{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "define",
    "extend",
    "io",
    "part",
    "Part",
    "construct",
    "name",
    "packages",
    "loader",
    "call",
    "members",
    "__packagesToLoad",
    "preload",
    "callback",
    "self",
    "packagesLoaded",
    "that",
    "i",
    "_packages",
    "length",
    "pkg",
    "getReadyState",
    "loadClosure",
    "_loader",
    "notifyPackageResult",
    "load",
    "_checkCompleteLoading",
    "_readyState",
    "_appendPartListener",
    "pkgReadyState",
    "addPackageListener",
    "bind",
    "_onPackageLoad",
    "_markAsCompleted",
    "__executePackages",
    "__P_257_1",
    "execute",
    "ClosurePart"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/node_modules/@qooxdoo/framework/source/class/qx/io/part/ClosurePart.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2009 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Fabian Jakobs (fjakobs)\n     * Martin Wittemann (martinwittemann)\n\n************************************************************************ */\n\n/**\n * Wrapper for a part as defined in the config file. This class knows about all\n * packages the part depends on and provides functionality to load the part.\n *\n * @internal\n */\nqx.Bootstrap.define(\"qx.io.part.ClosurePart\", {\n  extend: qx.io.part.Part,\n\n  /**\n   * @param name {String} Name of the part as defined in the config file at\n   *    compile time.\n   * @param packages {qx.io.part.Package[]} List of dependent packages\n   * @param loader {qx.Part} The loader of this part.\n   */\n  construct(name, packages, loader) {\n    qx.io.part.Part.call(this, name, packages, loader);\n  },\n\n  members: {\n    __packagesToLoad: 0,\n\n    // overridden\n    preload(callback, self) {\n      // store how many packages are already preloaded\n      var packagesLoaded = 0;\n      var that = this;\n\n      for (var i = 0; i < this._packages.length; i++) {\n        var pkg = this._packages[i];\n        if (pkg.getReadyState() == \"initialized\") {\n          pkg.loadClosure(function (pkg) {\n            packagesLoaded++;\n            that._loader.notifyPackageResult(pkg);\n            // everything loaded?\n            if (packagesLoaded >= that._packages.length && callback) {\n              callback.call(self);\n            }\n          }, this._loader);\n        }\n      }\n    },\n\n    /**\n     * Loads the closure part including all its packages. The loading will\n     * be done parallel. After all packages are available, the closures are\n     * executed in the correct order.\n     *\n     * @param callback {Function} The function to call after the loading.\n     * @param self {Object?} The context of the callback.\n     */\n    load(callback, self) {\n      if (this._checkCompleteLoading(callback, self)) {\n        return;\n      }\n\n      this._readyState = \"loading\";\n\n      if (callback) {\n        this._appendPartListener(callback, self, this);\n      }\n\n      this.__packagesToLoad = this._packages.length;\n\n      for (var i = 0; i < this._packages.length; i++) {\n        var pkg = this._packages[i];\n        var pkgReadyState = pkg.getReadyState();\n\n        // trigger loading\n        if (pkgReadyState == \"initialized\") {\n          pkg.loadClosure(this._loader.notifyPackageResult, this._loader);\n        }\n\n        // Listener for package changes\n        if (pkgReadyState == \"initialized\" || pkgReadyState == \"loading\") {\n          this._loader.addPackageListener(\n            pkg,\n            qx.Bootstrap.bind(this._onPackageLoad, this, pkg)\n          );\n        } else if (pkgReadyState == \"error\") {\n          this._markAsCompleted(\"error\");\n          return;\n        } else {\n          // \"complete\" and \"cached\"\n          this.__packagesToLoad--;\n        }\n      }\n\n      // execute closures in case everything is already loaded/cached\n      if (this.__packagesToLoad <= 0) {\n        this.__executePackages();\n      }\n    },\n\n    /**\n     * Executes the packages in their correct order and marks the part as\n     * complete after execution.\n     */\n    __executePackages() {\n      for (var i = 0; i < this._packages.length; i++) {\n        this._packages[i].execute();\n      }\n      this._markAsCompleted(\"complete\");\n    },\n\n    /**\n     * Handler for every package load. It checks for errors and decreases the\n     * packages to load. If all packages has been loaded, it invokes the\n     * execution.\n     *\n     * @param pkg {qx.io.part.Package} The loaded package.\n     */\n    _onPackageLoad(pkg) {\n      // if the part already has an error, ignore the callback\n      if (this._readyState == \"error\") {\n        return;\n      }\n\n      // one error package results in an error part\n      if (pkg.getReadyState() == \"error\") {\n        this._markAsCompleted(\"error\");\n        return;\n      }\n\n      // every package could be loaded -> execute the closures\n      this.__packagesToLoad--;\n      if (this.__packagesToLoad <= 0) {\n        this.__executePackages();\n      }\n    }\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}