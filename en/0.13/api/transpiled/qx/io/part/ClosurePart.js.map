{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "define",
    "extend",
    "io",
    "part",
    "Part",
    "construct",
    "name",
    "packages",
    "loader",
    "call",
    "members",
    "__packagesToLoad",
    "preload",
    "callback",
    "self",
    "packagesLoaded",
    "that",
    "i",
    "_packages",
    "length",
    "pkg",
    "getReadyState",
    "loadClosure",
    "_loader",
    "notifyPackageResult",
    "load",
    "_checkCompleteLoading",
    "_readyState",
    "_appendPartListener",
    "pkgReadyState",
    "addPackageListener",
    "bind",
    "_onPackageLoad",
    "_markAsCompleted",
    "__executePackages",
    "execute",
    "ClosurePart"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/node_modules/@qooxdoo/framework/source/class/qx/io/part/ClosurePart.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2009 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Fabian Jakobs (fjakobs)\n     * Martin Wittemann (martinwittemann)\n\n************************************************************************ */\n\n/**\n * Wrapper for a part as defined in the config file. This class knows about all\n * packages the part depends on and provides functionality to load the part.\n *\n * @internal\n */\nqx.Bootstrap.define(\"qx.io.part.ClosurePart\", {\n  extend: qx.io.part.Part,\n\n  /**\n   * @param name {String} Name of the part as defined in the config file at\n   *    compile time.\n   * @param packages {qx.io.part.Package[]} List of dependent packages\n   * @param loader {qx.Part} The loader of this part.\n   */\n  construct(name, packages, loader) {\n    qx.io.part.Part.call(this, name, packages, loader);\n  },\n\n  members: {\n    __packagesToLoad: 0,\n\n    // overridden\n    preload(callback, self) {\n      // store how many packages are already preloaded\n      var packagesLoaded = 0;\n      var that = this;\n\n      for (var i = 0; i < this._packages.length; i++) {\n        var pkg = this._packages[i];\n        if (pkg.getReadyState() == \"initialized\") {\n          pkg.loadClosure(function (pkg) {\n            packagesLoaded++;\n            that._loader.notifyPackageResult(pkg);\n            // everything loaded?\n            if (packagesLoaded >= that._packages.length && callback) {\n              callback.call(self);\n            }\n          }, this._loader);\n        }\n      }\n    },\n\n    /**\n     * Loads the closure part including all its packages. The loading will\n     * be done parallel. After all packages are available, the closures are\n     * executed in the correct order.\n     *\n     * @param callback {Function} The function to call after the loading.\n     * @param self {Object?} The context of the callback.\n     */\n    load(callback, self) {\n      if (this._checkCompleteLoading(callback, self)) {\n        return;\n      }\n\n      this._readyState = \"loading\";\n\n      if (callback) {\n        this._appendPartListener(callback, self, this);\n      }\n\n      this.__packagesToLoad = this._packages.length;\n\n      for (var i = 0; i < this._packages.length; i++) {\n        var pkg = this._packages[i];\n        var pkgReadyState = pkg.getReadyState();\n\n        // trigger loading\n        if (pkgReadyState == \"initialized\") {\n          pkg.loadClosure(this._loader.notifyPackageResult, this._loader);\n        }\n\n        // Listener for package changes\n        if (pkgReadyState == \"initialized\" || pkgReadyState == \"loading\") {\n          this._loader.addPackageListener(\n            pkg,\n            qx.Bootstrap.bind(this._onPackageLoad, this, pkg)\n          );\n        } else if (pkgReadyState == \"error\") {\n          this._markAsCompleted(\"error\");\n          return;\n        } else {\n          // \"complete\" and \"cached\"\n          this.__packagesToLoad--;\n        }\n      }\n\n      // execute closures in case everything is already loaded/cached\n      if (this.__packagesToLoad <= 0) {\n        this.__executePackages();\n      }\n    },\n\n    /**\n     * Executes the packages in their correct order and marks the part as\n     * complete after execution.\n     */\n    __executePackages() {\n      for (var i = 0; i < this._packages.length; i++) {\n        this._packages[i].execute();\n      }\n      this._markAsCompleted(\"complete\");\n    },\n\n    /**\n     * Handler for every package load. It checks for errors and decreases the\n     * packages to load. If all packages has been loaded, it invokes the\n     * execution.\n     *\n     * @param pkg {qx.io.part.Package} The loaded package.\n     */\n    _onPackageLoad(pkg) {\n      // if the part already has an error, ignore the callback\n      if (this._readyState == \"error\") {\n        return;\n      }\n\n      // one error package results in an error part\n      if (pkg.getReadyState() == \"error\") {\n        this._markAsCompleted(\"error\");\n        return;\n      }\n\n      // every package could be loaded -> execute the closures\n      this.__packagesToLoad--;\n      if (this.__packagesToLoad <= 0) {\n        this.__executePackages();\n      }\n    }\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;EAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;AACA;AACA;AACA;EACAH,EAAE,CAACC,SAAH,CAAaG,MAAb,CAAoB,wBAApB,EAA8C;IAC5CC,MAAM,EAAEL,EAAE,CAACM,EAAH,CAAMC,IAAN,CAAWC,IADyB;;IAG5C;AACF;AACA;AACA;AACA;AACA;IACEC,SAT4C,qBASlCC,IATkC,EAS5BC,QAT4B,EASlBC,MATkB,EASV;MAChCZ,EAAE,CAACM,EAAH,CAAMC,IAAN,CAAWC,IAAX,CAAgBK,IAAhB,CAAqB,IAArB,EAA2BH,IAA3B,EAAiCC,QAAjC,EAA2CC,MAA3C;IACD,CAX2C;IAa5CE,OAAO,EAAE;MACPC,SAAgB,EAAE,CADX;MAGP;MACAC,OAJO,mBAICC,QAJD,EAIWC,IAJX,EAIiB;QACtB;QACA,IAAIC,cAAc,GAAG,CAArB;QACA,IAAIC,IAAI,GAAG,IAAX;;QAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,SAAL,CAAeC,MAAnC,EAA2CF,CAAC,EAA5C,EAAgD;UAC9C,IAAIG,GAAG,GAAG,KAAKF,SAAL,CAAeD,CAAf,CAAV;;UACA,IAAIG,GAAG,CAACC,aAAJ,MAAuB,aAA3B,EAA0C;YACxCD,GAAG,CAACE,WAAJ,CAAgB,UAAUF,GAAV,EAAe;cAC7BL,cAAc;;cACdC,IAAI,CAACO,OAAL,CAAaC,mBAAb,CAAiCJ,GAAjC,EAF6B,CAG7B;;;cACA,IAAIL,cAAc,IAAIC,IAAI,CAACE,SAAL,CAAeC,MAAjC,IAA2CN,QAA/C,EAAyD;gBACvDA,QAAQ,CAACJ,IAAT,CAAcK,IAAd;cACD;YACF,CAPD,EAOG,KAAKS,OAPR;UAQD;QACF;MACF,CAtBM;;MAwBP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;MACIE,IAhCO,gBAgCFZ,QAhCE,EAgCQC,IAhCR,EAgCc;QACnB,IAAI,KAAKY,qBAAL,CAA2Bb,QAA3B,EAAqCC,IAArC,CAAJ,EAAgD;UAC9C;QACD;;QAED,KAAKa,WAAL,GAAmB,SAAnB;;QAEA,IAAId,QAAJ,EAAc;UACZ,KAAKe,mBAAL,CAAyBf,QAAzB,EAAmCC,IAAnC,EAAyC,IAAzC;QACD;;QAED,KAAKH,SAAL,GAAwB,KAAKO,SAAL,CAAeC,MAAvC;;QAEA,KAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,SAAL,CAAeC,MAAnC,EAA2CF,CAAC,EAA5C,EAAgD;UAC9C,IAAIG,GAAG,GAAG,KAAKF,SAAL,CAAeD,CAAf,CAAV;UACA,IAAIY,aAAa,GAAGT,GAAG,CAACC,aAAJ,EAApB,CAF8C,CAI9C;;UACA,IAAIQ,aAAa,IAAI,aAArB,EAAoC;YAClCT,GAAG,CAACE,WAAJ,CAAgB,KAAKC,OAAL,CAAaC,mBAA7B,EAAkD,KAAKD,OAAvD;UACD,CAP6C,CAS9C;;;UACA,IAAIM,aAAa,IAAI,aAAjB,IAAkCA,aAAa,IAAI,SAAvD,EAAkE;YAChE,KAAKN,OAAL,CAAaO,kBAAb,CACEV,GADF,EAEExB,EAAE,CAACC,SAAH,CAAakC,IAAb,CAAkB,KAAKC,cAAvB,EAAuC,IAAvC,EAA6CZ,GAA7C,CAFF;UAID,CALD,MAKO,IAAIS,aAAa,IAAI,OAArB,EAA8B;YACnC,KAAKI,gBAAL,CAAsB,OAAtB;;YACA;UACD,CAHM,MAGA;YACL;YACA,KAAKtB,SAAL;UACD;QACF,CAnCkB,CAqCnB;;;QACA,IAAI,KAAKA,SAAL,IAAyB,CAA7B,EAAgC;UAC9B,KAAKuB,SAAL;QACD;MACF,CAzEM;;MA2EP;AACJ;AACA;AACA;MACIA,SA/EO,uBA+Ea;QAClB,KAAK,IAAIjB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,SAAL,CAAeC,MAAnC,EAA2CF,CAAC,EAA5C,EAAgD;UAC9C,KAAKC,SAAL,CAAeD,CAAf,EAAkBkB,OAAlB;QACD;;QACD,KAAKF,gBAAL,CAAsB,UAAtB;MACD,CApFM;;MAsFP;AACJ;AACA;AACA;AACA;AACA;AACA;MACID,cA7FO,0BA6FQZ,GA7FR,EA6Fa;QAClB;QACA,IAAI,KAAKO,WAAL,IAAoB,OAAxB,EAAiC;UAC/B;QACD,CAJiB,CAMlB;;;QACA,IAAIP,GAAG,CAACC,aAAJ,MAAuB,OAA3B,EAAoC;UAClC,KAAKY,gBAAL,CAAsB,OAAtB;;UACA;QACD,CAViB,CAYlB;;;QACA,KAAKtB,SAAL;;QACA,IAAI,KAAKA,SAAL,IAAyB,CAA7B,EAAgC;UAC9B,KAAKuB,SAAL;QACD;MACF;IA9GM;EAbmC,CAA9C;EAzBAtC,EAAE,CAACM,EAAH,CAAMC,IAAN,CAAWiC,WAAX,CAAuBrC,aAAvB,GAAuCA,aAAvC"
}