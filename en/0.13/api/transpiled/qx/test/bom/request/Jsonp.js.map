{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "dev",
    "unit",
    "TestCase",
    "include",
    "test",
    "io",
    "MRemoteTest",
    "MRequirements",
    "MMock",
    "members",
    "setUp",
    "require",
    "req",
    "bom",
    "request",
    "Jsonp",
    "url",
    "getUrl",
    "core",
    "Environment",
    "get",
    "timeout",
    "tearDown",
    "window",
    "SCRIPT_LOADED",
    "undefined",
    "getSandbox",
    "restore",
    "dispose",
    "test_setCallbackParam",
    "setCallbackParam",
    "open",
    "send",
    "assertMatch",
    "_getUrl",
    "test_setCallbackName",
    "setCallbackName",
    "test_has_default_callback_param_and_name",
    "regExp",
    "test_not_overwrite_existing_callback",
    "that",
    "myExistingCallback",
    "onload",
    "resume",
    "assertEquals",
    "wait",
    "test_responseJson_holds_response_with_default_callback",
    "data",
    "responseJson",
    "assertObject",
    "assertTrue",
    "test_reset_responseJson_when_reopened",
    "assertNull",
    "test_status_indicates_success_when_default_callback_called",
    "status",
    "test_status_indicates_success_when_custom_callback_called",
    "test_status_indicates_failure_when_default_callback_not_called",
    "test_status_indicates_failure_when_custom_callback_not_called",
    "test_status_indicates_failure_when_callback_not_called_on_second_request",
    "count",
    "test_call_onload",
    "test_call_onerror_on_network_error",
    "onerror",
    "test_call_onloadend_on_network_error",
    "onloadend",
    "customUrl",
    "skip",
    "msg",
    "RequirementError"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/node_modules/@qooxdoo/framework/source/class/qx/test/bom/request/Jsonp.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2011 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Tristan Koch (tristankoch)\n\n************************************************************************ */\n\n/* ************************************************************************\n\n\n************************************************************************ */\n\n/* ************************************************************************\n\n\n************************************************************************ */\n/**\n *\n * @asset(qx/test/script.js)\n * @asset(qx/test/jsonp_primitive.php)\n *\n * @ignore(myExistingCallback)\n */\n/* global myExistingCallback */\nqx.Class.define(\"qx.test.bom.request.Jsonp\", {\n  extend: qx.dev.unit.TestCase,\n\n  include: [\n    qx.test.io.MRemoteTest,\n    qx.dev.unit.MRequirements,\n    qx.dev.unit.MMock\n  ],\n\n  members: {\n    setUp() {\n      this.require([\"php\"]);\n\n      var req = (this.req = new qx.bom.request.Jsonp());\n      this.url = this.getUrl(\"qx/test/jsonp_primitive.php\");\n\n      // Assume timeout after 1s in Opera (no error!)\n      if (qx.core.Environment.get(\"engine.name\") === \"opera\") {\n        req.timeout = 1000;\n      }\n    },\n\n    tearDown() {\n      window.SCRIPT_LOADED = undefined;\n      this.getSandbox().restore();\n      this.req.dispose();\n    },\n\n    //\n    // Callback\n    //\n\n    \"test: setCallbackParam()\"() {\n      var req = this.req;\n\n      req.setCallbackParam(\"myMethod\");\n      req.open(\"GET\", this.url);\n      req.send();\n\n      this.assertMatch(req._getUrl(), /(myMethod=)/);\n    },\n\n    \"test: setCallbackName()\"() {\n      var req = this.req;\n\n      req.setCallbackName(\"myCallback\");\n      req.open(\"GET\", this.url);\n      req.send();\n\n      this.assertMatch(req._getUrl(), /(=myCallback)/);\n    },\n\n    \"test: has default callback param and name\"() {\n      var req = this.req,\n        regExp;\n\n      req.open(\"GET\", this.url);\n      req.send();\n\n      // String is URL encoded\n      regExp = /\\?callback=qx\\.bom\\.request\\.Jsonp.*\\d{16,}.*\\.callback/;\n      this.assertMatch(req._getUrl(), regExp);\n    },\n\n    /**\n     * @ignore(myExistingCallback)\n     */\n    \"test: not overwrite existing callback\"() {\n      var that = this;\n\n      // User provided callback that must not be overwritten\n      window.myExistingCallback = function () {\n        return \"Affe\";\n      };\n\n      this.req.setCallbackName(\"myExistingCallback\");\n\n      this.req.onload = function () {\n        that.resume(function () {\n          that.assertEquals(\"Affe\", myExistingCallback());\n          window.myExistingCallback = undefined;\n        });\n      };\n\n      this.request();\n      this.wait();\n    },\n\n    //\n    // Properties\n    //\n\n    \"test: responseJson holds response with default callback\"() {\n      var that = this;\n\n      this.req.onload = function () {\n        that.resume(function () {\n          var data = this.req.responseJson;\n          that.assertObject(data);\n          that.assertTrue(data[\"boolean\"]);\n        });\n      };\n\n      this.request();\n      this.wait();\n    },\n\n    \"test: reset responseJson when reopened\"() {\n      var req = this.req,\n        that = this;\n\n      req.onload = function () {\n        that.resume(function () {\n          req.open(\"GET\", \"/url\");\n          that.assertNull(req.responseJson);\n        });\n      };\n\n      this.request();\n      this.wait();\n    },\n\n    \"test: status indicates success when default callback called\"() {\n      var that = this;\n\n      this.req.onload = function () {\n        that.resume(function () {\n          that.assertEquals(200, that.req.status);\n        });\n      };\n\n      this.request();\n      this.wait();\n    },\n\n    \"test: status indicates success when custom callback called\"() {\n      var that = this;\n\n      this.req.onload = function () {\n        that.resume(function () {\n          that.assertEquals(200, that.req.status);\n        });\n      };\n\n      this.req.setCallbackName(\"myCallback\");\n      this.request();\n      this.wait();\n    },\n\n    // Error handling\n\n    \"test: status indicates failure when default callback not called\"() {\n      var that = this;\n\n      this.req.onload = function () {\n        that.resume(function () {\n          that.assertEquals(500, that.req.status);\n        });\n      };\n\n      this.request(this.getUrl(\"qx/test/script.js\"));\n      this.wait();\n    },\n\n    \"test: status indicates failure when custom callback not called\"() {\n      var that = this;\n\n      this.req.onload = function () {\n        that.resume(function () {\n          that.assertEquals(500, that.req.status);\n        });\n      };\n\n      this.req.setCallbackName(\"myCallback\");\n      this.request(this.getUrl(\"qx/test/script.js\"));\n      this.wait();\n    },\n\n    \"test: status indicates failure when callback not called on second request\"() {\n      var count = 0,\n        req = this.req,\n        that = this;\n\n      req.onload = function () {\n        count += 1;\n\n        if (count == 2) {\n          that.resume(function () {\n            that.assertEquals(500, req.status);\n          });\n          return;\n        }\n\n        that.request(that.getUrl(\"qx/test/script.js\"));\n      };\n\n      this.request();\n      this.wait();\n    },\n\n    //\n    // Event handlers\n    //\n\n    \"test: call onload\"() {\n      var that = this;\n\n      this.req.onload = function () {\n        that.resume(function () {});\n      };\n\n      this.request();\n      this.wait();\n    },\n\n    // Error handling\n\n    \"test: call onerror on network error\"() {\n      var that = this;\n\n      // For legacy IEs, timeout needs to be lower than browser timeout\n      // or false \"load\" is fired. Alternatively, a false \"load\"\n      // can be identified by checking status property.\n      if (\n        qx.core.Environment.get(\"engine.name\") == \"mshtml\" &&\n        qx.core.Environment.get(\"browser.documentmode\") < 9\n      ) {\n        this.req.timeout = 2000;\n      }\n\n      this.req.onerror = function () {\n        that.resume(function () {});\n      };\n\n      this.request(\"http://fail.tld\");\n      this.wait(15000 + 100);\n    },\n\n    \"test: call onloadend on network error\"() {\n      var that = this;\n\n      this.req.onloadend = function () {\n        that.resume(function () {});\n      };\n\n      this.request(\"http://fail.tld\");\n      this.wait(15000 + 100);\n    },\n\n    request(customUrl) {\n      this.req.open(\"GET\", customUrl || this.url);\n      this.req.send();\n    },\n\n    skip(msg) {\n      throw new qx.dev.unit.RequirementError(null, msg);\n    }\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}