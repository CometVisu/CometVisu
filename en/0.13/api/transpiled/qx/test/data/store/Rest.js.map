{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "dev",
    "unit",
    "TestCase",
    "include",
    "MMock",
    "MRequirements",
    "members",
    "setUp",
    "setUpDoubleRequest",
    "marshal",
    "data",
    "Json",
    "shallowStub",
    "injectStub",
    "toModel",
    "returns",
    "setUpResource",
    "store",
    "Rest",
    "res",
    "dispose",
    "description",
    "index",
    "method",
    "url",
    "io",
    "rest",
    "Resource",
    "req",
    "request",
    "Xhr",
    "AbstractRequest",
    "stub",
    "tearDown",
    "getSandbox",
    "restore",
    "testConstructWithResAndActionName",
    "assertIdentical",
    "getResource",
    "getActionName",
    "testConstructThrowsWithMissingRes",
    "require",
    "assertException",
    "Error",
    "testConstructThrowsWithErroneousRes",
    "core",
    "AssertionError",
    "testConstructThrowsWithMissingAction",
    "testAddListenerForActionSuccessToRes",
    "assertCalled",
    "addListener",
    "testMarshalResponse",
    "key",
    "respond",
    "assertCalledWith",
    "testPopulatesModelPropertyWithMarshaledResponse",
    "name",
    "testFiresChangeModel",
    "that",
    "assertEventFired",
    "testConfigureRequestWithDelegate",
    "configureRequest",
    "spy",
    "setUserData",
    "delegate",
    "assertNotCalled",
    "send",
    "assertTrue",
    "getUserData",
    "testManipulateDataWithDelegateBeforeMarshaling",
    "manipulateData",
    "hasDebug",
    "response",
    "getPhase",
    "getResponse",
    "fireEvent",
    "skip",
    "msg",
    "RequirementError",
    "test"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/node_modules/@qooxdoo/framework/source/class/qx/test/data/store/Rest.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2011 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Tristan Koch (tristankoch)\n\n************************************************************************ */\n\nqx.Class.define(\"qx.test.data.store.Rest\", {\n  extend: qx.dev.unit.TestCase,\n\n  include: [qx.dev.unit.MMock, qx.dev.unit.MRequirements],\n\n  members: {\n    setUp() {\n      this.setUpDoubleRequest();\n\n      var marshal = (this.marshal = new qx.data.marshal.Json());\n      marshal = this.shallowStub(marshal, qx.data.marshal.Json);\n      this.injectStub(qx.data.marshal, \"Json\", marshal);\n\n      marshal.toModel.returns({});\n\n      this.setUpResource();\n      this.store = new qx.data.store.Rest(this.res, \"index\");\n    },\n\n    setUpResource() {\n      this.res && this.res.dispose();\n      var description = { index: { method: \"GET\", url: \"/photos\" } };\n      return (this.res = new qx.io.rest.Resource(description));\n    },\n\n    setUpDoubleRequest() {\n      var req = (this.req = new qx.io.request.Xhr()),\n        res = this.res;\n\n      // Stub request methods, leave event system intact\n      req = this.shallowStub(req, qx.io.request.AbstractRequest);\n\n      // Not dispose stub yet\n      this.stub(req, \"dispose\");\n\n      // Inject double and return\n      this.injectStub(qx.io.request, \"Xhr\", req);\n\n      return req;\n    },\n\n    tearDown() {\n      this.getSandbox().restore();\n      this.req.dispose();\n      this.marshal.dispose();\n      this.res.dispose();\n      this.store.dispose();\n    },\n\n    \"test: construct with res and action name\"() {\n      var store = this.store;\n\n      this.assertIdentical(store.getResource(), this.res);\n      this.assertIdentical(store.getActionName(), \"index\");\n    },\n\n    \"test: construct throws with missing res\"() {\n      this.require([\"debug\"]);\n\n      var store;\n\n      // Unfortunately, qx.core.Property throws a generic error\n      this.assertException(\n        function () {\n          store = new qx.data.store.Rest(null, \"index\");\n        },\n        Error,\n        /property res/\n      );\n\n      store && store.dispose();\n    },\n\n    \"test: construct throws with erroneous res\"() {\n      this.require([\"debug\"]);\n\n      var store;\n\n      this.assertException(function () {\n        store = new qx.data.store.Rest({}, \"index\");\n      }, qx.core.AssertionError);\n      store && store.dispose();\n    },\n\n    \"test: construct throws with missing action\"() {\n      this.require([\"debug\"]);\n\n      var store,\n        res = this.res;\n\n      this.assertException(\n        function () {\n          store = new qx.data.store.Rest(res, null);\n        },\n        Error,\n        /property actionName/\n      );\n\n      store && store.dispose();\n    },\n\n    \"test: add listener for actionSuccess to res\"() {\n      var res = this.res,\n        store;\n\n      this.stub(res, \"addListener\");\n      store = new qx.data.store.Rest(res, \"index\");\n      this.assertCalled(res.addListener);\n      store.dispose();\n    },\n\n    \"test: marshal response\"() {\n      var res = this.res,\n        store = this.store,\n        marshal = this.marshal,\n        data = { key: \"value\" };\n\n      res.index();\n\n      this.respond(data);\n      this.assertCalledWith(marshal.toModel, data);\n    },\n\n    \"test: populates model property with marshaled response\"() {\n      // Do not stub marshal.Json\n      qx.data.marshal.Json.restore();\n\n      var res = this.setUpResource(),\n        store = new qx.data.store.Rest(res, \"index\");\n\n      res.index();\n      this.respond({ name: \"Affe\" });\n      // this.assertEquals(\"Affe\", store.getModel().getName());\n      store.dispose();\n    },\n\n    \"test: fires changeModel\"() {\n      // Do not stub marshal.Json\n      qx.data.marshal.Json.restore();\n\n      var res = this.setUpResource(),\n        store = new qx.data.store.Rest(res, \"index\"),\n        that = this;\n\n      res.index();\n      this.assertEventFired(store, \"changeModel\", function () {\n        that.respond({ name: \"Affe\" });\n      });\n\n      store.dispose();\n      res.dispose();\n    },\n\n    \"test: configure request with delegate\"() {\n      var res = this.res,\n        req = this.req;\n\n      var configureRequest = this.spy(function (req) {\n        req.setUserData(\"affe\", true);\n      });\n\n      var delegate = {\n        configureRequest: configureRequest\n      };\n\n      var store = new qx.data.store.Rest(res, \"index\", delegate);\n\n      // Configure before sending\n      this.assertNotCalled(req.send);\n\n      res.index();\n      this.assertCalledWith(configureRequest, req);\n      this.assertTrue(req.getUserData(\"affe\"));\n      this.assertCalled(req.send);\n\n      store.dispose();\n    },\n\n    \"test: manipulate data with delegate before marshaling\"() {\n      var res = this.res,\n        data = { name: \"Tiger\" };\n\n      var manipulateData = this.spy(function (data) {\n        data.name = \"Maus\";\n        return data;\n      });\n\n      var delegate = {\n        manipulateData: manipulateData\n      };\n\n      var store = new qx.data.store.Rest(res, \"index\", delegate);\n      res.index();\n      this.respond(data);\n\n      this.assertCalledWith(manipulateData, data);\n      this.assertCalledWith(this.marshal.toModel, { name: \"Maus\" });\n\n      store.dispose();\n    },\n\n    hasDebug() {\n      return qx.core.Environment.get(\"qx.debug\");\n    },\n\n    // Fake response\n    respond(response) {\n      var req = this.req;\n      response = response || \"\";\n      req.getPhase.returns(\"success\");\n\n      // Set parsed response\n      req.getResponse.returns(response);\n\n      req.fireEvent(\"success\");\n    },\n\n    skip(msg) {\n      throw new qx.dev.unit.RequirementError(null, msg);\n    }\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}