{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "define",
    "extend",
    "Object",
    "construct",
    "clazz",
    "dev",
    "FakeServer",
    "$$allowconstruct",
    "msg",
    "Error",
    "getFakeServer",
    "__responses",
    "statics",
    "$$instance",
    "getInstance",
    "members",
    "__sinon",
    "__fakeServer",
    "__filter",
    "configure",
    "responseData",
    "forEach",
    "item",
    "urlRegExp",
    "url",
    "RegExp",
    "_getRegExp",
    "response",
    "method",
    "hasResponse",
    "i",
    "l",
    "length",
    "old",
    "push",
    "respondWith",
    "bind",
    "filter",
    "__getCombinedFilter",
    "addFilter",
    "FakeXMLHttpRequest",
    "removeFilter",
    "lang",
    "Array",
    "remove",
    "filters",
    "removeResponse",
    "toString",
    "responses",
    "sinon",
    "unit",
    "Sinon",
    "getSinon",
    "useFilters",
    "useFakeServer",
    "autoRespond",
    "restore",
    "pattern",
    "replace",
    "async",
    "username",
    "password",
    "filterMethod",
    "regExp",
    "test",
    "destruct"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/node_modules/@qooxdoo/framework/source/class/qx/dev/FakeServer.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2013 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Daniel Wagner (danielwagner)\n\n************************************************************************ */\n\n/**\n * A wrapper around Sinon.JS's FakeXMLHttpRequest and FakeServer features that\n * allows quick and simple configuration of mock HTTP backends for testing and\n * development.\n * Automatically creates URL filtering rules to ensure that only configured\n * requests are faked while others will be processed normally by the browser's\n * XHR implementation.\n *\n * The following example shows how to configure mock responses for two different\n * requests:\n * <pre class=\"javascript\">\n *   var responseData = [\n *     {\n *       method: \"GET\",\n *       url: /\\/api\\/resource\\/\\d+/,\n *       response : function(request) {\n *         var status = 200;\n *         var headers = { \"Content-Type\": \"application/json\" };\n *         var responseData = {\n *           description: \"Mock REST response for resource \" + request.url\n *         };\n *         var body = qx.lang.Json.stringify(responseData);\n *         request.respond(status, headers, body);\n *       }\n *     },\n *     {\n *       method: \"GET\",\n *       url: \"/users/{userId}\",\n *       response: [\n *         200,\n *         { \"Content-Type\": \"application/json\" },\n *         qx.lang.Json.stringify({userId: 'someUser'})\n *       ]\n *     }\n *   ];\n *\n *   qx.dev.FakeServer.getInstance().configure(responseData);\n * </pre>\n */\nqx.Bootstrap.define(\"qx.dev.FakeServer\", {\n  extend: Object,\n\n  construct() {\n    var clazz = qx.dev.FakeServer;\n\n    if (!clazz.$$allowconstruct) {\n      var msg =\n        clazz +\n        \" is a singleton! It is not possible to instantiate it directly.\" +\n        \"Use the static getInstance() method instead.\";\n      throw new Error(msg);\n    }\n\n    this.getFakeServer();\n    this.__responses = [];\n  },\n\n  statics: {\n    $$instance: null,\n    $$allowconstruct: false,\n\n    /**\n     * Helper method to handle singletons\n     *\n     * @internal\n     * @return {Object} The singleton instance\n     */\n    getInstance() {\n      if (!this.$$instance) {\n        this.$$allowconstruct = true;\n        this.$$instance = new this();\n        delete this.$$allowconstruct;\n      }\n\n      return this.$$instance;\n    }\n  },\n\n  members: {\n    __sinon: null,\n    __fakeServer: null,\n    __responses: null,\n    __filter: null,\n\n    /**\n     * Configures a set of fake HTTP responses. Each response is defined as a map\n     * that must provide the following keys:\n     * <ul>\n     *   <li><code>method</code> HTTP method to respond to, e.g. <code>PUT</code></li>\n     *   <li><code>url</code> URL used to match requests to fake responses. Can be\n     *   a RegExp or a String. REST-style parameter placeholders in curly braces\n     *   will be replaced with wildcards, e.g. the string \"/resource/{resourceId}\"\n     *   is interpreted as the RegExp <code>/\\/resource\\/\\{.*?\\}/</code>\n     *   <li><code>response</code> This can be either:\n     *     <ul>\n     *       <li>a string: This will be the response body, status code will be 200</li>\n     *       <li>an array containing the status code, a map of response headers and\n     *         the response text, e.g. <code>[200, { \"Content-Type\": \"text/html\" }, \"OK\"]</code>\n     *       </li>\n     *       <li>a function: This will be called with a FakeXMLHttpRequest object as\n     *       the only argument. Its <code>respond</code> method must be called to send a response.\n     *       See <a href=\"http://sinonjs.org/docs/#respond\">Sinon.JS: Respond</a> for details.\n     *       </li>\n     *     </ul>\n     *   </li>\n     * </ul>\n     *\n     * @param responseData {Map[]} An array of response description maps.\n     */\n    configure(responseData) {\n      responseData.forEach(\n        function (item) {\n          var urlRegExp =\n            item.url instanceof RegExp ? item.url : this._getRegExp(item.url);\n          var response = [item.method, urlRegExp];\n          var hasResponse = false;\n          for (var i = 0, l = this.__responses.length; i < l; i++) {\n            var old = this.__responses[i];\n            hasResponse = old[0] == response[0] && old[1] == response[1];\n          }\n          if (!hasResponse) {\n            this.__responses.push(response);\n          }\n          this.respondWith(item.method, urlRegExp, item.response);\n        }.bind(this)\n      );\n\n      var filter = (this.__filter = this.__getCombinedFilter());\n      this.addFilter(filter);\n    },\n\n    /**\n     * Adds a URL filtering function to decide whether a request should be handled\n     * by the FakeServer or passed to the regular XMLHttp implementation.\n     * See <a href=\"http://sinonjs.org/docs/#filtered-requests\">Sinon.JS: Filtered Requests</a>\n     * for details.\n     *\n     * @param filter {Function} URL filter function. Will be called with the\n     * following arguments: <code>method</code>, <code>url</code>, <code>async</code>,\n     * <code>username</code>, <code>password</code>. Must return <code>true</code>\n     * if the request should not be faked.\n     */\n    addFilter(filter) {\n      if (qx.core.Environment.get(\"qx.debug\")) {\n        qx.core.Assert.assertFunction(filter);\n      }\n\n      this.__sinon.FakeXMLHttpRequest.addFilter(filter);\n    },\n\n    /**\n     * Remove a filter that was added with {@link #addFilter}\n     * @param filter {Function} filter function to remove\n     */\n    removeFilter(filter) {\n      qx.lang.Array.remove(this.__sinon.FakeXMLHttpRequest.filters, filter);\n    },\n\n    /**\n     * Removes a response that was configured with {@link #configure}\n     * @param method {String} HTTP method of the response\n     * @param url {String|RegExp} URL of the response\n     */\n    removeResponse(method, url) {\n      qx.lang.Array.remove(\n        this.__sinon.FakeXMLHttpRequest.filters,\n        this.__filter\n      );\n\n      var urlRegExp = url instanceof RegExp ? url : this._getRegExp(url);\n      this.__responses = this.__responses.filter(function (response) {\n        return (\n          response[0] != method ||\n          response[1].toString() != urlRegExp.toString()\n        );\n      });\n      this.__fakeServer.responses = this.__fakeServer.responses.filter(\n        function (response) {\n          return (\n            response.method != method ||\n            response.url.toString() != urlRegExp.toString()\n          );\n        }\n      );\n\n      this.removeFilter(this.__filter);\n      this.__filter = this.__getCombinedFilter();\n      this.addFilter(this.__filter);\n    },\n\n    /**\n     * Defines a fake XHR response to a matching request.\n     *\n     * @param method {String} HTTP method to respond to, e.g. \"GET\"\n     * @param urlRegExp {RegExp} Request URL must match match this expression\n     * @param response {Function|Array|String} Response to send. See\n     * <a href=\"http://sinonjs.org/docs/#fakeServer\">Sinon.JS: Fake Server</a> for details.\n     */\n    respondWith(method, urlRegExp, response) {\n      this.getFakeServer().respondWith(method, urlRegExp, response);\n    },\n\n    /**\n     * Creates and configures a FakeServer if necessary and returns it.\n     * @return {Object} FakeServer object\n     */\n\n    getFakeServer() {\n      if (!this.__fakeServer) {\n        var sinon = (this.__sinon = qx.dev.unit.Sinon.getSinon());\n        sinon.FakeXMLHttpRequest.useFilters = true;\n        this.__fakeServer = sinon.useFakeServer();\n        this.__fakeServer.autoRespond = true;\n      }\n      return this.__fakeServer;\n    },\n\n    /**\n     * Stops the FakeServer and removes all configured responses and/or filters.\n     */\n    restore() {\n      this.__responses = [];\n      this.removeFilter(this.__filter);\n      this.__filter = null;\n      this.__fakeServer.restore();\n      this.__fakeServer = null;\n    },\n\n    /**\n     * Returns a RegExp using the given pattern. Curly brackets and anything\n     * between are replaced with wildcards (.*?)\n     *\n     * @param pattern {String} RegExp pattern\n     * @return {RegExp} Regular Expression\n     */\n    _getRegExp(pattern) {\n      pattern = pattern.replace(/\\{[^\\/]*?\\}/g, \".*?\");\n      return new RegExp(pattern);\n    },\n\n    /**\n     * Returns a filter function that ensures only requests matching configured\n     * fake responses will be intercepted.\n     * @return {Function} filter function\n     */\n    __getCombinedFilter() {\n      var responses = this.__responses;\n      return function (method, url, async, username, password) {\n        for (var i = 0, l = responses.length; i < l; i++) {\n          var filterMethod = responses[i][0];\n          var regExp = responses[i][1];\n          if (method == filterMethod && regExp.test(url)) {\n            return false;\n          }\n        }\n        return true;\n      };\n    }\n  },\n\n  destruct() {\n    this.restore();\n    this.__fakeServer = this.__sinon = null;\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}