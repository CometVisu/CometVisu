{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "implement",
    "IDisposable",
    "construct",
    "__calls",
    "__timeoutWrapper",
    "lang",
    "Function",
    "bind",
    "__timeout",
    "__hasCalls",
    "members",
    "__timeoutId",
    "__currentQueue",
    "schedule",
    "deferredCall",
    "window",
    "setTimeout",
    "callKey",
    "toHashCode",
    "refreshTimeout",
    "cancel",
    "isEmpty",
    "clearTimeout",
    "event",
    "GlobalError",
    "observeMethod",
    "clone",
    "key",
    "call",
    "destruct",
    "util",
    "DeferredCallManager"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/node_modules/@qooxdoo/framework/source/class/qx/util/DeferredCallManager.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\r\n\r\n   qooxdoo - the new era of web development\r\n\r\n   http://qooxdoo.org\r\n\r\n   Copyright:\r\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\r\n\r\n   License:\r\n     MIT: https://opensource.org/licenses/MIT\r\n     See the LICENSE file in the project's top-level directory for details.\r\n\r\n   Authors:\r\n     * Sebastian Werner (wpbasti)\r\n     * Fabian Jakobs (fjakobs)\r\n\r\n************************************************************************ */\r\n\r\n/**\r\n * This class manages the timer used for deferred calls. All\r\n * {@link qx.util.DeferredCall} instances use the single timer from this class.\r\n *\r\n * NOTE: Instances of this class must be disposed of after use\r\n *\r\n */\r\nqx.Class.define(\"qx.util.DeferredCallManager\", {\r\n  extend: qx.core.Object,\r\n  type: \"singleton\",\r\n  implement: [qx.core.IDisposable],\r\n\r\n  /*\r\n  *****************************************************************************\r\n     CONSTRUCTOR\r\n  *****************************************************************************\r\n  */\r\n\r\n  construct() {\r\n    this.__calls = {};\r\n    this.__timeoutWrapper = qx.lang.Function.bind(this.__timeout, this);\r\n    this.__hasCalls = false;\r\n  },\r\n\r\n  /*\r\n  *****************************************************************************\r\n     MEMBERS\r\n  *****************************************************************************\r\n  */\r\n\r\n  members: {\r\n    __timeoutId: null,\r\n    __currentQueue: null,\r\n    __calls: null,\r\n    __hasCalls: null,\r\n    __timeoutWrapper: null,\r\n\r\n    /**\r\n     * Schedule a deferred call\r\n     *\r\n     * @param deferredCall {qx.util.DeferredCall} The call to schedule\r\n     */\r\n    schedule(deferredCall) {\r\n      if (this.__timeoutId == null) {\r\n        this.__timeoutId = window.setTimeout(this.__timeoutWrapper, 0);\r\n      }\r\n\r\n      var callKey = deferredCall.toHashCode();\r\n\r\n      // the flush is currently running and the call is already\r\n      // scheduled\r\n      if (this.__currentQueue && this.__currentQueue[callKey]) {\r\n        return;\r\n      }\r\n\r\n      this.__calls[callKey] = deferredCall;\r\n      this.__hasCalls = true;\r\n    },\r\n\r\n    /**\r\n     * Refresh the timeout if the current one is not active anymore.\r\n     * This is a very special case which can happen in unit tests using\r\n     * fakeTimers, which overrides the window.setTimeout function (amongst others)\r\n     * after restoring the sinon sandbox the timeout must be refreshed otherwise\r\n     * DeferredCalls would never fire.\r\n     */\r\n    refreshTimeout() {\r\n      if (this.__timeoutId !== null) {\r\n        this.__timeoutId = window.setTimeout(this.__timeoutWrapper, 0);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Cancel a scheduled deferred call\r\n     *\r\n     * @param deferredCall {qx.util.DeferredCall} The call to schedule\r\n     */\r\n    cancel(deferredCall) {\r\n      var callKey = deferredCall.toHashCode();\r\n\r\n      // the flush is currently running and the call is already\r\n      // scheduled -> remove it from the current queue\r\n      if (this.__currentQueue && this.__currentQueue[callKey]) {\r\n        this.__currentQueue[callKey] = null;\r\n        return;\r\n      }\r\n\r\n      delete this.__calls[callKey];\r\n\r\n      // stop timer if no other calls are waiting\r\n      if (qx.lang.Object.isEmpty(this.__calls) && this.__timeoutId != null) {\r\n        window.clearTimeout(this.__timeoutId);\r\n        this.__timeoutId = null;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Helper function for the timer.\r\n     *\r\n     * @signature function()\r\n     */\r\n    __timeout: qx.event.GlobalError.observeMethod(function () {\r\n      this.__timeoutId = null;\r\n\r\n      // the queue may change while doing the flush so we work on a copy of\r\n      // the queue and loop while the queue has any entries.\r\n      while (this.__hasCalls) {\r\n        this.__currentQueue = qx.lang.Object.clone(this.__calls);\r\n        this.__calls = {};\r\n        this.__hasCalls = false;\r\n\r\n        for (var key in this.__currentQueue) {\r\n          var call = this.__currentQueue[key];\r\n          if (call) {\r\n            this.__currentQueue[key] = null;\r\n            call.call();\r\n          }\r\n        }\r\n      }\r\n\r\n      this.__currentQueue = null;\r\n    })\r\n  },\r\n\r\n  /*\r\n  *****************************************************************************\r\n     DESTRUCTOR\r\n  *****************************************************************************\r\n  */\r\n\r\n  destruct() {\r\n    if (this.__timeoutId != null) {\r\n      window.clearTimeout(this.__timeoutId);\r\n    }\r\n    this.__timeoutWrapper = this.__calls = null;\r\n  }\r\n});\r\n"
  ],
  "mappings": "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"
}