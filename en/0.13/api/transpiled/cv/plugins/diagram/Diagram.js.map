{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "plugins",
    "diagram",
    "AbstractDiagram",
    "construct",
    "props",
    "_init",
    "constructor",
    "call",
    "properties",
    "width",
    "check",
    "nullable",
    "height",
    "statics",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "getAttributeToPropertyMappings",
    "transform",
    "value",
    "parseInt",
    "members",
    "__vlid1",
    "_onDomReady",
    "_this",
    "$$domReady",
    "pageId",
    "getParentPage",
    "getPath",
    "broker",
    "event",
    "message",
    "Bus",
    "setRestartOnVisible",
    "subscribe",
    "loadDiagramData",
    "plot",
    "initDiagram",
    "isVisible",
    "util",
    "DeferredCall",
    "schedule",
    "addListener",
    "ev",
    "getData",
    "removeListenerById",
    "initListeners",
    "_getInnerDomString",
    "classStr",
    "getPreviewlabels",
    "styleStr",
    "getWidth",
    "getHeight",
    "defer",
    "parser",
    "pure",
    "WidgetParser",
    "addHandler",
    "ui",
    "structure",
    "WidgetFactory",
    "registerClass",
    "Diagram"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/diagram/Diagram.js"
  ],
  "sourcesContent": [
    "/* Diagram.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\nqx.Class.define('cv.plugins.diagram.Diagram', {\n  extend: cv.plugins.diagram.AbstractDiagram,\n\n  /*\n   ******************************************************\n   CONSTRUCTOR\n   ******************************************************\n   */\n  construct(props) {\n    this._init = true;\n    super(props);\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    width: {\n      check: 'String',\n      nullable: true\n    },\n\n    height: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n   ******************************************************\n   STATICS\n   ******************************************************\n   */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     */\n    parse(xml, path, flavour, pageType) {\n      return cv.plugins.diagram.AbstractDiagram.parse(\n        xml,\n        path,\n        flavour,\n        pageType,\n        this.getAttributeToPropertyMappings()\n      );\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        width: {\n          transform(value) {\n            return value ? parseInt(value) + 'px' : '100%';\n          }\n        },\n\n        height: {\n          transform(value) {\n            return value ? parseInt(value) + 'px' : null;\n          }\n        }\n      };\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __vlid1: null,\n\n    _onDomReady() {\n      if (!this.$$domReady) {\n        const pageId = this.getParentPage().getPath();\n        const broker = qx.event.message.Bus;\n\n        // let the refresh only be active when this widget is visible\n        this.setRestartOnVisible(true);\n\n        broker.subscribe(\n          'path.' + pageId + '.beforePageChange',\n          function () {\n            if (!this._init) {\n              this.loadDiagramData(this.plot, false, false);\n            }\n          },\n          this\n        );\n\n        broker.subscribe(\n          'page.' + pageId + '.appear',\n          function () {\n            // create diagram when it's not already existing\n            if (this._init) {\n              this.initDiagram(false);\n            }\n          },\n          this\n        );\n\n        // initialize the diagram but don't make the initialization process wait for it\n        // by using a deferred call\n        if (this.isVisible()) {\n          new qx.util.DeferredCall(function () {\n            if (!this._init) {\n              this.loadDiagramData(this.plot, false, false);\n            } else {\n              this.initDiagram(false);\n            }\n          }, this).schedule();\n        } else {\n          this.__vlid1 = this.addListener('changeVisible', ev => {\n            if (ev.getData()) {\n              if (!this._init) {\n                this.loadDiagramData(this.plot, false, false);\n              } else {\n                this.initDiagram(false);\n              }\n              this.removeListenerById(this.__vlid1);\n              this.__vlid1 = null;\n            }\n          });\n        }\n        this.$$domReady = true;\n        this.initListeners();\n      }\n    },\n\n    _getInnerDomString() {\n      const classStr = this.getPreviewlabels() ? 'diagram_inline' : 'diagram_preview';\n      const styleStr =\n        'min-height: 40px' +\n        (this.getWidth() ? ';width:' + this.getWidth() : '') +\n        (this.getHeight() ? ';height:' + this.getHeight() : ';height: 100%');\n\n      return (\n        '<div class=\"actor clickable\" style=\"height: 100%; min-height: 40px;\"><div class=\"' +\n        classStr +\n        '\" style=\"' +\n        styleStr +\n        '\">loading...</div></div>'\n      );\n    }\n  },\n\n  defer(statics) {\n    // register the parser\n    cv.parser.pure.WidgetParser.addHandler('diagram', statics);\n    cv.ui.structure.WidgetFactory.registerClass('diagram', statics);\n  }\n});\n"
  ],
  "mappings": "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"
}