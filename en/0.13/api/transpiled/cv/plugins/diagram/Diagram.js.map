{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "plugins",
    "diagram",
    "AbstractDiagram",
    "construct",
    "props",
    "_init",
    "properties",
    "width",
    "check",
    "nullable",
    "height",
    "statics",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "getAttributeToPropertyMappings",
    "transform",
    "value",
    "parseInt",
    "members",
    "__vlid1",
    "_onDomReady",
    "$$domReady",
    "pageId",
    "getParentPage",
    "getPath",
    "broker",
    "event",
    "message",
    "Bus",
    "setRestartOnVisible",
    "subscribe",
    "loadDiagramData",
    "plot",
    "initDiagram",
    "isVisible",
    "util",
    "DeferredCall",
    "schedule",
    "addListener",
    "ev",
    "getData",
    "removeListenerById",
    "initListeners",
    "_getInnerDomString",
    "classStr",
    "getPreviewlabels",
    "styleStr",
    "getWidth",
    "getHeight",
    "defer",
    "parser",
    "pure",
    "WidgetParser",
    "addHandler",
    "ui",
    "structure",
    "WidgetFactory",
    "registerClass",
    "Diagram"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/diagram/Diagram.js"
  ],
  "sourcesContent": [
    "/* Diagram.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\nqx.Class.define('cv.plugins.diagram.Diagram', {\n  extend: cv.plugins.diagram.AbstractDiagram,\n\n  /*\n   ******************************************************\n   CONSTRUCTOR\n   ******************************************************\n   */\n  construct(props) {\n    this._init = true;\n    super(props);\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    width: {\n      check: 'String',\n      nullable: true\n    },\n\n    height: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n   ******************************************************\n   STATICS\n   ******************************************************\n   */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     */\n    parse(xml, path, flavour, pageType) {\n      return cv.plugins.diagram.AbstractDiagram.parse(\n        xml,\n        path,\n        flavour,\n        pageType,\n        this.getAttributeToPropertyMappings()\n      );\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        width: {\n          transform(value) {\n            return value ? parseInt(value) + 'px' : '100%';\n          }\n        },\n\n        height: {\n          transform(value) {\n            return value ? parseInt(value) + 'px' : null;\n          }\n        }\n      };\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __vlid1: null,\n\n    _onDomReady() {\n      if (!this.$$domReady) {\n        const pageId = this.getParentPage().getPath();\n        const broker = qx.event.message.Bus;\n\n        // let the refresh only be active when this widget is visible\n        this.setRestartOnVisible(true);\n\n        broker.subscribe(\n          'path.' + pageId + '.beforePageChange',\n          function () {\n            if (!this._init) {\n              this.loadDiagramData(this.plot, false, false);\n            }\n          },\n          this\n        );\n\n        broker.subscribe(\n          'page.' + pageId + '.appear',\n          function () {\n            // create diagram when it's not already existing\n            if (this._init) {\n              this.initDiagram(false);\n            }\n          },\n          this\n        );\n\n        // initialize the diagram but don't make the initialization process wait for it\n        // by using a deferred call\n        if (this.isVisible()) {\n          new qx.util.DeferredCall(function () {\n            if (!this._init) {\n              this.loadDiagramData(this.plot, false, false);\n            } else {\n              this.initDiagram(false);\n            }\n          }, this).schedule();\n        } else {\n          this.__vlid1 = this.addListener('changeVisible', ev => {\n            if (ev.getData()) {\n              if (!this._init) {\n                this.loadDiagramData(this.plot, false, false);\n              } else {\n                this.initDiagram(false);\n              }\n              this.removeListenerById(this.__vlid1);\n              this.__vlid1 = null;\n            }\n          });\n        }\n        this.$$domReady = true;\n        this.initListeners();\n      }\n    },\n\n    _getInnerDomString() {\n      const classStr = this.getPreviewlabels() ? 'diagram_inline' : 'diagram_preview';\n      const styleStr =\n        'min-height: 40px' +\n        (this.getWidth() ? ';width:' + this.getWidth() : '') +\n        (this.getHeight() ? ';height:' + this.getHeight() : ';height: 100%');\n\n      return (\n        '<div class=\"actor clickable\" style=\"height: 100%; min-height: 40px;\"><div class=\"' +\n        classStr +\n        '\" style=\"' +\n        styleStr +\n        '\">loading...</div></div>'\n      );\n    }\n  },\n\n  defer(statics) {\n    // register the parser\n    cv.parser.pure.WidgetParser.addHandler('diagram', statics);\n    cv.ui.structure.WidgetFactory.registerClass('diagram', statics);\n  }\n});\n"
  ],
  "mappings": "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"
}