{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "pure",
    "AbstractWidget",
    "include",
    "common",
    "Operate",
    "Refresh",
    "type",
    "construct",
    "props",
    "_debouncedLoadDiagramData",
    "util",
    "Function",
    "debounce",
    "loadDiagramData",
    "bind",
    "statics",
    "cache",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "mappings",
    "Object",
    "assign",
    "getAttributeToPropertyMappings",
    "parser",
    "WidgetParser",
    "parseElement",
    "parseRefresh",
    "legend",
    "getAttribute",
    "data",
    "Model",
    "getInstance",
    "setWidgetData",
    "content",
    "getDiagramElements",
    "legendInline",
    "indexOf",
    "legendPopup",
    "series",
    "seriesStart",
    "seriesEnd",
    "seriesResolution",
    "transform",
    "parseInt",
    "period",
    "legendposition",
    "timeformat",
    "timeformatTooltip",
    "zoomYAxis",
    "value",
    "title",
    "target",
    "refresh",
    "gridcolor",
    "previewlabels",
    "popup",
    "tooltip",
    "xmlElement",
    "retVal",
    "axes",
    "axesnum",
    "ts",
    "tsnum",
    "axesNameIndex",
    "querySelectorAll",
    "forEach",
    "elem",
    "unit",
    "axisLabel",
    "position",
    "min",
    "max",
    "tickDecimals",
    "tickFormatter",
    "v",
    "axis",
    "toFixed",
    "textContent",
    "src",
    "tagName",
    "steps",
    "fillMissing",
    "tsType",
    "color",
    "label",
    "axisIndex",
    "fill",
    "scaling",
    "parseFloat",
    "cFunc",
    "fillTs",
    "resol",
    "offset",
    "style",
    "align",
    "barWidth",
    "filter",
    "getInfluxFilter",
    "field",
    "authentication",
    "dsIndex",
    "children",
    "length",
    "retval",
    "i",
    "child",
    "lookupTsCache",
    "start",
    "end",
    "res",
    "forceNowDatapoint",
    "force",
    "callback",
    "callbackParameter",
    "client",
    "io",
    "BackendConnections",
    "getClient",
    "key",
    "url",
    "chartsResource",
    "getResourcePath",
    "encodeURIComponent",
    "urlNotInCache",
    "doLoad",
    "undefined",
    "Date",
    "now",
    "timestamp",
    "waitingCallbacks",
    "push",
    "xhr",
    "dispose",
    "request",
    "Xhr",
    "authorize",
    "set",
    "accept",
    "addListener",
    "ev",
    "_onSuccess",
    "_onStatusError",
    "send",
    "tsdata",
    "getTarget",
    "getResponse",
    "hasCustomChartsDataProcessor",
    "processChartsData",
    "millisOffset",
    "Number",
    "isFinite",
    "newRrd",
    "Array",
    "j",
    "l",
    "last",
    "from",
    "waitingCallback",
    "core",
    "notifications",
    "Router",
    "dispatchMessage",
    "locale",
    "Manager",
    "tr",
    "severity",
    "message",
    "JSON",
    "stringify",
    "_target",
    "_transport",
    "responseText",
    "window",
    "console",
    "error",
    "properties",
    "check",
    "init",
    "nullable",
    "apply",
    "members",
    "_init",
    "popupplot",
    "plot",
    "plotted",
    "_timerPopup",
    "__isPopup",
    "_applyTitle",
    "setLabel",
    "_setupRefreshAction",
    "getRefresh",
    "_timer",
    "event",
    "Timer",
    "_stopRefresh",
    "timer",
    "isEnabled",
    "stop",
    "_startRefresh",
    "runImmediately",
    "fireEvent",
    "_action",
    "popupDiagram",
    "dom",
    "Element",
    "create",
    "id",
    "getPath",
    "PopupHandler",
    "showPopup",
    "getLabel",
    "page",
    "getParentPage",
    "Registration",
    "removeAllListeners",
    "shutdown",
    "parent",
    "parentNode",
    "entries",
    "height",
    "width",
    "margin",
    "key_value",
    "innerHTML",
    "stopPropagation",
    "initDiagram",
    "isPopup",
    "options",
    "canvas",
    "getTooltip",
    "tooltipOpts",
    "xDateFormat",
    "getTimeformatTooltip",
    "shifts",
    "x",
    "y",
    "defaultTheme",
    "zoom",
    "interactive",
    "trigger",
    "amount",
    "pan",
    "cursor",
    "frameRate",
    "triggerOnDrag",
    "yaxes",
    "getContent",
    "xaxes",
    "mode",
    "getTimeformat",
    "show",
    "isLegendPopup",
    "isLegendInline",
    "backgroundColor",
    "getLegendposition",
    "grid",
    "aboveData",
    "getGridcolor",
    "tickColor",
    "markingsColor",
    "borderColor",
    "hoverable",
    "touch",
    "scale",
    "autoWidth",
    "autoHeight",
    "delayTouchEnded",
    "simulClick",
    "tapThreshold",
    "dbltapThreshold",
    "tapPrecision",
    "val",
    "axisLabelColour",
    "yaxis",
    "zoomRange",
    "getZoomYAxis",
    "xaxis",
    "panRange",
    "clickable",
    "getPreviewlabels",
    "ticks",
    "diagram",
    "$",
    "empty",
    "debug",
    "that",
    "self",
    "container",
    "closest",
    "actor",
    "action",
    "getPlaceholder",
    "unbind",
    "getSeriesSettings",
    "xAxis",
    "isInteractive",
    "hour",
    "day",
    "fullday",
    "week",
    "month",
    "year",
    "ret",
    "getSeries",
    "getSeriesStart",
    "getSeriesEnd",
    "getSeriesResolution",
    "selectedSeries",
    "getPeriod",
    "datamin",
    "datamax",
    "forceReload",
    "getAxes",
    "loadedData",
    "tsloaded",
    "tsSuccessful",
    "index",
    "getForceNowDatapoint",
    "plugins",
    "AbstractDiagram",
    "bars",
    "lines",
    "zero",
    "points",
    "fulldata",
    "loadedIndex",
    "k",
    "setData",
    "setupGrid",
    "draw",
    "destruct",
    "_disposeObjects",
    "defer",
    "loader",
    "ScriptLoader",
    "addScripts"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/diagram/AbstractDiagram.js"
  ],
  "sourcesContent": [
    "/* AbstractDiagram.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * This plugins integrates flot (diagrams in javascript) into the visualization.\n * server-side data-storage is rrd or InfluxDB.\n *\n * short documentation\n *\n * <h4>widgets:</h4>\n * <ul>\n *   <li>diagram</li>\n *   <li>diagram_info</li>\n * </ul>\n *\n * <h4>attributes (per diagram):</h4>\n * <ul>\n *   <li>series:               optional, \"hour\", \"day\" (default), \"week\", \"month\", \"year\"</li>\n *   <li>period:               optional, number of \"series\" to be shown</li>\n *   <li>refresh:              optional, refresh-rate in seconds, no refresh if missing</li>\n *   <li>gridcolor:            optional, color for dataline and grid, HTML-colorcode</li>\n *   <li>width, height:        optional, width and height of \"inline\"-diagram</li>\n *   <li>previewlabels:        optional, show labels on \"inline\"-diagram</li>\n *   <li>popup:                optional, make diagram clickable and open popup</li>\n *   <li>legend:               optional, \"none\", \"both\", \"inline\", \"popup\" select display of legend</li>\n *   <li>title:                optional, diagram title (overrides label-content)</li>\n * </ul>\n *\n * <h4>attributes (per graph):</h4>\n * <ul>\n *   <li>style:                optional, \"lines\" (default), \"bars\", \"points\" select graph type</li>\n *   <li>fill:                 optional, true or false - fill the space under the line / within the bar (line / bar style graphs)</li>\n *   <li>barWidth:             optional, width of bars (bar style graphs)</li>\n *   <li>align:                optional, \"left\" (default), \"center\", \"right\" select qlignemnt of bars (bar style graphs)</li>\n * </ul>\n *\n * @author Michael Hausl [michael at hausl dot com]\n * @since 0.6.0\n *\n * @asset(plugins/diagram/influxfetch.php)\n * @asset(plugins/diagram/dep/flot/jquery.flot.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.touch.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.canvas.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.resize.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.time.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.axislabels.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.tooltip.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.navigate.min.js)\n */\nqx.Class.define('cv.plugins.diagram.AbstractDiagram', {\n  extend: cv.ui.structure.pure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Refresh],\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(props) {\n    super(props);\n    this._debouncedLoadDiagramData = qx.util.Function.debounce(this.loadDiagramData.bind(this), 200);\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    cache: {},\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @param mappings\n     */\n    parse(xml, path, flavour, pageType, mappings) {\n      if (mappings) {\n        mappings = Object.assign(mappings, this.getAttributeToPropertyMappings());\n      } else {\n        mappings = this.getAttributeToPropertyMappings();\n      }\n      cv.parser.pure.WidgetParser.parseElement(this, xml, path, flavour, pageType, mappings);\n\n      cv.parser.pure.WidgetParser.parseRefresh(xml, path);\n\n      const legend = xml.getAttribute('legend') || 'both';\n      return cv.data.Model.getInstance().setWidgetData(path, {\n        content: this.getDiagramElements(xml),\n        legendInline: ['both', 'inline'].indexOf(legend) >= 0,\n        legendPopup: ['both', 'popup'].indexOf(legend) >= 0\n      });\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        series: { default: 'day' },\n        seriesStart: { default: 'end-month' },\n        seriesEnd: { default: 'now' },\n        seriesResolution: { default: 300, transform: parseInt },\n        period: { default: 1, transform: parseInt },\n        legendposition: { default: 'ne' },\n        timeformat: {},\n        timeformatTooltip: { default: '%d.%m.%Y %H:%M' },\n        zoomYAxis: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        title: { target: 'title' },\n        refresh: {},\n        gridcolor: { default: '#81664B' },\n        previewlabels: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        popup: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        tooltip: {\n          transform(value) {\n            return value === 'true';\n          }\n        }\n      };\n    },\n\n    getDiagramElements(xmlElement) {\n      const retVal = {\n        axes: [],\n        axesnum: 0,\n        ts: [],\n        tsnum: 0\n      };\n\n      const axesNameIndex = [];\n\n      xmlElement.querySelectorAll('axis').forEach(function (elem) {\n        const unit = elem.getAttribute('unit') || '';\n        retVal.axes[retVal.axesnum] = {\n          axisLabel: elem.getAttribute('label') || null,\n          position: elem.getAttribute('position') || 'left',\n          min: elem.getAttribute('min') || null,\n          max: elem.getAttribute('max') || null,\n          unit: unit,\n          tickDecimals: elem.getAttribute('decimals') || null,\n          tickFormatter(v, axis) {\n            return v.toFixed(axis.tickDecimals) + unit;\n          }\n        };\n\n        retVal.axesnum++;\n        axesNameIndex[elem.textContent] = retVal.axesnum;\n      }, this);\n\n      xmlElement.querySelectorAll('influx,rrd').forEach(function (elem) {\n        const src = elem.tagName === 'rrd' ? elem.textContent : elem.getAttribute('measurement');\n        const steps = (elem.getAttribute('steps') || 'false') === 'true';\n        const fillMissing = elem.getAttribute('fillMissing');\n        retVal.ts[retVal.tsnum] = {\n          tsType: elem.tagName,\n          src: src,\n          color: elem.getAttribute('color'),\n          label: elem.getAttribute('label') || src,\n          axisIndex: axesNameIndex[elem.getAttribute('yaxis')] || 1,\n          steps: steps,\n          fill: (elem.getAttribute('fill') || 'false') === 'true',\n          scaling: parseFloat(elem.getAttribute('scaling')) || 1.0,\n          cFunc: elem.getAttribute('consolidationFunction') || (elem.tagName === 'rrd' ? 'AVERAGE' : 'MEAN'),\n          fillTs: fillMissing === null ? (steps ? 'previous' : 'linear') : fillMissing,\n          resol: parseInt(elem.getAttribute('resolution')),\n          offset: parseInt(elem.getAttribute('offset')),\n          style: elem.getAttribute('style') || 'lines',\n          align: elem.getAttribute('align') || 'center',\n          barWidth: elem.getAttribute('barWidth') || 1\n        };\n\n        if (elem.tagName === 'influx') {\n          retVal.ts[retVal.tsnum].filter = this.getInfluxFilter(elem, 'AND');\n          retVal.ts[retVal.tsnum].field = elem.getAttribute('field');\n          retVal.ts[retVal.tsnum].authentication = elem.getAttribute('authentication');\n        } else {\n          let dsIndex = elem.getAttribute('datasourceIndex') || 0;\n          if (dsIndex < 0) {\n            dsIndex = 0;\n          }\n          retVal.ts[retVal.tsnum].dsIndex = dsIndex;\n        }\n        retVal.tsnum++;\n      }, this);\n      return retVal;\n    },\n\n    /**\n     * Recursively walk through the elem to build filter sting\n     * @param elem\n     * @param type\n     */\n    getInfluxFilter(elem, type) {\n      const children = elem.children;\n      const length = children.length;\n      let retval = '';\n      let i = 0;\n\n      for (; i < length; i++) {\n        const child = children[i];\n\n        if (retval !== '') {\n          retval += ' ' + type + ' ';\n        }\n\n        switch (child.tagName) {\n          case 'and':\n            retval += this.getInfluxFilter(child, 'AND');\n            break;\n\n          case 'or':\n            retval += this.getInfluxFilter(child, 'OR');\n            break;\n\n          case 'tag':\n            retval +=\n              child.getAttribute('key') +\n              ' ' +\n              child.getAttribute('operator') +\n              ' \\'' +\n              child.getAttribute('value') +\n              '\\'';\n            break;\n\n          default:\n          // ignore unknown\n        }\n      }\n\n      if (type) {\n        return '(' + retval + ')';\n      }\n\n      return retval;\n    },\n\n    /**\n     * Get the rrd or InfluxDB and put it's content in the cache.\n     * @param ts\n     * @param start\n     * @param end\n     * @param res\n     * @param forceNowDatapoint\n     * @param refresh {Number} time is seconds to refresh the data\n     * @param force {Boolean} Update even when the cache is still valid\n     * @param callback {Function} call when the data has arrived\n     * @param callbackParameter\n     */\n    lookupTsCache(ts, start, end, res, forceNowDatapoint, refresh, force, callback, callbackParameter) {\n      const client = cv.io.BackendConnections.getClient();\n      let key;\n      let url;\n      const chartsResource = client.getResourcePath('charts', {\n        src: ts.src,\n        start: start,\n        end: end\n      });\n\n      if (ts.tsType !== 'influx' && chartsResource !== null) {\n        // the backend provides an charts resource that must be processed differently (e.g. openHABs persistence data\n        url = chartsResource;\n        key = url;\n      } else {\n        url =\n          (ts.tsType === 'influx'\n            ? 'resource/plugins/diagram/influxfetch.php?ts=' + ts.src\n            : client.getResourcePath('rrd') + '?rrd=' + encodeURIComponent(ts.src) + '.rrd') +\n          '&ds=' +\n          encodeURIComponent(ts.cFunc) +\n          // NOTE: don't encodeURIComponent `start` and `end` for RRD as the \"+\" needs to be in the URL in plain text\n          //       although it looks wrong (as a \"+\" in a URL translates in the decode to a space: \" \")\n          '&start=' +\n          (ts.tsType === 'rrd' ? start : encodeURIComponent(start)) +\n          '&end=' +\n          (ts.tsType === 'rrd' ? end : encodeURIComponent(end)) +\n          '&res=' +\n          encodeURIComponent(res) +\n          (ts.fillTs ? '&fill=' + encodeURIComponent(ts.fillTs) : '') +\n          (ts.filter ? '&filter=' + encodeURIComponent(ts.filter) : '') +\n          (ts.field ? '&field=' + encodeURIComponent(ts.field) : '') +\n          (ts.authentication ? '&auth=' + encodeURIComponent(ts.authentication) : '');\n        key = url + (ts.tsType === 'rrd' ? '|' + ts.dsIndex : '');\n      }\n      let urlNotInCache = !(key in this.cache);\n      let doLoad =\n        force ||\n        urlNotInCache ||\n        !('data' in this.cache[key]) ||\n        (refresh !== undefined && Date.now() - this.cache[key].timestamp > refresh * 1000);\n\n      if (doLoad) {\n        if (urlNotInCache) {\n          this.cache[key] = { waitingCallbacks: [] };\n        }\n        this.cache[key].waitingCallbacks.push([callback, callbackParameter]);\n\n        if (this.cache[key].waitingCallbacks.length === 1) {\n          if (this.cache[key].xhr) {\n            this.cache[key].xhr.dispose();\n          }\n          const xhr = new qx.io.request.Xhr(url);\n          client.authorize(xhr);\n          xhr.set({\n            accept: 'application/json'\n          });\n\n          xhr.addListener('success', ev => {\n            this._onSuccess(ts, key, ev, forceNowDatapoint);\n          });\n          xhr.addListener('statusError', ev => {\n            this._onStatusError(ts, key, ev);\n          });\n          this.cache[key].xhr = xhr;\n          xhr.send();\n        }\n      } else {\n        callback(this.cache[key].data, callbackParameter);\n      }\n    },\n\n    _onSuccess(ts, key, ev, forceNowDatapoint) {\n      let tsdata = ev.getTarget().getResponse();\n      if (tsdata !== null) {\n        const client = cv.io.BackendConnections.getClient();\n        if (client.hasCustomChartsDataProcessor(tsdata)) {\n          tsdata = client.processChartsData(tsdata);\n        } else {\n          // calculate timestamp offset and scaling\n          const millisOffset = Number.isFinite(ts.offset) ? ts.offset * 1000 : 0;\n          const newRrd = new Array(tsdata.length);\n          let j = 0;\n          const l = tsdata.length;\n          for (; j < l; j++) {\n            if (ts.tsType === 'rrd') {\n              newRrd[j] = [tsdata[j][0] + millisOffset, parseFloat(tsdata[j][1][ts.dsIndex]) * ts.scaling];\n            } else {\n              newRrd[j] = [tsdata[j][0] + millisOffset, parseFloat(tsdata[j][1]) * ts.scaling];\n            }\n          }\n          tsdata = newRrd;\n        }\n      }\n\n      let now = Date.now();\n\n      if (forceNowDatapoint && tsdata.length > 0) {\n        let last = Array.from(tsdata[tsdata.length - 1]); // force copy\n        last[0] = now;\n        tsdata.push(last);\n      }\n\n      this.cache[key].data = tsdata;\n      this.cache[key].timestamp = now;\n\n      this.cache[key].waitingCallbacks.forEach(function (waitingCallback) {\n        waitingCallback[0](tsdata, waitingCallback[1]);\n      }, this);\n      this.cache[key].waitingCallbacks.length = 0; // empty array)\n    },\n\n    _onStatusError(ts, key, ev) {\n      cv.core.notifications.Router.dispatchMessage('cv.diagram.error', {\n        title: qx.locale.Manager.tr('Diagram communication error'),\n        severity: 'urgent',\n        message: qx.locale.Manager.tr(\n          'URL: %1<br/><br/>Response:</br>%2',\n          JSON.stringify(key),\n          ev._target._transport.responseText\n        )\n      });\n\n      window.console.error('Diagram _onStatusError', ts, key, ev);\n      const tsdata = [];\n\n      this.cache[key].data = tsdata;\n      this.cache[key].timestamp = Date.now();\n\n      this.cache[key].waitingCallbacks.forEach(function (waitingCallback) {\n        waitingCallback[0](tsdata, waitingCallback[1]);\n      }, this);\n      this.cache[key].waitingCallbacks.length = 0; // empty array)\n    }\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    content: {\n      check: 'Object',\n      init: {}\n    },\n\n    title: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyTitle'\n    },\n\n    series: {\n      check: ['hour', 'day', 'week', 'month', 'year', 'fullday', 'custom'],\n      init: 'day'\n    },\n\n    seriesStart: {\n      check: 'String',\n      init: 'end-month'\n    },\n\n    seriesEnd: {\n      check: 'String',\n      init: 'now'\n    },\n\n    seriesResolution: {\n      check: 'Number',\n      init: 300\n    },\n\n    forceNowDatapoint: {\n      check: 'Boolean',\n      init: true\n    },\n\n    period: {\n      check: 'Number',\n      init: 1\n    },\n\n    legendInline: {\n      check: 'Boolean',\n      init: true\n    },\n\n    legendPopup: {\n      check: 'Boolean',\n      init: true\n    },\n\n    legendposition: {\n      check: ['nw', 'ne', 'sw', 'se'],\n      init: 'ne'\n    },\n\n    timeformat: {\n      check: 'String',\n      nullable: true\n    },\n\n    timeformatTooltip: {\n      check: 'String',\n      init: '%d.%m.%Y %H:%M'\n    },\n\n    zoomYAxis: {\n      check: 'Boolean',\n      init: false\n    },\n\n    gridcolor: {\n      check: 'String',\n      init: '#81664B'\n    },\n\n    previewlabels: {\n      check: 'Boolean',\n      init: false\n    },\n\n    popup: {\n      check: 'Boolean',\n      init: false\n    },\n\n    tooltip: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    _init: null,\n    popupplot: null,\n    plot: null,\n    plotted: null,\n    _timerPopup: null,\n    __isPopup: false,\n\n    // property apply\n    _applyTitle(value) {\n      if (value) {\n        // override label\n        this.setLabel('<div class=\"label\">' + value + '</div>');\n      }\n    },\n\n    _setupRefreshAction() {\n      if (this.getRefresh()) {\n        if (!this._timer) {\n          this._timer = new qx.event.Timer(this.getRefresh());\n          this._timer.addListener('interval', () => {\n            this.loadDiagramData(this.plot, false, true);\n          });\n        }\n\n        if (!this._timerPopup) {\n          this._timerPopup = new qx.event.Timer(this.getRefresh());\n          this._timerPopup.addListener('interval', () => {\n            this.loadDiagramData(this.popupplot, false, true);\n          });\n        }\n      }\n    },\n\n    /**\n     * Stop the refresh timer\n     *\n     * @param timer {qx.event.Timer} stop this timer\n     * @protected\n     */\n    _stopRefresh(timer) {\n      if (timer && timer.isEnabled()) {\n        timer.stop();\n      }\n    },\n\n    /**\n     * Start the refresh timer\n     *\n     * @param timer {qx.event.Timer} start this timer\n     * @param runImmediately {Boolean} fire the timers 'interval' event immediately to trigger an refresh right now\n     * @protected\n     */\n    _startRefresh(timer, runImmediately) {\n      if (timer) {\n        if (!timer.isEnabled()) {\n          timer.start();\n        }\n        if (runImmediately === true) {\n          timer.fireEvent('interval');\n        }\n      }\n    },\n\n    _action() {\n      const popupDiagram = qx.dom.Element.create('div', {\n        class: 'diagram',\n        id: this.getPath() + '_big',\n        style: 'height: 90%'\n      });\n\n      this._init = true;\n      const popup = cv.ui.PopupHandler.showPopup('diagram', {\n        title: this.getLabel(),\n        content: popupDiagram,\n        page: this.getParentPage().getPath()\n      });\n\n      // this will be called when the popup is being closed.\n      // NOTE: this will be called twice, one time for the foreground and one\n      //       time for the background.\n      popup.addListener('close', () => {\n        this._stopRefresh(this._timerPopup);\n        qx.event.Registration.removeAllListeners(popupDiagram);\n        if (this.popupplot) {\n          this.popupplot.shutdown();\n          this.popupplot = null;\n        }\n      });\n\n      const parent = popupDiagram.parentNode;\n      Object.entries({ height: '100%', width: '95%', margin: 'auto' }).forEach(function (key_value) {\n        parent.style[key_value[0]] = key_value[1];\n      });\n\n      // define parent as 100%!\n      popupDiagram.innerHTML = '';\n      qx.event.Registration.addListener(\n        popupDiagram,\n        'tap',\n        function (event) {\n          // don't let the popup know about the click, or it will close\n          event.stopPropagation();\n        },\n        this\n      );\n\n      this.initDiagram(true);\n\n      this._startRefresh(this._timerPopup, true);\n    },\n\n    initDiagram(isPopup) {\n      if (!this._init) {\n        return;\n      }\n      this._init = false;\n      isPopup = isPopup || this.__isPopup;\n\n      const options = {\n        canvas: true,\n        tooltip: this.getTooltip(),\n        tooltipOpts: {\n          content: '<center>%x<br/>%y</center>',\n          xDateFormat: this.getTimeformatTooltip(),\n          shifts: {\n            x: 20,\n            y: 10\n          },\n\n          defaultTheme: false\n        },\n\n        zoom: {\n          interactive: isPopup,\n          trigger: 'dblclick',\n          amount: 1.5\n        },\n\n        pan: {\n          interactive: isPopup,\n          cursor: 'move',\n          frameRate: 20,\n          triggerOnDrag: false\n        },\n\n        yaxes: JSON.parse(JSON.stringify(this.getContent().axes)), // deep copy to prevent side effects\n        xaxes: [\n          {\n            mode: 'time',\n            timeformat: this.getTimeformat()\n          }\n        ],\n\n        legend: {\n          show: (isPopup && this.isLegendPopup()) || (!isPopup && this.isLegendInline()),\n          backgroundColor: '#101010',\n          position: this.getLegendposition()\n        },\n\n        grid: {\n          show: true,\n          aboveData: false,\n          color: this.getGridcolor(),\n          backgroundColor: '#000000',\n          tickColor: this.getGridcolor(),\n          markingsColor: this.getGridcolor(),\n          borderColor: this.getGridcolor(),\n          hoverable: true\n        },\n\n        touch: {\n          pan: isPopup ? 'x' : 'none', // what axis pan work\n          scale: isPopup ? 'x' : 'none', // what axis zoom work\n          autoWidth: false,\n          autoHeight: false,\n          delayTouchEnded: 500, // delay in ms before touchended event is fired if no more touches\n          callback: null, // other plot draw callback\n          simulClick: true, // plugin will generate Mouse click event to brwoser on tap or double tap\n          tapThreshold: 150, // range of time where a tap event could be detected\n          dbltapThreshold: 200, // delay needed to detect a double tap\n          tapPrecision: 60 / 2 // tap events boundaries ( 60px square by default )\n        }\n      };\n\n      options.yaxes.forEach(function (val) {\n        Object.assign(val, {\n          axisLabelColour: this.getGridcolor(),\n          color: this.getGridcolor()\n        });\n      }, this);\n      options.xaxes.forEach(function (val) {\n        Object.assign(val, {\n          axisLabelColour: this.getGridcolor(),\n          color: this.getGridcolor()\n        });\n      }, this);\n      if (isPopup) {\n        Object.assign(options, {\n          yaxis: {\n            isPopup: true,\n            zoomRange: this.getZoomYAxis() ? [null, null] : false\n          },\n\n          xaxis: {\n            zoomRange: [null, null],\n            panRange: [null, null]\n          }\n        });\n      }\n      if (this.getTooltip()) {\n        options.grid.hoverable = true;\n        options.grid.clickable = true;\n      }\n\n      if (!isPopup && !this.getPreviewlabels()) {\n        Object.assign(options, {\n          xaxes: [{ ticks: 0, mode: options.xaxes[0].mode }]\n        });\n\n        if (options.yaxes.length === 0) {\n          options.yaxes[0] = {};\n        }\n        options.yaxes.forEach(function (val) {\n          Object.assign(val, { ticks: 0, axisLabel: null });\n        }, this);\n      }\n\n      // plot diagram initially with empty values\n      const diagram = isPopup ? $('#' + this.getPath() + '_big') : $('#' + this.getPath() + ' .actor div');\n      diagram.empty();\n      const plot = $.plot(diagram, [], options);\n      if (isPopup) {\n        this.debug('popup plot generated');\n        this.popupplot = plot;\n      } else {\n        this.debug('plot generated');\n        this.plot = plot;\n      }\n      this.plotted = true;\n\n      const that = this;\n      diagram\n        .bind('plotpan', function (event, plot) {\n          that._debouncedLoadDiagramData(plot, isPopup, false);\n        })\n        .bind('plotzoom', function () {\n          that.loadDiagramData(plot, isPopup, false);\n        })\n        .bind('touchended', function () {\n          that.loadDiagramData(plot, isPopup, false);\n        })\n        .bind('tap', function () {\n          const self = this;\n          const container = $(self).closest('.widget_container')[0];\n          if (!isPopup && container !== undefined) {\n            const actor = $(self).closest('.actor')[0];\n            const path = container.id;\n            if (actor !== undefined && path.length > 0) {\n              that.action();\n            }\n          }\n        });\n\n      if (!isPopup) {\n        // disable touch plugin in non-popup\n        plot.getPlaceholder().unbind('touchstart').unbind('touchmove').unbind('touchend');\n      }\n\n      this.loadDiagramData(plot, isPopup, false);\n    },\n\n    getSeriesSettings(xAxis, isInteractive) {\n      const series = {\n        hour: { res: 60, start: 'hour', end: 'now' },\n        day: { res: 300, start: 'day', end: 'now' },\n        fullday: { res: 300, start: 'day', end: 'midnight+24hour' },\n        week: { res: 1800, start: 'week', end: 'now' },\n        month: { res: 21600, start: 'month', end: 'now' },\n        year: { res: 432000, start: 'year', end: 'now' }\n      };\n\n      const ret = {\n        start: null,\n        end: null,\n        res: null\n      };\n\n      if (this.getSeries() === 'custom') {\n        // initial load, take parameters from custom configuration\n        ret.start = this.getSeriesStart();\n        ret.end = this.getSeriesEnd();\n        ret.res = this.getSeriesResolution();\n      } else {\n        const selectedSeries = series[this.getSeries()];\n        if (!selectedSeries) {\n          return null;\n        }\n\n        // initial load, take parameters from configuration\n        ret.start = 'end-' + this.getPeriod() + selectedSeries.start;\n        ret.end = selectedSeries.end;\n        ret.res = this.getSeriesResolution() ? this.getSeriesResolution() : selectedSeries.res;\n      }\n\n      if (xAxis.datamin && xAxis.datamax && isInteractive) {\n        ret.start = (xAxis.min / 1000).toFixed(0);\n      }\n      return ret;\n    },\n\n    loadDiagramData(plot, isInteractive, forceReload) {\n      if (!plot) {\n        return;\n      }\n      const series = this.getSeriesSettings(plot.getAxes().xaxis, isInteractive);\n\n      if (!series) {\n        return;\n      }\n\n      // init\n      let loadedData = [];\n      let tsloaded = 0;\n      let tsSuccessful = 0;\n      // get all time series data\n      this.getContent().ts.forEach(function (ts, index) {\n        const res = Number.isFinite(ts.resol) ? ts.resol : series.res;\n        const forceNowDatapoint = this.getForceNowDatapoint();\n        const refresh = this.getRefresh() ? this.getRefresh() : res;\n\n        cv.plugins.diagram.AbstractDiagram.lookupTsCache(\n          ts,\n          series.start,\n          series.end,\n          res,\n          forceNowDatapoint,\n          refresh,\n          forceReload,\n          function (tsdata) {\n            tsloaded++;\n            if (tsdata !== null) {\n              tsSuccessful++;\n\n              // store the data for diagram plotting\n              loadedData[index] = {\n                label: ts.label,\n                color: ts.color,\n                data: tsdata,\n                yaxis: parseInt(ts.axisIndex),\n                bars: {\n                  show: ts.style === 'bars',\n                  fill: ts.fill,\n                  barWidth: parseInt(ts.barWidth),\n                  align: ts.align\n                },\n\n                lines: {\n                  show: ts.style === 'lines',\n                  steps: ts.steps,\n                  fill: ts.fill,\n                  zero: false\n                },\n\n                points: { show: ts.style === 'points', fill: ts.fill }\n              };\n            }\n\n            // if loading has finished, i.e. all time series have been retrieved,\n            // go on and plot the diagram\n            if (tsloaded === this.getContent().tsnum) {\n              let fulldata;\n              // If all time series were successfully loaded, no extra action is needed.\n              // Otherwise we need to reduce the array to the loaded data.\n              if (tsSuccessful === tsloaded) {\n                fulldata = loadedData;\n              } else {\n                fulldata = [];\n                let loadedIndex = -1;\n                for (let j = 0; j < tsSuccessful; j++) {\n                  for (let k = loadedIndex + 1; k < loadedData.length; k++) {\n                    if (loadedData[k] !== null) {\n                      fulldata[j] = loadedData[k];\n                      loadedIndex = k;\n                      break;\n                    }\n                  }\n                }\n              }\n\n              // plot\n              plot.setData(fulldata);\n              plot.setupGrid();\n              plot.draw();\n\n              loadedData = [];\n            }\n          }.bind(this)\n        );\n      }, this);\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct() {\n    if (this._timerPopup) {\n      this._disposeObjects('_timerPopup');\n    }\n  },\n\n  defer() {\n    const loader = cv.util.ScriptLoader.getInstance();\n    loader.addScripts(\n      [\n        'plugins/diagram/dep/flot/jquery.flot.min.js',\n        'plugins/diagram/dep/flot/jquery.flot.touch.min.js',\n        'plugins/diagram/dep/flot/jquery.flot.canvas.min.js',\n        'plugins/diagram/dep/flot/jquery.flot.resize.min.js',\n        'plugins/diagram/dep/flot/jquery.flot.time.min.js',\n        'plugins/diagram/dep/flot/jquery.flot.axislabels.js',\n        'plugins/diagram/dep/flot/jquery.flot.tooltip.min.js',\n        'plugins/diagram/dep/flot/jquery.flot.navigate.min.js'\n      ],\n\n      [0]\n    );\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAS,CAACC,oBAAoB,CAACC,aAAa,CAAC;EAAhD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACAH,EAAE,CAACI,KAAK,CAACC,MAAM,CAAC,oCAAoC,EAAE;IACpDC,MAAM,EAAEC,EAAE,CAACC,EAAE,CAACC,SAAS,CAACC,IAAI,CAACC,cAAc;IAC3CC,OAAO,EAAE,CAACL,EAAE,CAACC,EAAE,CAACK,MAAM,CAACC,OAAO,EAAEP,EAAE,CAACC,EAAE,CAACK,MAAM,CAACE,OAAO,CAAC;IACrDC,IAAI,EAAE,UAAU;IAEhB;AACF;AACA;AACA;AACA;IACEC,SAAS,qBAACC,KAAK,EAAE;MACf,2DAAMA,KAAK;MACX,IAAI,CAACC,yBAAyB,GAAGnB,EAAE,CAACoB,IAAI,CAACC,QAAQ,CAACC,QAAQ,CAAC,IAAI,CAACC,eAAe,CAACC,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC;IAClG,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACPC,KAAK,EAAE,CAAC,CAAC;MACT;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACIC,KAAK,iBAACC,GAAG,EAAEC,IAAI,EAAEC,OAAO,EAAEC,QAAQ,EAAEC,QAAQ,EAAE;QAC5C,IAAIA,QAAQ,EAAE;UACZA,QAAQ,GAAGC,MAAM,CAACC,MAAM,CAACF,QAAQ,EAAE,IAAI,CAACG,8BAA8B,EAAE,CAAC;QAC3E,CAAC,MAAM;UACLH,QAAQ,GAAG,IAAI,CAACG,8BAA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"
}