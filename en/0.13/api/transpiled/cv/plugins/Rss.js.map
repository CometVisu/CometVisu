{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "pure",
    "AbstractWidget",
    "include",
    "common",
    "Refresh",
    "statics",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "data",
    "parser",
    "WidgetParser",
    "parseElement",
    "getAttributeToPropertyMappings",
    "parseRefresh",
    "src",
    "width",
    "height",
    "limit",
    "header",
    "date",
    "content",
    "snippet",
    "showerror",
    "ssl",
    "linktarget",
    "link",
    "title",
    "properties",
    "check",
    "init",
    "members",
    "_parser",
    "_getInnerDomString",
    "rssstyle",
    "getWidth",
    "getHeight",
    "_onDomReady",
    "RSSParser",
    "refreshRSS",
    "_setupRefreshAction",
    "_timer",
    "event",
    "Timer",
    "getRefresh",
    "addListener",
    "start",
    "parseURL",
    "getSrc",
    "err",
    "feed",
    "actor",
    "getActor",
    "target",
    "querySelector",
    "error",
    "getShowerror",
    "textContent",
    "getHeader",
    "headline",
    "document",
    "createElement",
    "insertBefore",
    "firstElementChild",
    "elements",
    "querySelectorAll",
    "i",
    "length",
    "items",
    "remove",
    "useLink",
    "getLink",
    "showContent",
    "getContent",
    "showDate",
    "getDate",
    "some",
    "entry",
    "elem",
    "a",
    "setAttribute",
    "getLinktarget",
    "appendChild",
    "classList",
    "add",
    "innerHTML",
    "getSnippet",
    "contentSnippet",
    "innerText",
    "Date",
    "isoDate",
    "toLocaleString",
    "getLimit",
    "destruct",
    "defer",
    "loader",
    "util",
    "ScriptLoader",
    "getInstance",
    "addScripts",
    "addHandler",
    "plugins",
    "Rss",
    "WidgetFactory",
    "registerClass"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/Rss.js"
  ],
  "sourcesContent": [
    "/* Rss.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * This plugins displays RSS-Feeds in the CometVisu.\n *\n * <pre class=\"sunlight-highlight-xml\">\n *   &lt;rss src=&quot;/visu/plugins/rss/rsslog.php&quot; refresh=&quot;300&quot; link=&quot;false&quot; title=&quot;false&quot;&gt;&lt;/rss&gt;\n *   &lt;rss src=&quot;http://www.tagesschau.de/xml/rss2&quot; refresh=&quot;300&quot;&gt;Test API&lt;/rss&gt;\n *   &lt;rss src=&quot;/visu/plugins/rss/tagesschau-rss2.xml&quot; refresh=&quot;300&quot; header=&quot;true&quot; date=&quot;true&quot;&gt;&lt;/rss&gt;\n * </pre>\n *\n * @author Michael Markstaller\n * @since 2011\n * @ignore(RSSParser)\n * @asset(plugins/rss/rss-parser.min.js)\n */\nqx.Class.define('cv.plugins.Rss', {\n  extend: cv.ui.structure.pure.AbstractWidget,\n  include: [cv.ui.common.Refresh],\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse(xml, path, flavour, pageType) {\n      const data = cv.parser.pure.WidgetParser.parseElement(\n        this,\n        xml,\n        path,\n        flavour,\n        pageType,\n        this.getAttributeToPropertyMappings()\n      );\n\n      cv.parser.pure.WidgetParser.parseRefresh(xml, path);\n      return data;\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        src: {},\n        width: { default: '' },\n        height: { default: '' },\n        limit: { default: 10 },\n        header: { default: true },\n        date: { default: true },\n        content: { default: true },\n        snippet: { default: true },\n        showerror: { default: true },\n        ssl: { default: false },\n        linktarget: { default: '_new' },\n        link: { default: true },\n        title: { default: true }\n      };\n    }\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    src: { check: 'String', init: '' },\n    width: { init: '' },\n    height: { init: '' },\n    limit: { init: 10 },\n    header: { init: true },\n    date: { init: true },\n    content: { init: true },\n    snippet: { init: true },\n    showerror: { init: true },\n    ssl: { init: false },\n    linktarget: { init: '_new' },\n    link: { init: true },\n    title: { init: true }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    _parser: null,\n\n    _getInnerDomString() {\n      const rssstyle =\n        '' + this.getWidth() ? 'width:' + this.getWidth() : '' + this.getHeight() ? 'height:' + this.getHeight() : '';\n      return '<div class=\"actor\"><ul class=\"rss_inline\" style=\"' + rssstyle + '\"></ul>';\n    },\n\n    _onDomReady() {\n      super._onDomReady();\n      this._parser = new RSSParser();\n      this.refreshRSS();\n    },\n\n    _setupRefreshAction() {\n      this._timer = new qx.event.Timer(this.getRefresh());\n      this._timer.addListener('interval', () => {\n        this.refreshRSS();\n      });\n      this._timer.start();\n    },\n\n    refreshRSS() {\n      this._parser.parseURL(this.getSrc(), (err, feed) => {\n        const actor = this.getActor();\n        let target = actor.querySelector('.rss_inline');\n        if (err) {\n          this.error(err);\n          if (this.getShowerror()) {\n            target.textContent = 'ERROR: ' + err;\n          }\n          return;\n        }\n        if (this.getHeader()) {\n          let headline = actor.querySelector(':scope > h3');\n          if (!headline) {\n            headline = document.createElement('h3');\n            actor.insertBefore(headline, actor.firstElementChild);\n          }\n          headline.textContent = feed.title;\n        }\n\n        const elements = target.querySelectorAll(':scope > li');\n        for (let i = elements.length; i >= feed.items.length; i--) {\n          elements[i].remove();\n        }\n\n        const useLink = this.getLink();\n        const showContent = this.getContent();\n        const showDate = this.getDate();\n\n        feed.items.some((entry, i) => {\n          let elem = target.querySelector(':scope > li[data-row=\"' + i + '\"]');\n          let a;\n          let content;\n          let date;\n          if (!elem) {\n            elem = document.createElement('li');\n            if (useLink) {\n              a = document.createElement('a');\n              a.setAttribute('target', this.getLinktarget());\n              elem.appendChild(a);\n            }\n            if (showContent) {\n              content = document.createElement('p');\n              content.classList.add('content');\n              elem.appendChild(content);\n            }\n            if (showDate) {\n              date = document.createElement('p');\n              date.classList.add('date');\n              elem.appendChild(date);\n            }\n            elem.setAttribute('data-row', '' + i);\n            target.appendChild(elem);\n          } else {\n            if (useLink) {\n              a = elem.querySelector(':scope > a');\n            }\n            if (showContent) {\n              content = elem.querySelector(':scope > p.content');\n            }\n            if (showDate) {\n              date = elem.querySelector(':scope > p.date');\n            }\n          }\n          if (useLink) {\n            a.textContent = entry.title;\n            a.setAttribute('href', entry.link);\n          } else {\n            elem.textContent = entry.title;\n          }\n          if (showContent) {\n            content.innerHTML = this.getSnippet() ? entry.contentSnippet : entry.content;\n          }\n          if (showDate) {\n            date.innerText = new Date(entry.isoDate).toLocaleString();\n          }\n          return i >= this.getLimit();\n        });\n      });\n    }\n  },\n\n  destruct() {\n    this._parser = null;\n  },\n\n  defer(statics) {\n    const loader = cv.util.ScriptLoader.getInstance();\n    loader.addScripts('plugins/rss/rss-parser.min.js');\n    cv.parser.pure.WidgetParser.addHandler('rss', cv.plugins.Rss);\n    cv.ui.structure.WidgetFactory.registerClass('rss', statics);\n  }\n});\n"
  ],
  "mappings": "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"
}