{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/Rss.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "AbstractWidget",
    "include",
    "common",
    "Refresh",
    "statics",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "data",
    "parser",
    "WidgetParser",
    "parseElement",
    "getAttributeToPropertyMappings",
    "parseRefresh",
    "properties",
    "src",
    "check",
    "init",
    "members",
    "_parser",
    "_getInnerDomString",
    "rssstyle",
    "getWidth",
    "getHeight",
    "_onDomReady",
    "RSSParser",
    "refreshRSS",
    "_setupRefreshAction",
    "_timer",
    "event",
    "Timer",
    "getRefresh",
    "addListener",
    "start",
    "parseURL",
    "getSrc",
    "err",
    "feed",
    "actor",
    "getActor",
    "target",
    "querySelector",
    "error",
    "getShowerror",
    "textContent",
    "getHeader",
    "headline",
    "document",
    "createElement",
    "insertBefore",
    "firstElementChild",
    "title",
    "elements",
    "querySelectorAll",
    "i",
    "length",
    "items",
    "remove",
    "useLink",
    "getLink",
    "showContent",
    "getContent",
    "showDate",
    "getDate",
    "some",
    "entry",
    "elem",
    "a",
    "content",
    "date",
    "setAttribute",
    "getLinktarget",
    "appendChild",
    "classList",
    "add",
    "link",
    "innerHTML",
    "getSnippet",
    "contentSnippet",
    "innerText",
    "Date",
    "isoDate",
    "toLocaleString",
    "getLimit",
    "destruct",
    "defer",
    "loader",
    "util",
    "ScriptLoader",
    "getInstance",
    "addScripts",
    "addHandler",
    "plugins",
    "Rss",
    "WidgetFactory",
    "registerClass"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Rss.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This plugins displays RSS-Feeds in the CometVisu.\n *\n * <pre class=\"sunlight-highlight-xml\">\n *   &lt;rss src=&quot;/visu/plugins/rss/rsslog.php&quot; refresh=&quot;300&quot; link=&quot;false&quot; title=&quot;false&quot;&gt;&lt;/rss&gt;\n *   &lt;rss src=&quot;http://www.tagesschau.de/xml/rss2&quot; refresh=&quot;300&quot;&gt;Test API&lt;/rss&gt;\n *   &lt;rss src=&quot;/visu/plugins/rss/tagesschau-rss2.xml&quot; refresh=&quot;300&quot; header=&quot;true&quot; date=&quot;true&quot;&gt;&lt;/rss&gt;\n * </pre>\n *\n * @author Michael Markstaller\n * @since 2011\n * @ignore(RSSParser)\n * @asset(plugins/rss/rss-parser.min.js)\n */\nqx.Class.define('cv.plugins.Rss', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Refresh],\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse: function (xml, path, flavour, pageType) {\n      const data = cv.parser.WidgetParser.parseElement(this, xml, path, flavour, pageType, this.getAttributeToPropertyMappings());\n      cv.parser.WidgetParser.parseRefresh(xml, path);\n      return data;\n    },\n\n    getAttributeToPropertyMappings: function() {\n      return {\n        'src': {},\n        'width': { 'default': '' },\n        'height': { 'default': '' },\n        'limit': { 'default': 10 },\n        'header': { 'default': true },\n        'date': { 'default': true },\n        'content': { 'default': true },\n        'snippet': { 'default': true },\n        'showerror': { 'default': true },\n        'ssl': { 'default': false },\n        'linktarget': { 'default': '_new' },\n        'link': { 'default': true },\n        'title': { 'default': true }\n      };\n    }\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    src: { check: 'String', init: '' },\n    'width': { init: '' },\n    'height': { init: '' },\n    'limit': { init: 10 },\n    'header': { init: true },\n    'date': { init: true },\n    'content': { init: true },\n    'snippet': { init: true },\n    'showerror': { init: true },\n    'ssl': { init: false },\n    'linktarget': { init: '_new' },\n    'link': { init: true },\n    'title': { init: true }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    _parser: null,\n\n    _getInnerDomString: function () {\n      const rssstyle = '' +\n      this.getWidth() ? 'width:' + this.getWidth() : '' +\n      this.getHeight() ? 'height:' + this.getHeight() : '';\n      return '<div class=\"actor\"><ul class=\"rss_inline\" style=\"' + rssstyle + '\"></ul>';\n    },\n\n    _onDomReady: function () {\n      this.base(arguments);\n      this._parser = new RSSParser();\n      this.refreshRSS();\n    },\n\n    _setupRefreshAction: function() {\n      this._timer = new qx.event.Timer(this.getRefresh());\n      this._timer.addListener('interval', function () {\n        this.refreshRSS();\n      }, this);\n      this._timer.start();\n    },\n\n    refreshRSS: function () {\n      this._parser.parseURL(this.getSrc(), (err, feed) => {\n        const actor = this.getActor();\n        let target = actor.querySelector('.rss_inline');\n        if (err) {\n          this.error(err);\n          if (this.getShowerror()) {\n            target.textContent = 'ERROR: ' +err;\n          }\n          return;\n        }\n        if (this.getHeader()) {\n          let headline = actor.querySelector(':scope > h3');\n          if (!headline) {\n            headline = document.createElement('h3');\n            actor.insertBefore(headline, actor.firstElementChild);\n          }\n          headline.textContent = feed.title;\n        }\n\n        const elements = target.querySelectorAll(':scope > li');\n        for (let i = elements.length; i >= feed.items.length; i--) {\n          elements[i].remove();\n        }\n\n        const useLink = this.getLink();\n        const showContent = this.getContent();\n        const showDate = this.getDate();\n\n        feed.items.some((entry, i) => {\n          let elem = target.querySelector(':scope > li[data-row=\"'+i+'\"]');\n          let a;\n          let content;\n          let date;\n          if (!elem) {\n            elem = document.createElement('li');\n            if (useLink) {\n              a = document.createElement('a');\n              a.setAttribute('target', this.getLinktarget());\n              elem.appendChild(a);\n            }\n            if (showContent) {\n              content = document.createElement('p');\n              content.classList.add('content');\n              elem.appendChild(content);\n            }\n            if (showDate) {\n              date = document.createElement('p');\n              date.classList.add('date');\n              elem.appendChild(date);\n            }\n            elem.setAttribute('data-row', ''+i);\n            target.appendChild(elem);\n          } else {\n            if (useLink) {\n              a = elem.querySelector(':scope > a');\n            }\n            if (showContent) {\n              content = elem.querySelector(':scope > p.content');\n            }\n            if (showDate) {\n              date = elem.querySelector(':scope > p.date');\n            }\n          }\n          if (useLink) {\n            a.textContent = entry.title;\n            a.setAttribute('href', entry.link);\n          } else {\n            elem.textContent = entry.title;\n          }\n          if (showContent) {\n            content.innerHTML = this.getSnippet() ? entry.contentSnippet : entry.content;\n          }\n          if (showDate) {\n            date.innerText = new Date(entry.isoDate).toLocaleString();\n          }\n          return i >= this.getLimit();\n        });\n      });\n    }\n  },\n\n  destruct: function() {\n    this._parser = null;\n  },\n\n  defer: function(statics) {\n    const loader = cv.util.ScriptLoader.getInstance();\n    loader.addScripts('plugins/rss/rss-parser.min.js');\n    cv.parser.WidgetParser.addHandler('rss', cv.plugins.Rss);\n    cv.ui.structure.WidgetFactory.registerClass('rss', statics);\n  }\n});\n"
  ]
}