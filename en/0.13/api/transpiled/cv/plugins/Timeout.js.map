{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "pure",
    "AbstractBasicWidget",
    "construct",
    "props",
    "__timeoutIdleCount",
    "__initialize",
    "statics",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "parser",
    "WidgetParser",
    "parseElement",
    "getAttributeToPropertyMappings",
    "target",
    "time",
    "transform",
    "parseFloat",
    "debug",
    "value",
    "properties",
    "check",
    "init",
    "members",
    "__timeoutCurrentPage",
    "__timeoutCurrentPageTitle",
    "__timeoutTargetPage",
    "__timer",
    "isDebug",
    "getTime",
    "getTarget",
    "deltaT",
    "event",
    "Timer",
    "addListener",
    "timeoutTrigger",
    "start",
    "Registration",
    "window",
    "_onUserAction",
    "message",
    "Bus",
    "subscribe",
    "ev",
    "getData",
    "document",
    "querySelector",
    "innerText",
    "pageNavigationHandler",
    "Application",
    "structureController",
    "scrollToPage",
    "getCurrentPage",
    "getDomElement",
    "scrollTop",
    "destruct",
    "_disposeObjects",
    "defer",
    "addHandler",
    "plugins",
    "Timeout",
    "WidgetFactory",
    "registerClass"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/Timeout.js"
  ],
  "sourcesContent": [
    "/* Timeout.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * This plugins jumps back to a defined page after a given timeout period\n *\n * @author Carsten Tschach (Carsten@Tschach.com)\n * @since 2012\n */\nqx.Class.define('cv.plugins.Timeout', {\n  extend: cv.ui.structure.pure.AbstractBasicWidget,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct(props) {\n    super(props);\n    this.__timeoutIdleCount = 0;\n    this.__initialize();\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse(xml, path, flavour, pageType) {\n      return cv.parser.pure.WidgetParser.parseElement(\n        this,\n        xml,\n        path,\n        flavour,\n        pageType,\n        this.getAttributeToPropertyMappings()\n      );\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        target: { default: 'id_' },\n        time: { default: 600, transform: parseFloat },\n        debug: {\n          default: false,\n          transform(value) {\n            return value === 'true';\n          }\n        }\n      };\n    }\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    target: {\n      check: 'String',\n      init: 'id_'\n    },\n\n    time: {\n      check: 'Number',\n      init: 600\n    },\n\n    debug: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __timeoutIdleCount: null,\n    __timeoutCurrentPage: null,\n    __timeoutCurrentPageTitle: null,\n    __timeoutTargetPage: null,\n    __timer: null,\n\n    __initialize() {\n      if (this.isDebug()) {\n        this.debug('Timeout Set to : ' + this.getTime());\n        this.debug('Target Page: ' + this.getTarget());\n      }\n\n      const deltaT = this.getTime() * 100;\n      this.__timer = new qx.event.Timer(deltaT);\n      this.__timer.addListener('interval', this.timeoutTrigger, this);\n      this.__timer.start();\n\n      // Reset Counter on every interaction\n      qx.event.Registration.addListener(window, 'useraction', this._onUserAction, this);\n\n      // Keep track of current page\n      qx.event.message.Bus.subscribe(\n        'path.pageChanged',\n        function (ev) {\n          const path = ev.getData();\n          this.__timeoutCurrentPage = path;\n          this.__timeoutCurrentPageTitle = document.querySelector('#' + path + ' div > h1').innerText;\n          this.__timeoutIdleCount = 0;\n          /* We could trun on and off the above binds if we are already on the right page\n        if (timeoutCurrentPage === timeoutTargetPage) {\n        console.log(\"XXXXXX TIMEOUT: Scrolled to Target Page: \" + path);\n        } else {\n        console.log(\"XXXXXX TIMEOUT: Scrolled to: \" + path + \" (\"+timeoutTargetPage + \")\");\n        }\n        */\n        },\n        this\n      );\n    },\n\n    _onUserAction() {\n      this.__timeoutIdleCount = 0;\n    },\n\n    timeoutTrigger() {\n      if (this.isDebug()) {\n        this.debug('TIMEOUT: Got Trigger (' + this.__timeoutIdleCount + ')');\n      }\n      this.__timeoutIdleCount++;\n      this.__timeoutTargetPage = this.getTarget();\n      if (this.__timeoutIdleCount >= 10) {\n        this.__timeoutIdleCount = 0;\n        const pageNavigationHandler = cv.Application.structureController;\n\n        if (\n          this.__timeoutCurrentPage !== this.__timeoutTargetPage &&\n          this.__timeoutCurrentPageTitle !== this.__timeoutTargetPage\n        ) {\n          if (this.isDebug()) {\n            this.debug('TIMEOUT: Got Timeout - Now Goto Page ' + this.__timeoutTargetPage);\n          }\n          pageNavigationHandler.scrollToPage(this.__timeoutTargetPage);\n          pageNavigationHandler.getCurrentPage().getDomElement().scrollTop = 0;\n          //templateEngine.updateTopNavigation();\n        } else {\n          if (this.isDebug()) {\n            this.debug('TIMEOUT: Already on page ' + this.__timeoutTargetPage);\n          }\n          pageNavigationHandler.getCurrentPage().getDomElement().scrollTop = 0;\n        }\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct() {\n    this._disposeObjects('__timer');\n  },\n\n  defer(statics) {\n    cv.parser.pure.WidgetParser.addHandler('timeout', cv.plugins.Timeout);\n    cv.ui.structure.WidgetFactory.registerClass('timeout', statics);\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;EAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;AACA;AACA;AACA;EACAH,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,oBAAhB,EAAsC;IACpCC,MAAM,EAAEC,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBC,IAAhB,CAAqBC,mBADO;;IAGpC;AACF;AACA;AACA;AACA;IACEC,SARoC,qBAQ1BC,KAR0B,EAQnB;MACf,gEAAMA,KAAN;MACA,KAAKC,QAAL,GAA0B,CAA1B;;MACA,KAAKC,QAAL;IACD,CAZmC;;IAcpC;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACIC,KAXO,iBAWDC,GAXC,EAWIC,IAXJ,EAWUC,OAXV,EAWmBC,QAXnB,EAW6B;QAClC,OAAOd,EAAE,CAACe,MAAH,CAAUZ,IAAV,CAAea,YAAf,CAA4BC,YAA5B,CACL,IADK,EAELN,GAFK,EAGLC,IAHK,EAILC,OAJK,EAKLC,QALK,EAML,KAAKI,8BAAL,EANK,CAAP;MAQD,CApBM;MAsBPA,8BAtBO,4CAsB0B;QAC/B,OAAO;UACLC,MAAM,EAAE;YAAE,WAAS;UAAX,CADH;UAELC,IAAI,EAAE;YAAE,WAAS,GAAX;YAAgBC,SAAS,EAAEC;UAA3B,CAFD;UAGLC,KAAK,EAAE;YACL,WAAS,KADJ;YAELF,SAFK,qBAEKG,KAFL,EAEY;cACf,OAAOA,KAAK,KAAK,MAAjB;YACD;UAJI;QAHF,CAAP;MAUD;IAjCM,CAnB2B;;IAuDpC;AACF;AACA;AACA;AACA;IACEC,UAAU,EAAE;MACVN,MAAM,EAAE;QACNO,KAAK,EAAE,QADD;QAENC,IAAI,EAAE;MAFA,CADE;MAMVP,IAAI,EAAE;QACJM,KAAK,EAAE,QADH;QAEJC,IAAI,EAAE;MAFF,CANI;MAWVJ,KAAK,EAAE;QACLG,KAAK,EAAE,SADF;QAELC,IAAI,EAAE;MAFD;IAXG,CA5DwB;;IA6EpC;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACPrB,QAAkB,EAAE,IADb;MAEPsB,QAAoB,EAAE,IAFf;MAGPC,QAAyB,EAAE,IAHpB;MAIPC,QAAmB,EAAE,IAJd;MAKPC,QAAO,EAAE,IALF;MAOPxB,QAPO,sBAOQ;QACb,IAAI,KAAKyB,OAAL,EAAJ,EAAoB;UAClB,KAAKV,KAAL,CAAW,sBAAsB,KAAKW,OAAL,EAAjC;UACA,KAAKX,KAAL,CAAW,kBAAkB,KAAKY,SAAL,EAA7B;QACD;;QAED,IAAMC,MAAM,GAAG,KAAKF,OAAL,KAAiB,GAAhC;QACA,KAAKF,QAAL,GAAe,IAAIvC,EAAE,CAAC4C,KAAH,CAASC,KAAb,CAAmBF,MAAnB,CAAf;;QACA,KAAKJ,QAAL,CAAaO,WAAb,CAAyB,UAAzB,EAAqC,KAAKC,cAA1C,EAA0D,IAA1D;;QACA,KAAKR,QAAL,CAAaS,KAAb,GATa,CAWb;;;QACAhD,EAAE,CAAC4C,KAAH,CAASK,YAAT,CAAsBH,WAAtB,CAAkCI,MAAlC,EAA0C,YAA1C,EAAwD,KAAKC,aAA7D,EAA4E,IAA5E,EAZa,CAcb;;QACAnD,EAAE,CAAC4C,KAAH,CAASQ,OAAT,CAAiBC,GAAjB,CAAqBC,SAArB,CACE,kBADF,EAEE,UAAUC,EAAV,EAAc;UACZ,IAAMpC,IAAI,GAAGoC,EAAE,CAACC,OAAH,EAAb;UACA,KAAKpB,QAAL,GAA4BjB,IAA5B;UACA,KAAKkB,QAAL,GAAiCoB,QAAQ,CAACC,aAAT,CAAuB,MAAMvC,IAAN,GAAa,WAApC,EAAiDwC,SAAlF;UACA,KAAK7C,QAAL,GAA0B,CAA1B;UACA;AACV;AACA;AACA;AACA;AACA;AACA;QACS,CAdH,EAeE,IAfF;MAiBD,CAvCM;MAyCPqC,aAzCO,2BAyCS;QACd,KAAKrC,QAAL,GAA0B,CAA1B;MACD,CA3CM;MA6CPiC,cA7CO,4BA6CU;QACf,IAAI,KAAKP,OAAL,EAAJ,EAAoB;UAClB,KAAKV,KAAL,CAAW,2BAA2B,KAAKhB,QAAhC,GAAqD,GAAhE;QACD;;QACD,KAAKA,QAAL;QACA,KAAKwB,QAAL,GAA2B,KAAKI,SAAL,EAA3B;;QACA,IAAI,KAAK5B,QAAL,IAA2B,EAA/B,EAAmC;UACjC,KAAKA,QAAL,GAA0B,CAA1B;UACA,IAAM8C,qBAAqB,GAAGrD,EAAE,CAACsD,WAAH,CAAeC,mBAA7C;;UAEA,IACE,KAAK1B,QAAL,KAA8B,KAAKE,QAAnC,IACA,KAAKD,QAAL,KAAmC,KAAKC,QAF1C,EAGE;YACA,IAAI,KAAKE,OAAL,EAAJ,EAAoB;cAClB,KAAKV,KAAL,CAAW,0CAA0C,KAAKQ,QAA1D;YACD;;YACDsB,qBAAqB,CAACG,YAAtB,CAAmC,KAAKzB,QAAxC;YACAsB,qBAAqB,CAACI,cAAtB,GAAuCC,aAAvC,GAAuDC,SAAvD,GAAmE,CAAnE,CALA,CAMA;UACD,CAVD,MAUO;YACL,IAAI,KAAK1B,OAAL,EAAJ,EAAoB;cAClB,KAAKV,KAAL,CAAW,8BAA8B,KAAKQ,QAA9C;YACD;;YACDsB,qBAAqB,CAACI,cAAtB,GAAuCC,aAAvC,GAAuDC,SAAvD,GAAmE,CAAnE;UACD;QACF;MACF;IAxEM,CAlF2B;;IA6JpC;AACF;AACA;AACA;AACA;IACEC,QAlKoC,sBAkKzB;MACT,KAAKC,eAAL,CAAqB,UAArB;IACD,CApKmC;IAsKpCC,KAtKoC,iBAsK9BrD,OAtK8B,EAsKrB;MACbT,EAAE,CAACe,MAAH,CAAUZ,IAAV,CAAea,YAAf,CAA4B+C,UAA5B,CAAuC,SAAvC,EAAkD/D,EAAE,CAACgE,OAAH,CAAWC,OAA7D;MACAjE,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBgE,aAAhB,CAA8BC,aAA9B,CAA4C,SAA5C,EAAuD1D,OAAvD;IACD;EAzKmC,CAAtC;EAzBAT,EAAE,CAACgE,OAAH,CAAWC,OAAX,CAAmBrE,aAAnB,GAAmCA,aAAnC"
}