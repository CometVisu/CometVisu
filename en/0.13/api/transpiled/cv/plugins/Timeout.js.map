{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "pure",
    "AbstractBasicWidget",
    "construct",
    "props",
    "__timeoutIdleCount",
    "__initialize",
    "statics",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "parser",
    "WidgetParser",
    "parseElement",
    "getAttributeToPropertyMappings",
    "target",
    "time",
    "transform",
    "parseFloat",
    "debug",
    "value",
    "properties",
    "check",
    "init",
    "members",
    "__timeoutCurrentPage",
    "__timeoutCurrentPageTitle",
    "__timeoutTargetPage",
    "__timer",
    "isDebug",
    "getTime",
    "getTarget",
    "deltaT",
    "event",
    "Timer",
    "addListener",
    "timeoutTrigger",
    "start",
    "Registration",
    "window",
    "_onUserAction",
    "message",
    "Bus",
    "subscribe",
    "ev",
    "getData",
    "document",
    "querySelector",
    "innerText",
    "pageNavigationHandler",
    "Application",
    "structureController",
    "scrollToPage",
    "getCurrentPage",
    "getDomElement",
    "scrollTop",
    "destruct",
    "_disposeObjects",
    "defer",
    "addHandler",
    "plugins",
    "Timeout",
    "WidgetFactory",
    "registerClass"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/Timeout.js"
  ],
  "sourcesContent": [
    "/* Timeout.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * This plugins jumps back to a defined page after a given timeout period\n *\n * @author Carsten Tschach (Carsten@Tschach.com)\n * @since 2012\n */\nqx.Class.define('cv.plugins.Timeout', {\n  extend: cv.ui.structure.pure.AbstractBasicWidget,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct(props) {\n    super(props);\n    this.__timeoutIdleCount = 0;\n    this.__initialize();\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse(xml, path, flavour, pageType) {\n      return cv.parser.pure.WidgetParser.parseElement(\n        this,\n        xml,\n        path,\n        flavour,\n        pageType,\n        this.getAttributeToPropertyMappings()\n      );\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        target: { default: 'id_' },\n        time: { default: 600, transform: parseFloat },\n        debug: {\n          default: false,\n          transform(value) {\n            return value === 'true';\n          }\n        }\n      };\n    }\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    target: {\n      check: 'String',\n      init: 'id_'\n    },\n\n    time: {\n      check: 'Number',\n      init: 600\n    },\n\n    debug: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __timeoutIdleCount: null,\n    __timeoutCurrentPage: null,\n    __timeoutCurrentPageTitle: null,\n    __timeoutTargetPage: null,\n    __timer: null,\n\n    __initialize() {\n      if (this.isDebug()) {\n        this.debug('Timeout Set to : ' + this.getTime());\n        this.debug('Target Page: ' + this.getTarget());\n      }\n\n      const deltaT = this.getTime() * 100;\n      this.__timer = new qx.event.Timer(deltaT);\n      this.__timer.addListener('interval', this.timeoutTrigger, this);\n      this.__timer.start();\n\n      // Reset Counter on every interaction\n      qx.event.Registration.addListener(window, 'useraction', this._onUserAction, this);\n\n      // Keep track of current page\n      qx.event.message.Bus.subscribe(\n        'path.pageChanged',\n        function (ev) {\n          const path = ev.getData();\n          this.__timeoutCurrentPage = path;\n          this.__timeoutCurrentPageTitle = document.querySelector('#' + path + ' div > h1').innerText;\n          this.__timeoutIdleCount = 0;\n          /* We could trun on and off the above binds if we are already on the right page\n        if (timeoutCurrentPage === timeoutTargetPage) {\n        console.log(\"XXXXXX TIMEOUT: Scrolled to Target Page: \" + path);\n        } else {\n        console.log(\"XXXXXX TIMEOUT: Scrolled to: \" + path + \" (\"+timeoutTargetPage + \")\");\n        }\n        */\n        },\n        this\n      );\n    },\n\n    _onUserAction() {\n      this.__timeoutIdleCount = 0;\n    },\n\n    timeoutTrigger() {\n      if (this.isDebug()) {\n        this.debug('TIMEOUT: Got Trigger (' + this.__timeoutIdleCount + ')');\n      }\n      this.__timeoutIdleCount++;\n      this.__timeoutTargetPage = this.getTarget();\n      if (this.__timeoutIdleCount >= 10) {\n        this.__timeoutIdleCount = 0;\n        const pageNavigationHandler = cv.Application.structureController;\n\n        if (\n          this.__timeoutCurrentPage !== this.__timeoutTargetPage &&\n          this.__timeoutCurrentPageTitle !== this.__timeoutTargetPage\n        ) {\n          if (this.isDebug()) {\n            this.debug('TIMEOUT: Got Timeout - Now Goto Page ' + this.__timeoutTargetPage);\n          }\n          pageNavigationHandler.scrollToPage(this.__timeoutTargetPage);\n          pageNavigationHandler.getCurrentPage().getDomElement().scrollTop = 0;\n          //templateEngine.updateTopNavigation();\n        } else {\n          if (this.isDebug()) {\n            this.debug('TIMEOUT: Already on page ' + this.__timeoutTargetPage);\n          }\n          pageNavigationHandler.getCurrentPage().getDomElement().scrollTop = 0;\n        }\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct() {\n    this._disposeObjects('__timer');\n  },\n\n  defer(statics) {\n    cv.parser.pure.WidgetParser.addHandler('timeout', cv.plugins.Timeout);\n    cv.ui.structure.WidgetFactory.registerClass('timeout', statics);\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAS,CAACC,oBAAoB,CAACC,aAAa,CAAC;EAAhD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;AACA;AACA;AACA;EACAH,EAAE,CAACI,KAAK,CAACC,MAAM,CAAC,oBAAoB,EAAE;IACpCC,MAAM,EAAEC,EAAE,CAACC,EAAE,CAACC,SAAS,CAACC,IAAI,CAACC,mBAAmB;IAEhD;AACF;AACA;AACA;AACA;IACEC,SAAS,qBAACC,KAAK,EAAE;MACf,gEAAMA,KAAK;MACX,IAAI,CAACC,QAAkB,GAAG,CAAC;MAC3B,IAAI,CAACC,QAAY,EAAE;IACrB,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACIC,KAAK,iBAACC,GAAG,EAAEC,IAAI,EAAEC,OAAO,EAAEC,QAAQ,EAAE;QAClC,OAAOd,EAAE,CAACe,MAAM,CAACZ,IAAI,CAACa,YAAY,CAACC,YAAY,CAC7C,IAAI,EACJN,GAAG,EACHC,IAAI,EACJC,OAAO,EACPC,QAAQ,EACR,IAAI,CAACI,8BAA8B,EAAE,CACtC;MACH,CAAC;MAEDA,8BAA8B,4CAAG;QAC/B,OAAO;UACLC,MAAM,EAAE;YAAE,WAAS;UAAM,CAAC;UAC1BC,IAAI,EAAE;YAAE,WAAS,GAAG;YAAEC,SAAS,EAAEC;UAAW,CAAC;UAC7CC,KAAK,EAAE;YACL,WAAS,KAAK;YACdF,SAAS,qBAACG,KAAK,EAAE;cACf,OAAOA,KAAK,KAAK,MAAM;YACzB;UACF;QACF,CAAC;MACH;IACF,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,UAAU,EAAE;MACVN,MAAM,EAAE;QACNO,KAAK,EAAE,QAAQ;QACfC,IAAI,EAAE;MACR,CAAC;MAEDP,IAAI,EAAE;QACJM,KAAK,EAAE,QAAQ;QACfC,IAAI,EAAE;MACR,CAAC;MAEDJ,KAAK,EAAE;QACLG,KAAK,EAAE,SAAS;QAChBC,IAAI,EAAE;MACR;IACF,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACPrB,QAAkB,EAAE,IAAI;MACxBsB,QAAoB,EAAE,IAAI;MAC1BC,QAAyB,EAAE,IAAI;MAC/BC,QAAmB,EAAE,IAAI;MACzBC,QAAO,EAAE,IAAI;MAEbxB,QAAY,sBAAG;QACb,IAAI,IAAI,CAACyB,OAAO,EAAE,EAAE;UAClB,IAAI,CAACV,KAAK,CAAC,mBAAmB,GAAG,IAAI,CAACW,OAAO,EAAE,CAAC;UAChD,IAAI,CAACX,KAAK,CAAC,eAAe,GAAG,IAAI,CAACY,SAAS,EAAE,CAAC;QAChD;QAEA,IAAMC,MAAM,GAAG,IAAI,CAACF,OAAO,EAAE,GAAG,GAAG;QACnC,IAAI,CAACF,QAAO,GAAG,IAAIvC,EAAE,CAAC4C,KAAK,CAACC,KAAK,CAACF,MAAM,CAAC;QACzC,IAAI,CAACJ,QAAO,CAACO,WAAW,CAAC,UAAU,EAAE,IAAI,CAACC,cAAc,EAAE,IAAI,CAAC;QAC/D,IAAI,CAACR,QAAO,CAACS,KAAK,EAAE;;QAEpB;QACAhD,EAAE,CAAC4C,KAAK,CAACK,YAAY,CAACH,WAAW,CAACI,MAAM,EAAE,YAAY,EAAE,IAAI,CAACC,aAAa,EAAE,IAAI,CAAC;;QAEjF;QACAnD,EAAE,CAAC4C,KAAK,CAACQ,OAAO,CAACC,GAAG,CAACC,SAAS,CAC5B,kBAAkB,EAClB,UAAUC,EAAE,EAAE;UACZ,IAAMpC,IAAI,GAAGoC,EAAE,CAACC,OAAO,EAAE;UACzB,IAAI,CAACpB,QAAoB,GAAGjB,IAAI;UAChC,IAAI,CAACkB,QAAyB,GAAGoB,QAAQ,CAACC,aAAa,CAAC,GAAG,GAAGvC,IAAI,GAAG,WAAW,CAAC,CAACwC,SAAS;UAC3F,IAAI,CAAC7C,QAAkB,GAAG,CAAC;UAC3B;AACV;AACA;AACA;AACA;AACA;AACA;QACQ,CAAC,EACD,IAAI,CACL;MACH,CAAC;MAEDqC,aAAa,2BAAG;QACd,IAAI,CAACrC,QAAkB,GAAG,CAAC;MAC7B,CAAC;MAEDiC,cAAc,4BAAG;QACf,IAAI,IAAI,CAACP,OAAO,EAAE,EAAE;UAClB,IAAI,CAACV,KAAK,CAAC,wBAAwB,GAAG,IAAI,CAAChB,QAAkB,GAAG,GAAG,CAAC;QACtE;QACA,IAAI,CAACA,QAAkB,EAAE;QACzB,IAAI,CAACwB,QAAmB,GAAG,IAAI,CAACI,SAAS,EAAE;QAC3C,IAAI,IAAI,CAAC5B,QAAkB,IAAI,EAAE,EAAE;UACjC,IAAI,CAACA,QAAkB,GAAG,CAAC;UAC3B,IAAM8C,qBAAqB,GAAGrD,EAAE,CAACsD,WAAW,CAACC,mBAAmB;UAEhE,IACE,IAAI,CAAC1B,QAAoB,KAAK,IAAI,CAACE,QAAmB,IACtD,IAAI,CAACD,QAAyB,KAAK,IAAI,CAACC,QAAmB,EAC3D;YACA,IAAI,IAAI,CAACE,OAAO,EAAE,EAAE;cAClB,IAAI,CAACV,KAAK,CAAC,uCAAuC,GAAG,IAAI,CAACQ,QAAmB,CAAC;YAChF;YACAsB,qBAAqB,CAACG,YAAY,CAAC,IAAI,CAACzB,QAAmB,CAAC;YAC5DsB,qBAAqB,CAACI,cAAc,EAAE,CAACC,aAAa,EAAE,CAACC,SAAS,GAAG,CAAC;YACpE;UACF,CAAC,MAAM;YACL,IAAI,IAAI,CAAC1B,OAAO,EAAE,EAAE;cAClB,IAAI,CAACV,KAAK,CAAC,2BAA2B,GAAG,IAAI,CAACQ,QAAmB,CAAC;YACpE;YACAsB,qBAAqB,CAACI,cAAc,EAAE,CAACC,aAAa,EAAE,CAACC,SAAS,GAAG,CAAC;UACtE;QACF;MACF;IACF,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,QAAQ,sBAAG;MACT,IAAI,CAACC,eAAe,CAAC,UAAS,CAAC;IACjC,CAAC;IAEDC,KAAK,iBAACrD,OAAO,EAAE;MACbT,EAAE,CAACe,MAAM,CAACZ,IAAI,CAACa,YAAY,CAAC+C,UAAU,CAAC,SAAS,EAAE/D,EAAE,CAACgE,OAAO,CAACC,OAAO,CAAC;MACrEjE,EAAE,CAACC,EAAE,CAACC,SAAS,CAACgE,aAAa,CAACC,aAAa,CAAC,SAAS,EAAE1D,OAAO,CAAC;IACjE;EACF,CAAC,CAAC;EAnMFT,EAAE,CAACgE,OAAO,CAACC,OAAO,CAACrE,aAAa,GAAGA,aAAa;AAAC"
}