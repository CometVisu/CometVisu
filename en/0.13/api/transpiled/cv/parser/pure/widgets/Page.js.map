{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "statics",
    "parse",
    "page",
    "path",
    "flavour",
    "pageType",
    "storagePath",
    "cv",
    "parser",
    "pure",
    "WidgetParser",
    "getStoragePath",
    "addresses",
    "getAttribute",
    "src",
    "data",
    "Model",
    "getInstance",
    "addAddress",
    "READ",
    "name",
    "backdrop",
    "showtopnavigation",
    "showfooter",
    "shownavbar",
    "top",
    "bottom",
    "left",
    "right",
    "Array",
    "from",
    "children",
    "filter",
    "m",
    "matches",
    "forEach",
    "elem",
    "pos",
    "value",
    "bindClickToWidget",
    "Config",
    "configSettings",
    "wstyle",
    "layout",
    "parseLayout",
    "backdropType",
    "substring",
    "length",
    "setWidgetData",
    "showTopNavigation",
    "showFooter",
    "showNavbarTop",
    "showNavbarBottom",
    "showNavbarLeft",
    "showNavbarRight",
    "backdropAlign",
    "size",
    "address",
    "linkVisible",
    "$$type",
    "parseAddress",
    "parseFormat",
    "parseChildren",
    "linkData",
    "classes",
    "setWidgetLayout",
    "defer",
    "addHandler",
    "widgets",
    "Page"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/parser/pure/widgets/Page.js"
  ],
  "sourcesContent": [
    "/* Page.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.parser.pure.widgets.Page', {\n  type: 'static',\n\n  /*\n   ******************************************************\n   STATICS\n   ******************************************************\n   */\n  statics: {\n    parse(page, path, flavour, pageType) {\n      const storagePath = cv.parser.pure.WidgetParser.getStoragePath(page, path);\n\n      const addresses = {};\n      if (page.getAttribute('ga')) {\n        const src = page.getAttribute('ga');\n        cv.data.Model.getInstance().addAddress(src, storagePath);\n        addresses[src] = ['DPT:1.001', cv.data.Model.READ];\n      }\n\n      const name = page.getAttribute('name');\n      pageType = page.getAttribute('type') || 'text'; //text, 2d or 3d\n      const backdrop = page.getAttribute('backdrop');\n      const showtopnavigation = page.getAttribute('showtopnavigation')\n        ? page.getAttribute('showtopnavigation') === 'true'\n        : null;\n      const showfooter = page.getAttribute('showfooter') ? page.getAttribute('showfooter') === 'true' : true;\n      // make sure the type has the correct value as we need to use it ass CSS class\n      switch (pageType) {\n        case '2d':\n        case '3d':\n          // do nothing, type has correct value\n          break;\n        default:\n          pageType = 'text';\n          break;\n      }\n\n      // automatically set the navbars if not set in the config file\n      const shownavbar = {\n        top: path === 'id' ? false : null,\n        bottom: path === 'id' ? false : null,\n        left: path === 'id' ? false : null,\n        right: path === 'id' ? false : null\n      };\n\n      Array.from(page.children)\n        .filter(function (m) {\n          return m.matches('navbar');\n        })\n        .forEach(function (elem) {\n          shownavbar[elem.getAttribute('position') || 'left'] = true;\n        });\n      // overwrite default when set manually in the config\n      ['top', 'left', 'right', 'bottom'].forEach(function (pos) {\n        if (shownavbar[pos] !== null) {\n          // do not override current values\n          return;\n        }\n        const value = page.getAttribute('shownavbar-' + pos);\n        if (typeof value === 'string') {\n          shownavbar[pos] = value === 'true';\n        }\n      }, this);\n      let bindClickToWidget = cv.Config.configSettings.bindClickToWidget;\n      if (page.getAttribute('bind_click_to_widget')) {\n        bindClickToWidget = page.getAttribute('bind_click_to_widget') === 'true';\n      }\n      if (page.getAttribute('flavour')) {\n        flavour = page.getAttribute('flavour'); // sub design choice\n      }\n      let wstyle = ''; // widget style\n      if (page.getAttribute('align')) {\n        wstyle += 'text-align:' + page.getAttribute('align') + ';';\n      }\n      if (wstyle !== '') {\n        wstyle = 'style=\"' + wstyle + '\"';\n      }\n\n      const layout = cv.parser.pure.WidgetParser.parseLayout(\n        Array.from(page.children).filter(function (m) {\n          return m.matches('layout');\n        })[0]\n      );\n\n      let backdropType = null;\n      if (backdrop) {\n        backdropType = backdrop.substring(backdrop.length - 4) === '.svg' ? 'embed' : 'img';\n      }\n\n      const data = cv.data.Model.getInstance().setWidgetData(storagePath, {\n        path: storagePath,\n        name: name,\n        pageType: pageType,\n        showTopNavigation: showtopnavigation,\n        showFooter: showfooter,\n        showNavbarTop: shownavbar.top,\n        showNavbarBottom: shownavbar.bottom,\n        showNavbarLeft: shownavbar.left,\n        showNavbarRight: shownavbar.right,\n        backdropAlign: pageType === '2d' ? page.getAttribute('backdropalign') || '50% 50%' : null,\n        size: page.getAttribute('size') || null,\n        address: addresses,\n        linkVisible: page.getAttribute('visible') ? page.getAttribute('visible') === 'true' : true,\n        flavour: flavour || null,\n        $$type: 'page',\n        backdrop: backdrop || null,\n        backdropType: backdropType\n      });\n\n      cv.parser.pure.WidgetParser.parseAddress(page, path);\n      cv.parser.pure.WidgetParser.parseFormat(page, path);\n      // this has to be called manually to allow inheritance of the flavour, pageType values\n      cv.parser.pure.WidgetParser.parseChildren(page, path, flavour, pageType);\n      if (data.linkVisible === true) {\n        const linkData = cv.data.Model.getInstance().setWidgetData(path, {\n          $$type: 'pagelink',\n          path: path,\n          name: name,\n          classes: cv.parser.pure.WidgetParser.setWidgetLayout(page, path) || '',\n          layout: layout || null,\n          address: addresses,\n          pageType: pageType,\n          wstyle: wstyle || '',\n          bindClickToWidget: bindClickToWidget\n        });\n\n        return [data, linkData];\n      }\n      return data;\n    }\n  },\n\n  defer(statics) {\n    cv.parser.pure.WidgetParser.addHandler('page', statics);\n  }\n});\n"
  ],
  "mappings": "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"
}