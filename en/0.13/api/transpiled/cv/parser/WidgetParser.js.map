{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/parser/WidgetParser.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "statics",
    "__handlers",
    "lookupM",
    "lookupS",
    "model",
    "cv",
    "data",
    "Model",
    "getInstance",
    "__templates",
    "getTemplates",
    "addTemplate",
    "name",
    "templateData",
    "addHandler",
    "tagName",
    "handler",
    "toLowerCase",
    "getHandler",
    "unknown",
    "renderTemplates",
    "rootPage",
    "querySelectorAll",
    "forEach",
    "elem",
    "templateName",
    "getAttribute",
    "variables",
    "Array",
    "prototype",
    "call",
    "children",
    "variable",
    "innerHTML",
    "Object",
    "hasOwnProperty",
    "renderedString",
    "bom",
    "Template",
    "render",
    "replace",
    "trim",
    "helperNode",
    "ownerDocument",
    "createElement",
    "substring",
    "length",
    "replacement",
    "firstElementChild",
    "next",
    "nextElementSibling",
    "parent",
    "parentNode",
    "replaceChild",
    "insertBefore",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "tag",
    "nodeName",
    "parser",
    "result",
    "log",
    "Logger",
    "debug",
    "parseBasicElement",
    "element",
    "setWidgetData",
    "WidgetParser",
    "getElementType",
    "parseElement",
    "mappings",
    "createDefaultWidget",
    "key",
    "map",
    "value",
    "undefined",
    "transform",
    "target",
    "parseStyling",
    "__getAttributeToPropertyMappings",
    "getAttributeToPropertyMappings",
    "getDefaultClasses",
    "widgetType",
    "layout",
    "parseLayout",
    "from",
    "filter",
    "m",
    "matches",
    "style",
    "keys",
    "extractLayout",
    "classes",
    "setWidgetLayout",
    "split",
    "className",
    "label",
    "parseLabel",
    "querySelector",
    "bindClickToWidget",
    "TemplateEngine",
    "prop",
    "responsive",
    "find",
    "endsWith",
    "defaultValues",
    "ret_val",
    "__extractLayoutAttribute",
    "property",
    "x",
    "y",
    "width",
    "height",
    "extractLayout3d",
    "z",
    "floor",
    "floorFilter",
    "roomFilter",
    "labelClass",
    "childNodes",
    "nodeType",
    "Node",
    "ELEMENT_NODE",
    "IconHandler",
    "getIconText",
    "TEXT_NODE",
    "textContent",
    "elementData",
    "getWidgetData",
    "rowspan",
    "colspan",
    "Element",
    "getAttributeNS",
    "colspanM",
    "colspanS",
    "parseFloat",
    "document",
    "dataset",
    "Math",
    "rowspanClass",
    "ui",
    "Manager",
    "parseFormat",
    "format",
    "parseAddress",
    "makeAddressListFn",
    "address",
    "makeAddressList",
    "id",
    "skipAdding",
    "src",
    "addressInfo",
    "formatPos",
    "mode",
    "Config",
    "backend",
    "qos",
    "retain",
    "error",
    "outerHTML",
    "variantInfo",
    "addAddress",
    "parseRefresh",
    "doCacheControl",
    "refresh",
    "parseInt",
    "cachecontrol",
    "styling",
    "parseChildren",
    "getStoragePath",
    "childs",
    "child",
    "indexOf",
    "idx",
    "childData",
    "isArray",
    "i",
    "l",
    "push"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* WidgetParser.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n//noinspection JSUnusedGlobalSymbols\nqx.Class.define('cv.parser.WidgetParser', {\n  type: 'static',\n\n  /*\n   ******************************************************\n   STATICS\n   ******************************************************\n   */\n  statics: {\n    __handlers: {},\n    lookupM : [ 0, 2, 4, 6, 6, 6, 6, 12, 12, 12, 12, 12, 12 ],\n    lookupS : [ 0, 3, 6, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12 ],\n    model: cv.data.Model.getInstance(),\n    __templates: {},\n\n    getTemplates: function () {\n      return this.__templates;\n    },\n\n    addTemplate: function(name, templateData) {\n      this.__templates[name] = templateData;\n    },\n\n    addHandler: function (tagName, handler) {\n      this.__handlers[tagName.toLowerCase()] = handler;\n    },\n\n    getHandler: function (tagName) {\n      return this.__handlers[tagName.toLowerCase()] || this.__handlers.unknown;\n    },\n\n    /**\n     * Renders templates into the config file, if they are used\n     * @param rootPage\n     */\n    renderTemplates: function (rootPage) {\n      rootPage.querySelectorAll('template').forEach(function (elem) {\n        const templateName = elem.getAttribute('name');\n        const variables = {};\n        Array.prototype.forEach.call(elem.children, function (variable) {\n          variables[variable.getAttribute('name')] = variable.innerHTML;\n        });\n\n        if (Object.prototype.hasOwnProperty.call(this.__templates, templateName)) {\n          const renderedString = qx.bom.Template.render(this.__templates[templateName], variables).replace('\\n', '').trim();\n          const helperNode = elem.ownerDocument.createElement('template');\n          helperNode.innerHTML = renderedString.substring(6, renderedString.length - 7).trim();\n          // replace existing element with the rendered templates child\n          const replacement = helperNode.firstElementChild;\n          const next = elem.nextElementSibling;\n          const parent = elem.parentNode;\n          parent.replaceChild(replacement, elem);\n          while (helperNode.children.length > 0) {\n            // append the rest\n            parent.insertBefore(helperNode.children[0], next);\n          }\n        }\n      }, this);\n    },\n\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} widget data\n     */\n    parse: function (xml, path, flavour, pageType) {\n      let tag = xml.nodeName.toLowerCase();\n      if (tag === 'custom') {\n        // use the child of the custom element\n        xml = xml.children[0];\n        tag = xml.nodeName.toLowerCase();\n      }\n      const parser = this.getHandler(tag);\n      let result = null;\n      if (parser) {\n        result = parser.parse(xml, path, flavour, pageType);\n      } else {\n        qx.log.Logger.debug(this, 'no parse handler registered for type: '+ tag.toLowerCase());\n      }\n      return result;\n    },\n\n    parseBasicElement: function (element, path, flavour, pageType) {\n      return this.model.setWidgetData(path, {\n        'path': path,\n        '$$type': cv.parser.WidgetParser.getElementType(element),\n        'pageType': pageType\n      });\n    },\n\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     * @param handler {Class} Handler class that parses this element\n     * @param element {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @param mappings\n     * @return {Map} HTML code\n     */\n    parseElement: function (handler, element, path, flavour, pageType, mappings) {\n      // and fill in widget specific data\n      const data = this.createDefaultWidget(handler, this.getElementType(element), element, path, flavour, pageType);\n      if (mappings) {\n        for (let key in mappings) {\n          if (Object.prototype.hasOwnProperty.call(mappings, key)) {\n            const map = mappings[key];\n            let value = element.getAttribute(key);\n            if (map['default'] !== undefined && (value === undefined || value === null)) {\n              value = map['default'];\n            }\n            if (map.transform) {\n              value = map.transform(value);\n            }\n            data[map.target || key] = value;\n          }\n        }\n      }\n      this.parseStyling(element, path);\n      return data;\n    },\n\n    /**\n     * Get the mappings needed for parsing from the handler\n     *\n     * @param handler {Class} parser handler\n     * @return {Map} parser configuration: describes how Attributes are mapped to properties\n     */\n    __getAttributeToPropertyMappings: function(handler) {\n      return handler && handler.getAttributeToPropertyMappings ? handler.getAttributeToPropertyMappings() : {};\n    },\n\n    getElementType: function(element) {\n      let type = element.nodeName.toLowerCase();\n      if (type === 'img') {\n        // workaround for unittests (<image> gets replaced by <img>\n        type = 'image';\n      }\n      return type;\n    },\n\n    getDefaultClasses: function(type) {\n      return 'widget clearfix ' + type.toLowerCase();\n    },\n\n    /**\n     * Create a default widget to be filled by the creator afterwards.\n     * Note: the receiver of the returned string must add an </div> closing element!\n     *\n     * @param handler {cv.parser.widgets} the parser that can parse this element\n     * @param widgetType {String} of the widget type\n     * @param element   {Object} the XML element\n     * @param path       {String} of the path ID\n     * @param flavour   {String} Flavour\n     * @param pageType  {String} one of text, 2d and 3d\n     * @return {Map} parsed widget data\n     */\n    createDefaultWidget: function(handler, widgetType, element, path, flavour, pageType) {\n      if (handler.createDefaultWidget) {\n        return handler.createDefaultWidget(widgetType, element, path, flavour, pageType);\n      }\n\n      const layout = this.parseLayout(Array.from(element.children).filter(function (m) {\n        return m.matches('layout');\n      })[0]);\n      const style = Object.keys(layout).length === 0 ? '' : 'style=\"' + this.extractLayout(layout, pageType) + '\"';\n      let classes = handler.getDefaultClasses ? handler.getDefaultClasses(widgetType) : this.getDefaultClasses(widgetType);\n      // the group widgets align attribute is just targeting the group header and is handled by the widget itself, so we skip it here\n      if (element.getAttribute('align') && widgetType !== 'group') {\n        classes+=' '+element.getAttribute('align');\n      }\n      classes += ' ' + this.setWidgetLayout(element, path);\n      if (element.getAttribute('flavour')) {\n        flavour = element.getAttribute('flavour');\n      }// sub design choice\n      if (flavour) {\n        classes += ' flavour_' + flavour;\n      }\n      if (element.getAttribute('class')) {\n        element.getAttribute('class').split(' ').forEach(className => {\n          classes += ' custom_' + className;  \n        });\n      }\n      const label = (widgetType === 'text') ? this.parseLabel(element.querySelector('label'), flavour, '') : this.parseLabel(element.querySelector('label'), flavour);\n\n      let bindClickToWidget = cv.TemplateEngine.getInstance().bindClickToWidget;\n      if (element.getAttribute('bind_click_to_widget')) {\n        bindClickToWidget = element.getAttribute('bind_click_to_widget') === 'true';\n      }\n\n      const data = {\n        'path': path,\n        '$$type': widgetType.toLowerCase(),\n        'pageType': pageType\n      };\n      data.bindClickToWidget = bindClickToWidget;\n      ['mapping', 'align', 'align'].forEach(function(prop) {\n        data[prop] = element.getAttribute(prop) || null;\n      }, this);\n\n      data.layout = layout || null;\n      data.label = label || '';\n      data.classes = classes || '';\n      data.style = style || '';\n      data.responsive = !!Object.keys(layout).find(function (prop) {\n        return prop.endsWith('-m') || prop.endsWith('-s');\n      });\n\n      return this.model.setWidgetData(path, data);\n    },\n\n    /**\n     * Parse config file layout element and convert it to an object\n     *\n     * @param layout {Element} XML config element &lt;layout&gt;\n     * @param defaultValues {Map} default layout values\n     * @return {Map}\n     */\n    parseLayout: function(layout, defaultValues) {\n      const ret_val = {};\n\n      if (!layout) {\n        return ret_val;\n      }\n\n      if (undefined === defaultValues) {\n        defaultValues = {};\n      }\n      ['x', 'y', 'width', 'height', 'scale', 'rowspan', 'colspan'].forEach(function (prop) {\n        this.__extractLayoutAttribute(ret_val, prop, layout, defaultValues);\n        this.__extractLayoutAttribute(ret_val, prop + '-m', layout, defaultValues);\n        this.__extractLayoutAttribute(ret_val, prop + '-s', layout, defaultValues);\n      }, this);\n      return ret_val;\n    },\n\n    __extractLayoutAttribute: function (ret_val, property, layout, defaultValues) {\n      if (layout.getAttribute(property)) {\n        ret_val[property] = layout.getAttribute(property);\n      } else if (defaultValues[property]) {\n        ret_val[property] = defaultValues[property];\n      }\n    },\n\n    extractLayout: function(layout, pageType) {\n      let ret_val = (pageType === '2d') ? 'position:absolute;' : '';\n      if (layout.x) {\n        ret_val += 'left:' + layout.x + ';';\n      }\n      if (layout.y) {\n        ret_val += 'top:' + layout.y + ';';\n      }\n      if (layout.width) {\n        ret_val += 'width:' + layout.width + ';';\n      }\n      if (layout.height) {\n        ret_val += 'height:' + layout.height + ';';\n      }\n\n      return ret_val;\n    },\n\n    extractLayout3d: function(layout) {\n      const ret_val = {};\n      if (layout.getAttribute('x')) {\n        ret_val.x = layout.getAttribute('x');\n      }\n      if (layout.getAttribute('y')) {\n        ret_val.y = layout.getAttribute('y');\n      }\n      if (layout.getAttribute('z')) {\n        ret_val.z = layout.getAttribute('z');\n      }\n      if (layout.getAttribute('floor')) {\n        ret_val.floor = layout.getAttribute('floor');\n      }\n      if (layout.getAttribute('floorFilter')) {\n        ret_val.floorFilter = layout.getAttribute('floorFilter');\n      }\n      if (layout.getAttribute('roomFilter')) {\n        ret_val.roomFilter = layout.getAttribute('roomFilter');\n      }\n      return ret_val;\n    },\n\n    parseLabel: function(label, flavour, labelClass, style) {\n      if (!label) {\n        return '';\n      }\n      let ret_val = '<div class=\"' + (labelClass !== undefined ? labelClass : 'label') + '\"' +\n        (style ? (' style=\"' + style + '\"') : '') + '>';\n\n      Array.prototype.forEach.call(label.childNodes, function(elem) {\n        if (elem.nodeType === Node.ELEMENT_NODE && elem.nodeName.toLowerCase() === 'icon') {\n          ret_val += cv.IconHandler.getInstance().getIconText(\n            elem.getAttribute('name'),\n            elem.getAttribute('type'),\n            elem.getAttribute('flavour') || flavour,\n            elem.getAttribute('color'),\n            elem.getAttribute('styling'));\n        } else if (elem.nodeType === Node.TEXT_NODE) {\n          ret_val += elem.textContent;\n        }\n      });\n      return ret_val + '</div>';\n    },\n\n    /**\n     * this function implements all widget layouts that are identical (JNK)\n     * implemented: rowspan, colspan\n     *\n     * @param element {Element} XML-Element from the config file for this widget\n     * @param path {String}\n     * @return {String} rowspan class or empty string\n     */\n    setWidgetLayout: function(element, path) {\n      const elementData = this.model.getWidgetData(path);\n      const layout = Array.from(element.children).filter(function (m) {\n        return m.matches('layout');\n      })[0];\n      let ret_val = '';\n      let rowspan = null;\n\n      if (layout) {\n        elementData.colspan = qx.xml.Element.getAttributeNS(layout, '', 'colspan');\n        elementData.colspanM = qx.xml.Element.getAttributeNS(layout, '', 'colspan-m');\n        elementData.colspanS = qx.xml.Element.getAttributeNS(layout, '', 'colspan-s');\n        rowspan = qx.xml.Element.getAttributeNS(layout, '', 'rowspan');\n      }\n      elementData.colspan = parseFloat(elementData.colspan || document.querySelector('head').dataset['colspanDefault'] || 6);\n      elementData.colspanM = parseFloat(elementData.colspanM || cv.parser.WidgetParser.lookupM[Math.floor(elementData.colspan)] || elementData.colspan);\n      elementData.colspanS = parseFloat(elementData.colspanS || cv.parser.WidgetParser.lookupS[Math.floor(elementData.colspan)] || elementData.colspan);\n\n      if (rowspan) {\n        elementData.rowspanClass = cv.ui.layout.Manager.rowspanClass(parseFloat(rowspan || 1));\n        ret_val = 'innerrowspan';\n      }\n      return ret_val;\n    },\n\n    /**\n     * Parse the format setting\n     * @param xml {Element} XML-Element from config\n     * @param path {String} path to the widget\n     */\n    parseFormat: function (xml, path) {\n      const data = this.model.getWidgetData(path);\n      const value = xml.getAttribute('format');\n      if (value) {\n        data.format = value;\n      }\n    },\n\n    /**\n     * Parses the address element\n     * @param xml {Element} address XML-Element from config\n     * @param path {String} path to the widget\n     * @param makeAddressListFn {Function?} callback for parsing address variants\n     */\n    parseAddress: function (xml, path, makeAddressListFn) {\n      if (xml.nodeName.toLowerCase() !== 'page') {\n        const data = this.model.getWidgetData(path);\n        data.address = cv.parser.WidgetParser.makeAddressList(xml, path, makeAddressListFn);\n      }\n    },\n\n    /**\n     * this function extracts all addresses with attributes (JNK)\n     *                       elements. The first is a boolean that determins if\n     *                       the visu should listen for that address. The second\n     *                       is added as it is to the returned object.\n     *\n     * @param element {Element} address XML-Element from the config file\n     * @param id {String} id / path to the widget\n     * @param makeAddressListFn {Function?} callback for parsing address variants\n     * @param skipAdding {Boolean?} do not add address to model if true\n     * @return {Object} address\n     */\n    makeAddressList: function (element, id, makeAddressListFn, skipAdding) {\n      let address = {};\n      element.querySelectorAll('address').forEach(function (elem) {\n        let\n          src = elem.textContent;\n          let transform = elem.getAttribute('transform');\n          let addressInfo = {};\n          let formatPos = +(elem.getAttribute('format-pos') || 1) | 0; // force integer\n          let mode = 1 | 2; // Bit 0 = read, Bit 1 = write  => 1|2 = 3 = readwrite\n\n        if (cv.Config.backend === 'mqtt') {\n          addressInfo.qos = (elem.getAttribute('qos') || 0) | 0; // force integer\n          addressInfo.retain = elem.getAttribute('retain') === 'true';\n        }\n\n        if ((!src) || (!transform)) { // fix broken address-entries in config\n          qx.log.Logger.error(this, 'Either address or transform is missing in address element %1', element.outerHTML);\n          return;\n        }\n        switch (elem.getAttribute('mode')) {\n          case 'disable':\n            mode = 0;\n            break;\n          case 'read':\n            mode = 1;\n            break;\n          case 'write':\n            mode = 2;\n            break;\n          case 'readwrite':\n            mode = 1 | 2;\n            break;\n        }\n        let variantInfo = makeAddressListFn ? makeAddressListFn(src, transform, mode, elem.getAttribute('variant')) : [true, undefined];\n        if (!skipAdding && (mode & 1) && variantInfo[0]) { // add only addresses when reading from them\n          this.model.addAddress(src, id);\n        }\n        if (address[src]) {\n          // we already have an entry for this address, merge the modes if the other attribute values are equal\n          if (address[src].transform === transform && address[src].variantInfo === variantInfo[1] && address[src].formatPos === formatPos) {\n            mode |= address[src].mode;\n          } else {\n            qx.log.Logger.error(this, 'multiple address entries with different configuration:', address[src], [transform, mode, variantInfo[1], formatPos], 'they are only allowed to differ in mode');\n          }\n        }\n        addressInfo.transform = transform;\n        addressInfo.mode = mode;\n        addressInfo.variantInfo = variantInfo[1];\n        addressInfo.formatPos = formatPos;\n        address[src] = addressInfo;\n      }, this);\n      return address;\n    },\n\n    parseRefresh: function (xml, path, doCacheControl) {\n      const data = this.model.getWidgetData(path);\n      data.refresh = xml.getAttribute('refresh') ? parseInt(xml.getAttribute('refresh')) * 1000 : 0;\n      if (doCacheControl) {\n        data.cachecontrol = (function(x) {\n          switch (x) {\n            case 'full':\n            case 'force':\n            case 'weak':\n            case 'none':\n              return x;\n              \n            case 'false':\n              return 'none';\n              \n            case 'true':\n            default:\n              return 'full';\n          }\n        })(xml.getAttribute('cachecontrol'));\n      }\n    },\n\n    parseStyling: function (xml, path) {\n      const data = this.model.getWidgetData(path);\n      data.styling = xml.getAttribute('styling');\n    },\n\n    // this might have been called from the cv.parser.WidgetParser with the including class as context\n    parseChildren: function (xml, path, flavour, pageType) {\n      const data = this.model.getWidgetData(this.getStoragePath(xml, path));\n\n      if (!data.children) {\n        data.children = [];\n      }\n      const childs = Array.from(xml.children).filter(function (child) {\n        return ['layout', 'label', 'address'].indexOf(child.nodeName.toLowerCase()) === -1;\n      }, this);\n      childs.forEach(function (child, idx) {\n        const childData = cv.parser.WidgetParser.parse(child, path + '_' + idx, flavour, pageType);\n        if (childData) {\n          if (Array.isArray(childData)) {\n            let i = 0;\n            const l = childData.length;\n            for (; i < l; i++) {\n              data.children.push(childData[i].path);\n            }\n          } else if (childData.path) {\n            data.children.push(childData.path);\n          }\n        }\n      }, this);\n      return data;\n    },\n\n    /**\n     * Returns the path where the widget data is stored, usually this is the same path, but there are\n     * exceptions for pages which are handled here\n     *\n     * @param xml {Element} widgets XML config element\n     * @param path {String} internal widget path e.g. id_0_2\n     */\n    getStoragePath: function (xml, path) {\n      if (xml.length === 1) {\n        xml = xml[0];\n      }\n      switch (xml.nodeName.toLowerCase()) {\n        case 'page':\n          return path + '_';\n        default:\n          return path;\n      }\n    }\n  }\n});\n"
  ]
}