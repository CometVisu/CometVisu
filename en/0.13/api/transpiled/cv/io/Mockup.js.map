{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "io",
    "AbstractClient",
    "implement",
    "IClient",
    "construct",
    "_this",
    "constructor",
    "call",
    "Client",
    "CLIENTS",
    "push",
    "window",
    "_receive",
    "receive",
    "bind",
    "model",
    "data",
    "Model",
    "getInstance",
    "_widgetDataGet",
    "getWidgetData",
    "_getWidgetDataModel",
    "getWidgetDataModel",
    "writeHistory",
    "testMode",
    "setConnected",
    "__simulation",
    "Simulation",
    "addresses",
    "file",
    "_resources",
    "addListener",
    "ev",
    "getData",
    "members",
    "backendName",
    "__xhr",
    "getType",
    "json",
    "forEach",
    "client",
    "update",
    "d",
    "login",
    "loginOnly",
    "credentials",
    "callback",
    "context",
    "_this2",
    "isInitialized",
    "addListenerOnce",
    "debug",
    "subscribe",
    "prepareTestData",
    "addSubscription",
    "address",
    "includes",
    "__decode",
    "__P_749_2",
    "value",
    "test",
    "length",
    "parseInt",
    "substring",
    "write",
    "report",
    "Record",
    "REPLAYING",
    "ts",
    "Date",
    "getTime",
    "lastWrite",
    "onWrite",
    "answer",
    "i",
    "transformedValue",
    "restart",
    "stop",
    "getResourcePath",
    "name",
    "map",
    "Config",
    "src",
    "basePath",
    "Object",
    "prototype",
    "hasOwnProperty",
    "endsWith",
    "startsWith",
    "path",
    "key",
    "concat",
    "getLastError",
    "getBackend",
    "authorize",
    "req",
    "canAuthorize",
    "terminate",
    "record",
    "type",
    "showError",
    "message",
    "args",
    "setInitialAddresses",
    "hasCustomChartsDataProcessor",
    "processChartsData",
    "hasProvider",
    "getProviderUrl",
    "getProviderConvertFunction",
    "format",
    "getProviderData",
    "Mockup"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/io/Mockup.js"
  ],
  "sourcesContent": [
    "/* Mockup.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Mockup simulating a backend + client for the Cometvisu protocol\n *\n * @author Tobias BrÃ¤utigam\n * @since 2016\n */\n/* istanbul ignore next */\nqx.Class.define('cv.io.Mockup', {\n  extend: cv.io.AbstractClient,\n  implement: cv.io.IClient,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct() {\n    super();\n    cv.io.Client.CLIENTS.push(this);\n    // make some functions accessible for the protractor runner\n    window._receive = this.receive.bind(this);\n    const model = cv.data.Model.getInstance();\n    window._widgetDataGet = model.getWidgetData.bind(model);\n    window._getWidgetDataModel = model.getWidgetDataModel.bind(model);\n    window.writeHistory = [];\n\n    const testMode = qx.core.Environment.get('cv.testMode');\n    if (typeof testMode === 'string' && testMode !== 'true') {\n      this.setConnected(false);\n      this.__simulation = new cv.data.Simulation(testMode, this);\n    }\n    this.addresses = [];\n\n    let file = this._resources['simulation'];\n    if (file) {\n      this.setConnected(false);\n      this.__simulation = new cv.data.Simulation(file, this);\n    } else {\n      this.addListener('resourcePathAdded', ev => {\n        switch (ev.getData()) {\n          case 'simulation': {\n            const file = this._resources['simulation'];\n            if (file) {\n              this.setConnected(false);\n              this.__simulation = new cv.data.Simulation(file, this);\n            }\n            break;\n          }\n        }\n      });\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    backendName: 'mockup',\n    addresses: null,\n    __xhr: null,\n    __simulation: null,\n\n    getType() {\n      return this.backendName;\n    },\n\n\n    /**\n     * This function gets called once the communication is established and session information is available\n     * @param json\n     */\n    receive(json) {\n      if (json) {\n        cv.io.Client.CLIENTS.forEach(function (client) {\n          client.update(json.d);\n        });\n      }\n    },\n\n    login(loginOnly, credentials, callback, context) {\n      if (callback) {\n        if (this.__simulation && !this.__simulation.isInitialized()) {\n          this.__simulation.addListenerOnce('changeInitialized', () => {\n            this.setConnected(true);\n            this.debug('(delayed) logged in to mockup client');\n            callback.call(context);\n          });\n        } else {\n          this.setConnected(true);\n          this.debug('logged in to mockup client');\n          callback.call(context);\n        }\n      }\n    },\n\n    /**\n     * Subscribe to the addresses in the parameter\n     * @param addresses\n     */\n    subscribe(addresses) {\n      this.addresses = addresses ? addresses : [];\n      if (this.__simulation) {\n        this.__simulation.prepareTestData(this.addresses);\n      }\n    },\n\n    addSubscription(address) {\n      if (!this.addresses.includes(address)) {\n        this.addresses.push(address);\n      }\n    },\n\n    __decode(address, value) {\n      if (/\\d{1,2}\\/\\d{1,2}\\/\\d{1,2}/.test(address)) {\n        if (/^[\\da-fA-F]+$/.test(value)) {\n          if (value.length <= 2) {\n            value = '' + (parseInt(value, 16) & 63);\n          } else {\n            value = value.substring(2);\n          }\n        }\n      }\n      return value;\n    },\n\n    /**\n     * This function sends a value\n     * @param address\n     * @param value\n     */\n    write(address, value) {\n      if (cv.report.Record.REPLAYING === true) {\n        // do nothing in replay mode\n        return;\n      }\n      const ts = new Date().getTime();\n      // store in window, to make it accessible for protractor\n      const lastWrite = {\n        address: address,\n        value: value,\n        ts: ts\n      };\n\n      value = this.__decode(address, value);\n\n      if (!this.__simulation || !this.__simulation.onWrite(address, value)) {\n        // send update\n        const answer = {\n          i: ts,\n          d: {}\n        };\n        lastWrite.transformedValue = value;\n        answer.d[address] = value;\n        this.debug('sending value: ' + value + ' to address: ' + address);\n        this.receive(answer);\n      }\n      // store in window, to make it accessible for protractor\n      window.writeHistory.push(lastWrite);\n    },\n\n    restart() {},\n\n    stop() {},\n\n    getResourcePath(name, map) {\n      if (cv.Config.testMode) {\n        // fallback to old behaviour just for screenshot generation / testing\n        if (name === 'charts' && map && map.src) {\n          return name + '/' + map.src;\n        }\n        return name;\n      }\n      let basePath = '';\n      if (Object.prototype.hasOwnProperty.call(this._resources, name)) {\n        basePath = this._resources[name];\n        if (basePath && !basePath.endsWith('/')) {\n          basePath += '/';\n        }\n      }\n      if (name === 'charts' && map && map.src) {\n        if (map.src.startsWith('generator:')) {\n          // the generator also might need the start/end values\n          let path = basePath + map.src + '?';\n          for (const key in map) {\n            path += `&${key}=${map[key]}`;\n          }\n          return path;\n        }\n        return basePath + map.src;\n      }\n      return basePath;\n    },\n\n    getLastError() {\n      return null;\n    },\n\n    getBackend() {\n      return {};\n    },\n\n    authorize(req) {},\n\n    canAuthorize() {\n      return false;\n    },\n\n    terminate() {},\n\n    update(json) {},\n    record(type, data) {},\n    showError(type, message, args) {},\n\n    // not used / needed in this client\n    setInitialAddresses(addresses) {},\n\n    hasCustomChartsDataProcessor() {\n      return false;\n    },\n    processChartsData(data) {\n      return data;\n    },\n    hasProvider(name) {\n      return false;\n    },\n    getProviderUrl(name) {\n      return null;\n    },\n    getProviderConvertFunction(name, format) {\n      return null;\n    },\n    getProviderData : function (name, format) {\n      return null;\n    }\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}