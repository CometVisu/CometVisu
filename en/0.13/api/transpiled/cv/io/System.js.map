{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "cv",
    "io",
    "IClient",
    "construct",
    "addresses",
    "event",
    "message",
    "Bus",
    "subscribe",
    "_onPageChange",
    "properties",
    "connected",
    "check",
    "init",
    "server",
    "nullable",
    "members",
    "backendName",
    "implementedAddresses",
    "ev",
    "page",
    "getData",
    "data",
    "getAttribute",
    "Model",
    "getInstance",
    "updateFrom",
    "getType",
    "receive",
    "json",
    "login",
    "loginOnly",
    "credentials",
    "callback",
    "context",
    "call",
    "filters",
    "write",
    "address",
    "value",
    "options",
    "parts",
    "split",
    "target",
    "shift",
    "name",
    "backend",
    "BackendConnections",
    "getClient",
    "restart",
    "warn",
    "url",
    "window",
    "location",
    "reload",
    "URL",
    "href",
    "searchParams",
    "set",
    "replace",
    "toString",
    "action",
    "Application",
    "structureController",
    "scrollToPage",
    "theme",
    "document",
    "documentElement",
    "setAttribute",
    "model",
    "onUpdate",
    "length",
    "rest",
    "Client",
    "getBaseUrl",
    "origin",
    "xhr",
    "request",
    "Xhr",
    "send",
    "stop",
    "getResourcePath",
    "params",
    "getLastError",
    "getBackend",
    "Map",
    "authorize",
    "req",
    "terminate",
    "update",
    "record",
    "type",
    "showError",
    "args",
    "setInitialAddresses",
    "hasCustomChartsDataProcessor",
    "processChartsData",
    "hasProvider",
    "getProviderUrl",
    "getProviderData",
    "format",
    "map",
    "label",
    "insertText",
    "kind",
    "monaco",
    "languages",
    "CompletionItemKind",
    "Value",
    "Promise",
    "resolve",
    "getProviderConvertFunction",
    "System"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/io/System.js"
  ],
  "sourcesContent": [
    "/* System.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * A backend client to handle internal system states.\n * With this backend you get access to e.g. backend connection states, currently shown page in the UI and can\n * trigger some things like:\n * - Restart a backend connection\n * - navigate to another page\n * - reload the browser\n * - trigger HTTP requests\n */\nqx.Class.define('cv.io.System', {\n  extend: qx.core.Object,\n  implement: cv.io.IClient,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    super();\n    this.addresses = [];\n    qx.event.message.Bus.subscribe('cv.ui.structure.tile.currentPage', this._onPageChange, this);\n  },\n\n  /*\n  ***********************************************\n   PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    connected: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeConnected'\n    },\n\n    /**\n     * The server the client is currently speaking to\n     */\n    server: {\n      check: 'String',\n      nullable: true,\n      event: 'changedServer'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    backendName: 'system',\n    addresses: null,\n    implementedAddresses: null,\n\n    _onPageChange(ev) {\n      const page = ev.getData();\n      const data = {};\n      data['nav:current-page'] = page.getAttribute('id');\n      cv.data.Model.getInstance().updateFrom('system', data);\n    },\n\n    getType() {\n      return this.backendName;\n    },\n\n    receive(json) {},\n\n    login(loginOnly, credentials, callback, context) {\n      if (callback) {\n        callback.call(context);\n      }\n    },\n\n    subscribe(addresses, filters) {\n      this.addresses = addresses ? addresses : [];\n    },\n\n    write(address, value, options) {\n      if (address) {\n        const parts = address.split(':');\n        const target = parts.shift();\n        if (target === 'backend') {\n          const name = parts.shift();\n          const backend = name === 'system' ? this : cv.io.BackendConnections.getClient(name);\n          if (backend) {\n            switch (value) {\n              case 'restart':\n                backend.restart(true);\n                break;\n\n              default:\n                this.warn('unhandled backend action:', value);\n            }\n          }\n        } else if (target === 'browser') {\n          let url;\n          switch (value) {\n            case 'reload':\n              window.location.reload();\n              break;\n\n            case 'forced-reload':\n              url = new URL(window.location.href);\n              url.searchParams.set('forceReload', 'true');\n              window.location.replace(url.toString());\n              break;\n\n            default:\n              this.warn('unhandled browser action:', value);\n          }\n        } else if (target === 'nav') {\n          const action = parts.shift();\n          switch (action) {\n            case 'current-page':\n              cv.Application.structureController.scrollToPage(value);\n              break;\n          }\n        } else if (target === 'theme') {\n          const theme = value;\n          document.documentElement.setAttribute('data-theme', theme);\n          const model = cv.data.Model.getInstance();\n          model.onUpdate('theme', theme, 'system');\n        } else if (target === 'http' || target === 'https') {\n          // send HTTP request, ignore the answer\n          if (parts.length >= 2 && parts[0] === 'proxy') {\n            const url = new URL(cv.io.rest.Client.getBaseUrl() + '/proxy', window.location.origin);\n\n            url.searchParams.set('url', target + ':' + parts[1]);\n            address = url.toString();\n          }\n          const xhr = new qx.io.request.Xhr(address);\n          xhr.send();\n        } else if (target === 'state') {\n          // just write the value to the states to update Listeners\n          cv.data.Model.getInstance().onUpdate(address, value, 'system');\n        }\n      }\n    },\n\n    restart() {},\n\n    stop() {},\n\n    getResourcePath(name, params) {\n      if (name === 'charts') {\n        return null;\n      }\n      return name;\n    },\n\n    getLastError() {\n      return null;\n    },\n\n    getBackend() {\n      return new Map();\n    },\n\n    authorize(req) {},\n\n    terminate() {},\n\n    update(json) {},\n    record(type, data) {},\n    showError(type, message, args) {},\n\n    // not used / needed in this client\n    setInitialAddresses(addresses) {},\n\n    hasCustomChartsDataProcessor() {\n      return false;\n    },\n    processChartsData(data) {\n      return data;\n    },\n    hasProvider(name) {\n      return false;\n    },\n    getProviderUrl(name) {\n      return null;\n    },\n\n    getProviderData(name, format) {\n      if (name === 'addresses') {\n        let data = null;\n        if (format === 'monaco') {\n          data = this.implementedAddresses.map(name => ({\n            label: name,\n            insertText: name,\n            kind: window.monaco.languages.CompletionItemKind.Value\n          }));\n        } else {\n          data = this.implementedAddresses.map(name => ({\n            label: name,\n            value: name\n          }));\n        }\n        return Promise.resolve(data);\n      }\n      return null;\n    },\n\n    getProviderConvertFunction(name, format) {\n      return null;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}