{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "__fsClient",
    "cv",
    "io",
    "rest",
    "Client",
    "getFsClient",
    "members",
    "rename",
    "file",
    "newName",
    "newPath",
    "getPath",
    "length",
    "endsWith",
    "isTemporary",
    "createSync",
    "path",
    "getType",
    "err",
    "ui",
    "manager",
    "snackbar",
    "Controller",
    "error",
    "info",
    "locale",
    "Manager",
    "tr",
    "getDisplayName",
    "resetTemporary",
    "resetModified",
    "setName",
    "reload",
    "getFullPath",
    "moveSync",
    "src",
    "target",
    "resetEditing",
    "move",
    "event",
    "message",
    "Bus",
    "dispatchByName",
    "action",
    "restore",
    "isInTrash",
    "replace",
    "__moveFile",
    "match",
    "exec",
    "targetFileName",
    "parentFolder",
    "getParent",
    "targetFile",
    "getChildren",
    "some",
    "child",
    "readSync",
    "res",
    "updateSync",
    "hash",
    "getName",
    "getBusTopic",
    "data",
    "source",
    "callback",
    "context",
    "apply",
    "isTrash",
    "qxl",
    "dialog",
    "Dialog",
    "confirm",
    "confirmed",
    "__doDelete",
    "deleteSync",
    "force",
    "download",
    "element",
    "document",
    "createElement",
    "setAttribute",
    "getBaseUrl",
    "style",
    "display",
    "body",
    "appendChild",
    "click",
    "removeChild",
    "validate",
    "isConfigFile",
    "__validateConfig",
    "d",
    "alert",
    "editor",
    "Worker",
    "getInstance",
    "validateConfig",
    "then",
    "close",
    "setValid",
    "handler",
    "handlerOptions",
    "jumpToError",
    "trn",
    "destruct",
    "control",
    "FileController"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileController.js"
  ],
  "sourcesContent": [
    "/* FileController.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * The FileController is responsible for all file operations, like config check, move, replace, delete etc.\n */\nqx.Class.define('cv.ui.manager.control.FileController', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    super();\n    this.__fsClient = cv.io.rest.Client.getFsClient();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __fsClient: null,\n\n    rename(file, newName) {\n      let newPath = file.getPath() || '';\n      if (newPath.length > 0 && !newPath.endsWith('/')) {\n        newPath += '/';\n      }\n      newPath += newName;\n      if (file.isTemporary()) {\n        // create new item\n        this.__fsClient.createSync(\n          { path: newPath, type: file.getType() },\n          function (err) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              cv.ui.manager.snackbar.Controller.info(\n                file.getType() === 'file'\n                  ? qx.locale.Manager.tr('File \"%1\" has been created', file.getDisplayName())\n                  : qx.locale.Manager.tr('Folder \"%1\" has been created', file.getDisplayName())\n              );\n\n              file.resetTemporary();\n              file.resetModified();\n              file.setName(newName);\n              file.reload();\n            }\n          },\n          this\n        );\n      } else if (file.getFullPath() !== newPath) {\n        this.__fsClient.moveSync(\n          { src: file.getFullPath(), target: newPath },\n          function (err) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              cv.ui.manager.snackbar.Controller.info(\n                file.getType() === 'file'\n                  ? qx.locale.Manager.tr('File \"%1\" has been renamed to \"%2\"', file.getDisplayName(), newName)\n                  : qx.locale.Manager.tr('Folder \"%1\" has been renamed to \"%2\"', file.getDisplayName(), newName)\n              );\n\n              file.setName(newName);\n              file.resetModified();\n              file.reload();\n            }\n            file.resetEditing();\n          },\n          this\n        );\n      }\n    },\n\n    /**\n     * Move file to another path\n     * @param file {cv.ui.manager.model.FileItem} file to move\n     * @param target {String} new path of the file\n     */\n    move(file, target) {\n      this.__fsClient.moveSync(\n        { src: file.getFullPath(), target: target },\n        function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(\n              file.getType() === 'file'\n                ? qx.locale.Manager.tr('File \"%1\" has been moved', file.getDisplayName())\n                : qx.locale.Manager.tr('Folder \"%1\" has been moved', file.getDisplayName())\n            );\n\n            qx.event.message.Bus.dispatchByName('cv.manager.file', {\n              action: 'moved',\n              path: file.getFullPath()\n            });\n          }\n        },\n        this\n      );\n    },\n\n    /**\n     * Restore file from trash by moving it out of the trash to the old path\n     * @param file {cv.ui.manager.model.FileItem} file to restore\n     */\n    restore(file) {\n      if (file.isInTrash()) {\n        const target = file.getFullPath().replace('.trash/', '');\n        this.__moveFile(file, target);\n      } else if (file.getType() === 'file' && !file.isTemporary()) {\n        const match = /^\\/?backup\\/visu_config(.*)-[0-9]{14}\\.xml$/.exec(file.getFullPath());\n\n        if (match) {\n          // find the existing target config to restore\n          const targetFileName = 'visu_config' + match[1] + '.xml';\n\n          // find the target file\n          const parentFolder = file.getParent().getParent();\n          let targetFile = null;\n          parentFolder.getChildren().some(function (child) {\n            if (child.getFullPath() === targetFileName) {\n              targetFile = child;\n              return true;\n            }\n            return false;\n          });\n\n          // load the backup content\n          this.__fsClient.readSync(\n            { path: file.getFullPath() },\n            function (err, res) {\n              if (err) {\n                cv.ui.manager.snackbar.Controller.error(err);\n              } else if (targetFile) {\n                this.__fsClient.updateSync(\n                  {\n                    path: targetFile.getFullPath(),\n                    hash: 'ignore'\n                  },\n\n                  res,\n                  function (err) {\n                    if (err) {\n                      cv.ui.manager.snackbar.Controller.error(err);\n                    } else {\n                      cv.ui.manager.snackbar.Controller.info(\n                        qx.locale.Manager.tr('%1 has been restored', file.getName())\n                      );\n\n                      targetFile.resetModified();\n                      targetFile.resetTemporary();\n                      qx.event.message.Bus.dispatchByName(targetFile.getBusTopic(), {\n                        type: 'fsContentChanged',\n                        data: res,\n                        source: this\n                      });\n                    }\n                  },\n                  this\n                );\n              } else {\n                // target file does not exist copy to a new file\n                this.__fsClient.createSync(\n                  {\n                    path: targetFileName,\n                    hash: 'ignore'\n                  },\n\n                  res,\n                  function (err) {\n                    if (err) {\n                      cv.ui.manager.snackbar.Controller.error(err);\n                    } else {\n                      cv.ui.manager.snackbar.Controller.info(\n                        qx.locale.Manager.tr('%1 has been restored', file.getName())\n                      );\n                    }\n                  },\n                  this\n                );\n              }\n            },\n            this\n          );\n        }\n      }\n    },\n\n    __moveFile(file, target) {\n      this.__fsClient.moveSync(\n        { src: file.getFullPath(), target: target },\n        function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(\n              file.getType() === 'file'\n                ? qx.locale.Manager.tr('File \"%1\" has been restored', file.getDisplayName())\n                : qx.locale.Manager.tr('Folder \"%1\" has been restored', file.getDisplayName())\n            );\n\n            qx.event.message.Bus.dispatchByName('cv.manager.file', {\n              action: 'restored',\n              path: file.getFullPath()\n            });\n          }\n        },\n        this\n      );\n    },\n\n    delete(file, callback, context) {\n      if (file.isTemporary()) {\n        // new file, no need to call the backend\n        if (callback) {\n          callback.apply(context, true);\n        }\n      } else if (file) {\n        let message;\n        if (file.isTrash()) {\n          message = qx.locale.Manager.tr('Do you really want to clear the trash?');\n        } else if (file.isInTrash()) {\n          message =\n            file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\" from the trash?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\" from the trash?', file.getDisplayName());\n        } else {\n          message =\n            file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\"?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\"?', file.getDisplayName());\n        }\n        qxl.dialog.Dialog.confirm(\n          message,\n          function (confirmed) {\n            if (confirmed) {\n              this.__doDelete(file, callback, context);\n            } else if (callback) {\n              callback.apply(context, false);\n            }\n          },\n          this,\n          qx.locale.Manager.tr('Confirm deletion')\n        );\n      }\n    },\n\n    __doDelete(file, callback, context) {\n      this.__fsClient.deleteSync(\n        { path: file.getFullPath(), force: file.isTrash() },\n        null,\n        function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n            if (callback) {\n              callback.apply(context, false);\n            }\n          } else {\n            let message;\n            if (file.isTrash()) {\n              message = qx.locale.Manager.tr('Trash has been cleared');\n            } else if (file.isInTrash()) {\n              message =\n                this.getType() === 'file'\n                  ? qx.locale.Manager.tr('File \"%1\" has been removed from trash', file.getDisplayName())\n                  : qx.locale.Manager.tr('Folder \"%1\" has been removed from trash', file.getDisplayName());\n            } else {\n              message =\n                file.getType() === 'file'\n                  ? qx.locale.Manager.tr('File \"%1\" has been deleted', file.getDisplayName())\n                  : qx.locale.Manager.tr('Folder \"%1\" has been deleted', file.getDisplayName());\n            }\n            cv.ui.manager.snackbar.Controller.info(message);\n            if (callback) {\n              callback.apply(context, true);\n            }\n            qx.event.message.Bus.dispatchByName('cv.manager.file', {\n              action: 'deleted',\n              path: file.getFullPath()\n            });\n          }\n        },\n        this\n      );\n    },\n\n    download(file) {\n      if (file.getType() === 'file') {\n        const element = document.createElement('a');\n        element.setAttribute('href', cv.io.rest.Client.getBaseUrl() + '/fs?download=true&path=' + file.getFullPath());\n\n        element.style.display = 'none';\n        document.body.appendChild(element);\n        element.click();\n        document.body.removeChild(element);\n      }\n    },\n\n    validate(file) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertInstance(file, cv.ui.manager.model.FileItem);\n      }\n      if (file.isConfigFile()) {\n        this.__validateConfig(file);\n      } else {\n        this.info('no validation available for file: ' + file.getFullPath());\n      }\n    },\n\n    __validateConfig(file) {\n      const d = qxl.dialog.Dialog.alert(qx.locale.Manager.tr('Validating %1', file.getFullPath()));\n\n      cv.ui.manager.editor.Worker.getInstance()\n        .validateConfig(file)\n        .then(function (res) {\n          d.close();\n          if (res === true) {\n            file.setValid(true);\n            cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has no errors!', file.getFullPath()));\n          } else {\n            file.setValid(false);\n            qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n              file: file,\n              handler: 'cv.ui.manager.editor.Source',\n              handlerOptions: {\n                jumpToError: true\n              }\n            });\n\n            cv.ui.manager.snackbar.Controller.error(\n              qx.locale.Manager.trn(\n                '%1 error found in %2!',\n                '%1 errors found in %2!',\n                res.length,\n                res.length,\n                file.getFullPath()\n              )\n            );\n          }\n        });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this.__fsClient = null;\n  }\n});\n"
  ],
  "mappings": "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"
}