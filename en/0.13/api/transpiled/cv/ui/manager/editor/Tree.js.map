{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "editor",
    "AbstractEditor",
    "construct",
    "_setLayout",
    "layout",
    "Grow",
    "_handledActions",
    "_initWorker",
    "_schemas",
    "__modifiedElements",
    "__modifiedPreviewElements",
    "data",
    "Array",
    "addListener",
    "ev",
    "getData",
    "setPreviewState",
    "structureChanges",
    "some",
    "element",
    "hasChildrenModified",
    "initUnDos",
    "initReDos",
    "__buttonListeners",
    "core",
    "Init",
    "getApplication",
    "getRoot",
    "_onElementKeyUp",
    "_maintainPreviewVisibility",
    "_draw",
    "statics",
    "SUPPORTED_FILES",
    "TITLE",
    "locale",
    "Manager",
    "tr",
    "ICON",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "Allowed",
    "NONE",
    "BEFORE",
    "AFTER",
    "INSIDE",
    "FIRST_CHILD",
    "properties",
    "appearance",
    "refine",
    "init",
    "expert",
    "check",
    "ready",
    "selected",
    "nullable",
    "event",
    "apply",
    "clipboard",
    "unDos",
    "deferredInit",
    "reDos",
    "autoRefreshPreview",
    "previewState",
    "showPreview",
    "dragging",
    "members",
    "_workerWrapper",
    "__editing",
    "__searchResults",
    "__searchResultIndex",
    "_structure",
    "getSchema",
    "file",
    "startsWith",
    "substring",
    "Object",
    "prototype",
    "hasOwnProperty",
    "call",
    "model",
    "Schema",
    "getInstance",
    "Promise",
    "resolve",
    "reject",
    "onLoaded",
    "setReady",
    "isPreviewSynced",
    "getPreviewState",
    "_applyHandlerOptions",
    "handlerOptions",
    "getHandlerOptions",
    "setShowPreview",
    "bom",
    "Viewport",
    "getWidth",
    "noPreview",
    "_applyShowPreview",
    "value",
    "getChildControl",
    "setVisibility",
    "clearLayoutProperties",
    "updateLayoutProperties",
    "noStretch",
    "setLayoutProperties",
    "flex",
    "getFile",
    "preview",
    "isWriteable",
    "setFile",
    "__getPreviewFile",
    "_updatePreview",
    "handleAction",
    "actionName",
    "canHandleAction",
    "undo",
    "redo",
    "_onCut",
    "_onCopy",
    "_onPaste",
    "_showHelp",
    "configureButton",
    "actionId",
    "button",
    "getUnDos",
    "length",
    "setEnabled",
    "setToolTipText",
    "getItem",
    "getTitle",
    "resetToolTipText",
    "getReDos",
    "bind",
    "converter",
    "isDeletable",
    "unConfigureButton",
    "removeListenerById",
    "removeRelatedBindings",
    "addUndo",
    "elementChange",
    "ElementChange",
    "push",
    "pop",
    "error",
    "clearUnDosReDos",
    "removeAll",
    "forEach",
    "elem",
    "dispose",
    "clearReDos",
    "_applyClipboard",
    "navigator",
    "writeText",
    "getNode",
    "outerHTML",
    "e",
    "CLIPBOARD",
    "Worker",
    "showErrors",
    "path",
    "errorList",
    "showDecorations",
    "decorators",
    "_loadFile",
    "old",
    "close",
    "getType",
    "isSupported",
    "hasChildControl",
    "resetFile",
    "resetPreviewState",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "container",
    "Composite",
    "HBox",
    "_add",
    "Canvas",
    "addAt",
    "VBox",
    "isShowPreview",
    "exclude",
    "viewer",
    "Config",
    "set",
    "target",
    "minWidth",
    "ok",
    "noSync",
    "notOk",
    "basic",
    "Atom",
    "setRich",
    "setWrap",
    "label",
    "icon",
    "removeState",
    "addState",
    "toolbar",
    "Button",
    "_onEdit",
    "add",
    "_onDelete",
    "CheckBox",
    "toggleExpert",
    "ToolBar",
    "top",
    "left",
    "right",
    "form",
    "TextField",
    "liveUpdate",
    "placeholder",
    "margin",
    "util",
    "Function",
    "debounce",
    "_onSearch",
    "getKeyIdentifier",
    "_showNextResult",
    "_showPreviousResult",
    "stopPropagation",
    "tree",
    "VirtualTree",
    "selectionMode",
    "width",
    "openMode",
    "itemHeight",
    "Environment",
    "get",
    "_initDragDrop",
    "setDelegate",
    "createItem",
    "item",
    "VirtualElementItem",
    "_onContextMenu",
    "_onContextMenuAction",
    "bindItem",
    "controller",
    "index",
    "bindProperty",
    "bindPropertyReverse",
    "getSelection",
    "_onChangeTreeSelection",
    "bottom",
    "setDraggable",
    "setMarginLeft",
    "setZIndex",
    "setAppearance",
    "getSelected",
    "_onCreate",
    "qxl",
    "dialog",
    "Dialog",
    "alert",
    "Widget",
    "setDecorator",
    "decoration",
    "Decorator",
    "widthTop",
    "styleTop",
    "colorTop",
    "setHeight",
    "setOpacity",
    "setDroppable",
    "contextmenu",
    "ConfigElement",
    "getCurrentTarget",
    "getModel",
    "replace",
    "setSelected",
    "menu",
    "setElement",
    "openAtPointer",
    "getBubbles",
    "stop",
    "action",
    "added",
    "resetSelected",
    "openByQuerySelector",
    "selector",
    "edit",
    "rootNode",
    "result",
    "querySelector",
    "__showSearchResult",
    "from",
    "querySelectorAll",
    "filter",
    "el",
    "tagName",
    "hasAttribute",
    "getAttribute",
    "firstMatch",
    "$$widget",
    "openNodeAndParents",
    "current",
    "ancestors",
    "parentElement",
    "load",
    "i",
    "p",
    "draggedXmlElement",
    "dragTarget",
    "getDragTarget",
    "setDragging",
    "isEditable",
    "preventDefault",
    "addAction",
    "addType",
    "addData",
    "addButton",
    "Tree",
    "accepted",
    "mode",
    "getCurrentAction",
    "supportsType",
    "addNew",
    "getTarget",
    "indicator",
    "debug",
    "isAncestor",
    "layerContent",
    "getPane",
    "getLayers",
    "getContentLocation",
    "getDocumentTop",
    "lastElem",
    "document",
    "elementFromPoint",
    "Math",
    "round",
    "getWidgetByElement",
    "isAnonymous",
    "getLayoutParent",
    "parent",
    "getParent",
    "parentSchemaElement",
    "getSchemaElement",
    "allowedElements",
    "getAllowedElements",
    "keys",
    "addable",
    "getAddableChildren",
    "areChildrenSortable",
    "acc",
    "allowedSorting",
    "getAllowedElementsSorting",
    "elementName",
    "__getAllowedPositions",
    "getName",
    "isChildElementAllowed",
    "lookInside",
    "getFirstLevelElementSorting",
    "targetPosition",
    "undefined",
    "getChildren",
    "firstChild",
    "maxPosition",
    "firstChildPosition",
    "expandTimer",
    "lastTreeItem",
    "treeContainer",
    "onDrag",
    "position",
    "cursor",
    "getManager",
    "getCursor",
    "DragDropCursor",
    "_native",
    "pointerType",
    "hasState",
    "origElem",
    "getDocumentLeft",
    "orig",
    "skipDetection",
    "origCoords",
    "leftPos",
    "spacer",
    "_getChildren",
    "getPaddingLeft",
    "setWidth",
    "getBounds",
    "lastCoords",
    "distance",
    "isOpen",
    "getUserData",
    "setDomPosition",
    "Timer",
    "once",
    "openNode",
    "setUserData",
    "getAction",
    "resetAction",
    "console",
    "assert",
    "setAction",
    "onDrop",
    "clone",
    "getDisplayName",
    "moveAfter",
    "snackbar",
    "Controller",
    "info",
    "insertAfter",
    "moveBefore",
    "insertBefore",
    "moveInside",
    "insertChild",
    "onDragEnd",
    "resetUserData",
    "resetDragging",
    "children",
    "sorting",
    "minPosition",
    "targetIndex",
    "indexOf",
    "found",
    "sibling",
    "name",
    "typeChooserForm",
    "ElementForm",
    "allowCancel",
    "context",
    "message",
    "formData",
    "type",
    "help",
    "options",
    "sort",
    "a",
    "b",
    "localeCompare",
    "map",
    "validation",
    "required",
    "show",
    "promise",
    "then",
    "ownerDocument",
    "isElement",
    "createComment",
    "createTextNode",
    "createCDATASection",
    "createElement",
    "schemaElement",
    "getSchemaElementForElementName",
    "initChildren",
    "requiredChildren",
    "getRequiredElements",
    "schema",
    "Element",
    "sortChildNodes",
    "childName",
    "child",
    "appendChild",
    "isTextContentRequired",
    "xmlElement",
    "XmlElement",
    "getEditor",
    "res",
    "isShowEditButton",
    "setSelection",
    "err",
    "targetName",
    "depth",
    "currentPosition",
    "split",
    "test",
    "parseInt",
    "min",
    "__checkProvider",
    "provider",
    "Provider",
    "getLive",
    "userInputAllowed",
    "includes",
    "endsWith",
    "isArray",
    "unshift",
    "__getAttributeFormDefinition",
    "attribute",
    "docs",
    "getDocumentation",
    "def",
    "join",
    "enabled",
    "getDefaultValue",
    "isOptional",
    "validator",
    "ListItem",
    "getValue",
    "isValueValid",
    "ValidationError",
    "getTypeString",
    "enums",
    "getEnumeration",
    "isNew",
    "title",
    "caption",
    "getShowEditButton",
    "typeElement",
    "nodeType",
    "Node",
    "ELEMENT_NODE",
    "allowed",
    "getAllowedAttributes",
    "getExpert",
    "appInfo",
    "getAppinfo",
    "parser",
    "DOMParser",
    "attrName",
    "nodeName",
    "lines",
    "autoSize",
    "innerHTML",
    "dom",
    "parseFromString",
    "getElementsByTagName",
    "TEXT_NODE",
    "COMMENT_NODE",
    "CDATA_SECTION_NODE",
    "getTextContent",
    "isTextNode",
    "convertTextNodeType",
    "newNodeName",
    "formDialog",
    "maxWidth",
    "setAttributes",
    "validate",
    "destroy",
    "remove",
    "execCommand",
    "setClipboard",
    "copy",
    "clipboardElement",
    "getClipboard",
    "resetClipboard",
    "updateModified",
    "previewIndex",
    "$$removed",
    "splice",
    "isModified",
    "setModified",
    "_onContentChanged",
    "_createChildControl",
    "addSeparator",
    "addSpacer",
    "_applySelected",
    "_updateHighlightWidget",
    "node",
    "openPage",
    "parentNode",
    "setHighlightWidget",
    "getWidgetPath",
    "isVisible",
    "_applyContent",
    "open",
    "initialValidation",
    "modified",
    "validateXmlConfig",
    "getPath",
    "__loadContent",
    "Main",
    "closeFile",
    "Bus",
    "dispatchByName",
    "getFullPath",
    "handler",
    "jumpToError",
    "hide",
    "resetModel",
    "FileItem",
    "ROOT",
    "f",
    "setTemporary",
    "errors",
    "doc",
    "xml",
    "Document",
    "fromString",
    "rootElement",
    "documentElement",
    "getAttributeNS",
    "getElementNode",
    "getStructure",
    "setEditable",
    "getWriteable",
    "setModel",
    "setContentPaddingBottom",
    "isTemporary",
    "parts",
    "substr",
    "part",
    "shift",
    "match",
    "exec",
    "toString",
    "setValid",
    "content",
    "getCurrentContent",
    "contentChanged",
    "isAutoRefreshPreview",
    "reset",
    "previewFile",
    "_client",
    "createSync",
    "getBusTopic",
    "source",
    "resetTemporary",
    "updateSync",
    "fast",
    "XMLSerializer",
    "serializeToString",
    "Prettifier",
    "_onSaved",
    "onSaved",
    "focusedWidget",
    "FocusHandler",
    "getFocusedWidget",
    "dialogConf",
    "modal",
    "image",
    "maxHeight",
    "getHeight",
    "BigAlert",
    "destruct",
    "_disposeArray",
    "removeListener"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACAH,EAAAA,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,2BAAhB,EAA6C;AAC3CC,IAAAA,MAAM,EAAEC,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBC,cADc;;AAG3C;AACF;AACA;AACA;AACA;AACEC,IAAAA,SAAS,EAAE,qBAAY;AAAA;;AACrB;;AACA,WAAKC,UAAL,CAAgB,IAAIb,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAaC,IAAjB,EAAhB;;AACA,WAAKC,eAAL,GAAuB,CAAC,MAAD,EAAS,KAAT,EAAgB,MAAhB,EAAwB,OAAxB,EAAiC,MAAjC,EAAyC,MAAzC,EAAiD,MAAjD,CAAvB;;AACA,WAAKC,WAAL,GAJqB,CAMrB;;;AACA,WAAKC,QAAL,GAAgB,EAAhB;AACA,WAAKC,QAAL,GAA0B,EAA1B;AACA,WAAKC,QAAL,GAAiC,IAAIpB,EAAE,CAACqB,IAAH,CAAQC,KAAZ,EAAjC;;AACA,WAAKF,QAAL,CAA+BG,WAA/B,CAA2C,cAA3C,EAA2D,UAAAC,EAAE,EAAI;AAC/D,YAAIA,EAAE,CAACC,OAAH,OAAiB,CAArB,EAAwB;AACtB,UAAA,KAAI,CAACC,eAAL,CAAqB,QAArB;AACD,SAFD,MAEO;AACL,cAAMC,gBAAgB,GAAG,KAAI,CAACP,QAAL,CAA+BQ,IAA/B,CAAoC,UAAAC,OAAO;AAAA,mBAAIA,OAAO,CAACC,mBAAR,EAAJ;AAAA,WAA3C,CAAzB;;AACA,UAAA,KAAI,CAACJ,eAAL,CAAqBC,gBAAgB,GAAG,kBAAH,GAAwB,SAA7D;AACD;AACF,OAPD,EAOG,IAPH;;AAQA,WAAKI,SAAL,CAAe,IAAI/B,EAAE,CAACqB,IAAH,CAAQC,KAAZ,EAAf;AACA,WAAKU,SAAL,CAAe,IAAIhC,EAAE,CAACqB,IAAH,CAAQC,KAAZ,EAAf;AACA,WAAKW,QAAL,GAAyB,EAAzB;AACAjC,MAAAA,EAAE,CAACkC,IAAH,CAAQC,IAAR,CAAaC,cAAb,GAA8BC,OAA9B,GAAwCd,WAAxC,CAAoD,OAApD,EAA6D,KAAKe,eAAlE,EAAmF,IAAnF;AACA,WAAKf,WAAL,CAAiB,QAAjB,EAA2B,KAAKgB,0BAAhC,EAA4D,IAA5D;;AACA,WAAKC,KAAL;AACD,KAhC0C;;AAkC3C;AACF;AACA;AACA;AACA;AACEC,IAAAA,OAAO,EAAE;AACPC,MAAAA,eAAe,EAAE,kCADV;AAEPC,MAAAA,KAAK,EAAE3C,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,YAArB,CAFA;AAGPC,MAAAA,IAAI,EAAExC,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,KAA7B,EAAoC,EAApC,CAHC;AAKPC,MAAAA,OAAO,EAAE;AACPC,QAAAA,IAAI,EAAE,CADC;AAEPC,QAAAA,MAAM,EAAE,CAFD;AAGPC,QAAAA,KAAK,EAAE,CAHA;AAIPC,QAAAA,MAAM,EAAE,CAJD;AAKPC,QAAAA,WAAW,EAAE,CALN,CAKQ;;AALR;AALF,KAvCkC;;AAqD3C;AACF;AACA;AACA;AACA;AACEC,IAAAA,UAAU,EAAE;AACVC,MAAAA,UAAU,EAAE;AACVC,QAAAA,MAAM,EAAE,IADE;AAEVC,QAAAA,IAAI,EAAE;AAFI,OADF;AAKV;AACAC,MAAAA,MAAM,EAAE;AACNC,QAAAA,KAAK,EAAE,SADD;AAENF,QAAAA,IAAI,EAAE;AAFA,OANE;AAWVG,MAAAA,KAAK,EAAE;AACLJ,QAAAA,MAAM,EAAE,IADH;AAELC,QAAAA,IAAI,EAAE;AAFD,OAXG;AAgBVI,MAAAA,QAAQ,EAAE;AACRF,QAAAA,KAAK,EAAE,gCADC;AAERG,QAAAA,QAAQ,EAAE,IAFF;AAGRC,QAAAA,KAAK,EAAE,gBAHC;AAIRC,QAAAA,KAAK,EAAE;AAJC,OAhBA;AAuBVC,MAAAA,SAAS,EAAE;AACTN,QAAAA,KAAK,EAAE,gCADE;AAETG,QAAAA,QAAQ,EAAE,IAFD;AAGTC,QAAAA,KAAK,EAAE,iBAHE;AAITC,QAAAA,KAAK,EAAE;AAJE,OAvBD;AA8BVE,MAAAA,KAAK,EAAE;AACLP,QAAAA,KAAK,EAAE,eADF;AAELQ,QAAAA,YAAY,EAAE;AAFT,OA9BG;AAmCVC,MAAAA,KAAK,EAAE;AACLT,QAAAA,KAAK,EAAE,eADF;AAELQ,QAAAA,YAAY,EAAE;AAFT,OAnCG;AAwCVE,MAAAA,kBAAkB,EAAE;AAClBV,QAAAA,KAAK,EAAE,SADW;AAElBF,QAAAA,IAAI,EAAE;AAFY,OAxCV;;AA6CV;AACJ;AACA;AACIa,MAAAA,YAAY,EAAE;AACZX,QAAAA,KAAK,EAAE,CAAC,QAAD,EAAW,SAAX,EAAsB,kBAAtB,CADK;AAEZF,QAAAA,IAAI,EAAE,QAFM;AAGZM,QAAAA,KAAK,EAAE,qBAHK;AAIZC,QAAAA,KAAK,EAAE;AAJK,OAhDJ;AAuDVO,MAAAA,WAAW,EAAE;AACXZ,QAAAA,KAAK,EAAE,SADI;AAEXF,QAAAA,IAAI,EAAE,IAFK;AAGXO,QAAAA,KAAK,EAAE,mBAHI;AAIXD,QAAAA,KAAK,EAAE;AAJI,OAvDH;;AA6DV;AACJ;AACA;AACIS,MAAAA,QAAQ,EAAE;AACRb,QAAAA,KAAK,EAAE,SADC;AAERF,QAAAA,IAAI,EAAE,KAFE;AAGRM,QAAAA,KAAK,EAAE;AAHC;AAhEA,KA1D+B;;AAiI3C;AACF;AACA;AACA;AACA;AACEU,IAAAA,OAAO,EAAE;AACP3D,MAAAA,QAAQ,EAAE,IADH;AAEPC,MAAAA,QAAkB,EAAE,IAFb;AAGPC,MAAAA,QAAyB,EAAE,IAHpB;AAIP0D,MAAAA,cAAc,EAAE,IAJT;AAKPC,MAAAA,QAAS,EAAE,KALJ;AAMP9C,MAAAA,QAAiB,EAAE,IANZ;AAOP+C,MAAAA,QAAe,EAAE,IAPV;AAQPC,MAAAA,QAAmB,EAAE,CARd;AASPC,MAAAA,UAAU,EAAE,IATL;AAWDC,MAAAA,SAXC,qBAWSC,IAXT,EAWe;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACpB,sBAAIA,IAAI,CAACC,UAAL,CAAgB,KAAhB,CAAJ,EAA4B;AAC1BD,oBAAAA,IAAI,GAAGA,IAAI,CAACE,SAAL,CAAe,CAAf,CAAP;AACD;;AACD,sBAAI,CAACC,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,MAArC,EAA2CN,IAA3C,CAAL,EAAuD;AACrD,oBAAA,MAAI,CAAClE,QAAL,CAAckE,IAAd,IAAsB7E,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBC,MAApB,CAA2BC,WAA3B,CAAuCT,IAAvC,CAAtB;AACD;;AANmB,mDAOb,IAAIU,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oBAAA,MAAI,CAAC9E,QAAL,CAAckE,IAAd,EAAoBa,QAApB,CAA6B,YAAY;AACvC,2BAAKC,QAAL,CAAc,IAAd;AACAH,sBAAAA,OAAO,CAAC,KAAK7E,QAAL,CAAckE,IAAd,CAAD,CAAP;AACD,qBAHD,EAGG,MAHH;AAID,mBALM,CAPa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAarB,OAxBM;AA0BPe,MAAAA,eAAe,EAAE,2BAAY;AAC3B,eAAO,KAAKC,eAAL,OAA2B,QAAlC;AACD,OA5BM;AA8BPC,MAAAA,oBAAoB,EAAE,gCAAY;AAChC,aAAK9D,0BAAL;AACD,OAhCM;AAkCPA,MAAAA,0BAA0B,EAAE,sCAAY;AACtC,YAAM+D,cAAc,GAAG,KAAKC,iBAAL,EAAvB;AACA,aAAKC,cAAL,CAAoBxG,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,KAA6B,GAA7B,KAAqC,CAACL,cAAD,IAAmB,CAACA,cAAc,CAACM,SAAxE,CAApB;AACD,OArCM;AAuCPC,MAAAA,iBAAiB,EAAE,2BAAUC,KAAV,EAAiB;AAClC,aAAKC,eAAL,CAAqB,OAArB,EAA8BC,aAA9B,CAA4CF,KAAK,GAAG,SAAH,GAAe,UAAhE;;AACA,YAAIA,KAAJ,EAAW;AACT,eAAKC,eAAL,CAAqB,MAArB,EAA6BE,qBAA7B;AACA,eAAKF,eAAL,CAAqB,MAArB,EAA6BG,sBAA7B;AACD,SAHD,MAGO;AACL,cAAMZ,cAAc,GAAG,KAAKC,iBAAL,EAAvB;;AACA,cAAI,CAACD,cAAD,IAAmB,CAACA,cAAc,CAACa,SAAvC,EAAkD;AAChD,iBAAKJ,eAAL,CAAqB,MAArB,EAA6BK,mBAA7B,CAAiD;AAACC,cAAAA,IAAI,EAAE;AAAP,aAAjD;AACD;AACF;;AACD,YAAMjC,IAAI,GAAG,KAAKkC,OAAL,EAAb;;AACA,YAAIR,KAAK,IAAI1B,IAAb,EAAmB;AACjB,cAAMmC,OAAO,GAAG,KAAKR,eAAL,CAAqB,SAArB,CAAhB;;AACA,cAAI3B,IAAI,CAACoC,WAAL,EAAJ,EAAwB;AACtB,gBAAI,CAACD,OAAO,CAACD,OAAR,EAAL,EAAwB;AACtBC,cAAAA,OAAO,CAACE,OAAR,CAAgB,KAAKC,QAAL,EAAhB;AACD;AACF,WAJD,MAIO;AACL;AACAH,YAAAA,OAAO,CAACE,OAAR,CAAgBrC,IAAhB;AACD;;AACD,eAAKuC,cAAL;AACD;AACF,OA/DM;AAiEPC,MAAAA,YAAY,EAAE,sBAAUC,UAAV,EAAsB;AAClC,YAAI,KAAKC,eAAL,CAAqBD,UAArB,CAAJ,EAAsC;AACpC,kBAAQA,UAAR;AACE,iBAAK,MAAL;AACE,kBAAI,CAAC,KAAK9C,QAAV,EAAqB;AACnB,qBAAKgD,IAAL;AACD;;AACD;;AAEF,iBAAK,MAAL;AACE,kBAAI,CAAC,KAAKhD,QAAV,EAAqB;AACnB,qBAAKiD,IAAL;AACD;;AACD;;AAEF,iBAAK,KAAL;AACE,mBAAKC,MAAL;;AACA;;AAEF,iBAAK,MAAL;AACE,mBAAKC,OAAL;;AACA;;AAEF,iBAAK,OAAL;AACE,mBAAKC,QAAL;;AACA;;AAEF,iBAAK,MAAL;AACE,kBAAI,CAAC,KAAKpD,QAAV,EAAqB;AACnB,qBAAKqD,SAAL;AACD;;AACD;;AAEF;AACE,qFAAqBP,UAArB;AACA;AAjCJ;AAmCD;AACF,OAvGM;AAyGPQ,MAAAA,eAAe,EAAE,yBAAUC,QAAV,EAAoBC,MAApB,EAA4B;AAAA;;AAC3C,gBAAQD,QAAR;AACE,eAAK,MAAL;AACE,iBAAKrG,QAAL,CAAuBqG,QAAvB,IAAmC,KAAKE,QAAL,GAAgBjH,WAAhB,CAA4B,cAA5B,EAA4C,YAAM;AACnF,kBAAMkH,MAAM,GAAG,MAAI,CAACD,QAAL,GAAgBC,MAA/B;;AACA,kBAAIA,MAAM,GAAG,CAAb,EAAgB;AACdF,gBAAAA,MAAM,CAACG,UAAP,CAAkB,IAAlB;AACAH,gBAAAA,MAAM,CAACI,cAAP,CAAsB,MAAI,CAAC7F,EAAL,CAAQ,UAAR,EAAoB,MAAI,CAAC0F,QAAL,GAAgBI,OAAhB,CAAwBH,MAAM,GAAG,CAAjC,EAAoCI,QAApC,EAApB,CAAtB;AACD,eAHD,MAGO;AACLN,gBAAAA,MAAM,CAACG,UAAP,CAAkB,KAAlB;AACAH,gBAAAA,MAAM,CAACO,gBAAP;AACD;AACF,aATkC,EAShC,IATgC,CAAnC;AAUAP,YAAAA,MAAM,CAACG,UAAP,CAAkB,KAAKF,QAAL,GAAgBC,MAAhB,GAAyB,CAA3C;AACA;;AAEF,eAAK,MAAL;AACE,iBAAKxG,QAAL,CAAuBqG,QAAvB,IAAmC,KAAKS,QAAL,GAAgBxH,WAAhB,CAA4B,cAA5B,EAA4C,YAAM;AACnF,kBAAMkH,MAAM,GAAG,MAAI,CAACM,QAAL,GAAgBN,MAA/B;;AACA,kBAAIA,MAAM,GAAG,CAAb,EAAgB;AACdF,gBAAAA,MAAM,CAACG,UAAP,CAAkB,IAAlB;AACAH,gBAAAA,MAAM,CAACI,cAAP,CAAsB,MAAI,CAAC7F,EAAL,CAAQ,UAAR,EAAoB,MAAI,CAACiG,QAAL,GAAgBH,OAAhB,CAAwBH,MAAM,GAAG,CAAjC,EAAoCI,QAApC,EAApB,CAAtB;AACD,eAHD,MAGO;AACLN,gBAAAA,MAAM,CAACG,UAAP,CAAkB,KAAlB;AACAH,gBAAAA,MAAM,CAACO,gBAAP;AACD;AACF,aATkC,EAShC,IATgC,CAAnC;AAUAP,YAAAA,MAAM,CAACG,UAAP,CAAkB,KAAKK,QAAL,GAAgBN,MAAhB,GAAyB,CAA3C;AACA;;AAEF,eAAK,KAAL;AACE,iBAAKO,IAAL,CAAU,UAAV,EAAsBT,MAAtB,EAA8B,SAA9B,EAAyC;AACvCU,cAAAA,SAAS,EAAE,mBAAUnC,KAAV,EAAiB;AAC1B,uBAAOA,KAAK,GAAG,CAACA,KAAK,CAACoC,WAAN,EAAJ,GAA0B,KAAtC;AACD;AAHsC,aAAzC;AAKA;;AAEF,eAAK,MAAL;AACE,iBAAKF,IAAL,CAAU,UAAV,EAAsBT,MAAtB,EAA8B,SAA9B,EAAyC;AACvCU,cAAAA,SAAS,EAAE,mBAAUnC,KAAV,EAAiB;AAC1B,uBAAO,CAAC,CAACA,KAAT;AACD;AAHsC,aAAzC;AAKA;;AAEF,eAAK,OAAL;AACE,iBAAKkC,IAAL,CAAU,WAAV,EAAuBT,MAAvB,EAA+B,SAA/B,EAA0C;AACxCU,cAAAA,SAAS,EAAE,mBAAUnC,KAAV,EAAiB;AAC1B,uBAAO,CAAC,CAACA,KAAT;AACD;AAHuC,aAA1C;AAKA;AAnDJ;AAqDD,OA/JM;AAgKPqC,MAAAA,iBAAiB,EAAE,2BAAUb,QAAV,EAAoBC,MAApB,EAA4B;AAC7C,gBAAQD,QAAR;AACE,eAAK,MAAL;AACE,gBAAI,KAAKrG,QAAL,CAAuBqG,QAAvB,CAAJ,EAAsC;AACpC,mBAAKE,QAAL,GAAgBY,kBAAhB,CAAmC,KAAKnH,QAAL,CAAuBqG,QAAvB,CAAnC;AACA,qBAAO,KAAKrG,QAAL,CAAuBqG,QAAvB,CAAP;AACD;;AACDC,YAAAA,MAAM,CAACG,UAAP,CAAkB,KAAlB;AACA;;AAEF,eAAK,MAAL;AACE,gBAAI,KAAKzG,QAAL,CAAuBqG,QAAvB,CAAJ,EAAsC;AACpC,mBAAKS,QAAL,GAAgBK,kBAAhB,CAAmC,KAAKnH,QAAL,CAAuBqG,QAAvB,CAAnC;AACA,qBAAO,KAAKrG,QAAL,CAAuBqG,QAAvB,CAAP;AACD;;AACDC,YAAAA,MAAM,CAACG,UAAP,CAAkB,KAAlB;AACA;;AAEF,eAAK,OAAL;AACA,eAAK,KAAL;AACA,eAAK,MAAL;AACE,iBAAKW,qBAAL,CAA2Bd,MAA3B;AACA;AArBJ;AAuBD,OAxLM;AA0LPe,MAAAA,OAAO,EAAE,iBAAUC,aAAV,EAAyB;AAChC,YAAIA,aAAa,YAAYhJ,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoB6D,aAAjD,EAAgE;AAC9D,eAAKhB,QAAL,GAAgBiB,IAAhB,CAAqBF,aAArB;AACD;AACF,OA9LM;AAgMPxB,MAAAA,IAAI,EAAE,gBAAY;AAChB,YAAMzD,KAAK,GAAG,KAAKkE,QAAL,EAAd;;AACA,YAAIlE,KAAK,CAACmE,MAAN,GAAe,CAAnB,EAAsB;AACpB,cAAMc,aAAa,GAAGjF,KAAK,CAACoF,GAAN,EAAtB;;AACA,cAAIH,aAAa,CAACxB,IAAd,EAAJ,EAA0B;AACxB,iBAAKgB,QAAL,GAAgBU,IAAhB,CAAqBF,aAArB;AACD,WAFD,MAEO;AACL,iBAAKI,KAAL,CAAW,oBAAoBJ,aAAa,CAACV,QAAd,EAA/B;AACAvE,YAAAA,KAAK,CAACmF,IAAN,CAAWF,aAAX;AACD;AACF;AACF,OA3MM;AA6MPvB,MAAAA,IAAI,EAAE,gBAAY;AAChB,YAAMxD,KAAK,GAAG,KAAKuE,QAAL,EAAd;;AACA,YAAIvE,KAAK,CAACiE,MAAN,GAAe,CAAnB,EAAsB;AACpB,cAAMc,aAAa,GAAG/E,KAAK,CAACkF,GAAN,EAAtB;;AACA,cAAIH,aAAa,CAACvB,IAAd,EAAJ,EAA0B;AACxB,iBAAKQ,QAAL,GAAgBiB,IAAhB,CAAqBF,aAArB;AACD,WAFD,MAEO;AACL,iBAAKI,KAAL,CAAW,oBAAoBJ,aAAa,CAACV,QAAd,EAA/B;AACArE,YAAAA,KAAK,CAACiF,IAAN,CAAWF,aAAX;AACD;AACF;AACF,OAxNM;AA0NPK,MAAAA,eAAe,EAAE,2BAAY;AAC3B,aAAKpB,QAAL,GAAgBqB,SAAhB,GAA4BC,OAA5B,CAAoC,UAAAC,IAAI;AAAA,iBAAIA,IAAI,CAACC,OAAL,EAAJ;AAAA,SAAxC;AACA,aAAKC,UAAL;AACD,OA7NM;AA+NPA,MAAAA,UAAU,EAAE,sBAAY;AACtB,aAAKlB,QAAL,GAAgBc,SAAhB,GAA4BC,OAA5B,CAAoC,UAAAC,IAAI;AAAA,iBAAIA,IAAI,CAACC,OAAL,EAAJ;AAAA,SAAxC;AACD,OAjOM;AAmOPE,MAAAA,eAAe,EAAE,yBAAUpD,KAAV,EAAiB;AAChC,YAAI;AACF,cAAIA,KAAJ,EAAW;AACTqD,YAAAA,SAAS,CAAC9F,SAAV,CAAoB+F,SAApB,CAA8BtD,KAAK,CAACuD,OAAN,GAAgBC,SAA9C;AACD,WAFD,MAEO;AACLH,YAAAA,SAAS,CAAC9F,SAAV,CAAoB+F,SAApB,CAA8B,EAA9B;AACD;AACF,SAND,CAME,OAAOG,CAAP,EAAU;AACV;AACAhK,UAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBC,cAArB,CAAoC6J,SAApC,GAAgD1D,KAAK,GAAGA,KAAK,CAACuD,OAAN,GAAgBC,SAAnB,GAA+B,EAApF;AACD;AACF,OA9OM;AAgPPrJ,MAAAA,WAAW,EAAE,uBAAY;AACvB,aAAK6D,cAAL,GAAsBvE,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB+J,MAArB,CAA4B5E,WAA5B,EAAtB;AACD,OAlPM;AAoPP6E,MAAAA,UAAU,EAAE,oBAAUC,IAAV,EAAgBC,SAAhB,EAA2B,CACtC,CArPM;AAsPPC,MAAAA,eAAe,EAAE,yBAAUF,IAAV,EAAgBG,UAAhB,EAA4B,CAC5C,CAvPM;AAyPPC,MAAAA,SAAS,EAAE,mBAAU3F,IAAV,EAAgB4F,GAAhB,EAAqB;AAC9B,YAAIA,GAAG,IAAI,KAAKlG,cAAhB,EAAgC;AAC9B,eAAKA,cAAL,CAAoBmG,KAApB,CAA0BD,GAA1B;AACD;;AACD,YAAI5F,IAAI,IAAIA,IAAI,CAAC8F,OAAL,OAAmB,MAA3B,IAAqC,KAAKC,WAAL,CAAiB/F,IAAjB,CAAzC,EAAiE;AAC/D,8EAAqBA,IAArB,EAA2B4F,GAA3B;AACD,SAFD,MAEO;AACL,8EAAqB,IAArB,EAA2BA,GAA3B;;AACA,cAAI,KAAKI,eAAL,CAAqB,SAArB,CAAJ,EAAqC;AACnC,iBAAKrE,eAAL,CAAqB,SAArB,EAAgCsE,SAAhC;AACD;;AACD,eAAKC,iBAAL;AACD;AACF,OAtQM;AAwQP;AACAC,MAAAA,uBAAuB,EAAG,iCAASC,EAAT,EAAaC,IAAb,EAAmB;AAAA;;AAC3C,YAAIC,OAAJ;;AAEA,gBAAQF,EAAR;AACG,eAAK,WAAL;AACEE,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMmL,SAAN,CAAgBC,SAApB,CAA8B,IAAI5L,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAa+K,IAAjB,EAA9B,CAAV;;AACA,iBAAKC,IAAL,CAAUJ,OAAV;;AACA;;AAEF,eAAK,MAAL;AACEA,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMmL,SAAN,CAAgBC,SAApB,CAA8B,IAAI5L,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAaiL,MAAjB,EAA9B,CAAV;AACA,iBAAKhF,eAAL,CAAqB,WAArB,EAAkCiF,KAAlC,CAAwCN,OAAxC,EAAiD,CAAjD;AACA;;AAEF,eAAK,OAAL;AACEA,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMmL,SAAN,CAAgBC,SAApB,CAA8B,IAAI5L,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAamL,IAAjB,EAA9B,CAAV;;AACA,gBAAI,CAAC,KAAKC,aAAL,EAAL,EAA2B;AACzBR,cAAAA,OAAO,CAACS,OAAR;AACD;;AACD,iBAAKpF,eAAL,CAAqB,WAArB,EAAkCiF,KAAlC,CAAwCN,OAAxC,EAAiD,CAAjD,EAAoD;AAACrE,cAAAA,IAAI,EAAE;AAAP,aAApD;AACA;;AAEF,eAAK,SAAL;AACEqE,YAAAA,OAAO,GAAG,IAAInL,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2L,MAAd,CAAqBC,MAAzB,EAAV;AACAX,YAAAA,OAAO,CAACY,GAAR,CAAY;AACVC,cAAAA,MAAM,EAAE,QADE;AAEVC,cAAAA,QAAQ,EAAE;AAFA,aAAZ;AAIA,iBAAKzF,eAAL,CAAqB,OAArB,EAA8BiF,KAA9B,CAAoCN,OAApC,EAA6C,CAA7C,EAAgD;AAACrE,cAAAA,IAAI,EAAE;AAAP,aAAhD;AACA;;AAEF,eAAK,mBAAL;AAA0B;AACxB,kBAAMoF,EAAE,GAAG,KAAK3J,EAAL,CAAQ,8DAAR,CAAX;AACA,kBAAM4J,MAAM,GAAG,KAAK5J,EAAL,CAAQ,gDAAR,CAAf;AACA,kBAAM6J,KAAK,GAAG,KAAK7J,EAAL,CAAQ,kJAAR,CAAd;AACA4I,cAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMoM,KAAN,CAAYC,IAAhB,CAAqBJ,EAArB,EAAyBlM,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,OAA7B,EAAsC,EAAtC,CAAzB,CAAV;AACAuI,cAAAA,OAAO,CAACoB,OAAR,CAAgB,IAAhB;AACApB,cAAAA,OAAO,CAAC3E,eAAR,CAAwB,OAAxB,EAAiCgG,OAAjC,CAAyC,IAAzC;AACArB,cAAAA,OAAO,CAACnK,WAAR,CAAoB,KAApB,EAA2B,YAAM;AAC/B,oBAAI,CAAC,MAAI,CAAC4E,eAAL,EAAD,IAA2B,MAAI,CAAC+F,aAAL,EAA/B,EAAqD;AACnD,kBAAA,MAAI,CAACvE,cAAL;AACD;AACF,eAJD,EAIG,IAJH;AAKA,mBAAKZ,eAAL,CAAqB,OAArB,EAA8BiF,KAA9B,CAAoCN,OAApC,EAA6C,CAA7C;AACA,mBAAKnK,WAAL,CAAiB,qBAAjB,EAAwC,UAAAC,EAAE,EAAI;AAC5C,wBAAQA,EAAE,CAACC,OAAH,EAAR;AACE,uBAAK,QAAL;AACEiK,oBAAAA,OAAO,CAACY,GAAR,CAAY;AACVU,sBAAAA,KAAK,EAAEP,EADG;AAEVQ,sBAAAA,IAAI,EAAE1M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,OAA7B,EAAsC,EAAtC;AAFI,qBAAZ;AAIAuI,oBAAAA,OAAO,CAAC3E,eAAR,CAAwB,MAAxB,EAAgCmG,WAAhC,CAA4C,OAA5C;AACAxB,oBAAAA,OAAO,CAAC3E,eAAR,CAAwB,MAAxB,EAAgCmG,WAAhC,CAA4C,SAA5C;AACA;;AAEF,uBAAK,SAAL;AACExB,oBAAAA,OAAO,CAACY,GAAR,CAAY;AACVU,sBAAAA,KAAK,EAAEN,MADG;AAEVO,sBAAAA,IAAI,EAAE1M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,aAA7B,EAA4C,EAA5C;AAFI,qBAAZ;AAIAuI,oBAAAA,OAAO,CAAC3E,eAAR,CAAwB,MAAxB,EAAgCmG,WAAhC,CAA4C,OAA5C;AACAxB,oBAAAA,OAAO,CAAC3E,eAAR,CAAwB,MAAxB,EAAgCoG,QAAhC,CAAyC,SAAzC;AACA;;AAEF,uBAAK,kBAAL;AACEzB,oBAAAA,OAAO,CAACY,GAAR,CAAY;AACVU,sBAAAA,KAAK,EAAEL,KADG;AAEVM,sBAAAA,IAAI,EAAE1M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,aAA7B,EAA4C,EAA5C;AAFI,qBAAZ;AAIAuI,oBAAAA,OAAO,CAAC3E,eAAR,CAAwB,MAAxB,EAAgCoG,QAAhC,CAAyC,OAAzC;AACAzB,oBAAAA,OAAO,CAAC3E,eAAR,CAAwB,MAAxB,EAAgCmG,WAAhC,CAA4C,SAA5C;AACA;AA1BJ;AA4BD,eA7BD,EA6BG,IA7BH;AA8BA;AACD;;AAED,eAAK,aAAL;AACExB,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAM4M,OAAN,CAAcC,MAAlB,CAAyB,IAAzB,EAA+B9M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,EAArC,CAA/B,CAAV;AACAuI,YAAAA,OAAO,CAAChD,UAAR,CAAmB,KAAnB;AACAgD,YAAAA,OAAO,CAACnK,WAAR,CAAoB,SAApB,EAA+B,KAAK+L,OAApC,EAA6C,IAA7C;AACA,iBAAKtE,IAAL,CAAU,gBAAV,EAA4B0C,OAA5B,EAAqC,MAArC,EAA6C;AAC3CzC,cAAAA,SAAS,EAAE,mBAAUnC,KAAV,EAAiB;AAC1B,uBAAOA,KAAK,GAAGvG,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,EAArC,CAAH,GAA8C5C,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,EAArC,CAA1D;AACD;AAH0C,aAA7C;AAKA,iBAAK4D,eAAL,CAAqB,SAArB,EAAgCwG,GAAhC,CAAoC7B,OAApC;AACA;;AAEF,eAAK,eAAL;AACEA,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAM4M,OAAN,CAAcC,MAAlB,CAAyB,IAAzB,EAA+B9M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,QAA7B,EAAuC,EAAvC,CAA/B,CAAV;AACAuI,YAAAA,OAAO,CAAChD,UAAR,CAAmB,KAAnB;AACAgD,YAAAA,OAAO,CAACnK,WAAR,CAAoB,SAApB,EAA+B,KAAKiM,SAApC,EAA+C,IAA/C;AACA,iBAAKzG,eAAL,CAAqB,SAArB,EAAgCwG,GAAhC,CAAoC7B,OAApC;AACA;;AAEF,eAAK,eAAL;AACEA,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAM4M,OAAN,CAAcK,QAAlB,CAA2B,KAAK3K,EAAL,CAAQ,YAAR,CAA3B,EACRvC,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,QAA7B,EAAuC,EAAvC,CADQ,CAAV;AAEAuI,YAAAA,OAAO,CAACnK,WAAR,CAAoB,SAApB,EAA+B,YAAY;AACzC,mBAAKmM,YAAL;AACD,aAFD,EAEG,IAFH;AAGA,iBAAK3G,eAAL,CAAqB,SAArB,EAAgCwG,GAAhC,CAAoC7B,OAApC;AACA;;AAEF,eAAK,iBAAL;AACEA,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAM4M,OAAN,CAAcC,MAAlB,CAAyB,IAAzB,EAA+B9M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,QAA7B,EAAuC,EAAvC,CAA/B,CAAV;AACAuI,YAAAA,OAAO,CAAC/C,cAAR,CAAuB,KAAK7F,EAAL,CAAQ,gBAAR,CAAvB;AACA4I,YAAAA,OAAO,CAACnK,WAAR,CAAoB,SAApB,EAA+B,KAAKoG,cAApC,EAAoD,IAApD;AACA,iBAAKqB,IAAL,CAAU,aAAV,EAAyB0C,OAAzB,EAAkC,YAAlC,EAAgD;AAC9CzC,cAAAA,SAAS,EAAE,mBAAUnC,KAAV,EAAiB;AAC1B,uBAAOA,KAAK,GAAG,SAAH,GAAe,QAA3B;AACD;AAH6C,aAAhD;AAKA,iBAAKkC,IAAL,CAAU,cAAV,EAA0B0C,OAA1B,EAAmC,SAAnC,EAA8C;AAC5CzC,cAAAA,SAAS,EAAE,mBAAUnC,KAAV,EAAiB;AAC1B,uBAAOA,KAAK,KAAK,QAAjB;AACD;AAH2C,aAA9C;AAKA,iBAAKC,eAAL,CAAqB,SAArB,EAAgCwG,GAAhC,CAAoC7B,OAApC;AACA;;AAEF,eAAK,SAAL;AACEA,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAM4M,OAAN,CAAcO,OAAlB,EAAV;AACA,iBAAK5G,eAAL,CAAqB,MAArB,EAA6BwG,GAA7B,CAAiC7B,OAAjC,EAA0C;AACxCkC,cAAAA,GAAG,EAAE,CADmC;AAExCC,cAAAA,IAAI,EAAE,CAFkC;AAGxCC,cAAAA,KAAK,EAAE;AAHiC,aAA1C;AAKA;;AAEF,eAAK,qBAAL;AACEpC,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMmL,SAAN,CAAgBC,SAApB,CAA8B,IAAI5L,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAa+K,IAAjB,EAA9B,CAAV;AACA,iBAAK9E,eAAL,CAAqB,MAArB,EAA6BwG,GAA7B,CAAiC7B,OAAjC,EAA0C;AACxCkC,cAAAA,GAAG,EAAE,EADmC;AAExCC,cAAAA,IAAI,EAAE,CAFkC;AAGxCC,cAAAA,KAAK,EAAE;AAHiC,aAA1C;AAKA;;AAEF,eAAK,WAAL;AACEpC,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMuN,IAAN,CAAWC,SAAf,EAAV;AACAtC,YAAAA,OAAO,CAACY,GAAR,CAAY;AACV2B,cAAAA,UAAU,EAAE,IADF;AAEVC,cAAAA,WAAW,EAAE,KAAKpL,EAAL,CAAQ,WAAR,CAFH;AAGVqL,cAAAA,MAAM,EAAE;AAHE,aAAZ;AAKAzC,YAAAA,OAAO,CAACnK,WAAR,CAAoB,aAApB,EAAmCvB,EAAE,CAACoO,IAAH,CAAQC,QAAR,CAAiBC,QAAjB,CAA0B,KAAKC,SAA/B,EAA0C,GAA1C,CAAnC,EAAmF,IAAnF;AACA7C,YAAAA,OAAO,CAACnK,WAAR,CAAoB,OAApB,EAA6B,UAAUC,EAAV,EAAc;AACzC,sBAAQA,EAAE,CAACgN,gBAAH,EAAR;AACE,qBAAK,OAAL;AACA,qBAAK,MAAL;AACE,uBAAKC,eAAL;;AACA;;AACF,qBAAK,IAAL;AACE,uBAAKC,mBAAL;;AACA;AAPJ;;AASAlN,cAAAA,EAAE,CAACmN,eAAH;AACD,aAXD,EAWG,IAXH;AAYA,iBAAK5H,eAAL,CAAqB,qBAArB,EAA4CwG,GAA5C,CAAgD7B,OAAhD,EAAyD;AAACrE,cAAAA,IAAI,EAAE;AAAP,aAAzD;AACA;;AAEF,eAAK,MAAL;AACEqE,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMoO,IAAN,CAAWC,WAAf,CAA2B,IAA3B,EAAiC,aAAjC,EAAgD,UAAhD,CAAV;AACAnD,YAAAA,OAAO,CAACY,GAAR,CAAY;AACVwC,cAAAA,aAAa,EAAE,QADL;AAEVC,cAAAA,KAAK,EAAE,GAFG;AAGVC,cAAAA,QAAQ,EAAE,MAHA;AAIVC,cAAAA,UAAU,EAAEjP,EAAE,CAACkC,IAAH,CAAQgN,WAAR,CAAoBC,GAApB,CAAwB,cAAxB,IAA0C,EAA1C,GAA+C;AAJjD,aAAZ;AAMA,iBAAKnG,IAAL,CAAU,gBAAV,EAA4B0C,OAA5B,EAAqC,WAArC;AACA,iBAAK1C,IAAL,CAAU,gBAAV,EAA4B0C,OAA5B,EAAqC,WAArC;;AACA,iBAAK0D,aAAL,CAAmB1D,OAAnB;;AACAA,YAAAA,OAAO,CAAC2D,WAAR,CAAoB;AAClBC,cAAAA,UAAU,EAAE,YAAY;AACtB,oBAAMC,IAAI,GAAG,IAAIhP,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcmO,IAAd,CAAmBY,kBAAvB,EAAb;;AACA,oBAAI,CAACxP,EAAE,CAACkC,IAAH,CAAQgN,WAAR,CAAoBC,GAApB,CAAwB,cAAxB,CAAL,EAA8C;AAC5CI,kBAAAA,IAAI,CAAChO,WAAL,CAAiB,aAAjB,EAAgC,KAAKkO,cAArC,EAAqD,IAArD;AACD,iBAFD,MAEO;AACLF,kBAAAA,IAAI,CAAChO,WAAL,CAAiB,QAAjB,EAA2B,KAAKmO,oBAAhC,EAAsD,IAAtD;AACD;;AACDH,gBAAAA,IAAI,CAAChO,WAAL,CAAiB,QAAjB,EAA2B,KAAK+L,OAAhC,EAAyC,IAAzC;AACA,uBAAOiC,IAAP;AACD,eATW,CASVvG,IATU,CASL,IATK,CADM;AAYlB;AACA2G,cAAAA,QAAQ,EAAE,kBAAUC,UAAV,EAAsBL,IAAtB,EAA4BM,KAA5B,EAAmC;AAC3CD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,EAAxB,EAA4B,OAA5B,EAAqC,IAArC,EAA2CP,IAA3C,EAAiDM,KAAjD;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,aAAxB,EAAuC,OAAvC,EAAgD,IAAhD,EAAsDP,IAAtD,EAA4DM,KAA5D;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC,IAAxC,EAA8CP,IAA9C,EAAoDM,KAApD;AACAD,gBAAAA,UAAU,CAACG,mBAAX,CAA+B,MAA/B,EAAuC,MAAvC,EAA+C,IAA/C,EAAqDR,IAArD,EAA2DM,KAA3D;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC,IAAxC,EAA8CP,IAA9C,EAAoDM,KAApD;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,gBAAxB,EAA0C,UAA1C,EAAsD,IAAtD,EAA4DP,IAA5D,EAAkEM,KAAlE;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,UAAxB,EAAoC,UAApC,EAAgD,IAAhD,EAAsDP,IAAtD,EAA4DM,KAA5D;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC,IAAxC,EAA8CP,IAA9C,EAAoDM,KAApD;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,QAAxB,EAAkC,QAAlC,EAA4C,IAA5C,EAAkDP,IAAlD,EAAwDM,KAAxD;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,gBAAxB,EAA0C,aAA1C,EAAyD,IAAzD,EAA+DP,IAA/D,EAAqEM,KAArE;AACAD,gBAAAA,UAAU,CAACE,YAAX,CAAwB,UAAxB,EAAoC,UAApC,EAAgD,IAAhD,EAAsDP,IAAtD,EAA4DM,KAA5D;AACD;AAzBiB,aAApB;AA2BAnE,YAAAA,OAAO,CAACsE,YAAR,GAAuBzO,WAAvB,CAAmC,QAAnC,EAA6C,KAAK0O,sBAAlD,EAA0E,IAA1E;AACA,iBAAKlJ,eAAL,CAAqB,MAArB,EAA6BwG,GAA7B,CAAiC7B,OAAjC,EAA0C;AACxCkC,cAAAA,GAAG,EAAE,EADmC;AAExCC,cAAAA,IAAI,EAAE,CAFkC;AAGxCC,cAAAA,KAAK,EAAE,CAHiC;AAIxCoC,cAAAA,MAAM,EAAE;AAJgC,aAA1C;AAMA;;AAEF,eAAK,YAAL;AACExE,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAMoM,KAAN,CAAYC,IAAhB,CAAqB,IAArB,EAA2BtM,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,KAA7B,EAAoC,EAApC,CAA3B,CAAV;AACAuI,YAAAA,OAAO,CAACyE,YAAR,CAAqB,IAArB;AACAzE,YAAAA,OAAO,CAAC0E,aAAR,CAAsB,CAAC,EAAvB;AACA1E,YAAAA,OAAO,CAAC2E,SAAR,CAAkB,EAAlB;AACA,iBAAK9O,WAAL,CAAiB,gBAAjB,EAAmC,UAAAC,EAAE,EAAI;AACvCkK,cAAAA,OAAO,CAACtE,mBAAR,CAA4B;AAC1B8I,gBAAAA,MAAM,EAAE,EADkB;AAE1BrC,gBAAAA,IAAI,EAAErM,EAAE,CAACC,OAAH,KAAe,CAAC,IAAhB,GAAuB;AAFH,eAA5B;AAID,aALD,EAKG,IALH;AAMAiK,YAAAA,OAAO,CAAC4E,aAAR,CAAsB,cAAtB;AACA5E,YAAAA,OAAO,CAACnK,WAAR,CAAoB,aAApB,EAAmC;AAAA,qBAAMmK,OAAO,CAACyB,QAAR,CAAiB,SAAjB,CAAN;AAAA,aAAnC;AACAzB,YAAAA,OAAO,CAACnK,WAAR,CAAoB,YAApB,EAAkC;AAAA,qBAAMmK,OAAO,CAACwB,WAAR,CAAoB,SAApB,CAAN;AAAA,aAAlC;AACAxB,YAAAA,OAAO,CAACnK,WAAR,CAAoB,KAApB,EAA2B,YAAM;AAC/B,kBAAI,MAAI,CAACgP,WAAL,EAAJ,EAAwB;AACtB,gBAAA,MAAI,CAACC,SAAL,CAAe,MAAI,CAACD,WAAL,EAAf,EAAmC,QAAnC;AACD,eAFD,MAEO;AACLE,gBAAAA,GAAG,CAACC,MAAJ,CAAWC,MAAX,CAAkBC,KAAlB,CAAwB,MAAI,CAAC9N,EAAL,CAAQ,6MAAR,CAAxB;AACD;AACF,aAND,EAMG,IANH;AAOA,iBAAKiE,eAAL,CAAqB,MAArB,EAA6BwG,GAA7B,CAAiC7B,OAAjC,EAA0C;AACxCwE,cAAAA,MAAM,EAAE,EADgC;AAExCrC,cAAAA,IAAI,EAAE;AAFkC,aAA1C;AAIA;;AAEF,eAAK,gBAAL;AACE;AACAnC,YAAAA,OAAO,GAAG,IAAI1L,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAW2O,MAAf,EAAV;AACAnF,YAAAA,OAAO,CAACoF,YAAR,CAAqB,IAAI9Q,EAAE,CAACQ,EAAH,CAAMuQ,UAAN,CAAiBC,SAArB,GAAiC1E,GAAjC,CAAqC;AACxD2E,cAAAA,QAAQ,EAAE,CAD8C;AAExDC,cAAAA,QAAQ,EAAE,OAF8C;AAGxDC,cAAAA,QAAQ,EAAE;AAH8C,aAArC,CAArB;AAKAzF,YAAAA,OAAO,CAAC0F,SAAR,CAAkB,CAAlB;AACA1F,YAAAA,OAAO,CAAC2F,UAAR,CAAmB,GAAnB;AACA3F,YAAAA,OAAO,CAAC2E,SAAR,CAAkB,GAAlB;AACA3E,YAAAA,OAAO,CAAC4F,YAAR,CAAqB,IAArB;AACA5F,YAAAA,OAAO,CAACtE,mBAAR,CAA4B;AAACyG,cAAAA,IAAI,EAAE,CAAC,IAAR;AAAcD,cAAAA,GAAG,EAAE,CAAC;AAApB,aAA5B;AACA5N,YAAAA,EAAE,CAACkC,IAAH,CAAQC,IAAR,CAAaC,cAAb,GAA8BC,OAA9B,GAAwCkL,GAAxC,CAA4C7B,OAA5C;AACA;;AAEF,eAAK,cAAL;AACEA,YAAAA,OAAO,GAAG,IAAInL,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc8Q,WAAd,CAA0BC,aAA9B,CAA4C,IAA5C,CAAV;AACA9F,YAAAA,OAAO,CAACnK,WAAR,CAAoB,QAApB,EAA8B,KAAKmO,oBAAnC,EAAyD,IAAzD;AACA;AA7PL;;AAgQC,eAAOhE,OAAO,sFAAyBF,EAAzB,CAAd;AACF,OA7gBM;AA+gBPiE,MAAAA,cAAc,EAAE,wBAAUjO,EAAV,EAAc;AAC5B,YAAM+K,MAAM,GAAG/K,EAAE,CAACiQ,gBAAH,EAAf;;AACA,YAAIlF,MAAM,YAAYhM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcmO,IAAd,CAAmBY,kBAAzC,EAA6D;AAC3D,cAAM3N,OAAO,GAAG0K,MAAM,CAACmF,QAAP,EAAhB;AACA,eAAK3K,eAAL,CAAqB,MAArB,EAA6BiJ,YAA7B,GAA4C2B,OAA5C,CAAoD,CAAC9P,OAAD,CAApD;AACA,eAAK+P,WAAL,CAAiB/P,OAAjB;AACA,cAAMgQ,IAAI,GAAG,KAAK9K,eAAL,CAAqB,cAArB,CAAb;AACA8K,UAAAA,IAAI,CAACC,UAAL,CAAgBjQ,OAAhB;AACAgQ,UAAAA,IAAI,CAACE,aAAL,CAAmBvQ,EAAnB;AACD,SAT2B,CAW5B;AACA;;;AACA,YAAIA,EAAE,CAACwQ,UAAH,EAAJ,EAAqB;AACnBxQ,UAAAA,EAAE,CAACyQ,IAAH;AACD;AACF,OA/hBM;AAiiBPvC,MAAAA,oBAAoB,EAAE,8BAAUlO,EAAV,EAAc;AAClC,YAAMH,IAAI,GAAGG,EAAE,CAACC,OAAH,EAAb;;AACA,YAAI,KAAKqG,eAAL,CAAqBzG,IAAI,CAAC6Q,MAA1B,CAAJ,EAAuC;AACrC,eAAKtK,YAAL,CAAkBvG,IAAI,CAAC6Q,MAAvB;AACD,SAFD,MAEO;AACL,kBAAQ7Q,IAAI,CAAC6Q,MAAb;AACE,iBAAK,MAAL;AACA,iBAAK,MAAL;AACE,mBAAK5E,OAAL,CAAa,IAAb,EAAmBjM,IAAI,CAACQ,OAAxB;;AACA;;AAEF,iBAAK,QAAL;AACE,mBAAK2L,SAAL,CAAe,IAAf,EAAqBnM,IAAI,CAACQ,OAA1B;;AACA;;AAEF,iBAAK,QAAL;AACE;AACA,mBAAK2O,SAAL,CAAenP,IAAI,CAACQ,OAApB,EAA6B,QAA7B;;AACA;;AAEF;AACE,mBAAK8H,KAAL,CAAW,+BAAX,EAA4CtI,IAAI,CAAC6Q,MAAjD;AACA;AAjBJ;AAmBD;AACF,OA1jBM;AA4jBPjC,MAAAA,sBAAsB,EAAE,gCAAUzO,EAAV,EAAc;AACpC,YAAMH,IAAI,GAAGG,EAAE,CAACC,OAAH,EAAb;;AACA,YAAIJ,IAAI,CAAC8Q,KAAL,CAAW1J,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,eAAKmJ,WAAL,CAAiBvQ,IAAI,CAAC8Q,KAAL,CAAW,CAAX,CAAjB;AACD,SAFD,MAEO;AACL,eAAKC,aAAL;AACD;AACF,OAnkBM;AAskBPC,MAAAA,mBAAmB,EAAE,6BAAUC,QAAV,EAAoBC,IAApB,EAA0B;AAAA;;AAC7C,eAAO,IAAIzM,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,cAAM4I,IAAI,GAAG,MAAI,CAAC7H,eAAL,CAAqB,MAArB,CAAb;;AACA,cAAMyL,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;AACA,cAAMoI,MAAM,GAAGD,QAAQ,CAACE,aAAT,CAAuBJ,QAAvB,CAAf;;AACA,cAAIG,MAAJ,EAAY;AACV,YAAA,MAAI,CAACzN,QAAL,GAAuB,CAACyN,MAAD,CAAvB;AACA,YAAA,MAAI,CAACxN,QAAL,GAA2B,CAA3B;;AACA,YAAA,MAAI,CAAC0N,QAAL;;AACA,gBAAIJ,IAAJ,EAAU;AACR,cAAA,MAAI,CAACjF,OAAL;AACD;;AACDvH,YAAAA,OAAO,CAAC,IAAD,CAAP;AACD,WARD,MAQO;AACLA,YAAAA,OAAO,CAAC,KAAD,CAAP;AACD;AACF,SAfM,CAAP;AAgBD,OAvlBM;AAylBPwI,MAAAA,SAAS,EAAE,mBAAU/M,EAAV,EAAc;AACvB,YAAMsF,KAAK,GAAGtF,EAAE,CAACC,OAAH,EAAd;AACA,aAAKuD,QAAL,GAAuB,EAAvB;AACA,aAAKC,QAAL,GAA2B,CAA3B;;AACA,YAAI6B,KAAK,CAAC2B,MAAN,GAAe,CAAnB,EAAsB;AACpB,cAAMmG,IAAI,GAAG,KAAK7H,eAAL,CAAqB,MAArB,CAAb;AACA,cAAMyL,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;AACA,eAAKrF,QAAL,GAAuB1D,KAAK,CAACsR,IAAN,CAAWJ,QAAQ,CAACK,gBAAT,CAA0B,GAA1B,CAAX,EAA2CC,MAA3C,CAAkD,UAAUC,EAAV,EAAc;AACrF,mBAAOA,EAAE,CAACC,OAAH,CAAW3N,UAAX,CAAsByB,KAAtB,KAAgCiM,EAAE,CAACE,YAAH,CAAgB,MAAhB,KAA2BF,EAAE,CAACG,YAAH,CAAgB,MAAhB,EAAwB7N,UAAxB,CAAmCyB,KAAnC,CAAlE;AACD,WAFsB,CAAvB;;AAGA,eAAK6L,QAAL;AACD;AACF,OArmBM;AAumBPlE,MAAAA,eAAe,EAAE,2BAAY;AAC3B,YAAI,KAAKzJ,QAAL,IAAwB,KAAKA,QAAL,CAAqByD,MAArB,GAA8B,KAAKxD,QAAL,GAA2B,CAArF,EAAwF;AACtF,eAAKA,QAAL;;AACA,eAAK0N,QAAL;AACD;AACF,OA5mBM;AA8mBPjE,MAAAA,mBAAmB,EAAE,+BAAY;AAC/B,YAAI,KAAK1J,QAAL,IAAwB,KAAKC,QAAL,GAA2B,CAAvD,EAA0D;AACxD,eAAKA,QAAL;;AACA,eAAK0N,QAAL;AACD;AACF,OAnnBM;AAqnBPA,MAAAA,QAAkB,EAAE,oBAAY;AAC9B,YAAI,KAAK3N,QAAL,CAAqByD,MAArB,GAA8B,KAAKxD,QAAvC,EAA4D;AAC1D;AACA,cAAMkO,UAAU,GAAG,KAAKnO,QAAL,CAAqB,KAAKC,QAA1B,CAAnB;AACA,cAAM2J,IAAI,GAAG,KAAK7H,eAAL,CAAqB,MAArB,CAAb;;AACA,cAAIoM,UAAU,CAACC,QAAf,EAAyB;AACvBxE,YAAAA,IAAI,CAACyE,kBAAL,CAAwBF,UAAU,CAACC,QAAnC;AACAxE,YAAAA,IAAI,CAACoB,YAAL,GAAoB2B,OAApB,CAA4B,CAACwB,UAAU,CAACC,QAAZ,CAA5B;AACD,WAHD,MAGO;AACL,gBAAIE,OAAO,GAAGH,UAAd;AACA,gBAAMI,SAAS,GAAG,EAAlB,CAFK,CAGL;;AACA,mBAAOD,OAAO,IAAI,CAACA,OAAO,CAACF,QAA3B,EAAqC;AACnCE,cAAAA,OAAO,GAAGA,OAAO,CAACE,aAAlB;;AACA,kBAAIF,OAAJ,EAAa;AACXC,gBAAAA,SAAS,CAAC9J,IAAV,CAAe6J,OAAf;AACD;AACF;;AACD,gBAAIA,OAAO,IAAIA,OAAO,CAACF,QAAvB,EAAiC;AAC/BE,cAAAA,OAAO,CAACF,QAAR,CAAiBK,IAAjB,GAD+B,CAE/B;;AACA,mBAAK,IAAIC,CAAC,GAAGH,SAAS,CAAC9K,MAAV,GAAiB,CAA9B,EAAiCiL,CAAC,IAAI,CAAtC,EAAyCA,CAAC,EAA1C,EAA8C;AAC5C,oBAAMC,CAAC,GAAGJ,SAAS,CAACG,CAAD,CAAT,CAAaN,QAAvB;;AACA,oBAAIO,CAAJ,EAAO;AACLA,kBAAAA,CAAC,CAACF,IAAF;AACD;AACF;;AACD,kBAAIN,UAAU,CAACC,QAAf,EAAyB;AACvBxE,gBAAAA,IAAI,CAACyE,kBAAL,CAAwBF,UAAU,CAACC,QAAnC;AACAxE,gBAAAA,IAAI,CAACoB,YAAL,GAAoB2B,OAApB,CAA4B,CAACwB,UAAU,CAACC,QAAZ,CAA5B;AACD;AACF;AACF;AACF;AACF,OAvpBM;AAypBPhE,MAAAA,aAAa,EAAE,uBAAU1D,OAAV,EAAmB;AAChC,YAAIkI,iBAAJ;AACAlI,QAAAA,OAAO,CAACnK,WAAR,CAAoB,WAApB,EAAiC,UAAUC,EAAV,EAAc;AAC7C,cAAMqS,UAAU,GAAGrS,EAAE,CAACsS,aAAH,EAAnB;AACA,cAAIjS,OAAJ;;AACA,cAAIgS,UAAU,YAAYtT,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcmO,IAAd,CAAmBY,kBAA7C,EAAiE;AAC/D3N,YAAAA,OAAO,GAAGgS,UAAU,CAACnC,QAAX,EAAV;AACA7P,YAAAA,OAAO,CAACkS,WAAR,CAAoB,IAApB;;AACA,gBAAI,CAAClS,OAAO,CAACmS,UAAR,EAAD,IAAyB,CAACnS,OAAO,CAACqH,WAAR,EAA9B,EAAqD;AACnD1H,cAAAA,EAAE,CAACyS,cAAH;AACAzS,cAAAA,EAAE,CAACmN,eAAH;AACA;AACD;;AACDnN,YAAAA,EAAE,CAAC0S,SAAH,CAAa,MAAb;;AACA,gBAAIrS,OAAO,CAACqH,WAAR,EAAJ,EAA2B;AACzB1H,cAAAA,EAAE,CAAC0S,SAAH,CAAa,MAAb;AACD;;AACD1S,YAAAA,EAAE,CAAC2S,OAAH,CAAW,iBAAX;AACA3S,YAAAA,EAAE,CAAC4S,OAAH,CAAW,iBAAX,EAA8BvS,OAA9B;AACA+R,YAAAA,iBAAiB,GAAG/R,OAApB;AACD;;AACD,eAAKkS,WAAL,CAAiB,IAAjB;AACD,SApBD,EAoBG,IApBH;AAsBA,YAAMM,SAAS,GAAG,KAAKtN,eAAL,CAAqB,YAArB,CAAlB;AACAsN,QAAAA,SAAS,CAAC9S,WAAV,CAAsB,WAAtB,EAAmC,UAAUC,EAAV,EAAc;AAC/CA,UAAAA,EAAE,CAAC0S,SAAH,CAAa,MAAb;AACA1S,UAAAA,EAAE,CAAC2S,OAAH,CAAW,qBAAX;AACA,eAAKJ,WAAL,CAAiB,IAAjB;AACD,SAJD,EAIG,IAJH;AAMA,YAAM3Q,OAAO,GAAG7C,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0BlR,OAA1C;AACA,YAAMmR,QAAQ,GAAG;AACfC,UAAAA,IAAI,EAAE,CADS;AAEfjI,UAAAA,MAAM,EAAE;AAFO,SAAjB;AAKAb,QAAAA,OAAO,CAACnK,WAAR,CAAoB,UAApB,EAAgC,UAAUC,EAAV,EAAc;AAAA;;AAC5C;AACA,cAAI0Q,MAAM,GAAG1Q,EAAE,CAACiT,gBAAH,EAAb;AACA,cAAI5S,OAAJ;;AACA,cAAIL,EAAE,CAACkT,YAAH,CAAgB,iBAAhB,CAAJ,EAAwC;AACtC7S,YAAAA,OAAO,GAAGL,EAAE,CAACC,OAAH,CAAW,iBAAX,CAAV;AACD;;AACD,cAAMkT,MAAM,GAAGzC,MAAM,KAAK,MAAX,IAAqB,CAACrQ,OAAtB,IAAiCL,EAAE,CAACkT,YAAH,CAAgB,qBAAhB,CAAhD;AACA,cAAInI,MAAM,GAAG/K,EAAE,CAACoT,SAAH,EAAb;;AACA,cAAIrI,MAAM,KAAKsI,SAAf,EAA0B;AACxB;AACA,iBAAKC,KAAL,CAAW,yBAAX;AACA;AACD;;AACD,cAAI5C,MAAM,KAAK,MAAX,IAAqB3F,MAArB,IAA+BA,MAAM,YAAYhM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcmO,IAAd,CAAmBY,kBAAxE,EAA4F;AAC1F,gBAAIjD,MAAM,CAACmF,QAAP,OAAsB7P,OAA1B,EAAmC;AACjC;AACA,mBAAKiT,KAAL,CAAW,oCAAX;AACAP,cAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACC,IAAxB;AACA7B,cAAAA,EAAE,CAACyS,cAAH;AACA;AACD,aAND,MAMO,IAAIpS,OAAO,IAAIA,OAAO,CAACkT,UAAR,CAAmBxI,MAAM,CAACmF,QAAP,EAAnB,CAAf,EAAsD;AAC3D;AACA,mBAAKoD,KAAL,CAAW,qCAAX;AACAP,cAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACC,IAAxB;AACA7B,cAAAA,EAAE,CAACyS,cAAH;AACA;AACD;AACF;;AACD,cAAI1H,MAAM,KAAKb,OAAf,EAAwB;AACtB,gBAAMsJ,YAAY,GAAGtJ,OAAO,CAACuJ,OAAR,GAAkBC,SAAlB,GAA8B,CAA9B,EAAiCC,kBAAjC,EAArB;;AACA,gBAAIH,YAAY,IAAKxT,EAAE,CAAC4T,cAAH,KAAsBJ,YAAY,CAAC9E,MAAnC,IAA6C,EAAlE,EAAuE;AACrE;AACA,kBAAMmF,QAAQ,GAAGC,QAAQ,CAACC,gBAAT,CAA0BC,IAAI,CAACC,KAAL,CAAW,CAACT,YAAY,CAACnH,IAAb,GAAoBmH,YAAY,CAAClH,KAAlC,IAA2C,CAAtD,CAA1B,EAAoFkH,YAAY,CAAC9E,MAAb,GAAsB,EAA1G,CAAjB;AACA3D,cAAAA,MAAM,GAAGvM,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAW2O,MAAX,CAAkB6E,kBAAlB,CAAqCL,QAArC,CAAT;;AACA,kBAAI9I,MAAJ,EAAY;AACV,uBAAOA,MAAM,CAACoJ,WAAP,EAAP,EAA6B;AAC3BpJ,kBAAAA,MAAM,GAAGA,MAAM,CAACqJ,eAAP,EAAT;AACD;AACF;AACF,aATD,MASO;AACLrJ,cAAAA,MAAM,GAAG,IAAT;AACD;;AACD,gBAAI,CAACA,MAAD,IAAWA,MAAM,KAAKb,OAA1B,EAAmC;AACjC6I,cAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACC,IAAxB;AACA7B,cAAAA,EAAE,CAACyS,cAAH;AACA,mBAAKa,KAAL,CAAW,uBAAX;AACA;AACD;AACF;;AACD,cAAI,CAACH,MAAD,IAAW,CAAC9S,OAAhB,EAAyB;AACvB;AACA,iBAAKiT,KAAL,CAAW,wCAAX;AACAP,YAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACC,IAAxB;AACA7B,YAAAA,EAAE,CAACyS,cAAH;AACA;AACD;;AACD,cAAMtO,KAAK,GAAG4G,MAAM,CAACmF,QAAP,EAAd;AACA,cAAMmE,MAAM,GAAGlQ,KAAK,CAACmQ,SAAN,EAAf;AACAvB,UAAAA,QAAQ,CAAChI,MAAT,GAAkB5G,KAAlB;;AAEA,cAAIkQ,MAAJ,EAAY;AACV,gBAAME,mBAAmB,GAAGF,MAAM,CAACG,gBAAP,EAA5B;;AACA,gBAAIrB,MAAJ,EAAY;AACV,kBAAMsB,eAAe,GAAGF,mBAAmB,CAACG,kBAApB,EAAxB;;AACA,kBAAI3Q,MAAM,CAAC4Q,IAAP,CAAYF,eAAZ,EAA6BxN,MAA7B,GAAsC,CAA1C,EAA6C;AAC3C;AACA,oBAAM2N,OAAO,GAAGP,MAAM,CAACQ,kBAAP,EAAhB;;AACA,oBAAID,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;AACtB;AACA,sBAAIsN,mBAAmB,CAACO,mBAApB,EAAJ,EAA+C;AAC7C;AACA;AACA/B,oBAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACE,MAAR,GAAiBF,OAAO,CAACG,KAAzC;AACD,mBAJD,MAIO;AACL,wBAAIgT,GAAG,GAAGnT,OAAO,CAACC,IAAlB;AACA,wBAAMmT,cAAc,GAAGT,mBAAmB,CAACU,yBAApB,EAAvB;AACAL,oBAAAA,OAAO,CAACxU,IAAR,CAAa,UAAA8U,WAAW,EAAI;AAC1BH,sBAAAA,GAAG,IAAI,MAAI,CAACI,QAAL,CAA2BH,cAA3B,EAA2CE,WAA3C,EAAwD/Q,KAAK,CAACiR,OAAN,EAAxD,CAAP;;AACA,0BAAKL,GAAG,GAAGnT,OAAO,CAACE,MAAf,IAA2BiT,GAAG,GAAGnT,OAAO,CAACG,KAA7C,EAAqD;AACnD;AACA,+BAAO,IAAP;AACD;;AACD,6BAAO,KAAP;AACD,qBAPD;AAQAgR,oBAAAA,QAAQ,CAACC,IAAT,GAAgB+B,GAAhB;AACD;AACF;AACF,eAvBD,MAuBO;AACL/U,gBAAAA,EAAE,CAACyS,cAAH,GADK,CAEL;;AACAM,gBAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACC,IAAxB;AACA,qBAAKyR,KAAL,CAAW,0BAAX;AACD;AACF,aA/BD,MA+BO,IAAI,CAACiB,mBAAmB,CAACc,qBAApB,CAA0ChV,OAAO,CAAC+U,OAAR,EAA1C,CAAL,EAAmE;AACtE;AACArC,cAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACC,IAAxB;AACA,mBAAKyR,KAAL,CAAW,iCAAX,EAA8Ce,MAAM,CAACe,OAAP,EAA9C;AACD,aAJI,MAIE,IAAIb,mBAAmB,CAACO,mBAApB,EAAJ,EAA+C;AACpD;AACA;AACA/B,cAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACE,MAAR,GAAiBF,OAAO,CAACG,KAAzC;AACD,aAJM,MAIA;AACL;AACAgR,cAAAA,QAAQ,CAACC,IAAT,GAAgB,KAAKmC,QAAL,CAA2BZ,mBAAmB,CAACU,yBAApB,EAA3B,EAA4E5U,OAAO,CAAC+U,OAAR,EAA5E,EAA+FjR,KAAK,CAACiR,OAAN,EAA/F,CAAhB;AACD;AACJ,WA7CD,MA6CO;AACLrC,YAAAA,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACC,IAAxB;AACD;;AACD,cAAIyT,UAAJ;;AACA,cAAInC,MAAJ,EAAY;AACVmC,YAAAA,UAAU,GAAGvR,MAAM,CAAC4Q,IAAP,CAAYxQ,KAAK,CAACqQ,gBAAN,GAAyBE,kBAAzB,CAA4C,IAA5C,CAAZ,EAA+DzN,MAA/D,GAAwE,CAArF;AACD,WAFD,MAEO;AACLqO,YAAAA,UAAU,GAAGnR,KAAK,CAACqQ,gBAAN,GAAyBa,qBAAzB,CAA+ChV,OAAO,CAAC+U,OAAR,EAA/C,CAAb;AACD;;AACD,cAAIE,UAAJ,EAAgB;AACd;AACAvC,YAAAA,QAAQ,CAACC,IAAT,IAAiBpR,OAAO,CAACI,MAAzB;;AACA,gBAAImC,KAAK,CAACqQ,gBAAN,GAAyBM,mBAAzB,EAAJ,EAAoD;AAClD/B,cAAAA,QAAQ,CAACC,IAAT,IAAiBpR,OAAO,CAACK,WAAzB;AACD,aAFD,MAEO;AACL,kBAAM+S,eAAc,GAAG7Q,KAAK,CAACqQ,gBAAN,GAAyBe,2BAAzB,EAAvB;;AACA,kBAAIP,eAAJ,EAAoB;AAClB,oBAAI3U,OAAJ,EAAa;AACX,sBAAImV,cAAc,GAAGR,eAAc,CAAC3U,OAAO,CAAC+U,OAAR,EAAD,CAAnC;;AACA,sBAAII,cAAc,KAAKC,SAAvB,EAAkC;AAChC,wBAAID,cAAc,KAAK,CAAnB,IAAwBrR,KAAK,CAACuR,WAAN,GAAoBzO,MAApB,KAA+B,CAA3D,EAA8D;AAC5D8L,sBAAAA,QAAQ,CAACC,IAAT,IAAiBpR,OAAO,CAACK,WAAzB;AACD,qBAFD,MAEO;AACL;AACA,0BAAM0T,UAAU,GAAGxR,KAAK,CAACuR,WAAN,GAAoBtO,OAApB,CAA4B,CAA5B,CAAnB;;AACA,0BAAMwO,WAAW,GAAGZ,eAAc,CAACW,UAAU,CAACP,OAAX,EAAD,CAAlC;;AACA,0BAAIQ,WAAW,IAAIJ,cAAnB,EAAmC;AACjCzC,wBAAAA,QAAQ,CAACC,IAAT,IAAiBpR,OAAO,CAACK,WAAzB;AACD;AACF;AACF;AACF,iBAdD,MAcO,IAAIkC,KAAK,CAACuR,WAAN,GAAoBzO,MAApB,GAA6B,CAAjC,EAAoC;AACzC,sBAAM0O,WAAU,GAAGxR,KAAK,CAACuR,WAAN,GAAoBtO,OAApB,CAA4B,CAA5B,CAAnB;;AACA,sBAAIyO,kBAAkB,GAAGb,eAAc,CAACW,WAAU,CAACP,OAAX,EAAD,CAAvC;;AACA,sBAAIS,kBAAkB,KAAKJ,SAAvB,IAAoCI,kBAAkB,GAAG,CAA7D,EAAgE;AAC9D;AACA9C,oBAAAA,QAAQ,CAACC,IAAT,IAAiBpR,OAAO,CAACK,WAAzB;AACD;AACF,iBAPM,MAOA,IAAI8B,MAAM,CAAC4Q,IAAP,CAAYK,eAAZ,EAA4B/N,MAA5B,GAAqC,CAAzC,EAA4C;AACjD;AACA8L,kBAAAA,QAAQ,CAACC,IAAT,IAAiBpR,OAAO,CAACK,WAAzB;AACD;AACF;AACF;AACF;;AACD,cAAI8Q,QAAQ,CAACC,IAAT,KAAkBpR,OAAO,CAACC,IAA9B,EAAoC;AAClC7B,YAAAA,EAAE,CAACyS,cAAH;AACA,iBAAKa,KAAL,CAAW,4BAAX;AACD;AACF,SA3JD,EA2JG,IA3JH;AA6JA,YAAMD,SAAS,GAAG,KAAK9N,eAAL,CAAqB,gBAArB,CAAlB;AAEA,YAAIuQ,WAAJ;AAEA5L,QAAAA,OAAO,CAACnK,WAAR,CAAoB,WAApB,EAAiC,UAAUC,EAAV,EAAc;AAC7C,cAAI8V,WAAJ,EAAiB;AACfA,YAAAA,WAAW,CAACrF,IAAZ;AACAqF,YAAAA,WAAW,GAAG,IAAd;AACD;AACF,SALD,EAKG,IALH;AAOA,YAAIC,YAAJ;AACA,YAAMC,aAAa,GAAG9L,OAAO,CAACuJ,OAAR,EAAtB;;AAEA,YAAMwC,MAAM,GAAG,SAATA,MAAS,CAAUjW,EAAV,EAAc;AAC3B,cAAIqM,IAAI,GAAG,CAAC,IAAZ;AACA,cAAID,GAAG,GAAG,CAAC,IAAX;AACA,cAAI8J,QAAQ,GAAG,EAAf;AACA,cAAIC,MAAM,GAAGnW,EAAE,CAACoW,UAAH,GAAgBC,SAAhB,EAAb;;AACA,cAAI,CAACF,MAAL,EAAa;AACXA,YAAAA,MAAM,GAAG3X,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAW4V,cAAX,CAA0BjS,WAA1B,EAAT;AACD;;AACD,cAAIrE,EAAE,CAACuW,OAAH,CAAWC,WAAX,KAA2B,OAA/B,EAAwC;AACtC,gBAAI,CAACL,MAAM,CAACM,QAAP,CAAgB,OAAhB,CAAL,EAA+B;AAC7BN,cAAAA,MAAM,CAACxK,QAAP,CAAgB,OAAhB;AACD;AACF;;AAED,cAAIoH,QAAQ,CAACC,IAAT,KAAkBpR,OAAO,CAACC,IAA9B,EAAoC;AAClC,gBAAM6U,QAAQ,GAAG5C,QAAQ,CAACC,gBAAT,CAA0B/T,EAAE,CAAC2W,eAAH,EAA1B,EAAgD3W,EAAE,CAAC4T,cAAH,EAAhD,CAAjB;AACA,gBAAIgD,IAAI,GAAGpY,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAW2O,MAAX,CAAkB6E,kBAAlB,CAAqCwC,QAArC,CAAX;AACA,gBAAIG,aAAa,GAAG,KAApB;;AACA,gBAAI,CAACD,IAAL,EAAW;AACT;AACD;;AACD,mBAAOA,IAAI,CAACzC,WAAL,EAAP,EAA2B;AACzByC,cAAAA,IAAI,GAAGA,IAAI,CAACxC,eAAL,EAAP;AACD;;AAED,gBAAM0C,UAAU,GAAGF,IAAI,CAACjD,kBAAL,EAAnB;AACA,gBAAIoD,OAAO,GAAGD,UAAU,CAACzK,IAAzB;;AACA,gBAAIuK,IAAI,YAAY7X,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcmO,IAAd,CAAmBY,kBAAvC,EAA2D;AACzD,kBAAMgJ,MAAM,GAAGJ,IAAI,CAACK,YAAL,GAAoB,CAApB,CAAf;;AACAF,cAAAA,OAAO,GAAGC,MAAM,CAAC7R,QAAP,KAAoByR,IAAI,CAACM,cAAL,EAA9B;AACA7D,cAAAA,SAAS,CAAC8D,QAAV,CAAmBP,IAAI,CAACQ,SAAL,GAAiB7J,KAAjB,GAAyBwJ,OAA5C;;AACA,kBAAIhE,QAAQ,CAAChI,MAAT,IAAmB6L,IAAI,CAAC1G,QAAL,OAAoB6C,QAAQ,CAAChI,MAApD,EAA4D;AAC1D8L,gBAAAA,aAAa,GAAG,IAAhB;AACD;;AACDd,cAAAA,YAAY,GAAGa,IAAf;AACD,aARD,MAQO,IAAIA,IAAI,KAAKvD,SAAb,EAAwB;AAC7B,kBAAIuD,IAAI,KAAKZ,aAAb,EAA4B;AAC1B,oBAAMqB,UAAU,GAAGtB,YAAY,CAACpC,kBAAb,EAAnB;AACA,oBAAM2D,QAAQ,GAAGtX,EAAE,CAAC4T,cAAH,KAAsByD,UAAU,CAAC3I,MAAlD;;AACA,oBAAI4I,QAAQ,IAAI,EAAZ,IAAkBvE,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACG,KAA9C,EAAqD;AACnD,sBAAMiV,OAAM,GAAGjB,YAAY,CAACkB,YAAb,GAA4B,CAA5B,CAAf;;AACA5K,kBAAAA,IAAI,GAAG2K,OAAM,CAAC7R,QAAP,KAAoB4Q,YAAY,CAACmB,cAAb,EAA3B;AACA9K,kBAAAA,GAAG,GAAGiL,UAAU,CAAC3I,MAAjB;AACAwH,kBAAAA,QAAQ,GAAG,OAAX;AACD;;AACDW,gBAAAA,aAAa,GAAG,IAAhB;AACD,eAVD,MAUO;AACLA,gBAAAA,aAAa,GAAG,IAAhB;AACD;AACF,aAdM,MAcA;AACL;AACA;AACD;;AACD,gBAAI,CAACA,aAAL,EAAoB;AAClB,kBAAK7W,EAAE,CAAC4T,cAAH,KAAsBkD,UAAU,CAAC1K,GAAlC,IAA0C,CAA9C,EAAiD;AAC/C;AACA,oBAAI0J,WAAJ,EAAiB;AACfA,kBAAAA,WAAW,CAACrF,IAAZ;AACAqF,kBAAAA,WAAW,GAAG,IAAd;AACD,iBAL8C,CAM/C;;;AACA,oBAAI/C,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACE,MAA5B,EAAoC;AAClCuK,kBAAAA,IAAI,GAAG0K,OAAP;AACA3K,kBAAAA,GAAG,GAAG0K,UAAU,CAAC1K,GAAjB;AACA8J,kBAAAA,QAAQ,GAAG,QAAX;AACD,iBAJD,MAIO,IAAInD,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACI,MAA5B,EAAoC;AACzCqK,kBAAAA,IAAI,GAAG,CAAC,IAAR;AACAD,kBAAAA,GAAG,GAAG,CAAC,IAAP;AACA8J,kBAAAA,QAAQ,GAAG,QAAX;AACD;AACF,eAhBD,MAgBO,IAAKY,UAAU,CAACpI,MAAX,GAAoB1O,EAAE,CAAC4T,cAAH,EAArB,IAA6C,CAAjD,EAAoD;AACzD;AACA,oBAAIb,QAAQ,CAAChI,MAAT,IAAmB,CAACgI,QAAQ,CAAChI,MAAT,CAAgBwM,MAAhB,EAAxB,EAAkD;AAChD,sBAAIxE,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACG,KAA5B,EAAmC;AACjCsK,oBAAAA,IAAI,GAAG0K,OAAP;AACA3K,oBAAAA,GAAG,GAAG0K,UAAU,CAACpI,MAAjB;AACAwH,oBAAAA,QAAQ,GAAG,OAAX;AACD,mBAJD,MAIO,IAAInD,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACI,MAA5B,EAAoC;AACzCqK,oBAAAA,IAAI,GAAG,CAAC,IAAR;AACAD,oBAAAA,GAAG,GAAG,CAAC,IAAP;AACA8J,oBAAAA,QAAQ,GAAG,QAAX;AACD;AACF,iBAVD,MAUO;AACL;AACA;AACA,sBAAInD,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACK,WAA5B,EAAyC;AACvCoK,oBAAAA,IAAI,GAAG0K,OAAO,GAAG,EAAjB;AACA1D,oBAAAA,SAAS,CAAC8D,QAAV,CAAmB9D,SAAS,CAAClO,QAAV,KAAuB,EAA1C;AACAiH,oBAAAA,GAAG,GAAG0K,UAAU,CAACpI,MAAjB;AACAwH,oBAAAA,QAAQ,GAAG,aAAX;AACD,mBALD,MAKO;AACL,yBAAK5C,KAAL,CAAW,4BAAX;AACD;AACF;;AACD,oBAAIwC,WAAJ,EAAiB;AACfA,kBAAAA,WAAW,CAACrF,IAAZ;AACAqF,kBAAAA,WAAW,GAAG,IAAd;AACD;AACF,eA5BM,MA4BA;AACL;AACA;AACA,oBAAI/C,QAAQ,CAAChI,MAAT,IAAmBgI,QAAQ,CAAChI,MAAT,CAAgBwM,MAAhB,EAAvB,EAAiD;AAC/C;AACA,sBAAIxE,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACK,WAA5B,EAAyC;AACvC,wBAAIoR,SAAS,CAACmE,WAAV,CAAsB,UAAtB,MAAsC,aAA1C,EAAyD;AACvDnL,sBAAAA,IAAI,GAAG0K,OAAO,GAAG,EAAjB;AACA1D,sBAAAA,SAAS,CAAC8D,QAAV,CAAmB9D,SAAS,CAAClO,QAAV,KAAuB,EAA1C;AACD;;AACDiH,oBAAAA,GAAG,GAAG0K,UAAU,CAACpI,MAAjB;AACAwH,oBAAAA,QAAQ,GAAG,aAAX;AACD;AACF,iBAVD,MAUO;AACL7C,kBAAAA,SAAS,CAACoE,cAAV,CAAyB,CAAC,IAA1B,EAAgC,CAAC,IAAjC;;AACA,sBAAI1E,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACI,MAA5B,EAAoC;AAClCkU,oBAAAA,QAAQ,GAAG,QAAX;AACD;;AACD,sBAAI,CAACJ,WAAL,EAAkB;AAChBA,oBAAAA,WAAW,GAAGtX,EAAE,CAACmE,KAAH,CAAS+U,KAAT,CAAeC,IAAf,CAAoB,YAAY;AAC5C,0BAAI5E,QAAQ,CAAChI,MAAb,EAAqB;AACnBb,wBAAAA,OAAO,CAAC0N,QAAR,CAAiB7E,QAAQ,CAAChI,MAA1B;AACD;AACF,qBAJa,EAIX,IAJW,EAIL,IAJK,CAAd;AAKD;AACF;AACF;AACF;AACF;;AACDsI,UAAAA,SAAS,CAACoE,cAAV,CAAyBpL,IAAzB,EAA+BD,GAA/B;AACAiH,UAAAA,SAAS,CAACwE,WAAV,CAAsB,UAAtB,EAAkC3B,QAAlC;;AACA,cAAI,CAACA,QAAD,IAAaC,MAAM,CAAC2B,SAAP,EAAjB,EAAqC;AACnCzE,YAAAA,SAAS,CAACwE,WAAV,CAAsB,QAAtB,EAAgC7X,EAAE,CAACiT,gBAAH,EAAhC;AACAkD,YAAAA,MAAM,CAAC4B,WAAP,GAFmC,CAGnC;;AACAC,YAAAA,OAAO,CAACC,MAAR,CAAe5L,IAAI,GAAG,CAAtB,EAJmC,CAKnC;;AACA2L,YAAAA,OAAO,CAACC,MAAR,CAAe7L,GAAG,GAAG,CAArB;AACD,WAPD,MAOO,IAAI8J,QAAQ,IAAI,CAACC,MAAM,CAAC2B,SAAP,EAAb,IAAmC3B,MAAM,CAAC2B,SAAP,OAAuBzE,SAAS,CAACmE,WAAV,CAAsB,QAAtB,CAA9D,EAA+F;AACpGrB,YAAAA,MAAM,CAAC+B,SAAP,CAAiB7E,SAAS,CAACmE,WAAV,CAAsB,QAAtB,CAAjB;AACAnE,YAAAA,SAAS,CAACwE,WAAV,CAAsB,QAAtB,EAAgC,IAAhC;AACD;AACF,SA5ID;;AA6IA3N,QAAAA,OAAO,CAACnK,WAAR,CAAoB,MAApB,EAA4BkW,MAA5B,EAAoC,IAApC;AACApD,QAAAA,SAAS,CAAC9S,WAAV,CAAsB,MAAtB,EAA8BkW,MAA9B,EAAsC,IAAtC;;AAEA,YAAMkC,MAAM,GAAG,UAAUnY,EAAV,EAAc;AAC3B,cAAI0Q,MAAM,GAAG1Q,EAAE,CAACiT,gBAAH,EAAb;AACA,cAAI5S,OAAO,GAAGL,EAAE,CAACkT,YAAH,CAAgB,iBAAhB,IAAqClT,EAAE,CAACC,OAAH,CAAW,iBAAX,CAArC,GAAqE,IAAnF;;AACA,cAAIyQ,MAAM,KAAK,MAAf,EAAuB;AACrB,gBAAIrQ,OAAJ,EAAa;AACXA,cAAAA,OAAO,GAAGA,OAAO,CAAC+X,KAAR,EAAV;AACD,aAFD,MAEO;AACL1H,cAAAA,MAAM,GAAG,KAAT;AACD;AACF;;AACD,cAAMwE,WAAW,GAAG7U,OAAO,GAAGA,OAAO,CAACgY,cAAR,EAAH,GAA8B,KAAzD;AACA,cAAMtN,MAAM,GAAGgI,QAAQ,CAAChI,MAAxB;;AACA,cAAI2F,MAAM,KAAK,MAAX,IAAqBrQ,OAAO,KAAK0K,MAArC,EAA6C;AAC3C;AACA;AACD;;AACD,kBAAQsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAR;AACE,iBAAK,OAAL;AACE,kBAAIzE,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACG,KAA5B,EAAmC;AACjC,qBAAKuR,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,OAAhC,EAAyCnK,MAAM,CAACsN,cAAP,EAAzC;;AACA,wBAAQ3H,MAAR;AACE,uBAAK,MAAL;AACE,wBAAIrQ,OAAO,CAACiY,SAAR,CAAkBvN,MAAlB,CAAJ,EAA+B;AAC7BhM,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,gCAAR,EAA0C4T,WAA1C,EAAuDnK,MAAM,CAACsN,cAAP,EAAvD,CAAvC;AACD;;AACD;;AAEF,uBAAK,MAAL;AACE,wBAAIhY,OAAO,CAACqY,WAAR,CAAoB3N,MAApB,CAAJ,EAAiC;AAC/BhM,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,iCAAR,EAA2C4T,WAA3C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD,CAAvC;AACD;;AACD;;AAEF,uBAAK,KAAL;AACE,yBAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;AACA;AAfJ;AAiBD,eAnBD,MAmBO;AACL,qBAAKlE,KAAL,CAAW,aAAX,EAA0B5C,MAA1B,EAAkCwE,WAAlC,EAA+C,OAA/C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD;AACD;;AACD;;AACF,iBAAK,QAAL;AACE,kBAAItF,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACE,MAA5B,EAAoC;AAClC,qBAAKwR,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,QAAhC,EAA0CnK,MAAM,CAACsN,cAAP,EAA1C;;AACA,wBAAQ3H,MAAR;AACE,uBAAK,MAAL;AACE,wBAAIrQ,OAAO,CAACsY,UAAR,CAAmB5N,MAAnB,CAAJ,EAAgC;AAC9BhM,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,iCAAR,EAA2C4T,WAA3C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD,CAAvC;AACD;;AACD;;AAEF,uBAAK,MAAL;AACE,wBAAIhY,OAAO,CAACuY,YAAR,CAAqB7N,MAArB,CAAJ,EAAkC;AAChChM,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,kCAAR,EAA4C4T,WAA5C,EAAyDnK,MAAM,CAACsN,cAAP,EAAzD,CAAvC;AACD;;AACD;;AAEF,uBAAK,KAAL;AACE,yBAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;AACA;AAfJ;AAiBD,eAnBD,MAmBO;AACL,qBAAKlE,KAAL,CAAW,aAAX,EAA0B5C,MAA1B,EAAkCwE,WAAlC,EAA+C,OAA/C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD;AACD;;AACD;;AAEF,iBAAK,aAAL;AACE,kBAAItF,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACK,WAA5B,EAAyC;AACvC,qBAAKqR,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,MAAhC,EAAwCnK,MAAM,CAACsN,cAAP,EAAxC,EAAiE,gBAAjE;;AACA,wBAAQ3H,MAAR;AACE,uBAAK,MAAL;AACE,wBAAIrQ,OAAO,CAACsY,UAAR,CAAmB5N,MAAM,CAAC2K,WAAP,GAAqBtO,OAArB,CAA6B,CAA7B,CAAnB,CAAJ,EAAyD;AACvDrI,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,8CAAR,EAAwD4T,WAAxD,EAAqEnK,MAAM,CAACsN,cAAP,EAArE,CAAvC;AACD;;AACD;;AAEF,uBAAK,MAAL;AACE,wBAAIhY,OAAO,CAACuY,YAAR,CAAqB7N,MAAM,CAAC2K,WAAP,GAAqBtO,OAArB,CAA6B,CAA7B,CAArB,CAAJ,EAA2D;AACzDrI,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,+CAAR,EAAyD4T,WAAzD,EAAsEnK,MAAM,CAACsN,cAAP,EAAtE,CAAvC;AACD;;AACD;;AAEF,uBAAK,KAAL;AACE,yBAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;AACA;AAfJ;AAiBD,eAnBD,MAmBO;AACL,qBAAKlE,KAAL,CAAW,aAAX,EAA0B4B,WAA1B,EAAuC,MAAvC,EAA+CnK,MAAM,CAACsN,cAAP,KAA0B,iBAAzE;AACD;;AACD;;AAEF,iBAAK,QAAL;AACE,kBAAItF,QAAQ,CAACC,IAAT,GAAgBpR,OAAO,CAACI,MAA5B,EAAoC;AAClC,qBAAKsR,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,MAAhC,EAAwCnK,MAAM,CAACsN,cAAP,EAAxC,EAAiE,UAAjE;;AACA,wBAAQ3H,MAAR;AACE,uBAAK,MAAL;AACE,wBAAIrQ,OAAO,CAACwY,UAAR,CAAmB9N,MAAnB,CAAJ,EAAgC;AAC9BhM,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,+BAAR,EAAyC4T,WAAzC,EAAsDnK,MAAM,CAACsN,cAAP,EAAtD,CAAvC;AACD;;AACD;;AAEF,uBAAK,MAAL;AACE,wBAAItN,MAAM,CAAC+N,WAAP,CAAmBzY,OAAnB,EAA4B,CAAC,CAA7B,EAAgC,KAAhC,EAAuC,OAAvC,CAAJ,EAAqD;AACnDtB,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsZ,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CAAuC,KAAKnX,EAAL,CAAQ,gCAAR,EAA0C4T,WAA1C,EAAuDnK,MAAM,CAACsN,cAAP,EAAvD,CAAvC;AACD;;AACD;;AAEF,uBAAK,KAAL;AACE,yBAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;AACA;AAfJ;AAiBD,eAnBD,MAmBO;AACL,qBAAKlE,KAAL,CAAW,aAAX,EAA0B4B,WAA1B,EAAuC,MAAvC,EAA+CnK,MAAM,CAACsN,cAAP,EAA/C,EAAwE,UAAxE;AACD;;AACD;AAlGJ;AAoGD,SApHc,CAoHb7Q,IApHa,CAoHR,IApHQ,CAAf;;AAsHA0C,QAAAA,OAAO,CAACnK,WAAR,CAAoB,MAApB,EAA4BoY,MAA5B,EAAoC,IAApC;AACA9E,QAAAA,SAAS,CAACtT,WAAV,CAAsB,MAAtB,EAA8BoY,MAA9B,EAAsC,IAAtC;;AAEA,YAAMY,SAAS,GAAG,SAAZA,SAAY,CAAS/Y,EAAT,EAAa;AAC7B;AACAqT,UAAAA,SAAS,CAACoE,cAAV,CAAyB,CAAC,IAA1B,EAAgC,CAAC,IAAjC;AACApE,UAAAA,SAAS,CAAC2F,aAAV;;AACA,cAAIlD,WAAJ,EAAiB;AACfA,YAAAA,WAAW,CAACrF,IAAZ;AACAqF,YAAAA,WAAW,GAAG,IAAd;AACD;;AACD,cAAI1D,iBAAJ,EAAuB;AACrBA,YAAAA,iBAAiB,CAAC6G,aAAlB;AACA7G,YAAAA,iBAAiB,GAAG,IAApB;AACD;;AACDW,UAAAA,QAAQ,CAAChI,MAAT,GAAkB,IAAlB;AACAgI,UAAAA,QAAQ,CAACC,IAAT,GAAgB,CAAhB;AACA,cAAImD,MAAM,GAAGnW,EAAE,CAACoW,UAAH,GAAgBC,SAAhB,EAAb;;AACA,cAAI,CAACF,MAAL,EAAa;AACXA,YAAAA,MAAM,GAAG3X,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAW4V,cAAX,CAA0BjS,WAA1B,EAAT;AACD;;AACD,cAAI8R,MAAM,CAACM,QAAP,CAAgB,OAAhB,CAAJ,EAA8B;AAC5BN,YAAAA,MAAM,CAACzK,WAAP,CAAmB,OAAnB;AACD;;AACD,eAAK6G,WAAL,CAAiB,KAAjB;AACD,SAtBD;;AAuBArI,QAAAA,OAAO,CAACnK,WAAR,CAAoB,SAApB,EAA+BgZ,SAA/B,EAA0C,IAA1C;AACAlG,QAAAA,SAAS,CAAC9S,WAAV,CAAsB,SAAtB,EAAiCgZ,SAAjC,EAA4C,IAA5C;AACD,OA3oCM;;AA6oCP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACI/J,MAAAA,SAAS,EAAE,mBAAUjE,MAAV,EAAkBmL,QAAlB,EAA4BhB,WAA5B,EAAyC;AAAA;;AAClD,YAAMb,MAAM,GAAG6B,QAAQ,KAAK,QAAb,IAAyBA,QAAQ,KAAK,aAAtC,GAAsDnL,MAAtD,GAA+DA,MAAM,CAACuJ,SAAP,EAA9E;AACA,YAAMC,mBAAmB,GAAGF,MAAM,CAACG,gBAAP,EAA5B;AACA,YAAII,OAAO,GAAGP,MAAM,CAACQ,kBAAP,CAA0B,KAA1B,CAAd;;AACA,YAAID,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;AACtB;AACA,cAAMiS,QAAQ,GAAG7E,MAAM,CAACqB,WAAP,EAAjB,CAFsB,CAGtB;;AACA,cAAI,CAACnB,mBAAmB,CAACO,mBAApB,EAAD,IAA8CoB,QAAQ,KAAK,QAA3D,IAAuEgD,QAAQ,CAACjS,MAAT,GAAkB,CAA7F,EAAgG;AAC9F;AACA,gBAAMkS,OAAO,GAAG5E,mBAAmB,CAACgB,2BAApB,EAAhB;AACA,gBAAI6D,WAAW,GAAG,CAAlB;AACA,gBAAIxD,WAAW,GAAG,CAAlB;;AACA,gBAAIM,QAAQ,KAAK,QAAjB,EAA2B;AACzBN,cAAAA,WAAW,GAAGuD,OAAO,CAACpO,MAAM,CAACqK,OAAP,EAAD,CAArB;AACA,kBAAMiE,WAAW,GAAGH,QAAQ,CAACI,OAAT,CAAiBvO,MAAjB,CAApB;;AACA,kBAAIsO,WAAW,GAAG,CAAlB,EAAqB;AACnB,oBAAIE,KAAK,GAAG,KAAZ,CADmB,CAEnB;;AACA,qBAAK,IAAIrH,CAAC,GAAGmH,WAAW,GAAC,CAAzB,EAA4BnH,CAAC,IAAI,CAAjC,EAAoCA,CAAC,EAArC,EAAyC;AACvC,sBAAMsH,OAAO,GAAGN,QAAQ,CAAC9R,OAAT,CAAiB8K,CAAjB,CAAhB;;AACA,sBAAI,CAACsH,OAAO,CAACpE,OAAR,GAAkBvR,UAAlB,CAA6B,GAA7B,CAAD,IAAsC2V,OAAO,CAACpE,OAAR,OAAsBrK,MAAM,CAACqK,OAAP,EAAhE,EAAkF;AAChFgE,oBAAAA,WAAW,GAAGD,OAAO,CAACK,OAAO,CAACpE,OAAR,EAAD,CAArB;AACAmE,oBAAAA,KAAK,GAAG,IAAR;AACA;AACD;AACF;;AACD,oBAAI,CAACA,KAAL,EAAY;AACV;AACAH,kBAAAA,WAAW,GAAGxD,WAAd;AACD;AACF;AACF,aAnBD,MAmBO,IAAIM,QAAQ,KAAK,OAAjB,EAA0B;AAC/BkD,cAAAA,WAAW,GAAGD,OAAO,CAACpO,MAAM,CAACqK,OAAP,EAAD,CAArB;;AACA,kBAAMiE,YAAW,GAAGH,QAAQ,CAACI,OAAT,CAAiBvO,MAAjB,CAApB;;AACA,kBAAIsO,YAAW,GAAGH,QAAQ,CAACjS,MAAT,GAAkB,CAApC,EAAuC;AACrC;AACA,oBAAIsS,MAAK,GAAG,KAAZ;;AACA,qBAAK,IAAIrH,EAAC,GAAGmH,YAAb,EAA0BnH,EAAC,GAAGgH,QAAQ,CAACjS,MAAvC,EAA+CiL,EAAC,EAAhD,EAAoD;AAClD,sBAAMsH,QAAO,GAAGN,QAAQ,CAAC9R,OAAT,CAAiB8K,EAAjB,CAAhB;;AACA,sBAAI,CAACsH,QAAO,CAACpE,OAAR,GAAkBvR,UAAlB,CAA6B,GAA7B,CAAD,IAAsC2V,QAAO,CAACpE,OAAR,OAAsBrK,MAAM,CAACqK,OAAP,EAAhE,EAAkF;AAChFQ,oBAAAA,WAAW,GAAGuD,OAAO,CAACK,QAAO,CAACpE,OAAR,EAAD,CAArB;AACAmE,oBAAAA,MAAK,GAAG,IAAR;AACA;AACD;AACF;;AACD,oBAAI,CAACA,MAAL,EAAY;AACV;AACA3D,kBAAAA,WAAW,GAAGwD,WAAd;AACD;AACF,eAfD,MAeO;AACL;AACAxD,gBAAAA,WAAW,GAAGwD,WAAW,GAAG,CAA5B;AACD;AACF,aAtBM,MAsBA,IAAIlD,QAAQ,KAAK,aAAjB,EAAgC;AACrC;AACA,kBAAMP,UAAU,GAAGuD,QAAQ,CAAC9R,OAAT,CAAiB,CAAjB,CAAnB;AACAwO,cAAAA,WAAW,GAAGuD,OAAO,CAACxD,UAAU,CAACP,OAAX,EAAD,CAArB;AACD;;AACDR,YAAAA,OAAO,GAAGA,OAAO,CAACtD,MAAR,CAAe,UAAAmI,IAAI;AAAA,qBAAI1V,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCiV,OAArC,EAA8CM,IAA9C,KAAuDN,OAAO,CAACM,IAAD,CAAP,IAAiB7D,WAAxE,IAAuFuD,OAAO,CAACM,IAAD,CAAP,IAAiBL,WAA5G;AAAA,aAAnB,CAAV;AACD;AACF;;AACD,YAAIxE,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;AACtB,eAAK1D,QAAL,GAAiB,IAAjB;AACA,cAAImW,eAAJ;;AACA,cAAI9E,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;AACtB;AACAyS,YAAAA,eAAe,GAAG,IAAI3a,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsN,IAAd,CAAmBoN,WAAvB,CAAmC;AACnDC,cAAAA,WAAW,EAAE,IADsC;AAEnDC,cAAAA,OAAO,EAAE,IAF0C;AAGnDC,cAAAA,OAAO,EAAE,KAAKxY,EAAL,CAAQ,gJAAR,CAH0C;AAInDyY,cAAAA,QAAQ,EAAE;AACRC,gBAAAA,IAAI,EAAE;AACJA,kBAAAA,IAAI,EAAE,WADF;AAEJxO,kBAAAA,KAAK,EAAE,KAAKlK,EAAL,CAAQ,gBAAR,CAFH;AAGJ2Y,kBAAAA,IAAI,EAAE,KAAK3Y,EAAL,CAAQ,iDAAR,CAHF;AAIJ4Y,kBAAAA,OAAO,EAAEtF,OAAO,CAACuF,IAAR,CAAa,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAC9B,wBAAID,CAAC,CAACvW,UAAF,CAAa,GAAb,KAAqB,CAACwW,CAAC,CAACxW,UAAF,CAAa,GAAb,CAA1B,EAA6C;AAC3C,6BAAO,CAAP;AACD,qBAFD,MAEO,IAAI,CAACuW,CAAC,CAACvW,UAAF,CAAa,GAAb,CAAD,IAAsBwW,CAAC,CAACxW,UAAF,CAAa,GAAb,CAA1B,EAA6C;AAClD,6BAAO,CAAC,CAAR;AACD;;AACD,2BAAOuW,CAAC,CAACE,aAAF,CAAgBD,CAAhB,CAAP;AACD,mBAPQ,EAONE,GAPM,CAOF,UAAAd,IAAI;AAAA,2BAAK;AAACjO,sBAAAA,KAAK,EAAEiO,IAAR;AAAcnU,sBAAAA,KAAK,EAAEmU;AAArB,qBAAL;AAAA,mBAPF,CAJL;AAYJe,kBAAAA,UAAU,EAAE;AACVC,oBAAAA,QAAQ,EAAE;AADA;AAZR;AADE;AAJyC,aAAnC,EAsBfC,IAtBe,GAsBRC,OAtBQ,EAAlB;AAuBD,WAzBD,MAyBO;AACLjB,YAAAA,eAAe,GAAGpV,OAAO,CAACC,OAAR,CAAgB;AAACyV,cAAAA,IAAI,EAAEpF,OAAO,CAAC,CAAD;AAAd,aAAhB,CAAlB;AACD;;AACD8E,UAAAA,eAAe,CAACkB,IAAhB,CAAqB,UAAA3J,MAAM,EAAI;AAC7B,gBAAIA,MAAJ,EAAY;AACV,kBAAM+I,IAAI,GAAG/I,MAAM,CAAC+I,IAApB,CADU,CAEV;;AACA,kBAAMlG,SAAQ,GAAG/I,MAAM,CAAClC,OAAP,GAAiBgS,aAAlC;AACA,kBAAIxa,OAAJ;AACA,kBAAIya,SAAS,GAAG,KAAhB;;AACA,sBAAQd,IAAR;AACE,qBAAK,UAAL;AACE3Z,kBAAAA,OAAO,GAAGyT,SAAQ,CAACiH,aAAT,CAAuB,EAAvB,CAAV;AACA;;AAEF,qBAAK,OAAL;AACE1a,kBAAAA,OAAO,GAAGyT,SAAQ,CAACkH,cAAT,CAAwB,EAAxB,CAAV;AACA;;AAEF,qBAAK,gBAAL;AACE3a,kBAAAA,OAAO,GAAGyT,SAAQ,CAACmH,kBAAT,CAA4B,EAA5B,CAAV;AACA;;AAEF;AACE5a,kBAAAA,OAAO,GAAGyT,SAAQ,CAACoH,aAAT,CAAuBlB,IAAvB,CAAV;AACAc,kBAAAA,SAAS,GAAG,IAAZ;AACA;AAhBJ;;AAkBA,kBAAMK,aAAa,GAAG5G,mBAAmB,CAAC6G,8BAApB,CAAmDpB,IAAnD,CAAtB;;AAEA,kBAAMqB,YAAY,GAAG,SAAfA,YAAe,CAAUhb,OAAV,EAAmB8a,aAAnB,EAAkC;AACrD,oBAAMG,gBAAgB,GAAGH,aAAa,CAACI,mBAAd,EAAzB;;AACA,oBAAID,gBAAgB,CAACrU,MAAjB,GAA0B,CAA9B,EAAiC;AAC/B,sBAAI,CAACkU,aAAa,CAACrG,mBAAd,EAAL,EAA0C;AACxC;AACA,wBAAME,cAAc,GAAGmG,aAAa,CAAClG,yBAAd,EAAvB;AACAqG,oBAAAA,gBAAgB,CAACnB,IAAjB,CAAsBpb,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBqX,MAApB,CAA2BC,OAA3B,CAAmCC,cAAnC,CAAkD1G,cAAlD,CAAtB;AACD;AACF;;AACDsG,gBAAAA,gBAAgB,CAAChT,OAAjB,CAAyB,UAAAqT,SAAS,EAAI;AACpC,sBAAMC,KAAK,GAAG9H,SAAQ,CAACoH,aAAT,CAAuBS,SAAvB,CAAd;;AACAtb,kBAAAA,OAAO,CAACwb,WAAR,CAAoBD,KAApB,EAFoC,CAGpC;;AACAP,kBAAAA,YAAY,CAACO,KAAD,EAAQT,aAAa,CAACC,8BAAd,CAA6CO,SAA7C,CAAR,CAAZ;AACD,iBALD;;AAMA,oBAAIR,aAAa,CAACW,qBAAd,EAAJ,EAA2C;AACzC,sBAAMF,KAAK,GAAG9H,SAAQ,CAACkH,cAAT,CAAwB,GAAxB,CAAd;;AACA3a,kBAAAA,OAAO,CAACwb,WAAR,CAAoBD,KAApB;AACD;AACF,eAnBD;;AAoBA,kBAAId,SAAJ,EAAe;AACbO,gBAAAA,YAAY,CAAChb,OAAD,EAAU8a,aAAV,CAAZ;AACD;;AAED,kBAAMY,UAAU,GAAG,IAAIhd,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoB6X,UAAxB,CAAmC3b,OAAnC,EAA4C8a,aAA5C,EAA2DpQ,MAAM,CAACkR,SAAP,EAA3D,EAA+E5H,MAA/E,CAAnB,CAlDU,CAmDV;;AACA0H,cAAAA,UAAU,CAAC9J,IAAX;AACA,kBAAIiK,GAAG,GAAG5X,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAV;;AACA,kBAAIwX,UAAU,CAACI,gBAAX,EAAJ,EAAmC;AACjC;AACAD,gBAAAA,GAAG,GAAG,MAAI,CAACpQ,OAAL,CAAa,IAAb,EAAmBiQ,UAAnB,EAA+B,IAA/B,CAAN;AACD;;AACDG,cAAAA,GAAG,CAACtB,IAAJ,CAAS,UAAA/a,IAAI,EAAI;AACf,oBAAIA,IAAJ,EAAU;AACR;AACA,0BAAQqW,QAAR;AACE,yBAAK,QAAL;AACE6F,sBAAAA,UAAU,CAACnD,YAAX,CAAwB7N,MAAxB;AACA;;AAEF,yBAAK,OAAL;AACEgR,sBAAAA,UAAU,CAACrD,WAAX,CAAuB3N,MAAvB;AACA;;AAEF,yBAAK,QAAL;AACEA,sBAAAA,MAAM,CAAC+N,WAAP,CAAmBiD,UAAnB,EAA+B,CAAC,CAAhC,EAAmC,KAAnC,EAA0C,OAA1C;AACA;;AAEF,yBAAK,aAAL;AACEhR,sBAAAA,MAAM,CAAC+N,WAAP,CAAmBiD,UAAnB,EAA+B,CAA/B,EAAkC,KAAlC,EAAyC,OAAzC;AACA;AAfJ;;AAiBA,kBAAA,MAAI,CAACxW,eAAL,CAAqB,MAArB,EAA6BsM,kBAA7B,CAAgDkK,UAAhD;;AACA,kBAAA,MAAI,CAACxW,eAAL,CAAqB,MAArB,EAA6B6W,YAA7B,CAA0C,CAACL,UAAD,CAA1C;AACD;AACF,eAvBD,EAuBG,MAvBH,WAuBe,UAAAM,GAAG;AAAA,uBAAI,MAAI,CAAClU,KAAL,CAAWkU,GAAX,CAAJ;AAAA,eAvBlB;AAwBD;AACF,WApFD;AAqFD;AACF,OAx0CM;AA00CPlH,MAAAA,QAAqB,EAAE,kBAAUH,cAAV,EAA0BE,WAA1B,EAAuCoH,UAAvC,EAAmDC,KAAnD,EAA0D;AAC/E,YAAIvH,cAAJ,EAAoB;AAClB,cAAIwH,eAAe,GAAGxH,cAAc,CAACE,WAAD,CAApC;;AACA,cAAI,OAAOsH,eAAP,KAA2B,QAA/B,EAAyC;AACvCA,YAAAA,eAAe,GAAGA,eAAe,CAACC,KAAhB,CAAsB,GAAtB,EAA2BlC,GAA3B,CAA+B,UAAArI,CAAC;AAAA,qBAAI,QAAQwK,IAAR,CAAaxK,CAAb,IAAkByK,QAAQ,CAACzK,CAAD,CAA1B,GAAgCA,CAApC;AAAA,aAAhC,CAAlB;AACD,WAFD,MAEO;AACLsK,YAAAA,eAAe,GAAG,CAACA,eAAD,CAAlB;AACD;;AACD,cAAIhH,cAAc,GAAGR,cAAc,CAACsH,UAAD,CAAnC;;AACA,cAAI,OAAO9G,cAAP,KAA0B,QAA9B,EAAwC;AACtCA,YAAAA,cAAc,GAAGA,cAAc,CAACiH,KAAf,CAAqB,GAArB,EAA0BlC,GAA1B,CAA8B,UAAArI,CAAC;AAAA,qBAAI,QAAQwK,IAAR,CAAaxK,CAAb,IAAkByK,QAAQ,CAACzK,CAAD,CAA1B,GAAgCA,CAApC;AAAA,aAA/B,CAAjB;AACD,WAFD,MAEO;AACLsD,YAAAA,cAAc,GAAG,CAACA,cAAD,CAAjB;AACD;;AACD,cAAM+G,MAAK,GAAGvI,IAAI,CAAC4I,GAAL,CAASL,MAAK,IAAI,CAAlB,EAAqBC,eAAe,CAACvV,MAArC,EAA6CuO,cAAc,CAACvO,MAA5D,CAAd;;AACA,eAAK,IAAIiL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqK,MAApB,EAA2BrK,CAAC,EAA5B,EAAgC;AAC9B,gBAAIsK,eAAe,CAACtK,CAAD,CAAf,KAAuBsD,cAAc,CAACtD,CAAD,CAAzC,EAA8C;AAC5C;AACA,qBAAOnT,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0BlR,OAA1B,CAAkCE,MAAlC,GAA2C/C,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0BlR,OAA1B,CAAkCG,KAApF;AACD,aAHD,MAGO,IAAIya,eAAe,CAACtK,CAAD,CAAf,GAAqB,CAArB,KAA2BsD,cAAc,CAACtD,CAAD,CAA7C,EAAkD;AACvD,qBAAOnT,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0BlR,OAA1B,CAAkCG,KAAzC;AACD,aAFM,MAEA,IAAIya,eAAe,CAACtK,CAAD,CAAf,GAAqB,CAArB,KAA2BsD,cAAc,CAACtD,CAAD,CAA7C,EAAkD;AACvD,qBAAOnT,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0BlR,OAA1B,CAAkCE,MAAzC;AACD;AACF;AACF;;AACD,eAAO/C,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0BlR,OAA1B,CAAkCC,IAAzC;AACD,OAr2CM;AAu2CPgb,MAAAA,QAAe,EAAE,kBAAU7S,EAAV,EAAc+P,QAAd,EAAwB1Z,OAAxB,EAAiC;AAAA;;AAChD,YAAMyc,QAAQ,GAAG/d,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBW,IAArB,CAA0Bkd,QAA1B,CAAmCpP,GAAnC,CAAuC3D,EAAvC,CAAjB;;AACA,YAAI8S,QAAJ,EAAc;AACZ,cAAI,OAAOA,QAAQ,CAACE,OAAhB,KAA4B,UAAhC,EAA4C;AAC1CjD,YAAAA,QAAQ,CAACG,OAAT,GAAmB4C,QAAQ,CAACE,OAAT,CAAiB3c,OAAjB,CAAnB;AACD,WAFD,MAEO,IAAIyc,QAAQ,CAACjd,IAAb,EAAmB;AACxBka,YAAAA,QAAQ,CAACG,OAAT,GAAmB4C,QAAQ,CAACjd,IAA5B;AACD,WAFM,MAEA;AACL,iBAAKsI,KAAL,CAAW,sCAAsC6B,EAAjD;AACD;;AACD+P,UAAAA,QAAQ,CAACC,IAAT,GAAgB8C,QAAQ,CAACG,gBAAT,GAA4B,iBAA5B,GAAgD,kBAAhE;AACD,SATD,MASO,IAAI,CAAC,SAAD,EAAY,SAAZ,EAAuBC,QAAvB,CAAgClT,EAAE,CAACyS,KAAH,CAAS,GAAT,EAAcvU,GAAd,EAAhC,CAAJ,EAA0D;AAC/D,cAAM8R,IAAI,GAAGhQ,EAAE,CAACyS,KAAH,CAAS,GAAT,EAAcvU,GAAd,EAAb,CAD+D,CAE/D;;AACA,cAAMkF,IAAI,GAAG,KAAK7H,eAAL,CAAqB,MAArB,CAAb;AACA,cAAMyL,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;AACAkR,UAAAA,QAAQ,CAACC,IAAT,GAAgB,WAAhB;AACAD,UAAAA,QAAQ,CAACG,OAAT,GAAmB,EAAnB;AACA,cAAMpJ,QAAQ,GAAG,KAAKpN,UAAL,KAAoB,MAApB,GAA6B,kBAAkBsW,IAA/C,GAAsD,YAAYA,IAAZ,GAAmB,MAAnB,GAA4BA,IAAnG;AACAhJ,UAAAA,QAAQ,CAACK,gBAAT,CAA0BP,QAA1B,EAAoCxI,OAApC,CAA4C,UAAAjI,OAAO,EAAI;AACrD,gBAAMoZ,IAAI,GAAGpZ,OAAO,CAACqR,YAAR,CAAqB,MAArB,CAAb;AACAqI,YAAAA,QAAQ,CAACG,OAAT,CAAiBjS,IAAjB,CAAsB;AAACuD,cAAAA,KAAK,EAAEiO,IAAR;AAAcnU,cAAAA,KAAK,EAAEmU;AAArB,aAAtB;AACD,WAHD;AAID;;AACD,YAAIM,QAAQ,CAACC,IAAT,CAAcmD,QAAd,CAAuB,WAAvB,CAAJ,EAAyC;AACvC;AACA,iBAAOpD,QAAQ,CAACrN,WAAhB;;AACA,cAAI,CAACqN,QAAQ,CAACS,UAAT,CAAoBC,QAAzB,EAAmC;AACjC,gBAAIV,QAAQ,CAACG,OAAT,YAA4B5V,OAAhC,EAAyC;AACvCyV,cAAAA,QAAQ,CAACG,OAAT,CAAiBU,IAAjB,CAAsB,UAAAsB,GAAG,EAAI;AAC3B,oBAAIpc,KAAK,CAACsd,OAAN,CAAclB,GAAd,CAAJ,EAAwB;AACtBA,kBAAAA,GAAG,CAACmB,OAAJ,CAAY;AAAC7R,oBAAAA,KAAK,EAAE,QAAQ,MAAI,CAAClK,EAAL,CAAQ,SAAR,CAAR,GAA6B,KAArC;AAA4CgE,oBAAAA,KAAK,EAAE;AAAnD,mBAAZ;AACD;AACF,eAJD,WAIS,YAAM,CAAE,CAJjB,EADuC,CAKnB;AACrB,aAND,MAMO;AACLyU,cAAAA,QAAQ,CAACG,OAAT,CAAiBmD,OAAjB,CAAyB;AAAC7R,gBAAAA,KAAK,EAAE,QAAQ,KAAKlK,EAAL,CAAQ,SAAR,CAAR,GAA6B,KAArC;AAA4CgE,gBAAAA,KAAK,EAAE;AAAnD,eAAzB;AACD;AACF;AACF;AACF,OA94CM;AAg5CPgY,MAAAA,SAA4B,EAAE,mBAAUjd,OAAV,EAAmBkd,SAAnB,EAA8B;AAC1D,YAAMC,IAAI,GAAGD,SAAS,CAACE,gBAAV,EAAb;AACA,YAAMC,GAAG,GAAG;AACV1D,UAAAA,IAAI,EAAE,WADI;AAEVxO,UAAAA,KAAK,EAAE+R,SAAS,CAACnI,OAAV,EAFG;AAGV1I,UAAAA,WAAW,EAAE,QAAQ,KAAKpL,EAAL,CAAQ,SAAR,CAAR,GAA6B,KAHhC;AAIV2Y,UAAAA,IAAI,EAAEuD,IAAI,CAACG,IAAL,CAAU,OAAV,CAJI;AAKVC,UAAAA,OAAO,EAAEvd,OAAO,CAACmS,UAAR,EALC;AAMVlN,UAAAA,KAAK,EAAEjF,OAAO,CAACqR,YAAR,CAAqB6L,SAAS,CAACnI,OAAV,EAArB,KAA6CmI,SAAS,CAACM,eAAV,EAN1C;AAOVrD,UAAAA,UAAU,EAAE;AACVC,YAAAA,QAAQ,EAAE,CAAC8C,SAAS,CAACO,UAAV,EADD;AAEVC,YAAAA,SAAS,EAAE,mBAAUzY,KAAV,EAAiB;AAC1B,kBAAIA,KAAK,YAAY9G,EAAE,CAACQ,EAAH,CAAMuN,IAAN,CAAWyR,QAAhC,EAA0C;AACxC1Y,gBAAAA,KAAK,GAAGA,KAAK,CAAC4K,QAAN,GAAiB+N,QAAjB,EAAR;AACD;;AACD,kBAAI,CAACV,SAAS,CAACW,YAAV,CAAuB5Y,KAAvB,CAAL,EAAoC;AAClC,sBAAM,IAAI9G,EAAE,CAACkC,IAAH,CAAQyd,eAAZ,CAA4B3f,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,4BAArB,CAA5B,CAAN;AACD;AACF;AATS;AAPF,SAAZ;;AAmBA,gBAAQic,SAAS,CAACa,aAAV,EAAR;AACE,eAAK,SAAL;AACEV,YAAAA,GAAG,CAAC1D,IAAJ,GAAW,UAAX;AACA0D,YAAAA,GAAG,CAACpY,KAAJ,GAAYoY,GAAG,CAACpY,KAAJ,KAAc,EAAd,IAAoBoY,GAAG,CAACpY,KAAJ,KAAc,IAAlC,IAA0CoY,GAAG,CAACpY,KAAJ,KAAcmQ,SAAxD,GAAoE,IAApE,GAA2EiI,GAAG,CAACpY,KAAJ,KAAc,MAArG;AACA,mBAAOoY,GAAG,CAAChR,WAAX;AACA;;AAEF,eAAK,QAAL;AAAe;AACb,kBAAM2R,KAAK,GAAGd,SAAS,CAACe,cAAV,EAAd;;AACA,kBAAID,KAAK,CAACpX,MAAN,GAAe,CAAnB,EAAsB;AACpByW,gBAAAA,GAAG,CAAC1D,IAAJ,GAAW,WAAX;AACA,uBAAO0D,GAAG,CAAChR,WAAX;AACAgR,gBAAAA,GAAG,CAACxD,OAAJ,GAAc,EAAd;AACAmE,gBAAAA,KAAK,CAAC/V,OAAN,CAAc,UAAAmR,IAAI,EAAI;AACpBiE,kBAAAA,GAAG,CAACxD,OAAJ,CAAYjS,IAAZ,CAAiB;AAACuD,oBAAAA,KAAK,EAAEiO,IAAR;AAAcnU,oBAAAA,KAAK,EAAEmU;AAArB,mBAAjB;AACD,iBAFD;;AAGA,oBAAI8D,SAAS,CAACO,UAAV,EAAJ,EAA4B;AAC1B;AACAJ,kBAAAA,GAAG,CAACxD,OAAJ,CAAYmD,OAAZ,CAAoB;AAAC7R,oBAAAA,KAAK,EAAE,QAAQ,KAAKlK,EAAL,CAAQ,SAAR,CAAR,GAA6B,KAArC;AAA4CgE,oBAAAA,KAAK,EAAE;AAAnD,mBAApB;AACD;AACF,eAXD,MAWO;AACL;AACA,qBAAKuX,QAAL,CAAqBxc,OAAO,CAAC+U,OAAR,KAAoB,GAApB,GAA0BmI,SAAS,CAACnI,OAAV,EAA/C,EAAoEsI,GAApE,EAAyErd,OAAO,CAACwI,OAAR,EAAzE;AACD;;AACD;AACD;AAzBH;;AA2BA,eAAO6U,GAAP;AACD,OAj8CM;AAm8CP5R,MAAAA,OAAO,EAAE,iBAAU9L,EAAV,EAAcK,OAAd,EAAuBke,KAAvB,EAA8B;AAAA;;AACrC,YAAI,CAAC,KAAKzY,OAAL,EAAD,IAAmB,CAAC,KAAKA,OAAL,GAAeE,WAAf,EAAxB,EAAsD;AACpD,iBAAO,IAAP;AACD;;AACD,YAAIwY,KAAJ;AACA,YAAIC,OAAJ;;AACA,YAAI,CAACpe,OAAL,EAAc;AACZ,cAAI,KAAK0O,WAAL,EAAJ,EAAwB;AACtB1O,YAAAA,OAAO,GAAG,KAAK0O,WAAL,EAAV;AACD,WAFD,MAEO;AACL,mBAAO,IAAP;AACD;AACF;;AACD,YAAI,CAAC1O,OAAO,CAACqe,iBAAR,EAAL,EAAkC;AAChC,iBAAO,IAAP;AACD;;AACDre,QAAAA,OAAO,CAAC4R,IAAR;AACA,YAAM8H,QAAQ,GAAG,EAAjB;AACA,YAAM4E,WAAW,GAAGte,OAAO,CAACmU,gBAAR,EAApB;;AACA,YAAI+J,KAAJ,EAAW;AACTC,UAAAA,KAAK,GAAG,KAAKld,EAAL,CAAQ,uBAAR,EAAiCjB,OAAO,CAAC+U,OAAR,EAAjC,CAAR;AACAqJ,UAAAA,OAAO,GAAG,KAAKnd,EAAL,CAAQ,8FAAR,EAAwGjB,OAAO,CAAC+U,OAAR,EAAxG,CAAV;AACD,SAHD,MAGO;AACLoJ,UAAAA,KAAK,GAAG,KAAKld,EAAL,CAAQ,yBAAR,CAAR;AACAmd,UAAAA,OAAO,GAAGpe,OAAO,CAACmS,UAAR,KAAuB,KAAKlR,EAAL,CAAQ,SAAR,EAAmBjB,OAAO,CAAC+U,OAAR,EAAnB,CAAvB,GAA+D,KAAK9T,EAAL,CAAQ,SAAR,EAAmBjB,OAAO,CAAC+U,OAAR,EAAnB,CAAzE;AACD;;AACD,YAAI/U,OAAO,CAACwI,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACC,YAAxC,EAAsD;AACpD,cAAMC,OAAO,GAAGJ,WAAW,CAACK,oBAAZ,EAAhB;AACAjb,UAAAA,MAAM,CAAC4Q,IAAP,CAAYoK,OAAZ,EAAqBzW,OAArB,CAA6B,UAAAmR,IAAI,EAAI;AACnC,gBAAM8D,SAAS,GAAGwB,OAAO,CAACtF,IAAD,CAAzB;;AACA,gBAAI,CAAC,MAAI,CAACwF,SAAL,EAAL,EAAuB;AACrB,kBAAMC,OAAO,GAAG3B,SAAS,CAAC4B,UAAV,EAAhB;;AACA,kBAAID,OAAO,CAAChC,QAAR,CAAiB,cAAjB,CAAJ,EAAsC;AACpC;AACA;AACD;AACF;;AACDnD,YAAAA,QAAQ,CAACN,IAAD,CAAR,GAAiB,MAAI,CAAC6D,SAAL,CAAkCjd,OAAlC,EAA2Ckd,SAA3C,CAAjB;AACD,WAVD;;AAWA,cAAIoB,WAAW,CAACtJ,qBAAZ,CAAkC,GAAlC,CAAJ,EAA4C;AAC1C,gBAAM+J,MAAM,GAAG,IAAIC,SAAJ,EAAf;AACA,gBAAMC,QAAQ,GAAGjf,OAAO,CAACwI,OAAR,GAAkB0W,QAAlB,KAA+B,QAA/B,GAA0C,YAA1C,GAAyD,YAA1E;;AACA,gBAAIhB,KAAJ,EAAW;AACTC,cAAAA,KAAK,GAAG,KAAKld,EAAL,CAAQ,uBAAR,EAAiCjB,OAAO,CAAC+U,OAAR,EAAjC,CAAR;AACAqJ,cAAAA,OAAO,GAAG,KAAKnd,EAAL,CAAQ,2FAAR,EAAqGjB,OAAO,CAAC+U,OAAR,EAArG,CAAV;AACD,aAHD,MAGO;AACLoJ,cAAAA,KAAK,GAAGc,QAAQ,KAAK,YAAb,GAA4B,KAAKhe,EAAL,CAAQ,0BAAR,CAA5B,GAAkE,KAAKA,EAAL,CAAQ,sBAAR,CAA1E;AACD;;AACDyY,YAAAA,QAAQ,CAACuF,QAAD,CAAR,GAAqB;AACnBtF,cAAAA,IAAI,EAAE,UADa;AAEnBxO,cAAAA,KAAK,EAAE,EAFY;AAGnBgU,cAAAA,KAAK,EAAE,CAHY;AAInBC,cAAAA,QAAQ,EAAE,IAJS;AAKnBlS,cAAAA,KAAK,EAAEyG,IAAI,CAAC4I,GAAL,CAASpe,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAT,EAAqC,GAArC,CALY;AAMnByY,cAAAA,OAAO,EAAEvd,OAAO,CAACmS,UAAR,EANU;AAOnBlN,cAAAA,KAAK,EAAEga,QAAQ,KAAK,YAAb,GAA4Bjf,OAAO,CAACwI,OAAR,GAAkBC,SAA9C,GAA0DzI,OAAO,CAACwI,OAAR,GAAkB6W,SAPhE;AAQnBlF,cAAAA,UAAU,EAAE;AACVuD,gBAAAA,SAAS,EAAE,mBAAUzY,KAAV,EAAiB;AAC1B,sBAAIA,KAAJ,EAAW;AACT,wBAAMqa,GAAG,GAAGP,MAAM,CAACQ,eAAP,CAAuBta,KAAvB,EAA8B,UAA9B,CAAZ;;AACA,wBAAIqa,GAAG,CAACE,oBAAJ,CAAyB,aAAzB,EAAwC5Y,MAAxC,GAAiD,CAArD,EAAwD;AACtD,4BAAM,IAAIzI,EAAE,CAACkC,IAAH,CAAQyd,eAAZ,CAA4B3f,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,4BAArB,CAA5B,CAAN;AACD;AACF;AACF;AARS;AARO,aAArB;AAmBD;AACF,SA1CD,MA0CO,IAAIjB,OAAO,CAACwI,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACiB,SAApC,IAAiDzf,OAAO,CAACwI,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACkB,YAArF,IAAqG1f,OAAO,CAACwI,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACmB,kBAA7I,EAAiK;AACtKxB,UAAAA,KAAK,GAAG,KAAKld,EAAL,CAAQ,mBAAR,EAA6BjB,OAAO,CAAC+U,OAAR,EAA7B,CAAR;AACAqJ,UAAAA,OAAO,GAAG,EAAV;AACA,cAAIc,QAAQ,GAAGlf,OAAO,CAACwI,OAAR,GAAkB0W,QAAjC,CAHsK,CAItK;;AACA,cAAM/B,IAAI,GAAGmB,WAAW,CAAClB,gBAAZ,EAAb;AACA1D,UAAAA,QAAQ,CAACwF,QAAD,CAAR,GAAqB;AACnBvF,YAAAA,IAAI,EAAE,UADa;AAEnBxO,YAAAA,KAAK,EAAE,EAFY;AAGnBgU,YAAAA,KAAK,EAAE,CAHY;AAInBC,YAAAA,QAAQ,EAAE,IAJS;AAKnBlS,YAAAA,KAAK,EAAEyG,IAAI,CAAC4I,GAAL,CAASpe,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAT,EAAqC,GAArC,CALY;AAMnBuH,YAAAA,WAAW,EAAE,KAAKpL,EAAL,CAAQ,SAAR,CANM;AAOnB2Y,YAAAA,IAAI,EAAEuD,IAAI,CAACG,IAAL,CAAU,OAAV,CAPa;AAQnBC,YAAAA,OAAO,EAAEvd,OAAO,CAACmS,UAAR,EARU;AASnBlN,YAAAA,KAAK,EAAEjF,OAAO,CAAC4f,cAAR,EATY;AAUnBzF,YAAAA,UAAU,EAAE;AACVuD,cAAAA,SAAS,EAAE,mBAAUzY,KAAV,EAAiB;AAC1B,oBAAIA,KAAK,YAAY9G,EAAE,CAACQ,EAAH,CAAMuN,IAAN,CAAWyR,QAAhC,EAA0C;AACxC1Y,kBAAAA,KAAK,GAAGA,KAAK,CAAC4K,QAAN,GAAiB+N,QAAjB,EAAR;AACD;;AACD,oBAAI,CAACU,WAAW,CAACT,YAAZ,CAAyB5Y,KAAzB,CAAL,EAAsC;AACpC,wBAAM,IAAI9G,EAAE,CAACkC,IAAH,CAAQyd,eAAZ,CAA4B3f,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,4BAArB,CAA5B,CAAN;AACD;AACF;AARS;AAVO,WAArB;;AAqBA,cAAIjB,OAAO,CAAC6f,UAAR,MAAwB7f,OAAO,CAACiU,SAAR,GAAoBc,OAApB,OAAkC,QAA9D,EAAwE;AACtE,gBAAM4E,IAAI,GAAG3Z,OAAO,CAACiU,SAAR,GAAoB5C,YAApB,CAAiC,MAAjC,CAAb;;AACA,gBAAI,CAACsI,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,KAA7B,KAAuC3Z,OAAO,CAACwI,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACiB,SAA/E,EAA0F;AACxFzf,cAAAA,OAAO,CAAC8f,mBAAR,CAA4BtB,IAAI,CAACmB,kBAAjC;AACA,kBAAMI,WAAW,GAAG/f,OAAO,CAACwI,OAAR,GAAkB0W,QAAtC;AACAxF,cAAAA,QAAQ,CAACqG,WAAD,CAAR,GAAwBrG,QAAQ,CAACwF,QAAD,CAAhC;AACA,qBAAOxF,QAAQ,CAACwF,QAAD,CAAf;AACAA,cAAAA,QAAQ,GAAGa,WAAX;AACD,aARqE,CAStE;AAEA;;AACA;AACV;AACA;AACA;AACA;AACA;;AACS;;AACD,eAAKvD,QAAL,CAAqBxc,OAAO,CAACiU,SAAR,GAAoBc,OAApB,KAAgC,GAAhC,GAAsC/U,OAAO,CAAC+U,OAAR,EAA3D,EAA8E2E,QAAQ,CAACwF,QAAD,CAAtF,EAAkGlf,OAAO,CAACwI,OAAR,EAAlG;AACD;;AACD,aAAKtF,QAAL,GAAiB,IAAjB;AAEA,YAAM8c,UAAU,GAAG,IAAIthB,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsN,IAAd,CAAmBoN,WAAvB,CAAmC;AACpDC,UAAAA,WAAW,EAAE,IADuC;AAEpDC,UAAAA,OAAO,EAAE,IAF2C;AAGpD4E,UAAAA,OAAO,EAAGD,KAH0C;AAIpD1E,UAAAA,OAAO,EAAE2E,OAJ2C;AAKpD1E,UAAAA,QAAQ,EAAEA,QAL0C;AAMpD/O,UAAAA,QAAQ,EAAEgJ,IAAI,CAAC4I,GAAL,CAASpe,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAT,EAAqC,GAArC,CAN0C;AAOpDmb,UAAAA,QAAQ,EAAE9hB,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB;AAP0C,SAAnC,EAQhBuV,IARgB,EAAnB;AASA,eAAO2F,UAAU,CAAC1F,OAAX,GAAqBC,IAArB,CAA0B,UAAA/a,IAAI,EAAI;AACvC,cAAIA,IAAI,IAAIQ,OAAO,CAACmS,UAAR,EAAZ,EAAkC;AAChC;AACAnS,YAAAA,OAAO,CAACkgB,aAAR,CAAsB1gB,IAAtB;;AACA,YAAA,MAAI,CAAC4I,UAAL;;AACA,gBAAI,CAAC1E,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCrE,IAArC,EAA2C,YAA3C,CAAD,IAA6D,CAACkE,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCrE,IAArC,EAA2C,YAA3C,CAAlE,EAA4H;AAC1HQ,cAAAA,OAAO,CAACmgB,QAAR;AACD;AACF;;AACD,UAAA,MAAI,CAACjd,QAAL,GAAiB,KAAjB;AACA8c,UAAAA,UAAU,CAACI,OAAX;AACA,iBAAO5gB,IAAP;AACD,SAZM,CAAP;AAaD,OA/kDM;AAilDPmM,MAAAA,SAAS,EAAE,mBAAUhM,EAAV,EAAcK,OAAd,EAAuB;AAChC,YAAI,CAACA,OAAL,EAAc;AACZA,UAAAA,OAAO,GAAG,KAAK0O,WAAL,EAAV;AACD;;AACD,YAAI1O,OAAO,IAAIA,OAAO,CAACqH,WAAR,EAAf,EAAsC;AACpCrH,UAAAA,OAAO,CAACqgB,MAAR;AACA,eAAKjY,UAAL;AACA,iBAAOpI,OAAP;AACD;;AACD,eAAO,IAAP;AACD,OA3lDM;AA6lDPoG,MAAAA,MAAM,EAAE,kBAAY;AAClB,YAAI,KAAKlD,QAAT,EAAoB;AAClBuQ,UAAAA,QAAQ,CAAC6M,WAAT,CAAqB,KAArB;AACD,SAFD,MAEO;AACL,cAAMtgB,OAAO,GAAG,KAAK2L,SAAL,EAAhB;;AACA,cAAI3L,OAAJ,EAAa;AACX,iBAAKugB,YAAL,CAAkBvgB,OAAlB;AACD;AACF;AACF,OAtmDM;AAwmDPqG,MAAAA,OAAO,EAAE,mBAAY;AACnB,YAAI,KAAKnD,QAAT,EAAoB;AAClBuQ,UAAAA,QAAQ,CAAC6M,WAAT,CAAqB,MAArB;AACD,SAFD,MAEO;AACL,cAAMtgB,OAAO,GAAG,KAAK0O,WAAL,EAAhB;;AACA,cAAI1O,OAAJ,EAAa;AACX,gBAAMwgB,IAAI,GAAGxgB,OAAO,CAAC+X,KAAR,EAAb;AACA,iBAAKwI,YAAL,CAAkBC,IAAlB;AACD;AACF;AACF,OAlnDM;AAonDPla,MAAAA,QAAQ,EAAE,oBAAY;AACpB,YAAMoE,MAAM,GAAG,KAAKgE,WAAL,EAAf;AACA,YAAM+R,gBAAgB,GAAG,KAAKC,YAAL,EAAzB;;AACA,YAAIhW,MAAM,IAAI+V,gBAAd,EAAgC;AAC9B,cAAI/V,MAAM,CAAC+N,WAAP,CAAmBgI,gBAAnB,EAAqC,CAAC,CAAtC,EAAyC,KAAzC,EAAgD,OAAhD,CAAJ,EAA8D;AAC5D;AACA,iBAAKE,cAAL;AACD;AACF;AACF,OA7nDM;;AA+nDP;AACJ;AACA;AACA;AACA;AACIC,MAAAA,cAAc,EAAE,wBAAU5gB,OAAV,EAAmB;AACjC,YAAMgO,KAAK,GAAG,KAAK1O,QAAL,CAAwB2Z,OAAxB,CAAgCjZ,OAAhC,CAAd;;AACA,YAAM6gB,YAAY,GAAG,KAAKthB,QAAL,CAA+B0Z,OAA/B,CAAuCjZ,OAAvC,CAArB;;AACA,YAAIA,OAAO,CAAC8gB,SAAZ,EAAuB;AACrB;AACA,cAAI9S,KAAK,IAAI,CAAb,EAAgB;AACd,iBAAK1O,QAAL,CAAwByhB,MAAxB,CAA+B/S,KAA/B,EAAsC,CAAtC;AACD;;AACD,cAAI6S,YAAY,IAAI,CAApB,EAAuB;AACrB,iBAAKthB,QAAL,CAA+BwhB,MAA/B,CAAsC/S,KAAtC,EAA6C,CAA7C;AACD;AACF,SARD,MAQO,IAAIhO,OAAO,CAACghB,UAAR,EAAJ,EAA0B;AAC7B,cAAIhT,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChB,iBAAK1O,QAAL,CAAwBsI,IAAxB,CAA6B5H,OAA7B;AACD;;AACD,cAAI6gB,YAAY,KAAK,CAAC,CAAtB,EAAyB;AACvB,iBAAKthB,QAAL,CAA+BqI,IAA/B,CAAoC5H,OAApC;AACD;AACF,SAPI,MAOE;AACL,cAAIgO,KAAK,IAAI,CAAb,EAAgB;AACd,iBAAK1O,QAAL,CAAwByhB,MAAxB,CAA+B/S,KAA/B,EAAsC,CAAtC;AACD;;AACD,cAAI6S,YAAY,IAAI,CAApB,EAAuB;AACrB,iBAAKthB,QAAL,CAA+BwhB,MAA/B,CAAsC/S,KAAtC,EAA6C,CAA7C;AACD;AACF;;AACH,aAAKvI,OAAL,GAAewb,WAAf,CAA2B,KAAK3hB,QAAL,CAAwBsH,MAAxB,GAAiC,CAA5D;;AACA,aAAKsa,iBAAL;AACD,OAhqDM;AAkqDPvgB,MAAAA,KAAK,EAAE,iBAAY;AACjB,YAAM4K,OAAO,GAAG,KAAKrG,eAAL,CAAqB,SAArB,CAAhB;;AACA,aAAKic,mBAAL,CAAyB,WAAzB;;AACA,YAAI,CAAC,KAAK5X,eAAL,CAAqB,YAArB,CAAL,EAAyC;AACvC,eAAK4X,mBAAL,CAAyB,YAAzB;AACD;;AACD5V,QAAAA,OAAO,CAAC6V,YAAR;;AACA,aAAKD,mBAAL,CAAyB,aAAzB;;AACA,aAAKA,mBAAL,CAAyB,eAAzB;;AACA5V,QAAAA,OAAO,CAAC6V,YAAR;;AACA,aAAKD,mBAAL,CAAyB,eAAzB;;AACA5V,QAAAA,OAAO,CAAC8V,SAAR;;AACA,aAAKF,mBAAL,CAAyB,iBAAzB;;AAEA,YAAI,CAAC,KAAK5X,eAAL,CAAqB,MAArB,CAAL,EAAmC;AACjC,eAAK4X,mBAAL,CAAyB,MAAzB;AACD;;AACD,YAAI,CAAC,KAAK5X,eAAL,CAAqB,OAArB,CAAL,EAAoC;AAClC,eAAK4X,mBAAL,CAAyB,OAAzB;AACD;;AACD,YAAI,CAAC,KAAK5X,eAAL,CAAqB,mBAArB,CAAL,EAAgD;AAC9C,eAAK4X,mBAAL,CAAyB,mBAAzB;AACD;;AACD,YAAI,CAAC,KAAK5X,eAAL,CAAqB,SAArB,CAAL,EAAsC;AACpC,eAAK4X,mBAAL,CAAyB,SAAzB;AACD;AACF,OA5rDM;AA8rDPG,MAAAA,cAAc,EAAE,wBAAUrc,KAAV,EAAiBkE,GAAjB,EAAsB;AACpC,YAAIA,GAAJ,EAAS;AACPA,UAAAA,GAAG,CAAC3B,qBAAJ,CAA0B,KAAKtC,eAAL,CAAqB,eAArB,CAA1B;AACD;;AACD,YAAID,KAAJ,EAAW;AACT,eAAKC,eAAL,CAAqB,aAArB,EAAoC2B,UAApC,CAA+C5B,KAAK,CAACoZ,iBAAN,EAA/C;;AACA,cAAI,KAAK5Y,OAAL,GAAeE,WAAf,EAAJ,EAAkC;AAChCV,YAAAA,KAAK,CAACkC,IAAN,CAAW,WAAX,EAAwB,KAAKjC,eAAL,CAAqB,eAArB,CAAxB,EAA+D,SAA/D;AACD;AACF,SALD,MAKO;AACL,eAAKA,eAAL,CAAqB,aAArB,EAAoC2B,UAApC,CAA+C,KAA/C;AACA,eAAK3B,eAAL,CAAqB,eAArB,EAAsC2B,UAAtC,CAAiD,KAAjD;AACD;;AACD,aAAK0a,sBAAL;AACD,OA5sDM;AA8sDPA,MAAAA,sBAAsB,EAAE,kCAAY;AAClC,YAAMnf,QAAQ,GAAG,KAAKsM,WAAL,EAAjB;;AACA,YAAI,KAAKrE,aAAL,EAAJ,EAA0B;AACxB,cAAM3E,OAAO,GAAG,KAAKR,eAAL,CAAqB,SAArB,CAAhB;;AACA,cAAI,KAAKX,eAAL,OAA2B,kBAA3B,IAAiDnC,QAArD,EAA+D;AAC7D;AACA,gBAAI0G,IAAI,GAAG,EAAX;AACA,gBAAI0Y,IAAI,GAAGpf,QAAQ,CAACoG,OAAT,EAAX;;AACA,gBAAI,KAAKnF,UAAL,KAAoB,MAAxB,EAAgC;AAC9B,qBAAOme,IAAI,IAAIA,IAAI,CAACtC,QAAL,KAAkB,QAAjC,EAA2C;AACzC,oBAAIsC,IAAI,CAACtC,QAAL,KAAkB,SAAtB,EAAiC;AAC/BxZ,kBAAAA,OAAO,CAAC+b,QAAR,CAAiBD,IAAI,CAACnQ,YAAL,CAAkB,IAAlB,CAAjB;AACA;AACD;;AACDmQ,gBAAAA,IAAI,GAAGA,IAAI,CAACE,UAAZ;AACD;AACF,aARD,MAQO;AACL,qBAAOF,IAAI,IAAIA,IAAI,CAACtC,QAAL,KAAkB,OAAjC,EAA0C;AACxC,oBAAIsC,IAAI,CAACtC,QAAL,KAAkB,MAAtB,EAA8B;AAC5BpW,kBAAAA,IAAI,CAACkU,OAAL,CAAawE,IAAI,CAACnQ,YAAL,CAAkB,MAAlB,CAAb;AACD;;AACDmQ,gBAAAA,IAAI,GAAGA,IAAI,CAACE,UAAZ;AACD;;AACD,kBAAI5Y,IAAI,CAAClC,MAAL,GAAc,CAAlB,EAAqB;AACnBlB,gBAAAA,OAAO,CAAC+b,QAAR,CAAiB3Y,IAAI,CAACjB,GAAL,EAAjB,EAA6BiB,IAAI,CAACwU,IAAL,CAAU,GAAV,CAA7B;AACD;AACF;;AACD5X,YAAAA,OAAO,CAACic,kBAAR,CAA2Bvf,QAAQ,CAACwf,aAAT,EAA3B;AACD,WAxBD,MAwBO;AACLlc,YAAAA,OAAO,CAACic,kBAAR,CAA2B,IAA3B;AACD;AACF;AACF,OA9uDM;AAgvDPlhB,MAAAA,eAAe,EAAE,yBAASd,EAAT,EAAa;AAC5B,YAAI,KAAK+O,WAAL,MAAsB,KAAKmT,SAAL,EAA1B,EAA4C;AAC1C,cAAIliB,EAAE,CAACgN,gBAAH,OAA0B,OAA9B,EAAuC;AACrC,gBAAI,CAAC,KAAKzJ,QAAV,EAAqB;AACnB,mBAAKuI,OAAL;AACD;AACF;AACF;AACF,OAxvDM;AA0vDPqW,MAAAA,aAAa,EAAE,uBAAS7c,KAAT,EAAgB;AAAA;;AAC7B,YAAM8H,IAAI,GAAG,KAAK7H,eAAL,CAAqB,MAArB,CAAb;AACA,YAAM3B,IAAI,GAAG,KAAKkC,OAAL,EAAb;;AACA,aAAKK,cAAL,CAAoB,IAApB,EAA0B,IAA1B,EAAgC,IAAhC;;AACA,YAAIb,KAAK,IAAI1B,IAAb,EAAmB;AACjB,cAAI,KAAKN,cAAT,EAAyB;AACvB,iBAAKA,cAAL,CAAoB8e,IAApB,CAAyBxe,IAAzB,EAA+B0B,KAA/B,EAAsC,IAAtC,EAA4C;AAC1Ckb,cAAAA,QAAQ,EAAE,KADgC;AAE1C6B,cAAAA,iBAAiB,EAAE,IAFuB;AAG1CC,cAAAA,QAAQ,EAAE;AAHgC,aAA5C;;AAKA,iBAAKhf,cAAL,CAAoBif,iBAApB,CAAsCjd,KAAtC,EAA6CsV,IAA7C,CAAkD,UAAAsB,GAAG,EAAI;AACvD,kBAAIA,GAAG,KAAK,IAAZ,EAAkB;AAChB,gBAAA,OAAI,CAACzD,IAAL,CAAU7U,IAAI,CAAC4e,OAAL,KAAiB,yBAA3B;;AACA,gBAAA,OAAI,CAACC,SAAL,CAAmBnd,KAAnB;AACD,eAHD,MAGO;AACL,oBAAM4J,MAAM,GAAG,IAAInQ,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAciQ,MAAd,CAAqBiP,eAAzB,CAAyCva,IAAzC,EAA+C0B,KAA/C,EAAsD4W,GAAtD,CAAf;AACAhN,gBAAAA,MAAM,CAACnP,WAAP,CAAmB,QAAnB,EAA6B,UAAAC,EAAE,EAAI;AACjC,0BAAQA,EAAE,CAACC,OAAH,EAAR;AACE,yBAAK,SAAL;AACE,sBAAA,OAAI,CAACwiB,SAAL,CAAmBnd,KAAnB,EAA0B4W,GAA1B;;AACA;;AAEF,yBAAK,aAAL;AAAoB;AAClB,4BAAMtY,KAAI,GAAG,OAAI,CAACkC,OAAL,EAAb;;AACA/G,wBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcyjB,IAAd,CAAmBre,WAAnB,GAAiCse,SAAjC,CAA2C/e,KAA3C;AACApF,wBAAAA,EAAE,CAACmE,KAAH,CAASmX,OAAT,CAAiB8I,GAAjB,CAAqBC,cAArB,CAAoC,qBAApC,EAA2D;AACzDjf,0BAAAA,IAAI,EAAEA,KAAI,CAACkf,WAAL,EADmD;AAEzDC,0BAAAA,OAAO,EAAE,6BAFgD;AAGzDje,0BAAAA,cAAc,EAAE;AACdke,4BAAAA,WAAW,EAAE;AADC;AAHyC,yBAA3D;AAOA;AACD;;AAED,yBAAK,QAAL;AACE;AACAjkB,sBAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcyjB,IAAd,CAAmBre,WAAnB,GAAiCse,SAAjC,CAA2C,OAAI,CAAC7c,OAAL,EAA3C;AACA;AArBJ;;AAuBAoJ,kBAAAA,MAAM,CAAC+T,IAAP;AACA/T,kBAAAA,MAAM,CAACuR,OAAP;AACD,iBA1BD,EA0BG,OA1BH;AA2BAvR,gBAAAA,MAAM,CAACwL,IAAP;AACD;AACF,aAnCD;AAoCD;AACF,SA5CD,MA4CO;AACLtN,UAAAA,IAAI,CAAC8V,UAAL;;AACA,cAAI,KAAKtZ,eAAL,CAAqB,YAArB,CAAJ,EAAwC;AACtC,iBAAKrE,eAAL,CAAqB,YAArB,EAAmC2B,UAAnC,CAA8C,KAA9C;AACD;AACF;AACF,OAhzDM;AAkzDPhB,MAAAA,QAAgB,EAAE,oBAAY;AAC5B,YAAItC,IAAJ;AACA7E,QAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBgf,QAApB,CAA6BC,IAA7B,CAAkC1N,WAAlC,GAAgDtV,IAAhD,CAAqD,UAAAijB,CAAC,EAAI;AACxD,cAAIA,CAAC,CAACjO,OAAF,OAAgB,6BAApB,EAAmD;AACjDxR,YAAAA,IAAI,GAAGyf,CAAP;AACA,mBAAO,IAAP;AACD;;AACD,iBAAO,KAAP;AACD,SAND;;AAOA,YAAI,CAACzf,IAAL,EAAW;AACTA,UAAAA,IAAI,GAAG,IAAI7E,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBgf,QAAxB,CAAiC,6BAAjC,EAAgE,GAAhE,EAAqE,KAAKrd,OAAL,GAAewO,SAAf,EAArE,CAAP;AACA1Q,UAAAA,IAAI,CAAC0f,YAAL,CAAkB,IAAlB;AACD;;AACD,eAAO1f,IAAP;AACD,OAh0DM;AAk0DP6e,MAAAA,SAAa;AAAA,6EAAE,kBAAgBnd,KAAhB,EAAuBie,MAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACPnW,kBAAAA,IADO,GACA,KAAK7H,eAAL,CAAqB,MAArB,CADA;AAEP3B,kBAAAA,IAFO,GAEA,KAAKkC,OAAL,EAFA;;AAAA,uBAGTlC,IAHS;AAAA;AAAA;AAAA;;AAIL4f,kBAAAA,GAJK,GAIChlB,EAAE,CAACilB,GAAH,CAAOC,QAAP,CAAgBC,UAAhB,CAA2Bre,KAA3B,CAJD;AAKLse,kBAAAA,WALK,GAKSJ,GAAG,CAACK,eALb;AAAA;AAAA,yBAMU,KAAKlgB,SAAL,CAAeigB,WAAW,CAACE,cAAZ,CAA2B,2CAA3B,EAAwE,2BAAxE,CAAf,CANV;;AAAA;AAMLtI,kBAAAA,MANK;AAOLL,kBAAAA,aAPK,GAOWK,MAAM,CAACuI,cAAP,CAAsBH,WAAW,CAACrE,QAAlC,CAPX;AAQLvO,kBAAAA,QARK,GAQM,IAAIjS,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoB6X,UAAxB,CAAmC4H,WAAnC,EAAgDzI,aAAhD,EAA+D,IAA/D,CARN;AASX,uBAAKzX,UAAL,GAAkB8X,MAAM,CAACwI,YAAP,EAAlB;AACAhT,kBAAAA,QAAQ,CAACiT,WAAT,CAAqBrgB,IAAI,CAACsgB,YAAL,EAArB;AACAlT,kBAAAA,QAAQ,CAACiB,IAAT;AACA7E,kBAAAA,IAAI,CAAC+W,QAAL,CAAcnT,QAAd;;AACA,sBAAI,KAAKpH,eAAL,CAAqB,YAArB,CAAJ,EAAwC;AACtC,yBAAKrE,eAAL,CAAqB,YAArB,EAAmCC,aAAnC,CAAiD5B,IAAI,CAACsgB,YAAL,KAAsB,SAAtB,GAAkC,UAAnF,EADsC,CAEtC;;AACA9W,oBAAAA,IAAI,CAACgX,uBAAL,CAA6BxgB,IAAI,CAACsgB,YAAL,KAAsB,EAAtB,GAA2B,CAAxD;AACD;;AACD,sBAAI,KAAKxZ,aAAL,EAAJ,EAA0B;AAClB3E,oBAAAA,OADkB,GACR,KAAKR,eAAL,CAAqB,SAArB,CADQ;;AAExB,wBAAI3B,IAAI,CAACoC,WAAL,EAAJ,EAAwB;AACtB,0BAAI,CAACD,OAAO,CAACD,OAAR,EAAL,EAAwB;AACtBC,wBAAAA,OAAO,CAACE,OAAR,CAAgB,KAAKC,QAAL,EAAhB;AACD;AACF,qBAJD,MAIO;AACLH,sBAAAA,OAAO,CAACE,OAAR,CAAgBrC,IAAhB;AACD;;AACD,yBAAKuC,cAAL,CAAoB,IAApB,EAA0Bb,KAA1B;;AACA,wBAAI,CAACS,OAAO,CAACmc,SAAR,EAAL,EAA0B;AACxBnc,sBAAAA,OAAO,CAAC2U,IAAR;AACD;AACF;;AACD,sBAAI9W,IAAI,CAACygB,WAAL,EAAJ,EAAwB;AACtB,yBAAK9C,iBAAL;AACD;;AACD,sBAAIgC,MAAJ,EAAY;AACVA,oBAAAA,MAAM,CAACjb,OAAP,CAAe,UAAAH,KAAK,EAAI;AACtB,0BAAIA,KAAK,CAACgB,IAAN,IAAchB,KAAK,CAACgB,IAAN,CAAWtF,UAAX,CAAsB,QAAtB,CAAlB,EAAmD;AACjD,4BAAIiO,OAAO,GAAGd,QAAd;AACA,4BAAIsT,KAAK,GAAGnc,KAAK,CAACgB,IAAN,CAAWob,MAAX,CAAkB,CAAlB,EAAqB9H,KAArB,CAA2B,GAA3B,CAAZ;;AACA,+BAAO6H,KAAK,CAACrd,MAAN,GAAe,CAAtB,EAAyB;AACvB,8BAAIud,IAAI,GAAGF,KAAK,CAACG,KAAN,EAAX;AACA,8BAAIC,KAAK,GAAG,qBAAqBC,IAArB,CAA0BH,IAA1B,CAAZ;;AACA,8BAAIE,KAAJ,EAAW;AACT5S,4BAAAA,OAAO,GAAGA,OAAO,CAAC4D,WAAR,GAAsBtO,OAAtB,CAA8BuV,QAAQ,CAAC+H,KAAK,CAAC,CAAD,CAAN,CAAtC,CAAV;;AACA,gCAAI5S,OAAJ,EAAa;AACX,kCAAI;AACF;AACAA,gCAAAA,OAAO,CAACG,IAAR;AACD,+BAHD,CAGE,OAAOlJ,CAAP,EAAU;AACV,gCAAA,OAAI,CAACZ,KAAL,CAAW,mBAAmB2J,OAAO,CAACsD,OAAR,EAAnB,GAAuC,IAAvC,GAA8CrM,CAAC,CAAC6b,QAAF,EAAzD;;AACA9S,gCAAAA,OAAO,GAAG,IAAV;AACA;AACD;AACF,6BATD,MASO;AACL;AACD;AACF,2BAdD,MAcO;AACL,4BAAA,OAAI,CAAC3J,KAAL,CAAW,iCAAiCqc,IAA5C;;AACA1S,4BAAAA,OAAO,GAAG,IAAV;AACA;AACD;AACF;;AACD,4BAAIA,OAAJ,EAAa;AACXA,0BAAAA,OAAO,CAAC+S,QAAR,CAAiB,KAAjB;AACA/S,0BAAAA,OAAO,CAAC0O,QAAR,CAAiB,KAAjB;AACApT,0BAAAA,IAAI,CAACyE,kBAAL,CAAwBC,OAAxB;AACD;AACF;AACF,qBAjCD;AAkCD;;AAtEU;AAAA;;AAAA;AAwEX,uBAAKpO,UAAL,GAAkB,IAAlB;;AAxEW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SAl0DN;AA84DP6d,MAAAA,iBAAiB,EAAE,6BAAY;AAC7B,YAAMuD,OAAO,GAAG,KAAKC,iBAAL,EAAhB;;AACA,YAAI,KAAKzhB,cAAT,EAAyB;AACvB,eAAKA,cAAL,CAAoB0hB,cAApB,CAAmC,KAAKlf,OAAL,EAAnC,EAAmDgf,OAAnD;AACD;;AACD,YAAI,KAAKG,oBAAL,MAA+B,KAAKva,aAAL,EAAnC,EAAyD;AACvD,eAAKvE,cAAL,CAAoB,IAApB,EAA0B2e,OAA1B;AACD;AACF,OAt5DM;AAw5DP3e,MAAAA,cAAc,EAAE,wBAAUnG,EAAV,EAAc8kB,OAAd,EAAuBI,KAAvB,EAA8B;AAAA;;AAC5C,YAAMC,WAAW,GAAG,KAAK5f,eAAL,CAAqB,SAArB,EAAgCO,OAAhC,EAApB;;AACA,YAAIqf,WAAJ,EAAiB;AACf,cAAI,CAACL,OAAD,IAAY,CAACI,KAAjB,EAAwB;AACtBJ,YAAAA,OAAO,GAAG,KAAKC,iBAAL,CAAuB,IAAvB,CAAV;AACD,WAFD,MAEO,IAAIG,KAAK,KAAK,IAAd,EAAoB;AACzB,iBAAK3f,eAAL,CAAqB,SAArB,EAAgC0d,IAAhC;AACA;AACD;;AACD,eAAK1d,eAAL,CAAqB,SAArB,EAAgCmV,IAAhC;;AACA,cAAIyK,WAAW,CAACd,WAAZ,EAAJ,EAA+B;AAC7B,iBAAKe,OAAL,CAAaC,UAAb,CAAwB;AACtBlc,cAAAA,IAAI,EAAEgc,WAAW,CAACrC,WAAZ,EADgB;AAEtB7Y,cAAAA,IAAI,EAAE;AAFgB,aAAxB,EAGG6a,OAHH,EAGY,YAAM;AAChBtmB,cAAAA,EAAE,CAACmE,KAAH,CAASmX,OAAT,CAAiB8I,GAAjB,CAAqBC,cAArB,CAAoCsC,WAAW,CAACG,WAAZ,EAApC,EAA+D;AAC7DtL,gBAAAA,IAAI,EAAE,gBADuD;AAE7DpW,gBAAAA,IAAI,EAAEuhB,WAFuD;AAG7DtlB,gBAAAA,IAAI,EAAEilB,OAHuD;AAI7DS,gBAAAA,MAAM,EAAE;AAJqD,eAA/D;;AAMA,cAAA,OAAI,CAAC3lB,QAAL,CAA+ByI,SAA/B;;AACA,cAAA,OAAI,CAACyB,iBAAL;;AACAqb,cAAAA,WAAW,CAACK,cAAZ;AACD,aAbD,EAaG,IAbH;AAcD,WAfD,MAeO;AACL,iBAAKJ,OAAL,CAAaK,UAAb,CAAwB;AACtBtc,cAAAA,IAAI,EAAEgc,WAAW,CAACrC,WAAZ,EADgB;AAEtB7Y,cAAAA,IAAI,EAAE;AAFgB,aAAxB,EAGG6a,OAHH,EAGY,YAAM;AAChBtmB,cAAAA,EAAE,CAACmE,KAAH,CAASmX,OAAT,CAAiB8I,GAAjB,CAAqBC,cAArB,CAAoCsC,WAAW,CAACG,WAAZ,EAApC,EAA+D;AAC7DtL,gBAAAA,IAAI,EAAE,gBADuD;AAE7DpW,gBAAAA,IAAI,EAAEuhB,WAFuD;AAG7DtlB,gBAAAA,IAAI,EAAEilB,OAHuD;AAI7DS,gBAAAA,MAAM,EAAE;AAJqD,eAA/D;;AAMA,cAAA,OAAI,CAAC3lB,QAAL,CAA+ByI,SAA/B;;AACA,cAAA,OAAI,CAACyB,iBAAL;AACD,aAZD,EAYG,IAZH;AAaD;AACF;AACF,OAj8DM;AAm8DPib,MAAAA,iBAAiB,EAAE,2BAAUW,IAAV,EAAgB;AACjC,YAAMtY,IAAI,GAAG,KAAK7H,eAAL,CAAqB,MAArB,CAAb;;AACA,YAAI6H,IAAI,CAAC8C,QAAL,EAAJ,EAAqB;AACnB,cAAMc,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;;AACA,cAAI6c,IAAJ,EAAU;AACR,mBAAO,IAAIC,aAAJ,GAAoBC,iBAApB,CAAsC5U,QAAQ,CAAC6J,aAA/C,CAAP;AACD,WAJkB,CAKnB;;;AACA,iBAAO9b,EAAE,CAAC6N,IAAH,CAAQiZ,UAAR,CAAmBpC,GAAnB,CAAuBzS,QAAQ,CAAC6J,aAAhC,CAAP;AACD;;AACC,eAAO,IAAP;AACH,OA98DM;AAg9DPiL,MAAAA,QAAQ,EAAE,oBAAY;AACpB;;AACA,aAAKnmB,QAAL,CAAwB2I,OAAxB,CAAgC,UAAAC,IAAI;AAAA,iBAAIA,IAAI,CAACwd,OAAL,EAAJ;AAAA,SAApC;;AACA,aAAKpmB,QAAL,GAA0B,EAA1B;AACA,aAAKyI,eAAL;AACD,OAr9DM;AAu9DPuB,MAAAA,WAAW,EAAE,qBAAU/F,IAAV,EAAgB;AAC3B,eAAO7E,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0B5R,eAA1B,CAA0Cwb,IAA1C,CAA+C9Y,IAAI,CAACwR,OAAL,EAA/C,CAAP;AACD,OAz9DM;AA29DPxO,MAAAA,SAAS,EAAE,qBAAY;AACrB,YAAMof,aAAa,GAAGxnB,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAWulB,YAAX,CAAwB5hB,WAAxB,GAAsC6hB,gBAAtC,EAAtB;AACA,YAAMC,UAAU,GAAG;AACjB1H,UAAAA,OAAO,EAAE,KAAKnd,EAAL,CAAQ,MAAR,CADQ;AAEjB8kB,UAAAA,KAAK,EAAE,IAFU;AAGjBC,UAAAA,KAAK,EAAE,sBAHU;AAIjBrb,UAAAA,QAAQ,EAAEgJ,IAAI,CAAC4I,GAAL,CAAS,GAAT,EAAcpe,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAd,CAJO;AAKjBmhB,UAAAA,SAAS,EAAE9nB,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBqhB,SAAhB,EALM;AAMjBzM,UAAAA,OAAO,EAAE;AANQ,SAAnB;;AAQA,YAAIkM,aAAa,KAAK,KAAKzgB,eAAL,CAAqB,WAArB,CAAtB,EAAyD;AACvD4gB,UAAAA,UAAU,CAACrM,OAAX,GAAqB,KAAKxY,EAAL,CAAQ;AACrC;AACA;AACA;AACA;AACA;AACA,yBAN6B,CAArB;AAOD,SARD,MAQO;AACL;AACA6kB,UAAAA,UAAU,CAACrM,OAAX,GAAqB,KAAKxY,EAAL,CAAQ;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4HAnB6B,CAArB;AAoBD;;AACD,YAAIvC,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAciQ,MAAd,CAAqBsX,QAAzB,CAAkCL,UAAlC,EAA8CzL,IAA9C;AACD;AArgEM,KAtIkC;;AA8oE3C;AACF;AACA;AACA;AACA;AACE+L,IAAAA,QAAQ,EAAE,oBAAY;AACpB,WAAK/mB,QAAL,GAAgB,IAAhB;AACA,WAAK4D,cAAL,GAAsB,IAAtB;;AACA,WAAKojB,aAAL,CAAmB,UAAnB,EAAyC,UAAzC;;AACAloB,MAAAA,EAAE,CAACkC,IAAH,CAAQC,IAAR,CAAaC,cAAb,GAA8BC,OAA9B,GAAwC8lB,cAAxC,CAAuD,OAAvD,EAAgE,KAAK7lB,eAArE,EAAsF,IAAtF;AACD;AAxpE0C,GAA7C;AAvBA/B,EAAAA,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqB4T,IAArB,CAA0BnU,aAA1B,GAA0CA,aAA1C",
  "sourcesContent": [
    "/* Tree.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n    this._initWorker();\n\n    // init schema\n    this._schemas = {};\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', ev => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    }, this);\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener('keyup', this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n    this._draw();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schemas: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n    _structure: null,\n\n    async getSchema(file) {\n      if (file.startsWith('../')) {\n        file = file.substring(3);\n      }\n      if (!Object.prototype.hasOwnProperty.call(this, file)) {\n        this._schemas[file] = cv.ui.manager.model.Schema.getInstance(file);\n      }\n      return new Promise((resolve, reject) => {\n        this._schemas[file].onLoaded(function () {\n          this.setReady(true);\n          resolve(this._schemas[file]);\n        }, this);\n      });\n    },\n\n    isPreviewSynced: function () {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions: function () {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility: function () {\n      const handlerOptions = this.getHandlerOptions();\n      this.setShowPreview(qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview));\n    },\n\n    _applyShowPreview: function (value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({flex: 1});\n        }\n      }\n      const file = this.getFile();\n      if (value && file) {\n        const preview = this.getChildControl('preview');\n        if (file.isWriteable()) {\n          if (!preview.getFile()) {\n            preview.setFile(this.__getPreviewFile());\n          }\n        } else {\n          // this file is not writable, we can use the real one for preview\n          preview.setFile(file);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'undo':\n            if (!this.__editing) {\n              this.undo();\n            }\n            break;\n\n          case 'redo':\n            if (!this.__editing) {\n              this.redo();\n            }\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            if (!this.__editing) {\n              this._showHelp();\n            }\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getUnDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getReDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return value ? !value.isDeletable() : false;\n            }\n          });\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n      }\n    },\n    unConfigureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo: function (elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo: function () {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error('could not undo ' + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo: function () {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error('could not redo ' + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos: function () {\n      this.getUnDos().removeAll().forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos: function () {\n      this.getReDos().removeAll().forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard: function (value) {\n      try {\n        if (value) {\n          navigator.clipboard.writeText(value.getNode().outerHTML);\n        } else {\n          navigator.clipboard.writeText('');\n        }\n      } catch (e) {\n        // clipboard api is only available in secure environment, otherwise we have to do it ourself\n        cv.ui.manager.editor.AbstractEditor.CLIPBOARD = value ? value.getNode().outerHTML : '';\n      }\n    },\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors: function (path, errorList) {\n    },\n    showDecorations: function (path, decorators) {\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        this.base(arguments, file, old);\n      } else {\n        this.base(arguments, null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'splitpane':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this._add(control);\n           break;\n\n         case 'left':\n           control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n           this.getChildControl('splitpane').addAt(control, 0);\n           break;\n\n         case 'right':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n           if (!this.isShowPreview()) {\n             control.exclude();\n           }\n           this.getChildControl('splitpane').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview':\n           control = new cv.ui.manager.viewer.Config();\n           control.set({\n             target: 'iframe',\n             minWidth: 600\n           });\n           this.getChildControl('right').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview-sync-hint': {\n           const ok = this.tr('Preview shows the current state of the edited configuration.');\n           const noSync = this.tr('Preview is out of sync. Click here to refresh.');\n           const notOk = this.tr('Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.');\n           control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n           control.setRich(true);\n           control.getChildControl('label').setWrap(true);\n           control.addListener('tap', () => {\n             if (!this.isPreviewSynced() && this.isShowPreview()) {\n               this._updatePreview();\n             }\n           }, this);\n           this.getChildControl('right').addAt(control, 0);\n           this.addListener('previewStateChanged', ev => {\n             switch (ev.getData()) {\n               case 'synced':\n                 control.set({\n                   label: ok,\n                   icon: cv.theme.dark.Images.getIcon('valid', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n\n               case 'changed':\n                 control.set({\n                   label: noSync,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').addState('warning');\n                 break;\n\n               case 'structureChanged':\n                 control.set({\n                   label: notOk,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').addState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n             }\n           }, this);\n           break;\n         }\n\n         case 'edit-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n           control.setEnabled(false);\n           control.addListener('execute', this._onEdit, this);\n           this.bind('file.writeable', control, 'icon', {\n             converter: function (value) {\n               return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16);\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n           control.setEnabled(false);\n           control.addListener('execute', this._onDelete, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toggle-expert':\n           control = new qx.ui.toolbar.CheckBox(this.tr('Expertview'),\n             cv.theme.dark.Images.getIcon('expert', 16));\n           control.addListener('execute', function () {\n             this.toggleExpert();\n           }, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'refresh-preview':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n           control.setToolTipText(this.tr('Reload preview'));\n           control.addListener('execute', this._updatePreview, this);\n           this.bind('showPreview', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'hidden';\n             }\n           });\n           this.bind('previewState', control, 'enabled', {\n             converter: function (value) {\n               return value !== 'synced';\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toolbar':\n           control = new qx.ui.toolbar.ToolBar();\n           this.getChildControl('left').add(control, {\n             top: 0,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar-container':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this.getChildControl('left').add(control, {\n             top: 36,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             placeholder: this.tr('Search...'),\n             margin: 8\n           });\n           control.addListener('changeValue', qx.util.Function.debounce(this._onSearch, 250), this);\n           control.addListener('keyup', function (ev) {\n             switch (ev.getKeyIdentifier()) {\n               case 'Enter':\n               case 'Down':\n                 this._showNextResult();\n                 break;\n               case 'Up':\n                 this._showPreviousResult();\n                 break;\n             }\n             ev.stopPropagation();\n           }, this);\n           this.getChildControl('searchbar-container').add(control, {flex: 1});\n           break;\n\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n           control.set({\n             selectionMode: 'single',\n             width: 350,\n             openMode: 'none',\n             itemHeight: qx.core.Environment.get('device.touch') ? 40 : 20\n           });\n           this.bind('file.writeable', control, 'droppable');\n           this.bind('file.writeable', control, 'draggable');\n           this._initDragDrop(control);\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualElementItem();\n               if (!qx.core.Environment.get('device.touch')) {\n                 item.addListener('contextmenu', this._onContextMenu, this);\n               } else {\n                 item.addListener('action', this._onContextMenuAction, this);\n               }\n               item.addListener('dbltap', this._onEdit, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindProperty('displayName', 'label', null, item, index);\n               controller.bindProperty('name', 'name', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('showEditButton', 'editable', null, item, index);\n               controller.bindProperty('sortable', 'sortable', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('status', 'status', null, item, index);\n               controller.bindProperty('invalidMessage', 'toolTipText', null, item, index);\n               controller.bindProperty('dragging', 'dragging', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this.getChildControl('left').add(control, {\n             top: 72,\n             left: 0,\n             right: 0,\n             bottom: 0\n           });\n           break;\n\n         case 'add-button':\n           control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n           control.setDraggable(true);\n           control.setMarginLeft(-16);\n           control.setZIndex(20);\n           this.addListener('changeDragging', ev => {\n             control.setLayoutProperties({\n               bottom: 16,\n               left: ev.getData() ? -1000 : '50%'\n             });\n           }, this);\n           control.setAppearance('round-button');\n           control.addListener('pointerover', () => control.addState('hovered'));\n           control.addListener('pointerout', () => control.removeState('hovered'));\n           control.addListener('tap', () => {\n             if (this.getSelected()) {\n               this._onCreate(this.getSelected(), 'inside');\n             } else {\n               qxl.dialog.Dialog.alert(this.tr('Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.'));\n             }\n           }, this);\n           this.getChildControl('left').add(control, {\n             bottom: 16,\n             left: '50%'\n           });\n           break;\n\n         case 'drag-indicator':\n           // Create drag indicator\n           control = new qx.ui.core.Widget();\n           control.setDecorator(new qx.ui.decoration.Decorator().set({\n             widthTop: 1,\n             styleTop: 'solid',\n             colorTop: 'white'\n           }));\n           control.setHeight(0);\n           control.setOpacity(0.5);\n           control.setZIndex(100);\n           control.setDroppable(true);\n           control.setLayoutProperties({left: -1000, top: -1000});\n           qx.core.Init.getApplication().getRoot().add(control);\n           break;\n\n         case 'context-menu':\n           control = new cv.ui.manager.contextmenu.ConfigElement(this);\n           control.addListener('action', this._onContextMenuAction, this);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    _onContextMenu: function (ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction: function (ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, 'inside');\n            break;\n\n          default:\n            this.error('unhandled context menu action', data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n\n    openByQuerySelector: function (selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch: function (ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || el.hasAttribute('name') && el.getAttribute('name').startsWith(value);\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult: function () {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult: function () {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult: function () {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length-1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop: function (control) {\n      let draggedXmlElement;\n      control.addListener('dragstart', function (ev) {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction('copy');\n          if (element.isDeletable()) {\n            ev.addAction('move');\n          }\n          ev.addType('cv/tree-element');\n          ev.addData('cv/tree-element', element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      }, this);\n\n      const addButton = this.getChildControl('add-button');\n      addButton.addListener('dragstart', function (ev) {\n        ev.addAction('copy');\n        ev.addType('cv/new-tree-element');\n        this.setDragging(true);\n      }, this);\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      };\n\n      control.addListener('dragover', function (ev) {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType('cv/tree-element')) {\n          element = ev.getData('cv/tree-element');\n        }\n        const addNew = action === 'copy' && !element && ev.supportsType('cv/new-tree-element');\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug('dragging over indicator');\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug('dropping on same element forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug('moving inside own subtree forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && (ev.getDocumentTop() - layerContent.bottom <= 20)) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(Math.round((layerContent.left + layerContent.right) / 2), layerContent.bottom - 20);\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug('drop target not found');\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug('drop not allowed here, no drag element');\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n                    if ((acc & Allowed.BEFORE) && (acc & Allowed.AFTER)) {\n                      // we cannot find more\n                      return true;\n                    }\n                    return false;\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug('no children allowed here');\n            }\n          } else if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n              // not allowed on this level\n              accepted.mode = Allowed.NONE;\n              this.debug('not allowed as child element of', parent.getName());\n            } else if (parentSchemaElement.areChildrenSortable()) {\n              // children can be put anywhere\n              // so this is allowed anywhere\n              accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n            } else {\n              // check position\n              accepted.mode = this.__getAllowedPositions(parentSchemaElement.getAllowedElementsSorting(), element.getName(), model.getName());\n            }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug('dropping not accepted here');\n        }\n      }, this);\n\n      const indicator = this.getChildControl('drag-indicator');\n\n      let expandTimer;\n\n      control.addListener('dragleave', function (ev) {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      }, this);\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = '';\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = 'after';\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if ((ev.getDocumentTop() - origCoords.top) <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = 'before';\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = 'inside';\n              }\n            } else if ((origCoords.bottom - ev.getDocumentTop()) <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = 'after';\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = 'inside';\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                // eslint-disable-next-line no-lonely-if\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                } else {\n                  this.debug('not allowed as first child');\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              // eslint-disable-next-line no-lonely-if\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData('position') !== 'first-child') {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = 'inside';\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(function () {\n                    if (accepted.target) {\n                      control.openNode(accepted.target);\n                    }\n                  }, this, 1000);\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData('position', position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData('action', ev.getCurrentAction());\n          cursor.resetAction();\n          // eslint-disable-next-line no-console\n          console.assert(left < 0);\n          // eslint-disable-next-line no-console\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData('action')) {\n          cursor.setAction(indicator.getUserData('action'));\n          indicator.setUserData('action', null);\n        }\n      };\n      control.addListener('drag', onDrag, this);\n      addButton.addListener('drag', onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction();\n        let element = ev.supportsType('cv/tree-element') ? ev.getData('cv/tree-element') : null;\n        if (action === 'copy') {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = 'add';\n          }\n        }\n        const elementName = element ? element.getDisplayName() : 'new';\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData('position')) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, 'after', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, 'before', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as first child');\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName() + ' as first child');\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as child');\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName(), 'as child');\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener('drop', onDrop, this);\n      indicator.addListener('drop', onDrop, this);\n\n      const onDragEnd = function(ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener('dragend', onDragEnd, this);\n      addButton.addListener('dragend', onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate: function (target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex-1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(name => Object.prototype.hasOwnProperty.call(sorting, name) && sorting[name] <= maxPosition && sorting[name] >= minPosition);\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm;\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr('<p style=\\'font-weight:bold\\'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>'),\n            formData: {\n              type: {\n                type: 'SelectBox',\n                label: this.tr('Choose element'),\n                help: this.tr('Please choose the element you want to add here.'),\n                options: addable.sort((a, b) => {\n                  if (a.startsWith('#') && !b.startsWith('#')) {\n                    return 1;\n                  } else if (!a.startsWith('#') && b.startsWith('#')) {\n                    return -1;\n                  }\n                  return a.localeCompare(b);\n                }).map(name => ({label: name, value: name})),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          }).show().promise();\n        } else {\n          typeChooserForm = Promise.resolve({type: addable[0]});\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment('');\n                break;\n\n              case '#text':\n                element = document.createTextNode('');\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection('');\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode('-');\n                element.appendChild(child);\n              }\n            };\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement, true);\n            }\n            res.then(data => {\n              if (data) {\n                // finally insert the new node\n                switch (position) {\n                  case 'before':\n                    xmlElement.insertBefore(target);\n                    break;\n\n                  case 'after':\n                    xmlElement.insertAfter(target);\n                    break;\n\n                  case 'inside':\n                    target.insertChild(xmlElement, -1, false, 'added');\n                    break;\n\n                  case 'first-child':\n                    target.insertChild(xmlElement, 0, false, 'added');\n                    break;\n                }\n                this.getChildControl('tree').openNodeAndParents(xmlElement);\n                this.getChildControl('tree').setSelection([xmlElement]);\n              }\n            }, this).catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions: function (allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === 'string') {\n          currentPosition = currentPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === 'string') {\n          targetPosition = targetPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length);\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n      }\n      return cv.ui.manager.editor.Tree.Allowed.NONE;\n    },\n\n    __checkProvider: function (id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error('misconfigured provider found for ' + id);\n        }\n        formData.type = provider.userInputAllowed ? 'VirtualComboBox' : 'VirtualSelectBox';\n      } else if (['mapping', 'styling'].includes(id.split('@').pop())) {\n        const type = id.split('@').pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = 'SelectBox';\n        formData.options = [];\n        const selector = this._structure === 'tile' ? 'cv-meta > cv-' + type : 'meta > ' + type + 's > ' + type;\n        rootNode.querySelectorAll(selector).forEach(element => {\n          const name = element.getAttribute('name');\n          formData.options.push({label: name, value: name});\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options.then(res => {\n              if (Array.isArray(res)) {\n                res.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n              }\n            }).catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition: function (element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: 'TextField',\n        label: attribute.getName(),\n        placeholder: ' - ' + this.tr('not set') + ' - ',\n        help: docs.join('<br/>'),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator: function (value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n            }\n          }\n        }\n      };\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = 'CheckBox';\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string': {\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = 'SelectBox';\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({label: name, value: name});\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + '@' + attribute.getName(), def, element.getNode());\n          }\n          break;\n        }\n      }\n      return def;\n    },\n\n    _onEdit: function (ev, element, isNew) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return null;\n      }\n      let title;\n      let caption;\n      if (!element) {\n        if (this.getSelected()) {\n          element = this.getSelected();\n        } else {\n          return null;\n        }\n      }\n      if (!element.getShowEditButton()) {\n        return null;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (isNew) {\n        title = this.tr('Create new %1 element', element.getName());\n        caption = this.tr('Please edit the attributes of the new %1 element, that will be added to the chosen position.', element.getName());\n      } else {\n        title = this.tr('Edit element attributes');\n        caption = element.isEditable() ? this.tr('Edit %1', element.getName()) : this.tr('Show %1', element.getName());\n      }\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n        if (typeElement.isChildElementAllowed('*')) {\n          const parser = new DOMParser();\n          const attrName = element.getNode().nodeName === 'custom' ? '#innerHTML' : '#outerHTML';\n          if (isNew) {\n            title = this.tr('Create new %1 element', element.getName());\n            caption = this.tr('Please edit the content of the new %1 element, that will be added to the chosen position.', element.getName());\n          } else {\n            title = attrName === '#outerHTML' ? this.tr('Edit element and content') : this.tr('Edit element content');\n          }\n          formData[attrName] = {\n            type: 'TextArea',\n            label: '',\n            lines: 5,\n            autoSize: true,\n            width: Math.min(qx.bom.Viewport.getWidth(), 500),\n            enabled: element.isEditable(),\n            value: attrName === '#outerHTML' ? element.getNode().outerHTML : element.getNode().innerHTML,\n            validation: {\n              validator: function (value) {\n                if (value) {\n                  const dom = parser.parseFromString(value, 'text/xml');\n                  if (dom.getElementsByTagName('parsererror').length > 0) {\n                    throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n                  }\n                }\n              }\n            }\n          };\n        }\n      } else if (element.getNode().nodeType === Node.TEXT_NODE || element.getNode().nodeType === Node.COMMENT_NODE || element.getNode().nodeType === Node.CDATA_SECTION_NODE) {\n        title = this.tr('Edit text content', element.getName());\n        caption = '';\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: 'TextArea',\n          label: '',\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr('not set'),\n          help: docs.join('<br/>'),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator: function (value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n              }\n            }\n          }\n        };\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute('type');\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(element.getParent().getName() + '@' + element.getName(), formData[nodeName], element.getNode());\n      }\n      this.__editing = true;\n\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption:  title,\n        message: caption,\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          if (!Object.prototype.hasOwnProperty.call(data, '#outerHTML') && !Object.prototype.hasOwnProperty.call(data, '#innerHTML')) {\n            element.validate();\n          }\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete: function (ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n      return null;\n    },\n\n    _onCut: function () {\n      if (this.__editing) {\n        document.execCommand('cut');\n      } else {\n        const element = this._onDelete();\n        if (element) {\n          this.setClipboard(element);\n        }\n      }\n    },\n\n    _onCopy: function () {\n      if (this.__editing) {\n        document.execCommand('copy');\n      } else {\n        const element = this.getSelected();\n        if (element) {\n          const copy = element.clone();\n          this.setClipboard(copy);\n        }\n      }\n    },\n\n    _onPaste: function () {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified: function (element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else if (element.isModified()) {\n          if (index === -1) {\n            this.__modifiedElements.push(element);\n          }\n          if (previewIndex === -1) {\n            this.__modifiedPreviewElements.push(element);\n          }\n        } else {\n          if (index >= 0) {\n            this.__modifiedElements.splice(index, 1);\n          }\n          if (previewIndex >= 0) {\n            this.__modifiedPreviewElements.splice(index, 1);\n          }\n        }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw: function () {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget: function () {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          if (this._structure === 'tile') {\n            while (node && node.nodeName !== 'config') {\n              if (node.nodeName === 'cv-page') {\n                preview.openPage(node.getAttribute('id'));\n                break;\n              }\n              node = node.parentNode;\n            }\n          } else {\n            while (node && node.nodeName !== 'pages') {\n              if (node.nodeName === 'page') {\n                path.unshift(node.getAttribute('name'));\n              }\n              node = node.parentNode;\n            }\n            if (path.length > 0) {\n              preview.openPage(path.pop(), path.join('/'));\n            }\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp: function(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === 'Enter') {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent: function(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + ' is a valid config file');\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n              dialog.addListener('action', ev => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source': {\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: 'cv.ui.manager.editor.Source',\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n                    break;\n                  }\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n                dialog.hide();\n                dialog.destroy();\n              }, this);\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __getPreviewFile: function () {\n      let file;\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(f => {\n        if (f.getName() === 'visu_config_previewtemp.xml') {\n          file = f;\n          return true;\n        }\n        return false;\n      });\n      if (!file) {\n        file = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', this.getFile().getParent());\n        file.setTemporary(true);\n      }\n      return file;\n    },\n\n    __loadContent: async function (value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const doc = qx.xml.Document.fromString(value);\n        const rootElement = doc.documentElement;\n        const schema = await this.getSchema(rootElement.getAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'noNamespaceSchemaLocation'));\n        const schemaElement = schema.getElementNode(rootElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(rootElement, schemaElement, this);\n        this._structure = schema.getStructure();\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n          // extra space fr add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (file.isWriteable()) {\n            if (!preview.getFile()) {\n              preview.setFile(this.__getPreviewFile());\n            }\n          } else {\n            preview.setFile(file);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split('/');\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error('Error loading ' + current.getName() + ': ' + e.toString());\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error('patch segment format error: ' + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      } else {\n        this._structure = null;\n      }\n    },\n\n    _onContentChanged: function () {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview: function (ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        if (previewFile.isTemporary()) {\n          this._client.createSync({\n            path: previewFile.getFullPath(),\n            hash: 'ignore'\n          }, content, () => {\n            qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n              type: 'contentChanged',\n              file: previewFile,\n              data: content,\n              source: this\n            });\n            this.__modifiedPreviewElements.removeAll();\n            this.resetPreviewState();\n            previewFile.resetTemporary();\n          }, this);\n        } else {\n          this._client.updateSync({\n            path: previewFile.getFullPath(),\n            hash: 'ignore'\n          }, content, () => {\n            qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n              type: 'contentChanged',\n              file: previewFile,\n              data: content,\n              source: this\n            });\n            this.__modifiedPreviewElements.removeAll();\n            this.resetPreviewState();\n          }, this);\n        }\n      }\n    },\n\n    getCurrentContent: function (fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        } \n        // prettify content\n        return cv.util.Prettifier.xml(rootNode.ownerDocument);\n      } \n        return null;\n    },\n\n    _onSaved: function () {\n      this.base(arguments);\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported: function (file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp: function () {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr('Help'),\n        modal: true,\n        image: 'qxl.dialog.icon.info',\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: ''\n      };\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr('<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with \\'Enter\\' or the \\'Down\\' key. Accordingly you can jump the the previous found element \\\nwith the \\'Up\\' key.</p>');\n      } else {\n        // show general help\n        dialogConf.message = this.tr('<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the \\'edit\\'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the \\'edit\\'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the \\'add child\\'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the \\'Expertview\\'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>');\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._schemas = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener('keyup', this._onElementKeyUp, this);\n  }\n});\n"
  ]
}