{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "editor",
    "AbstractEditor",
    "construct",
    "_setLayout",
    "layout",
    "Grow",
    "_handledActions",
    "_initWorker",
    "_schemas",
    "__modifiedElements",
    "__modifiedPreviewElements",
    "data",
    "Array",
    "addListener",
    "ev",
    "getData",
    "setPreviewState",
    "structureChanges",
    "some",
    "element",
    "hasChildrenModified",
    "initUnDos",
    "initReDos",
    "__buttonListeners",
    "core",
    "Init",
    "getApplication",
    "getRoot",
    "_onElementKeyUp",
    "_maintainPreviewVisibility",
    "_draw",
    "statics",
    "SUPPORTED_FILES",
    "TITLE",
    "locale",
    "Manager",
    "tr",
    "ICON",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "Allowed",
    "NONE",
    "BEFORE",
    "AFTER",
    "INSIDE",
    "FIRST_CHILD",
    "properties",
    "appearance",
    "refine",
    "init",
    "expert",
    "check",
    "ready",
    "selected",
    "nullable",
    "event",
    "apply",
    "clipboard",
    "unDos",
    "deferredInit",
    "reDos",
    "autoRefreshPreview",
    "previewState",
    "showPreview",
    "dragging",
    "members",
    "_workerWrapper",
    "__editing",
    "__searchResults",
    "__searchResultIndex",
    "_structure",
    "getSchema",
    "file",
    "startsWith",
    "substring",
    "Object",
    "prototype",
    "hasOwnProperty",
    "call",
    "model",
    "Schema",
    "getInstance",
    "Promise",
    "resolve",
    "reject",
    "onLoaded",
    "setReady",
    "isPreviewSynced",
    "getPreviewState",
    "_applyHandlerOptions",
    "handlerOptions",
    "getHandlerOptions",
    "enablePreview",
    "bom",
    "Viewport",
    "getWidth",
    "noPreview",
    "previewFile",
    "__getPreviewFile",
    "isTemporary",
    "isWriteable",
    "FileItem",
    "ROOT",
    "setShowPreview",
    "_applyShowPreview",
    "value",
    "getChildControl",
    "setVisibility",
    "clearLayoutProperties",
    "updateLayoutProperties",
    "noStretch",
    "setLayoutProperties",
    "flex",
    "getFile",
    "preview",
    "setFile",
    "_updatePreview",
    "handleAction",
    "actionName",
    "canHandleAction",
    "undo",
    "redo",
    "_onCut",
    "_onCopy",
    "_onPaste",
    "_showHelp",
    "configureButton",
    "actionId",
    "button",
    "getUnDos",
    "length",
    "setEnabled",
    "setToolTipText",
    "getItem",
    "getTitle",
    "resetToolTipText",
    "getReDos",
    "bind",
    "converter",
    "isDeletable",
    "unConfigureButton",
    "removeListenerById",
    "removeRelatedBindings",
    "addUndo",
    "elementChange",
    "ElementChange",
    "push",
    "pop",
    "error",
    "clearUnDosReDos",
    "removeAll",
    "forEach",
    "elem",
    "dispose",
    "clearReDos",
    "_applyClipboard",
    "navigator",
    "writeText",
    "getNode",
    "outerHTML",
    "e",
    "CLIPBOARD",
    "Worker",
    "showErrors",
    "path",
    "errorList",
    "showDecorations",
    "decorators",
    "_loadFile",
    "old",
    "close",
    "getType",
    "isSupported",
    "hasChildControl",
    "resetFile",
    "resetPreviewState",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "container",
    "Composite",
    "HBox",
    "_add",
    "Canvas",
    "addAt",
    "VBox",
    "isShowPreview",
    "exclude",
    "viewer",
    "Config",
    "set",
    "target",
    "minWidth",
    "ok",
    "noSync",
    "notOk",
    "basic",
    "Atom",
    "setRich",
    "setWrap",
    "label",
    "icon",
    "removeState",
    "addState",
    "toolbar",
    "Button",
    "_onEdit",
    "add",
    "_onDelete",
    "CheckBox",
    "toggleExpert",
    "ToolBar",
    "top",
    "left",
    "right",
    "form",
    "TextField",
    "liveUpdate",
    "placeholder",
    "margin",
    "util",
    "Function",
    "debounce",
    "_onSearch",
    "getKeyIdentifier",
    "_showNextResult",
    "_showPreviousResult",
    "stopPropagation",
    "tree",
    "VirtualTree",
    "selectionMode",
    "width",
    "openMode",
    "itemHeight",
    "Environment",
    "get",
    "_initDragDrop",
    "setDelegate",
    "createItem",
    "item",
    "VirtualElementItem",
    "_onContextMenu",
    "_onContextMenuAction",
    "bindItem",
    "controller",
    "index",
    "bindProperty",
    "bindPropertyReverse",
    "getSelection",
    "_onChangeTreeSelection",
    "bottom",
    "setDraggable",
    "setMarginLeft",
    "setZIndex",
    "setAppearance",
    "getSelected",
    "_onCreate",
    "qxl",
    "dialog",
    "Dialog",
    "alert",
    "Widget",
    "setDecorator",
    "decoration",
    "Decorator",
    "widthTop",
    "styleTop",
    "colorTop",
    "setHeight",
    "setOpacity",
    "setDroppable",
    "contextmenu",
    "ConfigElement",
    "getCurrentTarget",
    "getModel",
    "replace",
    "setSelected",
    "menu",
    "setElement",
    "openAtPointer",
    "getBubbles",
    "stop",
    "action",
    "added",
    "resetSelected",
    "openByQuerySelector",
    "selector",
    "edit",
    "rootNode",
    "result",
    "querySelector",
    "__showSearchResult",
    "from",
    "querySelectorAll",
    "filter",
    "el",
    "tagName",
    "hasAttribute",
    "getAttribute",
    "firstMatch",
    "$$widget",
    "openNodeAndParents",
    "current",
    "ancestors",
    "parentElement",
    "load",
    "i",
    "p",
    "draggedXmlElement",
    "dragTarget",
    "getDragTarget",
    "setDragging",
    "isEditable",
    "preventDefault",
    "addAction",
    "addType",
    "addData",
    "addButton",
    "Tree",
    "accepted",
    "mode",
    "getCurrentAction",
    "supportsType",
    "addNew",
    "getTarget",
    "indicator",
    "debug",
    "isAncestor",
    "layerContent",
    "getPane",
    "getLayers",
    "getContentLocation",
    "getDocumentTop",
    "lastElem",
    "document",
    "elementFromPoint",
    "Math",
    "round",
    "getWidgetByElement",
    "isAnonymous",
    "getLayoutParent",
    "parent",
    "getParent",
    "parentSchemaElement",
    "getSchemaElement",
    "allowedElements",
    "getAllowedElements",
    "keys",
    "addable",
    "getAddableChildren",
    "areChildrenSortable",
    "acc",
    "allowedSorting",
    "getAllowedElementsSorting",
    "elementName",
    "__getAllowedPositions",
    "getName",
    "isChildElementAllowed",
    "lookInside",
    "getFirstLevelElementSorting",
    "targetPosition",
    "undefined",
    "getChildren",
    "firstChild",
    "maxPosition",
    "firstChildPosition",
    "expandTimer",
    "lastTreeItem",
    "treeContainer",
    "onDrag",
    "position",
    "cursor",
    "getManager",
    "getCursor",
    "DragDropCursor",
    "_native",
    "pointerType",
    "hasState",
    "origElem",
    "getDocumentLeft",
    "orig",
    "skipDetection",
    "origCoords",
    "leftPos",
    "spacer",
    "_getChildren",
    "getPaddingLeft",
    "setWidth",
    "getBounds",
    "lastCoords",
    "distance",
    "isOpen",
    "getUserData",
    "setDomPosition",
    "Timer",
    "once",
    "openNode",
    "setUserData",
    "getAction",
    "resetAction",
    "console",
    "assert",
    "setAction",
    "onDrop",
    "clone",
    "getDisplayName",
    "moveAfter",
    "snackbar",
    "Controller",
    "info",
    "insertAfter",
    "moveBefore",
    "insertBefore",
    "moveInside",
    "insertChild",
    "onDragEnd",
    "resetUserData",
    "resetDragging",
    "children",
    "sorting",
    "minPosition",
    "targetIndex",
    "indexOf",
    "found",
    "sibling",
    "name",
    "typeChooserForm",
    "ElementForm",
    "allowCancel",
    "context",
    "message",
    "formData",
    "type",
    "help",
    "options",
    "sort",
    "a",
    "b",
    "localeCompare",
    "map",
    "validation",
    "required",
    "show",
    "promise",
    "then",
    "ownerDocument",
    "isElement",
    "createComment",
    "createTextNode",
    "createCDATASection",
    "createElement",
    "schemaElement",
    "getSchemaElementForElementName",
    "initChildren",
    "requiredChildren",
    "getRequiredElements",
    "schema",
    "Element",
    "sortChildNodes",
    "childName",
    "child",
    "appendChild",
    "isTextContentRequired",
    "xmlElement",
    "XmlElement",
    "getEditor",
    "res",
    "isShowEditButton",
    "setSelection",
    "err",
    "targetName",
    "depth",
    "currentPosition",
    "split",
    "test",
    "parseInt",
    "min",
    "__checkProvider",
    "provider",
    "Provider",
    "getLive",
    "userInputAllowed",
    "includes",
    "endsWith",
    "isArray",
    "unshift",
    "__getAttributeFormDefinition",
    "attribute",
    "docs",
    "getDocumentation",
    "def",
    "join",
    "enabled",
    "getDefaultValue",
    "isOptional",
    "validator",
    "ListItem",
    "getValue",
    "isValueValid",
    "ValidationError",
    "getTypeString",
    "enums",
    "getEnumeration",
    "isNew",
    "title",
    "caption",
    "getShowEditButton",
    "typeElement",
    "nodeType",
    "Node",
    "ELEMENT_NODE",
    "allowed",
    "getAllowedAttributes",
    "getExpert",
    "appInfo",
    "getAppinfo",
    "parser",
    "DOMParser",
    "attrName",
    "nodeName",
    "lines",
    "autoSize",
    "innerHTML",
    "dom",
    "parseFromString",
    "getElementsByTagName",
    "TEXT_NODE",
    "COMMENT_NODE",
    "CDATA_SECTION_NODE",
    "getTextContent",
    "isTextNode",
    "convertTextNodeType",
    "newNodeName",
    "formDialog",
    "maxWidth",
    "setAttributes",
    "validate",
    "destroy",
    "remove",
    "execCommand",
    "setClipboard",
    "copy",
    "clipboardElement",
    "getClipboard",
    "resetClipboard",
    "updateModified",
    "previewIndex",
    "$$removed",
    "splice",
    "isModified",
    "setModified",
    "_onContentChanged",
    "_createChildControl",
    "addSeparator",
    "addSpacer",
    "_applySelected",
    "_updateHighlightWidget",
    "node",
    "openPage",
    "parentNode",
    "setHighlightWidget",
    "getWidgetPath",
    "isVisible",
    "_applyContent",
    "open",
    "initialValidation",
    "modified",
    "validateXmlConfig",
    "getPath",
    "__loadContent",
    "Main",
    "closeFile",
    "Bus",
    "dispatchByName",
    "getFullPath",
    "handler",
    "jumpToError",
    "hide",
    "resetModel",
    "f",
    "setTemporary",
    "errors",
    "doc",
    "xml",
    "Document",
    "fromString",
    "rootElement",
    "documentElement",
    "getAttributeNS",
    "getElementNode",
    "getStructure",
    "setEditable",
    "getWriteable",
    "setModel",
    "setContentPaddingBottom",
    "parts",
    "substr",
    "part",
    "shift",
    "match",
    "exec",
    "toString",
    "setValid",
    "content",
    "getCurrentContent",
    "contentChanged",
    "isAutoRefreshPreview",
    "reset",
    "_client",
    "createSync",
    "getBusTopic",
    "source",
    "resetTemporary",
    "updateSync",
    "fast",
    "XMLSerializer",
    "serializeToString",
    "Prettifier",
    "_onSaved",
    "onSaved",
    "focusedWidget",
    "FocusHandler",
    "getFocusedWidget",
    "dialogConf",
    "modal",
    "image",
    "maxHeight",
    "getHeight",
    "BigAlert",
    "destruct",
    "_disposeArray",
    "removeListener"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js"
  ],
  "sourcesContent": [
    "/* Tree.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    super();\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n\n    this._initWorker();\n\n    // init schema\n    this._schemas = {};\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', ev => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    });\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener('keyup', this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n    this._draw();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schemas: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n    _structure: null,\n\n    async getSchema(file) {\n      if (file.startsWith('../')) {\n        file = file.substring(3);\n      }\n      if (!Object.prototype.hasOwnProperty.call(this, file)) {\n        this._schemas[file] = await cv.ui.manager.model.Schema.getInstance(file);\n      }\n      return new Promise((resolve, reject) => {\n        this._schemas[file].onLoaded(function () {\n          this.setReady(true);\n          resolve(this._schemas[file]);\n        }, this);\n      });\n    },\n\n    isPreviewSynced() {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions() {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility() {\n      const handlerOptions = this.getHandlerOptions();\n      let enablePreview = qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview);\n      if (enablePreview) {\n        const previewFile = this.__getPreviewFile();\n        if (!previewFile.isTemporary() && !previewFile.isWriteable()) {\n          // preview file already exists, but it is not writable\n          enablePreview = false;\n        } else if (previewFile.isTemporary() && !cv.ui.manager.model.FileItem.ROOT.isWriteable()) {\n          // parent folder is not writable and preview file does not exist\n          enablePreview = false;\n        }\n      }\n      this.setShowPreview(enablePreview);\n    },\n\n    _applyShowPreview(value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({ flex: 1 });\n        }\n      }\n      const file = this.getFile();\n      if (value && file) {\n        const preview = this.getChildControl('preview');\n        if (file.isWriteable()) {\n          if (!preview.getFile()) {\n            preview.setFile(this.__getPreviewFile());\n          }\n        } else {\n          // this file is not writable, we can use the real one for preview\n          preview.setFile(file);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction(actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'undo':\n            if (!this.__editing) {\n              this.undo();\n            }\n            break;\n\n          case 'redo':\n            if (!this.__editing) {\n              this.redo();\n            }\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            if (!this.__editing) {\n              this._showHelp();\n            }\n            break;\n\n          default:\n            super.handleAction(actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton(actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(\n                this.tr(\n                  'Undo: %1',\n                  this.getUnDos()\n                    .getItem(length - 1)\n                    .getTitle()\n                )\n              );\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          });\n\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(\n                this.tr(\n                  'Undo: %1',\n                  this.getReDos()\n                    .getItem(length - 1)\n                    .getTitle()\n                )\n              );\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          });\n\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter(value) {\n              return value ? !value.isDeletable() : false;\n            }\n          });\n\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter(value) {\n              return !!value;\n            }\n          });\n\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter(value) {\n              return !!value;\n            }\n          });\n\n          break;\n      }\n    },\n    unConfigureButton(actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo(elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo() {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error('could not undo ' + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo() {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error('could not redo ' + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos() {\n      this.getUnDos()\n        .removeAll()\n        .forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos() {\n      this.getReDos()\n        .removeAll()\n        .forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard(value) {\n      try {\n        if (value) {\n          navigator.clipboard.writeText(value.getNode().outerHTML);\n        } else {\n          navigator.clipboard.writeText('');\n        }\n      } catch (e) {\n        // clipboard api is only available in secure environment, otherwise we have to do it ourself\n        cv.ui.manager.editor.AbstractEditor.CLIPBOARD = value ? value.getNode().outerHTML : '';\n      }\n    },\n\n    _initWorker() {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors(path, errorList) {},\n    showDecorations(path, decorators) {},\n\n    _loadFile(file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        super._loadFile(file, old);\n      } else {\n        super._loadFile(null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'splitpane':\n          control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n          this._add(control);\n          break;\n\n        case 'left':\n          control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n          this.getChildControl('splitpane').addAt(control, 0);\n          break;\n\n        case 'right':\n          control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n          if (!this.isShowPreview()) {\n            control.exclude();\n          }\n          this.getChildControl('splitpane').addAt(control, 1, { flex: 1 });\n          break;\n\n        case 'preview':\n          control = new cv.ui.manager.viewer.Config();\n          control.set({\n            target: 'iframe',\n            minWidth: 600\n          });\n\n          this.getChildControl('right').addAt(control, 1, { flex: 1 });\n          break;\n\n        case 'preview-sync-hint': {\n          const ok = this.tr('Preview shows the current state of the edited configuration.');\n\n          const noSync = this.tr('Preview is out of sync. Click here to refresh.');\n\n          const notOk = this.tr(\n            'Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.'\n          );\n\n          control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n\n          control.setRich(true);\n          control.getChildControl('label').setWrap(true);\n          control.addListener('tap', () => {\n            if (!this.isPreviewSynced() && this.isShowPreview()) {\n              this._updatePreview();\n            }\n          });\n          this.getChildControl('right').addAt(control, 0);\n          this.addListener('previewStateChanged', ev => {\n            switch (ev.getData()) {\n              case 'synced':\n                control.set({\n                  label: ok,\n                  icon: cv.theme.dark.Images.getIcon('valid', 16)\n                });\n\n                control.getChildControl('icon').removeState('error');\n                control.getChildControl('icon').removeState('warning');\n                break;\n\n              case 'changed':\n                control.set({\n                  label: noSync,\n                  icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                });\n\n                control.getChildControl('icon').removeState('error');\n                control.getChildControl('icon').addState('warning');\n                break;\n\n              case 'structureChanged':\n                control.set({\n                  label: notOk,\n                  icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                });\n\n                control.getChildControl('icon').addState('error');\n                control.getChildControl('icon').removeState('warning');\n                break;\n            }\n          });\n          break;\n        }\n\n        case 'edit-button':\n          control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n\n          control.setEnabled(false);\n          control.addListener('execute', this._onEdit, this);\n          this.bind('file.writeable', control, 'icon', {\n            converter(value) {\n              return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16);\n            }\n          });\n\n          this.getChildControl('toolbar').add(control);\n          break;\n\n        case 'delete-button':\n          control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n\n          control.setEnabled(false);\n          control.addListener('execute', this._onDelete, this);\n          this.getChildControl('toolbar').add(control);\n          break;\n\n        case 'toggle-expert':\n          control = new qx.ui.toolbar.CheckBox(this.tr('Expertview'), cv.theme.dark.Images.getIcon('expert', 16));\n\n          control.addListener('execute', () => {\n            this.toggleExpert();\n          });\n          this.getChildControl('toolbar').add(control);\n          break;\n\n        case 'refresh-preview':\n          control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n\n          control.setToolTipText(this.tr('Reload preview'));\n          control.addListener('execute', this._updatePreview, this);\n          this.bind('showPreview', control, 'visibility', {\n            converter(value) {\n              return value ? 'visible' : 'hidden';\n            }\n          });\n\n          this.bind('previewState', control, 'enabled', {\n            converter(value) {\n              return value !== 'synced';\n            }\n          });\n\n          this.getChildControl('toolbar').add(control);\n          break;\n\n        case 'toolbar':\n          control = new qx.ui.toolbar.ToolBar();\n          this.getChildControl('left').add(control, {\n            top: 0,\n            left: 0,\n            right: 0\n          });\n\n          break;\n\n        case 'searchbar-container':\n          control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n          this.getChildControl('left').add(control, {\n            top: 36,\n            left: 0,\n            right: 0\n          });\n\n          break;\n\n        case 'searchbar':\n          control = new qx.ui.form.TextField();\n          control.set({\n            liveUpdate: true,\n            placeholder: this.tr('Search...'),\n            margin: 8\n          });\n\n          control.addListener('changeValue', qx.util.Function.debounce(this._onSearch, 250), this);\n\n          control.addListener('keyup', ev => {\n            switch (ev.getKeyIdentifier()) {\n              case 'Enter':\n              case 'Down':\n                this._showNextResult();\n                break;\n              case 'Up':\n                this._showPreviousResult();\n                break;\n            }\n\n            ev.stopPropagation();\n          });\n          this.getChildControl('searchbar-container').add(control, { flex: 1 });\n          break;\n\n        case 'tree':\n          control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n          control.set({\n            selectionMode: 'single',\n            width: 350,\n            openMode: 'none',\n            itemHeight: qx.core.Environment.get('device.touch') ? 40 : 20\n          });\n\n          this.bind('file.writeable', control, 'droppable');\n          this.bind('file.writeable', control, 'draggable');\n          this._initDragDrop(control);\n          control.setDelegate({\n            createItem: function () {\n              const item = new cv.ui.manager.tree.VirtualElementItem();\n              if (!qx.core.Environment.get('device.touch')) {\n                item.addListener('contextmenu', this._onContextMenu, this);\n              } else {\n                item.addListener('action', this._onContextMenuAction, this);\n              }\n              item.addListener('dbltap', this._onEdit, this);\n              return item;\n            }.bind(this),\n\n            // Bind properties from the item to the tree-widget and vice versa\n            bindItem(controller, item, index) {\n              controller.bindProperty('', 'model', null, item, index);\n              controller.bindProperty('displayName', 'label', null, item, index);\n\n              controller.bindProperty('name', 'name', null, item, index);\n              controller.bindPropertyReverse('open', 'open', null, item, index);\n              controller.bindProperty('open', 'open', null, item, index);\n              controller.bindProperty('showEditButton', 'editable', null, item, index);\n\n              controller.bindProperty('sortable', 'sortable', null, item, index);\n\n              controller.bindProperty('icon', 'icon', null, item, index);\n              controller.bindProperty('status', 'status', null, item, index);\n              controller.bindProperty('invalidMessage', 'toolTipText', null, item, index);\n\n              controller.bindProperty('dragging', 'dragging', null, item, index);\n            }\n          });\n\n          control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n          this.getChildControl('left').add(control, {\n            top: 72,\n            left: 0,\n            right: 0,\n            bottom: 0\n          });\n\n          break;\n\n        case 'add-button':\n          control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n\n          control.setDraggable(true);\n          control.setMarginLeft(-16);\n          control.setZIndex(20);\n          this.addListener('changeDragging', ev => {\n            control.setLayoutProperties({\n              bottom: 16,\n              left: ev.getData() ? -1000 : '50%'\n            });\n          });\n          control.setAppearance('round-button');\n          control.addListener('pointerover', () => control.addState('hovered'));\n          control.addListener('pointerout', () => control.removeState('hovered'));\n\n          control.addListener('tap', () => {\n            if (this.getSelected()) {\n              this._onCreate(this.getSelected(), 'inside');\n            } else {\n              qxl.dialog.Dialog.alert(\n                this.tr(\n                  'Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.'\n                )\n              );\n            }\n          });\n          this.getChildControl('left').add(control, {\n            bottom: 16,\n            left: '50%'\n          });\n\n          break;\n\n        case 'drag-indicator':\n          // Create drag indicator\n          control = new qx.ui.core.Widget();\n          control.setDecorator(\n            new qx.ui.decoration.Decorator().set({\n              widthTop: 1,\n              styleTop: 'solid',\n              colorTop: 'white'\n            })\n          );\n\n          control.setHeight(0);\n          control.setOpacity(0.5);\n          control.setZIndex(100);\n          control.setDroppable(true);\n          control.setLayoutProperties({ left: -1000, top: -1000 });\n          qx.core.Init.getApplication().getRoot().add(control);\n          break;\n\n        case 'context-menu':\n          control = new cv.ui.manager.contextmenu.ConfigElement(this);\n          control.addListener('action', this._onContextMenuAction, this);\n          break;\n      }\n\n      return control || super._createChildControlImpl(id);\n    },\n\n    _onContextMenu(ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction(ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, 'inside');\n            break;\n\n          default:\n            this.error('unhandled context menu action', data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection(ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n    openByQuerySelector(selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch(ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || (el.hasAttribute('name') && el.getAttribute('name').startsWith(value));\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult() {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult() {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult() {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length - 1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop(control) {\n      let draggedXmlElement;\n      control.addListener('dragstart', ev => {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction('copy');\n          if (element.isDeletable()) {\n            ev.addAction('move');\n          }\n          ev.addType('cv/tree-element');\n          ev.addData('cv/tree-element', element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      });\n\n      const addButton = this.getChildControl('add-button');\n      addButton.addListener('dragstart', ev => {\n        ev.addAction('copy');\n        ev.addType('cv/new-tree-element');\n        this.setDragging(true);\n      });\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      };\n\n      control.addListener('dragover', ev => {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType('cv/tree-element')) {\n          element = ev.getData('cv/tree-element');\n        }\n        const addNew = action === 'copy' && !element && ev.supportsType('cv/new-tree-element');\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug('dragging over indicator');\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug('dropping on same element forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug('moving inside own subtree forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && ev.getDocumentTop() - layerContent.bottom <= 20) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(\n              Math.round((layerContent.left + layerContent.right) / 2),\n              layerContent.bottom - 20\n            );\n\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug('drop target not found');\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug('drop not allowed here, no drag element');\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n\n                    if (acc & Allowed.BEFORE && acc & Allowed.AFTER) {\n                      // we cannot find more\n                      return true;\n                    }\n                    return false;\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug('no children allowed here');\n            }\n          } else if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n            // not allowed on this level\n            accepted.mode = Allowed.NONE;\n            this.debug('not allowed as child element of', parent.getName());\n          } else if (parentSchemaElement.areChildrenSortable()) {\n            // children can be put anywhere\n            // so this is allowed anywhere\n            accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n          } else {\n            // check position\n            accepted.mode = this.__getAllowedPositions(\n              parentSchemaElement.getAllowedElementsSorting(),\n              element.getName(),\n              model.getName()\n            );\n          }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug('dropping not accepted here');\n        }\n      });\n\n      const indicator = this.getChildControl('drag-indicator');\n\n      let expandTimer;\n\n      control.addListener('dragleave', ev => {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      });\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = '';\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = 'after';\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if (ev.getDocumentTop() - origCoords.top <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = 'before';\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = 'inside';\n              }\n            } else if (origCoords.bottom - ev.getDocumentTop() <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = 'after';\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = 'inside';\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                // eslint-disable-next-line no-lonely-if\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                } else {\n                  this.debug('not allowed as first child');\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              // eslint-disable-next-line no-lonely-if\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData('position') !== 'first-child') {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = 'inside';\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(\n                    function () {\n                      if (accepted.target) {\n                        control.openNode(accepted.target);\n                      }\n                    },\n                    this,\n                    1000\n                  );\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData('position', position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData('action', ev.getCurrentAction());\n          cursor.resetAction();\n          // eslint-disable-next-line no-console\n          console.assert(left < 0);\n          // eslint-disable-next-line no-console\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData('action')) {\n          cursor.setAction(indicator.getUserData('action'));\n          indicator.setUserData('action', null);\n        }\n      };\n      control.addListener('drag', onDrag, this);\n      addButton.addListener('drag', onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction();\n        let element = ev.supportsType('cv/tree-element') ? ev.getData('cv/tree-element') : null;\n        if (action === 'copy') {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = 'add';\n          }\n        }\n        const elementName = element ? element.getDisplayName() : 'new';\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData('position')) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, 'after', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, 'before', target.getDisplayName());\n\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as first child');\n\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName() + ' as first child');\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as child');\n\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(\n                      this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName())\n                    );\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName(), 'as child');\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener('drop', onDrop, this);\n      indicator.addListener('drop', onDrop, this);\n\n      const onDragEnd = function (ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener('dragend', onDragEnd, this);\n      addButton.addListener('dragend', onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate(target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex - 1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(\n            name =>\n              Object.prototype.hasOwnProperty.call(sorting, name) &&\n              sorting[name] <= maxPosition &&\n              sorting[name] >= minPosition\n          );\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm;\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr(\n              '<p style=\\'font-weight:bold\\'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>'\n            ),\n\n            formData: {\n              type: {\n                type: 'SelectBox',\n                label: this.tr('Choose element'),\n                help: this.tr('Please choose the element you want to add here.'),\n\n                options: addable\n                  .sort((a, b) => {\n                    if (a.startsWith('#') && !b.startsWith('#')) {\n                      return 1;\n                    } else if (!a.startsWith('#') && b.startsWith('#')) {\n                      return -1;\n                    }\n                    return a.localeCompare(b);\n                  })\n                  .map(name => ({ label: name, value: name })),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          })\n            .show()\n            .promise();\n        } else {\n          typeChooserForm = Promise.resolve({ type: addable[0] });\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment('');\n                break;\n\n              case '#text':\n                element = document.createTextNode('');\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection('');\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode('-');\n                element.appendChild(child);\n              }\n            };\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement, true);\n            }\n            res\n              .then(data => {\n                if (data) {\n                  // finally insert the new node\n                  switch (position) {\n                    case 'before':\n                      xmlElement.insertBefore(target);\n                      break;\n\n                    case 'after':\n                      xmlElement.insertAfter(target);\n                      break;\n\n                    case 'inside':\n                      target.insertChild(xmlElement, -1, false, 'added');\n                      break;\n\n                    case 'first-child':\n                      target.insertChild(xmlElement, 0, false, 'added');\n                      break;\n                  }\n\n                  this.getChildControl('tree').openNodeAndParents(xmlElement);\n                  this.getChildControl('tree').setSelection([xmlElement]);\n                }\n              }, this)\n              .catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions(allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === 'string') {\n          currentPosition = currentPosition.split('.').map(i => (/^\\d+$/.test(i) ? parseInt(i) : i));\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === 'string') {\n          targetPosition = targetPosition.split('.').map(i => (/^\\d+$/.test(i) ? parseInt(i) : i));\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length);\n\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n      }\n      return cv.ui.manager.editor.Tree.Allowed.NONE;\n    },\n\n    __checkProvider(id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error('misconfigured provider found for ' + id);\n        }\n        formData.type = provider.userInputAllowed ? 'VirtualComboBox' : 'VirtualSelectBox';\n      } else if (['mapping', 'styling'].includes(id.split('@').pop())) {\n        const type = id.split('@').pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = 'SelectBox';\n        formData.options = [];\n        const selector = this._structure === 'tile' ? 'cv-meta > cv-' + type : 'meta > ' + type + 's > ' + type;\n        rootNode.querySelectorAll(selector).forEach(element => {\n          const name = element.getAttribute('name');\n          formData.options.push({ label: name, value: name });\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options\n              .then(res => {\n                if (Array.isArray(res)) {\n                  res.unshift({\n                    label: ' - ' + this.tr('not set') + ' - ',\n                    value: ''\n                  });\n                }\n              })\n              .catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({\n              label: ' - ' + this.tr('not set') + ' - ',\n              value: ''\n            });\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition(element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: 'TextField',\n        label: attribute.getName(),\n        placeholder: ' - ' + this.tr('not set') + ' - ',\n        help: docs.join('<br/>'),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator(value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n            }\n          }\n        }\n      };\n\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = 'CheckBox';\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string': {\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = 'SelectBox';\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({ label: name, value: name });\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({\n                label: ' - ' + this.tr('not set') + ' - ',\n                value: ''\n              });\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + '@' + attribute.getName(), def, element.getNode());\n          }\n          break;\n        }\n      }\n\n      return def;\n    },\n\n    _onEdit(ev, element, isNew) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return null;\n      }\n      let title;\n      let caption;\n      if (!element) {\n        if (this.getSelected()) {\n          element = this.getSelected();\n        } else {\n          return null;\n        }\n      }\n      if (!element.getShowEditButton()) {\n        return null;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (isNew) {\n        title = this.tr('Create new %1 element', element.getName());\n        caption = this.tr(\n          'Please edit the attributes of the new %1 element, that will be added to the chosen position.',\n          element.getName()\n        );\n      } else {\n        title = this.tr('Edit element attributes');\n        caption = element.isEditable() ? this.tr('Edit %1', element.getName()) : this.tr('Show %1', element.getName());\n      }\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n        if (typeElement.isChildElementAllowed('*')) {\n          const parser = new DOMParser();\n          const attrName = element.getNode().nodeName === 'custom' ? '#innerHTML' : '#outerHTML';\n          if (isNew) {\n            title = this.tr('Create new %1 element', element.getName());\n            caption = this.tr(\n              'Please edit the content of the new %1 element, that will be added to the chosen position.',\n              element.getName()\n            );\n          } else {\n            title = attrName === '#outerHTML' ? this.tr('Edit element and content') : this.tr('Edit element content');\n          }\n          formData[attrName] = {\n            type: 'TextArea',\n            label: '',\n            lines: 5,\n            autoSize: true,\n            width: Math.min(qx.bom.Viewport.getWidth(), 500),\n            enabled: element.isEditable(),\n            value: attrName === '#outerHTML' ? element.getNode().outerHTML : element.getNode().innerHTML,\n            validation: {\n              validator(value) {\n                if (value) {\n                  const dom = parser.parseFromString(value, 'text/xml');\n                  if (dom.getElementsByTagName('parsererror').length > 0) {\n                    throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n                  }\n                }\n              }\n            }\n          };\n        }\n      } else if (\n        element.getNode().nodeType === Node.TEXT_NODE ||\n        element.getNode().nodeType === Node.COMMENT_NODE ||\n        element.getNode().nodeType === Node.CDATA_SECTION_NODE\n      ) {\n        title = this.tr('Edit text content', element.getName());\n        caption = '';\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: 'TextArea',\n          label: '',\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr('not set'),\n          help: docs.join('<br/>'),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator(value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n              }\n            }\n          }\n        };\n\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute('type');\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(\n          element.getParent().getName() + '@' + element.getName(),\n          formData[nodeName],\n          element.getNode()\n        );\n      }\n      this.__editing = true;\n\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption: title,\n        message: caption,\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          if (\n            !Object.prototype.hasOwnProperty.call(data, '#outerHTML') &&\n            !Object.prototype.hasOwnProperty.call(data, '#innerHTML')\n          ) {\n            element.validate();\n          }\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete(ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n      return null;\n    },\n\n    _onCut() {\n      if (this.__editing) {\n        document.execCommand('cut');\n      } else {\n        const element = this._onDelete();\n        if (element) {\n          this.setClipboard(element);\n        }\n      }\n    },\n\n    _onCopy() {\n      if (this.__editing) {\n        document.execCommand('copy');\n      } else {\n        const element = this.getSelected();\n        if (element) {\n          const copy = element.clone();\n          this.setClipboard(copy);\n        }\n      }\n    },\n\n    _onPaste() {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified(element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else if (element.isModified()) {\n        if (index === -1) {\n          this.__modifiedElements.push(element);\n        }\n        if (previewIndex === -1) {\n          this.__modifiedPreviewElements.push(element);\n        }\n      } else {\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw() {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected(value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget() {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          if (this._structure === 'tile') {\n            while (node && node.nodeName !== 'config') {\n              if (node.nodeName === 'cv-page') {\n                preview.openPage(node.getAttribute('id'));\n                break;\n              }\n              node = node.parentNode;\n            }\n          } else {\n            while (node && node.nodeName !== 'pages') {\n              if (node.nodeName === 'page') {\n                path.unshift(node.getAttribute('name'));\n              }\n              node = node.parentNode;\n            }\n            if (path.length > 0) {\n              preview.openPage(path.pop(), path.join('/'));\n            }\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === 'Enter') {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + ' is a valid config file');\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n\n              dialog.addListener('action', ev => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source': {\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: 'cv.ui.manager.editor.Source',\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n\n                    break;\n                  }\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n\n                dialog.hide();\n                dialog.destroy();\n              });\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __getPreviewFile() {\n      let file;\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(f => {\n        if (f.getName() === 'visu_config_previewtemp.xml') {\n          file = f;\n          return true;\n        }\n        return false;\n      });\n      if (!file) {\n        file = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', cv.ui.manager.model.FileItem.ROOT);\n\n        file.setTemporary(true);\n      }\n      return file;\n    },\n\n    async __loadContent(value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const doc = qx.xml.Document.fromString(value);\n        const rootElement = doc.documentElement;\n        const schema = await this.getSchema(\n          rootElement.getAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'noNamespaceSchemaLocation')\n        );\n\n        const schemaElement = schema.getElementNode(rootElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(rootElement, schemaElement, this);\n\n        this._structure = schema.getStructure();\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n\n          // extra space für add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (file.isWriteable()) {\n            if (!preview.getFile()) {\n              preview.setFile(this.__getPreviewFile());\n            }\n          } else {\n            preview.setFile(file);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split('/');\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error('Error loading ' + current.getName() + ': ' + e.toString());\n\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error('patch segment format error: ' + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      } else {\n        this._structure = null;\n      }\n    },\n\n    _onContentChanged() {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview(ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        if (previewFile.isTemporary()) {\n          this._client.createSync(\n            {\n              path: previewFile.getFullPath(),\n              hash: 'ignore'\n            },\n            content,\n            err => {\n              if (err) {\n                // disable preview, because the file could not be created\n                this.setShowPreview(false);\n                this.error(err);\n                cv.ui.manager.snackbar.Controller.error(this.tr('Disabling preview because the preview file could not be created.'));\n              } else {\n                qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n                  type: 'contentChanged',\n                  file: previewFile,\n                  data: content,\n                  source: this\n                });\n                this.__modifiedPreviewElements.removeAll();\n                this.resetPreviewState();\n                previewFile.resetTemporary();\n              }\n            },\n            this\n          );\n        } else {\n          this._client.updateSync(\n            {\n              path: previewFile.getFullPath(),\n              hash: 'ignore'\n            },\n            content,\n            err => {\n              if (err) {\n                cv.ui.manager.snackbar.Controller.error(err);\n              } else {\n                qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n                  type: 'contentChanged',\n                  file: previewFile,\n                  data: content,\n                  source: this\n                });\n\n                this.__modifiedPreviewElements.removeAll();\n                this.resetPreviewState();\n              }\n            },\n            this\n          );\n        }\n      }\n    },\n\n    getCurrentContent(fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        }\n        // prettify content\n        return cv.util.Prettifier.xml(rootNode.ownerDocument);\n      }\n      return null;\n    },\n\n    _onSaved() {\n      super._onSaved();\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported(file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp() {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr('Help'),\n        modal: true,\n        image: 'qxl.dialog.icon.info',\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: ''\n      };\n\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr(\n          '<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with \\'Enter\\' or the \\'Down\\' key. Accordingly you can jump the the previous found element \\\nwith the \\'Up\\' key.</p>'\n        );\n      } else {\n        // show general help\n        dialogConf.message = this.tr(\n          '<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the \\'edit\\'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the \\'edit\\'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the \\'add child\\'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the \\'Expertview\\'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>'\n        );\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._schemas = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener('keyup', this._onElementKeyUp, this);\n  }\n});\n"
  ],
  "mappings": ";;+CACA,oJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EADAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;EAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;EACAH,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,2BAAhB,EAA6C;IAC3CC,MAAM,EAAEC,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBC,cADc;;IAG3C;AACF;AACA;AACA;AACA;IACEC,SAR2C,uBAQ/B;MAAA;;MACV;;MACA,KAAKC,UAAL,CAAgB,IAAIb,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAaC,IAAjB,EAAhB;;MACA,KAAKC,eAAL,GAAuB,CAAC,MAAD,EAAS,KAAT,EAAgB,MAAhB,EAAwB,OAAxB,EAAiC,MAAjC,EAAyC,MAAzC,EAAiD,MAAjD,CAAvB;;MAEA,KAAKC,WAAL,GALU,CAOV;;;MACA,KAAKC,QAAL,GAAgB,EAAhB;MACA,KAAKC,QAAL,GAA0B,EAA1B;MACA,KAAKC,QAAL,GAAiC,IAAIpB,EAAE,CAACqB,IAAH,CAAQC,KAAZ,EAAjC;;MACA,KAAKF,QAAL,CAA+BG,WAA/B,CAA2C,cAA3C,EAA2D,UAAAC,EAAE,EAAI;QAC/D,IAAIA,EAAE,CAACC,OAAH,OAAiB,CAArB,EAAwB;UACtB,KAAI,CAACC,eAAL,CAAqB,QAArB;QACD,CAFD,MAEO;UACL,IAAMC,gBAAgB,GAAG,KAAI,CAACP,QAAL,CAA+BQ,IAA/B,CAAoC,UAAAC,OAAO;YAAA,OAAIA,OAAO,CAACC,mBAAR,EAAJ;UAAA,CAA3C,CAAzB;;UAEA,KAAI,CAACJ,eAAL,CAAqBC,gBAAgB,GAAG,kBAAH,GAAwB,SAA7D;QACD;MACF,CARD;;MASA,KAAKI,SAAL,CAAe,IAAI/B,EAAE,CAACqB,IAAH,CAAQC,KAAZ,EAAf;MACA,KAAKU,SAAL,CAAe,IAAIhC,EAAE,CAACqB,IAAH,CAAQC,KAAZ,EAAf;MACA,KAAKW,QAAL,GAAyB,EAAzB;MACAjC,EAAE,CAACkC,IAAH,CAAQC,IAAR,CAAaC,cAAb,GAA8BC,OAA9B,GAAwCd,WAAxC,CAAoD,OAApD,EAA6D,KAAKe,eAAlE,EAAmF,IAAnF;MACA,KAAKf,WAAL,CAAiB,QAAjB,EAA2B,KAAKgB,0BAAhC,EAA4D,IAA5D;;MACA,KAAKC,KAAL;IACD,CAlC0C;;IAoC3C;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACPC,eAAe,EAAE,kCADV;MAEPC,KAAK,EAAE3C,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,YAArB,CAFA;MAGPC,IAAI,EAAExC,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,KAA7B,EAAoC,EAApC,CAHC;MAKPC,OAAO,EAAE;QACPC,IAAI,EAAE,CADC;QAEPC,MAAM,EAAE,CAFD;QAGPC,KAAK,EAAE,CAHA;QAIPC,MAAM,EAAE,CAJD;QAKPC,WAAW,EAAE,CALN,CAKQ;;MALR;IALF,CAzCkC;;IAuD3C;AACF;AACA;AACA;AACA;IACEC,UAAU,EAAE;MACVC,UAAU,EAAE;QACVC,MAAM,EAAE,IADE;QAEVC,IAAI,EAAE;MAFI,CADF;MAMV;MACAC,MAAM,EAAE;QACNC,KAAK,EAAE,SADD;QAENF,IAAI,EAAE;MAFA,CAPE;MAYVG,KAAK,EAAE;QACLJ,MAAM,EAAE,IADH;QAELC,IAAI,EAAE;MAFD,CAZG;MAiBVI,QAAQ,EAAE;QACRF,KAAK,EAAE,gCADC;QAERG,QAAQ,EAAE,IAFF;QAGRC,KAAK,EAAE,gBAHC;QAIRC,KAAK,EAAE;MAJC,CAjBA;MAwBVC,SAAS,EAAE;QACTN,KAAK,EAAE,gCADE;QAETG,QAAQ,EAAE,IAFD;QAGTC,KAAK,EAAE,iBAHE;QAITC,KAAK,EAAE;MAJE,CAxBD;MA+BVE,KAAK,EAAE;QACLP,KAAK,EAAE,eADF;QAELQ,YAAY,EAAE;MAFT,CA/BG;MAoCVC,KAAK,EAAE;QACLT,KAAK,EAAE,eADF;QAELQ,YAAY,EAAE;MAFT,CApCG;MAyCVE,kBAAkB,EAAE;QAClBV,KAAK,EAAE,SADW;QAElBF,IAAI,EAAE;MAFY,CAzCV;;MA8CV;AACJ;AACA;MACIa,YAAY,EAAE;QACZX,KAAK,EAAE,CAAC,QAAD,EAAW,SAAX,EAAsB,kBAAtB,CADK;QAEZF,IAAI,EAAE,QAFM;QAGZM,KAAK,EAAE,qBAHK;QAIZC,KAAK,EAAE;MAJK,CAjDJ;MAwDVO,WAAW,EAAE;QACXZ,KAAK,EAAE,SADI;QAEXF,IAAI,EAAE,IAFK;QAGXO,KAAK,EAAE,mBAHI;QAIXD,KAAK,EAAE;MAJI,CAxDH;;MA+DV;AACJ;AACA;MACIS,QAAQ,EAAE;QACRb,KAAK,EAAE,SADC;QAERF,IAAI,EAAE,KAFE;QAGRM,KAAK,EAAE;MAHC;IAlEA,CA5D+B;;IAqI3C;AACF;AACA;AACA;AACA;IACEU,OAAO,EAAE;MACP3D,QAAQ,EAAE,IADH;MAEPC,QAAkB,EAAE,IAFb;MAGPC,QAAyB,EAAE,IAHpB;MAIP0D,cAAc,EAAE,IAJT;MAKPC,QAAS,EAAE,KALJ;MAMP9C,QAAiB,EAAE,IANZ;MAOP+C,QAAe,EAAE,IAPV;MAQPC,QAAmB,EAAE,CARd;MASPC,UAAU,EAAE,IATL;MAWDC,SAXC,qBAWSC,IAXT,EAWe;QAAA;;QAAA;UAAA;YAAA;cAAA;gBACpB,IAAIA,IAAI,CAACC,UAAL,CAAgB,KAAhB,CAAJ,EAA4B;kBAC1BD,IAAI,GAAGA,IAAI,CAACE,SAAL,CAAe,CAAf,CAAP;gBACD;;gBAHmB,IAIfC,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,MAArC,EAA2CN,IAA3C,CAJe;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OAKU7E,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBC,MAApB,CAA2BC,WAA3B,CAAuCT,IAAvC,CALV;;cAAA;gBAKlB,MAAI,CAAClE,QAAL,CAAckE,IAAd,CALkB;;cAAA;gBAAA,iCAOb,IAAIU,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;kBACtC,MAAI,CAAC9E,QAAL,CAAckE,IAAd,EAAoBa,QAApB,CAA6B,YAAY;oBACvC,KAAKC,QAAL,CAAc,IAAd;oBACAH,OAAO,CAAC,KAAK7E,QAAL,CAAckE,IAAd,CAAD,CAAP;kBACD,CAHD,EAGG,MAHH;gBAID,CALM,CAPa;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAarB,CAxBM;MA0BPe,eA1BO,6BA0BW;QAChB,OAAO,KAAKC,eAAL,OAA2B,QAAlC;MACD,CA5BM;MA8BPC,oBA9BO,kCA8BgB;QACrB,KAAK9D,0BAAL;MACD,CAhCM;MAkCPA,0BAlCO,wCAkCsB;QAC3B,IAAM+D,cAAc,GAAG,KAAKC,iBAAL,EAAvB;QACA,IAAIC,aAAa,GAAGxG,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,KAA6B,GAA7B,KAAqC,CAACL,cAAD,IAAmB,CAACA,cAAc,CAACM,SAAxE,CAApB;;QACA,IAAIJ,aAAJ,EAAmB;UACjB,IAAMK,WAAW,GAAG,KAAKC,QAAL,EAApB;;UACA,IAAI,CAACD,WAAW,CAACE,WAAZ,EAAD,IAA8B,CAACF,WAAW,CAACG,WAAZ,EAAnC,EAA8D;YAC5D;YACAR,aAAa,GAAG,KAAhB;UACD,CAHD,MAGO,IAAIK,WAAW,CAACE,WAAZ,MAA6B,CAACxG,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBsB,QAApB,CAA6BC,IAA7B,CAAkCF,WAAlC,EAAlC,EAAmF;YACxF;YACAR,aAAa,GAAG,KAAhB;UACD;QACF;;QACD,KAAKW,cAAL,CAAoBX,aAApB;MACD,CAhDM;MAkDPY,iBAlDO,6BAkDWC,KAlDX,EAkDkB;QACvB,KAAKC,eAAL,CAAqB,OAArB,EAA8BC,aAA9B,CAA4CF,KAAK,GAAG,SAAH,GAAe,UAAhE;;QAEA,IAAIA,KAAJ,EAAW;UACT,KAAKC,eAAL,CAAqB,MAArB,EAA6BE,qBAA7B;UACA,KAAKF,eAAL,CAAqB,MAArB,EAA6BG,sBAA7B;QACD,CAHD,MAGO;UACL,IAAMnB,cAAc,GAAG,KAAKC,iBAAL,EAAvB;;UACA,IAAI,CAACD,cAAD,IAAmB,CAACA,cAAc,CAACoB,SAAvC,EAAkD;YAChD,KAAKJ,eAAL,CAAqB,MAArB,EAA6BK,mBAA7B,CAAiD;cAAEC,IAAI,EAAE;YAAR,CAAjD;UACD;QACF;;QACD,IAAMxC,IAAI,GAAG,KAAKyC,OAAL,EAAb;;QACA,IAAIR,KAAK,IAAIjC,IAAb,EAAmB;UACjB,IAAM0C,OAAO,GAAG,KAAKR,eAAL,CAAqB,SAArB,CAAhB;;UACA,IAAIlC,IAAI,CAAC4B,WAAL,EAAJ,EAAwB;YACtB,IAAI,CAACc,OAAO,CAACD,OAAR,EAAL,EAAwB;cACtBC,OAAO,CAACC,OAAR,CAAgB,KAAKjB,QAAL,EAAhB;YACD;UACF,CAJD,MAIO;YACL;YACAgB,OAAO,CAACC,OAAR,CAAgB3C,IAAhB;UACD;;UACD,KAAK4C,cAAL;QACD;MACF,CA3EM;MA6EPC,YA7EO,wBA6EMC,UA7EN,EA6EkB;QACvB,IAAI,KAAKC,eAAL,CAAqBD,UAArB,CAAJ,EAAsC;UACpC,QAAQA,UAAR;YACE,KAAK,MAAL;cACE,IAAI,CAAC,KAAKnD,QAAV,EAAqB;gBACnB,KAAKqD,IAAL;cACD;;cACD;;YAEF,KAAK,MAAL;cACE,IAAI,CAAC,KAAKrD,QAAV,EAAqB;gBACnB,KAAKsD,IAAL;cACD;;cACD;;YAEF,KAAK,KAAL;cACE,KAAKC,MAAL;;cACA;;YAEF,KAAK,MAAL;cACE,KAAKC,OAAL;;cACA;;YAEF,KAAK,OAAL;cACE,KAAKC,QAAL;;cACA;;YAEF,KAAK,MAAL;cACE,IAAI,CAAC,KAAKzD,QAAV,EAAqB;gBACnB,KAAK0D,SAAL;cACD;;cACD;;YAEF;cACE,uEAAmBP,UAAnB;cACA;UAjCJ;QAmCD;MACF,CAnHM;MAqHPQ,eArHO,2BAqHSC,QArHT,EAqHmBC,MArHnB,EAqH2B;QAAA;;QAChC,QAAQD,QAAR;UACE,KAAK,MAAL;YACE,KAAK1G,QAAL,CAAuB0G,QAAvB,IAAmC,KAAKE,QAAL,GAAgBtH,WAAhB,CAA4B,cAA5B,EAA4C,YAAM;cACnF,IAAMuH,MAAM,GAAG,MAAI,CAACD,QAAL,GAAgBC,MAA/B;;cACA,IAAIA,MAAM,GAAG,CAAb,EAAgB;gBACdF,MAAM,CAACG,UAAP,CAAkB,IAAlB;gBACAH,MAAM,CAACI,cAAP,CACE,MAAI,CAAClG,EAAL,CACE,UADF,EAEE,MAAI,CAAC+F,QAAL,GACGI,OADH,CACWH,MAAM,GAAG,CADpB,EAEGI,QAFH,EAFF,CADF;cAQD,CAVD,MAUO;gBACLN,MAAM,CAACG,UAAP,CAAkB,KAAlB;gBACAH,MAAM,CAACO,gBAAP;cACD;YACF,CAhBkC,CAAnC;YAkBAP,MAAM,CAACG,UAAP,CAAkB,KAAKF,QAAL,GAAgBC,MAAhB,GAAyB,CAA3C;YACA;;UAEF,KAAK,MAAL;YACE,KAAK7G,QAAL,CAAuB0G,QAAvB,IAAmC,KAAKS,QAAL,GAAgB7H,WAAhB,CAA4B,cAA5B,EAA4C,YAAM;cACnF,IAAMuH,MAAM,GAAG,MAAI,CAACM,QAAL,GAAgBN,MAA/B;;cACA,IAAIA,MAAM,GAAG,CAAb,EAAgB;gBACdF,MAAM,CAACG,UAAP,CAAkB,IAAlB;gBACAH,MAAM,CAACI,cAAP,CACE,MAAI,CAAClG,EAAL,CACE,UADF,EAEE,MAAI,CAACsG,QAAL,GACGH,OADH,CACWH,MAAM,GAAG,CADpB,EAEGI,QAFH,EAFF,CADF;cAQD,CAVD,MAUO;gBACLN,MAAM,CAACG,UAAP,CAAkB,KAAlB;gBACAH,MAAM,CAACO,gBAAP;cACD;YACF,CAhBkC,CAAnC;YAkBAP,MAAM,CAACG,UAAP,CAAkB,KAAKK,QAAL,GAAgBN,MAAhB,GAAyB,CAA3C;YACA;;UAEF,KAAK,KAAL;YACE,KAAKO,IAAL,CAAU,UAAV,EAAsBT,MAAtB,EAA8B,SAA9B,EAAyC;cACvCU,SADuC,qBAC7BjC,KAD6B,EACtB;gBACf,OAAOA,KAAK,GAAG,CAACA,KAAK,CAACkC,WAAN,EAAJ,GAA0B,KAAtC;cACD;YAHsC,CAAzC;YAMA;;UAEF,KAAK,MAAL;YACE,KAAKF,IAAL,CAAU,UAAV,EAAsBT,MAAtB,EAA8B,SAA9B,EAAyC;cACvCU,SADuC,qBAC7BjC,KAD6B,EACtB;gBACf,OAAO,CAAC,CAACA,KAAT;cACD;YAHsC,CAAzC;YAMA;;UAEF,KAAK,OAAL;YACE,KAAKgC,IAAL,CAAU,WAAV,EAAuBT,MAAvB,EAA+B,SAA/B,EAA0C;cACxCU,SADwC,qBAC9BjC,KAD8B,EACvB;gBACf,OAAO,CAAC,CAACA,KAAT;cACD;YAHuC,CAA1C;YAMA;QAtEJ;MAwED,CA9LM;MA+LPmC,iBA/LO,6BA+LWb,QA/LX,EA+LqBC,MA/LrB,EA+L6B;QAClC,QAAQD,QAAR;UACE,KAAK,MAAL;YACE,IAAI,KAAK1G,QAAL,CAAuB0G,QAAvB,CAAJ,EAAsC;cACpC,KAAKE,QAAL,GAAgBY,kBAAhB,CAAmC,KAAKxH,QAAL,CAAuB0G,QAAvB,CAAnC;cAEA,OAAO,KAAK1G,QAAL,CAAuB0G,QAAvB,CAAP;YACD;;YACDC,MAAM,CAACG,UAAP,CAAkB,KAAlB;YACA;;UAEF,KAAK,MAAL;YACE,IAAI,KAAK9G,QAAL,CAAuB0G,QAAvB,CAAJ,EAAsC;cACpC,KAAKS,QAAL,GAAgBK,kBAAhB,CAAmC,KAAKxH,QAAL,CAAuB0G,QAAvB,CAAnC;cAEA,OAAO,KAAK1G,QAAL,CAAuB0G,QAAvB,CAAP;YACD;;YACDC,MAAM,CAACG,UAAP,CAAkB,KAAlB;YACA;;UAEF,KAAK,OAAL;UACA,KAAK,KAAL;UACA,KAAK,MAAL;YACE,KAAKW,qBAAL,CAA2Bd,MAA3B;YACA;QAvBJ;MAyBD,CAzNM;MA2NPe,OA3NO,mBA2NCC,aA3ND,EA2NgB;QACrB,IAAIA,aAAa,YAAYrJ,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBkE,aAAjD,EAAgE;UAC9D,KAAKhB,QAAL,GAAgBiB,IAAhB,CAAqBF,aAArB;QACD;MACF,CA/NM;MAiOPxB,IAjOO,kBAiOA;QACL,IAAM9D,KAAK,GAAG,KAAKuE,QAAL,EAAd;;QACA,IAAIvE,KAAK,CAACwE,MAAN,GAAe,CAAnB,EAAsB;UACpB,IAAMc,aAAa,GAAGtF,KAAK,CAACyF,GAAN,EAAtB;;UACA,IAAIH,aAAa,CAACxB,IAAd,EAAJ,EAA0B;YACxB,KAAKgB,QAAL,GAAgBU,IAAhB,CAAqBF,aAArB;UACD,CAFD,MAEO;YACL,KAAKI,KAAL,CAAW,oBAAoBJ,aAAa,CAACV,QAAd,EAA/B;YACA5E,KAAK,CAACwF,IAAN,CAAWF,aAAX;UACD;QACF;MACF,CA5OM;MA8OPvB,IA9OO,kBA8OA;QACL,IAAM7D,KAAK,GAAG,KAAK4E,QAAL,EAAd;;QACA,IAAI5E,KAAK,CAACsE,MAAN,GAAe,CAAnB,EAAsB;UACpB,IAAMc,aAAa,GAAGpF,KAAK,CAACuF,GAAN,EAAtB;;UACA,IAAIH,aAAa,CAACvB,IAAd,EAAJ,EAA0B;YACxB,KAAKQ,QAAL,GAAgBiB,IAAhB,CAAqBF,aAArB;UACD,CAFD,MAEO;YACL,KAAKI,KAAL,CAAW,oBAAoBJ,aAAa,CAACV,QAAd,EAA/B;YACA1E,KAAK,CAACsF,IAAN,CAAWF,aAAX;UACD;QACF;MACF,CAzPM;MA2PPK,eA3PO,6BA2PW;QAChB,KAAKpB,QAAL,GACGqB,SADH,GAEGC,OAFH,CAEW,UAAAC,IAAI;UAAA,OAAIA,IAAI,CAACC,OAAL,EAAJ;QAAA,CAFf;QAGA,KAAKC,UAAL;MACD,CAhQM;MAkQPA,UAlQO,wBAkQM;QACX,KAAKlB,QAAL,GACGc,SADH,GAEGC,OAFH,CAEW,UAAAC,IAAI;UAAA,OAAIA,IAAI,CAACC,OAAL,EAAJ;QAAA,CAFf;MAGD,CAtQM;MAwQPE,eAxQO,2BAwQSlD,KAxQT,EAwQgB;QACrB,IAAI;UACF,IAAIA,KAAJ,EAAW;YACTmD,SAAS,CAACnG,SAAV,CAAoBoG,SAApB,CAA8BpD,KAAK,CAACqD,OAAN,GAAgBC,SAA9C;UACD,CAFD,MAEO;YACLH,SAAS,CAACnG,SAAV,CAAoBoG,SAApB,CAA8B,EAA9B;UACD;QACF,CAND,CAME,OAAOG,CAAP,EAAU;UACV;UACArK,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBC,cAArB,CAAoCkK,SAApC,GAAgDxD,KAAK,GAAGA,KAAK,CAACqD,OAAN,GAAgBC,SAAnB,GAA+B,EAApF;QACD;MACF,CAnRM;MAqRP1J,WArRO,yBAqRO;QACZ,KAAK6D,cAAL,GAAsBvE,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBoK,MAArB,CAA4BjF,WAA5B,EAAtB;MACD,CAvRM;MAyRPkF,UAzRO,sBAyRIC,IAzRJ,EAyRUC,SAzRV,EAyRqB,CAAE,CAzRvB;MA0RPC,eA1RO,2BA0RSF,IA1RT,EA0ReG,UA1Rf,EA0R2B,CAAE,CA1R7B;MA4RPC,SA5RO,qBA4RGhG,IA5RH,EA4RSiG,GA5RT,EA4Rc;QACnB,IAAIA,GAAG,IAAI,KAAKvG,cAAhB,EAAgC;UAC9B,KAAKA,cAAL,CAAoBwG,KAApB,CAA0BD,GAA1B;QACD;;QACD,IAAIjG,IAAI,IAAIA,IAAI,CAACmG,OAAL,OAAmB,MAA3B,IAAqC,KAAKC,WAAL,CAAiBpG,IAAjB,CAAzC,EAAiE;UAC/D,oEAAgBA,IAAhB,EAAsBiG,GAAtB;QACD,CAFD,MAEO;UACL,oEAAgB,IAAhB,EAAsBA,GAAtB;;UACA,IAAI,KAAKI,eAAL,CAAqB,SAArB,CAAJ,EAAqC;YACnC,KAAKnE,eAAL,CAAqB,SAArB,EAAgCoE,SAAhC;UACD;;UACD,KAAKC,iBAAL;QACD;MACF,CAzSM;MA2SP;MACAC,uBA5SO,mCA4SiBC,EA5SjB,EA4SqBC,IA5SrB,EA4S2B;QAAA;;QAChC,IAAIC,OAAJ;;QAEA,QAAQF,EAAR;UACE,KAAK,WAAL;YACEE,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMwL,SAAN,CAAgBC,SAApB,CAA8B,IAAIjM,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAaoL,IAAjB,EAA9B,CAAV;;YACA,KAAKC,IAAL,CAAUJ,OAAV;;YACA;;UAEF,KAAK,MAAL;YACEA,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMwL,SAAN,CAAgBC,SAApB,CAA8B,IAAIjM,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAasL,MAAjB,EAA9B,CAAV;YACA,KAAK9E,eAAL,CAAqB,WAArB,EAAkC+E,KAAlC,CAAwCN,OAAxC,EAAiD,CAAjD;YACA;;UAEF,KAAK,OAAL;YACEA,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMwL,SAAN,CAAgBC,SAApB,CAA8B,IAAIjM,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAawL,IAAjB,EAA9B,CAAV;;YACA,IAAI,CAAC,KAAKC,aAAL,EAAL,EAA2B;cACzBR,OAAO,CAACS,OAAR;YACD;;YACD,KAAKlF,eAAL,CAAqB,WAArB,EAAkC+E,KAAlC,CAAwCN,OAAxC,EAAiD,CAAjD,EAAoD;cAAEnE,IAAI,EAAE;YAAR,CAApD;YACA;;UAEF,KAAK,SAAL;YACEmE,OAAO,GAAG,IAAIxL,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcgM,MAAd,CAAqBC,MAAzB,EAAV;YACAX,OAAO,CAACY,GAAR,CAAY;cACVC,MAAM,EAAE,QADE;cAEVC,QAAQ,EAAE;YAFA,CAAZ;YAKA,KAAKvF,eAAL,CAAqB,OAArB,EAA8B+E,KAA9B,CAAoCN,OAApC,EAA6C,CAA7C,EAAgD;cAAEnE,IAAI,EAAE;YAAR,CAAhD;YACA;;UAEF,KAAK,mBAAL;YAA0B;cACxB,IAAMkF,EAAE,GAAG,KAAKhK,EAAL,CAAQ,8DAAR,CAAX;cAEA,IAAMiK,MAAM,GAAG,KAAKjK,EAAL,CAAQ,gDAAR,CAAf;cAEA,IAAMkK,KAAK,GAAG,KAAKlK,EAAL,CACZ,kJADY,CAAd;cAIAiJ,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMyM,KAAN,CAAYC,IAAhB,CAAqBJ,EAArB,EAAyBvM,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,OAA7B,EAAsC,EAAtC,CAAzB,CAAV;cAEA4I,OAAO,CAACoB,OAAR,CAAgB,IAAhB;cACApB,OAAO,CAACzE,eAAR,CAAwB,OAAxB,EAAiC8F,OAAjC,CAAyC,IAAzC;cACArB,OAAO,CAACxK,WAAR,CAAoB,KAApB,EAA2B,YAAM;gBAC/B,IAAI,CAAC,MAAI,CAAC4E,eAAL,EAAD,IAA2B,MAAI,CAACoG,aAAL,EAA/B,EAAqD;kBACnD,MAAI,CAACvE,cAAL;gBACD;cACF,CAJD;cAKA,KAAKV,eAAL,CAAqB,OAArB,EAA8B+E,KAA9B,CAAoCN,OAApC,EAA6C,CAA7C;cACA,KAAKxK,WAAL,CAAiB,qBAAjB,EAAwC,UAAAC,EAAE,EAAI;gBAC5C,QAAQA,EAAE,CAACC,OAAH,EAAR;kBACE,KAAK,QAAL;oBACEsK,OAAO,CAACY,GAAR,CAAY;sBACVU,KAAK,EAAEP,EADG;sBAEVQ,IAAI,EAAE/M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,OAA7B,EAAsC,EAAtC;oBAFI,CAAZ;oBAKA4I,OAAO,CAACzE,eAAR,CAAwB,MAAxB,EAAgCiG,WAAhC,CAA4C,OAA5C;oBACAxB,OAAO,CAACzE,eAAR,CAAwB,MAAxB,EAAgCiG,WAAhC,CAA4C,SAA5C;oBACA;;kBAEF,KAAK,SAAL;oBACExB,OAAO,CAACY,GAAR,CAAY;sBACVU,KAAK,EAAEN,MADG;sBAEVO,IAAI,EAAE/M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,aAA7B,EAA4C,EAA5C;oBAFI,CAAZ;oBAKA4I,OAAO,CAACzE,eAAR,CAAwB,MAAxB,EAAgCiG,WAAhC,CAA4C,OAA5C;oBACAxB,OAAO,CAACzE,eAAR,CAAwB,MAAxB,EAAgCkG,QAAhC,CAAyC,SAAzC;oBACA;;kBAEF,KAAK,kBAAL;oBACEzB,OAAO,CAACY,GAAR,CAAY;sBACVU,KAAK,EAAEL,KADG;sBAEVM,IAAI,EAAE/M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,aAA7B,EAA4C,EAA5C;oBAFI,CAAZ;oBAKA4I,OAAO,CAACzE,eAAR,CAAwB,MAAxB,EAAgCkG,QAAhC,CAAyC,OAAzC;oBACAzB,OAAO,CAACzE,eAAR,CAAwB,MAAxB,EAAgCiG,WAAhC,CAA4C,SAA5C;oBACA;gBA7BJ;cA+BD,CAhCD;cAiCA;YACD;;UAED,KAAK,aAAL;YACExB,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMiN,OAAN,CAAcC,MAAlB,CAAyB,IAAzB,EAA+BnN,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,EAArC,CAA/B,CAAV;YAEA4I,OAAO,CAAChD,UAAR,CAAmB,KAAnB;YACAgD,OAAO,CAACxK,WAAR,CAAoB,SAApB,EAA+B,KAAKoM,OAApC,EAA6C,IAA7C;YACA,KAAKtE,IAAL,CAAU,gBAAV,EAA4B0C,OAA5B,EAAqC,MAArC,EAA6C;cAC3CzC,SAD2C,qBACjCjC,KADiC,EAC1B;gBACf,OAAOA,KAAK,GAAG9G,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,EAArC,CAAH,GAA8C5C,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,EAArC,CAA1D;cACD;YAH0C,CAA7C;YAMA,KAAKmE,eAAL,CAAqB,SAArB,EAAgCsG,GAAhC,CAAoC7B,OAApC;YACA;;UAEF,KAAK,eAAL;YACEA,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMiN,OAAN,CAAcC,MAAlB,CAAyB,IAAzB,EAA+BnN,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,QAA7B,EAAuC,EAAvC,CAA/B,CAAV;YAEA4I,OAAO,CAAChD,UAAR,CAAmB,KAAnB;YACAgD,OAAO,CAACxK,WAAR,CAAoB,SAApB,EAA+B,KAAKsM,SAApC,EAA+C,IAA/C;YACA,KAAKvG,eAAL,CAAqB,SAArB,EAAgCsG,GAAhC,CAAoC7B,OAApC;YACA;;UAEF,KAAK,eAAL;YACEA,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMiN,OAAN,CAAcK,QAAlB,CAA2B,KAAKhL,EAAL,CAAQ,YAAR,CAA3B,EAAkDvC,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,QAA7B,EAAuC,EAAvC,CAAlD,CAAV;YAEA4I,OAAO,CAACxK,WAAR,CAAoB,SAApB,EAA+B,YAAM;cACnC,MAAI,CAACwM,YAAL;YACD,CAFD;YAGA,KAAKzG,eAAL,CAAqB,SAArB,EAAgCsG,GAAhC,CAAoC7B,OAApC;YACA;;UAEF,KAAK,iBAAL;YACEA,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMiN,OAAN,CAAcC,MAAlB,CAAyB,IAAzB,EAA+BnN,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,QAA7B,EAAuC,EAAvC,CAA/B,CAAV;YAEA4I,OAAO,CAAC/C,cAAR,CAAuB,KAAKlG,EAAL,CAAQ,gBAAR,CAAvB;YACAiJ,OAAO,CAACxK,WAAR,CAAoB,SAApB,EAA+B,KAAKyG,cAApC,EAAoD,IAApD;YACA,KAAKqB,IAAL,CAAU,aAAV,EAAyB0C,OAAzB,EAAkC,YAAlC,EAAgD;cAC9CzC,SAD8C,qBACpCjC,KADoC,EAC7B;gBACf,OAAOA,KAAK,GAAG,SAAH,GAAe,QAA3B;cACD;YAH6C,CAAhD;YAMA,KAAKgC,IAAL,CAAU,cAAV,EAA0B0C,OAA1B,EAAmC,SAAnC,EAA8C;cAC5CzC,SAD4C,qBAClCjC,KADkC,EAC3B;gBACf,OAAOA,KAAK,KAAK,QAAjB;cACD;YAH2C,CAA9C;YAMA,KAAKC,eAAL,CAAqB,SAArB,EAAgCsG,GAAhC,CAAoC7B,OAApC;YACA;;UAEF,KAAK,SAAL;YACEA,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMiN,OAAN,CAAcO,OAAlB,EAAV;YACA,KAAK1G,eAAL,CAAqB,MAArB,EAA6BsG,GAA7B,CAAiC7B,OAAjC,EAA0C;cACxCkC,GAAG,EAAE,CADmC;cAExCC,IAAI,EAAE,CAFkC;cAGxCC,KAAK,EAAE;YAHiC,CAA1C;YAMA;;UAEF,KAAK,qBAAL;YACEpC,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMwL,SAAN,CAAgBC,SAApB,CAA8B,IAAIjM,EAAE,CAACQ,EAAH,CAAMM,MAAN,CAAaoL,IAAjB,EAA9B,CAAV;YACA,KAAK5E,eAAL,CAAqB,MAArB,EAA6BsG,GAA7B,CAAiC7B,OAAjC,EAA0C;cACxCkC,GAAG,EAAE,EADmC;cAExCC,IAAI,EAAE,CAFkC;cAGxCC,KAAK,EAAE;YAHiC,CAA1C;YAMA;;UAEF,KAAK,WAAL;YACEpC,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAM4N,IAAN,CAAWC,SAAf,EAAV;YACAtC,OAAO,CAACY,GAAR,CAAY;cACV2B,UAAU,EAAE,IADF;cAEVC,WAAW,EAAE,KAAKzL,EAAL,CAAQ,WAAR,CAFH;cAGV0L,MAAM,EAAE;YAHE,CAAZ;YAMAzC,OAAO,CAACxK,WAAR,CAAoB,aAApB,EAAmCvB,EAAE,CAACyO,IAAH,CAAQC,QAAR,CAAiBC,QAAjB,CAA0B,KAAKC,SAA/B,EAA0C,GAA1C,CAAnC,EAAmF,IAAnF;YAEA7C,OAAO,CAACxK,WAAR,CAAoB,OAApB,EAA6B,UAAAC,EAAE,EAAI;cACjC,QAAQA,EAAE,CAACqN,gBAAH,EAAR;gBACE,KAAK,OAAL;gBACA,KAAK,MAAL;kBACE,MAAI,CAACC,eAAL;;kBACA;;gBACF,KAAK,IAAL;kBACE,MAAI,CAACC,mBAAL;;kBACA;cAPJ;;cAUAvN,EAAE,CAACwN,eAAH;YACD,CAZD;YAaA,KAAK1H,eAAL,CAAqB,qBAArB,EAA4CsG,GAA5C,CAAgD7B,OAAhD,EAAyD;cAAEnE,IAAI,EAAE;YAAR,CAAzD;YACA;;UAEF,KAAK,MAAL;YACEmE,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMyO,IAAN,CAAWC,WAAf,CAA2B,IAA3B,EAAiC,aAAjC,EAAgD,UAAhD,CAAV;YACAnD,OAAO,CAACY,GAAR,CAAY;cACVwC,aAAa,EAAE,QADL;cAEVC,KAAK,EAAE,GAFG;cAGVC,QAAQ,EAAE,MAHA;cAIVC,UAAU,EAAEtP,EAAE,CAACkC,IAAH,CAAQqN,WAAR,CAAoBC,GAApB,CAAwB,cAAxB,IAA0C,EAA1C,GAA+C;YAJjD,CAAZ;YAOA,KAAKnG,IAAL,CAAU,gBAAV,EAA4B0C,OAA5B,EAAqC,WAArC;YACA,KAAK1C,IAAL,CAAU,gBAAV,EAA4B0C,OAA5B,EAAqC,WAArC;;YACA,KAAK0D,aAAL,CAAmB1D,OAAnB;;YACAA,OAAO,CAAC2D,WAAR,CAAoB;cAClBC,UAAU,EAAE,YAAY;gBACtB,IAAMC,IAAI,GAAG,IAAIrP,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcwO,IAAd,CAAmBY,kBAAvB,EAAb;;gBACA,IAAI,CAAC7P,EAAE,CAACkC,IAAH,CAAQqN,WAAR,CAAoBC,GAApB,CAAwB,cAAxB,CAAL,EAA8C;kBAC5CI,IAAI,CAACrO,WAAL,CAAiB,aAAjB,EAAgC,KAAKuO,cAArC,EAAqD,IAArD;gBACD,CAFD,MAEO;kBACLF,IAAI,CAACrO,WAAL,CAAiB,QAAjB,EAA2B,KAAKwO,oBAAhC,EAAsD,IAAtD;gBACD;;gBACDH,IAAI,CAACrO,WAAL,CAAiB,QAAjB,EAA2B,KAAKoM,OAAhC,EAAyC,IAAzC;gBACA,OAAOiC,IAAP;cACD,CATW,CASVvG,IATU,CASL,IATK,CADM;cAYlB;cACA2G,QAbkB,oBAaTC,UAbS,EAaGL,IAbH,EAaSM,KAbT,EAagB;gBAChCD,UAAU,CAACE,YAAX,CAAwB,EAAxB,EAA4B,OAA5B,EAAqC,IAArC,EAA2CP,IAA3C,EAAiDM,KAAjD;gBACAD,UAAU,CAACE,YAAX,CAAwB,aAAxB,EAAuC,OAAvC,EAAgD,IAAhD,EAAsDP,IAAtD,EAA4DM,KAA5D;gBAEAD,UAAU,CAACE,YAAX,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC,IAAxC,EAA8CP,IAA9C,EAAoDM,KAApD;gBACAD,UAAU,CAACG,mBAAX,CAA+B,MAA/B,EAAuC,MAAvC,EAA+C,IAA/C,EAAqDR,IAArD,EAA2DM,KAA3D;gBACAD,UAAU,CAACE,YAAX,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC,IAAxC,EAA8CP,IAA9C,EAAoDM,KAApD;gBACAD,UAAU,CAACE,YAAX,CAAwB,gBAAxB,EAA0C,UAA1C,EAAsD,IAAtD,EAA4DP,IAA5D,EAAkEM,KAAlE;gBAEAD,UAAU,CAACE,YAAX,CAAwB,UAAxB,EAAoC,UAApC,EAAgD,IAAhD,EAAsDP,IAAtD,EAA4DM,KAA5D;gBAEAD,UAAU,CAACE,YAAX,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC,IAAxC,EAA8CP,IAA9C,EAAoDM,KAApD;gBACAD,UAAU,CAACE,YAAX,CAAwB,QAAxB,EAAkC,QAAlC,EAA4C,IAA5C,EAAkDP,IAAlD,EAAwDM,KAAxD;gBACAD,UAAU,CAACE,YAAX,CAAwB,gBAAxB,EAA0C,aAA1C,EAAyD,IAAzD,EAA+DP,IAA/D,EAAqEM,KAArE;gBAEAD,UAAU,CAACE,YAAX,CAAwB,UAAxB,EAAoC,UAApC,EAAgD,IAAhD,EAAsDP,IAAtD,EAA4DM,KAA5D;cACD;YA7BiB,CAApB;YAgCAnE,OAAO,CAACsE,YAAR,GAAuB9O,WAAvB,CAAmC,QAAnC,EAA6C,KAAK+O,sBAAlD,EAA0E,IAA1E;YACA,KAAKhJ,eAAL,CAAqB,MAArB,EAA6BsG,GAA7B,CAAiC7B,OAAjC,EAA0C;cACxCkC,GAAG,EAAE,EADmC;cAExCC,IAAI,EAAE,CAFkC;cAGxCC,KAAK,EAAE,CAHiC;cAIxCoC,MAAM,EAAE;YAJgC,CAA1C;YAOA;;UAEF,KAAK,YAAL;YACExE,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAMyM,KAAN,CAAYC,IAAhB,CAAqB,IAArB,EAA2B3M,EAAE,CAACyC,KAAH,CAASC,IAAT,CAAcC,MAAd,CAAqBC,OAArB,CAA6B,KAA7B,EAAoC,EAApC,CAA3B,CAAV;YAEA4I,OAAO,CAACyE,YAAR,CAAqB,IAArB;YACAzE,OAAO,CAAC0E,aAAR,CAAsB,CAAC,EAAvB;YACA1E,OAAO,CAAC2E,SAAR,CAAkB,EAAlB;YACA,KAAKnP,WAAL,CAAiB,gBAAjB,EAAmC,UAAAC,EAAE,EAAI;cACvCuK,OAAO,CAACpE,mBAAR,CAA4B;gBAC1B4I,MAAM,EAAE,EADkB;gBAE1BrC,IAAI,EAAE1M,EAAE,CAACC,OAAH,KAAe,CAAC,IAAhB,GAAuB;cAFH,CAA5B;YAID,CALD;YAMAsK,OAAO,CAAC4E,aAAR,CAAsB,cAAtB;YACA5E,OAAO,CAACxK,WAAR,CAAoB,aAApB,EAAmC;cAAA,OAAMwK,OAAO,CAACyB,QAAR,CAAiB,SAAjB,CAAN;YAAA,CAAnC;YACAzB,OAAO,CAACxK,WAAR,CAAoB,YAApB,EAAkC;cAAA,OAAMwK,OAAO,CAACwB,WAAR,CAAoB,SAApB,CAAN;YAAA,CAAlC;YAEAxB,OAAO,CAACxK,WAAR,CAAoB,KAApB,EAA2B,YAAM;cAC/B,IAAI,MAAI,CAACqP,WAAL,EAAJ,EAAwB;gBACtB,MAAI,CAACC,SAAL,CAAe,MAAI,CAACD,WAAL,EAAf,EAAmC,QAAnC;cACD,CAFD,MAEO;gBACLE,GAAG,CAACC,MAAJ,CAAWC,MAAX,CAAkBC,KAAlB,CACE,MAAI,CAACnO,EAAL,CACE,6MADF,CADF;cAKD;YACF,CAVD;YAWA,KAAKwE,eAAL,CAAqB,MAArB,EAA6BsG,GAA7B,CAAiC7B,OAAjC,EAA0C;cACxCwE,MAAM,EAAE,EADgC;cAExCrC,IAAI,EAAE;YAFkC,CAA1C;YAKA;;UAEF,KAAK,gBAAL;YACE;YACAnC,OAAO,GAAG,IAAI/L,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAWgP,MAAf,EAAV;YACAnF,OAAO,CAACoF,YAAR,CACE,IAAInR,EAAE,CAACQ,EAAH,CAAM4Q,UAAN,CAAiBC,SAArB,GAAiC1E,GAAjC,CAAqC;cACnC2E,QAAQ,EAAE,CADyB;cAEnCC,QAAQ,EAAE,OAFyB;cAGnCC,QAAQ,EAAE;YAHyB,CAArC,CADF;YAQAzF,OAAO,CAAC0F,SAAR,CAAkB,CAAlB;YACA1F,OAAO,CAAC2F,UAAR,CAAmB,GAAnB;YACA3F,OAAO,CAAC2E,SAAR,CAAkB,GAAlB;YACA3E,OAAO,CAAC4F,YAAR,CAAqB,IAArB;YACA5F,OAAO,CAACpE,mBAAR,CAA4B;cAAEuG,IAAI,EAAE,CAAC,IAAT;cAAeD,GAAG,EAAE,CAAC;YAArB,CAA5B;YACAjO,EAAE,CAACkC,IAAH,CAAQC,IAAR,CAAaC,cAAb,GAA8BC,OAA9B,GAAwCuL,GAAxC,CAA4C7B,OAA5C;YACA;;UAEF,KAAK,cAAL;YACEA,OAAO,GAAG,IAAIxL,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcmR,WAAd,CAA0BC,aAA9B,CAA4C,IAA5C,CAAV;YACA9F,OAAO,CAACxK,WAAR,CAAoB,QAApB,EAA8B,KAAKwO,oBAAnC,EAAyD,IAAzD;YACA;QAnSJ;;QAsSA,OAAOhE,OAAO,sFAAkCF,EAAlC,CAAd;MACD,CAtlBM;MAwlBPiE,cAxlBO,0BAwlBQtO,EAxlBR,EAwlBY;QACjB,IAAMoL,MAAM,GAAGpL,EAAE,CAACsQ,gBAAH,EAAf;;QACA,IAAIlF,MAAM,YAAYrM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcwO,IAAd,CAAmBY,kBAAzC,EAA6D;UAC3D,IAAMhO,OAAO,GAAG+K,MAAM,CAACmF,QAAP,EAAhB;UACA,KAAKzK,eAAL,CAAqB,MAArB,EAA6B+I,YAA7B,GAA4C2B,OAA5C,CAAoD,CAACnQ,OAAD,CAApD;UACA,KAAKoQ,WAAL,CAAiBpQ,OAAjB;UACA,IAAMqQ,IAAI,GAAG,KAAK5K,eAAL,CAAqB,cAArB,CAAb;UACA4K,IAAI,CAACC,UAAL,CAAgBtQ,OAAhB;UACAqQ,IAAI,CAACE,aAAL,CAAmB5Q,EAAnB;QACD,CATgB,CAWjB;QACA;;;QACA,IAAIA,EAAE,CAAC6Q,UAAH,EAAJ,EAAqB;UACnB7Q,EAAE,CAAC8Q,IAAH;QACD;MACF,CAxmBM;MA0mBPvC,oBA1mBO,gCA0mBcvO,EA1mBd,EA0mBkB;QACvB,IAAMH,IAAI,GAAGG,EAAE,CAACC,OAAH,EAAb;;QACA,IAAI,KAAK0G,eAAL,CAAqB9G,IAAI,CAACkR,MAA1B,CAAJ,EAAuC;UACrC,KAAKtK,YAAL,CAAkB5G,IAAI,CAACkR,MAAvB;QACD,CAFD,MAEO;UACL,QAAQlR,IAAI,CAACkR,MAAb;YACE,KAAK,MAAL;YACA,KAAK,MAAL;cACE,KAAK5E,OAAL,CAAa,IAAb,EAAmBtM,IAAI,CAACQ,OAAxB;;cACA;;YAEF,KAAK,QAAL;cACE,KAAKgM,SAAL,CAAe,IAAf,EAAqBxM,IAAI,CAACQ,OAA1B;;cACA;;YAEF,KAAK,QAAL;cACE;cACA,KAAKgP,SAAL,CAAexP,IAAI,CAACQ,OAApB,EAA6B,QAA7B;;cACA;;YAEF;cACE,KAAKmI,KAAL,CAAW,+BAAX,EAA4C3I,IAAI,CAACkR,MAAjD;cACA;UAjBJ;QAmBD;MACF,CAnoBM;MAqoBPjC,sBAroBO,kCAqoBgB9O,EAroBhB,EAqoBoB;QACzB,IAAMH,IAAI,GAAGG,EAAE,CAACC,OAAH,EAAb;;QACA,IAAIJ,IAAI,CAACmR,KAAL,CAAW1J,MAAX,KAAsB,CAA1B,EAA6B;UAC3B,KAAKmJ,WAAL,CAAiB5Q,IAAI,CAACmR,KAAL,CAAW,CAAX,CAAjB;QACD,CAFD,MAEO;UACL,KAAKC,aAAL;QACD;MACF,CA5oBM;MA8oBPC,mBA9oBO,+BA8oBaC,QA9oBb,EA8oBuBC,IA9oBvB,EA8oB6B;QAAA;;QAClC,OAAO,IAAI9M,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;UACtC,IAAMiJ,IAAI,GAAG,MAAI,CAAC3H,eAAL,CAAqB,MAArB,CAAb;;UACA,IAAMuL,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;UACA,IAAMoI,MAAM,GAAGD,QAAQ,CAACE,aAAT,CAAuBJ,QAAvB,CAAf;;UACA,IAAIG,MAAJ,EAAY;YACV,MAAI,CAAC9N,QAAL,GAAuB,CAAC8N,MAAD,CAAvB;YACA,MAAI,CAAC7N,QAAL,GAA2B,CAA3B;;YACA,MAAI,CAAC+N,QAAL;;YACA,IAAIJ,IAAJ,EAAU;cACR,MAAI,CAACjF,OAAL;YACD;;YACD5H,OAAO,CAAC,IAAD,CAAP;UACD,CARD,MAQO;YACLA,OAAO,CAAC,KAAD,CAAP;UACD;QACF,CAfM,CAAP;MAgBD,CA/pBM;MAiqBP6I,SAjqBO,qBAiqBGpN,EAjqBH,EAiqBO;QACZ,IAAM6F,KAAK,GAAG7F,EAAE,CAACC,OAAH,EAAd;QACA,KAAKuD,QAAL,GAAuB,EAAvB;QACA,KAAKC,QAAL,GAA2B,CAA3B;;QACA,IAAIoC,KAAK,CAACyB,MAAN,GAAe,CAAnB,EAAsB;UACpB,IAAMmG,IAAI,GAAG,KAAK3H,eAAL,CAAqB,MAArB,CAAb;UACA,IAAMuL,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;UACA,KAAK1F,QAAL,GAAuB1D,KAAK,CAAC2R,IAAN,CAAWJ,QAAQ,CAACK,gBAAT,CAA0B,GAA1B,CAAX,EAA2CC,MAA3C,CAAkD,UAAUC,EAAV,EAAc;YACrF,OAAOA,EAAE,CAACC,OAAH,CAAWhO,UAAX,CAAsBgC,KAAtB,KAAiC+L,EAAE,CAACE,YAAH,CAAgB,MAAhB,KAA2BF,EAAE,CAACG,YAAH,CAAgB,MAAhB,EAAwBlO,UAAxB,CAAmCgC,KAAnC,CAAnE;UACD,CAFsB,CAAvB;;UAGA,KAAK2L,QAAL;QACD;MACF,CA7qBM;MA+qBPlE,eA/qBO,6BA+qBW;QAChB,IAAI,KAAK9J,QAAL,IAAwB,KAAKA,QAAL,CAAqB8D,MAArB,GAA8B,KAAK7D,QAAL,GAA2B,CAArF,EAAwF;UACtF,KAAKA,QAAL;;UACA,KAAK+N,QAAL;QACD;MACF,CAprBM;MAsrBPjE,mBAtrBO,iCAsrBe;QACpB,IAAI,KAAK/J,QAAL,IAAwB,KAAKC,QAAL,GAA2B,CAAvD,EAA0D;UACxD,KAAKA,QAAL;;UACA,KAAK+N,QAAL;QACD;MACF,CA3rBM;MA6rBPA,QA7rBO,sBA6rBc;QACnB,IAAI,KAAKhO,QAAL,CAAqB8D,MAArB,GAA8B,KAAK7D,QAAvC,EAA4D;UAC1D;UACA,IAAMuO,UAAU,GAAG,KAAKxO,QAAL,CAAqB,KAAKC,QAA1B,CAAnB;UACA,IAAMgK,IAAI,GAAG,KAAK3H,eAAL,CAAqB,MAArB,CAAb;;UACA,IAAIkM,UAAU,CAACC,QAAf,EAAyB;YACvBxE,IAAI,CAACyE,kBAAL,CAAwBF,UAAU,CAACC,QAAnC;YACAxE,IAAI,CAACoB,YAAL,GAAoB2B,OAApB,CAA4B,CAACwB,UAAU,CAACC,QAAZ,CAA5B;UACD,CAHD,MAGO;YACL,IAAIE,OAAO,GAAGH,UAAd;YACA,IAAMI,SAAS,GAAG,EAAlB,CAFK,CAGL;;YACA,OAAOD,OAAO,IAAI,CAACA,OAAO,CAACF,QAA3B,EAAqC;cACnCE,OAAO,GAAGA,OAAO,CAACE,aAAlB;;cACA,IAAIF,OAAJ,EAAa;gBACXC,SAAS,CAAC9J,IAAV,CAAe6J,OAAf;cACD;YACF;;YACD,IAAIA,OAAO,IAAIA,OAAO,CAACF,QAAvB,EAAiC;cAC/BE,OAAO,CAACF,QAAR,CAAiBK,IAAjB,GAD+B,CAE/B;;cACA,KAAK,IAAIC,CAAC,GAAGH,SAAS,CAAC9K,MAAV,GAAmB,CAAhC,EAAmCiL,CAAC,IAAI,CAAxC,EAA2CA,CAAC,EAA5C,EAAgD;gBAC9C,IAAMC,CAAC,GAAGJ,SAAS,CAACG,CAAD,CAAT,CAAaN,QAAvB;;gBACA,IAAIO,CAAJ,EAAO;kBACLA,CAAC,CAACF,IAAF;gBACD;cACF;;cACD,IAAIN,UAAU,CAACC,QAAf,EAAyB;gBACvBxE,IAAI,CAACyE,kBAAL,CAAwBF,UAAU,CAACC,QAAnC;gBACAxE,IAAI,CAACoB,YAAL,GAAoB2B,OAApB,CAA4B,CAACwB,UAAU,CAACC,QAAZ,CAA5B;cACD;YACF;UACF;QACF;MACF,CA/tBM;MAiuBPhE,aAjuBO,yBAiuBO1D,OAjuBP,EAiuBgB;QAAA;;QACrB,IAAIkI,iBAAJ;QACAlI,OAAO,CAACxK,WAAR,CAAoB,WAApB,EAAiC,UAAAC,EAAE,EAAI;UACrC,IAAM0S,UAAU,GAAG1S,EAAE,CAAC2S,aAAH,EAAnB;UACA,IAAItS,OAAJ;;UACA,IAAIqS,UAAU,YAAY3T,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcwO,IAAd,CAAmBY,kBAA7C,EAAiE;YAC/DhO,OAAO,GAAGqS,UAAU,CAACnC,QAAX,EAAV;YACAlQ,OAAO,CAACuS,WAAR,CAAoB,IAApB;;YACA,IAAI,CAACvS,OAAO,CAACwS,UAAR,EAAD,IAAyB,CAACxS,OAAO,CAAC0H,WAAR,EAA9B,EAAqD;cACnD/H,EAAE,CAAC8S,cAAH;cACA9S,EAAE,CAACwN,eAAH;cACA;YACD;;YACDxN,EAAE,CAAC+S,SAAH,CAAa,MAAb;;YACA,IAAI1S,OAAO,CAAC0H,WAAR,EAAJ,EAA2B;cACzB/H,EAAE,CAAC+S,SAAH,CAAa,MAAb;YACD;;YACD/S,EAAE,CAACgT,OAAH,CAAW,iBAAX;YACAhT,EAAE,CAACiT,OAAH,CAAW,iBAAX,EAA8B5S,OAA9B;YACAoS,iBAAiB,GAAGpS,OAApB;UACD;;UACD,MAAI,CAACuS,WAAL,CAAiB,IAAjB;QACD,CApBD;QAsBA,IAAMM,SAAS,GAAG,KAAKpN,eAAL,CAAqB,YAArB,CAAlB;QACAoN,SAAS,CAACnT,WAAV,CAAsB,WAAtB,EAAmC,UAAAC,EAAE,EAAI;UACvCA,EAAE,CAAC+S,SAAH,CAAa,MAAb;UACA/S,EAAE,CAACgT,OAAH,CAAW,qBAAX;;UACA,MAAI,CAACJ,WAAL,CAAiB,IAAjB;QACD,CAJD;QAMA,IAAMhR,OAAO,GAAG7C,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BvR,OAA1C;QACA,IAAMwR,QAAQ,GAAG;UACfC,IAAI,EAAE,CADS;UAEfjI,MAAM,EAAE;QAFO,CAAjB;QAKAb,OAAO,CAACxK,WAAR,CAAoB,UAApB,EAAgC,UAAAC,EAAE,EAAI;UACpC;UACA,IAAI+Q,MAAM,GAAG/Q,EAAE,CAACsT,gBAAH,EAAb;UACA,IAAIjT,OAAJ;;UACA,IAAIL,EAAE,CAACuT,YAAH,CAAgB,iBAAhB,CAAJ,EAAwC;YACtClT,OAAO,GAAGL,EAAE,CAACC,OAAH,CAAW,iBAAX,CAAV;UACD;;UACD,IAAMuT,MAAM,GAAGzC,MAAM,KAAK,MAAX,IAAqB,CAAC1Q,OAAtB,IAAiCL,EAAE,CAACuT,YAAH,CAAgB,qBAAhB,CAAhD;UACA,IAAInI,MAAM,GAAGpL,EAAE,CAACyT,SAAH,EAAb;;UACA,IAAIrI,MAAM,KAAKsI,SAAf,EAA0B;YACxB;YACA,MAAI,CAACC,KAAL,CAAW,yBAAX;;YACA;UACD;;UACD,IAAI5C,MAAM,KAAK,MAAX,IAAqB3F,MAArB,IAA+BA,MAAM,YAAYrM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcwO,IAAd,CAAmBY,kBAAxE,EAA4F;YAC1F,IAAIjD,MAAM,CAACmF,QAAP,OAAsBlQ,OAA1B,EAAmC;cACjC;cACA,MAAI,CAACsT,KAAL,CAAW,oCAAX;;cACAP,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACC,IAAxB;cACA7B,EAAE,CAAC8S,cAAH;cACA;YACD,CAND,MAMO,IAAIzS,OAAO,IAAIA,OAAO,CAACuT,UAAR,CAAmBxI,MAAM,CAACmF,QAAP,EAAnB,CAAf,EAAsD;cAC3D;cACA,MAAI,CAACoD,KAAL,CAAW,qCAAX;;cACAP,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACC,IAAxB;cACA7B,EAAE,CAAC8S,cAAH;cACA;YACD;UACF;;UACD,IAAI1H,MAAM,KAAKb,OAAf,EAAwB;YACtB,IAAMsJ,YAAY,GAAGtJ,OAAO,CAACuJ,OAAR,GAAkBC,SAAlB,GAA8B,CAA9B,EAAiCC,kBAAjC,EAArB;;YACA,IAAIH,YAAY,IAAI7T,EAAE,CAACiU,cAAH,KAAsBJ,YAAY,CAAC9E,MAAnC,IAA6C,EAAjE,EAAqE;cACnE;cACA,IAAMmF,QAAQ,GAAGC,QAAQ,CAACC,gBAAT,CACfC,IAAI,CAACC,KAAL,CAAW,CAACT,YAAY,CAACnH,IAAb,GAAoBmH,YAAY,CAAClH,KAAlC,IAA2C,CAAtD,CADe,EAEfkH,YAAY,CAAC9E,MAAb,GAAsB,EAFP,CAAjB;cAKA3D,MAAM,GAAG5M,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAWgP,MAAX,CAAkB6E,kBAAlB,CAAqCL,QAArC,CAAT;;cACA,IAAI9I,MAAJ,EAAY;gBACV,OAAOA,MAAM,CAACoJ,WAAP,EAAP,EAA6B;kBAC3BpJ,MAAM,GAAGA,MAAM,CAACqJ,eAAP,EAAT;gBACD;cACF;YACF,CAbD,MAaO;cACLrJ,MAAM,GAAG,IAAT;YACD;;YACD,IAAI,CAACA,MAAD,IAAWA,MAAM,KAAKb,OAA1B,EAAmC;cACjC6I,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACC,IAAxB;cACA7B,EAAE,CAAC8S,cAAH;;cACA,MAAI,CAACa,KAAL,CAAW,uBAAX;;cACA;YACD;UACF;;UACD,IAAI,CAACH,MAAD,IAAW,CAACnT,OAAhB,EAAyB;YACvB;YACA,MAAI,CAACsT,KAAL,CAAW,wCAAX;;YACAP,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACC,IAAxB;YACA7B,EAAE,CAAC8S,cAAH;YACA;UACD;;UACD,IAAM3O,KAAK,GAAGiH,MAAM,CAACmF,QAAP,EAAd;UACA,IAAMmE,MAAM,GAAGvQ,KAAK,CAACwQ,SAAN,EAAf;UACAvB,QAAQ,CAAChI,MAAT,GAAkBjH,KAAlB;;UAEA,IAAIuQ,MAAJ,EAAY;YACV,IAAME,mBAAmB,GAAGF,MAAM,CAACG,gBAAP,EAA5B;;YACA,IAAIrB,MAAJ,EAAY;cACV,IAAMsB,eAAe,GAAGF,mBAAmB,CAACG,kBAApB,EAAxB;;cACA,IAAIhR,MAAM,CAACiR,IAAP,CAAYF,eAAZ,EAA6BxN,MAA7B,GAAsC,CAA1C,EAA6C;gBAC3C;gBACA,IAAM2N,OAAO,GAAGP,MAAM,CAACQ,kBAAP,EAAhB;;gBACA,IAAID,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;kBACtB;kBACA,IAAIsN,mBAAmB,CAACO,mBAApB,EAAJ,EAA+C;oBAC7C;oBACA;oBACA/B,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACE,MAAR,GAAiBF,OAAO,CAACG,KAAzC;kBACD,CAJD,MAIO;oBACL,IAAIqT,GAAG,GAAGxT,OAAO,CAACC,IAAlB;oBACA,IAAMwT,cAAc,GAAGT,mBAAmB,CAACU,yBAApB,EAAvB;oBACAL,OAAO,CAAC7U,IAAR,CAAa,UAAAmV,WAAW,EAAI;sBAC1BH,GAAG,IAAI,MAAI,CAACI,QAAL,CAA2BH,cAA3B,EAA2CE,WAA3C,EAAwDpR,KAAK,CAACsR,OAAN,EAAxD,CAAP;;sBAEA,IAAIL,GAAG,GAAGxT,OAAO,CAACE,MAAd,IAAwBsT,GAAG,GAAGxT,OAAO,CAACG,KAA1C,EAAiD;wBAC/C;wBACA,OAAO,IAAP;sBACD;;sBACD,OAAO,KAAP;oBACD,CARD;oBASAqR,QAAQ,CAACC,IAAT,GAAgB+B,GAAhB;kBACD;gBACF;cACF,CAxBD,MAwBO;gBACLpV,EAAE,CAAC8S,cAAH,GADK,CAEL;;gBACAM,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACC,IAAxB;;gBACA,MAAI,CAAC8R,KAAL,CAAW,0BAAX;cACD;YACF,CAhCD,MAgCO,IAAI,CAACiB,mBAAmB,CAACc,qBAApB,CAA0CrV,OAAO,CAACoV,OAAR,EAA1C,CAAL,EAAmE;cACxE;cACArC,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACC,IAAxB;;cACA,MAAI,CAAC8R,KAAL,CAAW,iCAAX,EAA8Ce,MAAM,CAACe,OAAP,EAA9C;YACD,CAJM,MAIA,IAAIb,mBAAmB,CAACO,mBAApB,EAAJ,EAA+C;cACpD;cACA;cACA/B,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACE,MAAR,GAAiBF,OAAO,CAACG,KAAzC;YACD,CAJM,MAIA;cACL;cACAqR,QAAQ,CAACC,IAAT,GAAgB,MAAI,CAACmC,QAAL,CACdZ,mBAAmB,CAACU,yBAApB,EADc,EAEdjV,OAAO,CAACoV,OAAR,EAFc,EAGdtR,KAAK,CAACsR,OAAN,EAHc,CAAhB;YAKD;UACF,CAlDD,MAkDO;YACLrC,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACC,IAAxB;UACD;;UACD,IAAI8T,UAAJ;;UACA,IAAInC,MAAJ,EAAY;YACVmC,UAAU,GAAG5R,MAAM,CAACiR,IAAP,CAAY7Q,KAAK,CAAC0Q,gBAAN,GAAyBE,kBAAzB,CAA4C,IAA5C,CAAZ,EAA+DzN,MAA/D,GAAwE,CAArF;UACD,CAFD,MAEO;YACLqO,UAAU,GAAGxR,KAAK,CAAC0Q,gBAAN,GAAyBa,qBAAzB,CAA+CrV,OAAO,CAACoV,OAAR,EAA/C,CAAb;UACD;;UACD,IAAIE,UAAJ,EAAgB;YACd;YACAvC,QAAQ,CAACC,IAAT,IAAiBzR,OAAO,CAACI,MAAzB;;YACA,IAAImC,KAAK,CAAC0Q,gBAAN,GAAyBM,mBAAzB,EAAJ,EAAoD;cAClD/B,QAAQ,CAACC,IAAT,IAAiBzR,OAAO,CAACK,WAAzB;YACD,CAFD,MAEO;cACL,IAAMoT,eAAc,GAAGlR,KAAK,CAAC0Q,gBAAN,GAAyBe,2BAAzB,EAAvB;;cACA,IAAIP,eAAJ,EAAoB;gBAClB,IAAIhV,OAAJ,EAAa;kBACX,IAAIwV,cAAc,GAAGR,eAAc,CAAChV,OAAO,CAACoV,OAAR,EAAD,CAAnC;;kBACA,IAAII,cAAc,KAAKC,SAAvB,EAAkC;oBAChC,IAAID,cAAc,KAAK,CAAnB,IAAwB1R,KAAK,CAAC4R,WAAN,GAAoBzO,MAApB,KAA+B,CAA3D,EAA8D;sBAC5D8L,QAAQ,CAACC,IAAT,IAAiBzR,OAAO,CAACK,WAAzB;oBACD,CAFD,MAEO;sBACL;sBACA,IAAM+T,UAAU,GAAG7R,KAAK,CAAC4R,WAAN,GAAoBtO,OAApB,CAA4B,CAA5B,CAAnB;;sBACA,IAAMwO,WAAW,GAAGZ,eAAc,CAACW,UAAU,CAACP,OAAX,EAAD,CAAlC;;sBACA,IAAIQ,WAAW,IAAIJ,cAAnB,EAAmC;wBACjCzC,QAAQ,CAACC,IAAT,IAAiBzR,OAAO,CAACK,WAAzB;sBACD;oBACF;kBACF;gBACF,CAdD,MAcO,IAAIkC,KAAK,CAAC4R,WAAN,GAAoBzO,MAApB,GAA6B,CAAjC,EAAoC;kBACzC,IAAM0O,WAAU,GAAG7R,KAAK,CAAC4R,WAAN,GAAoBtO,OAApB,CAA4B,CAA5B,CAAnB;;kBACA,IAAIyO,kBAAkB,GAAGb,eAAc,CAACW,WAAU,CAACP,OAAX,EAAD,CAAvC;;kBACA,IAAIS,kBAAkB,KAAKJ,SAAvB,IAAoCI,kBAAkB,GAAG,CAA7D,EAAgE;oBAC9D;oBACA9C,QAAQ,CAACC,IAAT,IAAiBzR,OAAO,CAACK,WAAzB;kBACD;gBACF,CAPM,MAOA,IAAI8B,MAAM,CAACiR,IAAP,CAAYK,eAAZ,EAA4B/N,MAA5B,GAAqC,CAAzC,EAA4C;kBACjD;kBACA8L,QAAQ,CAACC,IAAT,IAAiBzR,OAAO,CAACK,WAAzB;gBACD;cACF;YACF;UACF;;UACD,IAAImR,QAAQ,CAACC,IAAT,KAAkBzR,OAAO,CAACC,IAA9B,EAAoC;YAClC7B,EAAE,CAAC8S,cAAH;;YACA,MAAI,CAACa,KAAL,CAAW,4BAAX;UACD;QACF,CApKD;QAsKA,IAAMD,SAAS,GAAG,KAAK5N,eAAL,CAAqB,gBAArB,CAAlB;QAEA,IAAIqQ,WAAJ;QAEA5L,OAAO,CAACxK,WAAR,CAAoB,WAApB,EAAiC,UAAAC,EAAE,EAAI;UACrC,IAAImW,WAAJ,EAAiB;YACfA,WAAW,CAACrF,IAAZ;YACAqF,WAAW,GAAG,IAAd;UACD;QACF,CALD;QAOA,IAAIC,YAAJ;QACA,IAAMC,aAAa,GAAG9L,OAAO,CAACuJ,OAAR,EAAtB;;QAEA,IAAMwC,MAAM,GAAG,SAATA,MAAS,CAAUtW,EAAV,EAAc;UAC3B,IAAI0M,IAAI,GAAG,CAAC,IAAZ;UACA,IAAID,GAAG,GAAG,CAAC,IAAX;UACA,IAAI8J,QAAQ,GAAG,EAAf;UACA,IAAIC,MAAM,GAAGxW,EAAE,CAACyW,UAAH,GAAgBC,SAAhB,EAAb;;UACA,IAAI,CAACF,MAAL,EAAa;YACXA,MAAM,GAAGhY,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAWiW,cAAX,CAA0BtS,WAA1B,EAAT;UACD;;UACD,IAAIrE,EAAE,CAAC4W,OAAH,CAAWC,WAAX,KAA2B,OAA/B,EAAwC;YACtC,IAAI,CAACL,MAAM,CAACM,QAAP,CAAgB,OAAhB,CAAL,EAA+B;cAC7BN,MAAM,CAACxK,QAAP,CAAgB,OAAhB;YACD;UACF;;UAED,IAAIoH,QAAQ,CAACC,IAAT,KAAkBzR,OAAO,CAACC,IAA9B,EAAoC;YAClC,IAAMkV,QAAQ,GAAG5C,QAAQ,CAACC,gBAAT,CAA0BpU,EAAE,CAACgX,eAAH,EAA1B,EAAgDhX,EAAE,CAACiU,cAAH,EAAhD,CAAjB;YAEA,IAAIgD,IAAI,GAAGzY,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAWgP,MAAX,CAAkB6E,kBAAlB,CAAqCwC,QAArC,CAAX;YACA,IAAIG,aAAa,GAAG,KAApB;;YACA,IAAI,CAACD,IAAL,EAAW;cACT;YACD;;YACD,OAAOA,IAAI,CAACzC,WAAL,EAAP,EAA2B;cACzByC,IAAI,GAAGA,IAAI,CAACxC,eAAL,EAAP;YACD;;YAED,IAAM0C,UAAU,GAAGF,IAAI,CAACjD,kBAAL,EAAnB;YACA,IAAIoD,OAAO,GAAGD,UAAU,CAACzK,IAAzB;;YACA,IAAIuK,IAAI,YAAYlY,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcwO,IAAd,CAAmBY,kBAAvC,EAA2D;cACzD,IAAMgJ,MAAM,GAAGJ,IAAI,CAACK,YAAL,GAAoB,CAApB,CAAf;;cACAF,OAAO,GAAGC,MAAM,CAAClS,QAAP,KAAoB8R,IAAI,CAACM,cAAL,EAA9B;cACA7D,SAAS,CAAC8D,QAAV,CAAmBP,IAAI,CAACQ,SAAL,GAAiB7J,KAAjB,GAAyBwJ,OAA5C;;cACA,IAAIhE,QAAQ,CAAChI,MAAT,IAAmB6L,IAAI,CAAC1G,QAAL,OAAoB6C,QAAQ,CAAChI,MAApD,EAA4D;gBAC1D8L,aAAa,GAAG,IAAhB;cACD;;cACDd,YAAY,GAAGa,IAAf;YACD,CARD,MAQO,IAAIA,IAAI,KAAKvD,SAAb,EAAwB;cAC7B,IAAIuD,IAAI,KAAKZ,aAAb,EAA4B;gBAC1B,IAAMqB,UAAU,GAAGtB,YAAY,CAACpC,kBAAb,EAAnB;gBACA,IAAM2D,QAAQ,GAAG3X,EAAE,CAACiU,cAAH,KAAsByD,UAAU,CAAC3I,MAAlD;;gBACA,IAAI4I,QAAQ,IAAI,EAAZ,IAAkBvE,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACG,KAA9C,EAAqD;kBACnD,IAAMsV,OAAM,GAAGjB,YAAY,CAACkB,YAAb,GAA4B,CAA5B,CAAf;;kBACA5K,IAAI,GAAG2K,OAAM,CAAClS,QAAP,KAAoBiR,YAAY,CAACmB,cAAb,EAA3B;kBACA9K,GAAG,GAAGiL,UAAU,CAAC3I,MAAjB;kBACAwH,QAAQ,GAAG,OAAX;gBACD;;gBACDW,aAAa,GAAG,IAAhB;cACD,CAVD,MAUO;gBACLA,aAAa,GAAG,IAAhB;cACD;YACF,CAdM,MAcA;cACL;cACA;YACD;;YACD,IAAI,CAACA,aAAL,EAAoB;cAClB,IAAIlX,EAAE,CAACiU,cAAH,KAAsBkD,UAAU,CAAC1K,GAAjC,IAAwC,CAA5C,EAA+C;gBAC7C;gBACA,IAAI0J,WAAJ,EAAiB;kBACfA,WAAW,CAACrF,IAAZ;kBACAqF,WAAW,GAAG,IAAd;gBACD,CAL4C,CAM7C;;;gBACA,IAAI/C,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACE,MAA5B,EAAoC;kBAClC4K,IAAI,GAAG0K,OAAP;kBACA3K,GAAG,GAAG0K,UAAU,CAAC1K,GAAjB;kBACA8J,QAAQ,GAAG,QAAX;gBACD,CAJD,MAIO,IAAInD,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACI,MAA5B,EAAoC;kBACzC0K,IAAI,GAAG,CAAC,IAAR;kBACAD,GAAG,GAAG,CAAC,IAAP;kBACA8J,QAAQ,GAAG,QAAX;gBACD;cACF,CAhBD,MAgBO,IAAIY,UAAU,CAACpI,MAAX,GAAoB/O,EAAE,CAACiU,cAAH,EAApB,IAA2C,CAA/C,EAAkD;gBACvD;gBACA,IAAIb,QAAQ,CAAChI,MAAT,IAAmB,CAACgI,QAAQ,CAAChI,MAAT,CAAgBwM,MAAhB,EAAxB,EAAkD;kBAChD,IAAIxE,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACG,KAA5B,EAAmC;oBACjC2K,IAAI,GAAG0K,OAAP;oBACA3K,GAAG,GAAG0K,UAAU,CAACpI,MAAjB;oBACAwH,QAAQ,GAAG,OAAX;kBACD,CAJD,MAIO,IAAInD,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACI,MAA5B,EAAoC;oBACzC0K,IAAI,GAAG,CAAC,IAAR;oBACAD,GAAG,GAAG,CAAC,IAAP;oBACA8J,QAAQ,GAAG,QAAX;kBACD;gBACF,CAVD,MAUO;kBACL;kBACA;kBACA,IAAInD,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACK,WAA5B,EAAyC;oBACvCyK,IAAI,GAAG0K,OAAO,GAAG,EAAjB;oBACA1D,SAAS,CAAC8D,QAAV,CAAmB9D,SAAS,CAACvO,QAAV,KAAuB,EAA1C;oBACAsH,GAAG,GAAG0K,UAAU,CAACpI,MAAjB;oBACAwH,QAAQ,GAAG,aAAX;kBACD,CALD,MAKO;oBACL,KAAK5C,KAAL,CAAW,4BAAX;kBACD;gBACF;;gBACD,IAAIwC,WAAJ,EAAiB;kBACfA,WAAW,CAACrF,IAAZ;kBACAqF,WAAW,GAAG,IAAd;gBACD;cACF,CA5BM,MA4BA;gBACL;gBACA;gBACA,IAAI/C,QAAQ,CAAChI,MAAT,IAAmBgI,QAAQ,CAAChI,MAAT,CAAgBwM,MAAhB,EAAvB,EAAiD;kBAC/C;kBACA,IAAIxE,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACK,WAA5B,EAAyC;oBACvC,IAAIyR,SAAS,CAACmE,WAAV,CAAsB,UAAtB,MAAsC,aAA1C,EAAyD;sBACvDnL,IAAI,GAAG0K,OAAO,GAAG,EAAjB;sBACA1D,SAAS,CAAC8D,QAAV,CAAmB9D,SAAS,CAACvO,QAAV,KAAuB,EAA1C;oBACD;;oBACDsH,GAAG,GAAG0K,UAAU,CAACpI,MAAjB;oBACAwH,QAAQ,GAAG,aAAX;kBACD;gBACF,CAVD,MAUO;kBACL7C,SAAS,CAACoE,cAAV,CAAyB,CAAC,IAA1B,EAAgC,CAAC,IAAjC;;kBACA,IAAI1E,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACI,MAA5B,EAAoC;oBAClCuU,QAAQ,GAAG,QAAX;kBACD;;kBACD,IAAI,CAACJ,WAAL,EAAkB;oBAChBA,WAAW,GAAG3X,EAAE,CAACmE,KAAH,CAASoV,KAAT,CAAeC,IAAf,CACZ,YAAY;sBACV,IAAI5E,QAAQ,CAAChI,MAAb,EAAqB;wBACnBb,OAAO,CAAC0N,QAAR,CAAiB7E,QAAQ,CAAChI,MAA1B;sBACD;oBACF,CALW,EAMZ,IANY,EAOZ,IAPY,CAAd;kBASD;gBACF;cACF;YACF;UACF;;UACDsI,SAAS,CAACoE,cAAV,CAAyBpL,IAAzB,EAA+BD,GAA/B;UACAiH,SAAS,CAACwE,WAAV,CAAsB,UAAtB,EAAkC3B,QAAlC;;UACA,IAAI,CAACA,QAAD,IAAaC,MAAM,CAAC2B,SAAP,EAAjB,EAAqC;YACnCzE,SAAS,CAACwE,WAAV,CAAsB,QAAtB,EAAgClY,EAAE,CAACsT,gBAAH,EAAhC;YACAkD,MAAM,CAAC4B,WAAP,GAFmC,CAGnC;;YACAC,OAAO,CAACC,MAAR,CAAe5L,IAAI,GAAG,CAAtB,EAJmC,CAKnC;;YACA2L,OAAO,CAACC,MAAR,CAAe7L,GAAG,GAAG,CAArB;UACD,CAPD,MAOO,IAAI8J,QAAQ,IAAI,CAACC,MAAM,CAAC2B,SAAP,EAAb,IAAmC3B,MAAM,CAAC2B,SAAP,OAAuBzE,SAAS,CAACmE,WAAV,CAAsB,QAAtB,CAA9D,EAA+F;YACpGrB,MAAM,CAAC+B,SAAP,CAAiB7E,SAAS,CAACmE,WAAV,CAAsB,QAAtB,CAAjB;YACAnE,SAAS,CAACwE,WAAV,CAAsB,QAAtB,EAAgC,IAAhC;UACD;QACF,CAjJD;;QAkJA3N,OAAO,CAACxK,WAAR,CAAoB,MAApB,EAA4BuW,MAA5B,EAAoC,IAApC;QACApD,SAAS,CAACnT,WAAV,CAAsB,MAAtB,EAA8BuW,MAA9B,EAAsC,IAAtC;;QAEA,IAAMkC,MAAM,GAAG,UAAUxY,EAAV,EAAc;UAC3B,IAAI+Q,MAAM,GAAG/Q,EAAE,CAACsT,gBAAH,EAAb;UACA,IAAIjT,OAAO,GAAGL,EAAE,CAACuT,YAAH,CAAgB,iBAAhB,IAAqCvT,EAAE,CAACC,OAAH,CAAW,iBAAX,CAArC,GAAqE,IAAnF;;UACA,IAAI8Q,MAAM,KAAK,MAAf,EAAuB;YACrB,IAAI1Q,OAAJ,EAAa;cACXA,OAAO,GAAGA,OAAO,CAACoY,KAAR,EAAV;YACD,CAFD,MAEO;cACL1H,MAAM,GAAG,KAAT;YACD;UACF;;UACD,IAAMwE,WAAW,GAAGlV,OAAO,GAAGA,OAAO,CAACqY,cAAR,EAAH,GAA8B,KAAzD;UACA,IAAMtN,MAAM,GAAGgI,QAAQ,CAAChI,MAAxB;;UACA,IAAI2F,MAAM,KAAK,MAAX,IAAqB1Q,OAAO,KAAK+K,MAArC,EAA6C;YAC3C;YACA;UACD;;UACD,QAAQsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAR;YACE,KAAK,OAAL;cACE,IAAIzE,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACG,KAA5B,EAAmC;gBACjC,KAAK4R,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,OAAhC,EAAyCnK,MAAM,CAACsN,cAAP,EAAzC;;gBACA,QAAQ3H,MAAR;kBACE,KAAK,MAAL;oBACE,IAAI1Q,OAAO,CAACsY,SAAR,CAAkBvN,MAAlB,CAAJ,EAA+B;sBAC7BrM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,gCAAR,EAA0CiU,WAA1C,EAAuDnK,MAAM,CAACsN,cAAP,EAAvD,CADF;oBAGD;;oBACD;;kBAEF,KAAK,MAAL;oBACE,IAAIrY,OAAO,CAAC0Y,WAAR,CAAoB3N,MAApB,CAAJ,EAAiC;sBAC/BrM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,iCAAR,EAA2CiU,WAA3C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD,CADF;oBAGD;;oBACD;;kBAEF,KAAK,KAAL;oBACE,KAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;oBACA;gBAnBJ;cAqBD,CAvBD,MAuBO;gBACL,KAAKlE,KAAL,CAAW,aAAX,EAA0B5C,MAA1B,EAAkCwE,WAAlC,EAA+C,OAA/C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD;cACD;;cACD;;YACF,KAAK,QAAL;cACE,IAAItF,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACE,MAA5B,EAAoC;gBAClC,KAAK6R,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,QAAhC,EAA0CnK,MAAM,CAACsN,cAAP,EAA1C;;gBAEA,QAAQ3H,MAAR;kBACE,KAAK,MAAL;oBACE,IAAI1Q,OAAO,CAAC2Y,UAAR,CAAmB5N,MAAnB,CAAJ,EAAgC;sBAC9BrM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,iCAAR,EAA2CiU,WAA3C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD,CADF;oBAGD;;oBACD;;kBAEF,KAAK,MAAL;oBACE,IAAIrY,OAAO,CAAC4Y,YAAR,CAAqB7N,MAArB,CAAJ,EAAkC;sBAChCrM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,kCAAR,EAA4CiU,WAA5C,EAAyDnK,MAAM,CAACsN,cAAP,EAAzD,CADF;oBAGD;;oBACD;;kBAEF,KAAK,KAAL;oBACE,KAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;oBACA;gBAnBJ;cAqBD,CAxBD,MAwBO;gBACL,KAAKlE,KAAL,CAAW,aAAX,EAA0B5C,MAA1B,EAAkCwE,WAAlC,EAA+C,OAA/C,EAAwDnK,MAAM,CAACsN,cAAP,EAAxD;cACD;;cACD;;YAEF,KAAK,aAAL;cACE,IAAItF,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACK,WAA5B,EAAyC;gBACvC,KAAK0R,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,MAAhC,EAAwCnK,MAAM,CAACsN,cAAP,EAAxC,EAAiE,gBAAjE;;gBAEA,QAAQ3H,MAAR;kBACE,KAAK,MAAL;oBACE,IAAI1Q,OAAO,CAAC2Y,UAAR,CAAmB5N,MAAM,CAAC2K,WAAP,GAAqBtO,OAArB,CAA6B,CAA7B,CAAnB,CAAJ,EAAyD;sBACvD1I,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,8CAAR,EAAwDiU,WAAxD,EAAqEnK,MAAM,CAACsN,cAAP,EAArE,CADF;oBAGD;;oBACD;;kBAEF,KAAK,MAAL;oBACE,IAAIrY,OAAO,CAAC4Y,YAAR,CAAqB7N,MAAM,CAAC2K,WAAP,GAAqBtO,OAArB,CAA6B,CAA7B,CAArB,CAAJ,EAA2D;sBACzD1I,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,+CAAR,EAAyDiU,WAAzD,EAAsEnK,MAAM,CAACsN,cAAP,EAAtE,CADF;oBAGD;;oBACD;;kBAEF,KAAK,KAAL;oBACE,KAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;oBACA;gBAnBJ;cAqBD,CAxBD,MAwBO;gBACL,KAAKlE,KAAL,CAAW,aAAX,EAA0B4B,WAA1B,EAAuC,MAAvC,EAA+CnK,MAAM,CAACsN,cAAP,KAA0B,iBAAzE;cACD;;cACD;;YAEF,KAAK,QAAL;cACE,IAAItF,QAAQ,CAACC,IAAT,GAAgBzR,OAAO,CAACI,MAA5B,EAAoC;gBAClC,KAAK2R,KAAL,CAAW5C,MAAX,EAAmBwE,WAAnB,EAAgC,MAAhC,EAAwCnK,MAAM,CAACsN,cAAP,EAAxC,EAAiE,UAAjE;;gBAEA,QAAQ3H,MAAR;kBACE,KAAK,MAAL;oBACE,IAAI1Q,OAAO,CAAC6Y,UAAR,CAAmB9N,MAAnB,CAAJ,EAAgC;sBAC9BrM,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,+BAAR,EAAyCiU,WAAzC,EAAsDnK,MAAM,CAACsN,cAAP,EAAtD,CADF;oBAGD;;oBACD;;kBAEF,KAAK,MAAL;oBACE,IAAItN,MAAM,CAAC+N,WAAP,CAAmB9Y,OAAnB,EAA4B,CAAC,CAA7B,EAAgC,KAAhC,EAAuC,OAAvC,CAAJ,EAAqD;sBACnDtB,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCC,IAAlC,CACE,KAAKxX,EAAL,CAAQ,gCAAR,EAA0CiU,WAA1C,EAAuDnK,MAAM,CAACsN,cAAP,EAAvD,CADF;oBAGD;;oBACD;;kBAEF,KAAK,KAAL;oBACE,KAAKrJ,SAAL,CAAejE,MAAf,EAAuBsI,SAAS,CAACmE,WAAV,CAAsB,UAAtB,CAAvB;;oBACA;gBAnBJ;cAqBD,CAxBD,MAwBO;gBACL,KAAKlE,KAAL,CAAW,aAAX,EAA0B4B,WAA1B,EAAuC,MAAvC,EAA+CnK,MAAM,CAACsN,cAAP,EAA/C,EAAwE,UAAxE;cACD;;cACD;UArHJ;QAuHD,CAvIc,CAuIb7Q,IAvIa,CAuIR,IAvIQ,CAAf;;QAyIA0C,OAAO,CAACxK,WAAR,CAAoB,MAApB,EAA4ByY,MAA5B,EAAoC,IAApC;QACA9E,SAAS,CAAC3T,WAAV,CAAsB,MAAtB,EAA8ByY,MAA9B,EAAsC,IAAtC;;QAEA,IAAMY,SAAS,GAAG,SAAZA,SAAY,CAAUpZ,EAAV,EAAc;UAC9B;UACA0T,SAAS,CAACoE,cAAV,CAAyB,CAAC,IAA1B,EAAgC,CAAC,IAAjC;UACApE,SAAS,CAAC2F,aAAV;;UACA,IAAIlD,WAAJ,EAAiB;YACfA,WAAW,CAACrF,IAAZ;YACAqF,WAAW,GAAG,IAAd;UACD;;UACD,IAAI1D,iBAAJ,EAAuB;YACrBA,iBAAiB,CAAC6G,aAAlB;YACA7G,iBAAiB,GAAG,IAApB;UACD;;UACDW,QAAQ,CAAChI,MAAT,GAAkB,IAAlB;UACAgI,QAAQ,CAACC,IAAT,GAAgB,CAAhB;UACA,IAAImD,MAAM,GAAGxW,EAAE,CAACyW,UAAH,GAAgBC,SAAhB,EAAb;;UACA,IAAI,CAACF,MAAL,EAAa;YACXA,MAAM,GAAGhY,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAWiW,cAAX,CAA0BtS,WAA1B,EAAT;UACD;;UACD,IAAImS,MAAM,CAACM,QAAP,CAAgB,OAAhB,CAAJ,EAA8B;YAC5BN,MAAM,CAACzK,WAAP,CAAmB,OAAnB;UACD;;UACD,KAAK6G,WAAL,CAAiB,KAAjB;QACD,CAtBD;;QAuBArI,OAAO,CAACxK,WAAR,CAAoB,SAApB,EAA+BqZ,SAA/B,EAA0C,IAA1C;QACAlG,SAAS,CAACnT,WAAV,CAAsB,SAAtB,EAAiCqZ,SAAjC,EAA4C,IAA5C;MACD,CApvCM;;MAsvCP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;MACI/J,SA9vCO,qBA8vCGjE,MA9vCH,EA8vCWmL,QA9vCX,EA8vCqBhB,WA9vCrB,EA8vCkC;QAAA;;QACvC,IAAMb,MAAM,GAAG6B,QAAQ,KAAK,QAAb,IAAyBA,QAAQ,KAAK,aAAtC,GAAsDnL,MAAtD,GAA+DA,MAAM,CAACuJ,SAAP,EAA9E;QACA,IAAMC,mBAAmB,GAAGF,MAAM,CAACG,gBAAP,EAA5B;QACA,IAAII,OAAO,GAAGP,MAAM,CAACQ,kBAAP,CAA0B,KAA1B,CAAd;;QACA,IAAID,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;UACtB;UACA,IAAMiS,QAAQ,GAAG7E,MAAM,CAACqB,WAAP,EAAjB,CAFsB,CAGtB;;UACA,IAAI,CAACnB,mBAAmB,CAACO,mBAApB,EAAD,IAA8CoB,QAAQ,KAAK,QAA3D,IAAuEgD,QAAQ,CAACjS,MAAT,GAAkB,CAA7F,EAAgG;YAC9F;YACA,IAAMkS,OAAO,GAAG5E,mBAAmB,CAACgB,2BAApB,EAAhB;YACA,IAAI6D,WAAW,GAAG,CAAlB;YACA,IAAIxD,WAAW,GAAG,CAAlB;;YACA,IAAIM,QAAQ,KAAK,QAAjB,EAA2B;cACzBN,WAAW,GAAGuD,OAAO,CAACpO,MAAM,CAACqK,OAAP,EAAD,CAArB;cACA,IAAMiE,WAAW,GAAGH,QAAQ,CAACI,OAAT,CAAiBvO,MAAjB,CAApB;;cACA,IAAIsO,WAAW,GAAG,CAAlB,EAAqB;gBACnB,IAAIE,KAAK,GAAG,KAAZ,CADmB,CAEnB;;gBACA,KAAK,IAAIrH,CAAC,GAAGmH,WAAW,GAAG,CAA3B,EAA8BnH,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;kBACzC,IAAMsH,OAAO,GAAGN,QAAQ,CAAC9R,OAAT,CAAiB8K,CAAjB,CAAhB;;kBACA,IAAI,CAACsH,OAAO,CAACpE,OAAR,GAAkB5R,UAAlB,CAA6B,GAA7B,CAAD,IAAsCgW,OAAO,CAACpE,OAAR,OAAsBrK,MAAM,CAACqK,OAAP,EAAhE,EAAkF;oBAChFgE,WAAW,GAAGD,OAAO,CAACK,OAAO,CAACpE,OAAR,EAAD,CAArB;oBACAmE,KAAK,GAAG,IAAR;oBACA;kBACD;gBACF;;gBACD,IAAI,CAACA,KAAL,EAAY;kBACV;kBACAH,WAAW,GAAGxD,WAAd;gBACD;cACF;YACF,CAnBD,MAmBO,IAAIM,QAAQ,KAAK,OAAjB,EAA0B;cAC/BkD,WAAW,GAAGD,OAAO,CAACpO,MAAM,CAACqK,OAAP,EAAD,CAArB;;cACA,IAAMiE,YAAW,GAAGH,QAAQ,CAACI,OAAT,CAAiBvO,MAAjB,CAApB;;cACA,IAAIsO,YAAW,GAAGH,QAAQ,CAACjS,MAAT,GAAkB,CAApC,EAAuC;gBACrC;gBACA,IAAIsS,MAAK,GAAG,KAAZ;;gBACA,KAAK,IAAIrH,GAAC,GAAGmH,YAAb,EAA0BnH,GAAC,GAAGgH,QAAQ,CAACjS,MAAvC,EAA+CiL,GAAC,EAAhD,EAAoD;kBAClD,IAAMsH,QAAO,GAAGN,QAAQ,CAAC9R,OAAT,CAAiB8K,GAAjB,CAAhB;;kBACA,IAAI,CAACsH,QAAO,CAACpE,OAAR,GAAkB5R,UAAlB,CAA6B,GAA7B,CAAD,IAAsCgW,QAAO,CAACpE,OAAR,OAAsBrK,MAAM,CAACqK,OAAP,EAAhE,EAAkF;oBAChFQ,WAAW,GAAGuD,OAAO,CAACK,QAAO,CAACpE,OAAR,EAAD,CAArB;oBACAmE,MAAK,GAAG,IAAR;oBACA;kBACD;gBACF;;gBACD,IAAI,CAACA,MAAL,EAAY;kBACV;kBACA3D,WAAW,GAAGwD,WAAd;gBACD;cACF,CAfD,MAeO;gBACL;gBACAxD,WAAW,GAAGwD,WAAW,GAAG,CAA5B;cACD;YACF,CAtBM,MAsBA,IAAIlD,QAAQ,KAAK,aAAjB,EAAgC;cACrC;cACA,IAAMP,UAAU,GAAGuD,QAAQ,CAAC9R,OAAT,CAAiB,CAAjB,CAAnB;cACAwO,WAAW,GAAGuD,OAAO,CAACxD,UAAU,CAACP,OAAX,EAAD,CAArB;YACD;;YACDR,OAAO,GAAGA,OAAO,CAACtD,MAAR,CACR,UAAAmI,IAAI;cAAA,OACF/V,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCsV,OAArC,EAA8CM,IAA9C,KACAN,OAAO,CAACM,IAAD,CAAP,IAAiB7D,WADjB,IAEAuD,OAAO,CAACM,IAAD,CAAP,IAAiBL,WAHf;YAAA,CADI,CAAV;UAMD;QACF;;QACD,IAAIxE,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;UACtB,KAAK/D,QAAL,GAAiB,IAAjB;UACA,IAAIwW,eAAJ;;UACA,IAAI9E,OAAO,CAAC3N,MAAR,GAAiB,CAArB,EAAwB;YACtB;YACAyS,eAAe,GAAG,IAAIhb,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2N,IAAd,CAAmBoN,WAAvB,CAAmC;cACnDC,WAAW,EAAE,IADsC;cAEnDC,OAAO,EAAE,IAF0C;cAGnDC,OAAO,EAAE,KAAK7Y,EAAL,CACP,gJADO,CAH0C;cAOnD8Y,QAAQ,EAAE;gBACRC,IAAI,EAAE;kBACJA,IAAI,EAAE,WADF;kBAEJxO,KAAK,EAAE,KAAKvK,EAAL,CAAQ,gBAAR,CAFH;kBAGJgZ,IAAI,EAAE,KAAKhZ,EAAL,CAAQ,iDAAR,CAHF;kBAKJiZ,OAAO,EAAEtF,OAAO,CACbuF,IADM,CACD,UAACC,CAAD,EAAIC,CAAJ,EAAU;oBACd,IAAID,CAAC,CAAC5W,UAAF,CAAa,GAAb,KAAqB,CAAC6W,CAAC,CAAC7W,UAAF,CAAa,GAAb,CAA1B,EAA6C;sBAC3C,OAAO,CAAP;oBACD,CAFD,MAEO,IAAI,CAAC4W,CAAC,CAAC5W,UAAF,CAAa,GAAb,CAAD,IAAsB6W,CAAC,CAAC7W,UAAF,CAAa,GAAb,CAA1B,EAA6C;sBAClD,OAAO,CAAC,CAAR;oBACD;;oBACD,OAAO4W,CAAC,CAACE,aAAF,CAAgBD,CAAhB,CAAP;kBACD,CARM,EASNE,GATM,CASF,UAAAd,IAAI;oBAAA,OAAK;sBAAEjO,KAAK,EAAEiO,IAAT;sBAAejU,KAAK,EAAEiU;oBAAtB,CAAL;kBAAA,CATF,CALL;kBAeJe,UAAU,EAAE;oBACVC,QAAQ,EAAE;kBADA;gBAfR;cADE;YAPyC,CAAnC,EA6BfC,IA7Be,GA8BfC,OA9Be,EAAlB;UA+BD,CAjCD,MAiCO;YACLjB,eAAe,GAAGzV,OAAO,CAACC,OAAR,CAAgB;cAAE8V,IAAI,EAAEpF,OAAO,CAAC,CAAD;YAAf,CAAhB,CAAlB;UACD;;UACD8E,eAAe,CAACkB,IAAhB,CAAqB,UAAA3J,MAAM,EAAI;YAC7B,IAAIA,MAAJ,EAAY;cACV,IAAM+I,IAAI,GAAG/I,MAAM,CAAC+I,IAApB,CADU,CAEV;;cACA,IAAMlG,SAAQ,GAAG/I,MAAM,CAAClC,OAAP,GAAiBgS,aAAlC;cACA,IAAI7a,OAAJ;cACA,IAAI8a,SAAS,GAAG,KAAhB;;cACA,QAAQd,IAAR;gBACE,KAAK,UAAL;kBACEha,OAAO,GAAG8T,SAAQ,CAACiH,aAAT,CAAuB,EAAvB,CAAV;kBACA;;gBAEF,KAAK,OAAL;kBACE/a,OAAO,GAAG8T,SAAQ,CAACkH,cAAT,CAAwB,EAAxB,CAAV;kBACA;;gBAEF,KAAK,gBAAL;kBACEhb,OAAO,GAAG8T,SAAQ,CAACmH,kBAAT,CAA4B,EAA5B,CAAV;kBACA;;gBAEF;kBACEjb,OAAO,GAAG8T,SAAQ,CAACoH,aAAT,CAAuBlB,IAAvB,CAAV;kBACAc,SAAS,GAAG,IAAZ;kBACA;cAhBJ;;cAmBA,IAAMK,aAAa,GAAG5G,mBAAmB,CAAC6G,8BAApB,CAAmDpB,IAAnD,CAAtB;;cAEA,IAAMqB,YAAY,GAAG,SAAfA,YAAe,CAAUrb,OAAV,EAAmBmb,aAAnB,EAAkC;gBACrD,IAAMG,gBAAgB,GAAGH,aAAa,CAACI,mBAAd,EAAzB;;gBACA,IAAID,gBAAgB,CAACrU,MAAjB,GAA0B,CAA9B,EAAiC;kBAC/B,IAAI,CAACkU,aAAa,CAACrG,mBAAd,EAAL,EAA0C;oBACxC;oBACA,IAAME,cAAc,GAAGmG,aAAa,CAAClG,yBAAd,EAAvB;oBACAqG,gBAAgB,CAACnB,IAAjB,CAAsBzb,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoB0X,MAApB,CAA2BC,OAA3B,CAAmCC,cAAnC,CAAkD1G,cAAlD,CAAtB;kBACD;gBACF;;gBACDsG,gBAAgB,CAAChT,OAAjB,CAAyB,UAAAqT,SAAS,EAAI;kBACpC,IAAMC,KAAK,GAAG9H,SAAQ,CAACoH,aAAT,CAAuBS,SAAvB,CAAd;;kBACA3b,OAAO,CAAC6b,WAAR,CAAoBD,KAApB,EAFoC,CAGpC;;kBACAP,YAAY,CAACO,KAAD,EAAQT,aAAa,CAACC,8BAAd,CAA6CO,SAA7C,CAAR,CAAZ;gBACD,CALD;;gBAMA,IAAIR,aAAa,CAACW,qBAAd,EAAJ,EAA2C;kBACzC,IAAMF,KAAK,GAAG9H,SAAQ,CAACkH,cAAT,CAAwB,GAAxB,CAAd;;kBACAhb,OAAO,CAAC6b,WAAR,CAAoBD,KAApB;gBACD;cACF,CAnBD;;cAoBA,IAAId,SAAJ,EAAe;gBACbO,YAAY,CAACrb,OAAD,EAAUmb,aAAV,CAAZ;cACD;;cAED,IAAMY,UAAU,GAAG,IAAIrd,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBkY,UAAxB,CAAmChc,OAAnC,EAA4Cmb,aAA5C,EAA2DpQ,MAAM,CAACkR,SAAP,EAA3D,EAA+E5H,MAA/E,CAAnB,CAnDU,CAqDV;;cACA0H,UAAU,CAAC9J,IAAX;cACA,IAAIiK,GAAG,GAAGjY,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAAV;;cACA,IAAI6X,UAAU,CAACI,gBAAX,EAAJ,EAAmC;gBACjC;gBACAD,GAAG,GAAG,MAAI,CAACpQ,OAAL,CAAa,IAAb,EAAmBiQ,UAAnB,EAA+B,IAA/B,CAAN;cACD;;cACDG,GAAG,CACAtB,IADH,CACQ,UAAApb,IAAI,EAAI;gBACZ,IAAIA,IAAJ,EAAU;kBACR;kBACA,QAAQ0W,QAAR;oBACE,KAAK,QAAL;sBACE6F,UAAU,CAACnD,YAAX,CAAwB7N,MAAxB;sBACA;;oBAEF,KAAK,OAAL;sBACEgR,UAAU,CAACrD,WAAX,CAAuB3N,MAAvB;sBACA;;oBAEF,KAAK,QAAL;sBACEA,MAAM,CAAC+N,WAAP,CAAmBiD,UAAnB,EAA+B,CAAC,CAAhC,EAAmC,KAAnC,EAA0C,OAA1C;sBACA;;oBAEF,KAAK,aAAL;sBACEhR,MAAM,CAAC+N,WAAP,CAAmBiD,UAAnB,EAA+B,CAA/B,EAAkC,KAAlC,EAAyC,OAAzC;sBACA;kBAfJ;;kBAkBA,MAAI,CAACtW,eAAL,CAAqB,MAArB,EAA6BoM,kBAA7B,CAAgDkK,UAAhD;;kBACA,MAAI,CAACtW,eAAL,CAAqB,MAArB,EAA6B2W,YAA7B,CAA0C,CAACL,UAAD,CAA1C;gBACD;cACF,CAzBH,EAyBK,MAzBL,WA0BS,UAAAM,GAAG;gBAAA,OAAI,MAAI,CAAClU,KAAL,CAAWkU,GAAX,CAAJ;cAAA,CA1BZ;YA2BD;UACF,CAzFD;QA0FD;MACF,CAn8CM;MAq8CPlH,QAr8CO,oBAq8CeH,cAr8Cf,EAq8C+BE,WAr8C/B,EAq8C4CoH,UAr8C5C,EAq8CwDC,KAr8CxD,EAq8C+D;QACpE,IAAIvH,cAAJ,EAAoB;UAClB,IAAIwH,eAAe,GAAGxH,cAAc,CAACE,WAAD,CAApC;;UACA,IAAI,OAAOsH,eAAP,KAA2B,QAA/B,EAAyC;YACvCA,eAAe,GAAGA,eAAe,CAACC,KAAhB,CAAsB,GAAtB,EAA2BlC,GAA3B,CAA+B,UAAArI,CAAC;cAAA,OAAK,QAAQwK,IAAR,CAAaxK,CAAb,IAAkByK,QAAQ,CAACzK,CAAD,CAA1B,GAAgCA,CAArC;YAAA,CAAhC,CAAlB;UACD,CAFD,MAEO;YACLsK,eAAe,GAAG,CAACA,eAAD,CAAlB;UACD;;UACD,IAAIhH,cAAc,GAAGR,cAAc,CAACsH,UAAD,CAAnC;;UACA,IAAI,OAAO9G,cAAP,KAA0B,QAA9B,EAAwC;YACtCA,cAAc,GAAGA,cAAc,CAACiH,KAAf,CAAqB,GAArB,EAA0BlC,GAA1B,CAA8B,UAAArI,CAAC;cAAA,OAAK,QAAQwK,IAAR,CAAaxK,CAAb,IAAkByK,QAAQ,CAACzK,CAAD,CAA1B,GAAgCA,CAArC;YAAA,CAA/B,CAAjB;UACD,CAFD,MAEO;YACLsD,cAAc,GAAG,CAACA,cAAD,CAAjB;UACD;;UACD,IAAM+G,MAAK,GAAGvI,IAAI,CAAC4I,GAAL,CAASL,MAAK,IAAI,CAAlB,EAAqBC,eAAe,CAACvV,MAArC,EAA6CuO,cAAc,CAACvO,MAA5D,CAAd;;UAEA,KAAK,IAAIiL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqK,MAApB,EAA2BrK,CAAC,EAA5B,EAAgC;YAC9B,IAAIsK,eAAe,CAACtK,CAAD,CAAf,KAAuBsD,cAAc,CAACtD,CAAD,CAAzC,EAA8C;cAC5C;cACA,OAAOxT,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BvR,OAA1B,CAAkCE,MAAlC,GAA2C/C,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BvR,OAA1B,CAAkCG,KAApF;YACD,CAHD,MAGO,IAAI8a,eAAe,CAACtK,CAAD,CAAf,GAAqB,CAArB,KAA2BsD,cAAc,CAACtD,CAAD,CAA7C,EAAkD;cACvD,OAAOxT,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BvR,OAA1B,CAAkCG,KAAzC;YACD,CAFM,MAEA,IAAI8a,eAAe,CAACtK,CAAD,CAAf,GAAqB,CAArB,KAA2BsD,cAAc,CAACtD,CAAD,CAA7C,EAAkD;cACvD,OAAOxT,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BvR,OAA1B,CAAkCE,MAAzC;YACD;UACF;QACF;;QACD,OAAO/C,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BvR,OAA1B,CAAkCC,IAAzC;MACD,CAj+CM;MAm+CPqb,QAn+CO,oBAm+CS7S,EAn+CT,EAm+Ca+P,QAn+Cb,EAm+CuB/Z,OAn+CvB,EAm+CgC;QAAA;;QACrC,IAAM8c,QAAQ,GAAGpe,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBW,IAArB,CAA0Bud,QAA1B,CAAmCpP,GAAnC,CAAuC3D,EAAvC,CAAjB;;QACA,IAAI8S,QAAJ,EAAc;UACZ,IAAI,OAAOA,QAAQ,CAACE,OAAhB,KAA4B,UAAhC,EAA4C;YAC1CjD,QAAQ,CAACG,OAAT,GAAmB4C,QAAQ,CAACE,OAAT,CAAiBhd,OAAjB,CAAnB;UACD,CAFD,MAEO,IAAI8c,QAAQ,CAACtd,IAAb,EAAmB;YACxBua,QAAQ,CAACG,OAAT,GAAmB4C,QAAQ,CAACtd,IAA5B;UACD,CAFM,MAEA;YACL,KAAK2I,KAAL,CAAW,sCAAsC6B,EAAjD;UACD;;UACD+P,QAAQ,CAACC,IAAT,GAAgB8C,QAAQ,CAACG,gBAAT,GAA4B,iBAA5B,GAAgD,kBAAhE;QACD,CATD,MASO,IAAI,CAAC,SAAD,EAAY,SAAZ,EAAuBC,QAAvB,CAAgClT,EAAE,CAACyS,KAAH,CAAS,GAAT,EAAcvU,GAAd,EAAhC,CAAJ,EAA0D;UAC/D,IAAM8R,IAAI,GAAGhQ,EAAE,CAACyS,KAAH,CAAS,GAAT,EAAcvU,GAAd,EAAb,CAD+D,CAE/D;;UACA,IAAMkF,IAAI,GAAG,KAAK3H,eAAL,CAAqB,MAArB,CAAb;UACA,IAAMuL,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;UACAkR,QAAQ,CAACC,IAAT,GAAgB,WAAhB;UACAD,QAAQ,CAACG,OAAT,GAAmB,EAAnB;UACA,IAAMpJ,QAAQ,GAAG,KAAKzN,UAAL,KAAoB,MAApB,GAA6B,kBAAkB2W,IAA/C,GAAsD,YAAYA,IAAZ,GAAmB,MAAnB,GAA4BA,IAAnG;UACAhJ,QAAQ,CAACK,gBAAT,CAA0BP,QAA1B,EAAoCxI,OAApC,CAA4C,UAAAtI,OAAO,EAAI;YACrD,IAAMyZ,IAAI,GAAGzZ,OAAO,CAAC0R,YAAR,CAAqB,MAArB,CAAb;YACAqI,QAAQ,CAACG,OAAT,CAAiBjS,IAAjB,CAAsB;cAAEuD,KAAK,EAAEiO,IAAT;cAAejU,KAAK,EAAEiU;YAAtB,CAAtB;UACD,CAHD;QAID;;QACD,IAAIM,QAAQ,CAACC,IAAT,CAAcmD,QAAd,CAAuB,WAAvB,CAAJ,EAAyC;UACvC;UACA,OAAOpD,QAAQ,CAACrN,WAAhB;;UACA,IAAI,CAACqN,QAAQ,CAACS,UAAT,CAAoBC,QAAzB,EAAmC;YACjC,IAAIV,QAAQ,CAACG,OAAT,YAA4BjW,OAAhC,EAAyC;cACvC8V,QAAQ,CAACG,OAAT,CACGU,IADH,CACQ,UAAAsB,GAAG,EAAI;gBACX,IAAIzc,KAAK,CAAC2d,OAAN,CAAclB,GAAd,CAAJ,EAAwB;kBACtBA,GAAG,CAACmB,OAAJ,CAAY;oBACV7R,KAAK,EAAE,QAAQ,MAAI,CAACvK,EAAL,CAAQ,SAAR,CAAR,GAA6B,KAD1B;oBAEVuE,KAAK,EAAE;kBAFG,CAAZ;gBAID;cACF,CARH,WASS,YAAM,CAAE,CATjB,EADuC,CAUnB;YACrB,CAXD,MAWO;cACLuU,QAAQ,CAACG,OAAT,CAAiBmD,OAAjB,CAAyB;gBACvB7R,KAAK,EAAE,QAAQ,KAAKvK,EAAL,CAAQ,SAAR,CAAR,GAA6B,KADb;gBAEvBuE,KAAK,EAAE;cAFgB,CAAzB;YAID;UACF;QACF;MACF,CAlhDM;MAohDP8X,SAphDO,qBAohDsBtd,OAphDtB,EAohD+Bud,SAphD/B,EAohD0C;QAC/C,IAAMC,IAAI,GAAGD,SAAS,CAACE,gBAAV,EAAb;QACA,IAAMC,GAAG,GAAG;UACV1D,IAAI,EAAE,WADI;UAEVxO,KAAK,EAAE+R,SAAS,CAACnI,OAAV,EAFG;UAGV1I,WAAW,EAAE,QAAQ,KAAKzL,EAAL,CAAQ,SAAR,CAAR,GAA6B,KAHhC;UAIVgZ,IAAI,EAAEuD,IAAI,CAACG,IAAL,CAAU,OAAV,CAJI;UAKVC,OAAO,EAAE5d,OAAO,CAACwS,UAAR,EALC;UAMVhN,KAAK,EAAExF,OAAO,CAAC0R,YAAR,CAAqB6L,SAAS,CAACnI,OAAV,EAArB,KAA6CmI,SAAS,CAACM,eAAV,EAN1C;UAOVrD,UAAU,EAAE;YACVC,QAAQ,EAAE,CAAC8C,SAAS,CAACO,UAAV,EADD;YAEVC,SAFU,qBAEAvY,KAFA,EAEO;cACf,IAAIA,KAAK,YAAYrH,EAAE,CAACQ,EAAH,CAAM4N,IAAN,CAAWyR,QAAhC,EAA0C;gBACxCxY,KAAK,GAAGA,KAAK,CAAC0K,QAAN,GAAiB+N,QAAjB,EAAR;cACD;;cACD,IAAI,CAACV,SAAS,CAACW,YAAV,CAAuB1Y,KAAvB,CAAL,EAAoC;gBAClC,MAAM,IAAIrH,EAAE,CAACkC,IAAH,CAAQ8d,eAAZ,CAA4BhgB,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,4BAArB,CAA5B,CAAN;cACD;YACF;UATS;QAPF,CAAZ;;QAoBA,QAAQsc,SAAS,CAACa,aAAV,EAAR;UACE,KAAK,SAAL;YACEV,GAAG,CAAC1D,IAAJ,GAAW,UAAX;YACA0D,GAAG,CAAClY,KAAJ,GAAYkY,GAAG,CAAClY,KAAJ,KAAc,EAAd,IAAoBkY,GAAG,CAAClY,KAAJ,KAAc,IAAlC,IAA0CkY,GAAG,CAAClY,KAAJ,KAAciQ,SAAxD,GAAoE,IAApE,GAA2EiI,GAAG,CAAClY,KAAJ,KAAc,MAArG;YACA,OAAOkY,GAAG,CAAChR,WAAX;YACA;;UAEF,KAAK,QAAL;YAAe;cACb,IAAM2R,KAAK,GAAGd,SAAS,CAACe,cAAV,EAAd;;cACA,IAAID,KAAK,CAACpX,MAAN,GAAe,CAAnB,EAAsB;gBACpByW,GAAG,CAAC1D,IAAJ,GAAW,WAAX;gBACA,OAAO0D,GAAG,CAAChR,WAAX;gBACAgR,GAAG,CAACxD,OAAJ,GAAc,EAAd;gBACAmE,KAAK,CAAC/V,OAAN,CAAc,UAAAmR,IAAI,EAAI;kBACpBiE,GAAG,CAACxD,OAAJ,CAAYjS,IAAZ,CAAiB;oBAAEuD,KAAK,EAAEiO,IAAT;oBAAejU,KAAK,EAAEiU;kBAAtB,CAAjB;gBACD,CAFD;;gBAGA,IAAI8D,SAAS,CAACO,UAAV,EAAJ,EAA4B;kBAC1B;kBACAJ,GAAG,CAACxD,OAAJ,CAAYmD,OAAZ,CAAoB;oBAClB7R,KAAK,EAAE,QAAQ,KAAKvK,EAAL,CAAQ,SAAR,CAAR,GAA6B,KADlB;oBAElBuE,KAAK,EAAE;kBAFW,CAApB;gBAID;cACF,CAdD,MAcO;gBACL;gBACA,KAAKqX,QAAL,CAAqB7c,OAAO,CAACoV,OAAR,KAAoB,GAApB,GAA0BmI,SAAS,CAACnI,OAAV,EAA/C,EAAoEsI,GAApE,EAAyE1d,OAAO,CAAC6I,OAAR,EAAzE;cACD;;cACD;YACD;QA5BH;;QA+BA,OAAO6U,GAAP;MACD,CA1kDM;MA4kDP5R,OA5kDO,mBA4kDCnM,EA5kDD,EA4kDKK,OA5kDL,EA4kDcue,KA5kDd,EA4kDqB;QAAA;;QAC1B,IAAI,CAAC,KAAKvY,OAAL,EAAD,IAAmB,CAAC,KAAKA,OAAL,GAAeb,WAAf,EAAxB,EAAsD;UACpD,OAAO,IAAP;QACD;;QACD,IAAIqZ,KAAJ;QACA,IAAIC,OAAJ;;QACA,IAAI,CAACze,OAAL,EAAc;UACZ,IAAI,KAAK+O,WAAL,EAAJ,EAAwB;YACtB/O,OAAO,GAAG,KAAK+O,WAAL,EAAV;UACD,CAFD,MAEO;YACL,OAAO,IAAP;UACD;QACF;;QACD,IAAI,CAAC/O,OAAO,CAAC0e,iBAAR,EAAL,EAAkC;UAChC,OAAO,IAAP;QACD;;QACD1e,OAAO,CAACiS,IAAR;QACA,IAAM8H,QAAQ,GAAG,EAAjB;QACA,IAAM4E,WAAW,GAAG3e,OAAO,CAACwU,gBAAR,EAApB;;QACA,IAAI+J,KAAJ,EAAW;UACTC,KAAK,GAAG,KAAKvd,EAAL,CAAQ,uBAAR,EAAiCjB,OAAO,CAACoV,OAAR,EAAjC,CAAR;UACAqJ,OAAO,GAAG,KAAKxd,EAAL,CACR,8FADQ,EAERjB,OAAO,CAACoV,OAAR,EAFQ,CAAV;QAID,CAND,MAMO;UACLoJ,KAAK,GAAG,KAAKvd,EAAL,CAAQ,yBAAR,CAAR;UACAwd,OAAO,GAAGze,OAAO,CAACwS,UAAR,KAAuB,KAAKvR,EAAL,CAAQ,SAAR,EAAmBjB,OAAO,CAACoV,OAAR,EAAnB,CAAvB,GAA+D,KAAKnU,EAAL,CAAQ,SAAR,EAAmBjB,OAAO,CAACoV,OAAR,EAAnB,CAAzE;QACD;;QACD,IAAIpV,OAAO,CAAC6I,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACC,YAAxC,EAAsD;UACpD,IAAMC,OAAO,GAAGJ,WAAW,CAACK,oBAAZ,EAAhB;UACAtb,MAAM,CAACiR,IAAP,CAAYoK,OAAZ,EAAqBzW,OAArB,CAA6B,UAAAmR,IAAI,EAAI;YACnC,IAAM8D,SAAS,GAAGwB,OAAO,CAACtF,IAAD,CAAzB;;YACA,IAAI,CAAC,MAAI,CAACwF,SAAL,EAAL,EAAuB;cACrB,IAAMC,OAAO,GAAG3B,SAAS,CAAC4B,UAAV,EAAhB;;cACA,IAAID,OAAO,CAAChC,QAAR,CAAiB,cAAjB,CAAJ,EAAsC;gBACpC;gBACA;cACD;YACF;;YACDnD,QAAQ,CAACN,IAAD,CAAR,GAAiB,MAAI,CAAC6D,SAAL,CAAkCtd,OAAlC,EAA2Cud,SAA3C,CAAjB;UACD,CAVD;;UAWA,IAAIoB,WAAW,CAACtJ,qBAAZ,CAAkC,GAAlC,CAAJ,EAA4C;YAC1C,IAAM+J,MAAM,GAAG,IAAIC,SAAJ,EAAf;YACA,IAAMC,QAAQ,GAAGtf,OAAO,CAAC6I,OAAR,GAAkB0W,QAAlB,KAA+B,QAA/B,GAA0C,YAA1C,GAAyD,YAA1E;;YACA,IAAIhB,KAAJ,EAAW;cACTC,KAAK,GAAG,KAAKvd,EAAL,CAAQ,uBAAR,EAAiCjB,OAAO,CAACoV,OAAR,EAAjC,CAAR;cACAqJ,OAAO,GAAG,KAAKxd,EAAL,CACR,2FADQ,EAERjB,OAAO,CAACoV,OAAR,EAFQ,CAAV;YAID,CAND,MAMO;cACLoJ,KAAK,GAAGc,QAAQ,KAAK,YAAb,GAA4B,KAAKre,EAAL,CAAQ,0BAAR,CAA5B,GAAkE,KAAKA,EAAL,CAAQ,sBAAR,CAA1E;YACD;;YACD8Y,QAAQ,CAACuF,QAAD,CAAR,GAAqB;cACnBtF,IAAI,EAAE,UADa;cAEnBxO,KAAK,EAAE,EAFY;cAGnBgU,KAAK,EAAE,CAHY;cAInBC,QAAQ,EAAE,IAJS;cAKnBlS,KAAK,EAAEyG,IAAI,CAAC4I,GAAL,CAASze,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAT,EAAqC,GAArC,CALY;cAMnB8Y,OAAO,EAAE5d,OAAO,CAACwS,UAAR,EANU;cAOnBhN,KAAK,EAAE8Z,QAAQ,KAAK,YAAb,GAA4Btf,OAAO,CAAC6I,OAAR,GAAkBC,SAA9C,GAA0D9I,OAAO,CAAC6I,OAAR,GAAkB6W,SAPhE;cAQnBlF,UAAU,EAAE;gBACVuD,SADU,qBACAvY,KADA,EACO;kBACf,IAAIA,KAAJ,EAAW;oBACT,IAAMma,GAAG,GAAGP,MAAM,CAACQ,eAAP,CAAuBpa,KAAvB,EAA8B,UAA9B,CAAZ;;oBACA,IAAIma,GAAG,CAACE,oBAAJ,CAAyB,aAAzB,EAAwC5Y,MAAxC,GAAiD,CAArD,EAAwD;sBACtD,MAAM,IAAI9I,EAAE,CAACkC,IAAH,CAAQ8d,eAAZ,CAA4BhgB,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,4BAArB,CAA5B,CAAN;oBACD;kBACF;gBACF;cARS;YARO,CAArB;UAmBD;QACF,CA7CD,MA6CO,IACLjB,OAAO,CAAC6I,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACiB,SAApC,IACA9f,OAAO,CAAC6I,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACkB,YADpC,IAEA/f,OAAO,CAAC6I,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACmB,kBAH/B,EAIL;UACAxB,KAAK,GAAG,KAAKvd,EAAL,CAAQ,mBAAR,EAA6BjB,OAAO,CAACoV,OAAR,EAA7B,CAAR;UACAqJ,OAAO,GAAG,EAAV;UACA,IAAIc,QAAQ,GAAGvf,OAAO,CAAC6I,OAAR,GAAkB0W,QAAjC,CAHA,CAIA;;UACA,IAAM/B,IAAI,GAAGmB,WAAW,CAAClB,gBAAZ,EAAb;UACA1D,QAAQ,CAACwF,QAAD,CAAR,GAAqB;YACnBvF,IAAI,EAAE,UADa;YAEnBxO,KAAK,EAAE,EAFY;YAGnBgU,KAAK,EAAE,CAHY;YAInBC,QAAQ,EAAE,IAJS;YAKnBlS,KAAK,EAAEyG,IAAI,CAAC4I,GAAL,CAASze,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAT,EAAqC,GAArC,CALY;YAMnB4H,WAAW,EAAE,KAAKzL,EAAL,CAAQ,SAAR,CANM;YAOnBgZ,IAAI,EAAEuD,IAAI,CAACG,IAAL,CAAU,OAAV,CAPa;YAQnBC,OAAO,EAAE5d,OAAO,CAACwS,UAAR,EARU;YASnBhN,KAAK,EAAExF,OAAO,CAACigB,cAAR,EATY;YAUnBzF,UAAU,EAAE;cACVuD,SADU,qBACAvY,KADA,EACO;gBACf,IAAIA,KAAK,YAAYrH,EAAE,CAACQ,EAAH,CAAM4N,IAAN,CAAWyR,QAAhC,EAA0C;kBACxCxY,KAAK,GAAGA,KAAK,CAAC0K,QAAN,GAAiB+N,QAAjB,EAAR;gBACD;;gBACD,IAAI,CAACU,WAAW,CAACT,YAAZ,CAAyB1Y,KAAzB,CAAL,EAAsC;kBACpC,MAAM,IAAIrH,EAAE,CAACkC,IAAH,CAAQ8d,eAAZ,CAA4BhgB,EAAE,CAAC4C,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,4BAArB,CAA5B,CAAN;gBACD;cACF;YARS;UAVO,CAArB;;UAsBA,IAAIjB,OAAO,CAACkgB,UAAR,MAAwBlgB,OAAO,CAACsU,SAAR,GAAoBc,OAApB,OAAkC,QAA9D,EAAwE;YACtE,IAAM4E,IAAI,GAAGha,OAAO,CAACsU,SAAR,GAAoB5C,YAApB,CAAiC,MAAjC,CAAb;;YACA,IAAI,CAACsI,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,KAA7B,KAAuCha,OAAO,CAAC6I,OAAR,GAAkB+V,QAAlB,KAA+BC,IAAI,CAACiB,SAA/E,EAA0F;cACxF9f,OAAO,CAACmgB,mBAAR,CAA4BtB,IAAI,CAACmB,kBAAjC;cACA,IAAMI,WAAW,GAAGpgB,OAAO,CAAC6I,OAAR,GAAkB0W,QAAtC;cACAxF,QAAQ,CAACqG,WAAD,CAAR,GAAwBrG,QAAQ,CAACwF,QAAD,CAAhC;cACA,OAAOxF,QAAQ,CAACwF,QAAD,CAAf;cACAA,QAAQ,GAAGa,WAAX;YACD,CARqE,CAStE;YAEA;;YACA;AACV;AACA;AACA;AACA;AACA;;UACS;;UACD,KAAKvD,QAAL,CACE7c,OAAO,CAACsU,SAAR,GAAoBc,OAApB,KAAgC,GAAhC,GAAsCpV,OAAO,CAACoV,OAAR,EADxC,EAEE2E,QAAQ,CAACwF,QAAD,CAFV,EAGEvf,OAAO,CAAC6I,OAAR,EAHF;QAKD;;QACD,KAAK3F,QAAL,GAAiB,IAAjB;QAEA,IAAMmd,UAAU,GAAG,IAAI3hB,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2N,IAAd,CAAmBoN,WAAvB,CAAmC;UACpDC,WAAW,EAAE,IADuC;UAEpDC,OAAO,EAAE,IAF2C;UAGpD4E,OAAO,EAAED,KAH2C;UAIpD1E,OAAO,EAAE2E,OAJ2C;UAKpD1E,QAAQ,EAAEA,QAL0C;UAMpD/O,QAAQ,EAAEgJ,IAAI,CAAC4I,GAAL,CAASze,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAT,EAAqC,GAArC,CAN0C;UAOpDwb,QAAQ,EAAEniB,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB;QAP0C,CAAnC,EAQhB4V,IARgB,EAAnB;QASA,OAAO2F,UAAU,CAAC1F,OAAX,GAAqBC,IAArB,CAA0B,UAAApb,IAAI,EAAI;UACvC,IAAIA,IAAI,IAAIQ,OAAO,CAACwS,UAAR,EAAZ,EAAkC;YAChC;YACAxS,OAAO,CAACugB,aAAR,CAAsB/gB,IAAtB;;YACA,MAAI,CAACiJ,UAAL;;YACA,IACE,CAAC/E,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCrE,IAArC,EAA2C,YAA3C,CAAD,IACA,CAACkE,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCrE,IAArC,EAA2C,YAA3C,CAFH,EAGE;cACAQ,OAAO,CAACwgB,QAAR;YACD;UACF;;UACD,MAAI,CAACtd,QAAL,GAAiB,KAAjB;UACAmd,UAAU,CAACI,OAAX;UACA,OAAOjhB,IAAP;QACD,CAfM,CAAP;MAgBD,CA1uDM;MA4uDPwM,SA5uDO,qBA4uDGrM,EA5uDH,EA4uDOK,OA5uDP,EA4uDgB;QACrB,IAAI,CAACA,OAAL,EAAc;UACZA,OAAO,GAAG,KAAK+O,WAAL,EAAV;QACD;;QACD,IAAI/O,OAAO,IAAIA,OAAO,CAAC0H,WAAR,EAAf,EAAsC;UACpC1H,OAAO,CAAC0gB,MAAR;UACA,KAAKjY,UAAL;UACA,OAAOzI,OAAP;QACD;;QACD,OAAO,IAAP;MACD,CAtvDM;MAwvDPyG,MAxvDO,oBAwvDE;QACP,IAAI,KAAKvD,QAAT,EAAoB;UAClB4Q,QAAQ,CAAC6M,WAAT,CAAqB,KAArB;QACD,CAFD,MAEO;UACL,IAAM3gB,OAAO,GAAG,KAAKgM,SAAL,EAAhB;;UACA,IAAIhM,OAAJ,EAAa;YACX,KAAK4gB,YAAL,CAAkB5gB,OAAlB;UACD;QACF;MACF,CAjwDM;MAmwDP0G,OAnwDO,qBAmwDG;QACR,IAAI,KAAKxD,QAAT,EAAoB;UAClB4Q,QAAQ,CAAC6M,WAAT,CAAqB,MAArB;QACD,CAFD,MAEO;UACL,IAAM3gB,OAAO,GAAG,KAAK+O,WAAL,EAAhB;;UACA,IAAI/O,OAAJ,EAAa;YACX,IAAM6gB,IAAI,GAAG7gB,OAAO,CAACoY,KAAR,EAAb;YACA,KAAKwI,YAAL,CAAkBC,IAAlB;UACD;QACF;MACF,CA7wDM;MA+wDPla,QA/wDO,sBA+wDI;QACT,IAAMoE,MAAM,GAAG,KAAKgE,WAAL,EAAf;QACA,IAAM+R,gBAAgB,GAAG,KAAKC,YAAL,EAAzB;;QACA,IAAIhW,MAAM,IAAI+V,gBAAd,EAAgC;UAC9B,IAAI/V,MAAM,CAAC+N,WAAP,CAAmBgI,gBAAnB,EAAqC,CAAC,CAAtC,EAAyC,KAAzC,EAAgD,OAAhD,CAAJ,EAA8D;YAC5D;YACA,KAAKE,cAAL;UACD;QACF;MACF,CAxxDM;;MA0xDP;AACJ;AACA;AACA;AACA;MACIC,cA/xDO,0BA+xDQjhB,OA/xDR,EA+xDiB;QACtB,IAAMqO,KAAK,GAAG,KAAK/O,QAAL,CAAwBga,OAAxB,CAAgCtZ,OAAhC,CAAd;;QACA,IAAMkhB,YAAY,GAAG,KAAK3hB,QAAL,CAA+B+Z,OAA/B,CAAuCtZ,OAAvC,CAArB;;QACA,IAAIA,OAAO,CAACmhB,SAAZ,EAAuB;UACrB;UACA,IAAI9S,KAAK,IAAI,CAAb,EAAgB;YACd,KAAK/O,QAAL,CAAwB8hB,MAAxB,CAA+B/S,KAA/B,EAAsC,CAAtC;UACD;;UACD,IAAI6S,YAAY,IAAI,CAApB,EAAuB;YACrB,KAAK3hB,QAAL,CAA+B6hB,MAA/B,CAAsC/S,KAAtC,EAA6C,CAA7C;UACD;QACF,CARD,MAQO,IAAIrO,OAAO,CAACqhB,UAAR,EAAJ,EAA0B;UAC/B,IAAIhT,KAAK,KAAK,CAAC,CAAf,EAAkB;YAChB,KAAK/O,QAAL,CAAwB2I,IAAxB,CAA6BjI,OAA7B;UACD;;UACD,IAAIkhB,YAAY,KAAK,CAAC,CAAtB,EAAyB;YACvB,KAAK3hB,QAAL,CAA+B0I,IAA/B,CAAoCjI,OAApC;UACD;QACF,CAPM,MAOA;UACL,IAAIqO,KAAK,IAAI,CAAb,EAAgB;YACd,KAAK/O,QAAL,CAAwB8hB,MAAxB,CAA+B/S,KAA/B,EAAsC,CAAtC;UACD;;UACD,IAAI6S,YAAY,IAAI,CAApB,EAAuB;YACrB,KAAK3hB,QAAL,CAA+B6hB,MAA/B,CAAsC/S,KAAtC,EAA6C,CAA7C;UACD;QACF;;QACD,KAAKrI,OAAL,GAAesb,WAAf,CAA2B,KAAKhiB,QAAL,CAAwB2H,MAAxB,GAAiC,CAA5D;;QACA,KAAKsa,iBAAL;MACD,CA3zDM;MA6zDP5gB,KA7zDO,mBA6zDC;QACN,IAAMiL,OAAO,GAAG,KAAKnG,eAAL,CAAqB,SAArB,CAAhB;;QACA,KAAK+b,mBAAL,CAAyB,WAAzB;;QACA,IAAI,CAAC,KAAK5X,eAAL,CAAqB,YAArB,CAAL,EAAyC;UACvC,KAAK4X,mBAAL,CAAyB,YAAzB;QACD;;QACD5V,OAAO,CAAC6V,YAAR;;QACA,KAAKD,mBAAL,CAAyB,aAAzB;;QACA,KAAKA,mBAAL,CAAyB,eAAzB;;QACA5V,OAAO,CAAC6V,YAAR;;QACA,KAAKD,mBAAL,CAAyB,eAAzB;;QACA5V,OAAO,CAAC8V,SAAR;;QACA,KAAKF,mBAAL,CAAyB,iBAAzB;;QAEA,IAAI,CAAC,KAAK5X,eAAL,CAAqB,MAArB,CAAL,EAAmC;UACjC,KAAK4X,mBAAL,CAAyB,MAAzB;QACD;;QACD,IAAI,CAAC,KAAK5X,eAAL,CAAqB,OAArB,CAAL,EAAoC;UAClC,KAAK4X,mBAAL,CAAyB,OAAzB;QACD;;QACD,IAAI,CAAC,KAAK5X,eAAL,CAAqB,mBAArB,CAAL,EAAgD;UAC9C,KAAK4X,mBAAL,CAAyB,mBAAzB;QACD;;QACD,IAAI,CAAC,KAAK5X,eAAL,CAAqB,SAArB,CAAL,EAAsC;UACpC,KAAK4X,mBAAL,CAAyB,SAAzB;QACD;MACF,CAv1DM;MAy1DPG,cAz1DO,0BAy1DQnc,KAz1DR,EAy1DegE,GAz1Df,EAy1DoB;QACzB,IAAIA,GAAJ,EAAS;UACPA,GAAG,CAAC3B,qBAAJ,CAA0B,KAAKpC,eAAL,CAAqB,eAArB,CAA1B;QACD;;QACD,IAAID,KAAJ,EAAW;UACT,KAAKC,eAAL,CAAqB,aAArB,EAAoCyB,UAApC,CAA+C1B,KAAK,CAACkZ,iBAAN,EAA/C;;UAEA,IAAI,KAAK1Y,OAAL,GAAeb,WAAf,EAAJ,EAAkC;YAChCK,KAAK,CAACgC,IAAN,CAAW,WAAX,EAAwB,KAAK/B,eAAL,CAAqB,eAArB,CAAxB,EAA+D,SAA/D;UACD;QACF,CAND,MAMO;UACL,KAAKA,eAAL,CAAqB,aAArB,EAAoCyB,UAApC,CAA+C,KAA/C;UACA,KAAKzB,eAAL,CAAqB,eAArB,EAAsCyB,UAAtC,CAAiD,KAAjD;QACD;;QACD,KAAK0a,sBAAL;MACD,CAx2DM;MA02DPA,sBA12DO,oCA02DkB;QACvB,IAAMxf,QAAQ,GAAG,KAAK2M,WAAL,EAAjB;;QACA,IAAI,KAAKrE,aAAL,EAAJ,EAA0B;UACxB,IAAMzE,OAAO,GAAG,KAAKR,eAAL,CAAqB,SAArB,CAAhB;;UACA,IAAI,KAAKlB,eAAL,OAA2B,kBAA3B,IAAiDnC,QAArD,EAA+D;YAC7D;YACA,IAAI+G,IAAI,GAAG,EAAX;YACA,IAAI0Y,IAAI,GAAGzf,QAAQ,CAACyG,OAAT,EAAX;;YACA,IAAI,KAAKxF,UAAL,KAAoB,MAAxB,EAAgC;cAC9B,OAAOwe,IAAI,IAAIA,IAAI,CAACtC,QAAL,KAAkB,QAAjC,EAA2C;gBACzC,IAAIsC,IAAI,CAACtC,QAAL,KAAkB,SAAtB,EAAiC;kBAC/BtZ,OAAO,CAAC6b,QAAR,CAAiBD,IAAI,CAACnQ,YAAL,CAAkB,IAAlB,CAAjB;kBACA;gBACD;;gBACDmQ,IAAI,GAAGA,IAAI,CAACE,UAAZ;cACD;YACF,CARD,MAQO;cACL,OAAOF,IAAI,IAAIA,IAAI,CAACtC,QAAL,KAAkB,OAAjC,EAA0C;gBACxC,IAAIsC,IAAI,CAACtC,QAAL,KAAkB,MAAtB,EAA8B;kBAC5BpW,IAAI,CAACkU,OAAL,CAAawE,IAAI,CAACnQ,YAAL,CAAkB,MAAlB,CAAb;gBACD;;gBACDmQ,IAAI,GAAGA,IAAI,CAACE,UAAZ;cACD;;cACD,IAAI5Y,IAAI,CAAClC,MAAL,GAAc,CAAlB,EAAqB;gBACnBhB,OAAO,CAAC6b,QAAR,CAAiB3Y,IAAI,CAACjB,GAAL,EAAjB,EAA6BiB,IAAI,CAACwU,IAAL,CAAU,GAAV,CAA7B;cACD;YACF;;YACD1X,OAAO,CAAC+b,kBAAR,CAA2B5f,QAAQ,CAAC6f,aAAT,EAA3B;UACD,CAxBD,MAwBO;YACLhc,OAAO,CAAC+b,kBAAR,CAA2B,IAA3B;UACD;QACF;MACF,CA14DM;MA44DPvhB,eA54DO,2BA44DSd,EA54DT,EA44Da;QAClB,IAAI,KAAKoP,WAAL,MAAsB,KAAKmT,SAAL,EAA1B,EAA4C;UAC1C,IAAIviB,EAAE,CAACqN,gBAAH,OAA0B,OAA9B,EAAuC;YACrC,IAAI,CAAC,KAAK9J,QAAV,EAAqB;cACnB,KAAK4I,OAAL;YACD;UACF;QACF;MACF,CAp5DM;MAs5DPqW,aAt5DO,yBAs5DO3c,KAt5DP,EAs5Dc;QAAA;;QACnB,IAAM4H,IAAI,GAAG,KAAK3H,eAAL,CAAqB,MAArB,CAAb;QACA,IAAMlC,IAAI,GAAG,KAAKyC,OAAL,EAAb;;QACA,KAAKG,cAAL,CAAoB,IAApB,EAA0B,IAA1B,EAAgC,IAAhC;;QACA,IAAIX,KAAK,IAAIjC,IAAb,EAAmB;UACjB,IAAI,KAAKN,cAAT,EAAyB;YACvB,KAAKA,cAAL,CAAoBmf,IAApB,CAAyB7e,IAAzB,EAA+BiC,KAA/B,EAAsC,IAAtC,EAA4C;cAC1Cgb,QAAQ,EAAE,KADgC;cAE1C6B,iBAAiB,EAAE,IAFuB;cAG1CC,QAAQ,EAAE;YAHgC,CAA5C;;YAMA,KAAKrf,cAAL,CAAoBsf,iBAApB,CAAsC/c,KAAtC,EAA6CoV,IAA7C,CAAkD,UAAAsB,GAAG,EAAI;cACvD,IAAIA,GAAG,KAAK,IAAZ,EAAkB;gBAChB,OAAI,CAACzD,IAAL,CAAUlV,IAAI,CAACif,OAAL,KAAiB,yBAA3B;;gBACA,OAAI,CAACC,SAAL,CAAmBjd,KAAnB;cACD,CAHD,MAGO;gBACL,IAAM0J,MAAM,GAAG,IAAIxQ,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsQ,MAAd,CAAqBiP,eAAzB,CAAyC5a,IAAzC,EAA+CiC,KAA/C,EAAsD0W,GAAtD,CAAf;gBAEAhN,MAAM,CAACxP,WAAP,CAAmB,QAAnB,EAA6B,UAAAC,EAAE,EAAI;kBACjC,QAAQA,EAAE,CAACC,OAAH,EAAR;oBACE,KAAK,SAAL;sBACE,OAAI,CAAC6iB,SAAL,CAAmBjd,KAAnB,EAA0B0W,GAA1B;;sBACA;;oBAEF,KAAK,aAAL;sBAAoB;wBAClB,IAAM3Y,KAAI,GAAG,OAAI,CAACyC,OAAL,EAAb;;wBACAtH,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc8jB,IAAd,CAAmB1e,WAAnB,GAAiC2e,SAAjC,CAA2Cpf,KAA3C;wBACApF,EAAE,CAACmE,KAAH,CAASwX,OAAT,CAAiB8I,GAAjB,CAAqBC,cAArB,CAAoC,qBAApC,EAA2D;0BACzDtf,IAAI,EAAEA,KAAI,CAACuf,WAAL,EADmD;0BAEzDC,OAAO,EAAE,6BAFgD;0BAGzDte,cAAc,EAAE;4BACdue,WAAW,EAAE;0BADC;wBAHyC,CAA3D;wBAQA;sBACD;;oBAED,KAAK,QAAL;sBACE;sBACAtkB,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc8jB,IAAd,CAAmB1e,WAAnB,GAAiC2e,SAAjC,CAA2C,OAAI,CAAC3c,OAAL,EAA3C;sBACA;kBAtBJ;;kBAyBAkJ,MAAM,CAAC+T,IAAP;kBACA/T,MAAM,CAACuR,OAAP;gBACD,CA5BD;gBA6BAvR,MAAM,CAACwL,IAAP;cACD;YACF,CAtCD;UAuCD;QACF,CAhDD,MAgDO;UACLtN,IAAI,CAAC8V,UAAL;;UACA,IAAI,KAAKtZ,eAAL,CAAqB,YAArB,CAAJ,EAAwC;YACtC,KAAKnE,eAAL,CAAqB,YAArB,EAAmCyB,UAAnC,CAA8C,KAA9C;UACD;QACF;MACF,CAh9DM;MAk9DPjC,QAl9DO,sBAk9DY;QACjB,IAAI1B,IAAJ;QACA7E,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBsB,QAApB,CAA6BC,IAA7B,CAAkCqQ,WAAlC,GAAgD3V,IAAhD,CAAqD,UAAAojB,CAAC,EAAI;UACxD,IAAIA,CAAC,CAAC/N,OAAF,OAAgB,6BAApB,EAAmD;YACjD7R,IAAI,GAAG4f,CAAP;YACA,OAAO,IAAP;UACD;;UACD,OAAO,KAAP;QACD,CAND;;QAOA,IAAI,CAAC5f,IAAL,EAAW;UACTA,IAAI,GAAG,IAAI7E,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBsB,QAAxB,CAAiC,6BAAjC,EAAgE,GAAhE,EAAqE1G,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBsB,QAApB,CAA6BC,IAAlG,CAAP;UAEA9B,IAAI,CAAC6f,YAAL,CAAkB,IAAlB;QACD;;QACD,OAAO7f,IAAP;MACD,CAj+DM;MAm+DDkf,SAn+DC,qBAm+Dajd,KAn+Db,EAm+DoB6d,MAn+DpB,EAm+D4B;QAAA;;QAAA;UAAA;UAAA;YAAA;cAAA;gBAC3BjW,IAD2B,GACpB,OAAI,CAAC3H,eAAL,CAAqB,MAArB,CADoB;gBAE3BlC,IAF2B,GAEpB,OAAI,CAACyC,OAAL,EAFoB;;gBAAA,KAG7BzC,IAH6B;kBAAA;kBAAA;gBAAA;;gBAIzB+f,GAJyB,GAInBnlB,EAAE,CAAColB,GAAH,CAAOC,QAAP,CAAgBC,UAAhB,CAA2Bje,KAA3B,CAJmB;gBAKzBke,WALyB,GAKXJ,GAAG,CAACK,eALO;gBAAA;gBAAA,OAMV,OAAI,CAACrgB,SAAL,CACnBogB,WAAW,CAACE,cAAZ,CAA2B,2CAA3B,EAAwE,2BAAxE,CADmB,CANU;;cAAA;gBAMzBpI,MANyB;gBAUzBL,aAVyB,GAUTK,MAAM,CAACqI,cAAP,CAAsBH,WAAW,CAACnE,QAAlC,CAVS;gBAWzBvO,QAXyB,GAWd,IAAItS,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAckF,KAAd,CAAoBkY,UAAxB,CAAmC0H,WAAnC,EAAgDvI,aAAhD,EAA+D,OAA/D,CAXc;gBAa/B,OAAI,CAAC9X,UAAL,GAAkBmY,MAAM,CAACsI,YAAP,EAAlB;gBACA9S,QAAQ,CAAC+S,WAAT,CAAqBxgB,IAAI,CAACygB,YAAL,EAArB;gBACAhT,QAAQ,CAACiB,IAAT;gBACA7E,IAAI,CAAC6W,QAAL,CAAcjT,QAAd;;gBACA,IAAI,OAAI,CAACpH,eAAL,CAAqB,YAArB,CAAJ,EAAwC;kBACtC,OAAI,CAACnE,eAAL,CAAqB,YAArB,EAAmCC,aAAnC,CAAiDnC,IAAI,CAACygB,YAAL,KAAsB,SAAtB,GAAkC,UAAnF,EADsC,CAGtC;;;kBACA5W,IAAI,CAAC8W,uBAAL,CAA6B3gB,IAAI,CAACygB,YAAL,KAAsB,EAAtB,GAA2B,CAAxD;gBACD;;gBACD,IAAI,OAAI,CAACtZ,aAAL,EAAJ,EAA0B;kBAClBzE,OADkB,GACR,OAAI,CAACR,eAAL,CAAqB,SAArB,CADQ;;kBAExB,IAAIlC,IAAI,CAAC4B,WAAL,EAAJ,EAAwB;oBACtB,IAAI,CAACc,OAAO,CAACD,OAAR,EAAL,EAAwB;sBACtBC,OAAO,CAACC,OAAR,CAAgB,OAAI,CAACjB,QAAL,EAAhB;oBACD;kBACF,CAJD,MAIO;oBACLgB,OAAO,CAACC,OAAR,CAAgB3C,IAAhB;kBACD;;kBACD,OAAI,CAAC4C,cAAL,CAAoB,IAApB,EAA0BX,KAA1B;;kBACA,IAAI,CAACS,OAAO,CAACic,SAAR,EAAL,EAA0B;oBACxBjc,OAAO,CAACyU,IAAR;kBACD;gBACF;;gBACD,IAAInX,IAAI,CAAC2B,WAAL,EAAJ,EAAwB;kBACtB,OAAI,CAACqc,iBAAL;gBACD;;gBACD,IAAI8B,MAAJ,EAAY;kBACVA,MAAM,CAAC/a,OAAP,CAAe,UAAAH,KAAK,EAAI;oBACtB,IAAIA,KAAK,CAACgB,IAAN,IAAchB,KAAK,CAACgB,IAAN,CAAW3F,UAAX,CAAsB,QAAtB,CAAlB,EAAmD;sBACjD,IAAIsO,OAAO,GAAGd,QAAd;sBACA,IAAImT,KAAK,GAAGhc,KAAK,CAACgB,IAAN,CAAWib,MAAX,CAAkB,CAAlB,EAAqB3H,KAArB,CAA2B,GAA3B,CAAZ;;sBACA,OAAO0H,KAAK,CAACld,MAAN,GAAe,CAAtB,EAAyB;wBACvB,IAAIod,IAAI,GAAGF,KAAK,CAACG,KAAN,EAAX;wBACA,IAAIC,KAAK,GAAG,qBAAqBC,IAArB,CAA0BH,IAA1B,CAAZ;;wBACA,IAAIE,KAAJ,EAAW;0BACTzS,OAAO,GAAGA,OAAO,CAAC4D,WAAR,GAAsBtO,OAAtB,CAA8BuV,QAAQ,CAAC4H,KAAK,CAAC,CAAD,CAAN,CAAtC,CAAV;;0BACA,IAAIzS,OAAJ,EAAa;4BACX,IAAI;8BACF;8BACAA,OAAO,CAACG,IAAR;4BACD,CAHD,CAGE,OAAOlJ,CAAP,EAAU;8BACV,OAAI,CAACZ,KAAL,CAAW,mBAAmB2J,OAAO,CAACsD,OAAR,EAAnB,GAAuC,IAAvC,GAA8CrM,CAAC,CAAC0b,QAAF,EAAzD;;8BAEA3S,OAAO,GAAG,IAAV;8BACA;4BACD;0BACF,CAVD,MAUO;4BACL;0BACD;wBACF,CAfD,MAeO;0BACL,OAAI,CAAC3J,KAAL,CAAW,iCAAiCkc,IAA5C;;0BACAvS,OAAO,GAAG,IAAV;0BACA;wBACD;sBACF;;sBACD,IAAIA,OAAJ,EAAa;wBACXA,OAAO,CAAC4S,QAAR,CAAiB,KAAjB;wBACA5S,OAAO,CAAC0O,QAAR,CAAiB,KAAjB;wBACApT,IAAI,CAACyE,kBAAL,CAAwBC,OAAxB;sBACD;oBACF;kBACF,CAlCD;gBAmCD;;gBA5E8B;gBAAA;;cAAA;gBA8E/B,OAAI,CAACzO,UAAL,GAAkB,IAAlB;;cA9E+B;cAAA;gBAAA;YAAA;UAAA;QAAA;MAgFlC,CAnjEM;MAqjEPke,iBArjEO,+BAqjEa;QAClB,IAAMoD,OAAO,GAAG,KAAKC,iBAAL,EAAhB;;QACA,IAAI,KAAK3hB,cAAT,EAAyB;UACvB,KAAKA,cAAL,CAAoB4hB,cAApB,CAAmC,KAAK7e,OAAL,EAAnC,EAAmD2e,OAAnD;QACD;;QACD,IAAI,KAAKG,oBAAL,MAA+B,KAAKpa,aAAL,EAAnC,EAAyD;UACvD,KAAKvE,cAAL,CAAoB,IAApB,EAA0Bwe,OAA1B;QACD;MACF,CA7jEM;MA+jEPxe,cA/jEO,0BA+jEQxG,EA/jER,EA+jEYglB,OA/jEZ,EA+jEqBI,KA/jErB,EA+jE4B;QAAA;;QACjC,IAAM/f,WAAW,GAAG,KAAKS,eAAL,CAAqB,SAArB,EAAgCO,OAAhC,EAApB;;QACA,IAAIhB,WAAJ,EAAiB;UACf,IAAI,CAAC2f,OAAD,IAAY,CAACI,KAAjB,EAAwB;YACtBJ,OAAO,GAAG,KAAKC,iBAAL,CAAuB,IAAvB,CAAV;UACD,CAFD,MAEO,IAAIG,KAAK,KAAK,IAAd,EAAoB;YACzB,KAAKtf,eAAL,CAAqB,SAArB,EAAgCwd,IAAhC;YACA;UACD;;UACD,KAAKxd,eAAL,CAAqB,SAArB,EAAgCiV,IAAhC;;UACA,IAAI1V,WAAW,CAACE,WAAZ,EAAJ,EAA+B;YAC7B,KAAK8f,OAAL,CAAaC,UAAb,CACE;cACE9b,IAAI,EAAEnE,WAAW,CAAC8d,WAAZ,EADR;cAEE7Y,IAAI,EAAE;YAFR,CADF,EAKE0a,OALF,EAME,UAAAtI,GAAG,EAAI;cACL,IAAIA,GAAJ,EAAS;gBACP;gBACA,OAAI,CAAC/W,cAAL,CAAoB,KAApB;;gBACA,OAAI,CAAC6C,KAAL,CAAWkU,GAAX;;gBACA3d,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCrQ,KAAlC,CAAwC,OAAI,CAAClH,EAAL,CAAQ,kEAAR,CAAxC;cACD,CALD,MAKO;gBACL9C,EAAE,CAACmE,KAAH,CAASwX,OAAT,CAAiB8I,GAAjB,CAAqBC,cAArB,CAAoC7d,WAAW,CAACkgB,WAAZ,EAApC,EAA+D;kBAC7DlL,IAAI,EAAE,gBADuD;kBAE7DzW,IAAI,EAAEyB,WAFuD;kBAG7DxF,IAAI,EAAEmlB,OAHuD;kBAI7DQ,MAAM,EAAE;gBAJqD,CAA/D;;gBAMA,OAAI,CAAC5lB,QAAL,CAA+B8I,SAA/B;;gBACA,OAAI,CAACyB,iBAAL;;gBACA9E,WAAW,CAACogB,cAAZ;cACD;YACF,CAvBH,EAwBE,IAxBF;UA0BD,CA3BD,MA2BO;YACL,KAAKJ,OAAL,CAAaK,UAAb,CACE;cACElc,IAAI,EAAEnE,WAAW,CAAC8d,WAAZ,EADR;cAEE7Y,IAAI,EAAE;YAFR,CADF,EAKE0a,OALF,EAME,UAAAtI,GAAG,EAAI;cACL,IAAIA,GAAJ,EAAS;gBACP3d,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAc2Z,QAAd,CAAuBC,UAAvB,CAAkCrQ,KAAlC,CAAwCkU,GAAxC;cACD,CAFD,MAEO;gBACLle,EAAE,CAACmE,KAAH,CAASwX,OAAT,CAAiB8I,GAAjB,CAAqBC,cAArB,CAAoC7d,WAAW,CAACkgB,WAAZ,EAApC,EAA+D;kBAC7DlL,IAAI,EAAE,gBADuD;kBAE7DzW,IAAI,EAAEyB,WAFuD;kBAG7DxF,IAAI,EAAEmlB,OAHuD;kBAI7DQ,MAAM,EAAE;gBAJqD,CAA/D;;gBAOA,OAAI,CAAC5lB,QAAL,CAA+B8I,SAA/B;;gBACA,OAAI,CAACyB,iBAAL;cACD;YACF,CApBH,EAqBE,IArBF;UAuBD;QACF;MACF,CA9nEM;MAgoEP8a,iBAhoEO,6BAgoEWU,IAhoEX,EAgoEiB;QACtB,IAAMlY,IAAI,GAAG,KAAK3H,eAAL,CAAqB,MAArB,CAAb;;QACA,IAAI2H,IAAI,CAAC8C,QAAL,EAAJ,EAAqB;UACnB,IAAMc,QAAQ,GAAG5D,IAAI,CAAC8C,QAAL,GAAgBrH,OAAhB,EAAjB;;UACA,IAAIyc,IAAJ,EAAU;YACR,OAAO,IAAIC,aAAJ,GAAoBC,iBAApB,CAAsCxU,QAAQ,CAAC6J,aAA/C,CAAP;UACD,CAJkB,CAKnB;;;UACA,OAAOnc,EAAE,CAACkO,IAAH,CAAQ6Y,UAAR,CAAmBlC,GAAnB,CAAuBvS,QAAQ,CAAC6J,aAAhC,CAAP;QACD;;QACD,OAAO,IAAP;MACD,CA3oEM;MA6oEP6K,QA7oEO,sBA6oEI;QACT;;QACA,KAAKpmB,QAAL,CAAwBgJ,OAAxB,CAAgC,UAAAC,IAAI;UAAA,OAAIA,IAAI,CAACod,OAAL,EAAJ;QAAA,CAApC;;QACA,KAAKrmB,QAAL,GAA0B,EAA1B;QACA,KAAK8I,eAAL;MACD,CAlpEM;MAopEPuB,WAppEO,uBAopEKpG,IAppEL,EAopEW;QAChB,OAAO7E,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BjS,eAA1B,CAA0C6b,IAA1C,CAA+CnZ,IAAI,CAAC6R,OAAL,EAA/C,CAAP;MACD,CAtpEM;MAwpEPxO,SAxpEO,uBAwpEK;QACV,IAAMgf,aAAa,GAAGznB,EAAE,CAACQ,EAAH,CAAM0B,IAAN,CAAWwlB,YAAX,CAAwB7hB,WAAxB,GAAsC8hB,gBAAtC,EAAtB;QACA,IAAMC,UAAU,GAAG;UACjBtH,OAAO,EAAE,KAAKxd,EAAL,CAAQ,MAAR,CADQ;UAEjB+kB,KAAK,EAAE,IAFU;UAGjBC,KAAK,EAAE,sBAHU;UAIjBjb,QAAQ,EAAEgJ,IAAI,CAAC4I,GAAL,CAAS,GAAT,EAAcze,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBC,QAAhB,EAAd,CAJO;UAKjBohB,SAAS,EAAE/nB,EAAE,CAACyG,GAAH,CAAOC,QAAP,CAAgBshB,SAAhB,EALM;UAMjBrM,OAAO,EAAE;QANQ,CAAnB;;QASA,IAAI8L,aAAa,KAAK,KAAKngB,eAAL,CAAqB,WAArB,CAAtB,EAAyD;UACvDsgB,UAAU,CAACjM,OAAX,GAAqB,KAAK7Y,EAAL,CACnB;AACV;AACA;AACA;AACA;AACA;AACA,yBAP6B,CAArB;QASD,CAVD,MAUO;UACL;UACA8kB,UAAU,CAACjM,OAAX,GAAqB,KAAK7Y,EAAL,CACnB;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4HApB6B,CAArB;QAsBD;;QACD,IAAIvC,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcsQ,MAAd,CAAqBkX,QAAzB,CAAkCL,UAAlC,EAA8CrL,IAA9C;MACD;IAvsEM,CA1IkC;;IAo1E3C;AACF;AACA;AACA;AACA;IACE2L,QAz1E2C,sBAy1EhC;MACT,KAAKhnB,QAAL,GAAgB,IAAhB;MACA,KAAK4D,cAAL,GAAsB,IAAtB;;MACA,KAAKqjB,aAAL,CAAmB,UAAnB,EAAyC,UAAzC;;MACAnoB,EAAE,CAACkC,IAAH,CAAQC,IAAR,CAAaC,cAAb,GAA8BC,OAA9B,GAAwC+lB,cAAxC,CAAuD,OAAvD,EAAgE,KAAK9lB,eAArE,EAAsF,IAAtF;IACD;EA91E0C,CAA7C;EAtBA/B,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,MAAd,CAAqBiU,IAArB,CAA0BxU,aAA1B,GAA0CA,aAA1C"
}