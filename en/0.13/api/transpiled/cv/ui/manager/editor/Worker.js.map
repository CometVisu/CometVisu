{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "constructor",
    "call",
    "_files",
    "_worker",
    "cv",
    "data",
    "FileWorker",
    "getInstance",
    "addListener",
    "_onMessage",
    "properties",
    "editor",
    "check",
    "nullable",
    "members",
    "open",
    "file",
    "code",
    "schema",
    "features",
    "postMessage",
    "path",
    "getFullPath",
    "xml",
    "Document",
    "isXmlDocument",
    "documentElement",
    "outerHTML",
    "close",
    "contentChanged",
    "content",
    "validateConfig",
    "isConfigFile",
    "getServerPath",
    "log",
    "Logger",
    "error",
    "validateXmlConfig",
    "e",
    "topic",
    "getData",
    "getEditor",
    "isTemporary",
    "setModified",
    "modified",
    "setHash",
    "currentHash",
    "setValid",
    "length",
    "showErrors",
    "showDecorations",
    "destruct",
    "terminate",
    "ui",
    "manager",
    "Worker"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Worker.js"
  ],
  "sourcesContent": [
    "/* Worker.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.editor.Worker', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    super();\n    this._files = {};\n    // create WebWorker\n    this._worker = cv.data.FileWorker.getInstance();\n    this._worker.addListener('message', this._onMessage, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    editor: {\n      check: 'cv.ui.manager.editor.AbstractEditor',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _worker: null,\n    _files: null,\n\n    open(file, code, schema, features) {\n      this._worker.postMessage([\n        'openFile',\n        {\n          path: file.getFullPath(),\n          code: qx.xml.Document.isXmlDocument(code) ? code.documentElement.outerHTML : code,\n          schema: schema\n        },\n\n        features\n      ]);\n\n      this._files[file.getFullPath()] = file;\n    },\n\n    close(file) {\n      this._worker.postMessage([\n        'closeFile',\n        {\n          path: file.getFullPath()\n        }\n      ]);\n\n      delete this._files[file.getFullPath()];\n    },\n\n    contentChanged(file, content) {\n      this._worker.postMessage([\n        'contentChange',\n        {\n          path: file.getFullPath(),\n          code: content\n        }\n      ]);\n    },\n\n    validateConfig(file) {\n      if (file.isConfigFile()) {\n        return this._worker.validateConfig(file.getServerPath());\n      }\n      qx.log.Logger.error(this, file.getFullPath() + ' is no configuration file');\n\n      return true;\n    },\n\n    validateXmlConfig(content) {\n      return this._worker.validateXmlConfig(content);\n    },\n\n    _onMessage(e) {\n      let topic = e.getData().topic;\n      let data = e.getData().data;\n      let path = e.getData().path;\n      let file = this._files[path];\n      if (!file && topic !== 'validationResult') {\n        qx.log.Logger.error(this, 'no file found for path ' + path + ' ignoring worker message for topic ' + topic);\n\n        return;\n      }\n      let editor = this.getEditor();\n      switch (topic) {\n        case 'modified':\n          // new files are always modified, to not override that state\n          if (!file.isTemporary()) {\n            file.setModified(data.modified);\n          }\n          file.setHash(data.currentHash);\n          break;\n\n        case 'hash':\n          file.setHash(data);\n          break;\n\n        case 'errors':\n          file.setValid(!data || data.length === 0);\n          if (editor) {\n            editor.showErrors(path, data);\n          }\n          break;\n\n        case 'decorations':\n          if (editor) {\n            editor.showDecorations(path, data);\n          }\n          break;\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._worker.terminate();\n    this._worker = null;\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}