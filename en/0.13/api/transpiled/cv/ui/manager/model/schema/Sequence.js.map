{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "model",
    "schema",
    "Base",
    "construct",
    "node",
    "parse",
    "properties",
    "type",
    "refine",
    "init",
    "elementsHaveOrder",
    "members",
    "getSchema",
    "subNodes",
    "Array",
    "from",
    "getNode",
    "children",
    "forEach",
    "subNode",
    "subObject",
    "nodeName",
    "Element",
    "setSortable",
    "_allowedElements",
    "getName",
    "Choice",
    "_subGroupings",
    "push",
    "Sequence",
    "Group",
    "Any",
    "_sortedContent",
    "getCommentNodeSchemaElement",
    "getRegex",
    "separator",
    "nocapture",
    "_regexCache",
    "regexString",
    "elementRegexes",
    "element",
    "join",
    "bounds",
    "getBounds",
    "min",
    "undefined",
    "max",
    "Number",
    "POSITIVE_INFINITY",
    "getBoundsForElementName",
    "childName",
    "elementBounds",
    "sequenceBounds",
    "resultBounds",
    "Object",
    "prototype",
    "hasOwnProperty",
    "call",
    "isNaN",
    "childBounds",
    "tmpBounds",
    "i",
    "length",
    "getAllowedElementsSorting",
    "sortNumber",
    "namesWithSorting",
    "item",
    "mySortNumber",
    "getType",
    "subSortedElements",
    "assign"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Sequence.js"
  ],
  "sourcesContent": [
    "/* Sequence.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * a single sequence.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Sequence', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(node, schema) {\n    super(node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'sequence'\n    },\n\n    elementsHaveOrder: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse() {\n      super.parse();\n      const schema = this.getSchema();\n\n      // for a sequence, we need to keep the order of the elements\n      // so we have to use a 'mixed' approach in reading them\n      const subNodes = Array.from(this.getNode().children);\n\n      subNodes.forEach(subNode => {\n        let subObject;\n\n        switch (subNode.nodeName) {\n          case 'xsd:element':\n          case 'element':\n            subObject = new cv.ui.manager.model.schema.Element(subNode, schema);\n            // sequences' children are non-sortable\n            subObject.setSortable(false);\n            this._allowedElements[subObject.getName()] = subObject;\n            break;\n          case 'xsd:choice':\n          case 'choice':\n            subObject = new cv.ui.manager.model.schema.Choice(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:sequence':\n          case 'sequence':\n            subObject = new cv.ui.manager.model.schema.Sequence(subNode, schema);\n\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:group':\n          case 'group':\n            subObject = new cv.ui.manager.model.schema.Group(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:any':\n          case 'any':\n            subObject = new cv.ui.manager.model.schema.Any(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n        }\n\n        this._sortedContent.push(subObject);\n      });\n      this._allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex(separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // create list of allowed elements\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      const elementRegexes = [];\n\n      // this goes over ALL elements AND sub-groupings\n      this._sortedContent.forEach(element => {\n        elementRegexes.push(element.getRegex(separator, nocapture));\n      });\n\n      regexString += elementRegexes.join('');\n\n      regexString += ')';\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName(childName) {\n      // we are a sequence-element; there is actually a lot of sayings ...\n      if (typeof this._allowedElements[childName] !== 'undefined') {\n        const elementBounds = this._allowedElements[childName].getBounds();\n        const sequenceBounds = this.getBounds();\n\n        const resultBounds = {\n          min: 1,\n          max: 1\n        };\n\n        // if it is bounded, we must duplicate element and sequence bounds\n        // (an element may appear as often as the number of sequences times the number of elements\n        // in each sequence - roughly)\n        if (Object.prototype.hasOwnProperty.call(elementBounds, 'min')) {\n          resultBounds.min = elementBounds.min;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'min') && !isNaN(sequenceBounds.min)) {\n          resultBounds.min *= sequenceBounds.min;\n        }\n\n        if (elementBounds.max === Number.POSITIVE_INFINITY || sequenceBounds.max === Number.POSITIVE_INFINITY) {\n          resultBounds.max = Number.POSITIVE_INFINITY;\n        } else {\n          if (Object.prototype.hasOwnProperty.call(elementBounds, 'max')) {\n            resultBounds.max = elementBounds.max;\n          }\n\n          if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'max') && !isNaN(sequenceBounds.max)) {\n            resultBounds.max *= sequenceBounds.max;\n          }\n        }\n\n        return resultBounds;\n      }\n\n      let childBounds;\n\n      let tmpBounds;\n\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        tmpBounds = this._subGroupings[i].getBoundsForElementName(childName);\n\n        if (undefined !== tmpBounds) {\n          // once we find the first set of bounds, we return that\n          childBounds = tmpBounds;\n          break;\n        }\n      }\n\n      return childBounds;\n    },\n\n    /**\n     * get the sorting of the allowed elements\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     * @param sortNumber  integer the sortNumber of a parent (only used when recursive)\n     * @return object     list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting(sortNumber) {\n      const namesWithSorting = {};\n\n      this._sortedContent.forEach((item, i) => {\n        let mySortNumber = i;\n        if (sortNumber !== undefined) {\n          mySortNumber = sortNumber + '.' + i;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortNumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortNumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      });\n\n      return namesWithSorting;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}