{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "title",
    "element",
    "changes",
    "type",
    "setTitle",
    "setElement",
    "setChanges",
    "setChangeType",
    "properties",
    "check",
    "changeType",
    "init",
    "members",
    "undo",
    "getElement",
    "success",
    "change",
    "isDisposed",
    "getChangeType",
    "getChanges",
    "forEach",
    "cv",
    "ui",
    "manager",
    "model",
    "ElementChange",
    "setAttribute",
    "attribute",
    "old",
    "updateModified",
    "parent",
    "insertChild",
    "child",
    "index",
    "remove",
    "moveTo",
    "oldParent",
    "oldIndex",
    "redo",
    "value"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/ElementChange.js"
  ],
  "sourcesContent": [
    "/* ElementChange.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * An atomic change on an cv.ui.manager.model.XmlElement that can be undone / redone.\n */\nqx.Class.define('cv.ui.manager.model.ElementChange', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(title, element, changes, type) {\n    super();\n    this.setTitle(title);\n    this.setElement(element);\n    this.setChanges(changes);\n    this.setChangeType(type || 'content');\n  },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement'\n    },\n\n    title: {\n      check: 'String'\n    },\n\n    changes: {\n      check: 'Array'\n    },\n\n    changeType: {\n      check: ['content', 'created', 'deleted', 'moved'],\n      init: ['content']\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * Undo all changes\n     * @return {Boolean} true if all changes are undone\n     */\n    undo() {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.undo();\n              } else {\n                element.setAttribute(change.attribute, change.old);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.child) {\n              change.child.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.oldParent, change.oldIndex, true);\n\n            break;\n        }\n      }\n      return success;\n    },\n\n    /**\n     * Redo all change\n     *  @return {Boolean} true if all changes are redone\n     */\n    redo() {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.redo();\n              } else {\n                element.setAttribute(change.attribute, change.value);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            if (element) {\n              element.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.parent, change.index, true);\n            break;\n        }\n      }\n      return success;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}