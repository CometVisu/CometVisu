{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "filename",
    "match",
    "Error",
    "__filename",
    "setStructure",
    "endsWith",
    "__allowedRootElements",
    "__referencedNodeCache",
    "__typeNodeCache",
    "_cacheXSD",
    "statics",
    "__CACHE",
    "getInstance",
    "schemaFile",
    "prototype",
    "hasOwnProperty",
    "call",
    "schema",
    "cv",
    "ui",
    "manager",
    "model",
    "Schema",
    "util",
    "ResourceManager",
    "toUri",
    "isLoaded",
    "Promise",
    "resolve",
    "reject",
    "timer",
    "setTimeout",
    "addListenerOnce",
    "clearTimeout",
    "properties",
    "loaded",
    "check",
    "init",
    "event",
    "structure",
    "apply",
    "members",
    "__xsd",
    "__textNodeSchemaElement",
    "__commentNodeSchemaElement",
    "_widgetNames",
    "__rootElementName",
    "__pageParentElementName",
    "__pageElementName",
    "_applyStructure",
    "onLoaded",
    "callback",
    "context",
    "ajaxRequest",
    "io",
    "request",
    "Xhr",
    "set",
    "accept",
    "e",
    "req",
    "getTarget",
    "xml",
    "getResponse",
    "Document",
    "fromString",
    "querySelectorAll",
    "include",
    "loadXml",
    "getAttribute",
    "includeXml",
    "target",
    "parentElement",
    "remove",
    "includedChild",
    "appendChild",
    "_parseXSD",
    "send",
    "file",
    "getStatusText",
    "forEach",
    "element",
    "name",
    "Element",
    "setLoaded",
    "getElementNode",
    "getReferencedNode",
    "type",
    "refName",
    "noFallback",
    "fallbackType",
    "selector",
    "ref",
    "querySelector",
    "hasAttribute",
    "getTypeNode",
    "typeNode",
    "getTextNodeSchemaElement",
    "tmpXML",
    "createElement",
    "setAttribute",
    "getCommentNodeSchemaElement",
    "getSchemaDOM",
    "getWidgetNames",
    "root",
    "pageParent",
    "getSchemaElementForElementName",
    "page",
    "keys",
    "getAllowedElements",
    "filter",
    "startsWith",
    "isRoot",
    "isPage",
    "destruct",
    "_disposeObjects",
    "_disposeMap"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Schema.js"
  ],
  "sourcesContent": [
    "/* Schema.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.model.Schema', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(filename) {\n    super();\n    if (!filename || !filename.match(/\\.xsd$/)) {\n      throw new Error('no, empty or invalid filename given, can not instantiate without one');\n    }\n    this.__filename = filename;\n    this.setStructure(filename.endsWith('visu_config_tile.xsd') ? 'tile' : 'pure');\n\n    this.__allowedRootElements = {};\n    this.__referencedNodeCache = {};\n    this.__typeNodeCache = {};\n    this._cacheXSD();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    __CACHE: {},\n\n    async getInstance(schemaFile) {\n      if (!Object.prototype.hasOwnProperty.call(this.__CACHE, schemaFile)) {\n        const schema = this.__CACHE[schemaFile] = new cv.ui.manager.model.Schema(\n          qx.util.ResourceManager.getInstance().toUri(schemaFile)\n        );\n        if (!schema.isLoaded()) {\n          return new Promise((resolve, reject) => {\n            const timer = setTimeout(() => {\n              reject(new Error('timeout loading schema file'));\n            }, 5000);\n            schema.addListenerOnce('changeLoaded', () => {\n              clearTimeout(timer);\n              resolve(schema);\n            });\n          });\n        }\n      }\n      return this.__CACHE[schemaFile];\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    loaded: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeLoaded'\n    },\n\n    structure: {\n      check: ['pure', 'tile'],\n      apply: '_applyStructure'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __filename: null,\n    /**\n     * object of the schema/xsd\n     * @var object\n     */\n    __xsd: null,\n\n    /**\n     * object of allowed root-level elements\n     * @var object\n     */\n    __allowedRootElements: null,\n\n    /**\n     * cache for referenced nods\n     * @var object\n     */\n    __referencedNodeCache: null,\n\n    /**\n     * cache for getTypeNode\n     * @var object\n     */\n    __typeNodeCache: null,\n\n    /**\n     * cache for #text-SchemaElement\n     * @var object\n     */\n    __textNodeSchemaElement: null,\n\n    /**\n     * cache for #comment-SchemaElement\n     * @var object\n     */\n    __commentNodeSchemaElement: null,\n\n    /**\n     * @var {Array<String>}\n     */\n    _widgetNames: null,\n\n    /**\n     * @var {String}\n     */\n    __rootElementName: null,\n\n    /**\n     * @var {String}\n     */\n    __pageParentElementName: null,\n\n    /**\n     * @var {String}\n     */\n    __pageElementName: null,\n\n    _applyStructure(structure) {\n      if (structure === 'tile') {\n        this.__rootElementName = 'config';\n        this.__pageParentElementName = 'main';\n        this.__pageElementName = 'cv-page';\n      } else {\n        this.__rootElementName = 'pages';\n        this.__pageElementName = 'page';\n      }\n    },\n\n    onLoaded(callback, context) {\n      if (this.isLoaded()) {\n        callback.call(context);\n      } else {\n        this.addListenerOnce('changeLoaded', callback, context);\n      }\n    },\n\n    /**\n     * load and cache the xsd from the server\n     */\n    _cacheXSD() {\n      const ajaxRequest = new qx.io.request.Xhr(this.__filename);\n      ajaxRequest.set({\n        accept: 'application/xml'\n      });\n\n      ajaxRequest.addListenerOnce('success', async e => {\n        const req = e.getTarget();\n        // Response parsed according to the server's response content type\n        let xml = req.getResponse();\n        if (xml && typeof xml === 'string') {\n          xml = qx.xml.Document.fromString(xml);\n        }\n        // embed all includes\n        let includeXml;\n        for (let include of xml.querySelectorAll('schema include')) {\n          includeXml = await this.loadXml('resource/' + include.getAttribute('schemaLocation'));\n          const target = include.parentElement;\n          include.remove();\n          for (let includedChild of includeXml.querySelectorAll('schema > *')) {\n            target.appendChild(includedChild);\n          }\n        }\n        this.__xsd = xml;\n\n        // parse the data, to have at least a list of root-level-elements\n        this._parseXSD();\n      });\n      ajaxRequest.send();\n    },\n\n    async loadXml(file) {\n      return new Promise((resolve, reject) => {\n        const ajaxRequest = new qx.io.request.Xhr(file);\n        ajaxRequest.set({\n          accept: 'application/xml'\n        });\n        ajaxRequest.addListenerOnce('success', e => {\n          const req = e.getTarget();\n          // Response parsed according to the server's response content type\n          let xml = req.getResponse();\n          if (xml && typeof xml === 'string') {\n            xml = qx.xml.Document.fromString(xml);\n          }\n          resolve(xml);\n        });\n        ajaxRequest.addListenerOnce('statusError', e => {\n          const req = e.getTarget();\n          reject(new Error(req.getStatusText()));\n        });\n        ajaxRequest.send();\n      });\n    },\n\n    /**\n     * parse the schema once\n     */\n    _parseXSD() {\n      // make a list of root-level elements\n      this.__xsd.querySelectorAll('schema > element').forEach(element => {\n        const name = element.getAttribute('name');\n        this.__allowedRootElements[name] = new cv.ui.manager.model.schema.Element(element, this);\n      });\n      this.setLoaded(true);\n    },\n\n    getElementNode(name) {\n      if (Object.prototype.hasOwnProperty.call(this.__allowedRootElements, name)) {\n        return this.__allowedRootElements[name];\n      }\n      throw new Error('schema/xsd appears to be invalid, element ' + name + ' not allowed on root level');\n    },\n\n    /**\n     * dive into the schema and find the element that is being pulled in by a ref.\n     * Do so recursively.\n     * referenced nodes can be top-level-nodes only!\n     *\n     * @param   type       string  Type of the node (e.g. element, attributeGroup, ...)\n     * @param   refName    string  Name as per the ref-attribute\n     * @param   noFallback boolean Don't look up other types as fallback, if the requested type is not found\n     * @return  object          jQuery-object of the ref'ed element\n     */\n    getReferencedNode(type, refName, noFallback) {\n      if (\n        Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type) &&\n        Object.prototype.hasOwnProperty.call(this.__referencedNodeCache[type], refName)\n      ) {\n        return this.__referencedNodeCache[type][refName];\n      }\n      const fallbackType = type === 'simpleType' ? 'complexType' : 'simpleType';\n      if (!noFallback) {\n        if (\n          Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, fallbackType) &&\n          Object.prototype.hasOwnProperty.call(this.__referencedNodeCache[fallbackType], refName)\n        ) {\n          return this.__referencedNodeCache[fallbackType][refName];\n        }\n      }\n\n      const selector = 'schema > ' + type + '[name=\"' + refName + '\"]';\n      let ref = this.__xsd.querySelector(selector);\n      if (!ref && !noFallback) {\n        try {\n          ref = this.getReferencedNode(fallbackType, refName, true);\n        } catch (e) {}\n      }\n      if (!ref) {\n        throw new Error('schema/xsd appears to be invalid, reference ' + type + ' \"' + refName + '\" can not be found');\n      }\n\n      if (ref.hasAttribute('ref')) {\n        // do it recursively, if necessary\n        ref = this.getReferencedNode(type, ref.getAttribute('ref'));\n      }\n\n      if (!Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type)) {\n        this.__referencedNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__referencedNodeCache[type][refName] = ref;\n\n      return ref;\n    },\n\n    /**\n     * get the definition of a type, be it complex or simple\n     *\n     * @param   type    string  Type of type to find (either simple or complex)\n     * @param   name    string  Name of the type to find\n     */\n    getTypeNode(type, name) {\n      if (\n        Object.prototype.hasOwnProperty.call(this.__typeNodeCache, type) &&\n        Object.prototype.hasOwnProperty.call(this.__typeNodeCache[type], name)\n      ) {\n        return this.__typeNodeCache[type][name];\n      }\n      let typeNode = this.__xsd.querySelector(type + 'Type[name=\"' + name + '\"]');\n\n      if (!typeNode) {\n        throw new Error('schema/xsd appears to be invalid, ' + type + 'Type \"' + name + '\" can not be found');\n      }\n\n      if (typeof this.__typeNodeCache[type] == 'undefined') {\n        this.__typeNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__typeNodeCache[type][name] = typeNode;\n\n      return typeNode;\n    },\n\n    /**\n     * get a SchemaElement for a #text-node\n     *\n     * @return  object  SchemaElement for #text-node\n     */\n    getTextNodeSchemaElement() {\n      if (this.__textNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#text');\n        tmpXML.setAttribute('type', 'xsd:string');\n        this.__textNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__textNodeSchemaElement;\n    },\n\n    /**\n     * get a SchemaElement for a #comment-node\n     *\n     * @return  object  SchemaElement for #comment-node\n     */\n    getCommentNodeSchemaElement() {\n      if (this.__commentNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#comment');\n        tmpXML.setAttribute('type', 'xsd:string');\n        tmpXML.setAttribute('minOccurs', '0');\n        tmpXML.setAttribute('maxOccurs', 'unbounded');\n        this.__commentNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__commentNodeSchemaElement;\n    },\n\n    /**\n     * get the DOM for this Schema\n     *\n     * @return  object  DOM\n     */\n    getSchemaDOM() {\n      return this.__xsd;\n    },\n\n    /**\n     * A CometVisu-Schema specific helper function that returns an array of all widget names.\n     * @returns {Array<String>}\n     */\n    getWidgetNames() {\n      if (!this._widgetNames) {\n        const root = this.getElementNode(this.__rootElementName);\n        let pageParent = root;\n        if (this.__pageParentElementName) {\n          pageParent = root.getSchemaElementForElementName(this.__pageParentElementName);\n        }\n        const page = pageParent.getSchemaElementForElementName(this.__pageElementName);\n\n        this._widgetNames = Object.keys(page.getAllowedElements()).filter(\n          name => !name.startsWith('#') && name !== 'layout'\n        );\n      }\n      return this._widgetNames;\n    },\n\n    isRoot(name) {\n      return name === this.__rootElementName;\n    },\n\n    isPage(name) {\n      return (name = this.__pageElementName);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this.__xsd = null;\n    this._disposeObjects('__commentNodeSchemaElement', '__textNodeSchemaElement');\n\n    this._disposeMap('__allowedRootElements');\n    this.__referencedNodeCache = null;\n    this.__typeNodeCache = null;\n    this._widgetNames = null;\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;+CACA,oJ;;;;;;;;;;;;;;;;;;;;;;;EADAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;EAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;EACAH,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,4BAAhB,EAA8C;IAC5CC,MAAM,EAAEN,EAAE,CAACO,IAAH,CAAQC,MAD4B;;IAG5C;AACF;AACA;AACA;AACA;IACEC,SAR4C,qBAQlCC,QARkC,EAQxB;MAClB;;MACA,IAAI,CAACA,QAAD,IAAa,CAACA,QAAQ,CAACC,KAAT,CAAe,QAAf,CAAlB,EAA4C;QAC1C,MAAM,IAAIC,KAAJ,CAAU,sEAAV,CAAN;MACD;;MACD,KAAKC,UAAL,GAAkBH,QAAlB;MACA,KAAKI,YAAL,CAAkBJ,QAAQ,CAACK,QAAT,CAAkB,sBAAlB,IAA4C,MAA5C,GAAqD,MAAvE;MAEA,KAAKC,QAAL,GAA6B,EAA7B;MACA,KAAKC,QAAL,GAA6B,EAA7B;MACA,KAAKC,QAAL,GAAuB,EAAvB;;MACA,KAAKC,SAAL;IACD,CApB2C;;IAsB5C;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACPC,QAAO,EAAE,EADF;MAGDC,WAHC,uBAGWC,UAHX,EAGuB;QAAA;;QAAA;UAAA;UAAA;YAAA;cAAA;gBAAA,IACvBf,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAI,CAACL,QAA1C,EAAmDE,UAAnD,CADuB;kBAAA;kBAAA;gBAAA;;gBAEpBI,MAFoB,GAEX,KAAI,CAACN,QAAL,CAAaE,UAAb,IAA2B,IAAIK,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,KAAd,CAAoBC,MAAxB,CACxChC,EAAE,CAACiC,IAAH,CAAQC,eAAR,CAAwBZ,WAAxB,GAAsCa,KAAtC,CAA4CZ,UAA5C,CADwC,CAFhB;;gBAAA,IAKrBI,MAAM,CAACS,QAAP,EALqB;kBAAA;kBAAA;gBAAA;;gBAAA,iCAMjB,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;kBACtC,IAAMC,KAAK,GAAGC,UAAU,CAAC,YAAM;oBAC7BF,MAAM,CAAC,IAAI3B,KAAJ,CAAU,6BAAV,CAAD,CAAN;kBACD,CAFuB,EAErB,IAFqB,CAAxB;kBAGAe,MAAM,CAACe,eAAP,CAAuB,cAAvB,EAAuC,YAAM;oBAC3CC,YAAY,CAACH,KAAD,CAAZ;oBACAF,OAAO,CAACX,MAAD,CAAP;kBACD,CAHD;gBAID,CARM,CANiB;;cAAA;gBAAA,iCAiBrB,KAAI,CAACN,QAAL,CAAaE,UAAb,CAjBqB;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAkB7B;IArBM,CA3BmC;;IAmD5C;AACF;AACA;AACA;AACA;IACEqB,UAAU,EAAE;MACVC,MAAM,EAAE;QACNC,KAAK,EAAE,SADD;QAENC,IAAI,EAAE,KAFA;QAGNC,KAAK,EAAE;MAHD,CADE;MAOVC,SAAS,EAAE;QACTH,KAAK,EAAE,CAAC,MAAD,EAAS,MAAT,CADE;QAETI,KAAK,EAAE;MAFE;IAPD,CAxDgC;;IAqE5C;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACPtC,UAAU,EAAE,IADL;;MAEP;AACJ;AACA;AACA;MACIuC,QAAK,EAAE,IANA;;MAQP;AACJ;AACA;AACA;MACIpC,QAAqB,EAAE,IAZhB;;MAcP;AACJ;AACA;AACA;MACIC,QAAqB,EAAE,IAlBhB;;MAoBP;AACJ;AACA;AACA;MACIC,QAAe,EAAE,IAxBV;;MA0BP;AACJ;AACA;AACA;MACImC,QAAuB,EAAE,IA9BlB;;MAgCP;AACJ;AACA;AACA;MACIC,QAA0B,EAAE,IApCrB;;MAsCP;AACJ;AACA;MACIC,YAAY,EAAE,IAzCP;;MA2CP;AACJ;AACA;MACIC,QAAiB,EAAE,IA9CZ;;MAgDP;AACJ;AACA;MACIC,QAAuB,EAAE,IAnDlB;;MAqDP;AACJ;AACA;MACIC,QAAiB,EAAE,IAxDZ;MA0DPC,eA1DO,2BA0DSV,SA1DT,EA0DoB;QACzB,IAAIA,SAAS,KAAK,MAAlB,EAA0B;UACxB,KAAKO,QAAL,GAAyB,QAAzB;UACA,KAAKC,QAAL,GAA+B,MAA/B;UACA,KAAKC,QAAL,GAAyB,SAAzB;QACD,CAJD,MAIO;UACL,KAAKF,QAAL,GAAyB,OAAzB;UACA,KAAKE,QAAL,GAAyB,MAAzB;QACD;MACF,CAnEM;MAqEPE,QArEO,oBAqEEC,QArEF,EAqEYC,OArEZ,EAqEqB;QAC1B,IAAI,KAAK1B,QAAL,EAAJ,EAAqB;UACnByB,QAAQ,CAACnC,IAAT,CAAcoC,OAAd;QACD,CAFD,MAEO;UACL,KAAKpB,eAAL,CAAqB,cAArB,EAAqCmB,QAArC,EAA+CC,OAA/C;QACD;MACF,CA3EM;;MA6EP;AACJ;AACA;MACI3C,SAhFO,uBAgFK;QAAA;;QACV,IAAM4C,WAAW,GAAG,IAAI/D,EAAE,CAACgE,EAAH,CAAMC,OAAN,CAAcC,GAAlB,CAAsB,KAAKrD,UAA3B,CAApB;QACAkD,WAAW,CAACI,GAAZ,CAAgB;UACdC,MAAM,EAAE;QADM,CAAhB;QAIAL,WAAW,CAACrB,eAAZ,CAA4B,SAA5B;UAAA,sEAAuC,kBAAM2B,CAAN;YAAA;;YAAA;cAAA;gBAAA;kBAC/BC,GAD+B,GACzBD,CAAC,CAACE,SAAF,EADyB,EAErC;;kBACIC,GAHiC,GAG3BF,GAAG,CAACG,WAAJ,EAH2B;;kBAIrC,IAAID,GAAG,IAAI,OAAOA,GAAP,KAAe,QAA1B,EAAoC;oBAClCA,GAAG,GAAGxE,EAAE,CAACwE,GAAH,CAAOE,QAAP,CAAgBC,UAAhB,CAA2BH,GAA3B,CAAN;kBACD,CANoC,CAOrC;;;kBAPqC,uCASjBA,GAAG,CAACI,gBAAJ,CAAqB,gBAArB,CATiB;kBAAA;;kBAAA;;gBAAA;kBAAA;oBAAA;oBAAA;kBAAA;;kBAS5BC,OAT4B;kBAAA;kBAAA,OAUhB,MAAI,CAACC,OAAL,CAAa,cAAcD,OAAO,CAACE,YAAR,CAAqB,gBAArB,CAA3B,CAVgB;;gBAAA;kBAUnCC,UAVmC;kBAW7BC,MAX6B,GAWpBJ,OAAO,CAACK,aAXY;kBAYnCL,OAAO,CAACM,MAAR;kBAZmC,wCAaTH,UAAU,CAACJ,gBAAX,CAA4B,YAA5B,CAbS;;kBAAA;oBAanC,uDAAqE;sBAA5DQ,aAA4D;sBACnEH,MAAM,CAACI,WAAP,CAAmBD,aAAnB;oBACD;kBAfkC;oBAAA;kBAAA;oBAAA;kBAAA;;gBAAA;kBAAA;kBAAA;;gBAAA;kBAAA;kBAAA;;gBAAA;kBAAA;kBAAA;;kBAAA;;gBAAA;kBAAA;;kBAAA;;kBAAA;;gBAAA;kBAiBrC,MAAI,CAAChC,QAAL,GAAaoB,GAAb,CAjBqC,CAmBrC;;kBACA,MAAI,CAACc,SAAL;;gBApBqC;gBAAA;kBAAA;cAAA;YAAA;UAAA,CAAvC;;UAAA;YAAA;UAAA;QAAA;QAsBAvB,WAAW,CAACwB,IAAZ;MACD,CA7GM;MA+GDT,OA/GC,mBA+GOU,IA/GP,EA+Ga;QAAA;UAAA;YAAA;cAAA;gBAAA,kCACX,IAAInD,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;kBACtC,IAAMwB,WAAW,GAAG,IAAI/D,EAAE,CAACgE,EAAH,CAAMC,OAAN,CAAcC,GAAlB,CAAsBsB,IAAtB,CAApB;kBACAzB,WAAW,CAACI,GAAZ,CAAgB;oBACdC,MAAM,EAAE;kBADM,CAAhB;kBAGAL,WAAW,CAACrB,eAAZ,CAA4B,SAA5B,EAAuC,UAAA2B,CAAC,EAAI;oBAC1C,IAAMC,GAAG,GAAGD,CAAC,CAACE,SAAF,EAAZ,CAD0C,CAE1C;;oBACA,IAAIC,GAAG,GAAGF,GAAG,CAACG,WAAJ,EAAV;;oBACA,IAAID,GAAG,IAAI,OAAOA,GAAP,KAAe,QAA1B,EAAoC;sBAClCA,GAAG,GAAGxE,EAAE,CAACwE,GAAH,CAAOE,QAAP,CAAgBC,UAAhB,CAA2BH,GAA3B,CAAN;oBACD;;oBACDlC,OAAO,CAACkC,GAAD,CAAP;kBACD,CARD;kBASAT,WAAW,CAACrB,eAAZ,CAA4B,aAA5B,EAA2C,UAAA2B,CAAC,EAAI;oBAC9C,IAAMC,GAAG,GAAGD,CAAC,CAACE,SAAF,EAAZ;oBACAhC,MAAM,CAAC,IAAI3B,KAAJ,CAAU0D,GAAG,CAACmB,aAAJ,EAAV,CAAD,CAAN;kBACD,CAHD;kBAIA1B,WAAW,CAACwB,IAAZ;gBACD,CAnBM,CADW;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAqBnB,CApIM;;MAsIP;AACJ;AACA;MACID,SAzIO,uBAyIK;QAAA;;QACV;QACA,KAAKlC,QAAL,CAAWwB,gBAAX,CAA4B,kBAA5B,EAAgDc,OAAhD,CAAwD,UAAAC,OAAO,EAAI;UACjE,IAAMC,IAAI,GAAGD,OAAO,CAACZ,YAAR,CAAqB,MAArB,CAAb;UACA,MAAI,CAAC/D,QAAL,CAA2B4E,IAA3B,IAAmC,IAAIhE,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,KAAd,CAAoBJ,MAApB,CAA2BkE,OAA/B,CAAuCF,OAAvC,EAAgD,MAAhD,CAAnC;QACD,CAHD;;QAIA,KAAKG,SAAL,CAAe,IAAf;MACD,CAhJM;MAkJPC,cAlJO,0BAkJQH,IAlJR,EAkJc;QACnB,IAAIpF,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKV,QAA1C,EAAiE4E,IAAjE,CAAJ,EAA4E;UAC1E,OAAO,KAAK5E,QAAL,CAA2B4E,IAA3B,CAAP;QACD;;QACD,MAAM,IAAIhF,KAAJ,CAAU,+CAA+CgF,IAA/C,GAAsD,4BAAhE,CAAN;MACD,CAvJM;;MAyJP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACII,iBAnKO,6BAmKWC,IAnKX,EAmKiBC,OAnKjB,EAmK0BC,UAnK1B,EAmKsC;QAC3C,IACE3F,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKT,QAA1C,EAAiEgF,IAAjE,KACAzF,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKT,QAAL,CAA2BgF,IAA3B,CAArC,EAAuEC,OAAvE,CAFF,EAGE;UACA,OAAO,KAAKjF,QAAL,CAA2BgF,IAA3B,EAAiCC,OAAjC,CAAP;QACD;;QACD,IAAME,YAAY,GAAGH,IAAI,KAAK,YAAT,GAAwB,aAAxB,GAAwC,YAA7D;;QACA,IAAI,CAACE,UAAL,EAAiB;UACf,IACE3F,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKT,QAA1C,EAAiEmF,YAAjE,KACA5F,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKT,QAAL,CAA2BmF,YAA3B,CAArC,EAA+EF,OAA/E,CAFF,EAGE;YACA,OAAO,KAAKjF,QAAL,CAA2BmF,YAA3B,EAAyCF,OAAzC,CAAP;UACD;QACF;;QAED,IAAMG,QAAQ,GAAG,cAAcJ,IAAd,GAAqB,SAArB,GAAiCC,OAAjC,GAA2C,IAA5D;;QACA,IAAII,GAAG,GAAG,KAAKlD,QAAL,CAAWmD,aAAX,CAAyBF,QAAzB,CAAV;;QACA,IAAI,CAACC,GAAD,IAAQ,CAACH,UAAb,EAAyB;UACvB,IAAI;YACFG,GAAG,GAAG,KAAKN,iBAAL,CAAuBI,YAAvB,EAAqCF,OAArC,EAA8C,IAA9C,CAAN;UACD,CAFD,CAEE,OAAO7B,CAAP,EAAU,CAAE;QACf;;QACD,IAAI,CAACiC,GAAL,EAAU;UACR,MAAM,IAAI1F,KAAJ,CAAU,iDAAiDqF,IAAjD,GAAwD,IAAxD,GAA+DC,OAA/D,GAAyE,oBAAnF,CAAN;QACD;;QAED,IAAII,GAAG,CAACE,YAAJ,CAAiB,KAAjB,CAAJ,EAA6B;UAC3B;UACAF,GAAG,GAAG,KAAKN,iBAAL,CAAuBC,IAAvB,EAA6BK,GAAG,CAACvB,YAAJ,CAAiB,KAAjB,CAA7B,CAAN;QACD;;QAED,IAAI,CAACvE,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKT,QAA1C,EAAiEgF,IAAjE,CAAL,EAA6E;UAC3E,KAAKhF,QAAL,CAA2BgF,IAA3B,IAAmC,EAAnC;QACD,CAnC0C,CAqC3C;;;QACA,KAAKhF,QAAL,CAA2BgF,IAA3B,EAAiCC,OAAjC,IAA4CI,GAA5C;QAEA,OAAOA,GAAP;MACD,CA5MM;;MA8MP;AACJ;AACA;AACA;AACA;AACA;MACIG,WApNO,uBAoNKR,IApNL,EAoNWL,IApNX,EAoNiB;QACtB,IACEpF,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKR,QAA1C,EAA2D+E,IAA3D,KACAzF,MAAM,CAACgB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKR,QAAL,CAAqB+E,IAArB,CAArC,EAAiEL,IAAjE,CAFF,EAGE;UACA,OAAO,KAAK1E,QAAL,CAAqB+E,IAArB,EAA2BL,IAA3B,CAAP;QACD;;QACD,IAAIc,QAAQ,GAAG,KAAKtD,QAAL,CAAWmD,aAAX,CAAyBN,IAAI,GAAG,aAAP,GAAuBL,IAAvB,GAA8B,IAAvD,CAAf;;QAEA,IAAI,CAACc,QAAL,EAAe;UACb,MAAM,IAAI9F,KAAJ,CAAU,uCAAuCqF,IAAvC,GAA8C,QAA9C,GAAyDL,IAAzD,GAAgE,oBAA1E,CAAN;QACD;;QAED,IAAI,OAAO,KAAK1E,QAAL,CAAqB+E,IAArB,CAAP,IAAqC,WAAzC,EAAsD;UACpD,KAAK/E,QAAL,CAAqB+E,IAArB,IAA6B,EAA7B;QACD,CAfqB,CAiBtB;;;QACA,KAAK/E,QAAL,CAAqB+E,IAArB,EAA2BL,IAA3B,IAAmCc,QAAnC;QAEA,OAAOA,QAAP;MACD,CAzOM;;MA2OP;AACJ;AACA;AACA;AACA;MACIC,wBAhPO,sCAgPoB;QACzB,IAAI,KAAKtD,QAAL,KAAiC,IAArC,EAA2C;UACzC;UACA,IAAMuD,MAAM,GAAG,KAAKxD,QAAL,CAAWyD,aAAX,CAAyB,SAAzB,CAAf;;UACAD,MAAM,CAACE,YAAP,CAAoB,MAApB,EAA4B,OAA5B;UACAF,MAAM,CAACE,YAAP,CAAoB,MAApB,EAA4B,YAA5B;UACA,KAAKzD,QAAL,GAA+B,IAAIzB,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,KAAd,CAAoBJ,MAApB,CAA2BkE,OAA/B,CAAuCe,MAAvC,EAA+C,IAA/C,CAA/B;QACD;;QAED,OAAO,KAAKvD,QAAZ;MACD,CA1PM;;MA4PP;AACJ;AACA;AACA;AACA;MACI0D,2BAjQO,yCAiQuB;QAC5B,IAAI,KAAKzD,QAAL,KAAoC,IAAxC,EAA8C;UAC5C;UACA,IAAMsD,MAAM,GAAG,KAAKxD,QAAL,CAAWyD,aAAX,CAAyB,SAAzB,CAAf;;UACAD,MAAM,CAACE,YAAP,CAAoB,MAApB,EAA4B,UAA5B;UACAF,MAAM,CAACE,YAAP,CAAoB,MAApB,EAA4B,YAA5B;UACAF,MAAM,CAACE,YAAP,CAAoB,WAApB,EAAiC,GAAjC;UACAF,MAAM,CAACE,YAAP,CAAoB,WAApB,EAAiC,WAAjC;UACA,KAAKxD,QAAL,GAAkC,IAAI1B,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,KAAd,CAAoBJ,MAApB,CAA2BkE,OAA/B,CAAuCe,MAAvC,EAA+C,IAA/C,CAAlC;QACD;;QAED,OAAO,KAAKtD,QAAZ;MACD,CA7QM;;MA+QP;AACJ;AACA;AACA;AACA;MACI0D,YApRO,0BAoRQ;QACb,OAAO,KAAK5D,QAAZ;MACD,CAtRM;;MAwRP;AACJ;AACA;AACA;MACI6D,cA5RO,4BA4RU;QACf,IAAI,CAAC,KAAK1D,YAAV,EAAwB;UACtB,IAAM2D,IAAI,GAAG,KAAKnB,cAAL,CAAoB,KAAKvC,QAAzB,CAAb;UACA,IAAI2D,UAAU,GAAGD,IAAjB;;UACA,IAAI,KAAKzD,QAAT,EAAkC;YAChC0D,UAAU,GAAGD,IAAI,CAACE,8BAAL,CAAoC,KAAK3D,QAAzC,CAAb;UACD;;UACD,IAAM4D,IAAI,GAAGF,UAAU,CAACC,8BAAX,CAA0C,KAAK1D,QAA/C,CAAb;UAEA,KAAKH,YAAL,GAAoB/C,MAAM,CAAC8G,IAAP,CAAYD,IAAI,CAACE,kBAAL,EAAZ,EAAuCC,MAAvC,CAClB,UAAA5B,IAAI;YAAA,OAAI,CAACA,IAAI,CAAC6B,UAAL,CAAgB,GAAhB,CAAD,IAAyB7B,IAAI,KAAK,QAAtC;UAAA,CADc,CAApB;QAGD;;QACD,OAAO,KAAKrC,YAAZ;MACD,CA1SM;MA4SPmE,MA5SO,kBA4SA9B,IA5SA,EA4SM;QACX,OAAOA,IAAI,KAAK,KAAKpC,QAArB;MACD,CA9SM;MAgTPmE,MAhTO,kBAgTA/B,IAhTA,EAgTM;QACX,OAAQA,IAAI,GAAG,KAAKlC,QAApB;MACD;IAlTM,CA1EmC;;IA+X5C;AACF;AACA;AACA;AACA;IACEkE,QApY4C,sBAoYjC;MACT,KAAKxE,QAAL,GAAa,IAAb;;MACA,KAAKyE,eAAL,CAAqB,UAArB,EAAmD,UAAnD;;MAEA,KAAKC,WAAL,CAAiB,UAAjB;;MACA,KAAK7G,QAAL,GAA6B,IAA7B;MACA,KAAKC,QAAL,GAAuB,IAAvB;MACA,KAAKqC,YAAL,GAAoB,IAApB;IACD;EA5Y2C,CAA9C;EAtBA3B,EAAE,CAACC,EAAH,CAAMC,OAAN,CAAcC,KAAd,CAAoBC,MAApB,CAA2B7B,aAA3B,GAA2CA,aAA3C"
}