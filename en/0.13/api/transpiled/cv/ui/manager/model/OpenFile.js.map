{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "file",
    "handlerId",
    "constructor",
    "call",
    "setFile",
    "setHandlerId",
    "properties",
    "check",
    "nullable",
    "event",
    "apply",
    "handlerOptions",
    "permanent",
    "init",
    "icon",
    "closeable",
    "members",
    "__ibid",
    "_applyFile",
    "value",
    "old",
    "removeListener",
    "_maintainPermanent",
    "removeRelatedBindings",
    "addListener",
    "_maintainIcon",
    "getFile",
    "getHandlerId",
    "handlerClass",
    "getByName",
    "ICON",
    "setIcon",
    "removeBinding",
    "bind",
    "resetIcon",
    "isModified",
    "isPermanent",
    "setPermanent",
    "save",
    "callback",
    "overrideHash",
    "fileHandler",
    "cv",
    "ui",
    "manager",
    "control",
    "FileHandlerRegistry",
    "getInstance",
    "getFileHandlerById",
    "getFileHandler",
    "instance",
    "Interface",
    "objectImplements",
    "editor",
    "IEditor",
    "model",
    "OpenFile"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/OpenFile.js"
  ],
  "sourcesContent": [
    "/* OpenFile.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Data model for currently opened files, a combination of cv.ui.manager.model.FileItem and a certain FileHandler.\n */\nqx.Class.define('cv.ui.manager.model.OpenFile', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(file, handlerId) {\n    super();\n    if (file) {\n      this.setFile(file);\n    }\n    if (handlerId) {\n      this.setHandlerId(handlerId);\n    }\n  },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      event: 'changeFile',\n      apply: '_applyFile'\n    },\n\n    handlerId: {\n      check: '!!qx.Class.getByName(value)',\n      nullable: true,\n      apply: '_maintainIcon'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true\n    },\n\n    /**\n     * The opening state: permanent false behaves like a quick preview, where\n     * the current file content is replaces by the next selected file on single click.\n     * In permanent mode a new tab will be created, which content will not be replaced.\n     */\n    permanent: {\n      check: 'Boolean',\n      init: false,\n      event: 'changePermanent'\n    },\n\n    /**\n     * Icon to show in e.g. the File-Tab\n     */\n    icon: {\n      check: 'String',\n      init: '',\n      event: 'changeIcon'\n    },\n\n    closeable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeCloseable'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __ibid: null,\n\n    _applyFile(value, old) {\n      if (old) {\n        old.removeListener('changeModified', this._maintainPermanent, this);\n        old.removeRelatedBindings(this);\n        this.__ibid = null;\n      }\n      if (value) {\n        value.addListener('changeModified', this._maintainPermanent, this);\n      }\n      this._maintainIcon();\n    },\n\n    _maintainIcon() {\n      // use the handlers icon is there is one, otherwise the file items icon\n      const file = this.getFile();\n      if (this.getHandlerId() && file) {\n        const handlerClass = qx.Class.getByName(this.getHandlerId());\n        if (handlerClass && handlerClass.ICON) {\n          this.setIcon(handlerClass.ICON);\n          if (this.__ibid) {\n            file.removeBinding(this.__ibid);\n            this.__ibid = null;\n          }\n        } else {\n          this.__ibid = file.bind('icon', this, 'icon');\n        }\n      } else {\n        this.resetIcon();\n      }\n    },\n\n    _maintainPermanent() {\n      if (this.getFile().isModified() && !this.isPermanent()) {\n        // change to permanent once we have a modification\n        this.setPermanent(true);\n      }\n    },\n\n    save(callback, overrideHash) {\n      const file = this.getFile();\n      const handlerId = this.getHandlerId();\n      let fileHandler;\n      if (handlerId) {\n        fileHandler = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n      } else {\n        fileHandler = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n      }\n      if (file.isModified()) {\n        if (\n          fileHandler &&\n          fileHandler.instance &&\n          qx.Interface.objectImplements(fileHandler.instance, cv.ui.manager.editor.IEditor)\n        ) {\n          fileHandler.instance.save(callback, overrideHash);\n        }\n      }\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}