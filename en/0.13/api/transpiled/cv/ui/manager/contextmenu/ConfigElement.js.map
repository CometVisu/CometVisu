{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "menu",
    "Menu",
    "construct",
    "editor",
    "setEditor",
    "_commandGroup",
    "core",
    "Init",
    "getApplication",
    "getCommandManager",
    "getActive",
    "_init",
    "events",
    "action",
    "properties",
    "element",
    "check",
    "nullable",
    "apply",
    "members",
    "_applyEditor",
    "value",
    "old",
    "removeListener",
    "_maintainClipboardButtons",
    "addListener",
    "_applyElement",
    "removeRelatedBindings",
    "getChildControl",
    "editable",
    "isEditable",
    "setEnabled",
    "bind",
    "exclude",
    "show",
    "getShowEditButton",
    "addable",
    "getAddableChildren",
    "length",
    "forEach",
    "name",
    "add",
    "addSeparator",
    "content",
    "getEditor",
    "getClipboard",
    "getElement",
    "enabled",
    "cv",
    "manager",
    "model",
    "XmlElement",
    "includes",
    "getName",
    "isChildAllowedAtPosition",
    "Number",
    "POSITIVE_INFINITY",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "__createButton",
    "tr",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "title",
    "icon",
    "command",
    "button",
    "Button",
    "fireDataEvent",
    "destruct",
    "contextmenu",
    "ConfigElement"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/ConfigElement.js"
  ],
  "sourcesContent": [
    "/* ConfigElement.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Contextmenu for an XML-Element in a CometVisu config file.\n */\nqx.Class.define('cv.ui.manager.contextmenu.ConfigElement', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(editor) {\n    super();\n    if (editor) {\n      this.setEditor(editor);\n    }\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      apply: '_applyElement'\n    },\n\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      apply: '_applyEditor'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {qx.ui.command.GroupManager}\n     */\n    _commandGroup: null,\n\n    _applyEditor(value, old) {\n      if (old) {\n        old.removeListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n      if (value) {\n        value.addListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n    },\n\n    _applyElement(value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n        old.removeRelatedBindings(this.getChildControl('cut-button'));\n      }\n      if (value) {\n        const editable = value.isEditable();\n        this.getChildControl('copy-button').setEnabled(true);\n        if (editable) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n\n          value.bind('deletable', this.getChildControl('cut-button'), 'enabled');\n\n          this.getChildControl('view-button').exclude();\n          this.getChildControl('edit-button').show();\n          this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n\n          let addable = value.getAddableChildren(true);\n          this.getChildControl('create-button').setEnabled(addable.length > 0);\n        } else {\n          this.getChildControl('delete-button').setEnabled(false);\n          this.getChildControl('cut-button').setEnabled(false);\n          this.getChildControl('create-button').setEnabled(false);\n          this.getChildControl('view-button').show();\n          // enable view button when there are attributes to show\n          this.getChildControl('view-button').setEnabled(value.getShowEditButton());\n\n          this.getChildControl('edit-button').exclude();\n        }\n      } else {\n        ['edit', 'delete', 'cut', 'copy', 'paste', 'create'].forEach(name =>\n          this.getChildControl(name + '-button').setEnabled(false)\n        );\n      }\n      this._maintainClipboardButtons();\n    },\n\n    _init() {\n      ['view', 'edit', 'delete'].forEach(name => this.add(this.getChildControl(name + '-button')));\n\n      this.addSeparator();\n      ['cut', 'copy', 'paste'].forEach(name => this.add(this.getChildControl(name + '-button')));\n\n      this.addSeparator();\n      this.add(this.getChildControl('create-button'));\n    },\n\n    _maintainClipboardButtons() {\n      const content = this.getEditor().getClipboard();\n      const element = this.getElement();\n      let enabled = (element ? element.isEditable() : false) && content instanceof cv.ui.manager.model.XmlElement;\n      if (enabled) {\n        // check if content is allowed as child here\n        let addable = element.getAddableChildren(true);\n        enabled =\n          addable.includes(content.getName()) && element.isChildAllowedAtPosition(content, Number.POSITIVE_INFINITY);\n      }\n      this.getChildControl('paste-button').setEnabled(enabled);\n    },\n\n    // overridden\n    _createChildControlImpl(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'view-button':\n          control = this.__createButton('view', this.tr('View'), cv.theme.dark.Images.getIcon('view', 18));\n\n          control.exclude();\n          break;\n\n        case 'edit-button':\n          control = this.__createButton('edit', this.tr('Edit'), cv.theme.dark.Images.getIcon('edit', 18));\n\n          break;\n\n        case 'delete-button':\n          control = this.__createButton('delete', this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n\n          break;\n\n        case 'cut-button':\n          control = this.__createButton('cut', this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18));\n\n          break;\n\n        case 'copy-button':\n          control = this.__createButton('copy', this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18));\n\n          break;\n\n        case 'paste-button':\n          control = this.__createButton('paste', this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18));\n\n          break;\n\n        case 'create-menu':\n          control = new qx.ui.menu.Menu();\n          break;\n\n        case 'create-button':\n          control = this.__createButton('create', this.tr('Add child'), cv.theme.dark.Images.getIcon('add', 18));\n\n          break;\n      }\n\n      return control || super._createChildControlImpl(id);\n    },\n\n    __createButton(action, title, icon, command, menu) {\n      const button = new qx.ui.menu.Button(title, icon, command, menu);\n      button.addListener('execute', () => {\n        this.fireDataEvent('action', {\n          action: action,\n          element: this.getElement()\n        });\n      });\n      return button;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._commandGroup = null;\n  }\n});\n"
  ],
  "mappings": "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"
}