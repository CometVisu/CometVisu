{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "menu",
    "Menu",
    "construct",
    "editor",
    "constructor",
    "call",
    "setEditor",
    "_commandGroup",
    "core",
    "Init",
    "getApplication",
    "getCommandManager",
    "getActive",
    "_init",
    "events",
    "action",
    "properties",
    "element",
    "check",
    "nullable",
    "apply",
    "members",
    "_applyEditor",
    "value",
    "old",
    "removeListener",
    "_maintainClipboardButtons",
    "addListener",
    "_applyElement",
    "_this",
    "removeRelatedBindings",
    "getChildControl",
    "editable",
    "isEditable",
    "setEnabled",
    "bind",
    "exclude",
    "show",
    "getShowEditButton",
    "addable",
    "getAddableChildren",
    "length",
    "forEach",
    "name",
    "_this2",
    "add",
    "addSeparator",
    "content",
    "getEditor",
    "getClipboard",
    "getElement",
    "enabled",
    "cv",
    "manager",
    "model",
    "XmlElement",
    "includes",
    "getName",
    "isChildAllowedAtPosition",
    "Number",
    "POSITIVE_INFINITY",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "__createButton",
    "tr",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "contextmenu",
    "ConfigElement",
    "superclass",
    "prototype",
    "title",
    "icon",
    "command",
    "_this3",
    "button",
    "Button",
    "fireDataEvent",
    "destruct"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/ConfigElement.js"
  ],
  "sourcesContent": [
    "/* ConfigElement.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Contextmenu for an XML-Element in a CometVisu config file.\n */\nqx.Class.define('cv.ui.manager.contextmenu.ConfigElement', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(editor) {\n    super();\n    if (editor) {\n      this.setEditor(editor);\n    }\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      apply: '_applyElement'\n    },\n\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      apply: '_applyEditor'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {qx.ui.command.GroupManager}\n     */\n    _commandGroup: null,\n\n    _applyEditor(value, old) {\n      if (old) {\n        old.removeListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n      if (value) {\n        value.addListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n    },\n\n    _applyElement(value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n        old.removeRelatedBindings(this.getChildControl('cut-button'));\n      }\n      if (value) {\n        const editable = value.isEditable();\n        this.getChildControl('copy-button').setEnabled(true);\n        if (editable) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n\n          value.bind('deletable', this.getChildControl('cut-button'), 'enabled');\n\n          this.getChildControl('view-button').exclude();\n          this.getChildControl('edit-button').show();\n          this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n\n          let addable = value.getAddableChildren(true);\n          this.getChildControl('create-button').setEnabled(addable.length > 0);\n        } else {\n          this.getChildControl('delete-button').setEnabled(false);\n          this.getChildControl('cut-button').setEnabled(false);\n          this.getChildControl('create-button').setEnabled(false);\n          this.getChildControl('view-button').show();\n          // enable view button when there are attributes to show\n          this.getChildControl('view-button').setEnabled(value.getShowEditButton());\n\n          this.getChildControl('edit-button').exclude();\n        }\n      } else {\n        ['edit', 'delete', 'cut', 'copy', 'paste', 'create'].forEach(name =>\n          this.getChildControl(name + '-button').setEnabled(false)\n        );\n      }\n      this._maintainClipboardButtons();\n    },\n\n    _init() {\n      ['view', 'edit', 'delete'].forEach(name => this.add(this.getChildControl(name + '-button')));\n\n      this.addSeparator();\n      ['cut', 'copy', 'paste'].forEach(name => this.add(this.getChildControl(name + '-button')));\n\n      this.addSeparator();\n      this.add(this.getChildControl('create-button'));\n    },\n\n    _maintainClipboardButtons() {\n      const content = this.getEditor().getClipboard();\n      const element = this.getElement();\n      let enabled = (element ? element.isEditable() : false) && content instanceof cv.ui.manager.model.XmlElement;\n      if (enabled) {\n        // check if content is allowed as child here\n        let addable = element.getAddableChildren(true);\n        enabled =\n          addable.includes(content.getName()) && element.isChildAllowedAtPosition(content, Number.POSITIVE_INFINITY);\n      }\n      this.getChildControl('paste-button').setEnabled(enabled);\n    },\n\n    // overridden\n    _createChildControlImpl(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'view-button':\n          control = this.__createButton('view', this.tr('View'), cv.theme.dark.Images.getIcon('view', 18));\n\n          control.exclude();\n          break;\n\n        case 'edit-button':\n          control = this.__createButton('edit', this.tr('Edit'), cv.theme.dark.Images.getIcon('edit', 18));\n\n          break;\n\n        case 'delete-button':\n          control = this.__createButton('delete', this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n\n          break;\n\n        case 'cut-button':\n          control = this.__createButton('cut', this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18));\n\n          break;\n\n        case 'copy-button':\n          control = this.__createButton('copy', this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18));\n\n          break;\n\n        case 'paste-button':\n          control = this.__createButton('paste', this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18));\n\n          break;\n\n        case 'create-menu':\n          control = new qx.ui.menu.Menu();\n          break;\n\n        case 'create-button':\n          control = this.__createButton('create', this.tr('Add child'), cv.theme.dark.Images.getIcon('add', 18));\n\n          break;\n      }\n\n      return control || super._createChildControlImpl(id);\n    },\n\n    __createButton(action, title, icon, command, menu) {\n      const button = new qx.ui.menu.Button(title, icon, command, menu);\n      button.addListener('execute', () => {\n        this.fireDataEvent('action', {\n          action: action,\n          element: this.getElement()\n        });\n      });\n      return button;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._commandGroup = null;\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAS,CAACC,oBAAoB,CAACC,aAAa,CAAC;EAAhD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;EACAH,EAAE,CAACI,KAAK,CAACC,MAAM,CAAC,yCAAyC,EAAE;IACzDC,MAAM,EAAEN,EAAE,CAACO,EAAE,CAACC,IAAI,CAACC,IAAI;IAEvB;AACF;AACA;AACA;AACA;IACEC,SAAS,WAATA,SAASA,CAACC,MAAM,EAAE;MAChBX,EAAA,CAAAO,EAAA,CAAAC,IAAA,CAAAC,IAAA,CAAAG,WAAA,CAAAC,IAAA;MACA,IAAIF,MAAM,EAAE;QACV,IAAI,CAACG,SAAS,CAACH,MAAM,CAAC;MACxB;MACA,IAAI,CAACI,aAAa,GAAGf,EAAE,CAACgB,IAAI,CAACC,IAAI,CAACC,cAAc,CAAC,CAAC,CAACC,iBAAiB,CAAC,CAAC,CAACC,SAAS,CAAC,CAAC;MAClF,IAAI,CAACC,KAAK,CAAC,CAAC;IACd,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,MAAM,EAAE;MACNC,MAAM,EAAE;IACV,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,UAAU,EAAE;MACVC,OAAO,EAAE;QACPC,KAAK,EAAE,gCAAgC;QACvCC,QAAQ,EAAE,IAAI;QACdC,KAAK,EAAE;MACT,CAAC;MAEDjB,MAAM,EAAE;QACNe,KAAK,EAAE,2BAA2B;QAClCC,QAAQ,EAAE,IAAI;QACdC,KAAK,EAAE;MACT;IACF,CAAC;IAED;AACF;AACA;AACA;AACA;IACEC,OAAO,EAAE;MACP;AACJ;AACA;MACId,aAAa,EAAE,IAAI;MAEnBe,YAAY,WAAZA,YAAYA,CAACC,KAAK,EAAEC,GAAG,EAAE;QACvB,IAAIA,GAAG,EAAE;UACPA,GAAG,CAACC,cAAc,CAAC,iBAAiB,EAAE,IAAI,CAACC,yBAAyB,EAAE,IAAI,CAAC;QAC7E;QACA,IAAIH,KAAK,EAAE;UACTA,KAAK,CAACI,WAAW,CAAC,iBAAiB,EAAE,IAAI,CAACD,yBAAyB,EAAE,IAAI,CAAC;QAC5E;MACF,CAAC;MAEDE,aAAa,WAAbA,aAAaA,CAACL,KAAK,EAAEC,GAAG,EAAE;QAAA,IAAAK,KAAA;QACxB,IAAIL,GAAG,EAAE;UACPA,GAAG,CAACM,qBAAqB,CAAC,IAAI,CAACC,eAAe,CAAC,eAAe,CAAC,CAAC;UAChEP,GAAG,CAACM,qBAAqB,CAAC,IAAI,CAACC,eAAe,CAAC,YAAY,CAAC,CAAC;QAC/D;QACA,IAAIR,KAAK,EAAE;UACT,IAAMS,QAAQ,GAAGT,KAAK,CAACU,UAAU,CAAC,CAAC;UACnC,IAAI,CAACF,eAAe,CAAC,aAAa,CAAC,CAACG,UAAU,CAAC,IAAI,CAAC;UACpD,IAAIF,QAAQ,EAAE;YACZT,KAAK,CAACY,IAAI,CAAC,WAAW,EAAE,IAAI,CAACJ,eAAe,CAAC,eAAe,CAAC,EAAE,SAAS,CAAC;YAEzER,KAAK,CAACY,IAAI,CAAC,WAAW,EAAE,IAAI,CAACJ,eAAe,CAAC,YAAY,CAAC,EAAE,SAAS,CAAC;YAEtE,IAAI,CAACA,eAAe,CAAC,aAAa,CAAC,CAACK,OAAO,CAAC,CAAC;YAC7C,IAAI,CAACL,eAAe,CAAC,aAAa,CAAC,CAACM,IAAI,CAAC,CAAC;YAC1C,IAAI,CAACN,eAAe,CAAC,aAAa,CAAC,CAACG,UAAU,CAACX,KAAK,CAACe,iBAAiB,CAAC,CAAC,CAAC;YAEzE,IAAIC,OAAO,GAAGhB,KAAK,CAACiB,kBAAkB,CAAC,IAAI,CAAC;YAC5C,IAAI,CAACT,eAAe,CAAC,eAAe,CAAC,CAACG,UAAU,CAACK,OAAO,CAACE,MAAM,GAAG,CAAC,CAAC;UACtE,CAAC,MAAM;YACL,IAAI,CAACV,eAAe,CAAC,eAAe,CAAC,CAACG,UAAU,CAAC,KAAK,CAAC;YACvD,IAAI,CAACH,eAAe,CAAC,YAAY,CAAC,CAACG,UAAU,CAAC,KAAK,CAAC;YACpD,IAAI,CAACH,eAAe,CAAC,eAAe,CAAC,CAACG,UAAU,CAAC,KAAK,CAAC;YACvD,IAAI,CAACH,eAAe,CAAC,aAAa,CAAC,CAACM,IAAI,CAAC,CAAC;YAC1C;YACA,IAAI,CAACN,eAAe,CAAC,aAAa,CAAC,CAACG,UAAU,CAACX,KAAK,CAACe,iBAAiB,CAAC,CAAC,CAAC;YAEzE,IAAI,CAACP,eAAe,CAAC,aAAa,CAAC,CAACK,OAAO,CAAC,CAAC;UAC/C;QACF,CAAC,MAAM;UACL,CAAC,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC,CAACM,OAAO,CAAC,UAAAC,IAAI;YAAA,OAC/Dd,KAAI,CAACE,eAAe,CAACY,IAAI,GAAG,SAAS,CAAC,CAACT,UAAU,CAAC,KAAK,CAAC;UAAA,CAC1D,CAAC;QACH;QACA,IAAI,CAACR,yBAAyB,CAAC,CAAC;MAClC,CAAC;MAEDb,KAAK,WAALA,KAAKA,CAAA,EAAG;QAAA,IAAA+B,MAAA;QACN,CAAC,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC,CAACF,OAAO,CAAC,UAAAC,IAAI;UAAA,OAAIC,MAAI,CAACC,GAAG,CAACD,MAAI,CAACb,eAAe,CAACY,IAAI,GAAG,SAAS,CAAC,CAAC;QAAA,EAAC;QAE5F,IAAI,CAACG,YAAY,CAAC,CAAC;QACnB,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,CAACJ,OAAO,CAAC,UAAAC,IAAI;UAAA,OAAIC,MAAI,CAACC,GAAG,CAACD,MAAI,CAACb,eAAe,CAACY,IAAI,GAAG,SAAS,CAAC,CAAC;QAAA,EAAC;QAE1F,IAAI,CAACG,YAAY,CAAC,CAAC;QACnB,IAAI,CAACD,GAAG,CAAC,IAAI,CAACd,eAAe,CAAC,eAAe,CAAC,CAAC;MACjD,CAAC;MAEDL,yBAAyB,WAAzBA,yBAAyBA,CAAA,EAAG;QAC1B,IAAMqB,OAAO,GAAG,IAAI,CAACC,SAAS,CAAC,CAAC,CAACC,YAAY,CAAC,CAAC;QAC/C,IAAMhC,OAAO,GAAG,IAAI,CAACiC,UAAU,CAAC,CAAC;QACjC,IAAIC,OAAO,GAAG,CAAClC,OAAO,GAAGA,OAAO,CAACgB,UAAU,CAAC,CAAC,GAAG,KAAK,KAAKc,OAAO,YAAYK,EAAE,CAACrD,EAAE,CAACsD,OAAO,CAACC,KAAK,CAACC,UAAU;QAC3G,IAAIJ,OAAO,EAAE;UACX;UACA,IAAIZ,OAAO,GAAGtB,OAAO,CAACuB,kBAAkB,CAAC,IAAI,CAAC;UAC9CW,OAAO,GACLZ,OAAO,CAACiB,QAAQ,CAACT,OAAO,CAACU,OAAO,CAAC,CAAC,CAAC,IAAIxC,OAAO,CAACyC,wBAAwB,CAACX,OAAO,EAAEY,MAAM,CAACC,iBAAiB,CAAC;QAC9G;QACA,IAAI,CAAC7B,eAAe,CAAC,cAAc,CAAC,CAACG,UAAU,CAACiB,OAAO,CAAC;MAC1D,CAAC;MAED;MACAU,uBAAuB,WAAvBA,uBAAuBA,CAACC,EAAE,EAAEC,IAAI,EAAE;QAChC,IAAIC,OAAO;QAEX,QAAQF,EAAE;UACR,KAAK,aAAa;YAChBE,OAAO,GAAG,IAAI,CAACC,QAAc,CAAC,MAAM,EAAE,IAAI,CAACC,EAAE,CAAC,MAAM,CAAC,EAAEd,EAAE,CAACe,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YAEhGN,OAAO,CAAC5B,OAAO,CAAC,CAAC;YACjB;UAEF,KAAK,aAAa;YAChB4B,OAAO,GAAG,IAAI,CAACC,QAAc,CAAC,MAAM,EAAE,IAAI,CAACC,EAAE,CAAC,MAAM,CAAC,EAAEd,EAAE,CAACe,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YAEhG;UAEF,KAAK,eAAe;YAClBN,OAAO,GAAG,IAAI,CAACC,QAAc,CAAC,QAAQ,EAAE,IAAI,CAACC,EAAE,CAAC,QAAQ,CAAC,EAAEd,EAAE,CAACe,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;YAEtG;UAEF,KAAK,YAAY;YACfN,OAAO,GAAG,IAAI,CAACC,QAAc,CAAC,KAAK,EAAE,IAAI,CAACC,EAAE,CAAC,KAAK,CAAC,EAAEd,EAAE,CAACe,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;YAE7F;UAEF,KAAK,aAAa;YAChBN,OAAO,GAAG,IAAI,CAACC,QAAc,CAAC,MAAM,EAAE,IAAI,CAACC,EAAE,CAAC,MAAM,CAAC,EAAEd,EAAE,CAACe,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YAEhG;UAEF,KAAK,cAAc;YACjBN,OAAO,GAAG,IAAI,CAACC,QAAc,CAAC,OAAO,EAAE,IAAI,CAACC,EAAE,CAAC,OAAO,CAAC,EAAEd,EAAE,CAACe,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;YAEnG;UAEF,KAAK,aAAa;YAChBN,OAAO,GAAG,IAAIxE,EAAE,CAACO,EAAE,CAACC,IAAI,CAACC,IAAI,CAAC,CAAC;YAC/B;UAEF,KAAK,eAAe;YAClB+D,OAAO,GAAG,IAAI,CAACC,QAAc,CAAC,QAAQ,EAAE,IAAI,CAACC,EAAE,CAAC,WAAW,CAAC,EAAEd,EAAE,CAACe,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;YAEtG;QACJ;QAEA,OAAON,OAAO,IAAAZ,EAAA,CAAArD,EAAA,CAAAsD,OAAA,CAAAkB,WAAA,CAAAC,aAAA,CAAAC,UAAA,CAAAC,SAAA,CAAAb,uBAAA,CAAAxD,IAAA,OAAkCyD,EAAE,CAAC;MACrD,CAAC;MAEDG,QAAc,WAAdA,QAAcA,CAAClD,MAAM,EAAE4D,KAAK,EAAEC,IAAI,EAAEC,OAAO,EAAE7E,IAAI,EAAE;QAAA,IAAA8E,MAAA;QACjD,IAAMC,MAAM,GAAG,IAAIvF,EAAE,CAACO,EAAE,CAACC,IAAI,CAACgF,MAAM,CAACL,KAAK,EAAEC,IAAI,EAAEC,OAAO,EAAE7E,IAAI,CAAC;QAChE+E,MAAM,CAACpD,WAAW,CAAC,SAAS,EAAE,YAAM;UAClCmD,MAAI,CAACG,aAAa,CAAC,QAAQ,EAAE;YAC3BlE,MAAM,EAAEA,MAAM;YACdE,OAAO,EAAE6D,MAAI,CAAC5B,UAAU,CAAC;UAC3B,CAAC,CAAC;QACJ,CAAC,CAAC;QACF,OAAO6B,MAAM;MACf;IACF,CAAC;IAED;AACF;AACA;AACA;AACA;IACEG,QAAQ,WAARA,QAAQA,CAAA,EAAG;MACT,IAAI,CAAC3E,aAAa,GAAG,IAAI;IAC3B;EACF,CAAC,CAAC;EAxNF6C,EAAE,CAACrD,EAAE,CAACsD,OAAO,CAACkB,WAAW,CAACC,aAAa,CAAC7E,aAAa,GAAGA,aAAa;AAAC",
  "ignoreList": []
}