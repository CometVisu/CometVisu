{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "construct",
    "grid",
    "layout",
    "Grid",
    "setColumnFlex",
    "setColumnAlign",
    "_setLayout",
    "_createChildControl",
    "properties",
    "appearance",
    "refine",
    "init",
    "model",
    "check",
    "nullable",
    "apply",
    "modified",
    "event",
    "readOnly",
    "events",
    "members",
    "_listController",
    "_originalName",
    "_originalOptions",
    "_applyModel",
    "value",
    "old",
    "nameField",
    "getChildControl",
    "__unbindModel",
    "bind",
    "getName",
    "getOptions",
    "forEach",
    "option",
    "addListener",
    "__checkForModification",
    "getKey",
    "getValue",
    "length",
    "emptyOption",
    "cv",
    "manager",
    "config",
    "Option",
    "push",
    "removeRelatedBindings",
    "removeListener",
    "getModel",
    "setModified",
    "Object",
    "keys",
    "some",
    "prototype",
    "hasOwnProperty",
    "call",
    "_onDeleteOption",
    "ev",
    "getData",
    "options",
    "resetKey",
    "resetValue",
    "removed",
    "remove",
    "_onAddOption",
    "_createChildControlImpl",
    "id",
    "control",
    "basic",
    "Label",
    "tr",
    "_add",
    "row",
    "column",
    "form",
    "TextField",
    "set",
    "liveUpdate",
    "required",
    "Button",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "setToolTipText",
    "fireDataEvent",
    "converter",
    "List",
    "setEnableInlineFind",
    "data",
    "controller",
    "setNullValueTitle",
    "setAllowNull",
    "setDelegate",
    "createItem",
    "OptionListItem",
    "configureItem",
    "item",
    "bindItem",
    "index",
    "bindProperty",
    "destruct",
    "_disposeObjects",
    "SectionListItem"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SectionListItem.js"
  ],
  "sourcesContent": [
    "/* SectionListItem.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * This widgets shows and editable config section in a list.\n */\nqx.Class.define('cv.ui.manager.form.SectionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    super();\n    const grid = new qx.ui.layout.Grid(8, 8);\n    grid.setColumnFlex(1, 1);\n    grid.setColumnAlign(0, 'left', 'top');\n    this._setLayout(grid);\n    this._createChildControl('section-title');\n    this._createChildControl('list');\n    this._createChildControl('delete');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-section'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.config.Section',\n      nullable: false,\n      apply: '_applyModel'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    },\n\n    readOnly: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadOnly'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    delete: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n    _originalName: null,\n    _originalOptions: null,\n\n    _applyModel(value, old) {\n      const nameField = this.getChildControl('name');\n      this.__unbindModel(old);\n      if (value) {\n        value.bind('name', nameField, 'value');\n        this._originalName = value.getName();\n        this._originalOptions = {};\n        value.getOptions().forEach(function (option) {\n          option.addListener('change', this.__checkForModification, this);\n          this._originalOptions[option.getKey()] = option.getValue();\n        }, this);\n        nameField.bind('value', value, 'name');\n        value.addListener('changeName', this.__checkForModification, this);\n        value.bind('options', this._listController, 'model');\n        // add at least one empty entry, when there are no options\n        if (value.getOptions().length === 0) {\n          const emptyOption = new cv.ui.manager.model.config.Option('', '');\n          value.getOptions().push(emptyOption);\n        }\n      } else {\n        this._originalName = null;\n        this._originalOptions = null;\n      }\n    },\n\n    __unbindModel(model) {\n      if (model) {\n        const nameField = this.getChildControl('name');\n        if (this._listController) {\n          model.removeRelatedBindings(this._listController);\n        }\n        model.removeListener('changeName', this.__checkForModification, this);\n        model.removeRelatedBindings(nameField);\n        nameField.removeRelatedBindings(model);\n        model.getOptions().forEach(function (option) {\n          option.removeListener('change', this.__checkForModification, this);\n        }, this);\n      }\n    },\n\n    __checkForModification() {\n      if (this._originalName !== this.getModel().getName()) {\n        this.setModified(true);\n        return;\n      }\n      // check if the still have the same the same amount of options\n      if (Object.keys(this._originalOptions).length !== this.getModel().getOptions().length) {\n        this.setModified(true);\n        return;\n      }\n      // compare options one by one\n      const modified = this.getModel()\n        .getOptions()\n        .some(function (option) {\n          return (\n            !Object.prototype.hasOwnProperty.call(this._originalOptions, option.getKey()) ||\n            this._originalOptions[option.getKey()] !== option.getValue()\n          );\n        }, this);\n      this.setModified(modified);\n    },\n\n    _onDeleteOption(ev) {\n      const option = ev.getData();\n      const options = this.getModel().getOptions();\n      if (options.length === 1) {\n        // do not delete the last option, just reset its values\n        option.resetKey();\n        option.resetValue();\n      } else {\n        const removed = this.getModel().getOptions().remove(option);\n        if (removed) {\n          removed.removeListener('change', this.__checkForModification, this);\n        }\n      }\n      this.__checkForModification();\n    },\n\n    _onAddOption() {\n      const option = new cv.ui.manager.model.config.Option('', '');\n      option.addListener('change', this.__checkForModification, this);\n      this.getModel().getOptions().push(option);\n      this.__checkForModification();\n    },\n\n    // overridden\n    _createChildControlImpl(id) {\n      let control;\n\n      switch (id) {\n        case 'section-title':\n          control = new qx.ui.basic.Label(this.tr('Section'));\n          this._add(control, { row: 0, column: 0 });\n          break;\n\n        case 'name':\n          control = new qx.ui.form.TextField();\n          control.set({\n            liveUpdate: true,\n            required: true\n          });\n\n          this.bind('readOnly', control, 'readOnly');\n          this._add(control, { row: 0, column: 1 });\n          break;\n\n        case 'delete':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n\n          control.setToolTipText(this.tr('Delete section'));\n          control.addListener('execute', () => {\n            this.fireDataEvent('delete', this.getModel());\n          });\n          this.bind('readOnly', control, 'visibility', {\n            converter(value) {\n              return value ? 'hidden' : 'visible';\n            }\n          });\n\n          this._add(control, { row: 0, column: 2 });\n          break;\n\n        case 'list':\n          control = new qx.ui.form.List();\n          control.setEnableInlineFind(false);\n          this._listController = new qx.data.controller.List(null, control);\n          this._listController.setNullValueTitle('header');\n          this._listController.setAllowNull(true);\n          this._listController.setDelegate({\n            createItem() {\n              return new cv.ui.manager.form.OptionListItem();\n            },\n            configureItem: function (item) {\n              item.addListener('delete', this._onDeleteOption, this);\n              item.addListener('add', this._onAddOption, this);\n              this.bind('readOnly', item, 'readOnly');\n            }.bind(this),\n            bindItem(controller, item, index) {\n              controller.bindProperty('', 'model', null, item, index);\n            }\n          });\n\n          this._add(control, { row: 1, column: 1 });\n          break;\n      }\n\n      return control || super._createChildControlImpl(id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._disposeObjects('_listController');\n  }\n});\n"
  ],
  "mappings": "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"
}