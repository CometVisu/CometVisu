{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "implement",
    "form",
    "IStringForm",
    "IForm",
    "include",
    "MForm",
    "construct",
    "value",
    "type",
    "_init",
    "setType",
    "setValue",
    "events",
    "changeValue",
    "properties",
    "check",
    "init",
    "apply",
    "focusable",
    "refine",
    "autoSize",
    "members",
    "_editor",
    "__delayedValue",
    "__areaHeight",
    "_hasBeenEdited",
    "_applyType",
    "_autoSize",
    "isAutoSize",
    "contentHeight",
    "getModel",
    "getLineCount",
    "_setAreaHeight",
    "getType",
    "resetValue",
    "getValue",
    "window",
    "monaco",
    "cv",
    "manager",
    "editor",
    "Source",
    "load",
    "domElement",
    "getContentElement",
    "getDomElement",
    "addListenerOnce",
    "create",
    "suggestOnTriggerCharacters",
    "folding",
    "autoIndent",
    "automaticLayout",
    "dragAndDrop",
    "formatOnPaste",
    "formatOnType",
    "renderValidationDecorations",
    "minimap",
    "enabled",
    "theme",
    "model",
    "uri",
    "Uri",
    "parse",
    "newModel",
    "createModel",
    "updateOptions",
    "tabSize",
    "indentSize",
    "insertSpaces",
    "setModel",
    "onDidChangeModelContent",
    "_onContentChange",
    "bind",
    "fireDataEvent",
    "getFocusElement",
    "el",
    "height",
    "queue",
    "Layout",
    "add",
    "Manager",
    "flush",
    "layout",
    "_getContentHint",
    "hint",
    "destruct",
    "dispose",
    "SourceCodeField"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SourceCodeField.js"
  ],
  "sourcesContent": [
    "/* SourceCodeField.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.form.SourceCodeField', {\n  extend: qx.ui.core.Widget,\n  implement: [qx.ui.form.IStringForm, qx.ui.form.IForm],\n\n  include: [qx.ui.form.MForm],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(value, type) {\n    super();\n    this._init();\n\n    if (type) {\n      this.setType(type);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /** Fired when the value was modified */\n    changeValue: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: 'String',\n      init: 'xml',\n      apply: '_applyType'\n    },\n\n    // overridden\n    focusable: {\n      refine: true,\n      init: true\n    },\n\n    autoSize: {\n      check: 'Boolean',\n      init: false,\n      apply: '_autoSize'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _editor: null,\n    __delayedValue: null,\n    __areaHeight: null,\n    _hasBeenEdited: false,\n\n    _applyType(value) {\n      if (value && this.__delayedValue) {\n        this.setValue(this.__delayedValue);\n        this.__delayedValue = null;\n      }\n    },\n\n    _autoSize() {\n      if (this._editor && this.isAutoSize()) {\n        const contentHeight = (this._editor.getModel().getLineCount() + 1) * 19;\n        this._setAreaHeight(contentHeight);\n      }\n    },\n\n    /**\n     * Sets the element's value.\n     *\n     * @param value {String|null} The new value of the element.\n     */\n    setValue(value) {\n      if (!this._hasBeenEdited) {\n        if (this._editor && this.getType()) {\n          this._editor.setValue(value);\n        } else {\n          this.__delayedValue = value;\n        }\n      }\n      this._autoSize();\n    },\n\n    /**\n     * Resets the element's value to its initial value.\n     */\n    resetValue() {\n      if (this._editor) {\n        this._editor.setValue('');\n      }\n    },\n\n    /**\n     * The element's user set value.\n     *\n     * @return {String|null} The value.\n     */\n    getValue() {\n      if (this._editor) {\n        return this._editor.getValue();\n      } else if (this.__delayedValue) {\n        return this.__delayedValue;\n      }\n      return '';\n    },\n\n    _init() {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._init, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', () => {\n            this._init();\n          });\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: false\n            },\n\n            theme: 'vs-dark'\n          });\n\n          if (this.getType()) {\n            const model = this._editor.getModel();\n            const uri = monaco.Uri.parse('cv://SourceCode.' + this.getType());\n            let newModel = window.monaco.editor.getModel(uri);\n            if (!newModel) {\n              newModel = window.monaco.editor.createModel(this.__delayedValue, this.getType(), uri);\n            } else {\n              newModel.setValue(this.__delayedValue);\n            }\n            if (model !== newModel) {\n              newModel.updateOptions({\n                tabSize: 2,\n                indentSize: 2,\n                insertSpaces: true\n              });\n\n              this._editor.setModel(newModel);\n            }\n          }\n          if (this.__delayedValue) {\n            this.__delayedValue = null;\n          }\n          this._editor.onDidChangeModelContent(this._onContentChange.bind(this));\n        }\n      }\n    },\n\n    _onContentChange() {\n      this._hasBeenEdited = true;\n      this.fireDataEvent('changeValue', this._editor.getValue());\n      this._autoSize();\n    },\n\n    // overridden\n    getFocusElement() {\n      const el = this.getContentElement();\n      if (el) {\n        return el;\n      }\n      return null;\n    },\n\n    _setAreaHeight(height) {\n      if (this.__areaHeight !== height) {\n        this.__areaHeight = height;\n        qx.ui.core.queue.Layout.add(this);\n        qx.ui.core.queue.Manager.flush();\n        if (this._editor) {\n          this._editor.layout();\n        }\n      }\n    },\n\n    // overridden\n    _getContentHint() {\n      const hint = super._getContentHint();\n\n      if (this.isAutoSize()) {\n        hint.height = this.__areaHeight || hint.height;\n      }\n\n      return hint;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._hasBeenEdited = false;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}