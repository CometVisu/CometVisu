{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "implement",
    "form",
    "IStringForm",
    "IForm",
    "include",
    "MForm",
    "construct",
    "value",
    "type",
    "_init",
    "setType",
    "setValue",
    "events",
    "changeValue",
    "properties",
    "check",
    "init",
    "apply",
    "focusable",
    "refine",
    "autoSize",
    "members",
    "_editor",
    "__delayedValue",
    "__areaHeight",
    "_hasBeenEdited",
    "_applyType",
    "_autoSize",
    "isAutoSize",
    "contentHeight",
    "getModel",
    "getLineCount",
    "_setAreaHeight",
    "getType",
    "resetValue",
    "getValue",
    "window",
    "monaco",
    "cv",
    "manager",
    "editor",
    "Source",
    "load",
    "domElement",
    "getContentElement",
    "getDomElement",
    "addListenerOnce",
    "create",
    "suggestOnTriggerCharacters",
    "folding",
    "autoIndent",
    "automaticLayout",
    "dragAndDrop",
    "formatOnPaste",
    "formatOnType",
    "renderValidationDecorations",
    "minimap",
    "enabled",
    "theme",
    "model",
    "uri",
    "Uri",
    "parse",
    "newModel",
    "createModel",
    "updateOptions",
    "tabSize",
    "indentSize",
    "insertSpaces",
    "setModel",
    "onDidChangeModelContent",
    "_onContentChange",
    "bind",
    "fireDataEvent",
    "getFocusElement",
    "el",
    "height",
    "queue",
    "Layout",
    "add",
    "Manager",
    "flush",
    "layout",
    "_getContentHint",
    "hint",
    "destruct",
    "dispose",
    "SourceCodeField"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SourceCodeField.js"
  ],
  "sourcesContent": [
    "/* SourceCodeField.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.form.SourceCodeField', {\n  extend: qx.ui.core.Widget,\n  implement: [qx.ui.form.IStringForm, qx.ui.form.IForm],\n\n  include: [qx.ui.form.MForm],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(value, type) {\n    super();\n    this._init();\n\n    if (type) {\n      this.setType(type);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /** Fired when the value was modified */\n    changeValue: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: 'String',\n      init: 'xml',\n      apply: '_applyType'\n    },\n\n    // overridden\n    focusable: {\n      refine: true,\n      init: true\n    },\n\n    autoSize: {\n      check: 'Boolean',\n      init: false,\n      apply: '_autoSize'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _editor: null,\n    __delayedValue: null,\n    __areaHeight: null,\n    _hasBeenEdited: false,\n\n    _applyType(value) {\n      if (value && this.__delayedValue) {\n        this.setValue(this.__delayedValue);\n        this.__delayedValue = null;\n      }\n    },\n\n    _autoSize() {\n      if (this._editor && this.isAutoSize()) {\n        const contentHeight = (this._editor.getModel().getLineCount() + 1) * 19;\n        this._setAreaHeight(contentHeight);\n      }\n    },\n\n    /**\n     * Sets the element's value.\n     *\n     * @param value {String|null} The new value of the element.\n     */\n    setValue(value) {\n      if (!this._hasBeenEdited) {\n        if (this._editor && this.getType()) {\n          this._editor.setValue(value);\n        } else {\n          this.__delayedValue = value;\n        }\n      }\n      this._autoSize();\n    },\n\n    /**\n     * Resets the element's value to its initial value.\n     */\n    resetValue() {\n      if (this._editor) {\n        this._editor.setValue('');\n      }\n    },\n\n    /**\n     * The element's user set value.\n     *\n     * @return {String|null} The value.\n     */\n    getValue() {\n      if (this._editor) {\n        return this._editor.getValue();\n      } else if (this.__delayedValue) {\n        return this.__delayedValue;\n      }\n      return '';\n    },\n\n    _init() {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._init, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', () => {\n            this._init();\n          });\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: false\n            },\n\n            theme: 'vs-dark'\n          });\n\n          if (this.getType()) {\n            const model = this._editor.getModel();\n            const uri = monaco.Uri.parse('cv://SourceCode.' + this.getType());\n            let newModel = window.monaco.editor.getModel(uri);\n            if (!newModel) {\n              newModel = window.monaco.editor.createModel(this.__delayedValue, this.getType(), uri);\n            } else {\n              newModel.setValue(this.__delayedValue);\n            }\n            if (model !== newModel) {\n              newModel.updateOptions({\n                tabSize: 2,\n                indentSize: 2,\n                insertSpaces: true\n              });\n\n              this._editor.setModel(newModel);\n            }\n          }\n          if (this.__delayedValue) {\n            this.__delayedValue = null;\n          }\n          this._editor.onDidChangeModelContent(this._onContentChange.bind(this));\n        }\n      }\n    },\n\n    _onContentChange() {\n      this._hasBeenEdited = true;\n      this.fireDataEvent('changeValue', this._editor.getValue());\n      this._autoSize();\n    },\n\n    // overridden\n    getFocusElement() {\n      const el = this.getContentElement();\n      if (el) {\n        return el;\n      }\n      return null;\n    },\n\n    _setAreaHeight(height) {\n      if (this.__areaHeight !== height) {\n        this.__areaHeight = height;\n        qx.ui.core.queue.Layout.add(this);\n        qx.ui.core.queue.Manager.flush();\n        if (this._editor) {\n          this._editor.layout();\n        }\n      }\n    },\n\n    // overridden\n    _getContentHint() {\n      const hint = super._getContentHint();\n\n      if (this.isAutoSize()) {\n        hint.height = this.__areaHeight || hint.height;\n      }\n\n      return hint;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._hasBeenEdited = false;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}