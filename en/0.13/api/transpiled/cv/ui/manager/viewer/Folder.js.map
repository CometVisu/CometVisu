{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "viewer",
    "AbstractViewer",
    "implement",
    "core",
    "ISingleSelection",
    "form",
    "IModelSelection",
    "include",
    "MSingleSelectionHandling",
    "MRemoteChildrenHandling",
    "MModelSelection",
    "control",
    "MFileEventHandler",
    "construct",
    "noToolbar",
    "model",
    "Preferences",
    "getInstance",
    "bind",
    "_isImageRegex",
    "RegExp",
    "Image",
    "SUPPORTED_FILES",
    "join",
    "initModel",
    "data",
    "Array",
    "_setLayout",
    "layout",
    "VBox",
    "_newItem",
    "FileItem",
    "set",
    "fake",
    "type",
    "loaded",
    "icon",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "displayName",
    "tr",
    "special",
    "_debouncedOnFilter",
    "util",
    "Function",
    "debounce",
    "_onFilter",
    "_createChildControl",
    "statics",
    "item",
    "getType",
    "TITLE",
    "locale",
    "Manager",
    "ICON",
    "events",
    "addItem",
    "removeItem",
    "properties",
    "check",
    "deferredInit",
    "permanentFilter",
    "nullable",
    "apply",
    "showTextFilter",
    "init",
    "labelConverter",
    "disableScrolling",
    "viewMode",
    "event",
    "members",
    "_controller",
    "_getItems",
    "getChildControl",
    "getChildren",
    "_isAllowEmptySelection",
    "_defaultLabelConverter",
    "name",
    "getViewMode",
    "parts",
    "split",
    "length",
    "pop",
    "_getDelegate",
    "getLabelConverter",
    "converter",
    "createItem",
    "FileListItem",
    "configureItem",
    "addListener",
    "_onDblTap",
    "_onFsItemRightClick",
    "setShowFileActions",
    "bindItem",
    "controller",
    "index",
    "bindProperty",
    "source",
    "file",
    "test",
    "getName",
    "getServerPath",
    "ev",
    "getCurrentTarget",
    "getModel",
    "getSpecial",
    "preventDefault",
    "getBubbles",
    "stopPropagation",
    "menu",
    "contextmenu",
    "GlobalFileItem",
    "configure",
    "setContextMenu",
    "openAtPointer",
    "stop",
    "message",
    "Bus",
    "dispatchByName",
    "_applyFile",
    "old",
    "removeRelatedBindings",
    "resetModel",
    "container",
    "List",
    "setDelegate",
    "setParent",
    "getValue",
    "getPermanentFilter",
    "setModel",
    "load",
    "resetParent",
    "_handleFileEvent",
    "folder",
    "getFile",
    "getData",
    "action",
    "reload",
    "path",
    "startsWith",
    "getFullPath",
    "children",
    "dispose",
    "some",
    "child",
    "remove",
    "_applyShowTextFilter",
    "value",
    "setVisibility",
    "filterString",
    "filterFunction",
    "filtered",
    "filter",
    "includes",
    "getChildrenContainer",
    "_onAddChild",
    "e",
    "fireDataEvent",
    "_onRemoveChild",
    "_onFileEvent",
    "_applyDisableScrolling",
    "exclude",
    "_addAt",
    "flex",
    "scrollContainer",
    "show",
    "add",
    "_createChildControlImpl",
    "id",
    "ToolBar",
    "TextField",
    "placeholder",
    "liveUpdate",
    "margin",
    "isShowTextFilter",
    "Scroll",
    "Composite",
    "Flow",
    "isDisableScrolling",
    "destruct",
    "_disposeObjects",
    "Folder"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Folder.js"
  ],
  "sourcesContent": [
    "/* Folder.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Displays folder content in an explorer like view.\n */\nqx.Class.define('cv.ui.manager.viewer.Folder', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n  implement: [qx.ui.core.ISingleSelection, qx.ui.form.IModelSelection],\n\n  include: [\n    qx.ui.core.MSingleSelectionHandling,\n    qx.ui.core.MRemoteChildrenHandling,\n    qx.ui.form.MModelSelection,\n    cv.ui.manager.control.MFileEventHandler\n  ],\n\n  /*\n  ***********************************************\n   CONSTRUCTOR\n  ***********************************************\n  */\n  construct(noToolbar) {\n    super();\n    cv.ui.manager.model.Preferences.getInstance().bind('startViewMode', this, 'viewMode');\n\n    this._isImageRegex = new RegExp('\\\\.(' + cv.ui.manager.viewer.Image.SUPPORTED_FILES.join('|') + ')$', 'i');\n\n    this.initModel(new qx.data.Array());\n    this._setLayout(new qx.ui.layout.VBox(8));\n\n    this._newItem = new cv.ui.manager.model.FileItem('new', 'new', null).set({\n      fake: true,\n      type: 'file',\n      loaded: true,\n      icon: cv.theme.dark.Images.getIcon('upload'),\n      displayName: this.tr('Upload file'),\n      special: 'add-file'\n    });\n\n    this._debouncedOnFilter = qx.util.Function.debounce(this._onFilter, 500, false);\n\n    if (!noToolbar) {\n      this._createChildControl('toolbar');\n    }\n    this._createChildControl('filter');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES(item) {\n      // noinspection JSConstructorReturnsPrimitive\n      return item.getType() === 'dir';\n    },\n    TITLE: qx.locale.Manager.tr('Show folder'),\n    ICON: cv.theme.dark.Images.getIcon('folder', 18)\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /**\n     * This event is fired after a list item was added to the list. The\n     * {@link qx.event.type.Data#getData} method of the event returns the\n     * added item.\n     */\n    addItem: 'qx.event.type.Data',\n\n    /**\n     * This event is fired after a list item has been removed from the list.\n     * The {@link qx.event.type.Data#getData} method of the event returns the\n     * removed item.\n     */\n    removeItem: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    model: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    permanentFilter: {\n      check: 'Function',\n      nullable: true,\n      apply: '_onFilter'\n    },\n\n    showTextFilter: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowTextFilter'\n    },\n\n    labelConverter: {\n      check: 'Function',\n      nullable: true\n    },\n\n    disableScrolling: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDisableScrolling'\n    },\n\n    viewMode: {\n      check: ['list', 'preview'],\n      init: 'list',\n      event: 'changeViewMode'\n    }\n  },\n\n  /*\n  ***********************************************\n   MEMBERS\n  ***********************************************\n  */\n  members: {\n    _controller: null,\n    _isImageRegex: null,\n    _newItem: null,\n\n    _getItems() {\n      return this.getChildControl('list').getChildren();\n    },\n\n    _isAllowEmptySelection() {\n      return true;\n    },\n\n    _defaultLabelConverter(name) {\n      if (this.getViewMode() === 'list') {\n        // do not remove file type in list mode\n        return name;\n      }\n      const parts = name.split('.');\n      if (parts.length > 1) {\n        parts.pop();\n      }\n      return parts.join('.');\n    },\n\n    _getDelegate() {\n      const labelConverter = this.getLabelConverter();\n      const converter = {\n        converter: labelConverter ? labelConverter : this._defaultLabelConverter.bind(this)\n      };\n\n      return {\n        createItem() {\n          return new cv.ui.manager.form.FileListItem();\n        },\n\n        configureItem: function (item) {\n          item.addListener('dbltap', this._onDblTap, this);\n          item.addListener('contextmenu', this._onFsItemRightClick, this);\n          item.addListener('action', this._onFsItemRightClick, this);\n          item.setShowFileActions(true);\n          this.bind('viewMode', item, 'viewMode');\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n          controller.bindProperty('displayName', 'label', converter, item, index);\n\n          controller.bindProperty(\n            'icon',\n            'icon',\n            {\n              converter: function (source, file) {\n                if (file.getType() === 'file' && this._isImageRegex.test(file.getName())) {\n                  // use the image as icon\n                  return file.getServerPath();\n                }\n                if (!source) {\n                  return null;\n                }\n                // remove size from icon source\n                const parts = source.split('/');\n                if (parts.length === 3) {\n                  parts.pop();\n                }\n                return parts.join('/');\n              }.bind(this)\n            },\n\n            item,\n            index\n          );\n        }.bind(this)\n      };\n    },\n\n    _onFsItemRightClick(ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        ev.preventDefault();\n        if (ev.getBubbles()) {\n          ev.stopPropagation();\n        }\n        return;\n      }\n      const menu = cv.ui.manager.contextmenu.GlobalFileItem.getInstance();\n      menu.configure(file);\n      ev.getCurrentTarget().setContextMenu(menu);\n      menu.openAtPointer(ev);\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onDblTap(ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        // Select file for upload\n      } else {\n        qx.event.message.Bus.dispatchByName('cv.manager.open', file);\n      }\n    },\n\n    _applyFile(file, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n        this.resetModel();\n      }\n      if (file) {\n        const container = this.getChildControl('list');\n        if (!this._controller) {\n          this._controller = new qx.data.controller.List(null, container);\n          this._controller.setDelegate(this._getDelegate());\n        }\n        file.bind('children', this, 'model');\n        const model = this.getModel();\n        this._newItem.setParent(file);\n        model.addListener('change', () => {\n          if (this.getChildControl('filter').getValue() || this.getPermanentFilter()) {\n            this._onFilter();\n          } else {\n            this._controller.setModel(model);\n          }\n        });\n        this._controller.setModel(model);\n        file.load();\n      } else {\n        if (this._controller) {\n          this._controller.resetModel();\n        }\n        this._newItem.resetParent();\n      }\n    },\n\n    _handleFileEvent(ev) {\n      const folder = this.getFile();\n      const data = ev.getData();\n      switch (data.action) {\n        case 'moved':\n          folder.reload();\n          break;\n\n        case 'added':\n        case 'uploaded':\n        case 'created':\n          if (data.path.startsWith(folder.getFullPath())) {\n            folder.reload();\n          }\n          break;\n\n        case 'deleted': {\n          let children;\n          if (folder) {\n            if (data.path === folder.getFullPath()) {\n              // this item has been deleted\n              this.dispose();\n            } else if (data.path.startsWith(folder.getFullPath())) {\n              // delete child\n              children = folder.getChildren();\n              children.some(function (child) {\n                if (child.getFullPath() === data.path) {\n                  children.remove(child);\n                  this.removeRelatedBindings(child);\n                  return true;\n                }\n                return false;\n              }, this);\n            }\n          }\n          children = this.getModel();\n          children.some(function (child) {\n            if (child.getFullPath() === data.path) {\n              children.remove(child);\n              this.removeRelatedBindings(child);\n              return true;\n            }\n            return false;\n          }, this);\n          break;\n        }\n      }\n    },\n\n    _applyShowTextFilter(value) {\n      this.getChildControl('filter').setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    _onFilter() {\n      if (this._controller) {\n        const filterString = this.getChildControl('filter').getValue();\n        const filterFunction = this.getPermanentFilter();\n        const filtered = this.getModel().filter(function (file) {\n          return (!filterFunction || filterFunction(file)) && (!filterString || file.getName().includes(filterString));\n        });\n        this._controller.setModel(filtered);\n      }\n    },\n\n    getChildrenContainer() {\n      return this.getChildControl('list');\n    },\n\n    /**\n     * Handle child widget adds on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onAddChild(e) {\n      this.fireDataEvent('addItem', e.getData());\n    },\n\n    /**\n     * Handle child widget removes on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onRemoveChild(e) {\n      this.fireDataEvent('removeItem', e.getData());\n    },\n\n    _onFileEvent(ev) {\n      const data = ev.getData();\n      switch (data.action) {\n        case 'deleted':\n          break;\n      }\n    },\n\n    _applyDisableScrolling(value) {\n      if (value) {\n        this.getChildControl('scroll').exclude();\n        this._addAt(this.getChildControl('list'), 1, { flex: 1 });\n      } else {\n        const scrollContainer = this.getChildControl('scroll');\n        scrollContainer.show();\n        scrollContainer.add(this.getChildControl('list'));\n        this._addAt(scrollContainer, 1, { flex: 1 });\n      }\n    },\n\n    // overridden\n    _createChildControlImpl(id) {\n      let control;\n\n      switch (id) {\n        case 'toolbar':\n          control = new cv.ui.manager.ToolBar(null, ['new-file', 'new-folder', 'upload', 'reload']);\n\n          this.bind('file', control, 'folder');\n          control.addListener('reload', () => {\n            this.getFile().reload();\n          });\n          this._addAt(control, 0);\n          break;\n\n        case 'filter':\n          control = new qx.ui.form.TextField();\n          control.set({\n            placeholder: this.tr('Filter by name...'),\n            liveUpdate: true,\n            margin: 8\n          });\n\n          if (!this.isShowTextFilter()) {\n            control.exclude();\n          }\n          control.addListener('changeValue', this._debouncedOnFilter, this);\n          this._addAt(control, 1);\n          break;\n\n        case 'scroll':\n          control = new qx.ui.container.Scroll();\n          this._addAt(control, 2, { flex: 1 });\n          break;\n\n        case 'list':\n          control = new qx.ui.container.Composite(new qx.ui.layout.Flow(8, 8));\n\n          // Used to fire item add/remove events\n          control.addListener('addChildWidget', this._onAddChild, this);\n          control.addListener('removeChildWidget', this._onRemoveChild, this);\n          if (this.isDisableScrolling()) {\n            this._addAt(control, 1, { flex: 1 });\n          } else {\n            this.getChildControl('scroll').add(control);\n          }\n          break;\n      }\n\n      return control || super._createChildControlImpl(id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._disposeObjects('_controller');\n    this._isImageRegex = null;\n    cv.ui.manager.model.Preferences.getInstance().removeRelatedBindings(this);\n  }\n});\n"
  ],
  "mappings": "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"
}