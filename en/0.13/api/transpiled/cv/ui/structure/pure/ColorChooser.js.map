{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/ColorChooser.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "AbstractWidget",
    "include",
    "common",
    "Operate",
    "Update",
    "statics",
    "coord2sv",
    "x",
    "y",
    "hue",
    "radius",
    "hue2angle",
    "Math",
    "PI",
    "Sx",
    "sin",
    "Sy",
    "cos",
    "Wx",
    "Wy",
    "Bx",
    "By",
    "WBx",
    "WBy",
    "SBx",
    "SBy",
    "CBx",
    "CBy",
    "uv",
    "util",
    "Color",
    "solve2d",
    "u",
    "min",
    "max",
    "v",
    "value",
    "saturation",
    "abs",
    "construct",
    "props",
    "base",
    "getBaseColors",
    "__color",
    "r",
    "g",
    "b",
    "w",
    "__animator",
    "LimitedRateUpdateAnimator",
    "__updateHandlePosition",
    "setAnimationSpeed",
    "__pageSizeListener",
    "layout",
    "ResizeHandler",
    "states",
    "addListener",
    "__invalidateScreensize",
    "__components",
    "Set",
    "Object",
    "entries",
    "getAddress",
    "map",
    "variantInfo",
    "__lastBusValue",
    "destruct",
    "removeListenerById",
    "__button",
    "properties",
    "controls",
    "check",
    "baseColors",
    "sendOnFinish",
    "init",
    "members",
    "__mode",
    "__colorOld",
    "undefined",
    "__colorCurrent",
    "__range",
    "__actors",
    "__inDrag",
    "__coordMin",
    "__Tmin",
    "__Tmax",
    "_getInnerDomString",
    "placeholder",
    "getFormat",
    "self",
    "retval",
    "historicWidth",
    "getLayout",
    "colspan",
    "getControls",
    "split",
    "forEach",
    "control",
    "hue_type",
    "parts",
    "temperatures",
    "rgbTmin",
    "xy2sRGB",
    "temperature2xy",
    "rgbTmax",
    "disp",
    "c",
    "round",
    "join",
    "colors",
    "_onDomReady",
    "__throttled",
    "Function",
    "throttle",
    "__onChangeValue",
    "trailing",
    "getDomElement",
    "querySelectorAll",
    "actor",
    "addEventListener",
    "_update",
    "address",
    "data",
    "addressObj",
    "showInvalidDataErrorMessage",
    "message",
    "locale",
    "Manager",
    "tr",
    "transform",
    "selector",
    "variant",
    "Config",
    "testMode",
    "console",
    "error",
    "toString",
    "core",
    "notifications",
    "Router",
    "dispatchMessage",
    "variantType",
    "Transform",
    "decode",
    "Number",
    "isFinite",
    "get",
    "h",
    "s",
    "invCurve",
    "curve",
    "scale",
    "Map",
    "Y",
    "notKnown",
    "__setSliderTo",
    "isVisible",
    "instant",
    "copy",
    "changeComponent",
    "delta",
    "setTo",
    "newColor",
    "actors",
    "actorStyle",
    "type",
    "className",
    "replace",
    "window",
    "getComputedStyle",
    "sv_element",
    "querySelector",
    "inner",
    "handle",
    "handle_hue",
    "isLCh",
    "classList",
    "contains",
    "handle_hueTop",
    "parseFloat",
    "getPropertyValue",
    "handle_hueWidth",
    "width",
    "height",
    "innerRadius",
    "outerRadius",
    "button",
    "range",
    "buttonWidth",
    "style",
    "marginLeft",
    "borderRadius",
    "Bt",
    "St",
    "Wt",
    "Bl",
    "Sl",
    "Wl",
    "angle",
    "LCh",
    "getComponent",
    "WSt",
    "C",
    "WSl",
    "top",
    "L",
    "left",
    "background",
    "hsv",
    "transformOrigin",
    "ratioComponent",
    "length",
    "clipPath",
    "handleEvent",
    "event",
    "relCoordX",
    "relCoordY",
    "actorType",
    "currentTarget",
    "boundingRect",
    "getBoundingClientRect",
    "computedStyle",
    "__coordMinX",
    "paddingLeft",
    "__coordMinY",
    "clientX",
    "clientY",
    "sv",
    "pure",
    "ColorChooser",
    "distSqrd",
    "clearlyOnWheel",
    "closeToInerior",
    "closeToTriangleCorners",
    "atan2",
    "boxSize",
    "ratio",
    "document",
    "buttons",
    "removeEventListener",
    "getSendOnFinish",
    "call",
    "includes",
    "typeCategory",
    "sendToBackend",
    "t",
    "defer",
    "WidgetFactory",
    "registerClass"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ColorChooser.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The ColorChooser let you select and display a color, e.g. for lighting effects.\n * It supports a RGB light source with red, green and blue light components as well\n * as a RGBW light source that also has a white channel.\n *\n * @widgetexample\n * <settings>\n *      <screenshot name=\"colorchooser_example\">\n *          <caption>ColorChooser, simple example</caption>\n *      </screenshot>\n * </settings>\n * <colorchooser>\n *   <layout colspan=\"6\" rowspan=\"4\"/>\n *   <label>RGB kitchen</label>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"r\">1/2/59</address>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"g\">1/2/60</address>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"b\">1/2/61</address>\n * </colorchooser>\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.ColorChooser', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Calculate the saturation and value from (x,y) relative widget coordinates\n     * based on a centered SV-triangle.\n     * @param x position for the calculation\n     * @param y position for the calculation\n     * @param hue value for the orientation of the triangle\n     * @param radius (outside) radius of the triangle\n     */\n    coord2sv: function(x, y, hue, radius) {\n      const hue2angle = 2 * Math.PI;\n      // coordinates of the triangle corners\n      const Sx = 0.5 - Math.sin(hue2angle * (-hue)) * radius; // 100% saturation\n      const Sy = 0.5 - Math.cos(hue2angle * (-hue)) * radius;\n      const Wx = 0.5 - Math.sin(hue2angle * (2/3-hue)) * radius; // 100% white\n      const Wy = 0.5 - Math.cos(hue2angle * (2/3-hue)) * radius;\n      const Bx = 0.5 - Math.sin(hue2angle * (1/3-hue)) * radius; // 100% black\n      const By = 0.5 - Math.cos(hue2angle * (1/3-hue)) * radius;\n      // differences to determine (u,v) coordinates of (x,y)\n      const WBx = Wx - Bx;\n      const WBy = Wy - By;\n      const SBx = Sx - Bx;\n      const SBy = Sy - By;\n      const CBx = x - Bx;\n      const CBy = y - By;\n      const uv = cv.util.Color.solve2d(WBx, WBy, SBx, SBy, CBx, CBy);\n      const u = Math.min(Math.max(0, uv[0]), 1);\n      const v = Math.min(Math.max(0, uv[1]), 1);\n      // convert (u,v) to S and V\n      const value = u + v;\n      const saturation = Math.abs(value) < 1e-3 ? 0 : v/value;\n      return [saturation, value];\n    }\n  },\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.base(arguments, props);\n\n    const base = this.getBaseColors();\n    this.__color = new cv.util.Color(base.r, base.g, base.b, base.w);\n    this.__animator = new cv.util.LimitedRateUpdateAnimator(this.__updateHandlePosition, this);\n    this.__animator.setAnimationSpeed(100, 0.5);\n    this.__pageSizeListener = cv.ui.layout.ResizeHandler.states.addListener('changePageSizeInvalid', () => {\n      this.__invalidateScreensize();\n    });\n    this.__components = new Set(Object.entries(this.getAddress()).map(v => v[1].variantInfo));\n    this.__lastBusValue = {};\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    cv.ui.layout.ResizeHandler.states.removeListenerById(this.__pageSizeListener);\n    this.__pageSizeListener = null;\n    this.__button = null;\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    controls: {\n      check: 'String'\n    },\n    baseColors: {\n      check: 'Object'\n    },\n    sendOnFinish: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __mode: '',\n    __colorOld: undefined,      // the color where the animation started\n    __colorCurrent: undefined,  // the current color of the running animation\n    __color: undefined,         // the current color of the widget, also the target for the animation\n    __lastBusValue: undefined,  // initialize with empty object in the constructor to prevent object being shared between instances\n    __animator: null,\n    __button: undefined, // cache for DOM element\n    __range: undefined,  // cache for DOM element\n    __actors: undefined,\n    __pageSizeListener: undefined,\n    __components: undefined, // set of all color components required to send\n    __inDrag: false,       // is the handle currently dragged?\n    __coordMin: undefined, // minimal screen coordinate of slider\n    __Tmin: 2000,   // minimal color temperature to show in slider\n    __Tmax: 12500,  // maximal color temperature to show in slider\n\n    // overridden\n    _getInnerDomString: function () {\n      const placeholder = this.getFormat() === '' ? '' : '-';\n      const self = this;\n      let retval = '';\n      const historicWidth = this.getLayout().colspan === undefined ? ' style=\"width:195px\"' : '';\n      let controls = this.getControls().split(';');\n      if (controls[0] === '') {\n        controls[0] = 'box';\n      }\n      controls.forEach(function(control) {\n        switch (control) {\n          case 'box':\n          case 'LCh-box': {\n            let hue_type = control === 'box' ? 'hsv_hue' : 'lch_hue';\n            retval += '<div class=\"actor cc_box\"><div class=\"hue ' + hue_type;\n            retval += '\"></div><div class=\"handle_hue\"></div><div class=\"sv_box\"><div class=\"inner\"></div><div class=\"handle\"></div></div></div>';\n            break;\n          }\n\n          case 'triangle':\n          case 'LCh-triangle': {\n            let hue_type = control === 'triangle' ? 'hsv_hue' : 'lch_hue';\n            retval += '<div class=\"actor cc_wheel\"><div class=\"hue ' + hue_type;\n            retval += '\"></div><div class=\"sv_triangle\"><div class=\"inner\"></div><div class=\"handle_hue\"></div><div class=\"handle\"></div></div></div>';\n            break;\n          }\n\n          case 'RGB-r':\n          case 'RGB-g':\n          case 'RGB-b':\n          case 'RGBW-r':\n          case 'RGBW-g':\n          case 'RGBW-b':\n          case 'RGBW-w':\n          case 'h':\n          case 's':\n          case 'v':\n          case 'LCh-L':\n          case 'LCh-C':\n          case 'LCh-h':\n          case 'Y':\n            retval += '<div class=\"actor cc_' + control + ` ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n              <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">`+placeholder+`</button>\n              <div class=\"ui-slider-range\" style=\"margin-left: 0px; clip-path: inset(0 100% 0 0);\"></div>\n            </div>`;\n            break;\n\n          default: {\n            let parts = control.split(':');\n            if (parts[0] === 'T') {\n              const temperatures = (parts[1] || '-').split('-');\n              self.__Tmin = Math.max(1667, Math.min(temperatures[0] || 2500, 25000));\n              self.__Tmax = Math.max(1667, Math.min(temperatures[1] || 9000, 25000));\n              const rgbTmin = cv.util.Color.xy2sRGB(cv.util.Color.temperature2xy(self.__Tmin));\n              const rgbTmax = cv.util.Color.xy2sRGB(cv.util.Color.temperature2xy(self.__Tmax));\n              const disp = c => [Math.round(255 * c.r), Math.round(255 * c.g), Math.round(255 * c.b)].join(',');\n              const colors = 'rgb(' + disp(rgbTmin) + '), rgb(' + disp(rgbTmax) + ')';\n\n              retval += `<div class=\"actor cc_T ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n                <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">` + placeholder + `</button>\n                <div class=\"ui-slider-range\" style=\"margin-left: 0px; clip-path: inset(0 100% 0 0);background: linear-gradient(90deg, ` + colors + `);\"></div>\n              </div>`;\n            }\n          }\n        }\n      });\n      return '<div class=\"actors\"'+historicWidth+'>' + retval + '</div>';\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n\n      this.__throttled = cv.util.Function.throttle(this.__onChangeValue, 250, {trailing: true}, this);\n\n      this.getDomElement().querySelectorAll('.actor').forEach(actor => actor.addEventListener('pointerdown', this));\n    },\n\n    _update: function (address, data) {\n      const addressObj = this.getAddress()[address];\n      const showInvalidDataErrorMessage = function () {\n        const message = qx.locale.Manager.tr(\n          'Updating ColorChooser with invalid data<br/>Address: \"%1\"<br/>transform: \"%2\"<br/>selector: \"%3\"<br/>variant: \"%4\"<br/>data: \"%5\"',\n          address,\n          addressObj.transform,\n          addressObj.selector,\n          addressObj.variant,\n          data\n        );\n        if (cv.Config.testMode === true) {\n          // eslint-disable-next-line no-console\n          console.error(message.toString());\n        }\n        cv.core.notifications.Router.dispatchMessage('cv.config.error', {message});\n      };\n\n      const transform = addressObj.transform;\n      let variant = addressObj.variantInfo;\n\n      let variantType;\n      let value = cv.Transform.decode(addressObj, data);\n      let base;\n\n      switch (variant) {\n        case 'h':\n        case 's':\n        case 'v':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value /= 100;\n          variantType = 'hsv-single';\n          break;\n\n        case 'hsv':\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = { h: value.get('h')/360, s: value.get('s')/100, v: value.get('v')/100 };\n          variantType = 'hsv';\n          break;\n\n        case 'RGB-r':\n        case 'RGB-g':\n        case 'RGB-b':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          base = this.getBaseColors()[variant.split('-')[1]];\n          value = cv.util.Color.invCurve(value, base.curve, base.scale);\n          variantType = 'rgb-single';\n          break;\n\n        case 'rgb':\n          base = this.getBaseColors();\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = {\n            r: cv.util.Color.invCurve(value.get('r'), base.r.curve, base.r.scale),\n            g: cv.util.Color.invCurve(value.get('g'), base.g.curve, base.g.scale),\n            b: cv.util.Color.invCurve(value.get('b'), base.b.curve, base.b.scale)\n          };\n          variantType = 'rgb';\n          break;\n\n        case 'RGBW-r':\n        case 'RGBW-g':\n        case 'RGBW-b':\n        case 'RGBW-w':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          base = this.getBaseColors()[variant.split('-')[1]];\n          value = cv.util.Color.invCurve(value, base.curve, base.scale);\n          variantType = 'rgbw-single';\n          break;\n\n        case 'rgbw':\n          base = this.getBaseColors();\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = {\n            r: cv.util.Color.invCurve(value.get('r'), base.r.curve, base.r.scale),\n            g: cv.util.Color.invCurve(value.get('g'), base.g.curve, base.g.scale),\n            b: cv.util.Color.invCurve(value.get('b'), base.b.curve, base.b.scale),\n            w: cv.util.Color.invCurve(value.get('w'), base.w.curve, base.w.scale)\n          };\n          variantType = 'rgbw';\n          break;\n\n        case 'x':\n        case 'y':\n          variantType = 'xyY';\n          break;\n\n        case 'Y':\n          if (value instanceof Map && value.get('YValid') !== false) {\n            value = value.get('Y');\n          } else if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n\n        case 'xy':\n          if (value instanceof Map && value.get('cValid') !== false) {\n            value = { x: value.get('x'), y: value.get('y') };\n          } else if (!(typeof value === 'object' && 'x' in value && 'y' in value)) {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n\n        case 'xyY':\n          if (value instanceof Map) {\n            variant = (value.get('cValid') !== false ? 'xy' : '') + (value.get('YValid') !== false ? 'Y' : '');\n            value = {\n              x: value.get('x'),\n              y: value.get('y'),\n              Y: value.get('Y')\n            };\n            if (variant === '') {\n              return; // no valid data in the value\n            }\n          } else {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n      }\n\n      if (this.__inDrag || (this.__lastBusValue[variantType] && this.__lastBusValue[variantType][variant] && this.__lastBusValue[variantType][variant][transform] === data)) {\n        // slider in use -> ignore value from bus\n        // internal state unchanged -> also do nothing\n        return;\n      }\n      const notKnown = this.__lastBusValue[variantType] === undefined;\n      if (notKnown) {\n        this.__lastBusValue[variantType] = {};\n      }\n\n      // forget all other transforms as they might not be valid anymore\n      this.__lastBusValue = {[variantType]: this.__lastBusValue[variantType]};\n      this.__lastBusValue[variantType][variant] = {[transform]: data};\n\n      // animate when visible, otherwise jump to the target value\n      this.__setSliderTo(value, variant, !this.isVisible() || notKnown);\n    },\n\n    /**\n     * The the internal slider state and its handle and displayed value\n     * @param {number} value The new value\n     * @param {string} variant The color component to change\n     * @param {boolean} instant Animate or instant change\n     * @private\n     */\n    __setSliderTo: function(value, variant, instant) {\n      this.__colorOld = this.__colorCurrent === undefined ? this.__color.copy() : this.__colorCurrent.copy();\n      this.__color.changeComponent(variant, value);\n      instant = instant || this.__color.delta(this.__colorOld) < 0.5;\n      if (!instant) {\n        this.__animator.setTo(this.__colorOld, true, false);\n      }\n      this.__animator.setTo(this.__color, instant);\n    },\n\n    __updateHandlePosition: function (newColor) {\n      // check cache\n      if (this.__actors === undefined) {\n        let actors = {};\n        let actorStyle;\n        this.getDomElement().querySelectorAll('.actor').forEach(function (actor) {\n          let type = actor.className.replace(/.*cc_([^ ]*).*/, '$1');\n          switch (type) {\n            case 'box':\n            case 'wheel': {\n              actorStyle = window.getComputedStyle(actor);\n              let sv_element = type === 'box' ? actor.querySelector('.sv_box') : actor.querySelector('.sv_triangle');\n              let inner = sv_element.querySelector('.inner');\n              let handle = actor.querySelector('.handle');\n              let handle_hue = actor.querySelector('.handle_hue');\n              let hue = actor.querySelector('.hue');\n              actors[type] = {\n                isLCh: hue.classList.contains('lch_hue'),\n                sv_element: sv_element,\n                inner: inner,\n                handle: handle,\n                handle_hue: handle_hue,\n                handle_hueTop: parseFloat(window.getComputedStyle(handle_hue).getPropertyValue('top')),\n                handle_hueWidth: parseFloat(window.getComputedStyle(handle_hue).getPropertyValue('width')),\n                width: parseFloat(actorStyle.getPropertyValue('width')),\n                height: parseFloat(actorStyle.getPropertyValue('padding-top')),\n                innerRadius: parseFloat(window.getComputedStyle(sv_element).getPropertyValue('width')),\n                outerRadius: parseFloat(window.getComputedStyle(hue).getPropertyValue('width'))\n              };\n              break;\n            }\n\n            default: {\n              actorStyle = window.getComputedStyle(actor);\n              let button = actor.querySelector('button');\n              let range = actor.querySelector('.ui-slider-range');\n              actors[type] = {\n                button: button,\n                range: range,\n                width: parseFloat(actorStyle.getPropertyValue('width')),\n                buttonWidth: parseFloat(window.getComputedStyle(button).getPropertyValue('width'))\n              };\n              range.style.marginLeft = '-' + actorStyle.getPropertyValue('padding-left');\n              range.style.borderRadius = actorStyle.getPropertyValue('border-radius');\n            }\n          }\n        });\n        this.__actors = actors;\n      }\n\n      this.__colorCurrent = newColor;\n      // move handles\n      for (let type in this.__actors) {\n        let actor = this.__actors[type];\n        if (type === 'wheel') {\n          const Bt = 75;\n          const St = 0;\n          const Wt = 75;\n          const Bl = 50-85/2;\n          const Sl = 50;\n          const Wl = 50+85/2;\n          let angle;\n          if (actor.isLCh) {\n            let LCh = this.__colorCurrent.getComponent('LCh');\n            let r = cv.util.Color.curve(LCh.h, [246, 255,  46,   0, 246], 1);\n            let g = cv.util.Color.curve(LCh.h, [ 27, 224, 255, 136,  27], 1);\n            let b = cv.util.Color.curve(LCh.h, [136,  32, 224, 245, 136], 1);\n            angle = (LCh.h*360)+'deg';\n            const WSt = LCh.C*St + (1-LCh.C)*Wt;\n            const WSl = LCh.C*Sl + (1-LCh.C)*Wl;\n            actor.handle.style.top  = (LCh.L*WSt + (1-LCh.L)*Bt) + '%';\n            actor.handle.style.left = (LCh.L*WSl + (1-LCh.L)*Bl) + '%';\n            actor.inner.style.background = 'linear-gradient(210deg, transparent 45%, black 90%),linear-gradient(150deg, transparent 45%, white 90%),rgb('+[r, g, b].join(',')+')';\n          } else {\n            let hsv = this.__colorCurrent.getComponent('hsv');\n            angle = (hsv.h*360)+'deg';\n            const WSt = hsv.s*St + (1-hsv.s)*Wt;\n            const WSl = hsv.s*Sl + (1-hsv.s)*Wl;\n            actor.handle.style.top  = (hsv.v*WSt + (1-hsv.v)*Bt) + '%';\n            actor.handle.style.left = (hsv.v*WSl + (1-hsv.v)*Bl) + '%';\n            actor.inner.style.background = 'linear-gradient(210deg, transparent 45%, black 90%),linear-gradient(150deg, transparent 45%, white 90%),hsl('+angle+' 100% 50%)';\n          }\n          actor.sv_element.style.transform = 'rotate('+angle+')';\n        } else if (type === 'box') {\n          let angle;\n          if (actor.isLCh) {\n            let LCh = this.__colorCurrent.getComponent('LCh');\n            let r = cv.util.Color.curve(LCh.h, [246, 255,  46,   0, 246], 1);\n            let g = cv.util.Color.curve(LCh.h, [ 27, 224, 255, 136,  27], 1);\n            let b = cv.util.Color.curve(LCh.h, [136,  32, 224, 245, 136], 1);\n            angle = (LCh.h*360)+'deg';\n            actor.handle.style.top = (1-LCh.L) * 100 + '%';\n            actor.handle.style.left = (1-LCh.C) * 100 + '%';\n            actor.inner.style.background = 'linear-gradient(0deg, black 0%, transparent 50%, white 100%), linear-gradient(90deg,rgb('+[r, g, b].join(',')+'), #808080 100%)';\n          } else {\n            let hsv = this.__colorCurrent.getComponent('hsv');\n            angle = (hsv.h*360)+'deg';\n            actor.handle.style.top = (1-hsv.v) * 100 + '%';\n            actor.handle.style.left = (1-hsv.s) * 100 + '%';\n            actor.inner.style.background = 'linear-gradient(0deg, black 0%, transparent 50%, white 100%), linear-gradient(90deg,hsl('+angle+' 100% 50%), #808080 100%)';\n          }\n          actor.handle_hue.style.transform = 'rotate('+angle+')';\n          actor.handle_hue.style.transformOrigin = actor.handle_hueWidth/2 + 'px '+(actor.width/2 - actor.handle_hueTop)+'px'; //calc(195px / 2 - 3px)';\n        } else {\n          let ratioComponent = this.__colorCurrent.getComponent(type);\n          if (type === 'T') {\n            ratioComponent = (ratioComponent - this.__Tmin)/(this.__Tmax - this.__Tmin);\n          }\n          let length = Math.max(0, Math.min(ratioComponent, 1)) * actor.width;\n          actor.button.style.transform = 'translate3d(' + (length-actor.buttonWidth/2) + 'px, 0px, 0px)';\n          actor.range.style.clipPath = 'inset(0 ' + (1-ratioComponent)*100 + '% 0 0)';\n        }\n      }\n    },\n\n    __invalidateScreensize: function () {\n      this.__actors = undefined; // invalidate cached values\n      this.__animator.setTo(this.__color, true /* tmp */);\n    },\n\n    handleEvent: function (event) {\n      let relCoordX = 0;\n      let relCoordY = 0;\n      let actor;\n\n      switch (event.type) {\n        case 'pointerdown': {\n          let actorType = event.currentTarget.className.replace(/.*cc_([^ ]*).*/, '$1');\n          actor = this.__actors[actorType];\n          let boundingRect = event.currentTarget.getBoundingClientRect();\n          let computedStyle = window.getComputedStyle(event.currentTarget);\n          this.__coordMinX = boundingRect.left + parseFloat(computedStyle.paddingLeft);\n          this.__coordMinY = boundingRect.top;\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          if (actorType === 'wheel') {\n            let radius = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            let sv = cv.ui.structure.pure.ColorChooser.coord2sv(relCoordX, relCoordY, this.__color.getComponent(actor.isLCh ? 'LCh' : 'hsv').h, radius);\n            let distSqrd = (relCoordX - 0.5)**2 + (relCoordY - 0.5)**2;\n            if (distSqrd < (0.5*1.07)**2) { // ignore clicks outside of the wheel, with 7% safety margin on the outside\n              const clearlyOnWheel = (radius * 1.10)**2 < distSqrd; // with 10% safety margin to the interior triangle\n              const closeToInerior = radius**2 < distSqrd && !clearlyOnWheel;\n              const closeToTriangleCorners = (sv[1] < 0.01) || (sv[0] < 0.01 && sv[1] > 0.99) || (sv[0] > 0.99 && sv[1] > 0.99);\n              if (clearlyOnWheel || (closeToInerior && !closeToTriangleCorners)) {\n                this.__mode = 'wheel_h';\n                this.__color.changeComponent(actor.isLCh ? 'LCh-h' : 'h', 0.5 + Math.atan2(-relCoordX + 0.5, relCoordY - 0.5) / 2 / Math.PI);\n                this.__inDrag = true;\n              } else {\n                this.__mode = 'wheel_sv';\n                this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', sv);\n                this.__inDrag = true;\n              }\n            }\n          } else if (actorType === 'box') {\n            let boxSize = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            let x = relCoordX - 0.5;\n            let y = relCoordY - 0.5;\n            let sv = [-x / boxSize / 2 + 0.5, -y / boxSize / 2 + 0.5];\n            if ((Math.abs(x) < boxSize) && (Math.abs(y) < boxSize)) {\n              this.__mode = 'box_sv';\n              this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', sv);\n              this.__inDrag = true;\n            } else {\n              this.__mode = 'box_h';\n              this.__color.changeComponent(actor.isLCh ? 'LCh-h' : 'h', 0.5 + Math.atan2(-x, y) / 2 / Math.PI);\n              this.__inDrag = true;\n            }\n          } else {\n            let ratio = relCoordX;\n            if (actorType === 'T') {\n              ratio = this.__Tmin + ratio * (this.__Tmax - this.__Tmin);\n            }\n            this.__mode = actorType;\n            this.__color.changeComponent(actorType, ratio);\n            this.__inDrag = true;\n          }\n          if (this.__inDrag) {\n            document.addEventListener('pointermove', this);\n            document.addEventListener('pointerup', this);\n          } else {\n            this.__mode = undefined;\n          }\n          break;\n        }\n\n        case 'pointermove': {\n          if (!this.__inDrag) {\n            return;\n          }\n          if (event.buttons === 0) { // move with no button could only happen during debug sessions\n            this.__inDrag = false;\n            document.removeEventListener('pointermove', this);\n            document.removeEventListener('pointerup', this);\n          }\n          let type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n          actor = this.__actors[type];\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          break;\n        }\n\n        case 'pointerup': {\n          this.__inDrag = false;\n          document.removeEventListener('pointermove', this);\n          document.removeEventListener('pointerup', this);\n          const type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n          actor = this.__actors[type];\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          break;\n        }\n      }\n\n      if (event.type !== 'pointerdown') {\n        let type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n        let actor = this.__actors[type];\n        switch (this.__mode) {\n          case 'wheel_sv': {\n            const radius = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            const sv = cv.ui.structure.pure.ColorChooser.coord2sv(relCoordX, relCoordY, this.__color.getComponent(actor.isLCh ? 'LCh' : 'hsv').h, radius);\n            this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', [Math.min(Math.max(sv[0], 0), 1), Math.min(Math.max(sv[1], 0), 1)]);\n            break;\n          }\n          case 'box_sv': {\n            const boxSize = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            const x = relCoordX - 0.5;\n            const y = relCoordY - 0.5;\n            const sv = [-x / boxSize / 2 + 0.5, -y / boxSize / 2 + 0.5];\n            this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', [Math.min(Math.max(sv[0], 0), 1), Math.min(Math.max(sv[1], 0), 1)]);\n            break;\n          }\n          case 'wheel_h':\n          case 'box_h':\n            this.__color.changeComponent(actor.isLCh?'LCh-h':'h', 0.5 + Math.atan2(-relCoordX + 0.5, relCoordY - 0.5) / 2 / Math.PI);\n            break;\n          case 'T':\n            this.__color.changeComponent('T', this.__Tmin + Math.max(0, Math.min(relCoordX, 1)) * (this.__Tmax - this.__Tmin));\n            break;\n          default:\n            this.__color.changeComponent(this.__mode, relCoordX);\n        }\n      }\n      this.__animator.setTo(this.__color, true);\n      if (!this.getSendOnFinish() || event.type === 'pointerup') {\n        this.__throttled.call();\n      }\n    },\n\n    __onChangeValue: function() {\n      this.__components.forEach(type => {\n        let value = this.__color.getComponent(['xyY', 'x', 'y'].includes(type) ? 'xy' : type);\n        let typeCategory;\n        let base;\n\n        switch (type) {\n          case 'h':\n            value *= 360;\n            typeCategory = 'hsv-single';\n            break;\n\n          case 's':\n          case 'v':\n            value *= 100;\n            typeCategory = 'hsv-single';\n            break;\n\n          case 'hsv':\n            value = new Map([['h', value.h*360], ['s', value.s*100], ['v', value.v*100]]);\n            typeCategory = 'hsv';\n            break;\n\n          case 'RGB-r':\n          case 'RGB-g':\n          case 'RGB-b':\n            base = this.getBaseColors()[type.split('-')[1]];\n            value = cv.util.Color.curve(value, base.curve, base.scale);\n            typeCategory = 'rgb-single';\n            break;\n\n          case 'RGBW-r':\n          case 'RGBW-g':\n          case 'RGBW-b':\n          case 'RGBW-w':\n            base = this.getBaseColors()[type.split('-')[1]];\n            value = cv.util.Color.curve(value, base.curve, base.scale);\n            typeCategory = 'rgbw-single';\n            break;\n\n          case 'rgb':\n            base = this.getBaseColors();\n            value = new Map([\n              ['r', cv.util.Color.curve(value.r, base.r.curve, base.r.scale)],\n              ['g', cv.util.Color.curve(value.g, base.g.curve, base.g.scale)],\n              ['b', cv.util.Color.curve(value.b, base.b.curve, base.b.scale)]\n            ]);\n            typeCategory = 'rgb';\n            break;\n\n          case 'rgbw':\n            base = this.getBaseColors();\n            value = new Map([\n              ['r', cv.util.Color.curve(value.r, base.r.curve, base.r.scale)],\n              ['g', cv.util.Color.curve(value.g, base.g.curve, base.g.scale)],\n              ['b', cv.util.Color.curve(value.b, base.b.curve, base.b.scale)],\n              ['w', cv.util.Color.curve(value.w, base.w.curve, base.w.scale)]\n            ]);\n            typeCategory = 'rgbw';\n            break;\n\n          case 'xy':\n            value = new Map([\n              ['x', value.x],\n              ['y', value.y]\n            ]);\n            typeCategory = 'xyY';\n            break;\n\n          case 'xyY': {\n            let Y = this.__color.getComponent('Y');\n            value = new Map([\n              ['x', value.x],\n              ['y', value.y],\n              ['Y', Y]\n            ]);\n            typeCategory = 'xyY';\n            break;\n          }\n\n          case 'Y':\n            typeCategory = 'xyY';\n            break;\n\n          case 'x':\n          case 'y':\n            value = value[type];\n            typeCategory = 'xyY';\n            break;\n        }\n        if (this.__lastBusValue[typeCategory] === undefined) {\n          this.__lastBusValue[typeCategory] = {};\n        }\n        this.__lastBusValue[typeCategory][type] = this.sendToBackend(value, t => t.variantInfo===type, this.__lastBusValue[typeCategory][type]);\n      });\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('colorchooser', statics);\n  }\n});\n"
  ]
}