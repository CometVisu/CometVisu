{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "implement",
    "cv",
    "ui",
    "structure",
    "IController",
    "construct",
    "__HTML_STRUCT",
    "__supportedFeatures",
    "cache",
    "bom",
    "Stylesheet",
    "includeFile",
    "util",
    "ResourceManager",
    "getInstance",
    "toUri",
    "Config",
    "forceReload",
    "Date",
    "now",
    "properties",
    "currentPage",
    "check",
    "nullable",
    "event",
    "renderTarget",
    "init",
    "namespace",
    "members",
    "main_scroll",
    "old_scroll",
    "pagePartsHandler",
    "getHtmlStructure",
    "parseBackendSettings",
    "xml",
    "settings",
    "configSettings",
    "pagesElement",
    "documentElement",
    "defaultBackendName",
    "getAttribute",
    "backend",
    "URL",
    "server",
    "split",
    "backendUrl",
    "error",
    "backendKnxdUrl",
    "backendMQTTUrl",
    "backendOpenHABUrl",
    "credentials",
    "token",
    "username",
    "password",
    "data",
    "Model",
    "setDefaultBackendName",
    "login",
    "clients",
    "io",
    "BackendConnections",
    "getClients",
    "client",
    "name",
    "debug",
    "startInitialRequest",
    "parseSettings",
    "done",
    "screensave_time",
    "parseInt",
    "screensave_page",
    "maxMobileScreenWidth",
    "globalClass",
    "document",
    "querySelector",
    "classList",
    "add",
    "scrollSpeed",
    "bindClickToWidget",
    "defaultColumns",
    "minColumnWidth",
    "preParse",
    "metaParser",
    "parser",
    "pure",
    "MetaParser",
    "pluginsToLoad",
    "concat",
    "parsePlugins",
    "parse",
    "createUI",
    "cacheUsed",
    "page",
    "_createPages",
    "message",
    "Bus",
    "dispatchByName",
    "TemplateEngine",
    "setDomFinished",
    "initLayout",
    "path",
    "flavour",
    "WidgetParser",
    "renderTemplates",
    "parsedData",
    "Array",
    "isArray",
    "i",
    "l",
    "length",
    "widget",
    "WidgetFactory",
    "createInstance",
    "$$type",
    "getDomString",
    "parseLabel",
    "label",
    "labelClass",
    "style",
    "ret_val",
    "undefined",
    "prototype",
    "forEach",
    "call",
    "childNodes",
    "elem",
    "nodeType",
    "Node",
    "ELEMENT_NODE",
    "nodeName",
    "toLowerCase",
    "IconHandler",
    "getIconElement",
    "TEXT_NODE",
    "textContent",
    "supports",
    "feature",
    "subfeature",
    "hasOwnProperty",
    "getInitialAddresses",
    "backendName",
    "startPageAddresses",
    "pageWidget",
    "getInstanceById",
    "initialPage",
    "getChildWidgets",
    "child",
    "address",
    "getAddress",
    "addr",
    "backendType",
    "keys",
    "initPagePartsHandler",
    "navigation",
    "PagePartsHandler",
    "__detectInitialPage",
    "setCurrentPage",
    "layout",
    "Manager",
    "adjustColumns",
    "applyColumnWidths",
    "PageHandler",
    "setSpeed",
    "DeferredCall",
    "scrollToPage",
    "schedule",
    "querySelectorAll",
    "_runTrickOMatic",
    "IconTools",
    "fillRecoloredIcon",
    "remove",
    "Init",
    "getApplication",
    "addListener",
    "_onMobileChanged",
    "retries",
    "getSVGDocument",
    "svg",
    "readyState",
    "onload",
    "TrickOMatic",
    "run",
    "e",
    "window",
    "requestAnimationFrame",
    "doScreenSave",
    "onHistoryRequest",
    "anchor",
    "target",
    "speed",
    "skipHistory",
    "page_id",
    "getPageIdByPath",
    "currentPageId",
    "treePath",
    "rememberLastPage",
    "Environment",
    "get",
    "localStorage",
    "lastpage",
    "headline",
    "pageTitle",
    "History",
    "addToHistory",
    "seekTo",
    "initializeNavbars",
    "_maintainNavbars",
    "ev",
    "app",
    "isReady",
    "ResizeHandler",
    "invalidateNavbar",
    "getMobile",
    "navbars",
    "left",
    "dynamic",
    "fadeNavbar",
    "resetPageValues",
    "resetCurrentPage",
    "currentPageUnavailableWidth",
    "currentPageUnavailableHeight",
    "currentPageNavbarVisibility",
    "getInitialPageId",
    "startpage",
    "getItem",
    "substr",
    "removeItem",
    "req",
    "Uri",
    "parseUri",
    "location",
    "href",
    "substring",
    "match",
    "Promise",
    "resolve",
    "subscribe",
    "page_name",
    "scope",
    "traversePath",
    "getPageIdByName",
    "root_page_id",
    "path_scope",
    "index",
    "indexOf",
    "next",
    "path_page_name",
    "String",
    "decodeHtmlEntities",
    "decodeURI",
    "replace",
    "selector",
    "pages",
    "from",
    "filter",
    "h",
    "getCurrentPage",
    "getPath",
    "fallback",
    "some",
    "p",
    "Tree",
    "getClosest",
    "innerText",
    "pid",
    "destruct",
    "removeListener",
    "defer",
    "statics",
    "Application",
    "structureController",
    "Controller"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Controller.js"
  ],
  "sourcesContent": [
    "/* Controller.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\nqx.Class.define('cv.ui.structure.pure.Controller', {\n  extend: qx.core.Object,\n  type: 'singleton',\n  implement: cv.ui.structure.IController,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    super();\n    this.__HTML_STRUCT =\n      '<div id=\"top\" class=\"loading\"><div class=\"nav_path\">-</div></div><div id=\"navbarTop\" class=\"loading\"></div><div id=\"centerContainer\" class=\"clearfix\"><div id=\"navbarLeft\" class=\"loading page\"></div><div id=\"main\" style=\"position:relative; overflow: hidden;\" class=\"loading\"><div id=\"pages\" style=\"position:relative;clear:both;\"><!-- all pages will be inserted here --></div></div><div id=\"navbarRight\" class=\"loading page\"></div></div><div id=\"navbarBottom\" class=\"loading\"></div><div id=\"bottom\" class=\"loading\"><hr /><div class=\"footer\"></div></div>';\n    this.__supportedFeatures = {\n      cache: true\n    };\n\n    // load basic CSS rules shared by all designs that support this structure\n    qx.bom.Stylesheet.includeFile(\n      qx.util.ResourceManager.getInstance().toUri('designs/designglobals.css') +\n        (cv.Config.forceReload === true ? '?' + Date.now() : '')\n    );\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    currentPage: {\n      check: 'cv.ui.structure.pure.Page',\n      nullable: true,\n      event: 'changeCurrentPage'\n    },\n\n    renderTarget: {\n      check: 'String',\n      init: '#pages'\n    },\n\n    /**\n     * Namespace for path ids\n     */\n    namespace: {\n      check: 'String',\n      init: ''\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __supportedFeatures: null,\n    __HTML_STRUCT: null,\n    main_scroll: null,\n    old_scroll: '',\n    pagePartsHandler: null,\n\n    getHtmlStructure() {\n      return this.__HTML_STRUCT;\n    },\n\n    parseBackendSettings(xml) {\n      const settings = cv.Config.configSettings;\n      const pagesElement = xml.documentElement;\n      let defaultBackendName = '';\n      if (pagesElement.getAttribute('backend') !== null) {\n        settings.backend = pagesElement.getAttribute('backend');\n        defaultBackendName = settings.backend;\n      } else {\n        defaultBackendName = (\n          cv.Config.URL.backend ||\n          cv.Config.server.backend ||\n          'knxd'\n        ).split(',')[0];\n      }\n      if (pagesElement.getAttribute('backend-url') !== null) {\n        settings.backendUrl = pagesElement.getAttribute('backend-url');\n        this.error(\n          'The useage of \"backend-url\" is deprecated. Please use \"backend-knxd-url\", \"backend-mqtt-url\" or \"backend-openhab-url\" instead.'\n        );\n      }\n\n      if (pagesElement.getAttribute('backend-knxd-url') !== null) {\n        settings.backendKnxdUrl = pagesElement.getAttribute('backend-knxd-url');\n        if (!defaultBackendName) {\n          defaultBackendName = 'knxd';\n        }\n      }\n      if (pagesElement.getAttribute('backend-mqtt-url') !== null) {\n        settings.backendMQTTUrl = pagesElement.getAttribute('backend-mqtt-url');\n        if (!defaultBackendName) {\n          defaultBackendName = 'mqtt';\n        }\n      }\n      if (pagesElement.getAttribute('backend-openhab-url') !== null) {\n        settings.backendOpenHABUrl = pagesElement.getAttribute('backend-openhab-url');\n        if (!defaultBackendName) {\n          defaultBackendName = 'openhab';\n        }\n      }\n      if (pagesElement.getAttribute('token') !== null) {\n        settings.credentials.token = pagesElement.getAttribute('token');\n      }\n      if (pagesElement.getAttribute('username') !== null) {\n        settings.credentials.username = pagesElement.getAttribute('username');\n      }\n      if (pagesElement.getAttribute('password') !== null) {\n        settings.credentials.password = pagesElement.getAttribute('password');\n      }\n\n      // make sure that the default name is the actual type\n      if (defaultBackendName === 'default') {\n        defaultBackendName = 'knxd';\n      }\n      if (defaultBackendName) {\n        cv.data.Model.getInstance().setDefaultBackendName(defaultBackendName);\n      }\n      return true;\n    },\n\n    login() {\n      const clients = cv.io.BackendConnections.getClients();\n      let client;\n      for (const name in clients) {\n        client = clients[name];\n        client.login(true, cv.Config.configSettings.credentials, () => {\n          this.debug(name + ' logged in');\n          cv.io.BackendConnections.startInitialRequest(name);\n        });\n      }\n    },\n\n    parseSettings(xml, done) {\n      const settings = cv.Config.configSettings;\n      const pagesElement = xml.documentElement;\n      settings.screensave_time = pagesElement.getAttribute('screensave_time');\n      if (settings.screensave_time) {\n        settings.screensave_time = parseInt(settings.screensave_time, 10);\n      }\n      settings.screensave_page = pagesElement.getAttribute('screensave_page');\n\n      if (pagesElement.getAttribute('max_mobile_screen_width') !== null) {\n        settings.maxMobileScreenWidth = pagesElement.getAttribute('max_mobile_screen_width');\n\n        // override config setting\n        cv.Config.maxMobileScreenWidth = settings.maxMobileScreenWidth;\n      }\n\n      const globalClass = pagesElement.getAttribute('class');\n      if (globalClass !== null) {\n        document.querySelector('body').classList.add(globalClass);\n      }\n      if (pagesElement.getAttribute('scroll_speed') === null) {\n        settings.scrollSpeed = 400;\n      } else {\n        settings.scrollSpeed = parseInt(pagesElement.getAttribute('scroll_speed'));\n      }\n      settings.bindClickToWidget = pagesElement.getAttribute('bind_click_to_widget') === 'true';\n      if (pagesElement.getAttribute('default_columns') !== null) {\n        settings.defaultColumns = pagesElement.getAttribute('default_columns');\n      }\n      if (pagesElement.getAttribute('min_column_width') !== null) {\n        settings.minColumnWidth = pagesElement.getAttribute('min_column_width');\n      }\n    },\n\n    async preParse(xml) {\n      const settings = cv.Config.configSettings;\n      const metaParser = new cv.parser.pure.MetaParser();\n\n      // start with the plugins\n      settings.pluginsToLoad = settings.pluginsToLoad.concat(metaParser.parsePlugins(xml));\n\n      // and then the rest\n      await metaParser.parse(xml);\n      this.debug('pre parsing done');\n    },\n\n    /**\n     * Generate the UI code from the config file\n     * @param xml {XMLDocument} loaded config file\n     */\n    createUI(xml) {\n      if (!cv.Config.cacheUsed) {\n        this.debug('creating pages');\n        const page = xml.querySelector('pages > page'); // only one page element allowed...\n\n        this._createPages(page, 'id');\n        this.debug('finalizing');\n        qx.event.message.Bus.dispatchByName('setup.dom.append');\n        this.debug('pages created');\n      }\n      this.debug('setup.dom.finished');\n      qx.event.message.Bus.dispatchByName('setup.dom.finished.before');\n      cv.TemplateEngine.getInstance().setDomFinished(true);\n\n      this.login();\n\n      this.initLayout();\n    },\n\n    /**\n     * Start the parsing process\n     * @param page {Element} XML-configuration element\n     * @param path {String} internal poth\n     * @param flavour {String} inherited flavour\n     * @param type {String} page type (text, 2d, 3d)\n     */\n    _createPages(page, path, flavour, type) {\n      cv.parser.pure.WidgetParser.renderTemplates(page);\n      let parsedData = cv.parser.pure.WidgetParser.parse(page, path, flavour, type);\n\n      if (!Array.isArray(parsedData)) {\n        parsedData = [parsedData];\n      }\n      let i = 0;\n      const l = parsedData.length;\n      for (; i < l; i++) {\n        const data = parsedData[i];\n        const widget = cv.ui.structure.WidgetFactory.createInstance(data.$$type, data);\n\n        // trigger DOM generation\n        if (widget) {\n          widget.getDomString();\n        }\n      }\n    },\n\n    /**\n     * Parse a label from the config file\n     * @param label {Element} label xml element\n     * @param flavour {String?} flavour name\n     * @param labelClass {String?} CSS class name\n     * @param style {String?} additional CSS style properties\n     */\n    parseLabel(label, flavour, labelClass, style) {\n      if (!label) {\n        return '';\n      }\n      let ret_val =\n        '<div class=\"' +\n        (labelClass !== undefined ? labelClass : 'label') +\n        '\"' +\n        (style ? ' style=\"' + style + '\"' : '') +\n        '>';\n\n      Array.prototype.forEach.call(label.childNodes, function (elem) {\n        if (elem.nodeType === Node.ELEMENT_NODE && elem.nodeName.toLowerCase() === 'icon') {\n          ret_val += cv.IconHandler.getInstance().getIconElement(\n            elem.getAttribute('name'),\n            elem.getAttribute('type'),\n            elem.getAttribute('flavour') || flavour,\n            elem.getAttribute('color'),\n            elem.getAttribute('styling'),\n            '',\n            true\n          );\n        } else if (elem.nodeType === Node.TEXT_NODE) {\n          ret_val += elem.textContent;\n        }\n      });\n      return ret_val + '</div>';\n    },\n    supports(feature, subfeature) {\n      if (Object.prototype.hasOwnProperty.call(this.__supportedFeatures, feature)) {\n        if (this.__supportedFeatures[feature] === true) {\n          if (subfeature) {\n            return (\n              Object.prototype.hasOwnProperty.call(this.__supportedFeatures[feature], subfeature) &&\n              this.__supportedFeatures[feature][subfeature] === true\n            );\n          }\n          return true;\n        }\n      }\n      return false;\n    },\n\n    getInitialAddresses(backendName) {\n      const startPageAddresses = {};\n      const pageWidget = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n\n      pageWidget.getChildWidgets().forEach(function (child) {\n        const address = child.getAddress ? child.getAddress() : {};\n        for (let addr in address) {\n          if (Object.prototype.hasOwnProperty.call(address, addr) && addr.backendType === backendName) {\n            startPageAddresses[addr] = 1;\n          }\n        }\n      }, this);\n      return Object.keys(startPageAddresses);\n    },\n\n    initPagePartsHandler() {\n      if (!this.pagePartsHandler) {\n        this.pagePartsHandler = new cv.ui.structure.pure.navigation.PagePartsHandler();\n      }\n    },\n\n    initLayout() {\n      this.initPagePartsHandler();\n      if (!cv.Config.initialPage) {\n        this.__detectInitialPage();\n      }\n      let currentPage = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n\n      if (currentPage) {\n        this.setCurrentPage(currentPage);\n      } else {\n        // this page does not exist, fallback to start page\n        cv.Config.initialPage = 'id_';\n        currentPage = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n      }\n\n      cv.ui.structure.pure.layout.Manager.adjustColumns();\n      cv.ui.structure.pure.layout.Manager.applyColumnWidths('#' + cv.Config.initialPage, true);\n\n      this.main_scroll = new cv.ui.structure.pure.navigation.PageHandler();\n      if (this.scrollSpeed !== undefined) {\n        this.main_scroll.setSpeed(this.scrollSpeed);\n      }\n\n      new qx.util.DeferredCall(function () {\n        this.scrollToPage(cv.Config.initialPage, 0);\n      }, this).schedule();\n\n      // run the Trick-O-Matic scripts for great SVG backdrops\n      document.querySelectorAll('embed').forEach(function (elem) {\n        this._runTrickOMatic(elem, 0);\n      }, this);\n\n      document.querySelectorAll('.icon').forEach(cv.util.IconTools.fillRecoloredIcon, cv.util.IconTools);\n      document.querySelectorAll('.loading').forEach(function (elem) {\n        elem.classList.remove('loading');\n      }, this);\n\n      qx.core.Init.getApplication().addListener('changeMobile', this._onMobileChanged, this);\n    },\n\n    _runTrickOMatic(elem, retries) {\n      if (elem && typeof elem.getSVGDocument === 'function') {\n        try {\n          const svg = elem.getSVGDocument();\n          if (svg === null || svg.readyState !== 'complete') {\n            elem.onload = cv.ui.TrickOMatic.run;\n          } else {\n            cv.ui.TrickOMatic.run.call(elem);\n          }\n        } catch (e) {\n          if (e.name === 'NotSupportedError') {\n            if (retries <= 5) {\n              retries++;\n              window.requestAnimationFrame(() => {\n                this._runTrickOMatic(elem, retries);\n              });\n            } else {\n              this.error(e);\n            }\n          } else {\n            this.error(e);\n          }\n        }\n      }\n    },\n\n    doScreenSave() {\n      this.scrollToPage();\n    },\n\n    onHistoryRequest(anchor) {\n      if (anchor) {\n        this.scrollToPage(anchor, 0, true);\n      }\n    },\n\n    scrollToPage(target, speed, skipHistory) {\n      if (undefined === target) {\n        target = cv.Config.configSettings.screensave_page;\n      }\n      const page_id = this.getPageIdByPath(target);\n      if (page_id === null) {\n        return;\n      }\n      if (cv.Config.currentPageId === page_id) {\n        return;\n      }\n      cv.Config.currentPageId = page_id;\n      cv.Config.treePath = page_id;\n\n      if (undefined === speed) {\n        speed = cv.Config.configSettings.scrollSpeed;\n      }\n\n      if (cv.Config.rememberLastPage && qx.core.Environment.get('html.storage.local')) {\n        localStorage.lastpage = page_id;\n      }\n\n      // push new state to history\n      if (skipHistory === undefined) {\n        const headline = document.querySelectorAll('#' + page_id + ' h1');\n        let pageTitle = 'CometVisu';\n        if (headline.length) {\n          pageTitle = headline[0].textContent + ' - ' + pageTitle;\n        }\n        qx.bom.History.getInstance().addToHistory(page_id, pageTitle);\n      }\n\n      this.main_scroll.seekTo(page_id, speed); // scroll to it\n\n      this.pagePartsHandler.initializeNavbars(page_id);\n      this._maintainNavbars();\n    },\n\n    _onMobileChanged(ev) {\n      const app = qx.core.Init.getApplication();\n      if (app.isReady()) {\n        cv.ui.structure.pure.layout.ResizeHandler.invalidateNavbar();\n        this._maintainNavbars();\n      }\n    },\n\n    _maintainNavbars() {\n      if (qx.core.Init.getApplication().getMobile()) {\n        switch (this.pagePartsHandler.navbars.left.dynamic) {\n          case null:\n          case true:\n            this.pagePartsHandler.fadeNavbar('Left', 'out', 0);\n            break;\n\n          case false:\n            this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n        }\n      } else {\n        this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n      }\n    },\n\n    /**\n     * Reset some values related to the current page\n     */\n    resetPageValues() {\n      this.resetCurrentPage();\n      cv.ui.structure.pure.layout.Manager.currentPageUnavailableWidth = -1;\n      cv.ui.structure.pure.layout.Manager.currentPageUnavailableHeight = -1;\n      cv.ui.structure.pure.layout.Manager.currentPageNavbarVisibility = null;\n    },\n\n    async getInitialPageId() {\n      if (!cv.Config.initialPage) {\n        await this.__detectInitialPage();\n      }\n      return cv.Config.initialPage;\n    },\n\n    async __detectInitialPage() {\n      let startpage = 'id_';\n      if (cv.Config.startpage) {\n        startpage = cv.Config.startpage;\n        if (qx.core.Environment.get('html.storage.local') === true) {\n          if (startpage === 'remember') {\n            startpage = localStorage.getItem('lastpage');\n            cv.Config.rememberLastPage = true;\n            if (typeof startpage !== 'string' || startpage.substr(0, 3) !== 'id_') {\n              startpage = 'id_'; // fix obvious wrong data\n            }\n          } else if (startpage === 'noremember') {\n            localStorage.removeItem('lastpage');\n            startpage = 'id_';\n            cv.Config.rememberLastPage = false;\n          }\n        }\n      } else {\n        const req = qx.util.Uri.parseUri(window.location.href);\n        if (req.anchor && req.anchor.substring(0, 3) === 'id_') {\n          startpage = req.anchor;\n        }\n      }\n      if (startpage.match(/^id_[0-9_]*$/) !== null) {\n        cv.Config.initialPage = startpage;\n        return startpage;\n      }\n      // wait for DOM to be ready and detect the page id then\n      return new Promise(resolve => {\n        qx.event.message.Bus.subscribe('setup.dom.finished.before', () => {\n          cv.Config.initialPage = this.getPageIdByPath(startpage) || 'id_';\n          resolve(cv.Config.initialPage);\n        });\n      });\n    },\n\n    /**\n     * Returns the id of the page the given path is associated to\n     * @param page_name {String}\n     * @param path {String}\n     * @return {String}\n     */\n    getPageIdByPath(page_name, path) {\n      if (page_name === null) {\n        return null;\n      }\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      }\n      if (path !== undefined) {\n        const scope = this.traversePath(path);\n        if (scope === null) {\n          // path is wrong\n          this.error('path \\'' + path + '\\' could not be traversed, no page found');\n\n          return null;\n        }\n        return this.getPageIdByName(page_name, scope);\n      }\n      return this.getPageIdByName(page_name);\n    },\n\n    traversePath(path, root_page_id) {\n      let path_scope = null;\n      let index = path.indexOf('/');\n      if (index >= 1) {\n        // skip escaped slashes like \\/\n        while (path.substr(index - 1, 1) === '\\\\') {\n          const next = path.indexOf('/', index + 1);\n          if (next >= 0) {\n            index = next;\n          }\n        }\n      }\n      //    console.log(\"traversePath(\"+path+\",\"+root_page_id+\")\");\n      if (index >= 0) {\n        // traverse path one level down\n        const path_page_name = path.substr(0, index);\n        path_scope = this.getPageIdByName(path_page_name, root_page_id);\n        path = path.substr(path_page_name.length + 1);\n        path_scope = this.traversePath(path, path_scope);\n        //      console.log(path_page_name+\"=>\"+path_scope);\n        return path_scope;\n      }\n      // bottom path level reached\n      path_scope = this.getPageIdByName(path, root_page_id);\n      return path_scope;\n    },\n\n    getPageIdByName(page_name, scope) {\n      let page_id = null;\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      }\n      // find Page-ID by name\n      // decode html code (e.g. like &apos; => ')\n      page_name = cv.util.String.decodeHtmlEntities(page_name);\n      // remove escaped slashes\n      page_name = decodeURI(page_name.replace('\\\\/', '/'));\n\n      //      console.log(\"Page: \"+page_name+\", Scope: \"+scope);\n      const selector = scope !== undefined && scope !== null ? '.page[id^=\"' + scope + '\"] h1' : '.page h1';\n      let pages = document.querySelectorAll(selector);\n      pages = Array.from(pages).filter(function (h) {\n        return h.textContent === page_name;\n      });\n      if (pages.length > 1 && this.getCurrentPage() !== null) {\n        const currentPageId = this.getCurrentPage().getPath();\n        // More than one Page found -> search in the current pages descendants first\n        let fallback = true;\n        pages.some(function (page) {\n          const p = cv.util.Tree.getClosest(page, '.page');\n          if (page.innerText === page_name) {\n            const pid = p.getAttribute('id');\n            if (pid.length < currentPageId.length) {\n              // found pages path is shorter the the current pages -> must be an ancestor\n              if (currentPageId.indexOf(pid) === 0) {\n                // found page is an ancestor of the current page -> we take this one\n                page_id = pid;\n                fallback = false;\n                //break loop\n                return true;\n              }\n            } else if (pid.indexOf(currentPageId) === 0) {\n              // found page is an descendant of the current page -> we take this one\n              page_id = pid;\n              fallback = false;\n              //break loop\n              return true;\n            }\n          }\n          return false;\n        }, this);\n        if (fallback) {\n          // take the first page that fits (old behaviour)\n          pages.some(function (page) {\n            if (page.innerText === page_name) {\n              page_id = cv.util.Tree.getClosest(page, '.page').getAttribute('id');\n\n              // break loop\n              return true;\n            }\n            return false;\n          });\n        }\n      } else {\n        pages.some(function (page) {\n          if (page.innerText === page_name) {\n            page_id = cv.util.Tree.getClosest(page, '.page').getAttribute('id');\n            // break loop\n            return true;\n          }\n          return false;\n        });\n      }\n\n      if (page_id !== null && page_id.match(/^id_[0-9_]*$/) !== null) {\n        return page_id;\n      }\n      // not found\n      return null;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    qx.core.Init.getApplication().removeListener('changeMobile', this._onMobileChanged, this);\n  },\n\n  defer(statics) {\n    cv.Application.structureController = statics.getInstance();\n  }\n});\n"
  ],
  "mappings": "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"
}