{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "pure",
    "AbstractWidget",
    "include",
    "common",
    "HasChildren",
    "HasAnimatedButton",
    "construct",
    "props",
    "name",
    "bindClickToWidget",
    "properties",
    "target",
    "check",
    "init",
    "activeScope",
    "nullable",
    "targetPath",
    "statics",
    "_onScrollToPage",
    "ev",
    "page_id",
    "getData",
    "page",
    "WidgetFactory",
    "getInstanceById",
    "model",
    "data",
    "Model",
    "getInstance",
    "getName",
    "document",
    "querySelectorAll",
    "forEach",
    "elem",
    "classList",
    "remove",
    "getWidgetDataByElement",
    "add",
    "parentPage",
    "util",
    "Tree",
    "getParentWidget",
    "pageJumps",
    "markPageJumps",
    "parentName",
    "path",
    "match",
    "members",
    "_getInnerDomString",
    "actor",
    "getAlign",
    "getChildrenDomString",
    "action",
    "getTarget",
    "getTargetPath",
    "Application",
    "structureController",
    "getPageIdByPath",
    "scrollToPage",
    "defer",
    "registerClass",
    "event",
    "message",
    "Bus",
    "subscribe",
    "PageJump"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/PageJump.js"
  ],
  "sourcesContent": [
    "/* PageJump.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * The pagejump widget can be used to link the visu pages.\n * The function is similar to hyperlinks.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.PageJump', {\n  extend: cv.ui.structure.pure.AbstractWidget,\n  include: [cv.ui.common.HasChildren, cv.ui.common.HasAnimatedButton],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(props) {\n    if (!props.name) {\n      // when there is no name the widget has no actor as clickable subelement, so we need\n      // to bind the click events to the whole widget\n      props.bindClickToWidget = true;\n    }\n    super(props);\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    target: {\n      check: 'String',\n      init: '0'\n    },\n\n    activeScope: {\n      check: ['target', 'path'],\n      init: 'target'\n    },\n\n    name: {\n      check: 'String',\n      nullable: true\n    },\n\n    targetPath: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Handle page change events and update the active state of this PageJump\n     *\n     * @param ev {Event}\n     * @protected\n     */\n    _onScrollToPage(ev) {\n      const page_id = ev.getData();\n      const page = cv.ui.structure.WidgetFactory.getInstanceById(page_id);\n      const model = cv.data.Model.getInstance();\n      const name = page.getName();\n\n      // remove old active classes\n      document.querySelectorAll('.pagejump.active').forEach(function (elem) {\n        elem.classList.remove('active');\n      }, this);\n      document.querySelectorAll('.pagejump.active_ancestor').forEach(function (elem) {\n        elem.classList.remove('active_ancestor');\n      }, this);\n\n      // and set the new active ones\n      document.querySelectorAll('.pagejump').forEach(function (elem) {\n        const data = model.getWidgetDataByElement(elem);\n        if (name === data.target) {\n          elem.classList.add('active');\n        }\n      }, this);\n\n      // now set the active ancestors\n      let parentPage = cv.util.Tree.getParentWidget(page, 'page');\n      // set for all parent pages apart from the root page\n\n      const pageJumps = document.querySelectorAll('.pagejump');\n      const markPageJumps = function (parentName, elem) {\n        const data = model.getWidgetDataByElement(elem);\n        if (\n          parentName === data.target ||\n          (data.activeScope === 'path' &&\n            ((typeof data.path === 'string' && data.path.match(parentName + '$')) ||\n              (typeof data.targetPath === 'string' && data.targetPath.match(parentName + '$'))))\n        ) {\n          elem.classList.add('active_ancestor');\n        }\n      };\n\n      while (parentPage && cv.util.Tree.getParentWidget(parentPage, 'page')) {\n        pageJumps.forEach(function (elem) {\n          markPageJumps(parentPage.getName(), elem);\n        });\n        // recursively find pagejumps for parent pages\n        parentPage = cv.util.Tree.getParentWidget(parentPage, 'page');\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString() {\n      let actor = '<div class=\"actor switchUnpressed';\n      if (this.getAlign()) {\n        actor += ' ' + this.getAlign();\n      }\n      actor += '\">';\n      if (this.getName()) {\n        actor += '<div class=\"value\">' + this.getName() + '</div>';\n      }\n      actor += '</div>';\n      return actor + this.getChildrenDomString();\n    },\n\n    // overridden\n    action() {\n      let target = this.getTarget();\n      if (this.getTargetPath() !== null) {\n        target = cv.Application.structureController.getPageIdByPath(target, this.getTargetPath());\n      }\n      cv.Application.structureController.scrollToPage(target);\n    }\n  },\n\n  defer(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('pagejump', statics);\n    qx.event.message.Bus.subscribe('path.pageChanged', statics._onScrollToPage, statics);\n  }\n});\n"
  ],
  "mappings": "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"
}