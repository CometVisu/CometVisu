{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Mixin",
    "define",
    "properties",
    "fullscreen",
    "check",
    "init",
    "apply",
    "event",
    "members",
    "__uuid",
    "__popupAddress",
    "__button",
    "getUuid",
    "util",
    "Uuid",
    "createUuidV4",
    "getPopupAddress",
    "concat",
    "__applyFullscreen",
    "value",
    "sendValue",
    "setAttribute",
    "cv",
    "data",
    "Model",
    "getInstance",
    "onUpdate",
    "_initFullscreenSwitch",
    "_this",
    "button",
    "_buttonFactory",
    "addEventListener",
    "toggleFullscreen",
    "appendToHeader",
    "tileAddress",
    "document",
    "createElement",
    "textContent",
    "_element",
    "parentElement",
    "appendChild",
    "parent",
    "nodeName",
    "toLowerCase",
    "tileWidget",
    "addListener",
    "setFullscreen",
    "ev",
    "onStateUpdate",
    "stopPropagation",
    "icon",
    "classes",
    "_button$classList",
    "classList",
    "add",
    "_toConsumableArray",
    "i",
    "destruct",
    "ui",
    "structure",
    "tile",
    "MFullscreen"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/MFullscreen.js"
  ],
  "sourcesContent": [
    "/*\n * Copyright (c) 2023, Christian Mayer and the CometVisu contributors.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n *\n */\n\n/**\n *\n */\nqx.Mixin.define('cv.ui.structure.tile.MFullscreen', {\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    fullscreen: {\n      check: 'Boolean',\n      init: false,\n      apply: '__applyFullscreen',\n      event: 'changeFullscreen'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __uuid: null,\n    __popupAddress: null,\n    __button: null,\n\n    getUuid() {\n      if (!this.__uuid) {\n        this.__uuid = qx.util.Uuid.createUuidV4();\n      }\n      return this.__uuid;\n    },\n\n    getPopupAddress() {\n      if (!this.__popupAddress) {\n        this.__popupAddress = `state:${this.getUuid()}-popup`;\n      }\n      return this.__popupAddress;\n    },\n\n    __applyFullscreen(value) {\n      const sendValue = value ? '1' : '0';\n      this.__button.setAttribute('data-value', sendValue);\n      cv.data.Model.getInstance().onUpdate(this.getPopupAddress(), sendValue, 'system');\n    },\n\n    _initFullscreenSwitch() {\n      // add fullscreen button + address\n      const button= this.__button = this._buttonFactory('ri-fullscreen-line', ['fullscreen']);\n      button.setAttribute('data-value', '0');\n      button.addEventListener('click', () => this.toggleFullscreen());\n      this.appendToHeader(button, 'right');\n\n      // address\n      const tileAddress = document.createElement('cv-address');\n      tileAddress.setAttribute('mode', 'read');\n      tileAddress.setAttribute('target', 'fullscreen-popup');\n      tileAddress.setAttribute('backend', 'system');\n      tileAddress.setAttribute('send-mode', 'always');\n      tileAddress.textContent = this.getPopupAddress();\n      this._element.parentElement.appendChild(tileAddress);\n\n      // listen to parent tile of popup is opened or not\n      let parent = this._element;\n      while (parent && parent.nodeName.toLowerCase() !== 'cv-tile') {\n        parent = parent.parentElement;\n      }\n      if (parent) {\n        const tileWidget = parent.getInstance();\n        tileWidget.addListener('closed', () => this.setFullscreen(false));\n\n        // because we added a read address to the tile after it has been initialized we need to init the listener here manually\n        parent.addEventListener('stateUpdate', ev => {\n          tileWidget.onStateUpdate(ev);\n          // cancel event here\n          ev.stopPropagation();\n        });\n      }\n    },\n\n    _buttonFactory(icon, classes) {\n      const button = document.createElement('button');\n      button.classList.add(...classes);\n      if (icon) {\n        const i = document.createElement('i');\n        i.classList.add(icon);\n        button.appendChild(i);\n      }\n      return button;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this.__button = null;\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}