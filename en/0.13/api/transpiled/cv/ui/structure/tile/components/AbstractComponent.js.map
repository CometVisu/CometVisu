{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/AbstractComponent.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "elements",
    "AbstractCustomElement",
    "type",
    "properties",
    "value",
    "apply",
    "init",
    "styleClass",
    "check",
    "nullable",
    "enabled",
    "visibility",
    "event",
    "members",
    "_writeAddresses",
    "_visibleDisplayMode",
    "_init",
    "element",
    "_element",
    "hasReadAddress",
    "writeAddresses",
    "Array",
    "prototype",
    "forEach",
    "call",
    "querySelectorAll",
    "address",
    "mode",
    "hasAttribute",
    "getAttribute",
    "push",
    "addEventListener",
    "ev",
    "onStateUpdate",
    "stopPropagation",
    "_applyValue",
    "isConnected",
    "setAttribute",
    "mappedValue",
    "Application",
    "structureController",
    "mapValue",
    "util",
    "String",
    "sprintf",
    "Date",
    "toLocaleString",
    "_updateValue",
    "styleValue",
    "setStyleClass",
    "_applyStyleClass",
    "oldValue",
    "classes",
    "classList",
    "contains",
    "replace",
    "add",
    "remove",
    "_applyEnabled",
    "blocker",
    "querySelector",
    "document",
    "createElement",
    "appendChild",
    "preventDefault",
    "style",
    "display",
    "_applyVisibility",
    "opacity",
    "getComputedStyle",
    "getPropertyValue",
    "detail",
    "target",
    "setEnabled",
    "state",
    "setVisibility",
    "setValue",
    "components",
    "AbstractComponent"
  ],
  "mappings": ";;;;;;;;;;;;;;AAAAA,EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACAH,EAAAA,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,mDAAhB,EAAqE;AACnEC,IAAAA,MAAM,EAAEC,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBC,IAAhB,CAAqBC,QAArB,CAA8BC,qBAD6B;AAEnEC,IAAAA,IAAI,EAAE,UAF6D;;AAInE;AACF;AACA;AACA;AACA;AACEC,IAAAA,UAAU,EAAE;AACVC,MAAAA,KAAK,EAAE;AACLC,QAAAA,KAAK,EAAE,aADF;AAELC,QAAAA,IAAI,EAAE;AAFD,OADG;AAKVC,MAAAA,UAAU,EAAE;AACVC,QAAAA,KAAK,EAAE,QADG;AAEVC,QAAAA,QAAQ,EAAE,IAFA;AAGVJ,QAAAA,KAAK,EAAE;AAHG,OALF;AAUVK,MAAAA,OAAO,EAAE;AACPF,QAAAA,KAAK,EAAE,SADA;AAEPF,QAAAA,IAAI,EAAE,IAFC;AAGPD,QAAAA,KAAK,EAAE;AAHA,OAVC;AAeVM,MAAAA,UAAU,EAAE;AACVH,QAAAA,KAAK,EAAE,CAAC,SAAD,EAAY,UAAZ,EAAwB,QAAxB,CADG;AAEVF,QAAAA,IAAI,EAAE,SAFI;AAGVD,QAAAA,KAAK,EAAE,kBAHG;AAIVO,QAAAA,KAAK,EAAE;AAJG;AAfF,KATuD;;AA+BnE;AACF;AACA;AACA;AACA;AACEC,IAAAA,OAAO,EAAE;AACPC,MAAAA,eAAe,EAAE,IADV;AAEPC,MAAAA,mBAAmB,EAAE,IAFd;AAIPC,MAAAA,KAJO,mBAIC;AAAA;;AACN,YAAMC,OAAO,GAAG,KAAKC,QAArB;AACA,YAAIC,cAAc,GAAG,KAArB;AACA,YAAMC,cAAc,GAAG,EAAvB;AACAC,QAAAA,KAAK,CAACC,SAAN,CAAgBC,OAAhB,CAAwBC,IAAxB,CAA6BP,OAAO,CAACQ,gBAAR,CAAyB,qBAAzB,CAA7B,EAA8E,UAAAC,OAAO,EAAI;AACvF,cAAMC,IAAI,GAAGD,OAAO,CAACE,YAAR,CAAqB,MAArB,IAA+BF,OAAO,CAACG,YAAR,CAAqB,MAArB,CAA/B,GAA8D,WAA3E;;AACA,kBAAQF,IAAR;AACE,iBAAK,WAAL;AACER,cAAAA,cAAc,GAAG,IAAjB;AACAC,cAAAA,cAAc,CAACU,IAAf,CAAoBJ,OAApB;AACA;;AACF,iBAAK,MAAL;AACEP,cAAAA,cAAc,GAAG,IAAjB;AACA;;AACF,iBAAK,OAAL;AACEC,cAAAA,cAAc,CAACU,IAAf,CAAoBJ,OAApB;AACA;AAVJ;AAYD,SAdD;AAgBA,aAAKZ,eAAL,GAAuBM,cAAvB;;AAEA,YAAID,cAAJ,EAAoB;AAClBF,UAAAA,OAAO,CAACc,gBAAR,CAAyB,aAAzB,EAAwC,UAAAC,EAAE,EAAI;AAC5C,YAAA,KAAI,CAACC,aAAL,CAAmBD,EAAnB,EAD4C,CAE5C;;;AACAA,YAAAA,EAAE,CAACE,eAAH;AACD,WAJD;AAKD;AACF,OAjCM;AAmCP;AACAC,MAAAA,WApCO,uBAoCK/B,KApCL,EAoCY;AACjB,YAAI,KAAKgC,WAAL,EAAJ,EAAwB;AACtB,eAAKlB,QAAL,CAAcmB,YAAd,CAA2B,OAA3B,EAAoCjC,KAAK,IAAI,EAA7C;;AACA,cAAIkC,WAAW,GAAGlC,KAAlB;;AACA,cAAI,KAAKc,QAAL,CAAcU,YAAd,CAA2B,SAA3B,CAAJ,EAA2C;AACzCU,YAAAA,WAAW,GAAG1C,EAAE,CAAC2C,WAAH,CAAeC,mBAAf,CAAmCC,QAAnC,CAA4C,KAAKvB,QAAL,CAAcW,YAAd,CAA2B,SAA3B,CAA5C,EAAmFzB,KAAnF,CAAd;AACD;;AACD,cAAI,KAAKc,QAAL,CAAcU,YAAd,CAA2B,QAA3B,CAAJ,EAA0C;AACxCU,YAAAA,WAAW,GAAG1C,EAAE,CAAC8C,IAAH,CAAQC,MAAR,CAAeC,OAAf,CAAuB,KAAK1B,QAAL,CAAcW,YAAd,CAA2B,QAA3B,CAAvB,EAA6DS,WAAW,YAAYO,IAAvB,GAA8BP,WAAW,CAACQ,cAAZ,EAA9B,GAA6DR,WAA1H,CAAd;AACD;;AACD,eAAKS,YAAL,CAAkBT,WAAlB,EAA+BlC,KAA/B;;AACA,cAAI,KAAKc,QAAL,CAAcU,YAAd,CAA2B,SAA3B,CAAJ,EAA2C;AACzC,gBAAIrB,UAAU,GAAGX,EAAE,CAAC2C,WAAH,CAAeC,mBAAf,CAAmCQ,UAAnC,CAA8C,KAAK9B,QAAL,CAAcW,YAAd,CAA2B,SAA3B,CAA9C,EAAqFzB,KAArF,CAAjB;AACA,iBAAK6C,aAAL,CAAmB1C,UAAnB;AACD;AACF;AACF,OApDM;AAsDP;AACAwC,MAAAA,YAvDO,wBAuDMT,WAvDN,EAuDmBlC,KAvDnB,EAuD0B,CAChC,CAxDM;AA0DP;AACA8C,MAAAA,gBA3DO,4BA2DU9C,KA3DV,EA2DiB+C,QA3DjB,EA2D2B;AAChC,YAAMC,OAAO,GAAG,KAAKlC,QAAL,CAAcmC,SAA9B;;AACA,YAAIF,QAAJ,EAAc;AACZ,cAAIC,OAAO,CAACE,QAAR,CAAiBH,QAAjB,CAAJ,EAAgC;AAC9BC,YAAAA,OAAO,CAACG,OAAR,CAAgBJ,QAAhB,EAA0B/C,KAA1B;AACD,WAFD,MAEO;AACLgD,YAAAA,OAAO,CAACI,GAAR,CAAYpD,KAAZ;AACAgD,YAAAA,OAAO,CAACK,MAAR,CAAeN,QAAf;AACD;AACF,SAPD,MAOO,IAAI/C,KAAJ,EAAW;AAChBgD,UAAAA,OAAO,CAACI,GAAR,CAAYpD,KAAZ;AACD;AACF,OAvEM;AAyEPsD,MAAAA,aAzEO,yBAyEOtD,KAzEP,EAyEc;AACnB,YAAIuD,OAAO,GAAG,KAAKzC,QAAL,CAAc0C,aAAd,CAA4B,mBAA5B,CAAd;;AACA,YAAI,CAACD,OAAL,EAAc;AACZA,UAAAA,OAAO,GAAGE,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAV;AACAH,UAAAA,OAAO,CAACN,SAAR,CAAkBG,GAAlB,CAAsB,SAAtB;;AACA,eAAKtC,QAAL,CAAc6C,WAAd,CAA0BJ,OAA1B;;AACAA,UAAAA,OAAO,CAAC5B,gBAAR,CAAyB,OAAzB,EAAkC,UAAAC,EAAE,EAAI;AACtCA,YAAAA,EAAE,CAACgC,cAAH;AACAhC,YAAAA,EAAE,CAACE,eAAH;AACD,WAHD;AAIAyB,UAAAA,OAAO,CAAC5B,gBAAR,CAAyB,aAAzB,EAAwC,UAAAC,EAAE,EAAI;AAC5CA,YAAAA,EAAE,CAACgC,cAAH;AACAhC,YAAAA,EAAE,CAACE,eAAH;AACD,WAHD;AAIAyB,UAAAA,OAAO,CAAC5B,gBAAR,CAAyB,WAAzB,EAAsC,UAAAC,EAAE,EAAI;AAC1CA,YAAAA,EAAE,CAACgC,cAAH;AACAhC,YAAAA,EAAE,CAACE,eAAH;AACD,WAHD;AAID;;AACD,aAAKhB,QAAL,CAAcmB,YAAd,CAA2B,UAA3B,EAAuCjC,KAAK,KAAK,KAAV,GAAkB,MAAlB,GAA2B,OAAlE;;AACAuD,QAAAA,OAAO,CAACM,KAAR,CAAcC,OAAd,GAAwB9D,KAAK,KAAK,IAAV,GAAiB,MAAjB,GAA0B,OAAlD;AACD,OA9FM;AAgGP+D,MAAAA,gBAhGO,4BAgGU/D,KAhGV,EAgGiB+C,QAhGjB,EAgG2B;AAChC,YAAIA,QAAQ,KAAK,QAAjB,EAA2B;AACzB,eAAKjC,QAAL,CAAc+C,KAAd,CAAoBG,OAApB,GAA8B,KAA9B;AACD;;AACD,gBAAQhE,KAAR;AACE,eAAK,SAAL;AACE,gBAAI,KAAKW,mBAAT,EAA8B;AAC5B,mBAAKG,QAAL,CAAc+C,KAAd,CAAoBC,OAApB,GAA8B,KAAKnD,mBAAL,IAA4B,SAA1D;AACD;;AACD;;AAEF,eAAK,QAAL;AACE,iBAAKG,QAAL,CAAc+C,KAAd,CAAoBG,OAApB,GAA8B,GAA9B;AACA;;AAEF,eAAK,UAAL;AACE,iBAAKrD,mBAAL,GAA2BsD,gBAAgB,CAAC,KAAKnD,QAAN,CAAhB,CAAgCoD,gBAAhC,CAAiD,SAAjD,CAA3B;AACA,iBAAKpD,QAAL,CAAc+C,KAAd,CAAoBC,OAApB,GAA8B,MAA9B;AACA;AAdJ;AAgBD,OApHM;;AAsHP;AACJ;AACA;AACA;AACA;AACA;AACIjC,MAAAA,aA5HO,yBA4HOD,EA5HP,EA4HW;AAChB,gBAAQA,EAAE,CAACuC,MAAH,CAAUC,MAAlB;AACE,eAAK,SAAL;AACE,iBAAKC,UAAL,CAAgBzC,EAAE,CAACuC,MAAH,CAAUG,KAA1B;AACA1C,YAAAA,EAAE,CAACE,eAAH;AACA,mBAAO,IAAP;;AACF,eAAK,cAAL;AACE,iBAAKyC,aAAL,CAAmB3C,EAAE,CAACuC,MAAH,CAAUG,KAAV,GAAkB,SAAlB,GAA8B,UAAjD;AACA1C,YAAAA,EAAE,CAACE,eAAH;AACA,mBAAO,IAAP;;AACF,eAAK,WAAL;AACE,iBAAKyC,aAAL,CAAmB3C,EAAE,CAACuC,MAAH,CAAUG,KAAV,GAAkB,SAAlB,GAA8B,QAAjD;AACA1C,YAAAA,EAAE,CAACE,eAAH;AACA,mBAAO,IAAP;;AACF,eAAK,EAAL;AACE,iBAAK0C,QAAL,CAAc5C,EAAE,CAACuC,MAAH,CAAUG,KAAxB;AACA1C,YAAAA,EAAE,CAACE,eAAH;AACA,mBAAO,IAAP;AAhBJ;;AAkBA,eAAO,KAAP;AACD;AAhJM;AApC0D,GAArE;AAtBAtC,EAAAA,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBC,IAAhB,CAAqB8E,UAArB,CAAgCC,iBAAhC,CAAkDtF,aAAlD,GAAkEA,aAAlE",
  "sourcesContent": [
    "/* AbstractComponent.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Base class for all components.\n */\nqx.Class.define('cv.ui.structure.tile.components.AbstractComponent', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    value: {\n      apply: '_applyValue',\n      init: null\n    },\n    styleClass: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyStyleClass'\n    },\n    enabled: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyEnabled'\n    },\n    visibility: {\n      check: ['visible', 'excluded', 'hidden'],\n      init: 'visible',\n      apply: '_applyVisibility',\n      event: 'changeVisibility'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _writeAddresses: null,\n    _visibleDisplayMode: null,\n\n    _init() {\n      const element = this._element;\n      let hasReadAddress = false;\n      const writeAddresses = [];\n      Array.prototype.forEach.call(element.querySelectorAll(':scope > cv-address'), address => {\n        const mode = address.hasAttribute('mode') ? address.getAttribute('mode') : 'readwrite';\n        switch (mode) {\n          case 'readwrite':\n            hasReadAddress = true;\n            writeAddresses.push(address);\n            break;\n          case 'read':\n            hasReadAddress = true;\n            break;\n          case 'write':\n            writeAddresses.push(address);\n            break;\n        }\n      });\n\n      this._writeAddresses = writeAddresses;\n\n      if (hasReadAddress) {\n        element.addEventListener('stateUpdate', ev => {\n          this.onStateUpdate(ev);\n          // cancel event here\n          ev.stopPropagation();\n        });\n      }\n    },\n\n    // property apply\n    _applyValue(value) {\n      if (this.isConnected()) {\n        this._element.setAttribute('value', value || '');\n        let mappedValue = value;\n        if (this._element.hasAttribute('mapping')) {\n          mappedValue = cv.Application.structureController.mapValue(this._element.getAttribute('mapping'), value);\n        }\n        if (this._element.hasAttribute('format')) {\n          mappedValue = cv.util.String.sprintf(this._element.getAttribute('format'), mappedValue instanceof Date ? mappedValue.toLocaleString() : mappedValue);\n        }\n        this._updateValue(mappedValue, value);\n        if (this._element.hasAttribute('styling')) {\n          let styleClass = cv.Application.structureController.styleValue(this._element.getAttribute('styling'), value);\n          this.setStyleClass(styleClass);\n        }\n      }\n    },\n\n    // needs to be implemented by inheriting classes\n    _updateValue(mappedValue, value) {\n    },\n\n    // property apply\n    _applyStyleClass(value, oldValue) {\n      const classes = this._element.classList;\n      if (oldValue) {\n        if (classes.contains(oldValue)) {\n          classes.replace(oldValue, value);\n        } else {\n          classes.add(value);\n          classes.remove(oldValue);\n        }\n      } else if (value) {\n        classes.add(value);\n      }\n    },\n\n    _applyEnabled(value) {\n      let blocker = this._element.querySelector(':scope > .blocker');\n      if (!blocker) {\n        blocker = document.createElement('div');\n        blocker.classList.add('blocker');\n        this._element.appendChild(blocker);\n        blocker.addEventListener('click', ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n        });\n        blocker.addEventListener('pointerdown', ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n        });\n        blocker.addEventListener('pointerup', ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n        });\n      }\n      this._element.setAttribute('disabled', value === false ? 'true' : 'false');\n      blocker.style.display = value === true ? 'none' : 'block';\n    },\n\n    _applyVisibility(value, oldValue) {\n      if (oldValue === 'hidden') {\n        this._element.style.opacity = '1.0';\n      }\n      switch (value) {\n        case 'visible':\n          if (this._visibleDisplayMode) {\n            this._element.style.display = this._visibleDisplayMode || 'initial';\n          }\n          break;\n\n        case 'hidden':\n          this._element.style.opacity = '0';\n          break;\n\n        case 'excluded':\n          this._visibleDisplayMode = getComputedStyle(this._element).getPropertyValue('display');\n          this._element.style.display = 'none';\n          break;\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     * @return {Boolean} true of the update has been handled\n     */\n    onStateUpdate(ev) {\n      switch (ev.detail.target) {\n        case 'enabled':\n          this.setEnabled(ev.detail.state);\n          ev.stopPropagation();\n          return true;\n        case 'show-exclude':\n          this.setVisibility(ev.detail.state ? 'visible' : 'excluded');\n          ev.stopPropagation();\n          return true;\n        case 'show-hide':\n          this.setVisibility(ev.detail.state ? 'visible' : 'hidden');\n          ev.stopPropagation();\n          return true;\n        case '':\n          this.setValue(ev.detail.state);\n          ev.stopPropagation();\n          return true;\n      }\n      return false;\n    }\n  }\n});\n"
  ]
}