{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Mixin",
    "define",
    "construct",
    "_onPointerDownBounded",
    "_onPointerDown",
    "bind",
    "_openPopupChildBounded",
    "_openPopupChild",
    "statics",
    "openedPopups",
    "events",
    "closed",
    "members",
    "_childPopup",
    "_initPopupChild",
    "popup",
    "_element",
    "querySelector",
    "addEventListener",
    "parent",
    "parentElement",
    "last",
    "tagName",
    "toLowerCase",
    "classList",
    "add",
    "getInstance",
    "open",
    "_closePopupChild",
    "close",
    "registerModalPopup",
    "document",
    "blocker",
    "body",
    "createElement",
    "appendChild",
    "style",
    "display",
    "cv",
    "ui",
    "structure",
    "tile",
    "MPopup",
    "push",
    "unregisterModalPopup",
    "removeEventListener",
    "index",
    "indexOf",
    "splice",
    "length",
    "ev",
    "element",
    "_headerFooterParent",
    "util",
    "Tree",
    "isChildOf",
    "target",
    "preventDefault",
    "stopImmediatePropagation",
    "event",
    "Timer",
    "once",
    "destruct"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/MPopup.js"
  ],
  "sourcesContent": [
    "/* MPopup.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Handles cv-popup children and some general popup tasks, like global registration and close on click outside, modal blocker etc.\n */\nqx.Mixin.define('cv.ui.structure.tile.MPopup', {\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    this._onPointerDownBounded = this._onPointerDown.bind(this);\n    this._openPopupChildBounded = this._openPopupChild.bind(this);\n  },\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    openedPopups: []\n  },\n\n  events: {\n    closed: 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _childPopup: null,\n    _onPointerDownBounded: null,\n    _openPopupChildBounded: null,\n\n    _initPopupChild() {\n      const popup = (this._childPopup = this._element.querySelector(':scope > cv-popup'));\n      if (popup) {\n        this._element.addEventListener('click', this._openPopupChildBounded);\n\n        // we need to tell the parent widget that is inside a group that wen have a popup here\n        let parent = popup.parentElement;\n        let last;\n        while (parent) {\n          if (parent.tagName.toLowerCase() === 'cv-group') {\n            last.classList.add('has-popup');\n          } else if (parent.tagName.toLowerCase() === 'cv-page') {\n            break;\n          }\n          last = parent;\n          parent = parent.parentElement;\n        }\n      }\n    },\n\n    _openPopupChild() {\n      const popup = this._element.querySelector(':scope > cv-popup:not([open])');\n\n      if (popup) {\n        popup.getInstance().open();\n      }\n    },\n\n    _closePopupChild() {\n      const popup = this._element.querySelector(':scope > cv-popup[open]');\n      if (popup) {\n        popup.getInstance().close();\n      }\n    },\n\n    registerModalPopup() {\n      document.addEventListener('pointerup', this._onPointerDownBounded);\n\n      let blocker = document.body.querySelector('.modal-popup-blocker');\n      if (!blocker) {\n        blocker = document.createElement('div');\n        blocker.classList.add('modal-popup-blocker');\n        document.body.appendChild(blocker);\n      }\n      blocker.style.display = 'block';\n      cv.ui.structure.tile.MPopup.openedPopups.push(this);\n    },\n\n    unregisterModalPopup() {\n      document.removeEventListener('pointerup', this._onPointerDownBounded);\n\n      const index = cv.ui.structure.tile.MPopup.openedPopups.indexOf(this);\n      cv.ui.structure.tile.MPopup.openedPopups.splice(index, 1);\n      let blocker = document.body.querySelector('.modal-popup-blocker');\n      if (blocker && cv.ui.structure.tile.MPopup.openedPopups.length === 0) {\n        blocker.style.display = 'none';\n      }\n    },\n\n    _onPointerDown(ev) {\n      const element = this._headerFooterParent || this._element;\n      if (!cv.util.Tree.isChildOf(ev.target, element)) {\n        ev.preventDefault();\n        ev.stopImmediatePropagation();\n        // clicked outside -> close (with delay to capture composed events)\n        qx.event.Timer.once(this.close, this, 100);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._element.removeEventListener('click', this._openPopupChildBounded);\n\n    this._childPopup = null;\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}