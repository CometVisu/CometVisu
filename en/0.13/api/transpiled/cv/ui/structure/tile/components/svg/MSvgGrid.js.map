{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Mixin",
    "define",
    "construct",
    "_cells",
    "_isLayoutValid",
    "debouncedLayoutAll",
    "module",
    "util",
    "Function",
    "debounce",
    "_layoutAll",
    "bind",
    "properties",
    "rows",
    "check",
    "init",
    "event",
    "apply",
    "transform",
    "columns",
    "outerPadding",
    "spacing",
    "cellWidth",
    "cellHeight",
    "viewBox",
    "nullable",
    "members",
    "__toInt",
    "__P_90_0",
    "value",
    "parseInt",
    "_invalidateLayout",
    "debug",
    "cellId",
    "position",
    "split",
    "map",
    "i",
    "parseFloat",
    "layout",
    "getCells",
    "getRows",
    "getColumns",
    "element",
    "row",
    "arguments",
    "length",
    "undefined",
    "column",
    "replace",
    "retries",
    "_this$getNextFreeCell",
    "getNextFreeCell",
    "_this$getNextFreeCell2",
    "_slicedToArray",
    "r",
    "c",
    "error",
    "concat",
    "_i2",
    "_Object$keys",
    "Object",
    "keys",
    "id",
    "x",
    "getOuterPadding",
    "getSpacing",
    "getCellWidth",
    "y",
    "getCellHeight",
    "setAttribute",
    "startCell",
    "Math",
    "floor",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "svg",
    "MSvgGrid"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/svg/MSvgGrid.js"
  ],
  "sourcesContent": [
    "/*\n * Copyright (c) 2023, Christian Mayer and the CometVisu contributors.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n *\n */\n\n/**\n * Mixin for SVG elements that provide a grid layout.\n * @since 2023\n * @author Tobias BrÃ¤utigam\n */\nqx.Mixin.define('cv.ui.structure.tile.components.svg.MSvgGrid', {\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    this._cells = {};\n    this._isLayoutValid = true;\n    this.debouncedLayoutAll = qx.module.util.Function.debounce(this._layoutAll.bind(this), 100);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    rows: {\n      check: 'Number',\n      init: 3,\n      event: 'changeRows',\n      apply: '_invalidateLayout',\n      transform: '__toInt'\n    },\n\n    columns: {\n      check: 'Number',\n      init: 3,\n      event: 'changeColumns',\n      apply: '_invalidateLayout',\n      transform: '__toInt'\n    },\n\n    outerPadding: {\n      check: 'Number',\n      event: 'changeOuterPadding',\n      init: 4,\n      apply: '_invalidateLayout',\n      transform: '__toInt'\n    },\n\n    spacing: {\n      check: 'Number',\n      init: 8,\n      event: 'changeSpacing',\n      apply: '_invalidateLayout',\n      transform: '__toInt'\n    },\n\n    cellWidth: {\n      check: 'Number',\n      init: 56,\n      apply: '_invalidateLayout',\n      event: 'changeSize',\n      transform: '__toInt'\n    },\n\n    cellHeight: {\n      check: 'Number',\n      init: 56,\n      apply: '_invalidateLayout',\n      event: 'changeSize',\n      transform: '__toInt'\n    },\n\n    viewBox: {\n      check: 'String',\n      nullable: true,\n      event: 'changeViewBox'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _cells: null,\n    _isLayoutValid: null,\n\n    __toInt(value) {\n      if (typeof value === 'string') {\n        return parseInt(value);\n      }\n      return value;\n    },\n\n    _invalidateLayout() {\n      this._isLayoutValid = false;\n      this.debouncedLayoutAll();\n    },\n\n    _layoutAll() {\n      this.debug('re-layout all items');\n      for (const cellId in this._cells) {\n        const position = cellId.split('-').map(i => parseFloat(i));\n        this.layout(this._cells[cellId], position[0], position[1], true);\n      }\n      this._isLayoutValid = true;\n    },\n\n    /**\n     * Returns the number of cells in this grid\n     * @returns {number}\n     */\n    getCells() {\n      return this.getRows() * this.getColumns();\n    },\n\n    /**\n     * Add a SVGElement to a cell in the grid.\n     * @param element {SVGGraphicsElement} element to place\n     * @param row {number} row number (-1 to find next free row)\n     * @param column {number} column cumber (-1 to use next free cell)\n     * @param replace {boolean} it true replace current item in cell, otherwise the element will not be added when the cell is not empty\n     * @param retries {number} internal value used to limit layout retries for one element. Do not set this externally!\n     */\n    layout(element, row = -1, column = -1, replace = false, retries = 0) {\n      if (row === -1 || column === -1) {\n        const [r, c] = this.getNextFreeCell(row, column);\n        if (r === -1 || c === -1) {\n          this.error('no next free cell found, element could not be placed');\n          return;\n        }\n        row = r;\n        column = c;\n      }\n      const cellId = row + '-' + column;\n      if (this._cells[cellId] && !replace) {\n        this.error(`cell ${row}/${column} is not empty`);\n        return;\n      }\n\n      // remove old positions\n      for (const id of Object.keys(this._cells)) {\n        if (id !== cellId && this._cells[id] === element) {\n          delete this._cells[id];\n        }\n      }\n      let x = this.getOuterPadding() + column * this.getSpacing() + column * this.getCellWidth();\n      let y  = this.getOuterPadding() + row * this.getSpacing() + row * this.getCellHeight();\n      element.setAttribute('x', `${x}`);\n      element.setAttribute('y', `${y}`);\n      this._cells[cellId] = element;\n    },\n\n    getNextFreeCell(row, column) {\n      let cellId;\n      if (row === -1 && column === -1) {\n        for (let r = 0; r < this.getRows(); r++) {\n          for (let c = 0; c < this.getColumns(); c++) {\n            cellId = r + '-' + c;\n            if (!this._cells[cellId]) {\n              return [r,  c];\n            }\n          }\n        }\n      } else if (row === -1) {\n        for (let r = 0; r < this.getRows(); r++) {\n          cellId = r + '-' + column;\n          if (!this._cells[cellId]) {\n            return [r, column];\n          }\n        }\n      } else if (column === -1) {\n        for (let c = 0; c < this.getColumns(); c++) {\n          cellId = row + '-' + c;\n          if (!this._cells[cellId]) {\n            return [row, column];\n          }\n        }\n      } else {\n        let startCell = row * this.getColumns() + column;\n        let r;\n        let c;\n        for (let i = startCell; i < this.getCells(); i++) {\n          r = Math.floor(i / this.getColumns());\n          c = i % this.getColumns();\n          cellId = r + '-' + c;\n          if (!this._cells[cellId]) {\n            return [r,  c];\n          }\n        }\n      }\n      return [row, column];\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}