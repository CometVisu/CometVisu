{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "members",
    "__options",
    "__value",
    "__popup",
    "_init",
    "_this",
    "Select",
    "superclass",
    "prototype",
    "call",
    "element",
    "_element",
    "Map",
    "popup",
    "document",
    "createElement",
    "classList",
    "add",
    "querySelectorAll",
    "forEach",
    "option",
    "i",
    "appendChild",
    "hasAttribute",
    "setAttribute",
    "set",
    "getAttribute",
    "value",
    "handle",
    "_writeAddresses",
    "length",
    "addEventListener",
    "ev",
    "onClicked",
    "style",
    "getComputedStyle",
    "target",
    "currentTarget",
    "tagName",
    "toLowerCase",
    "parentElement",
    "_sendSelection",
    "getPropertyValue",
    "display",
    "key",
    "predictive",
    "CustomEvent",
    "detail",
    "source",
    "filter",
    "addr",
    "address",
    "dispatchEvent",
    "setValue",
    "_updateValue",
    "mappedValue",
    "has",
    "innerHTML",
    "current",
    "get",
    "children",
    "_iterator",
    "_createForOfIteratorHelper",
    "_step",
    "s",
    "n",
    "done",
    "child",
    "cloneNode",
    "err",
    "e",
    "f",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "_QxConnector",
    "_inherits",
    "_class",
    "_super",
    "_createSuper",
    "_classCallCheck",
    "_createClass",
    "QxConnector"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Select.js"
  ],
  "sourcesContent": [
    "/* Select.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Allows the selection of one element out of a list of <cv-option> elements\n */\nqx.Class.define('cv.ui.structure.tile.components.Select', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __options: null,\n    __value: null,\n    __popup: null,\n\n    _init() {\n      super._init();\n      const element = this._element;\n      this.__options = new Map();\n\n      const popup = (this.__popup = document.createElement('div'));\n      popup.classList.add('popup');\n      element.querySelectorAll(':scope > cv-option').forEach((option, i) => {\n        popup.appendChild(option);\n        if (!option.hasAttribute('key')) {\n          option.setAttribute('key', '' + i);\n        }\n        this.__options.set(option.getAttribute('key'), option);\n      });\n      const value = (this.__value = document.createElement('span'));\n      value.classList.add('value');\n      element.appendChild(value);\n      element.appendChild(popup);\n      const handle = document.createElement('cv-icon');\n      handle.classList.add('dropdown');\n      handle.classList.add('ri-arrow-down-s-line');\n      element.appendChild(handle);\n\n      if (this._writeAddresses.length > 0) {\n        element.addEventListener('click', ev => this.onClicked(ev));\n      }\n    },\n\n    onClicked(ev) {\n      const style = getComputedStyle(this.__popup);\n      let target = ev.target;\n      // find out event target (either the cv-select of cv-option\n      while (target !== ev.currentTarget && target.tagName.toLowerCase() !== 'cv-option') {\n        target = target.parentElement;\n      }\n      if (target.tagName.toLowerCase() === 'cv-option') {\n        // select this option\n        this._sendSelection(target.getAttribute('key'), true);\n      }\n      // open popup\n      if (style.getPropertyValue('display') === 'none') {\n        this.__popup.style.display = 'block';\n      } else {\n        this.__popup.style.display = 'none';\n      }\n    },\n\n    _sendSelection(key, predictive) {\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: key,\n          source: this\n        }\n      });\n\n      this._writeAddresses\n        .filter(addr => !addr.hasAttribute('on') || addr.getAttribute('on') === 'click')\n        .forEach(address => address.dispatchEvent(ev));\n      if (predictive === true) {\n        this.setValue(key);\n      }\n    },\n\n    _updateValue(mappedValue, value) {\n      if (this.__options.has(mappedValue)) {\n        this.__value.innerHTML = '';\n        const current = this.__options.get(mappedValue);\n        if (current.children.length > 0) {\n          // if we have non text children, we only use them (only icons no text)\n          for (const child of current.children) {\n            this.__value.appendChild(child.cloneNode());\n          }\n        } else {\n          this.__value.innerHTML = current.innerHTML;\n        }\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'select',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}