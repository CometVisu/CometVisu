{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "properties",
    "show",
    "check",
    "init",
    "apply",
    "members",
    "__options",
    "__value",
    "__popup",
    "_init",
    "_this",
    "Select",
    "superclass",
    "prototype",
    "call",
    "element",
    "_element",
    "Map",
    "popup",
    "document",
    "createElement",
    "classList",
    "add",
    "querySelectorAll",
    "forEach",
    "option",
    "i",
    "appendChild",
    "hasAttribute",
    "setAttribute",
    "set",
    "getAttribute",
    "value",
    "handle",
    "_writeAddresses",
    "length",
    "addEventListener",
    "ev",
    "onClicked",
    "_toggleOptions",
    "close",
    "_this2",
    "style",
    "getComputedStyle",
    "getPropertyValue",
    "display",
    "window",
    "requestAnimationFrame",
    "event",
    "Registration",
    "addListener",
    "body",
    "handleEvent",
    "removeListener",
    "preventDefault",
    "stopPropagation",
    "target",
    "currentTarget",
    "tagName",
    "toLowerCase",
    "parentElement",
    "_sendSelection",
    "key",
    "predictive",
    "CustomEvent",
    "detail",
    "source",
    "filter",
    "addr",
    "address",
    "dispatchEvent",
    "setValue",
    "_updateValue",
    "mappedValue",
    "has",
    "innerHTML",
    "current",
    "get",
    "getShow",
    "_iterator",
    "_createForOfIteratorHelper",
    "children",
    "_step",
    "s",
    "n",
    "done",
    "child",
    "nodeName",
    "cloneNode",
    "err",
    "e",
    "f",
    "_iterator2",
    "childNodes",
    "_step2",
    "nodeType",
    "Node",
    "TEXT_NODE",
    "ELEMENT_NODE",
    "_applyShow",
    "getValue",
    "defer",
    "QxClass",
    "_Class",
    "customElements",
    "Controller",
    "PREFIX",
    "_QxConnector",
    "_classCallCheck",
    "_callSuper",
    "_inherits",
    "_createClass",
    "QxConnector",
    "_defineProperty"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Select.js"
  ],
  "sourcesContent": [
    "/* Select.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Allows the selection of one element out of a list of <cv-option> elements\n */\nqx.Class.define('cv.ui.structure.tile.components.Select', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    show: {\n      check: ['icon', 'label', 'both'],\n      init: 'both',\n      apply: '_applyShow'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __options: null,\n    __value: null,\n    __popup: null,\n\n    _init() {\n      super._init();\n      const element = this._element;\n      this.__options = new Map();\n\n      const popup = (this.__popup = document.createElement('div'));\n      popup.classList.add('popup');\n      element.querySelectorAll(':scope > cv-option').forEach((option, i) => {\n        popup.appendChild(option);\n        if (!option.hasAttribute('key')) {\n          option.setAttribute('key', '' + i);\n        }\n        this.__options.set(option.getAttribute('key'), option);\n      });\n      const value = (this.__value = document.createElement('span'));\n      value.classList.add('value');\n      element.appendChild(value);\n      element.appendChild(popup);\n      const handle = document.createElement('cv-icon');\n      handle.classList.add('dropdown');\n      handle.classList.add('ri-arrow-down-s-line');\n      element.appendChild(handle);\n\n      if (this._writeAddresses.length > 0) {\n        element.addEventListener('click', ev => this.onClicked(ev));\n      }\n    },\n\n    _toggleOptions(close) {\n      // open popup\n      const style = getComputedStyle(this.__popup);\n      if (style.getPropertyValue('display') === 'none' && !close) {\n        this.__popup.style.display = 'block';\n        window.requestAnimationFrame(() => {\n          // delay adding this listener, otherwise it would fire immediately\n          // also the native addEventListener does not allow the listener to be re-added once removed, so we use the qx way here\n          // which works fine\n          qx.event.Registration.addListener(document.body, 'click', this.handleEvent, this, true);\n        });\n      } else {\n        this.__popup.style.display = 'none';\n        qx.event.Registration.removeListener(document.body, 'click', this.handleEvent, this, true);\n      }\n    },\n\n    handleEvent(ev) {\n      ev.preventDefault();\n      ev.stopPropagation();\n      this._toggleOptions(true);\n    },\n\n    onClicked(ev) {\n      let target = ev.target;\n      // find out event target (either the cv-select of cv-option\n      while (target !== ev.currentTarget && target.tagName.toLowerCase() !== 'cv-option') {\n        target = target.parentElement;\n      }\n      if (target.tagName.toLowerCase() === 'cv-option') {\n        // select this option\n        this._sendSelection(target.getAttribute('key'), true);\n      }\n      this._toggleOptions();\n    },\n\n    _sendSelection(key, predictive) {\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: key,\n          source: this\n        }\n      });\n\n      this._writeAddresses\n        .filter(addr => !addr.hasAttribute('on') || addr.getAttribute('on') === 'click')\n        .forEach(address => address.dispatchEvent(ev));\n      if (predictive === true) {\n        this.setValue(key);\n      }\n    },\n\n    _updateValue(mappedValue, value) {\n      const key = typeof mappedValue !== 'undefined' ? '' + mappedValue : '';\n      if (this.__options.has(key)) {\n        this.__value.innerHTML = '';\n        const current = this.__options.get(key);\n        switch (this.getShow()) {\n          case 'icon':\n            // if we have non text children, we only use them (only icons no text)\n            for (const child of current.children) {\n              if (child.nodeName.toLowerCase() === 'cv-icon') {\n                this.__value.appendChild(child.cloneNode());\n              }\n            }\n            break;\n\n          case 'label':\n            for (const child of current.childNodes) {\n              if (child.nodeType === Node.TEXT_NODE || (child.nodeType === Node.ELEMENT_NODE && child.nodeName.toLowerCase() === 'label')) {\n                this.__value.appendChild(child.cloneNode());\n              }\n            }\n            break;\n\n          case 'both':\n            this.__value.innerHTML = current.innerHTML;\n            break;\n        }\n      }\n    },\n\n    _applyShow(show) {\n      if (this.getValue()) {\n        this._updateValue(this.getValue());\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'select',\n      class extends QxConnector {\n        static observedAttributes = ['show'];\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}