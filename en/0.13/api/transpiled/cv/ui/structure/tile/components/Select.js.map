{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "members",
    "__options",
    "__value",
    "__popup",
    "_init",
    "element",
    "_element",
    "Map",
    "popup",
    "document",
    "createElement",
    "classList",
    "add",
    "querySelectorAll",
    "forEach",
    "option",
    "i",
    "appendChild",
    "hasAttribute",
    "setAttribute",
    "set",
    "getAttribute",
    "value",
    "handle",
    "_writeAddresses",
    "length",
    "addEventListener",
    "ev",
    "onClicked",
    "style",
    "getComputedStyle",
    "target",
    "currentTarget",
    "tagName",
    "toLowerCase",
    "parentElement",
    "_sendSelection",
    "getPropertyValue",
    "display",
    "key",
    "predictive",
    "CustomEvent",
    "detail",
    "source",
    "filter",
    "addr",
    "address",
    "dispatchEvent",
    "setValue",
    "_updateValue",
    "mappedValue",
    "has",
    "innerHTML",
    "current",
    "get",
    "children",
    "child",
    "cloneNode",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "Select"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Select.js"
  ],
  "sourcesContent": [
    "/* Select.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Allows the selection of one element out of a list of <cv-option> elements\n */\nqx.Class.define('cv.ui.structure.tile.components.Select', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __options: null,\n    __value: null,\n    __popup: null,\n\n    _init() {\n      super._init();\n      const element = this._element;\n      this.__options = new Map();\n\n      const popup = (this.__popup = document.createElement('div'));\n      popup.classList.add('popup');\n      element.querySelectorAll(':scope > cv-option').forEach((option, i) => {\n        popup.appendChild(option);\n        if (!option.hasAttribute('key')) {\n          option.setAttribute('key', '' + i);\n        }\n        this.__options.set(option.getAttribute('key'), option);\n      });\n      const value = (this.__value = document.createElement('span'));\n      value.classList.add('value');\n      element.appendChild(value);\n      element.appendChild(popup);\n      const handle = document.createElement('cv-icon');\n      handle.classList.add('dropdown');\n      handle.classList.add('ri-arrow-down-s-line');\n      element.appendChild(handle);\n\n      if (this._writeAddresses.length > 0) {\n        element.addEventListener('click', ev => this.onClicked(ev));\n      }\n    },\n\n    onClicked(ev) {\n      const style = getComputedStyle(this.__popup);\n      let target = ev.target;\n      // find out event target (either the cv-select of cv-option\n      while (target !== ev.currentTarget && target.tagName.toLowerCase() !== 'cv-option') {\n        target = target.parentElement;\n      }\n      if (target.tagName.toLowerCase() === 'cv-option') {\n        // select this option\n        this._sendSelection(target.getAttribute('key'), true);\n      }\n      // open popup\n      if (style.getPropertyValue('display') === 'none') {\n        this.__popup.style.display = 'block';\n      } else {\n        this.__popup.style.display = 'none';\n      }\n    },\n\n    _sendSelection(key, predictive) {\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: key,\n          source: this\n        }\n      });\n\n      this._writeAddresses\n        .filter(addr => !addr.hasAttribute('on') || addr.getAttribute('on') === 'click')\n        .forEach(address => address.dispatchEvent(ev));\n      if (predictive === true) {\n        this.setValue(key);\n      }\n    },\n\n    _updateValue(mappedValue, value) {\n      if (this.__options.has(mappedValue)) {\n        this.__value.innerHTML = '';\n        const current = this.__options.get(mappedValue);\n        if (current.children.length > 0) {\n          // if we have non text children, we only use them (only icons no text)\n          for (const child of current.children) {\n            this.__value.appendChild(child.cloneNode());\n          }\n        } else {\n          this.__value.innerHTML = current.innerHTML;\n        }\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'select',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}