{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "include",
    "MPopup",
    "statics",
    "openedPopups",
    "members",
    "_closeButton",
    "_init",
    "popup",
    "_element",
    "closeable",
    "hasAttribute",
    "getAttribute",
    "document",
    "createElement",
    "classList",
    "add",
    "icon",
    "appendChild",
    "insertBefore",
    "firstChild",
    "addEventListener",
    "close",
    "ev",
    "header",
    "title",
    "textContent",
    "timeoutSeconds",
    "parseInt",
    "isNaN",
    "_autoCloseTimer",
    "event",
    "Timer",
    "addListener",
    "stop",
    "error",
    "open",
    "setAttribute",
    "registerModalPopup",
    "start",
    "removeAttribute",
    "unregisterModalPopup",
    "dispatchEvent",
    "CustomEvent",
    "onStateUpdate",
    "detail",
    "target",
    "state",
    "debug",
    "destruct",
    "_disposeObjects",
    "remove",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "widgets",
    "Popup"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/widgets/Popup.js"
  ],
  "sourcesContent": [
    "/* Popup.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Creates a popup that contains arbitrary content and can be opened as an overlay over the current UI.\n *\n * @author Tobias BrÃ¤utigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.widgets.Popup', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: cv.ui.structure.tile.MPopup,\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    openedPopups: []\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    _closeButton: null,\n\n    _init() {\n      super._init();\n      const popup = this._element;\n      const closeable = !popup.hasAttribute('closeable') || popup.getAttribute('closeable') === 'true';\n      if (closeable) {\n        this._closeButton = document.createElement('button');\n        this._closeButton.classList.add('close');\n        const icon = document.createElement('i');\n        icon.classList.add('ri-close-line');\n        this._closeButton.appendChild(icon);\n        popup.insertBefore(this._closeButton, popup.firstChild);\n        this._closeButton.addEventListener('click', () => this.close());\n      }\n      popup.addEventListener('close', ev => {\n        this.close();\n      });\n      if (popup.hasAttribute('title')) {\n        const header = document.createElement('header');\n        popup.insertBefore(header, popup.firstChild);\n        const title = document.createElement('h2');\n        title.textContent = popup.getAttribute('title');\n        header.appendChild(title);\n      }\n      if (popup.hasAttribute('auto-close-timeout')) {\n        const timeoutSeconds = parseInt(popup.getAttribute('auto-close-timeout'));\n\n        if (!isNaN(timeoutSeconds)) {\n          this._autoCloseTimer = new qx.event.Timer(timeoutSeconds * 1000);\n          this._autoCloseTimer.addListener('interval', () => {\n            this._autoCloseTimer.stop();\n            this.close();\n          });\n        } else {\n          this.error('invalid auto-close-timeout value:', popup.getAttribute('auto-close-timeout'));\n        }\n      }\n    },\n\n    open() {\n      const popup = this._element;\n      if (!popup.hasAttribute('open')) {\n        popup.setAttribute('open', '');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.registerModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.start();\n        }\n      }\n    },\n\n    close() {\n      const popup = this._element;\n      if (popup) {\n        popup.removeAttribute('open');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.unregisterModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.stop();\n        }\n        popup.dispatchEvent(new CustomEvent('closed'));\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget.\n     * The popup handles the special address-targets:\n     *  - open: opens the popup when the address value is 'true' or 1 => no auto closing\n     *  - close: closes the popup when the address value is 'false' or 0 => no auto opening\n     *  - open-close: the upper both combined => popup visibility fully dependent on the address value, auto-opening + auto-closing\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      if (!super.onStateUpdate(ev)) {\n        switch (ev.detail.target) {\n          case 'open':\n            if (ev.detail.state) {\n              this.open();\n            }\n            break;\n\n          case 'open-close':\n            if (ev.detail.state) {\n              this.open();\n            } else {\n              this.close();\n            }\n            break;\n\n          case 'close':\n            if (!ev.detail.state) {\n              this.close();\n            }\n            break;\n\n          default:\n            this.debug('unhandled address target', ev.detail.target);\n            break;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._disposeObjects('_autoCloseTimer');\n    if (this._closeButton) {\n      this._closeButton.remove();\n      this._closeButton = null;\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'popup',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}