{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "include",
    "MPopup",
    "statics",
    "openedPopups",
    "members",
    "_closeButton",
    "_init",
    "popup",
    "_element",
    "closeable",
    "hasAttribute",
    "getAttribute",
    "document",
    "createElement",
    "classList",
    "add",
    "icon",
    "appendChild",
    "insertBefore",
    "firstChild",
    "addEventListener",
    "close",
    "header",
    "title",
    "textContent",
    "timeoutSeconds",
    "parseInt",
    "isNaN",
    "_autoCloseTimer",
    "event",
    "Timer",
    "addListener",
    "stop",
    "error",
    "open",
    "setAttribute",
    "registerModalPopup",
    "start",
    "removeAttribute",
    "unregisterModalPopup",
    "dispatchEvent",
    "CustomEvent",
    "onStateUpdate",
    "ev",
    "detail",
    "target",
    "state",
    "debug",
    "destruct",
    "_disposeObjects",
    "remove",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "widgets",
    "Popup"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/widgets/Popup.js"
  ],
  "sourcesContent": [
    "/* Popup.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Creates a popup that contains arbitrary content and can be opened as an overlay over the current UI.\n *\n * @author Tobias BrÃ¤utigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.widgets.Popup', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: cv.ui.structure.tile.MPopup,\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    openedPopups: []\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    _closeButton: null,\n\n    _init() {\n      super._init();\n      const popup = this._element;\n      const closeable = !popup.hasAttribute('closeable') || popup.getAttribute('closeable') === 'true';\n      if (closeable) {\n        this._closeButton = document.createElement('button');\n        this._closeButton.classList.add('close');\n        const icon = document.createElement('i');\n        icon.classList.add('ri-close-line');\n        this._closeButton.appendChild(icon);\n        popup.insertBefore(this._closeButton, popup.firstChild);\n        this._closeButton.addEventListener('click', () => this.close());\n      }\n      if (popup.hasAttribute('title')) {\n        const header = document.createElement('header');\n        popup.insertBefore(header, popup.firstChild);\n        const title = document.createElement('h2');\n        title.textContent = popup.getAttribute('title');\n        header.appendChild(title);\n      }\n      if (popup.hasAttribute('auto-close-timeout')) {\n        const timeoutSeconds = parseInt(popup.getAttribute('auto-close-timeout'));\n\n        if (!isNaN(timeoutSeconds)) {\n          this._autoCloseTimer = new qx.event.Timer(timeoutSeconds * 1000);\n          this._autoCloseTimer.addListener('interval', () => {\n            this._autoCloseTimer.stop();\n            this.close();\n          });\n        } else {\n          this.error('invalid auto-close-timeout value:', popup.getAttribute('auto-close-timeout'));\n        }\n      }\n    },\n\n    open() {\n      const popup = this._element;\n      if (!popup.hasAttribute('open')) {\n        popup.setAttribute('open', '');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.registerModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.start();\n        }\n      }\n    },\n\n    close() {\n      const popup = this._element;\n      if (popup) {\n        popup.removeAttribute('open');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.unregisterModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.stop();\n        }\n        popup.dispatchEvent(new CustomEvent('closed'));\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget.\n     * The popup handles the special address-targets:\n     *  - open: opens the popup when the address value is 'true' or 1 => no auto closing\n     *  - close: closes the popup when the address value is 'false' or 0 => no auto opening\n     *  - open-close: the upper both combined => popup visibility fully dependent on the address value, auto-opening + auto-closing\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      if (!super.onStateUpdate(ev)) {\n        switch (ev.detail.target) {\n          case 'open':\n            if (ev.detail.state) {\n              this.open();\n            }\n            break;\n\n          case 'open-close':\n            if (ev.detail.state) {\n              this.open();\n            } else {\n              this.close();\n            }\n            break;\n\n          case 'close':\n            if (!ev.detail.state) {\n              this.close();\n            }\n            break;\n\n          default:\n            this.debug('unhandled address target', ev.detail.target);\n            break;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._disposeObjects('_autoCloseTimer');\n    if (this._closeButton) {\n      this._closeButton.remove();\n      this._closeButton = null;\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'popup',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}