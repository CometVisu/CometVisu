{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/widgets/Popup.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "include",
    "MPopup",
    "statics",
    "openedPopups",
    "members",
    "_init",
    "popup",
    "_element",
    "closeable",
    "hasAttribute",
    "getAttribute",
    "_closeButton",
    "document",
    "createElement",
    "classList",
    "add",
    "icon",
    "appendChild",
    "insertBefore",
    "firstChild",
    "addEventListener",
    "close",
    "timeoutSeconds",
    "parseInt",
    "isNaN",
    "_autoCloseTimer",
    "event",
    "Timer",
    "addListener",
    "stop",
    "error",
    "open",
    "setAttribute",
    "registerModalPopup",
    "start",
    "removeAttribute",
    "unregisterModalPopup",
    "dispatchEvent",
    "CustomEvent",
    "onStateUpdate",
    "ev",
    "detail",
    "target",
    "state",
    "debug",
    "destruct",
    "_disposeObjects",
    "remove",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "widgets",
    "Popup"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Popup.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Creates a popup that contains arbitrary content and can be opened as an overlay over the current UI.\n *\n * @author Tobias BrÃ¤utigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.widgets.Popup', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: cv.ui.structure.tile.MPopup,\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    openedPopups: []\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n\n    _init() {\n      this.base(arguments);\n      const popup = this._element;\n      const closeable = !popup.hasAttribute('closeable') || popup.getAttribute('closeable') === 'true';\n      if (closeable) {\n        this._closeButton = document.createElement('button');\n        this._closeButton.classList.add('close');\n        const icon = document.createElement('i');\n        icon.classList.add('ri-close-line');\n        this._closeButton.appendChild(icon);\n        popup.insertBefore(this._closeButton, popup.firstChild);\n        this._closeButton.addEventListener('click', () => this.close());\n      }\n      if (popup.hasAttribute('auto-close-timeout')) {\n        const timeoutSeconds = parseInt(popup.getAttribute('auto-close-timeout'));\n        if (!isNaN(timeoutSeconds)) {\n          this._autoCloseTimer = new qx.event.Timer(timeoutSeconds * 1000);\n          this._autoCloseTimer.addListener('interval', () => {\n            this._autoCloseTimer.stop();\n            this.close();\n          });\n        } else {\n          this.error('invalid auto-close-timeout value:', popup.getAttribute('auto-close-timeout'));\n        }\n      }\n    },\n\n    open() {\n      const popup = this._element;\n      if (!popup.hasAttribute('open')) {\n        popup.setAttribute('open', '');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.registerModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.start();\n        }\n      }\n    },\n\n    close() {\n      const popup = this._element;\n      if (popup) {\n        popup.removeAttribute('open');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.unregisterModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.stop();\n        }\n        popup.dispatchEvent(new CustomEvent('closed'));\n      }\n    },\n\n\n    /**\n     * Handles the incoming data from the backend for this widget.\n     * The popup handles the special address-targets:\n     *  - open: opens the popup when the address value is 'true' or 1 => no auto closing\n     *  - close: closes the popup when the address value is 'false' or 0 => no auto opening\n     *  - open-close: the upper both combined => popup visibility fully dependent on the address value, auto-opening + auto-closing\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      if (!this.base(arguments, ev)) {\n        switch (ev.detail.target) {\n          case 'open':\n            if (ev.detail.state) {\n              this.open();\n            }\n            break;\n\n          case 'open-close':\n            if (ev.detail.state) {\n              this.open();\n            } else {\n              this.close();\n            }\n            break;\n\n          case 'close':\n            if (!ev.detail.state) {\n              this.close();\n            }\n            break;\n\n          default:\n            this.debug('unhandled address target', ev.detail.target);\n            break;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_autoCloseTimer');\n    if (this._closeButton) {\n      this._closeButton.remove();\n      this._closeButton = null;\n    }\n  },\n\n  defer: function(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'popup', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n"
  ]
}