{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "members",
    "_currentState",
    "_init",
    "_this",
    "MenuAction",
    "superclass",
    "prototype",
    "call",
    "action",
    "_element",
    "getAttribute",
    "hasAddress",
    "_iterator",
    "_createForOfIteratorHelper",
    "querySelectorAll",
    "_step",
    "s",
    "n",
    "done",
    "address",
    "value",
    "addEventListener",
    "ev",
    "onStateUpdate",
    "stopPropagation",
    "err",
    "e",
    "f",
    "error",
    "querySelector",
    "onClick",
    "event",
    "popup",
    "getInstance",
    "open",
    "CustomEvent",
    "detail",
    "source",
    "_iterator2",
    "_step2",
    "dispatchEvent",
    "state",
    "elements",
    "Address",
    "addressElement",
    "getElement",
    "hasAttribute",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "_QxConnector",
    "_inherits",
    "_class",
    "_super",
    "_createSuper",
    "_classCallCheck",
    "_createClass",
    "QxConnector"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/MenuAction.js"
  ],
  "sourcesContent": [
    "/* ListItem.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Represents an action that should be executed when the related menu item has been clicked.\n */\nqx.Class.define('cv.ui.structure.tile.components.MenuAction', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _currentState: null,\n\n    _init() {\n      super._init();\n      const action = this._element.getAttribute('action');\n      switch (action) {\n        case 'toggleState': {\n          let hasAddress = false;\n          for (let address of this._element.querySelectorAll(':scope > cv-address')) {\n            hasAddress = true;\n            if (address.getAttribute('mode') !== 'write') {\n              this._element.addEventListener('stateUpdate', ev => {\n                this.onStateUpdate(ev);\n                // cancel event here\n                ev.stopPropagation();\n              });\n            }\n          }\n          if (!hasAddress) {\n            this.error('a cv-menu-item with action \"toggleState\" needs at least one cv-address to read the write the state,');\n          }\n          break;\n        }\n        case 'popup':\n          if (!this._element.querySelector(':scope > cv-popup')) {\n            this.error('a cv-menu-item with action \"popup\" must have a cv-popup as child.');\n          }\n          break;\n      }\n    },\n\n    onClick(event) {\n      switch (this._element.getAttribute('action')) {\n        case 'popup': {\n          const popup = this._element.querySelector(':scope > cv-popup');\n          if (popup) {\n            popup.getInstance().open();\n          }\n          event.stopPropagation();\n          break;\n        }\n        case 'toggleState': {\n          const ev = new CustomEvent('sendState', {\n            detail: {\n              value: !this._currentState,\n              source: this\n            }\n          });\n          for (let address of this._element.querySelectorAll(':scope > cv-address')) {\n            if (address.getAttribute('mode') !== 'read') {\n              address.dispatchEvent(ev);\n            }\n          }\n          event.stopPropagation();\n          break;\n        }\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      // noinspection EqualityComparisonWithCoercionJS\n      let value = ev.detail.state == '1';\n      if (ev.detail.source instanceof cv.ui.structure.tile.elements.Address) {\n        const addressElement = ev.detail.source.getElement();\n        if (addressElement.hasAttribute('value')) {\n          // noinspection EqualityComparisonWithCoercionJS\n          value = ev.detail.state == addressElement.getAttribute('value');\n        }\n      }\n      this._currentState = value;\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'menu-item',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}