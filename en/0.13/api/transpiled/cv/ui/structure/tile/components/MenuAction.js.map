{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "members",
    "_currentState",
    "_init",
    "action",
    "_element",
    "getAttribute",
    "hasAddress",
    "querySelectorAll",
    "address",
    "addEventListener",
    "ev",
    "onStateUpdate",
    "stopPropagation",
    "error",
    "querySelector",
    "onClick",
    "event",
    "popup",
    "getInstance",
    "open",
    "CustomEvent",
    "detail",
    "value",
    "source",
    "dispatchEvent",
    "state",
    "elements",
    "Address",
    "addressElement",
    "getElement",
    "hasAttribute",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "MenuAction"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/MenuAction.js"
  ],
  "sourcesContent": [
    "/* ListItem.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Represents an action that should be executed when the related menu item has been clicked.\n */\nqx.Class.define('cv.ui.structure.tile.components.MenuAction', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _currentState: null,\n\n    _init() {\n      super._init();\n      const action = this._element.getAttribute('action');\n      switch (action) {\n        case 'toggleState': {\n          let hasAddress = false;\n          for (let address of this._element.querySelectorAll(':scope > cv-address')) {\n            hasAddress = true;\n            if (address.getAttribute('mode') !== 'write') {\n              this._element.addEventListener('stateUpdate', ev => {\n                this.onStateUpdate(ev);\n                // cancel event here\n                ev.stopPropagation();\n              });\n            }\n          }\n          if (!hasAddress) {\n            this.error('a cv-menu-item with action \"toggleState\" needs at least one cv-address to read the write the state,');\n          }\n          break;\n        }\n        case 'popup':\n          if (!this._element.querySelector(':scope > cv-popup')) {\n            this.error('a cv-menu-item with action \"popup\" must have a cv-popup as child.');\n          }\n          break;\n      }\n    },\n\n    onClick(event) {\n      switch (this._element.getAttribute('action')) {\n        case 'popup': {\n          const popup = this._element.querySelector(':scope > cv-popup');\n          if (popup) {\n            popup.getInstance().open();\n          }\n          event.stopPropagation();\n          break;\n        }\n        case 'toggleState': {\n          const ev = new CustomEvent('sendState', {\n            detail: {\n              value: !this._currentState,\n              source: this\n            }\n          });\n          for (let address of this._element.querySelectorAll(':scope > cv-address')) {\n            if (address.getAttribute('mode') !== 'read') {\n              address.dispatchEvent(ev);\n            }\n          }\n          event.stopPropagation();\n          break;\n        }\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      // noinspection EqualityComparisonWithCoercionJS\n      let value = ev.detail.state == '1';\n      if (ev.detail.source instanceof cv.ui.structure.tile.elements.Address) {\n        const addressElement = ev.detail.source.getElement();\n        if (addressElement.hasAttribute('value')) {\n          // noinspection EqualityComparisonWithCoercionJS\n          value = ev.detail.state == addressElement.getAttribute('value');\n        }\n      }\n      this._currentState = value;\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'menu-item',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}