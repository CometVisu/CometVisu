{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "members",
    "_currentState",
    "_init",
    "action",
    "_element",
    "getAttribute",
    "hasAddress",
    "querySelectorAll",
    "address",
    "addEventListener",
    "ev",
    "onStateUpdate",
    "stopPropagation",
    "error",
    "querySelector",
    "onClick",
    "event",
    "popup",
    "getInstance",
    "open",
    "CustomEvent",
    "detail",
    "value",
    "source",
    "dispatchEvent",
    "state",
    "elements",
    "Address",
    "addressElement",
    "getElement",
    "hasAttribute",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "MenuAction"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/MenuAction.js"
  ],
  "sourcesContent": [
    "/* ListItem.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Represents an action that should be executed when the related menu item has been clicked.\n */\nqx.Class.define('cv.ui.structure.tile.components.MenuAction', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _currentState: null,\n\n    _init() {\n      super._init();\n      const action = this._element.getAttribute('action');\n      switch (action) {\n        case 'toggleState': {\n          let hasAddress = false;\n          for (let address of this._element.querySelectorAll(':scope > cv-address')) {\n            hasAddress = true;\n            if (address.getAttribute('mode') !== 'write') {\n              this._element.addEventListener('stateUpdate', ev => {\n                this.onStateUpdate(ev);\n                // cancel event here\n                ev.stopPropagation();\n              });\n            }\n          }\n          if (!hasAddress) {\n            this.error('a cv-menu-item with action \"toggleState\" needs at least one cv-address to read the write the state,');\n          }\n          break;\n        }\n        case 'popup':\n          if (!this._element.querySelector(':scope > cv-popup')) {\n            this.error('a cv-menu-item with action \"popup\" must have a cv-popup as child.');\n          }\n          break;\n      }\n    },\n\n    onClick(event) {\n      switch (this._element.getAttribute('action')) {\n        case 'popup': {\n          const popup = this._element.querySelector(':scope > cv-popup');\n          if (popup) {\n            popup.getInstance().open();\n          }\n          event.stopPropagation();\n          break;\n        }\n        case 'toggleState': {\n          const ev = new CustomEvent('sendState', {\n            detail: {\n              value: !this._currentState,\n              source: this\n            }\n          });\n          for (let address of this._element.querySelectorAll(':scope > cv-address')) {\n            if (address.getAttribute('mode') !== 'read') {\n              address.dispatchEvent(ev);\n            }\n          }\n          event.stopPropagation();\n          break;\n        }\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      // noinspection EqualityComparisonWithCoercionJS\n      let value = ev.detail.state == '1';\n      if (ev.detail.source instanceof cv.ui.structure.tile.elements.Address) {\n        const addressElement = ev.detail.source.getElement();\n        if (addressElement.hasAttribute('value')) {\n          // noinspection EqualityComparisonWithCoercionJS\n          value = ev.detail.state == addressElement.getAttribute('value');\n        }\n      }\n      this._currentState = value;\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'menu-item',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}