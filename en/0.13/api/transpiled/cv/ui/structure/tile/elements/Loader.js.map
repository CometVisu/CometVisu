{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Loader.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "elements",
    "AbstractCustomElement",
    "members",
    "_init",
    "element",
    "_element",
    "type",
    "getAttribute",
    "src",
    "loaderElement",
    "document",
    "createElement",
    "setAttribute",
    "loadXml",
    "appendChild",
    "uri",
    "ajaxRequest",
    "io",
    "request",
    "Xhr",
    "set",
    "accept",
    "cache",
    "Config",
    "forceReload",
    "addListenerOnce",
    "e",
    "content",
    "getTarget",
    "getResponse",
    "htmlContent",
    "target",
    "Application",
    "structureController",
    "getRenderTarget",
    "documentElement",
    "xmlns",
    "text",
    "getResponseText",
    "replace",
    "parser",
    "DOMParser",
    "parseFromString",
    "child",
    "firstElementChild",
    "registerTemplates",
    "addListener",
    "status",
    "getTransport",
    "util",
    "Request",
    "isSuccessful",
    "handleError",
    "getUrl",
    "send",
    "textStatus",
    "additionalErrorInfo",
    "title",
    "locale",
    "Manager",
    "tr",
    "translate",
    "toString",
    "message",
    "actions",
    "notification",
    "topic",
    "core",
    "notifications",
    "Router",
    "dispatchMessage",
    "error",
    "defer",
    "Clazz",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "Loader"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAH,EAAAA,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,sCAAhB,EAAwD;AACtDC,IAAAA,MAAM,EAAEC,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBC,IAAhB,CAAqBC,QAArB,CAA8BC,qBADgB;;AAGtD;AACF;AACA;AACA;AACA;AACEC,IAAAA,OAAO,EAAE;AAEPC,MAAAA,KAFO,mBAEC;AACN,YAAMC,OAAO,GAAG,KAAKC,QAArB;AACA,YAAMC,IAAI,GAAGF,OAAO,CAACG,YAAR,CAAqB,MAArB,CAAb;AACA,YAAMC,GAAG,GAAGJ,OAAO,CAACG,YAAR,CAAqB,KAArB,CAAZ;AACA,YAAIE,aAAJ;;AACA,YAAID,GAAJ,EAAS;AACP,kBAAQF,IAAR;AACE,iBAAK,KAAL;AACEG,cAAAA,aAAa,GAAGC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAhB;AACAF,cAAAA,aAAa,CAACG,YAAd,CAA2B,MAA3B,EAAmC,UAAnC;AACAH,cAAAA,aAAa,CAACG,YAAd,CAA2B,KAA3B,EAAkC,YAAlC;AACAH,cAAAA,aAAa,CAACG,YAAd,CAA2B,MAA3B,EAAmCJ,GAAnC;AACA;;AAEF,iBAAK,IAAL;AACEC,cAAAA,aAAa,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAhB;AACAF,cAAAA,aAAa,CAACG,YAAd,CAA2B,MAA3B,EAAmC,iBAAnC;AACAH,cAAAA,aAAa,CAACG,YAAd,CAA2B,KAA3B,EAAkCJ,GAAlC;AACA;;AAEF,iBAAK,WAAL;AACE,mBAAKK,OAAL,CAAaL,GAAb,EAAkBF,IAAlB;AACA;AAhBJ;;AAmBA,cAAIG,aAAJ,EAAmB;AACjBL,YAAAA,OAAO,CAACU,WAAR,CAAoBL,aAApB;AACD;AACF;AACF,OA/BM;AAiCPI,MAAAA,OAjCO,mBAiCCE,GAjCD,EAiCM;AACX,YAAMC,WAAW,GAAG,IAAI3B,EAAE,CAAC4B,EAAH,CAAMC,OAAN,CAAcC,GAAlB,CAAsBJ,GAAtB,CAApB;AACAC,QAAAA,WAAW,CAACI,GAAZ,CAAgB;AACdC,UAAAA,MAAM,EAAE,iBADM;AAEdC,UAAAA,KAAK,EAAE,CAAC1B,EAAE,CAAC2B,MAAH,CAAUC;AAFJ,SAAhB;AAIAR,QAAAA,WAAW,CAACS,eAAZ,CAA4B,SAA5B,EAAuC,UAAUC,CAAV,EAAa;AAClD,cAAIC,OAAO,GAAGD,CAAC,CAACE,SAAF,GAAcC,WAAd,EAAd;AACA,cAAIC,WAAW,GAAGH,OAAlB;AACA,cAAMI,MAAM,GAAGnC,EAAE,CAACoC,WAAH,CAAeC,mBAAf,CAAmCC,eAAnC,EAAf,CAHkD,CAIlD;;AACA,cAAI,CAACJ,WAAW,CAACK,eAAZ,CAA4BC,KAAjC,EAAwC;AACtC,gBAAIC,IAAI,GAAGX,CAAC,CAACE,SAAF,GAAcU,eAAd,EAAX;AACAD,YAAAA,IAAI,GAAGA,IAAI,CAACE,OAAL,CAAa,YAAb,EAA2B,iDAA3B,CAAP;AACA,gBAAMC,MAAM,GAAG,IAAIC,SAAJ,EAAf;AACAX,YAAAA,WAAW,GAAGU,MAAM,CAACE,eAAP,CAAuBL,IAAvB,EAA6B,UAA7B,CAAd;AACD;;AACD,cAAIM,KAAJ;;AACA,iBAAQA,KAAK,GAAGb,WAAW,CAACK,eAAZ,CAA4BS,iBAA5C,EAAgE;AAC9Db,YAAAA,MAAM,CAACjB,WAAP,CAAmB6B,KAAnB;AACD,WAdiD,CAelD;;;AACA/C,UAAAA,EAAE,CAACoC,WAAH,CAAeC,mBAAf,CAAmCY,iBAAnC,CAAqDlB,OAArD;AACD,SAjBD;AAkBAX,QAAAA,WAAW,CAAC8B,WAAZ,CAAwB,aAAxB,EAAuC,UAAUpB,CAAV,EAAa;AAClD,cAAMqB,MAAM,GAAGrB,CAAC,CAACE,SAAF,GAAcoB,YAAd,GAA6BD,MAA5C;;AACA,cAAI,CAAC1D,EAAE,CAAC4D,IAAH,CAAQC,OAAR,CAAgBC,YAAhB,CAA6BJ,MAA7B,CAAL,EAA2C;AACzC,iBAAKK,WAAL,CAAiB,cAAjB,EAAiCpC,WAAW,CAACqC,MAAZ,EAAjC;AACD,WAFD,MAEO;AACL,iBAAKD,WAAL,CAAiBL,MAAjB,EAAyB,IAAzB;AACD;AACF,SAPD,EAOG,IAPH;AASA/B,QAAAA,WAAW,CAACsC,IAAZ;AACD,OAnEM;AAqEPF,MAAAA,WArEO,uBAqEKG,UArEL,EAqEiBC,mBArEjB,EAqEsC;AAC3C,YAAMC,KAAK,GAAGpE,EAAE,CAACqE,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,aAArB,EAAoCC,SAApC,GAAgDC,QAAhD,EAAd;AACA,YAAIC,OAAO,GAAG,EAAd;AACA,YAAIC,OAAJ;;AACA,gBAAQT,UAAR;AACE,eAAK,aAAL;AACEQ,YAAAA,OAAO,GAAG1E,EAAE,CAACqE,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,mBAArB,CAAV;AACA;;AACF,eAAK,cAAL;AACEG,YAAAA,OAAO,GAAG1E,EAAE,CAACqE,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,0BAArB,EAAiDJ,mBAAjD,EAAsEK,SAAtE,GAAkFC,QAAlF,EAAV;AACA;;AACF;AACEC,YAAAA,OAAO,GAAG1E,EAAE,CAACqE,MAAH,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,8BAArB,EAAqDL,UAArD,EAAiEM,SAAjE,GAA6EC,QAA7E,EAAV;;AACA,gBAAIN,mBAAJ,EAAyB;AACvBO,cAAAA,OAAO,IAAI,OAAOP,mBAAlB;AACD,aAFD,MAEO;AACLO,cAAAA,OAAO,IAAI,GAAX;AACD;;AAbL;;AAeA,YAAME,YAAY,GAAG;AACnBC,UAAAA,KAAK,EAAE,UADY;AAEnBT,UAAAA,KAAK,EAAEA,KAFY;AAGnBM,UAAAA,OAAO,EAAEA;AAHU,SAArB;;AAKA,YAAIC,OAAJ,EAAa;AACXC,UAAAA,YAAY,CAACD,OAAb,GAAuBA,OAAvB;AACD;;AACDpE,QAAAA,EAAE,CAACuE,IAAH,CAAQC,aAAR,CAAsBC,MAAtB,CAA6BC,eAA7B,CAA6CL,YAAY,CAACC,KAA1D,EAAiED,YAAjE;AACA,aAAKM,KAAL,CAAW,IAAX,EAAiBR,OAAO,CAACD,QAAR,EAAjB;AACD;AAlGM,KAR6C;AA6GtDU,IAAAA,KA7GsD,iBA6GhDC,KA7GgD,EA6GzC;AACXC,MAAAA,cAAc,CAAChF,MAAf,CAAsBE,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBC,IAAhB,CAAqB4E,UAArB,CAAgCC,MAAhC,GAAyC,QAA/D;AAAA;;AAAA;;AAAA;;AACE,0BAAc;AAAA;;AAAA,mCACNH,KADM;AAEb;;AAHH;AAAA,QAAuFI,WAAvF;AAKD;AAnHqD,GAAxD;AAzBAjF,EAAAA,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBC,IAAhB,CAAqBC,QAArB,CAA8B8E,MAA9B,CAAqCtF,aAArC,GAAqDA,aAArD",
  "sourcesContent": [
    "/* Loader.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Loads external content like CSS/JS files, config-content or a template file.\n *\n *  @author Tobias Br√§utigam\n *  @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.elements.Loader', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _init() {\n      const element = this._element;\n      const type = element.getAttribute('type');\n      const src = element.getAttribute('src');\n      let loaderElement;\n      if (src) {\n        switch (type) {\n          case 'css':\n            loaderElement = document.createElement('link');\n            loaderElement.setAttribute('type', 'text/css');\n            loaderElement.setAttribute('rel', 'stylesheet');\n            loaderElement.setAttribute('href', src);\n            break;\n\n          case 'js':\n            loaderElement = document.createElement('script');\n            loaderElement.setAttribute('type', 'text/javascript');\n            loaderElement.setAttribute('src', src);\n            break;\n\n          case 'templates':\n            this.loadXml(src, type);\n            break;\n        }\n\n        if (loaderElement) {\n          element.appendChild(loaderElement);\n        }\n      }\n    },\n\n    loadXml(uri) {\n      const ajaxRequest = new qx.io.request.Xhr(uri);\n      ajaxRequest.set({\n        accept: 'application/xml',\n        cache: !cv.Config.forceReload\n      });\n      ajaxRequest.addListenerOnce('success', function (e) {\n        let content = e.getTarget().getResponse();\n        let htmlContent = content;\n        const target = cv.Application.structureController.getRenderTarget();\n        // we need the documents to be in HTML namespace\n        if (!htmlContent.documentElement.xmlns) {\n          let text = e.getTarget().getResponseText();\n          text = text.replace('<templates', '<templates xmlns=\"http://www.w3.org/1999/xhtml\"');\n          const parser = new DOMParser();\n          htmlContent = parser.parseFromString(text, 'text/xml');\n        }\n        let child;\n        while ((child = htmlContent.documentElement.firstElementChild)) {\n          target.appendChild(child);\n        }\n        // register custom elements for templates in this document\n        cv.Application.structureController.registerTemplates(content);\n      });\n      ajaxRequest.addListener('statusError', function (e) {\n        const status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status)) {\n          this.handleError('filenotfound', ajaxRequest.getUrl());\n        } else {\n          this.handleError(status, null);\n        }\n      }, this);\n\n      ajaxRequest.send();\n    },\n\n    handleError(textStatus, additionalErrorInfo) {\n      const title = qx.locale.Manager.tr('File Error!').translate().toString();\n      let message = '';\n      let actions;\n      switch (textStatus) {\n        case 'parsererror':\n          message = qx.locale.Manager.tr('Invalid XML file!');\n          break;\n        case 'filenotfound':\n          message = qx.locale.Manager.tr('404: File not found, %1.', additionalErrorInfo).translate().toString();\n          break;\n        default:\n          message = qx.locale.Manager.tr('Unhandled error of type \"%1\"', textStatus).translate().toString();\n          if (additionalErrorInfo) {\n            message += ': ' + additionalErrorInfo;\n          } else {\n            message += '.';\n          }\n      }\n      const notification = {\n        topic: 'cv.error',\n        title: title,\n        message: message\n      };\n      if (actions) {\n        notification.actions = actions;\n      }\n      cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n      this.error(this, message.toString());\n    }\n  },\n\n  defer(Clazz) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'loader', class extends QxConnector {\n      constructor() {\n        super(Clazz);\n      }\n    });\n  }\n});\n"
  ]
}