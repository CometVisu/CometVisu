{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "elements",
    "AbstractCustomElement",
    "members",
    "_init",
    "element",
    "_element",
    "type",
    "getAttribute",
    "src",
    "loaderElement",
    "document",
    "createElement",
    "setAttribute",
    "loadXml",
    "appendChild",
    "uri",
    "ajaxRequest",
    "io",
    "request",
    "Xhr",
    "set",
    "accept",
    "cache",
    "Config",
    "forceReload",
    "addListenerOnce",
    "e",
    "content",
    "getTarget",
    "getResponse",
    "htmlContent",
    "target",
    "Application",
    "structureController",
    "getRenderTarget",
    "documentElement",
    "xmlns",
    "text",
    "getResponseText",
    "replace",
    "parser",
    "DOMParser",
    "parseFromString",
    "child",
    "firstElementChild",
    "registerTemplates",
    "addListener",
    "status",
    "getTransport",
    "util",
    "Request",
    "isSuccessful",
    "handleError",
    "getUrl",
    "send",
    "textStatus",
    "additionalErrorInfo",
    "title",
    "locale",
    "Manager",
    "tr",
    "translate",
    "toString",
    "message",
    "actions",
    "notification",
    "topic",
    "core",
    "notifications",
    "Router",
    "dispatchMessage",
    "error",
    "defer",
    "Clazz",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "Loader"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Loader.js"
  ],
  "sourcesContent": [
    "/* Loader.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Loads external content like CSS/JS files, config-content or a template file.\n *\n *  @author Tobias Br√§utigam\n *  @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.elements.Loader', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _init() {\n      const element = this._element;\n      const type = element.getAttribute('type');\n      const src = element.getAttribute('src');\n      let loaderElement;\n      if (src) {\n        switch (type) {\n          case 'css':\n            loaderElement = document.createElement('link');\n            loaderElement.setAttribute('type', 'text/css');\n            loaderElement.setAttribute('rel', 'stylesheet');\n            loaderElement.setAttribute('href', src);\n            break;\n\n          case 'js':\n            loaderElement = document.createElement('script');\n            loaderElement.setAttribute('type', 'text/javascript');\n            loaderElement.setAttribute('src', src);\n            break;\n\n          case 'templates':\n            this.loadXml(src, type);\n            break;\n        }\n\n        if (loaderElement) {\n          element.appendChild(loaderElement);\n        }\n      }\n    },\n\n    loadXml(uri) {\n      const ajaxRequest = new qx.io.request.Xhr(uri);\n      ajaxRequest.set({\n        accept: 'application/xml',\n        cache: !cv.Config.forceReload\n      });\n\n      ajaxRequest.addListenerOnce('success', function (e) {\n        let content = e.getTarget().getResponse();\n        let htmlContent = content;\n        const target = cv.Application.structureController.getRenderTarget();\n        // we need the documents to be in HTML namespace\n        if (!htmlContent.documentElement.xmlns) {\n          let text = e.getTarget().getResponseText();\n          text = text.replace('<templates', '<templates xmlns=\"http://www.w3.org/1999/xhtml\"');\n\n          const parser = new DOMParser();\n          htmlContent = parser.parseFromString(text, 'text/xml');\n        }\n        let child;\n        while ((child = htmlContent.documentElement.firstElementChild)) {\n          target.appendChild(child);\n        }\n        // register custom elements for templates in this document\n        cv.Application.structureController.registerTemplates(content);\n      });\n      ajaxRequest.addListener('statusError', e => {\n        const status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status)) {\n          this.handleError('filenotfound', ajaxRequest.getUrl());\n        } else {\n          this.handleError(status, null);\n        }\n      });\n\n      ajaxRequest.send();\n    },\n\n    handleError(textStatus, additionalErrorInfo) {\n      const title = qx.locale.Manager.tr('File Error!').translate().toString();\n      let message = '';\n      let actions;\n      switch (textStatus) {\n        case 'parsererror':\n          message = qx.locale.Manager.tr('Invalid XML file!');\n          break;\n        case 'filenotfound':\n          message = qx.locale.Manager.tr('404: File not found, %1.', additionalErrorInfo).translate().toString();\n          break;\n        default:\n          message = qx.locale.Manager.tr('Unhandled error of type \"%1\"', textStatus).translate().toString();\n          if (additionalErrorInfo) {\n            message += ': ' + additionalErrorInfo;\n          } else {\n            message += '.';\n          }\n      }\n\n      const notification = {\n        topic: 'cv.error',\n        title: title,\n        message: message\n      };\n\n      if (actions) {\n        notification.actions = actions;\n      }\n      cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n\n      this.error(this, message.toString());\n    }\n  },\n\n  defer(Clazz) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'loader',\n      class extends QxConnector {\n        constructor() {\n          super(Clazz);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}