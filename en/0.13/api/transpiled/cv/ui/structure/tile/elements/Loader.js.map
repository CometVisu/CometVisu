{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "elements",
    "AbstractCustomElement",
    "members",
    "_init",
    "element",
    "_element",
    "type",
    "getAttribute",
    "src",
    "loaderElement",
    "document",
    "createElement",
    "setAttribute",
    "loadXml",
    "appendChild",
    "uri",
    "ajaxRequest",
    "io",
    "request",
    "Xhr",
    "set",
    "accept",
    "cache",
    "Config",
    "forceReload",
    "addListenerOnce",
    "e",
    "content",
    "getTarget",
    "getResponse",
    "htmlContent",
    "target",
    "Application",
    "structureController",
    "getRenderTarget",
    "documentElement",
    "xmlns",
    "text",
    "getResponseText",
    "replace",
    "parser",
    "DOMParser",
    "parseFromString",
    "child",
    "firstElementChild",
    "registerTemplates",
    "addListener",
    "status",
    "getTransport",
    "util",
    "Request",
    "isSuccessful",
    "handleError",
    "getUrl",
    "send",
    "textStatus",
    "additionalErrorInfo",
    "title",
    "locale",
    "Manager",
    "tr",
    "translate",
    "toString",
    "message",
    "actions",
    "notification",
    "topic",
    "core",
    "notifications",
    "Router",
    "dispatchMessage",
    "error",
    "defer",
    "Clazz",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector",
    "Loader"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Loader.js"
  ],
  "sourcesContent": [
    "/* Loader.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Loads external content like CSS/JS files, config-content or a template file.\n *\n *  @author Tobias Br√§utigam\n *  @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.elements.Loader', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _init() {\n      const element = this._element;\n      const type = element.getAttribute('type');\n      const src = element.getAttribute('src');\n      let loaderElement;\n      if (src) {\n        switch (type) {\n          case 'css':\n            loaderElement = document.createElement('link');\n            loaderElement.setAttribute('type', 'text/css');\n            loaderElement.setAttribute('rel', 'stylesheet');\n            loaderElement.setAttribute('href', src);\n            break;\n\n          case 'js':\n            loaderElement = document.createElement('script');\n            loaderElement.setAttribute('type', 'text/javascript');\n            loaderElement.setAttribute('src', src);\n            break;\n\n          case 'templates':\n            this.loadXml(src, type);\n            break;\n        }\n\n        if (loaderElement) {\n          element.appendChild(loaderElement);\n        }\n      }\n    },\n\n    loadXml(uri) {\n      const ajaxRequest = new qx.io.request.Xhr(uri);\n      ajaxRequest.set({\n        accept: 'application/xml',\n        cache: !cv.Config.forceReload\n      });\n\n      ajaxRequest.addListenerOnce('success', function (e) {\n        let content = e.getTarget().getResponse();\n        let htmlContent = content;\n        const target = cv.Application.structureController.getRenderTarget();\n        // we need the documents to be in HTML namespace\n        if (!htmlContent.documentElement.xmlns) {\n          let text = e.getTarget().getResponseText();\n          text = text.replace('<templates', '<templates xmlns=\"http://www.w3.org/1999/xhtml\"');\n\n          const parser = new DOMParser();\n          htmlContent = parser.parseFromString(text, 'text/xml');\n        }\n        let child;\n        while ((child = htmlContent.documentElement.firstElementChild)) {\n          target.appendChild(child);\n        }\n        // register custom elements for templates in this document\n        cv.Application.structureController.registerTemplates(content);\n      });\n      ajaxRequest.addListener('statusError', e => {\n        const status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status)) {\n          this.handleError('filenotfound', ajaxRequest.getUrl());\n        } else {\n          this.handleError(status, null);\n        }\n      });\n\n      ajaxRequest.send();\n    },\n\n    handleError(textStatus, additionalErrorInfo) {\n      const title = qx.locale.Manager.tr('File Error!').translate().toString();\n      let message = '';\n      let actions;\n      switch (textStatus) {\n        case 'parsererror':\n          message = qx.locale.Manager.tr('Invalid XML file!');\n          break;\n        case 'filenotfound':\n          message = qx.locale.Manager.tr('404: File not found, %1.', additionalErrorInfo).translate().toString();\n          break;\n        default:\n          message = qx.locale.Manager.tr('Unhandled error of type \"%1\"', textStatus).translate().toString();\n          if (additionalErrorInfo) {\n            message += ': ' + additionalErrorInfo;\n          } else {\n            message += '.';\n          }\n      }\n\n      const notification = {\n        topic: 'cv.error',\n        title: title,\n        message: message\n      };\n\n      if (actions) {\n        notification.actions = actions;\n      }\n      cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n\n      this.error(this, message.toString());\n    }\n  },\n\n  defer(Clazz) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'loader',\n      class extends QxConnector {\n        constructor() {\n          super(Clazz);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}