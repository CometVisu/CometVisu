{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "components",
    "AbstractComponent",
    "include",
    "MVisibility",
    "MRefresh",
    "MResize",
    "statics",
    "ChartCounter",
    "DEFAULT_ASPECT_RATIO",
    "JS_LOADED",
    "Promise",
    "resolve",
    "reject",
    "check",
    "window",
    "d3",
    "util",
    "ScriptLoader",
    "includeScript",
    "ResourceManager",
    "getInstance",
    "toUri",
    "timer",
    "event",
    "Timer",
    "counter",
    "addListener",
    "Error",
    "then",
    "locale",
    "Manager",
    "getLanguage",
    "formatDefaultLocale",
    "decimal",
    "Number",
    "getDecimalSeparator",
    "translate",
    "toString",
    "thousands",
    "getGroupSeparator",
    "grouping",
    "currency",
    "timeFormatDefaultLocale",
    "dateTime",
    "date",
    "time",
    "periods",
    "Date",
    "getAmMarker",
    "getPmMarker",
    "days",
    "getDayNames",
    "map",
    "t",
    "shortDays",
    "months",
    "getMonthNames",
    "shortMonths",
    "CONFIG",
    "properties",
    "currentSeries",
    "init",
    "apply",
    "currentPeriod",
    "members",
    "_id",
    "_downloadedImage",
    "_url",
    "_headers",
    "_request",
    "_width",
    "_height",
    "_loaded",
    "_dataSetConfigs",
    "_initializing",
    "_navigationEnabled",
    "__toolTipTimer",
    "__showTooltip",
    "__debouncedOnResize",
    "__resizeTimeout",
    "_dot",
    "_svg",
    "_tooltip",
    "_titleString",
    "__helpers",
    "__config",
    "_chartConf",
    "_init",
    "_checkIfWidget",
    "element",
    "_element",
    "Chart",
    "isVisible",
    "_loadData",
    "chartId",
    "setAttribute",
    "inBackground",
    "hasAttribute",
    "getAttribute",
    "title",
    "getHeader",
    "document",
    "createElement",
    "classList",
    "add",
    "span",
    "appendChild",
    "textContent",
    "appendToHeader",
    "trim",
    "seriesSelection",
    "s",
    "split",
    "n",
    "toLowerCase",
    "setCurrentSeries",
    "getCurrentSeries",
    "length",
    "includes",
    "push",
    "button",
    "_buttonFactory",
    "tr",
    "addEventListener",
    "_onSeriesPrev",
    "parentElement",
    "insertBefore",
    "i",
    "popup",
    "option",
    "_seriesToShort",
    "ev",
    "style",
    "display",
    "_onSeriesChange",
    "target",
    "stopPropagation",
    "preventDefault",
    "getComputedStyle",
    "getPropertyValue",
    "disabled",
    "_onSeriesNext",
    "popupAddress",
    "data",
    "Model",
    "onUpdate",
    "tileAddress",
    "parent",
    "nodeName",
    "tileWidget",
    "onStateUpdate",
    "body",
    "contains",
    "_onRendered",
    "setRefresh",
    "parseInt",
    "svg",
    "select",
    "append",
    "noToolTips",
    "on",
    "_onPointerEntered",
    "bind",
    "_onPointerMoved",
    "_onPointerLeft",
    "y",
    "targetTouches",
    "clientY",
    "_helpers",
    "linePath",
    "pathRect",
    "node",
    "getBoundingClientRect",
    "height",
    "passive",
    "format",
    "timeFormat",
    "formatString",
    "multiTimeFormat",
    "d",
    "getSeconds",
    "getMinutes",
    "getHours",
    "getDay",
    "getDate",
    "getMonth",
    "x",
    "value",
    "z",
    "src",
    "color",
    "String",
    "sprintf",
    "curve",
    "curveLinear",
    "marginTop",
    "marginRight",
    "marginBottom",
    "marginLeft",
    "width",
    "aspectRatio",
    "xType",
    "scaleTime",
    "xFormat",
    "yType",
    "scaleLinear",
    "yFormat",
    "undefined",
    "yLabel",
    "strokeLinecap",
    "strokeLinejoin",
    "strokeWidth",
    "strokeOpacity",
    "mixBlendMode",
    "showArea",
    "showXAxis",
    "showYAxis",
    "xPadding",
    "__updateTitle",
    "datasetSources",
    "Array",
    "from",
    "querySelectorAll",
    "elem",
    "readAddresses",
    "filter",
    "targetDataset",
    "querySelector",
    "detail",
    "config",
    "ts",
    "now",
    "aggregationInterval",
    "mins",
    "Math",
    "round",
    "_renderChart",
    "state",
    "setCurrentPeriod",
    "getCurrentPeriod",
    "resetCurrentPeriod",
    "refresh",
    "_refreshData",
    "nextButton",
    "removeAttribute",
    "client",
    "io",
    "BackendConnections",
    "getClient",
    "url",
    "dataSets",
    "series",
    "start",
    "end",
    "interval",
    "promises",
    "dataSet",
    "chartType",
    "attr",
    "name",
    "attributes",
    "item",
    "part",
    "substring",
    "toUpperCase",
    "join",
    "test",
    "parseFloat",
    "getResourcePath",
    "debug",
    "Fetch",
    "cachedFetch",
    "ttl",
    "getRefresh",
    "hasCustomChartsDataProcessor",
    "processChartsData",
    "_lastRefresh",
    "err",
    "_onStatusError",
    "all",
    "responses",
    "_onSuccess",
    "chartData",
    "entry",
    "tsdata",
    "Object",
    "assign",
    "localName",
    "overflow",
    "requestAnimationFrame",
    "setTimeout",
    "retries",
    "clearTimeout",
    "_getSize",
    "padding",
    "containerWidth",
    "offsetWidth",
    "containerHeight",
    "offsetHeight",
    "factor",
    "landscape",
    "formatsArray",
    "multiFormat",
    "found",
    "fmt",
    "key",
    "core",
    "notifications",
    "Router",
    "dispatchMessage",
    "severity",
    "message",
    "JSON",
    "stringify",
    "error",
    "_getSvgElement",
    "classes",
    "empty",
    "single",
    "X",
    "Y",
    "Z",
    "O",
    "T",
    "shift",
    "xDomain",
    "extent",
    "minVal",
    "min",
    "maxVal",
    "max",
    "yDomain",
    "zDomain",
    "InternSet",
    "I",
    "range",
    "has",
    "maxValue",
    "toFixed",
    "xTicks",
    "yTicks",
    "additionalXRangePadding",
    "xRange",
    "yRange",
    "xAxis",
    "axisBottom",
    "ticks",
    "tickSizeOuter",
    "tickFormat",
    "yAxis",
    "axisLeft",
    "showGrid",
    "xGrid",
    "tickSize",
    "transform",
    "call",
    "yGrid",
    "yAxisElement",
    "label",
    "text",
    "g",
    "remove",
    "lineGroups",
    "Map",
    "areaGroups",
    "barGroups",
    "stackedBarGroups",
    "lineFunctions",
    "areaFunctions",
    "xBar",
    "xzScale",
    "idx",
    "set",
    "curveName",
    "prototype",
    "hasOwnProperty",
    "curveFunction",
    "curveStep",
    "curveNatural",
    "line",
    "minY",
    "area",
    "y0",
    "y1",
    "scaleBand",
    "xz",
    "size",
    "lineContainer",
    "fill",
    "stroke",
    "areaContainer",
    "__opacifyColor",
    "barContainer",
    "domain",
    "bandwidth",
    "keys",
    "transition",
    "duration",
    "ease",
    "easeLinear",
    "selectAll",
    "enter",
    "p",
    "func",
    "linear",
    "val",
    "yMin",
    "dot",
    "__activateTooltip",
    "relatedTarget",
    "raise",
    "dispatch",
    "bubbles",
    "center",
    "xm",
    "ym",
    "pointer",
    "least",
    "hypot",
    "scaleFactorX",
    "scaleFactorY",
    "xOffset",
    "cursorOffset",
    "pointerType",
    "timeString",
    "top",
    "left",
    "lineTitle",
    "innerHTML",
    "property",
    "icon",
    "chartTitle",
    "_shownDateRange",
    "DateFormat",
    "setHours",
    "getDateTimeFormat",
    "setDate",
    "trc",
    "getWeekNumber",
    "setMonth",
    "getFullYear",
    "yearStart",
    "ceil",
    "opacity",
    "startsWith",
    "destruct",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Chart.js"
  ],
  "sourcesContent": [
    "/* Chart.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/* eslint-disable arrow-body-style */\n/**\n * Shows an chart.\n * @asset(libs/d3.min.js)\n * @ignore(d3)\n */\nqx.Class.define('cv.ui.structure.tile.components.Chart', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: [\n    cv.ui.structure.tile.MVisibility,\n    cv.ui.structure.tile.MRefresh,\n    cv.ui.structure.tile.MResize\n  ],\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    ChartCounter: 0,\n    DEFAULT_ASPECT_RATIO: 392/192,\n\n    JS_LOADED: new Promise(async (resolve, reject) => {\n      const check = () => typeof window.d3 === 'object';\n      await cv.util.ScriptLoader.includeScript(qx.util.ResourceManager.getInstance().toUri('libs/d3.min.js'));\n\n      if (!check()) {\n        const timer = new qx.event.Timer(50);\n        let counter = 0;\n        timer.addListener('interval', () => {\n          counter++;\n          if (check()) {\n            resolve(true);\n          } else if (counter > 5) {\n            reject(new Error('Error loaded d3 library'));\n          }\n        });\n      } else {\n        resolve(true);\n      }\n    }).then(() => {\n      if (qx.locale.Manager.getInstance().getLanguage() === 'de') {\n        // localize\n        d3.formatDefaultLocale({\n          decimal: qx.locale.Number.getDecimalSeparator().translate().toString(),\n          thousands: qx.locale.Number.getGroupSeparator().translate().toString(),\n          grouping: [3],\n          currency: ['â‚¬', '']\n        });\n\n        d3.timeFormatDefaultLocale({\n          dateTime: '%A, der %e. %B %Y, %X',\n          date: '%d.%m.%Y',\n          time: '%H:%M:%S',\n          periods: [qx.locale.Date.getAmMarker().translate().toString(), qx.locale.Date.getPmMarker().translate().toString()],\n          days: qx.locale.Date.getDayNames('wide', null, 'format').map(t => t.translate().toString()),\n\n          shortDays: qx.locale.Date.getDayNames('narrow', null, 'stand-alone').map(t => t.translate().toString()),\n          months: qx.locale.Date.getMonthNames('wide').map(t => t.translate().toString()),\n          shortMonths: qx.locale.Date.getMonthNames('narrow', null, 'stand-alone').map(t => t.translate().toString())\n        });\n      }\n    }),\n\n    CONFIG: null\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    currentSeries: {\n      check: ['hour', 'day', 'week', 'month', 'year'],\n      init: 'day',\n      apply: '_refreshData'\n    },\n\n    currentPeriod: {\n      check: 'Number',\n      init: 0,\n      apply: '_refreshData'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _id: null,\n    _downloadedImage: null,\n    _url: null,\n    _headers: null,\n    _request: null,\n    _width: null,\n    _height: null,\n    _loaded: null,\n    _dataSetConfigs: null,\n    _initializing: null,\n    _navigationEnabled: null,\n    __toolTipTimer: null,\n    __showTooltip: false,\n    __debouncedOnResize: null,\n    __resizeTimeout: null,\n\n    /**\n    * @type {d3.Selection}\n    */\n    _dot: null,\n    /**\n     * @type {d3.Selection}\n     */\n    _svg: null,\n    /**\n     * @type {HTMLElement}\n     */\n    _tooltip: null,\n    /**\n     * @type {String}\n     */\n    _titleString: null,\n\n    __helpers: null,\n    __config: null,\n    // all chart properties\n    _chartConf: null,\n\n    async _init() {\n      this._checkIfWidget();\n\n      this._initializing = true;\n      const element = this._element;\n      await cv.ui.structure.tile.components.Chart.JS_LOADED;\n      if (this.isVisible()) {\n        this._loadData();\n      }\n      this._id = cv.ui.structure.tile.components.Chart.ChartCounter++;\n      const chartId = 'chart-' + this._id;\n      element.setAttribute('data-chart-id', this._id.toString());\n      const inBackground = this._element.hasAttribute('background') && this._element.getAttribute('background') === 'true';\n\n      let title = this.getHeader('label.title');\n      if (!inBackground && element.hasAttribute('title') && !title) {\n        title = document.createElement('label');\n        title.classList.add('title');\n        let span = document.createElement('span');\n        title.appendChild(span);\n        span.textContent = element.getAttribute('title');\n        this.appendToHeader(title);\n      }\n\n      if (title) {\n        // save base title for updating\n        this._titleString = title.textContent.trim();\n      }\n\n      let seriesSelection = [];\n      if (!inBackground && element.hasAttribute('selection')) {\n        const s = element.getAttribute('selection');\n        if (s === 'none') {\n          seriesSelection = [];\n        } else if (s === 'all') {\n          seriesSelection = ['hour', 'day', 'week', 'month', 'year'];\n        } else {\n          seriesSelection = s.split(',').map(n => n.trim().toLowerCase());\n        }\n      }\n      if (element.hasAttribute('series')) {\n        this.setCurrentSeries(element.getAttribute('series'));\n      }\n      const currentSeries = this.getCurrentSeries();\n      if (seriesSelection.length > 0 && !seriesSelection.includes(currentSeries)) {\n        seriesSelection.push(currentSeries);\n      }\n      this._navigationEnabled = seriesSelection.length > 0;\n      if (seriesSelection.length > 0) {\n        // back button\n        let button = this._buttonFactory('ri-arrow-left-s-line', ['prev']);\n        button.setAttribute('title', qx.locale.Manager.tr('previous'));\n        button.addEventListener('click', () => this._onSeriesPrev());\n\n        if (!title) {\n          title = document.createElement('label');\n          title.classList.add('title');\n          let span = document.createElement('span');\n          title.appendChild(span);\n          this.appendToHeader(title);\n        }\n\n        title.parentElement.insertBefore(button, title);\n        const i = document.createElement('i');\n        i.classList.add('ri-arrow-down-s-fill');\n        title.appendChild(i);\n\n        // current selection\n        const popup = document.createElement('div');\n        popup.classList.add('popup', 'series');\n        let option;\n        for (const s of seriesSelection) {\n          option = document.createElement('cv-option');\n          option.setAttribute('key', s);\n          if (s === currentSeries) {\n            option.setAttribute('selected', 'selected');\n          }\n          option.textContent = this._seriesToShort(s);\n          option.addEventListener('click', ev => {\n            popup.style.display = 'none';\n            this._onSeriesChange(ev.target.getAttribute('key'));\n            ev.stopPropagation();\n            ev.preventDefault();\n          });\n          popup.appendChild(option);\n        }\n        title.appendChild(popup);\n\n        // make title clickable\n        title.classList.add('clickable');\n        title.addEventListener('click', ev => {\n          const style = getComputedStyle(popup);\n          if (style.getPropertyValue('display') === 'none') {\n            popup.style.display = 'flex';\n          } else {\n            popup.style.display = 'none';\n          }\n          ev.stopPropagation();\n          ev.preventDefault();\n        });\n\n        // forward button\n        button = this._buttonFactory('ri-arrow-right-s-line', ['next']);\n        button.setAttribute('title', qx.locale.Manager.tr('next'));\n        // initially we cannot go into the future\n        button.disabled = true;\n        button.addEventListener('click', () => this._onSeriesNext());\n        this.appendToHeader(button);\n      }\n      if (!inBackground && element.hasAttribute('allow-fullscreen') && element.getAttribute('allow-fullscreen') === 'true') {\n        // add fullscreen button + address\n        const button = this._buttonFactory('ri-fullscreen-line', ['fullscreen']);\n        button.setAttribute('data-value', '0');\n\n        const popupAddress = `state:${chartId}-popup`;\n\n        button.addEventListener('click', () => {\n          cv.data.Model.getInstance().onUpdate(popupAddress, button.getAttribute('data-value') === '0' ? '1' : '0', 'system');\n        });\n\n        this.appendToHeader(button, 'right');\n\n        // address\n        const tileAddress = document.createElement('cv-address');\n        tileAddress.setAttribute('mode', 'read');\n        tileAddress.setAttribute('target', 'fullscreen-popup');\n        tileAddress.setAttribute('backend', 'system');\n        tileAddress.setAttribute('send-mode', 'always');\n        tileAddress.textContent = popupAddress;\n        element.parentElement.appendChild(tileAddress);\n\n        // listen to parent tile of popup is opened or not\n        let parent = element;\n        while (parent && parent.nodeName.toLowerCase() !== 'cv-tile') {\n          parent = parent.parentElement;\n        }\n        if (parent) {\n          const tileWidget = parent.getInstance();\n          tileWidget.addListener('closed', () => cv.data.Model.getInstance().onUpdate(popupAddress, '0', 'system'));\n\n          // because we added a read address to the tile after is has been initialized we need to init the listener here manually\n          parent.addEventListener('stateUpdate', ev => {\n            tileWidget.onStateUpdate(ev);\n            // cancel event here\n            ev.stopPropagation();\n          });\n\n        // only on mobile we need this, because of height: auto\n          if (document.body.classList.contains('mobile')) {\n            tileWidget.addListener('fullscreenChanged', () => {\n              this._onRendered();\n            });\n          }\n        }\n      }\n\n\n      if (element.hasAttribute('refresh')) {\n        this.setRefresh(parseInt(element.getAttribute('refresh')));\n      }\n\n      // create needed elements\n\n      const svg = d3.select(this._element)\n        .append('svg');\n\n      let noToolTips = false;\n      if (inBackground) {\n        noToolTips = true;\n        svg.style('opacity', 0.4);\n      }\n\n      if (!noToolTips) {\n        this._tooltip = document.createElement('div');\n        this._tooltip.classList.add('tooltip');\n        this._tooltip.style.display = 'none';\n        this._element.appendChild(this._tooltip);\n\n        svg.on('pointerenter', this._onPointerEntered.bind(this));\n        svg.on('pointermove', this._onPointerMoved.bind(this));\n        svg.on('pointerleave', this._onPointerLeft.bind(this));\n      }\n      svg.on(\n        'touchmove',\n        event => {\n          if (this._loaded) {\n            let y = event.targetTouches[0].clientY;\n            if (this._helpers.linePath) {\n              const pathRect = this._helpers.linePath.node().getBoundingClientRect();\n              if (y > pathRect.y && y < pathRect.y + pathRect.height) {\n                event.preventDefault();\n              }\n            }\n          }\n        },\n        { passive: false }\n      );\n\n      // init some fixed settings\n      const format = this._element.hasAttribute('y-format') ? this._element.getAttribute('y-format') : '%s';\n      let timeFormat = null;\n      if (this._element.hasAttribute('x-format')) {\n        const formatString = this._element.getAttribute('x-format');\n        timeFormat = date => d3.timeFormat(formatString)(date);\n      } else {\n        // format auto-detection\n        timeFormat = this.multiTimeFormat([\n          [\n            '%H:%M:%S',\n            function (d) {\n              return d.getSeconds();\n            }\n          ],\n\n          [\n            '%H:%M',\n            function (d) {\n              return d.getMinutes();\n            }\n          ],\n\n          [\n            '%H',\n            function (d) {\n              return d.getHours();\n            }\n          ],\n\n          [\n            '%a %d',\n            function (d) {\n              return d.getDay() && d.getDate() !== 1;\n            }\n          ],\n\n          [\n            '%b %d',\n            function (d) {\n              return d.getDate() !== 1;\n            }\n          ],\n\n          [\n            '%B',\n            function (d) {\n              return d.getMonth();\n            }\n          ],\n\n          [\n            '%Y',\n            function () {\n              return true;\n            }\n          ]\n        ]);\n      }\n      this.__config = {\n        x: d => d.time, // given d in data, returns the (temporal) x-value\n        y: d => +d.value, // given d in data, returns the (quantitative) y-value\n        z: d => d.src, // given d in data, returns the (categorical) z-value\n        color: d => d && this._dataSetConfigs[d].color, // stroke color of line, as a constant or a function of *z*\n        title: d => cv.util.String.sprintf(format, d.value), // given d in data, returns the title text\n        curve: d3.curveLinear, // method of interpolation between points\n        marginTop: 12, // top margin, in pixels\n        marginRight: 24, // right margin, in pixels\n        marginBottom: 20, // bottom margin, in pixels\n        marginLeft: 24, // left margin, in pixels\n        width: 392, // outer width, in pixels\n        height: 192, // outer height, in pixels\n        aspectRatio: 392/192,\n        xType: d3.scaleTime, // type of x-scale\n        xFormat: timeFormat, // a format specifier string for the x-axis\n        yType: d3.scaleLinear, // type of y-scale\n        yFormat: undefined, // a format specifier string for the y-axis\n        yLabel: undefined, // a label for the y-axis\n        strokeLinecap: undefined, // stroke line cap of line\n        strokeLinejoin: undefined, // stroke line join of line\n        strokeWidth: 1.5, // stroke width of line\n        strokeOpacity: undefined, // stroke opacity of line\n        mixBlendMode: 'normal', // blend mode of lines\n        showArea: d => this._dataSetConfigs[d].showArea, // show area below the line,\n        showXAxis: !this._element.hasAttribute('show-x-axis') || this._element.getAttribute('show-x-axis') === 'true',\n        showYAxis: !this._element.hasAttribute('show-y-axis') || this._element.getAttribute('show-y-axis') === 'true',\n        xPadding: 0.1 // amount of x-range to reserve to separate bars\n      };\n\n      this._initializing = false;\n      this.__updateTitle();\n\n      // check if we have a read address for live updates\n      const datasetSources = Array.from(this._element.querySelectorAll(':scope > dataset')).map(elem => elem.getAttribute('src'));\n      const readAddresses = Array.from(element.querySelectorAll(':scope > cv-address:not([mode=\"write\"])')).filter(elem => datasetSources.includes(elem.getAttribute('target')));\n      if (readAddresses.length > 0) {\n        element.addEventListener('stateUpdate', ev => {\n          this.onStateUpdate(ev);\n          // cancel event here\n          ev.stopPropagation();\n        });\n      }\n    },\n\n    onStateUpdate(ev) {\n      const targetDataset = this._element.querySelector(':scope > dataset[src=\"'+ev.detail.target+'\"]');\n      const config = this._dataSetConfigs[ev.detail.target];\n      if (targetDataset && config) {\n        let ts = Date.now();\n        if (config.aggregationInterval) {\n          const mins = config.aggregationInterval * 60 * 1000;\n          ts = Math.round(ts / mins) * mins;\n        }\n        this._renderChart({\n          src: ev.detail.target,\n          time: ts,\n          value: ev.detail.state\n        }, true);\n      }\n    },\n\n    _onSeriesPrev() {\n      this.setCurrentPeriod(this.getCurrentPeriod()+1);\n    },\n\n    _onSeriesChange(select) {\n      this._initializing = true;\n      // reset offset when series changed\n      this.resetCurrentPeriod();\n      this._initializing = false;\n      // reset configuration, we need a new one\n      this._chartConf = null;\n      this.setCurrentSeries(select);\n    },\n\n    _onSeriesNext() {\n      const currentPeriod = this.getCurrentPeriod();\n      if (currentPeriod > 0) {\n        this.setCurrentPeriod(currentPeriod-1);\n      }\n    },\n\n    refresh() {\n      this._loaded = false;\n      this._loadData();\n    },\n\n    // triggered after a change os series or period\n    _refreshData() {\n      const nextButton = this.getHeader('.next');\n      if (nextButton) {\n        if (this.getCurrentPeriod() === 0) {\n          nextButton.setAttribute('disabled', 'disabled');\n        } else {\n          nextButton.removeAttribute('disabled');\n        }\n      }\n\n      if (!this._initializing) {\n        this._loaded = false;\n        this._loadData();\n      }\n      this.__updateTitle();\n    },\n\n    _loadData() {\n      if (this._loaded && Date.now() - this._loaded < 300000) {\n        // don't reload within 5 minutes\n        return;\n      }\n      const client = cv.io.BackendConnections.getClient();\n      let url;\n      const dataSets = this._element.querySelectorAll(':scope > dataset');\n      const series = this.getCurrentSeries();\n\n      const currentPeriod = this.getCurrentPeriod();\n      let start = 'end-1' + series;\n      let end = 'now';\n\n      let interval = 0;\n      switch (series) {\n        case 'hour':\n          interval = 60 * 60 * 1000;\n          break;\n\n        case 'day':\n          interval = 24 * 60 * 60 * 1000;\n          break;\n\n        case 'week':\n          interval = 7 * 24 * 60 * 60 * 1000;\n          break;\n\n        case 'month':\n          interval = 30 * 24 * 60 * 60 * 1000;\n          break;\n\n        case 'year':\n          interval = 365 * 24 * 60 * 60 * 1000;\n          break;\n      }\n      if (currentPeriod > 0 && interval > 0) {\n        end = Math.round((Date.now() - currentPeriod * interval) / 1000);\n      }\n\n      const promises = [];\n      if (!this._dataSetConfigs) {\n        this._dataSetConfigs = {};\n        for (let dataSet of dataSets) {\n          let ts = {\n            showArea: true,\n            color: '#FF9900',\n            chartType: 'line',\n            title: '',\n            curve: 'linear',\n            aggregationInterval: 0\n          };\n\n          let attr;\n          let name;\n          let value;\n          for (let i = 0; i < dataSet.attributes.length; i++) {\n            attr = dataSet.attributes.item(i);\n            // CamelCase attribute names\n            name = attr.name\n              .split('-')\n              .map((part, i) => {\n                if (i > 0) {\n                  return `${part.substring(0, 1).toUpperCase()}${part.substring(1)}`;\n                }\n                return part;\n              })\n              .join('');\n            value = attr.value;\n            if (value === 'true' || value === 'false') {\n              value = value === 'true';\n            } else if (/^\\d+$/.test(value)) {\n              value = parseInt(value);\n            } else if (/^[\\d.]+$/.test(value)) {\n              value = parseFloat(value);\n            }\n            ts[name] = value;\n          }\n          this._dataSetConfigs[ts.src] = ts;\n        }\n      }\n\n      for (const src in this._dataSetConfigs) {\n        url = client.getResourcePath('charts', {\n          src: src,\n          start: start,\n          end: end\n        });\n\n        const ts = this._dataSetConfigs[src];\n\n        if (!url) {\n          continue;\n        }\n\n        this.debug('loading', url);\n        promises.push(\n          cv.io.Fetch.cachedFetch(url, {ttl: this.getRefresh()}, false, client)\n            .then(data => {\n              this.debug('successfully loaded', url);\n              if (client.hasCustomChartsDataProcessor(data)) {\n                data = client.processChartsData(data, ts);\n              }\n              if (!this._lastRefresh) {\n                this._lastRefresh = Date.now();\n              }\n              return {\n                data: data || [],\n                ts: ts\n              };\n            })\n            .catch(err => {\n              this._onStatusError(ts, url, err);\n              return {\n                data: [],\n                ts: ts\n              };\n            })\n        );\n      }\n      Promise.all(promises).then(responses => {\n        this._onSuccess(responses);\n      });\n    },\n\n    _onSuccess(data) {\n      let chartData = [];\n\n      for (let entry of data) {\n        let tsdata = entry.data;\n        if (tsdata !== null) {\n          // TODO: stacked bar times (entry.ts.chartType === 'stacked-bar') must be aggregated, they have to be at the same time index for stacking\n          const mins = entry.ts.aggregationInterval > 0 ? entry.ts.aggregationInterval * 60 * 1000 : 0;\n          for (let [time, value] of tsdata) {\n            chartData.push({\n              src: entry.ts.src,\n              time: mins > 0\n                ? Math.round(time / mins) * mins : time,\n              value\n            });\n          }\n        }\n      }\n\n      if (this._element.hasAttribute('background') && this._element.getAttribute('background') === 'true') {\n        // no margins\n        this.__config = Object.assign(this.__config, {\n          marginRight: 0,\n          marginBottom: 0,\n          marginLeft: 0\n        });\n\n        // because we have no margins we need to cut the overflow on the tile\n        let tile = this._element.parentElement;\n        while (tile && tile.localName !== 'cv-tile') {\n          tile = tile.parentElement;\n        }\n        if (tile && tile.localName === 'cv-tile') {\n          tile.style.overflow = 'hidden';\n        }\n      }\n\n      // wait some time to let the element size settle\n      window.requestAnimationFrame(() => {\n        setTimeout(() => {\n          this._onRendered(chartData);\n        }, 100);\n      });\n    },\n\n    _onRendered(chartData, retries) {\n      if (this.__resizeTimeout) {\n        clearTimeout(this.__resizeTimeout);\n        this.__resizeTimeout = null;\n      }\n      if (this.isVisible()) {\n        const [width, height] = this._getSize();\n        if ((width < 20 || height < 10) && (!retries || retries <= 5)) {\n          // this make no sense\n          this.__resizeTimeout = setTimeout(() => {\n            this._onRendered(chartData, retries > 0 ? retries + 1 : 1);\n          }, 150);\n        }\n        if (width < 20 || height < 10) {\n          // dp nothing, these values are invalid\n          return;\n        }\n\n        this.__config.width = width;\n        this.__config.height = height;\n        d3.select(this._element).select('svg')\n          .attr('viewBox', `0, 0, ${width}, ${height}`);\n        if (chartData) {\n          this._renderChart(chartData);\n          this._loaded = Date.now();\n        }\n      }\n    },\n\n    _getSize() {\n      const parent = this._element.parentElement;\n      let padding = this._element.getAttribute('background') === 'true' ? 0 : 8;\n      let containerWidth = this._element.offsetWidth - padding;\n      let containerHeight = this._element.offsetHeight - padding;\n      let factor = 1;\n\n      const landscape = containerWidth > containerHeight;\n      let width = 0;\n      let height = 0;\n\n      if (landscape && containerHeight > 0) {\n        // obeying aspect ratio in landscape mode is not necessary\n        width = Math.round(containerWidth / factor);\n        height = Math.round(containerHeight / factor);\n      } else {\n        width = Math.round(containerWidth / factor);\n        height = width / cv.ui.structure.tile.components.Chart.DEFAULT_ASPECT_RATIO;\n      }\n      if ((parent.localName === 'cv-popup' && parent.getAttribute('fullscreen') === 'true') ||\n        (this._element.getAttribute('allow-fullscreen') === 'true' && parent.parentElement.classList.contains('fullscreen'))) {\n        // the parent container has height: auto, so we need to have one\n        this._element.style.height = (height + padding*2) + 'px';\n      }\n      return [width, height];\n    },\n\n    multiTimeFormat(formatsArray) {\n      /**\n       * @param date\n       */\n      function multiFormat(date) {\n        let i = 0;\n        let found = false;\n        let fmt = '%c';\n        while (!found && i < formatsArray.length) {\n          found = formatsArray[i][1](date);\n          if (found) {\n            fmt = formatsArray[i][0];\n          }\n          i++;\n        }\n        return fmt;\n      }\n      return date => d3.timeFormat(multiFormat(date))(date);\n    },\n\n    _onStatusError(ts, key, err) {\n      cv.core.notifications.Router.dispatchMessage('cv.charts.error', {\n        title: qx.locale.Manager.tr('Communication error'),\n        severity: 'urgent',\n        message: qx.locale.Manager.tr('URL: %1<br/><br/>Response:</br>%2', JSON.stringify(key), err)\n      });\n\n      this.error('Chart _onStatusError', ts, key, err);\n    },\n\n\n    /**\n     * Get svg element selection (create if not exists)\n     * @param parent d3.selection of the parent this element should be a child of\n     * @param nodeName {String} Element name\n     * @param classes {Array<String>} array of css classes used to identify this element\n     * @param attributes {Map<String, String>?} set these attributes if the element has to be created, when it already exists these are ignored\n     * @private\n     */\n    _getSvgElement(parent, nodeName, classes, attributes) {\n      let elem = parent.select(nodeName + '.' + classes.join('.'));\n      if (elem.empty()) {\n        elem = parent.append(nodeName).attr('class', classes.join(' '));\n        if (attributes) {\n          for (const name in attributes) {\n            elem.attr(name, attributes[name]);\n          }\n        }\n      }\n      return elem;\n    },\n\n    /**\n     * Copyright 2021 Observable, Inc.\n     * Released under the ISC license.\n     * https://observablehq.com/@d3/multi-line-chart\n     *\n     * @param data\n     * @param single\n     * @private\n     */\n    _renderChart(data, single) {\n      const config = this.__config;\n      const svg = d3.select(this._element).select('svg');\n\n      // Compute values.\n      let X;\n      let Y;\n      let Z;\n      let O;\n      let T;\n      if (single) {\n        if (!this._helpers) {\n          return;\n        }\n        X = this._helpers.X;\n        Y = this._helpers.Y;\n        Z = this._helpers.Z;\n        O = this._helpers.O;\n        T = this._helpers.T;\n        if (X[X.length-1] === data.time) {\n          // replace last value instead of adding one\n          Y[Y.length-1] = data.value;\n        } else {\n          X.push(data.time);\n          Y.push(data.value);\n          Z.push(data.src);\n          O.push(data);\n          T.push(config.title === undefined ? data.src : config.title === null ? null : config.title(data));\n\n          // cleanup\n          X.shift();\n          Y.shift();\n          Z.shift();\n          O.shift();\n          T.shift();\n        }\n      } else {\n        X = d3.map(data, config.x);\n        Y = d3.map(data, config.y);\n        Z = d3.map(data, config.z);\n        O = d3.map(data, d => d);\n        // Compute titles.\n        T = config.title === undefined ? Z : config.title === null ? null : d3.map(data, config.title);\n      }\n\n      // Compute default domains, and unique the z-domain.\n      let xDomain = d3.extent(X);\n      let minVal = 0;\n      if (this._element.hasAttribute('zero-based') && this._element.getAttribute('zero-based') === 'false') {\n        minVal = d3.min(Y);\n        if (minVal > 1.0) {\n          minVal -= 1;\n        }\n      }\n      let maxVal = d3.max(Y);\n      if (maxVal > 1.0) {\n        // add some inner chart padding\n        maxVal += 1;\n      } else {\n        maxVal += 0.1;\n      }\n      const yDomain = [minVal, maxVal];\n      const zDomain = new d3.InternSet(Z);\n      // Omit any data not present in the z-domain.\n      const I = d3.range(X.length).filter(i => zDomain.has(Z[i]));\n\n      if (config.showYAxis) {\n        const maxValue = config.yFormat ? config.yFormat(yDomain[1]) : yDomain[1].toFixed(maxVal < 1 ? 2 : 1);\n        // check if we need more space for the y-axis\n        if (maxValue.length >= 2) {\n          config.marginLeft = maxValue.length * 8;\n        }\n      }\n\n      const xTicks = config.width / 80;\n      const yTicks = config.height / 60;\n      const additionalXRangePadding = this._element.getAttribute('background') === 'true' ? 0 : 2;\n\n      const xRange = [config.marginLeft + additionalXRangePadding, config.width - config.marginRight - additionalXRangePadding]; // [left, right]\n      if (!this._chartConf) {\n        const yRange = [config.height - config.marginBottom, config.marginTop]; // [bottom, top]\n\n        // initialize everything once\n        this._chartConf = {\n          // x/y scales\n          x: config.xType().range(xRange),\n          y: config.yType().range(yRange)\n        };\n        this._chartConf.xAxis = config.showXAxis\n          ? d3.axisBottom(this._chartConf.x)\n            .ticks(xTicks)\n            .tickSizeOuter(0)\n            .tickFormat(config.xFormat)\n          : undefined;\n        this._chartConf.yAxis = config.showYAxis\n          ? d3.axisLeft(this._chartConf.y).ticks(yTicks, config.yFormat)\n          : undefined;\n\n\n        // add elements\n        const showGrid = this._element.hasAttribute('show-grid') ? this._element.getAttribute('show-grid') : 'xy';\n        if (showGrid.includes('x')) {\n          this._chartConf.xGrid = d3.axisBottom(this._chartConf.x).ticks(xTicks)\n            .tickSize(-config.height + config.marginBottom + config.marginTop)\n            .tickFormat('');\n          this._getSvgElement(svg, 'g', ['grid', 'x'], {\n            transform: `translate(0,${config.height - config.marginBottom})`\n          })\n            .call(this._chartConf.xGrid);\n        }\n        if (showGrid.includes('y')) {\n          this._chartConf.yGrid = d3.axisLeft(this._chartConf.y).ticks(yTicks)\n            .tickSize(-config.width + config.marginRight + config.marginLeft)\n            .tickFormat('');\n\n          this._getSvgElement(svg, 'g', ['grid', 'y'], {\n            transform: `translate(${config.marginLeft},0)`\n          })\n            .call(this._chartConf.yGrid);\n        }\n\n        if (config.showXAxis) {\n          this._getSvgElement(svg, 'g', ['axis', 'x'])\n            .attr('transform', `translate(0,${config.height - config.marginBottom})`)\n            .call(this._chartConf.xAxis);\n        }\n\n        if (config.showYAxis) {\n          let yAxisElement = this._getSvgElement(svg, 'g', ['axis', 'y'])\n            .attr('transform', `translate(${config.marginLeft},0)`);\n\n          if (config.label && yAxisElement.select('text').empty()) {\n            yAxisElement.append('text')\n              .attr('x', -config.marginLeft)\n              .attr('y', 10)\n              .attr('fill', 'currentColor')\n              .attr('text-anchor', 'start')\n              .text(config.yLabel);\n          }\n\n          yAxisElement\n            .call(this._chartConf.yAxis)\n            .call(g => g.select('.domain').remove());\n        }\n\n        // find chart types\n        const lineGroups = new Map();\n        const areaGroups = new Map();\n        const barGroups = new Map();\n        const stackedBarGroups = new Map();\n        const lineFunctions = {};\n        const areaFunctions = {};\n        let xBar;\n        let xzScale;\n\n        for (const key of zDomain) {\n          switch (this._dataSetConfigs[key].chartType) {\n            case 'line': {\n              const idx = I.filter(i => Z[i] === key);\n              lineGroups.set(key, idx);\n              const curveName = this._dataSetConfigs[key].curve || 'linear';\n              if (!Object.prototype.hasOwnProperty.call(lineFunctions, curveName)) {\n                let curveFunction;\n                switch (curveName) {\n                  case 'linear':\n                    curveFunction = d3.curveLinear;\n                    break;\n\n                  case 'step':\n                    curveFunction = d3.curveStep;\n                    break;\n\n                  case 'natural':\n                    curveFunction = d3.curveNatural;\n                    break;\n                }\n\n                if (curveFunction) {\n                  // Construct a line generator.\n                  lineFunctions[curveName] = d3\n                    .line()\n                    .curve(curveFunction)\n                    .x(i => this._chartConf.x(this._helpers.X[i]))\n                    .y(i => this._chartConf.y(this._helpers.Y[i]));\n                }\n\n                if (this._dataSetConfigs[key].chartType === 'line' && typeof config.showArea === 'function' && config.showArea(key)) {\n                  areaGroups.set(key, idx);\n                  if (curveFunction) {\n                    // Construct a line generator.\n                    const minY = this._chartConf.y.range()[0];\n                    areaFunctions[curveName] = d3\n                      .area()\n                      .curve(curveFunction)\n                      .x(i => this._chartConf.x(this._helpers.X[i]))\n                      .y0(() => minY)\n                      .y1(i => this._chartConf.y(this._helpers.Y[i]));\n                  }\n                }\n              }\n              break;\n            }\n\n            case 'bar':\n              barGroups.set(key, I.filter(i => Z[i] === key));\n              if (!xBar) {\n                xBar = d3.scaleBand().range(this._chartConf.x.range()).padding(config.xPadding);\n              }\n              if (!xzScale) {\n                xzScale = d3.scaleBand().padding(0.05);\n              }\n              break;\n\n            case 'stacked-bar':\n              stackedBarGroups.set(key, I.filter(i => Z[i] === key));\n              break;\n          }\n        }\n\n        this._chartConf.lineGroups = lineGroups;\n        this._chartConf.areaGroups = areaGroups;\n        this._chartConf.barGroups = barGroups;\n        this._chartConf.stackedBarGroups = stackedBarGroups;\n        this._chartConf.lineFunctions = lineFunctions;\n        this._chartConf.areaFunctions = areaFunctions;\n        this._chartConf.xBar = xBar;\n        if (xzScale) {\n          this._chartConf.xz = xzScale;\n        }\n\n        // prepare elements for chart elements\n        if (this._chartConf.lineGroups.size > 0) {\n          this._chartConf.lineContainer = this._getSvgElement(svg, 'g', ['line'], {\n            fill: 'none',\n            stroke: typeof config.color === 'string' ? config.color : null,\n            'stroke-linecap': config.strokeLinecap,\n            'stroke-linejoin': config.strokeLinejoin,\n            'stroke-width': config.strokeWidth,\n            'stroke-opacity': config.strokeOpacity\n          });\n        }\n        if (this._chartConf.areaGroups.size > 0) {\n          this._chartConf.areaContainer = this._getSvgElement(svg, 'g', ['area'], {\n            stroke: 'none',\n            fill: typeof config.color === 'string' ? this.__opacifyColor(config.color, '30') : null\n          });\n        }\n        if (this._chartConf.barGroups.size > 0) {\n          this._chartConf.barContainer = this._getSvgElement(svg, 'g', ['bars']);\n        }\n      }\n\n      // apply domains to scales\n      this._chartConf.x.domain(xDomain);\n      this._chartConf.y.domain(yDomain);\n\n      this._helpers = { X, Y, I, T, Z, O };\n\n      if (this._chartConf.xAxis) {\n        this._getSvgElement(svg, 'g', ['axis', 'x'])\n          .call(this._chartConf.xAxis);\n      }\n\n      if (this._chartConf.yAxis) {\n        this._getSvgElement(svg, 'g', ['axis', 'y'])\n          .call(this._chartConf.yAxis);\n      }\n      if (this._chartConf.xBar) {\n        this._chartConf.xBar.domain(new d3.InternSet(X));\n      }\n      if (this._chartConf.xz) {\n        this._chartConf.xz.domain(zDomain);\n        this._chartConf.x.range([xRange[0], xRange[1] - this._chartConf.xBar.bandwidth()]);\n        this._chartConf.xz.range([0, this._chartConf.xBar.bandwidth()]);\n      }\n\n      // update groups\n      for (const key of this._chartConf.lineGroups.keys()) {\n        const idx = I.filter(i => Z[i] === key);\n        this._chartConf.lineGroups.set(key, idx);\n      }\n      for (const key of this._chartConf.areaGroups.keys()) {\n        const idx = I.filter(i => Z[i] === key && Y[i] !== undefined);\n        this._chartConf.areaGroups.set(key, idx);\n      }\n      for (const key of this._chartConf.barGroups.keys()) {\n        const idx = I.filter(i => Z[i] === key && Y[i] !== undefined);\n        this._chartConf.barGroups.set(key, idx);\n      }\n      for (const key of this._chartConf.stackedBarGroups.keys()) {\n        const idx = I.filter(i => Z[i] === key && Y[i] !== undefined);\n        this._chartConf.stackedBarGroups.set(key, idx);\n      }\n\n      this.__config = config;\n      this._dot = svg.select('g.dot');\n\n      const t = d3.transition()\n        .duration(single ? 0 : 500)\n        .ease(d3.easeLinear);\n\n      if (this._chartConf.lineContainer) {\n        this._chartConf.lineContainer\n          .selectAll('path')\n          .data(this._chartConf.lineGroups)\n          .join(\n            enter => enter.append('path')\n              .style('mix-blend-mode', config.mixBlendMode)\n              .attr('stroke', typeof config.color === 'function' ? p => config.color(p[0]) : null)\n          )\n          .transition(t)\n          .attr('d', d => {\n            const curveName = this._dataSetConfigs[d[0]].curve || 'linear';\n            const func = this._chartConf.lineFunctions[curveName] || this._chartConf.lineFunctions.linear;\n            const val = func(d[1]);\n            return val;\n          });\n      }\n\n      // Add the area\n      if (this._chartConf.areaContainer) {\n        this._chartConf.areaContainer\n          .selectAll('path')\n          .data(this._chartConf.areaGroups)\n          .join(\n            enter => enter.append('path')\n              .style('mix-blend-mode', config.mixBlendMode)\n              .attr('fill', typeof config.color === 'function' ? p => this.__opacifyColor(config.color(p[0]), '30') : null)\n          )\n          .transition(t)\n          .attr('d', d => {\n            const curveName = this._dataSetConfigs[d[0]].curve || 'linear';\n            const func = this._chartConf.areaFunctions[curveName] || this._chartConf.areaFunctions.linear;\n            return func(d[1]);\n          });\n      }\n\n      if (this._chartConf.barContainer) {\n        const yMin = this._chartConf.y.range()[0];\n        this._chartConf.barContainer\n          .selectAll('g')\n          .data(this._chartConf.barGroups)\n          .join('g')\n          .attr('fill', typeof config.color === 'function' ? d => config.color(d[0]) : null)\n          .selectAll('rect')\n          .data(d => {\n            return d[1].map(val => {\n              return {\n                key: d[0],\n                value: val\n              };\n            });\n          })\n          .join('rect')\n          .attr('x', d => {\n            const x = this._chartConf.x(X[d.value]);\n            const xz =  this._chartConf.xz(d.key);\n            return x + xz;\n          })\n          .attr('y', d => this._chartConf.y(Y[d.value]))\n          .attr('width', this._chartConf.xz.bandwidth())\n          .transition(t)\n          .attr('height', d => yMin - this._chartConf.y(Y[d.value]));\n      }\n\n      // dot must be added last\n      const dot = svg.select('g.dot');\n      if (dot.empty()) {\n        svg.append('g')\n          .attr('class', 'dot')\n          .attr('display', 'none')\n          .attr('fill', 'currentColor')\n          .append('circle')\n          .attr('r', 2.5);\n      }\n      this._dot = svg.select('g.dot');\n    },\n\n    _onPointerEntered(ev) {\n      if (this._loaded) {\n        this.__toolTipTimer = setTimeout(() => {\n          this.__activateTooltip(true, ev);\n          this.__toolTipTimer = null;\n        }, 500);\n      }\n    },\n\n    _onPointerLeft(ev) {\n      if (this.__toolTipTimer) {\n        clearTimeout(this.__toolTipTimer);\n      }\n\n      if (this._loaded) {\n        if (ev.relatedTarget !== this._tooltip) {\n          this.__activateTooltip(false);\n        }\n      }\n    },\n\n    __activateTooltip(val, ev) {\n      this.__showTooltip = val;\n      if (val) {\n        if (this._dot) {\n          this._dot.attr('display', null);\n          this._dot.raise();\n        }\n        this._tooltip.style.display = 'block';\n        this._onPointerMoved(null, true);\n      } else {\n        if (this._dot) {\n          this._dot.attr('display', 'none');\n        }\n        const svg = d3.select(this._element).select('svg');\n        svg.node().value = null;\n        svg.dispatch('input', {bubbles: true});\n        this._tooltip.style.display = 'none';\n      }\n    },\n\n    _onPointerMoved(event, center) {\n      if (this._loaded && this.__showTooltip) {\n        let xm = 0;\n        let ym = 0;\n        if (event) {\n          [xm, ym] = d3.pointer(event);\n        } else if (center) {\n          xm = this.__config.width/2;\n          ym = this.__config.height/2;\n        } else {\n          return;\n        }\n        const {X, Y, I, T, Z, O} = this._helpers;\n        const {x, y, xz} = this._chartConf;\n        const i = d3.least(I, i => Math.hypot(x(X[i]) - xm, y(Y[i]) - ym));\n        const scaleFactorX = this._element.offsetWidth / this.__config.width;\n        const scaleFactorY = this._element.offsetHeight / this.__config.height;\n        // closest point\n        const xOffset = xz ? (xz(Z[i]) + (typeof xz.bandwidth === 'function' ? xz.bandwidth() / 2 : 0)) : 0;\n        this._dot.attr('transform', `translate(${x(X[i]) + xOffset},${y(Y[i])})`);\n        if (T) {\n          const cursorOffset = event && event.pointerType === 'mouse' ? 16 : 40;\n          const timeString = this.__config.xFormat(new Date(X[i]));\n          let top = ym * scaleFactorY - this._tooltip.offsetHeight;\n          if (top < 0) {\n            top += cursorOffset + this._tooltip.offsetHeight;\n          } else {\n            top -= cursorOffset;\n          }\n\n          let left = xm * scaleFactorX;\n          if (left > this._element.offsetWidth / 2) {\n            left -= this._tooltip.offsetWidth + cursorOffset;\n          } else {\n            left += cursorOffset;\n          }\n\n          const key = Z[i];\n          const lineTitle = this._dataSetConfigs[key] && this._dataSetConfigs[key].title ? this._dataSetConfigs[key].title + ': ' : '';\n          this._tooltip.innerHTML = `${timeString}<br/>${lineTitle}${T[i]}`;\n          this._tooltip.style.left = left + 'px';\n          this._tooltip.style.top = top + 'px';\n        }\n        d3.select(this._element).select('svg').property('value', O[i]).dispatch('input', {bubbles: true});\n      }\n    },\n\n    _buttonFactory(icon, classes) {\n      const button = document.createElement('button');\n      button.classList.add(...classes);\n      if (icon) {\n        const i = document.createElement('i');\n        i.classList.add(icon);\n        button.appendChild(i);\n      }\n      return button;\n    },\n\n    __updateTitle() {\n      if (this._navigationEnabled) {\n        let title = this.getHeader('label.title span');\n        if (title) {\n          let chartTitle = this._titleString || '';\n          title.textContent = (chartTitle ? chartTitle + ' - ' : '') + this._shownDateRange();\n        }\n      }\n    },\n\n    /**\n     * Converts series to a shot string that is shown in a select box\n     * @param series\n     * @private\n     */\n    _seriesToShort(series) {\n      switch (series) {\n        case 'hour':\n          return qx.locale.Manager.tr('Hour');\n\n        case 'day':\n          return qx.locale.Manager.tr('Day');\n\n        case 'week':\n          return qx.locale.Manager.tr('Week');\n\n        case 'month':\n          return qx.locale.Manager.tr('Month');\n\n        case 'year':\n          return qx.locale.Manager.tr('Year');\n      }\n      return '';\n    },\n\n    /**\n     * Convert the currently shown date range into a human-readable string\n     * @private\n     */\n    _shownDateRange() {\n      const series = this.getCurrentSeries();\n      const currentPeriod = this.getCurrentPeriod();\n      const date = new Date();\n      let format = new qx.util.format.DateFormat();\n      switch (series) {\n        case 'hour':\n          date.setHours(date.getHours() - currentPeriod, 0, 0);\n          format = new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat('hmm', 'h:mm'));\n          return format.format(date);\n\n        case 'day':\n          if (currentPeriod === 0) {\n            return qx.locale.Manager.tr('today');\n          } else if (currentPeriod === 1) {\n            return qx.locale.Manager.tr('yesterday');\n          }\n          date.setDate(date.getDate() - currentPeriod);\n          format = new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat('MMMd', 'd. MMM'));\n          return format.format(date);\n\n        case 'week':\n          date.setDate(date.getDate() - currentPeriod*7);\n          return qx.locale.Manager.trc('CW = calendar week', 'CW %1', this.getWeekNumber(date));\n\n        case 'month':\n          date.setMonth(date.getMonth() - currentPeriod);\n          if (date.getFullYear() === new Date().getFullYear()) {\n            // no year needed\n            format = new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat('MMM', 'MMM'));\n          } else {\n            format = new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat('yyMMM', 'MMM yy'));\n          }\n          return format.format(date);\n\n        case 'year':\n          return date.getFullYear() - currentPeriod;\n      }\n      return '';\n    },\n\n   getWeekNumber(d) {\n      d = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      // Set to the nearest Thursday: current date + 4 - current day number\n      d.setDate(d.getDate() + 4 - (d.getDay() || 7));\n      // Get first day of year\n      const yearStart = new Date(d.getFullYear(), 0, 1);\n      // Calculate full weeks to the nearest Thursday\n      return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);\n    },\n\n    /**\n     * add opacity to color\n     * @param color\n     * @param opacity {string} hex number 0 - 255\n     * @return {string|*}\n     * @private\n     */\n    __opacifyColor(color, opacity) {\n      if (color.startsWith('rgb(')) {\n        return 'rgba(' + color.substring(4, color.length-1) + ', ' + (parseInt(opacity, 16) / 255).toFixed(2) + ')';\n      } else if (color.startsWith('#') && color.length === 7) {\n        return color + opacity;\n      }\n      return color;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._chartConf = null;\n    this._helpers = null;\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'chart',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}