{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "tile",
    "elements",
    "AbstractCustomElement",
    "statics",
    "PL_COUNTER",
    "members",
    "__widget",
    "_init",
    "name",
    "_element",
    "hasAttribute",
    "getAttribute",
    "firstElementChild",
    "nodeName",
    "toLowerCase",
    "pluginName",
    "loadPluginPart",
    "part",
    "Clazz",
    "plugins",
    "baseName",
    "components",
    "Plugin",
    "id",
    "parser",
    "DOMParser",
    "doc",
    "parseFromString",
    "innerHTML",
    "props",
    "parse",
    "TemplateEngine",
    "getInstance",
    "setDomFinished",
    "$$type",
    "getDomString",
    "scriptLoader",
    "util",
    "ScriptLoader",
    "window",
    "requestAnimationFrame",
    "isFinished",
    "addListenerOnce",
    "error",
    "Part",
    "getParts",
    "Promise",
    "resolve",
    "load",
    "defer",
    "QxClass",
    "customElements",
    "Controller",
    "PREFIX",
    "QxConnector"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Plugin.js"
  ],
  "sourcesContent": [
    "/**\n * Wrapper for plugins\n */\nqx.Class.define('cv.ui.structure.tile.components.Plugin', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n   PL_COUNTER: 0\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __widget: null,\n\n    async _init() {\n      super._init();\n      // load plugin\n      let name = '';\n      if (this._element.hasAttribute('name')) {\n        name = this._element.getAttribute('name');\n      } else {\n        name = this._element.firstElementChild.nodeName.toLowerCase();\n      }\n      if (name) {\n        const pluginName = 'plugin-' + name;\n        const part = await this.loadPluginPart(pluginName);\n        if (part) {\n          // find the main class file in the package\n          let Clazz = null;\n          for (let baseName in cv.plugins) {\n            if (baseName.toLowerCase() === name) {\n              Clazz = cv.plugins[baseName];\n              break;\n            }\n          }\n          if (Clazz) {\n            cv.ui.structure.tile.components.Plugin.PL_COUNTER++;\n            const id = 'id_9_' + cv.ui.structure.tile.components.Plugin.PL_COUNTER;\n            // must be converted to real XML document, otherwise attributes cannot be accessed\n            const parser = new DOMParser();\n            const doc = parser.parseFromString(this._element.innerHTML, 'application/xml');\n            const props = Clazz.parse(doc.firstElementChild, id, '', 'text');\n            cv.TemplateEngine.getInstance().setDomFinished(false);\n            this.__widget = new Clazz(props);\n            this._element.innerHTML = `<div class=\"widget_container\" id=\"${id}\" data-type=\"${props.$$type}\">${this.__widget.getDomString()}</div>`;\n            const scriptLoader = cv.util.ScriptLoader.getInstance();\n            window.requestAnimationFrame(() => {\n              if (!scriptLoader.isFinished()) {\n                // wait until plugin dependencies have been loaded\n                scriptLoader.addListenerOnce('finished', () => {\n                  cv.TemplateEngine.getInstance().setDomFinished(true);\n                });\n              } else {\n                cv.TemplateEngine.getInstance().setDomFinished(true);\n              }\n            });\n          } else {\n            this.error('no main plugin class found for ' + pluginName);\n          }\n        }\n      } else {\n        this.error('no plugin name provided!');\n      }\n    },\n\n    async loadPluginPart(pluginName) {\n      const part = qx.Part.getInstance().getParts()[pluginName];\n      if (part) {\n        return new Promise(resolve => {\n          part.load(() => resolve(part), this);\n        });\n      }\n      this.error('plugin', pluginName, 'does not exist');\n      return Promise.resolve(null);\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(\n      cv.ui.structure.tile.Controller.PREFIX + 'plugin',\n      class extends QxConnector {\n        constructor() {\n          super(QxClass);\n        }\n      }\n    );\n  }\n});\n"
  ],
  "mappings": "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"
}