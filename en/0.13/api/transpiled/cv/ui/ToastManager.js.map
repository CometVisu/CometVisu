{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "cv",
    "notifications",
    "IHandler",
    "include",
    "ui",
    "MHandleMessage",
    "type",
    "construct",
    "set",
    "rootElementId",
    "messageElementId",
    "setDelegate",
    "prepareMessage",
    "message",
    "prototype",
    "hasOwnProperty",
    "call",
    "duration",
    "getMessageDuration",
    "bind",
    "postHandleMessage",
    "config",
    "payload",
    "action",
    "event",
    "Timer",
    "once",
    "getMessages",
    "remove",
    "util",
    "DeferredCall",
    "TemplateEngine",
    "getInstance",
    "executeWhenDomFinished",
    "_init",
    "schedule",
    "properties",
    "messageDuration",
    "check",
    "init",
    "members",
    "__domElement",
    "__timer",
    "__opened",
    "document",
    "querySelector",
    "getRootElementId",
    "dom",
    "Element",
    "create",
    "id",
    "querySelectorAll",
    "length",
    "body",
    "appendChild",
    "template",
    "html",
    "getMessageElementId",
    "_list",
    "data",
    "controller",
    "website",
    "List",
    "_messages",
    "Registration",
    "addListener",
    "_onListTap",
    "_performAction",
    "actions",
    "deleteMessage",
    "destruct",
    "stop",
    "parentNode",
    "removeChild",
    "ToastManager"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/ToastManager.js"
  ],
  "sourcesContent": [
    "/* ToastManager.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Handles toast positioning in the gui.\n */\nqx.Class.define('cv.ui.ToastManager', {\n  extend: qx.core.Object,\n  implement: cv.core.notifications.IHandler,\n  include: cv.ui.MHandleMessage,\n  type: 'singleton',\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct() {\n    super();\n    this.set({\n      rootElementId: 'toast-list',\n      messageElementId: 'toast_'\n    });\n\n    this.setDelegate({\n      prepareMessage: function (message) {\n        // all toast messages need a duration\n        if (!Object.prototype.hasOwnProperty.call(message, 'duration')) {\n          message.duration = this.getMessageDuration();\n        }\n      }.bind(this),\n      postHandleMessage: function (message, config, payload) {\n        if (payload.action === 'added' || payload.action === 'replaced') {\n          // add removal listener\n          qx.event.Timer.once(\n            function () {\n              this.getMessages().remove(message);\n            },\n            this,\n            message.duration\n          );\n        }\n      }.bind(this)\n    });\n\n    // as the Mixins constructor has not been called yet, the messages array has not been initialized\n    // so we defer this call here to make sure everything is in place\n    new qx.util.DeferredCall(function () {\n      cv.TemplateEngine.getInstance().executeWhenDomFinished(this._init, this);\n    }, this).schedule();\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    /**\n     * Default time in MS a toast message is visible\n     */\n    messageDuration: {\n      check: 'Number',\n      init: 5000\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __domElement: null,\n    __timer: null,\n    __opened: false,\n\n    /**\n     * Attach to dom element and style it\n     */\n    _init() {\n      if (!this.__domElement) {\n        // check if there is one (might be restored from cache)\n        this.__domElement = document.querySelector(this.getRootElementId());\n        if (!this.__domElement) {\n          this.__domElement = qx.dom.Element.create('div', {\n            id: this.getRootElementId()\n          });\n        }\n      }\n      if (document.querySelectorAll(this.getRootElementId()).length === 0) {\n        document.body.appendChild(this.__domElement);\n      }\n      if (document.querySelectorAll('#ToastTemplate').length === 0) {\n        const template = qx.dom.Element.create('script', {\n          id: 'ToastTemplate',\n          type: 'text/template',\n          html:\n            '<div class=\"toast {{severity}}{{#actions}} selectable{{/actions}}\" title=\"{{tooltip}}\" id=\"' +\n            this.getMessageElementId() +\n            '{{ id }}\"><div class=\"content\">{{&message}}</div></div>'\n        });\n\n        document.body.appendChild(template);\n      }\n      this._list = new qx.data.controller.website.List(this._messages, this.__domElement, 'ToastTemplate');\n\n      qx.event.Registration.addListener(this.__domElement, 'tap', this._onListTap, this);\n    },\n\n    _performAction(message) {\n      if (message.actions) {\n        return false;\n      }\n      // default is to delete the toast\n      return this.deleteMessage(message.id);\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct() {\n    if (this.__timer) {\n      this.__timer.stop();\n      this.__timer = null;\n    }\n    if (this.__domElement) {\n      this.__domElement.parentNode.removeChild(this.__domElement);\n      this.__domElement = null;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}