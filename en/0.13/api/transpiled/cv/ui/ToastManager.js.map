{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "cv",
    "notifications",
    "IHandler",
    "include",
    "ui",
    "MHandleMessage",
    "type",
    "construct",
    "constructor",
    "call",
    "set",
    "rootElementId",
    "messageElementId",
    "setDelegate",
    "prepareMessage",
    "message",
    "prototype",
    "hasOwnProperty",
    "duration",
    "getMessageDuration",
    "bind",
    "postHandleMessage",
    "config",
    "payload",
    "action",
    "event",
    "Timer",
    "once",
    "getMessages",
    "remove",
    "util",
    "DeferredCall",
    "TemplateEngine",
    "getInstance",
    "executeWhenDomFinished",
    "_init",
    "schedule",
    "properties",
    "messageDuration",
    "check",
    "init",
    "members",
    "__domElement",
    "__timer",
    "__opened",
    "document",
    "querySelector",
    "getRootElementId",
    "dom",
    "Element",
    "create",
    "id",
    "querySelectorAll",
    "length",
    "body",
    "appendChild",
    "template",
    "html",
    "getMessageElementId",
    "_list",
    "data",
    "controller",
    "website",
    "List",
    "_messages",
    "Registration",
    "addListener",
    "_onListTap",
    "_performAction",
    "actions",
    "deleteMessage",
    "destruct",
    "stop",
    "parentNode",
    "removeChild",
    "ToastManager"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/ToastManager.js"
  ],
  "sourcesContent": [
    "/* ToastManager.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Handles toast positioning in the gui.\n */\nqx.Class.define('cv.ui.ToastManager', {\n  extend: qx.core.Object,\n  implement: cv.core.notifications.IHandler,\n  include: cv.ui.MHandleMessage,\n  type: 'singleton',\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct() {\n    super();\n    this.set({\n      rootElementId: 'toast-list',\n      messageElementId: 'toast_'\n    });\n\n    this.setDelegate({\n      prepareMessage: function (message) {\n        // all toast messages need a duration\n        if (!Object.prototype.hasOwnProperty.call(message, 'duration')) {\n          message.duration = this.getMessageDuration();\n        }\n      }.bind(this),\n      postHandleMessage: function (message, config, payload) {\n        if (payload.action === 'added' || payload.action === 'replaced') {\n          // add removal listener\n          qx.event.Timer.once(\n            function () {\n              this.getMessages().remove(message);\n            },\n            this,\n            message.duration\n          );\n        }\n      }.bind(this)\n    });\n\n    // as the Mixins constructor has not been called yet, the messages array has not been initialized\n    // so we defer this call here to make sure everything is in place\n    new qx.util.DeferredCall(function () {\n      cv.TemplateEngine.getInstance().executeWhenDomFinished(this._init, this);\n    }, this).schedule();\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    /**\n     * Default time in MS a toast message is visible\n     */\n    messageDuration: {\n      check: 'Number',\n      init: 5000\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __domElement: null,\n    __timer: null,\n    __opened: false,\n\n    /**\n     * Attach to dom element and style it\n     */\n    _init() {\n      if (!this.__domElement) {\n        // check if there is one (might be restored from cache)\n        this.__domElement = document.querySelector(this.getRootElementId());\n        if (!this.__domElement) {\n          this.__domElement = qx.dom.Element.create('div', {\n            id: this.getRootElementId()\n          });\n        }\n      }\n      if (document.querySelectorAll(this.getRootElementId()).length === 0) {\n        document.body.appendChild(this.__domElement);\n      }\n      if (document.querySelectorAll('#ToastTemplate').length === 0) {\n        const template = qx.dom.Element.create('script', {\n          id: 'ToastTemplate',\n          type: 'text/template',\n          html:\n            '<div class=\"toast {{severity}}{{#actions}} selectable{{/actions}}\" title=\"{{tooltip}}\" id=\"' +\n            this.getMessageElementId() +\n            '{{ id }}\"><div class=\"content\">{{&message}}</div></div>'\n        });\n\n        document.body.appendChild(template);\n      }\n      this._list = new qx.data.controller.website.List(this._messages, this.__domElement, 'ToastTemplate');\n\n      qx.event.Registration.addListener(this.__domElement, 'tap', this._onListTap, this);\n    },\n\n    _performAction(message) {\n      if (message.actions) {\n        return false;\n      }\n      // default is to delete the toast\n      return this.deleteMessage(message.id);\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct() {\n    if (this.__timer) {\n      this.__timer.stop();\n      this.__timer = null;\n    }\n    if (this.__domElement) {\n      this.__domElement.parentNode.removeChild(this.__domElement);\n      this.__domElement = null;\n    }\n  }\n});\n"
  ],
  "mappings": "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",
  "ignoreList": []
}