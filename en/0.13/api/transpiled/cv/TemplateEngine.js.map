{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "lazyPlugins",
    "__partQueue",
    "data",
    "Array",
    "_domFinishedQueue",
    "addListener",
    "ev",
    "setPartsLoaded",
    "getData",
    "__clients",
    "defaults",
    "widget",
    "plugin",
    "group",
    "ui",
    "command",
    "Group",
    "setCommands",
    "app",
    "Init",
    "getApplication",
    "manager",
    "getCommandManager",
    "add",
    "setActive",
    "properties",
    "partsLoaded",
    "check",
    "init",
    "apply",
    "event",
    "scriptsLoaded",
    "ready",
    "currentPage",
    "nullable",
    "domFinished",
    "commands",
    "highlightedWidget",
    "configSource",
    "configHash",
    "members",
    "pluginsToLoadCount",
    "_applyConfigSource",
    "xml",
    "cv",
    "Config",
    "enableCache",
    "setConfigHash",
    "ConfigCache",
    "toHash",
    "resetConfigHash",
    "loadParts",
    "parts",
    "isArray",
    "loadLazyParts",
    "filter",
    "part",
    "indexOf",
    "length",
    "p",
    "includes",
    "append",
    "waitingFor",
    "io",
    "PartLoader",
    "require",
    "states",
    "forEach",
    "idx",
    "remove",
    "debug",
    "startsWith",
    "loadedStructure",
    "substring",
    "setStructureLoaded",
    "error",
    "Promise",
    "resolve",
    "reject",
    "timer",
    "setTimeout",
    "getLength",
    "clearTimeout",
    "_applyReady",
    "value",
    "setupUI",
    "_applyLoaded",
    "old",
    "name",
    "isPartsLoaded",
    "isScriptsLoaded",
    "setReady",
    "_applyDomFinished",
    "document",
    "body",
    "style",
    "visibility",
    "message",
    "Bus",
    "dispatchByName",
    "entry",
    "callback",
    "shift",
    "context",
    "BackendConnections",
    "initSystemBackend",
    "executeWhenDomFinished",
    "isDomFinished",
    "push",
    "prototype",
    "slice",
    "call",
    "arguments",
    "parse",
    "settings",
    "configSettings",
    "rootNode",
    "getConfigSource",
    "documentElement",
    "predefinedDesign",
    "getAttribute",
    "tagName",
    "toLowerCase",
    "clientDesign",
    "selectDesign",
    "scriptsToLoad",
    "stylesToLoad",
    "design",
    "getDesign",
    "baseUri",
    "uri",
    "media",
    "maxMobileScreenWidth",
    "loader",
    "util",
    "ScriptLoader",
    "getInstance",
    "addListenerOnce",
    "alternativeStyles",
    "maxMobileScreenWidthh",
    "addStyles",
    "addScripts",
    "getStructure",
    "Application",
    "structureController",
    "parseBackendSettings",
    "initBackendClient",
    "parseSettings",
    "preParse",
    "createUI",
    "resetConfigSource",
    "startScreensaver",
    "screensave_time",
    "screensave",
    "Timer",
    "doScreenSave",
    "start",
    "Registration",
    "window",
    "restart",
    "_applyHighlightedWidget",
    "oldElement",
    "querySelector",
    "classList",
    "element",
    "querySelectorAll",
    "elem",
    "display",
    "div",
    "dom",
    "Element",
    "create",
    "id",
    "entries",
    "background",
    "width",
    "color",
    "margin",
    "padding",
    "key_value",
    "innerHTML",
    "appendChild",
    "store",
    "Json",
    "ResourceManager",
    "toUri",
    "html",
    "getModel",
    "myDiv",
    "cursor",
    "borderBottom",
    "position",
    "tDiv",
    "height",
    "zIndex",
    "pos",
    "getBoundingClientRect",
    "left",
    "top",
    "href",
    "location",
    "hash",
    "split",
    "search",
    "destruct",
    "_disposeObjects",
    "TemplateEngine"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/TemplateEngine.js"
  ],
  "sourcesContent": [
    "/* TemplateEngine.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.TemplateEngine', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  construct() {\n    // this.base(arguments);\n    this.lazyPlugins = ['plugin-openhab'];\n\n    this.__partQueue = new qx.data.Array();\n    this._domFinishedQueue = [];\n    this.__partQueue.addListener('changeLength', ev => {\n      this.setPartsLoaded(ev.getData() === 0);\n    });\n    this.__clients = {};\n\n    this.defaults = { widget: {}, plugin: {} };\n    const group = new qx.ui.command.Group();\n    this.setCommands(group);\n    const app = qx.core.Init.getApplication();\n    if (app) {\n      // application is not available in tests\n      const manager = app.getCommandManager();\n      manager.add(group);\n      manager.setActive(group);\n    }\n  },\n\n  properties: {\n    /**\n     * Shows the loading state of the parts\n     */\n    partsLoaded: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyLoaded',\n      event: 'changePartsLoaded'\n    },\n\n    /**\n     * Shows the loading state of the scripts\n     */\n    scriptsLoaded: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyLoaded'\n    },\n\n    /**\n     * Shows the initialization state of the TemplateEngine. It gets true when all\n     * external stuff (parts, scripts, etc.) has been loaded.\n     */\n    ready: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReady',\n      apply: '_applyReady'\n    },\n\n    currentPage: {\n      check: 'cv.ui.structure.IPage',\n      nullable: true,\n      event: 'changeCurrentPage'\n    },\n\n    domFinished: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDomFinished',\n      event: 'changeDomFinished'\n    },\n\n    commands: {\n      check: 'qx.ui.command.Group',\n      nullable: true\n    },\n\n    // highlight a widget\n    highlightedWidget: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyHighlightedWidget'\n    },\n\n    configSource: {\n      check: 'XMLDocument',\n      nullable: true,\n      apply: '_applyConfigSource'\n    },\n\n    configHash: {\n      check: 'Number',\n      nullable: true\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    /**\n     * Structure where a design can set a default value that a widget or plugin\n     * can use.\n     * This is especially important for design relevant information like colors\n     * that can not be set though CSS.\n     *\n     * Usage: this.defaults.plugin.foo = {bar: 'baz'};\n     */\n    defaults: null,\n\n    pluginsToLoadCount: 0,\n\n    __partQueue: null,\n    _domFinishedQueue: null,\n\n    // plugins that do not need to be loaded to proceed with the initial setup\n    lazyPlugins: null,\n\n    _applyConfigSource(xml) {\n      if (cv.Config.enableCache && xml) {\n        this.setConfigHash(cv.ConfigCache.toHash(xml));\n      } else {\n        this.resetConfigHash();\n      }\n    },\n\n    /**\n     * Load parts (e.g. plugins, structure)\n     *\n     * @param parts {String[]|String} parts to load\n     */\n    loadParts(parts) {\n      if (!Array.isArray(parts)) {\n        parts = [parts];\n      }\n      const loadLazyParts = this.lazyPlugins.filter(function (part) {\n        return parts.indexOf(part) >= 0;\n      });\n      if (loadLazyParts.length) {\n        parts = parts.filter(function (p) {\n          return !loadLazyParts.includes(p);\n        });\n      }\n      this.__partQueue.append(parts);\n      const waitingFor = new qx.data.Array(parts);\n      qx.io.PartLoader.require(\n        parts,\n        function (states) {\n          parts.forEach(function (part, idx) {\n            if (states[idx] === 'complete') {\n              this.__partQueue.remove(part);\n              this.debug('successfully loaded part ' + part);\n              if (part.startsWith('structure-')) {\n                if (!cv.Config.loadedStructure) {\n                  cv.Config.loadedStructure = part.substring(10);\n                }\n                qx.core.Init.getApplication().setStructureLoaded(true);\n              }\n              this.__partQueue.remove(part);\n              waitingFor.remove(part);\n            } else {\n              this.error('error loading part ' + part);\n            }\n          }, this);\n        },\n        this\n      );\n\n      // load the lazy plugins no one needs to wait for\n      qx.io.PartLoader.require(\n        loadLazyParts,\n        function (states) {\n          loadLazyParts.forEach(function (part, idx) {\n            if (states[idx] === 'complete') {\n              this.debug('successfully loaded lazy part ' + part);\n              waitingFor.remove(part);\n            } else {\n              this.error('error loading lazy part ' + part);\n            }\n          }, this);\n        },\n        this\n      );\n\n      return new Promise((resolve, reject) => {\n        const timer = setTimeout(reject, 2000);\n        if (waitingFor.getLength() === 0) {\n          resolve();\n          clearTimeout(timer);\n        } else {\n          waitingFor.addListener('changeLength', ev => {\n            if (ev.getData() === 0) {\n              resolve();\n              clearTimeout(timer);\n            }\n          });\n        }\n      });\n    },\n\n    // property apply\n    _applyReady(value) {\n      if (value === true) {\n        this.setupUI();\n      }\n    },\n\n    // property apply\n    _applyLoaded(value, old, name) {\n      this.debug(name + ' is ' + value + ' now');\n      if (this.isPartsLoaded() && this.isScriptsLoaded()) {\n        this.setReady(true);\n      }\n    },\n\n    // property apply\n    _applyDomFinished(value) {\n      if (value) {\n        document.body.style.visibility = '';\n        qx.event.message.Bus.dispatchByName('setup.dom.finished');\n        // flush the queue\n        this._domFinishedQueue.forEach(function (entry) {\n          const callback = entry.shift();\n          const context = entry.shift();\n          callback.apply(context, entry);\n        }, this);\n        this._domFinishedQueue = [];\n        cv.io.BackendConnections.initSystemBackend();\n      }\n    },\n\n    /**\n     * Adds a callback to a queue which is executed after DOM has been rendered\n     * @param callback {Function}\n     * @param context {Object}\n     */\n    executeWhenDomFinished(callback, context) {\n      if (!this.isDomFinished()) {\n        // queue callback\n        this._domFinishedQueue.push(Array.prototype.slice.call(arguments));\n      } else {\n        callback.apply(context, Array.prototype.slice.call(arguments, 2));\n      }\n    },\n\n    /**\n     * Read basic settings and detect and load the structure for this config to do the rest.\n     */\n    async parse() {\n      /*\n       * First, we try to get a design by url. Secondly, we try to get a predefined\n       */\n      // read predefined design in config\n      const settings = cv.Config.configSettings;\n      // all config files must have a root with some attributes to be able to detect at least the design\n      // if not provides via URL, because the design is needed to detect the structure that can load the config\n      const rootNode = this.getConfigSource().documentElement;\n\n      const xml = this.getConfigSource();\n\n      let predefinedDesign = rootNode.getAttribute('design');\n      if (!predefinedDesign) {\n        switch (rootNode.tagName.toLowerCase()) {\n          case 'config':\n            predefinedDesign = 'tile';\n            break;\n\n          case 'pages':\n            predefinedDesign = 'pure';\n            break;\n        }\n      }\n      // design by url\n      // design by config file\n      if (!cv.Config.clientDesign && !settings.clientDesign) {\n        if (predefinedDesign) {\n          settings.clientDesign = predefinedDesign;\n        } else {\n          // selection dialog\n          this.selectDesign();\n        }\n      }\n\n      settings.scriptsToLoad = [];\n      settings.stylesToLoad = [];\n      const design = cv.Config.getDesign();\n      if (design) {\n        let baseUri = 'designs/' + design;\n        settings.stylesToLoad.push(baseUri + '/basic.css');\n        settings.stylesToLoad.push({\n          uri: baseUri + '/mobile.css',\n          media: `screen and (max-width:${cv.Config.maxMobileScreenWidth}px)`\n        });\n\n        settings.stylesToLoad.push(baseUri + '/custom.css');\n        settings.scriptsToLoad.push('designs/' + design + '/design_setup.js');\n\n        const loader = cv.util.ScriptLoader.getInstance();\n        loader.addListenerOnce('designError', ev => {\n          if (ev.getData() === design) {\n            this.error(\n              'Failed to load \"' + design + '\" design! Falling back to simplified \"' + cv.Config.loadedStructure + '\"'\n            );\n\n            baseUri = 'designs/' + cv.Config.loadedStructure;\n            const alternativeStyles = [baseUri + '/basic.css'];\n            alternativeStyles.push({\n              uri: baseUri + '/mobile.css',\n              media: `screen and (max-width:${cv.Config.maxMobileScreenWidthh}px)`\n            });\n\n            alternativeStyles.push(baseUri + '/custom.css');\n            cv.util.ScriptLoader.getInstance().addStyles(alternativeStyles);\n            cv.util.ScriptLoader.getInstance().addScripts(baseUri + '/design_setup.js');\n          }\n        });\n      }\n      // load structure-part\n      await this.loadParts([cv.Config.getStructure()]);\n      if (cv.Application.structureController.parseBackendSettings(xml)) {\n        cv.io.BackendConnections.initBackendClient();\n      }\n      cv.Application.structureController.parseSettings(xml);\n      await cv.Application.structureController.preParse(xml);\n    },\n\n    /**\n     * Main setup to get everything running and show the initial UI page.\n     */\n    setupUI() {\n      // and now setup the UI\n      this.debug('setup');\n      cv.Application.structureController.createUI(this.getConfigSource());\n      this.resetConfigSource(); // not needed anymore - free the space\n      this.startScreensaver();\n      if (qx.core.Environment.get('qx.aspects')) {\n        qx.dev.Profile.stop();\n        qx.dev.Profile.showResults(50);\n      }\n    },\n\n    /**\n     * Start the screensaver if a screensave time is set\n     */\n    startScreensaver() {\n      if (typeof cv.Config.configSettings.screensave_time === 'number') {\n        this.screensave = new qx.event.Timer(cv.Config.configSettings.screensave_time * 1000);\n\n        this.screensave.addListener(\n          'interval',\n          cv.Application.structureController.doScreenSave,\n          cv.Application.structureController\n        );\n\n        this.screensave.start();\n        qx.event.Registration.addListener(window, 'useraction', this.screensave.restart, this.screensave);\n      }\n    },\n\n    _applyHighlightedWidget(value, old) {\n      if (old) {\n        const oldElement = document.querySelector(old);\n        if (oldElement) {\n          oldElement.classList.remove('highlightedWidget');\n        }\n      }\n      if (value) {\n        const element = document.querySelector(value);\n        if (element) {\n          element.classList.add('highlightedWidget');\n        }\n      }\n    },\n\n    selectDesign() {\n      const body = document.querySelector('body');\n\n      document.querySelectorAll('body > *').forEach(function (elem) {\n        elem.style.display = 'none';\n      }, this);\n      body.style['background-color'] = 'black';\n\n      const div = qx.dom.Element.create('div', { id: 'designSelector' });\n      Object.entries({\n        background: '#808080',\n        width: '400px',\n        color: 'white',\n        margin: 'auto',\n        padding: '0.5em'\n      }).forEach(function (key_value) {\n        body.style[key_value[0]] = key_value[1];\n      });\n      div.innerHTML = 'Loading ...';\n\n      body.appendChild(div);\n\n      const store = new qx.data.store.Json(qx.util.ResourceManager.getInstance().toUri('designs/get_designs.php'));\n\n      store.addListener('loaded', function () {\n        let html = '<h1>Please select design</h1>';\n        html +=\n          '<p>The Location/URL will change after you have chosen your design. Please bookmark the new URL if you do not want to select the design every time.</p>';\n\n        div.innerHTML = html;\n\n        store.getModel().forEach(function (element) {\n          const myDiv = qx.dom.Element.create('div', {\n            cursor: 'pointer',\n            padding: '0.5em 1em',\n            borderBottom: '1px solid black',\n            margin: 'auto',\n            width: '262px',\n            position: 'relative'\n          });\n\n          myDiv.innerHTML = '<div style=\"font-weight: bold; margin: 1em 0 .5em;\">Design: ' + element + '</div>';\n          myDiv.innerHTML +=\n            '<iframe src=\"' +\n            qx.util.ResourceManager.getInstance().toUri('designs/design_preview.html') +\n            '?design=' +\n            element +\n            '\" width=\"160\" height=\"90\" border=\"0\" scrolling=\"auto\" frameborder=\"0\" style=\"z-index: 1;\"></iframe>';\n          myDiv.innerHTML +=\n            '<img width=\"60\" height=\"30\" src=\"' +\n            qx.util.ResourceManager.getInstance().toUri('demo/media/arrow.png') +\n            '\" alt=\"select\" border=\"0\" style=\"margin: 60px 10px 10px 30px;\"/>';\n\n          div.appendChild(myDiv);\n\n          const tDiv = qx.dom.Element.create('div', {\n            background: 'transparent',\n            position: 'absolute',\n            height: '90px',\n            width: '160px',\n            zIndex: 2\n          });\n\n          const pos = document.querySelector('iframe').getBoundingClientRect();\n          Object.entries({\n            left: pos.left + 'px',\n            top: pos.top + 'px'\n          }).forEach(function (key_value) {\n            tDiv.style[key_value[0]] = key_value[1];\n          });\n          myDiv.appendChild(tDiv);\n\n          qx.event.Registration.addListener(\n            myDiv,\n            'pointerover',\n            function () {\n              myDiv.style.background = '#bbbbbb';\n            },\n            this\n          );\n\n          qx.event.Registration.addListener(\n            myDiv,\n            'pointerout',\n            function () {\n              myDiv.style.background = 'transparent';\n            },\n            this\n          );\n\n          qx.event.Registration.addListener(myDiv, 'tap', function () {\n            let href = document.location.href;\n            if (document.location.hash) {\n              href = href.split('#')[0];\n            }\n            if (document.location.search === '') {\n              document.location.href = href + '?design=' + element;\n            } else {\n              document.location.href = href + '&design=' + element;\n            }\n          });\n        });\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._disposeObjects('__activeChangedTimer');\n  }\n});\n"
  ],
  "mappings": "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"
}