{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/util/ScriptLoader.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "__scriptQueue",
    "data",
    "Array",
    "__loaders",
    "__delayedScriptQueue",
    "__markedAsLoaded",
    "statics",
    "markAsLoaded",
    "path",
    "getInstance",
    "isMarkedAsLoaded",
    "includeStylesheet",
    "href",
    "media",
    "Promise",
    "res",
    "rej",
    "el",
    "document",
    "createElement",
    "rel",
    "onload",
    "onerror",
    "log",
    "Logger",
    "error",
    "head",
    "getElementsByTagName",
    "appendChild",
    "includeScript",
    "src",
    "querySelector",
    "properties",
    "allQueued",
    "check",
    "init",
    "apply",
    "event",
    "finished",
    "events",
    "members",
    "__listener",
    "addStyles",
    "styleArr",
    "queue",
    "concat",
    "suffix",
    "cv",
    "Config",
    "forceReload",
    "Date",
    "now",
    "promises",
    "forEach",
    "style",
    "uri",
    "resPath",
    "util",
    "ResourceManager",
    "toUri",
    "scssStyle",
    "replace",
    "scssPath",
    "push",
    "ScriptLoader",
    "all",
    "then",
    "debug",
    "fireEvent",
    "reason",
    "includes",
    "addScripts",
    "scriptArr",
    "order",
    "realQueue",
    "i",
    "l",
    "length",
    "resetFinished",
    "append",
    "processQueue",
    "loadIndex",
    "shift",
    "script",
    "splice",
    "loader",
    "__loadSingleScript",
    "addListener",
    "bind",
    "DynamicScriptLoader",
    "_onLoaded",
    "_onFailed",
    "addListenerOnce",
    "remove",
    "removeListener",
    "start",
    "ev",
    "getData",
    "_checkQueue",
    "startsWith",
    "failedDesign",
    "split",
    "fireDataEvent",
    "match",
    "exec",
    "notifications",
    "Router",
    "dispatchMessage",
    "title",
    "locale",
    "Manager",
    "tr",
    "message",
    "severity",
    "deletable",
    "isAllQueued",
    "setFinished",
    "removeListenerById"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ScriptLoader.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\nqx.Class.define('cv.util.ScriptLoader', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function() {\n    this.base(arguments);\n    this.__scriptQueue = new qx.data.Array();\n    this.__loaders = new qx.data.Array();\n    this.__delayedScriptQueue = new qx.data.Array();\n    this.__markedAsLoaded = [];\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    markAsLoaded: function (path) {\n      return this.getInstance().markAsLoaded(path);\n    },\n\n    isMarkedAsLoaded: function (path) {\n      return this.getInstance().isMarkedAsLoaded(path);\n    },\n\n    /**\n     * Include a CSS file\n     *\n     * @param href {String} Href value\n     * @param media {string?} Content of the media attribute\n     */\n    includeStylesheet(href, media) {\n      return new Promise((res, rej) => {\n        const el = document.createElement('link');\n        el.type = 'text/css';\n        el.rel = 'stylesheet';\n        el.href = href;\n        if (media) {\n          el.media = media;\n        }\n        el.onload = res;\n        el.onerror = () => {\n          qx.log.Logger.error(this, 'error loading ' + href);\n          // always resolve\n          res();\n        };\n        const head = document.getElementsByTagName('head')[0];\n        head.appendChild(el);\n      });\n    },\n\n    /**\n     * Include a JS file with module support\n     *\n     * @param src {String} Href value\n     * @param type {string?} Content of the type attribute\n     */\n    includeScript(src, type) {\n      return new Promise((res, rej) => {\n        const head = document.getElementsByTagName('head')[0];\n        if (!head.querySelector(`:scope > script[src='${src}']`)) {\n          const el = document.createElement('script');\n          if (type) {\n            el.type = type;\n          }\n          el.onload = res;\n          el.onerror = rej;\n          el.src = src;\n          head.appendChild(el);\n        } else {\n          res();\n        }\n      });\n    }\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    allQueued: {\n      check: 'Boolean',\n      init: false,\n      apply: '_checkQueue',\n      event: 'changeAllQueued'\n    },\n    finished: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeFinished'\n    }\n  },\n\n  /*\n  ******************************************************\n    EVENTS\n  ******************************************************\n  */\n  events: {\n    'finished': 'qx.event.type.Event',\n    'stylesLoaded': 'qx.event.type.Event',\n    'designError': 'qx.event.type.Data'\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __scriptQueue: null,\n    __loaders: null,\n    __listener : null,\n    __markedAsLoaded: null,\n\n    addStyles: function(styleArr) {\n      const queue = (typeof styleArr === 'string' ? [styleArr] : styleArr.concat());\n      const suffix = (cv.Config.forceReload === true) ? '?' + Date.now() : '';\n      let promises = [];\n      queue.forEach(function(style) {\n        let media;\n        let src;\n        if (typeof style === 'string') {\n          src = style;\n        } else if (typeof style === 'object') {\n          src = style.uri;\n          media = style.media;\n        } else {\n          this.error('unknown style parameter type', typeof style);\n        }\n        if (src) {\n          let resPath = qx.util.ResourceManager.getInstance().toUri(src);\n          if (resPath === src) {\n            // this file is unknown to the resource manager, might be a scss source\n            const scssStyle = src.replace(/\\.css$/, '.scss');\n            const scssPath = qx.util.ResourceManager.getInstance().toUri(scssStyle);\n            if (scssStyle !== scssPath) {\n              resPath = scssPath.replace(/\\.scss$/, '.css');\n            }\n          }\n          promises.push(cv.util.ScriptLoader.includeStylesheet(resPath + suffix, media));\n        }\n      }, this);\n      Promise.all(promises)\n        .then(() => {\n          this.debug('styles have been loaded');\n          this.fireEvent('stylesLoaded');\n        }).catch(reason => {\n            this.error('error loading styles', reason);\n            // fire this event anyways, because a non loaded CSS file is no blocker\n            this.fireEvent('stylesLoaded');\n        });\n    },\n\n    markAsLoaded: function (path) {\n      if (!this.__markedAsLoaded.includes(path)) {\n        this.debug('marking ' + path + ' as loaded');\n        this.__markedAsLoaded.push(path);\n      }\n    },\n\n    isMarkedAsLoaded: function (path) {\n      return this.__markedAsLoaded.includes(path);\n    },\n\n    addScripts: function(scriptArr, order) {\n      const queue = (typeof scriptArr === 'string' ? [scriptArr] : scriptArr);\n      // make sure that no cached scripts are loaded\n      const suffix = (cv.Config.forceReload === true) ? '?' + Date.now() : '';\n      const realQueue = [];\n      let i = 0;\n      const l = queue.length;\n      for (; i<l; i++) {\n        if (!this.__markedAsLoaded.includes(queue[i])) {\n          realQueue.push(qx.util.ResourceManager.getInstance().toUri(queue[i]) + suffix);\n        }\n      }\n      if (realQueue.length === 0) {\n        return;\n      }\n      this.debug('queueing '+realQueue.length+' scripts');\n      this.resetFinished();\n      this.__scriptQueue.append(realQueue);\n      if (order) {\n        const processQueue = function () {\n          if (order.length > 0) {\n            const loadIndex = order.shift();\n            const script = realQueue.splice(loadIndex, 1)[0];\n            const loader = this.__loadSingleScript(script);\n            loader.addListener('ready', processQueue, this);\n          } else {\n            realQueue.forEach(this.__loadSingleScript, this);\n          }\n        }.bind(this);\n        processQueue();\n      } else {\n        // use an extra DynamicScriptLoader for every single script because loading errors stop the process\n        // and the loader would not try to load the other scripts\n        // queue.forEach(this.__loadSingleScript, this);\n        this.__loadSingleScript(realQueue);\n      }\n    },\n\n    /**\n     * Load one script\n     *\n     * @param script {String} path to script\n     */\n    __loadSingleScript: function(script) {\n      const loader = new qx.util.DynamicScriptLoader(script);\n      this.__loaders.push(loader);\n      loader.addListener('loaded', this._onLoaded, this);\n      loader.addListener('failed', this._onFailed, this);\n      loader.addListenerOnce('ready', function() {\n        this.__loaders.remove(loader);\n        loader.removeListener('loaded', this._onLoaded, this);\n        loader.removeListener('failed', this._onFailed, this);\n      }, this);\n      loader.start();\n      return loader;\n    },\n\n    _onLoaded: function(ev) {\n      const data = ev.getData();\n      this.__scriptQueue.remove(data.script);\n      this.debug(data.script+' loaded');\n      this._checkQueue();\n    },\n\n    _onFailed: function(ev) {\n      const data = ev.getData();\n      this.__scriptQueue.remove(data.script);\n      if (data.script.startsWith('design')) {\n        const failedDesign = data.script.split('/')[1];\n        this.fireDataEvent('designError', failedDesign);\n      } else if (data.script.includes('/plugins/')) {\n        const match = /.+\\/plugins\\/([\\w]+)\\/index\\.js.*/.exec(data.script);\n        if (match) {\n          cv.core.notifications.Router.dispatchMessage('cv.loading.error', {\n            title: qx.locale.Manager.tr('Error loading plugin \"%1\"', match[1]),\n            message: qx.locale.Manager.tr('File %1 could not be loaded.', data.script),\n            severity: 'high',\n            deletable: true\n          });\n        }\n      } else {\n        cv.core.notifications.Router.dispatchMessage('cv.loading.error', {\n          title: qx.locale.Manager.tr('File loading error'),\n          message:  qx.locale.Manager.tr('File %1 could not be loaded.', data.script),\n          severity: 'high',\n          deletable: true\n        });\n      }\n      this._checkQueue();\n    },\n\n    // property apply\n    _checkQueue: function() {\n      if (this.__scriptQueue.length === 0) {\n        if (this.isAllQueued()) {\n          this.debug('script loader finished');\n          this.fireEvent('finished');\n          this.setFinished(true);\n        } else if (!this.__listener) {\n          this.debug('script loader waiting for all scripts beeing queued');\n\n          this.__listener = this.addListener('changeAllQueued', function(ev) {\n            if (ev.getData() === true) {\n              if (this.__scriptQueue.length === 0) {\n                this.debug('script loader finished');\n                this.fireEvent('finished');\n                this.setFinished(true);\n              }\n              this.removeListenerById(this.__listener);\n              this.__listener = null;\n            }\n          }, this);\n        }\n      } else {\n        this.debug(this.__scriptQueue.length+' scripts remaining');\n      }\n    }\n  }\n});\n"
  ]
}