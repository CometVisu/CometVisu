{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "statics",
    "isChildOf",
    "child",
    "parent",
    "parentNode",
    "getChildWidgets",
    "widget",
    "getChildren",
    "filter",
    "get$$type",
    "getParentWidget",
    "getParentPageData",
    "path",
    "data",
    "isPage",
    "substr",
    "length",
    "parentPath",
    "model",
    "cv",
    "Model",
    "getInstance",
    "Object",
    "keys",
    "getWidgetData",
    "parts",
    "split",
    "pop",
    "join",
    "getParentData",
    "traverseUp",
    "children",
    "indexOf",
    "getChildElements",
    "element",
    "selector",
    "Array",
    "from",
    "childNodes",
    "prototype",
    "call",
    "m",
    "matches",
    "getParentPage",
    "getParent",
    "getParentGroup",
    "until",
    "limit",
    "parents",
    "getAttribute",
    "found",
    "concat",
    "getClosest",
    "elem",
    "findClosest",
    "current",
    "util",
    "Tree"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/util/Tree.js"
  ],
  "sourcesContent": [
    "/* Tree.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Tree\n *\n * @author tobiasb\n * @since 2016\n */\n\n/**\n * Helper methods for the widget/dom tree\n */\nqx.Class.define('cv.util.Tree', {\n  type: 'static',\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Checks if child is a child of parent\n     * @param child {Node}\n     * @param parent {Node}\n     * @return {boolean}\n     */\n    isChildOf(child, parent) {\n      while (child && child !== parent) {\n        child = child.parentNode;\n      }\n      return !!child;\n    },\n\n    /*\n     * *********************************************************\n     * Widget tree helper functions\n     * ********************************************************\n     */\n    getChildWidgets(widget, type) {\n      return widget.getChildren().filter(function (child) {\n        return !type || child.get$$type() === type;\n      });\n    },\n\n    /**\n     * Get the parent widget with optional type filter\n     *\n     * @param widget {cv.ui.structure.pure.AbstractWidget} start traversing up the with this widget\n     * @param type {String?} only return parent of this type\n     * @return {cv.ui.structure.pure.AbstractWidget|null}\n     */\n    getParentWidget(widget, type) {\n      let parent = widget.getParentWidget();\n      while (parent) {\n        if (!type || parent.get$$type() === type) {\n          return parent;\n        }\n        parent = parent.getParentWidget();\n      }\n      return null;\n    },\n\n    /*\n     * *********************************************************\n     * Widget data tree helper functions\n     * ********************************************************\n     */\n    getParentPageData(path) {\n      let data = {};\n      const isPage = path.substr(-1, 1) === '_'; // path ends with _\n      if (!isPage) {\n        path = path.substr(0, path.length - 1);\n      }\n      let parentPath = path;\n      if (parentPath === 'id_') {\n        return null;\n      }\n      const model = cv.data.Model.getInstance();\n      while (Object.keys(data).length === 0 && parentPath.length > 2) {\n        data = model.getWidgetData(parentPath);\n        if (parentPath === 'id_') {\n          break;\n        }\n        const parts = parentPath.substr(0, parentPath.length - 1).split('_');\n        parts.pop();\n        parentPath = parts.join('_') + '_';\n      }\n      return data;\n    },\n\n    /**\n     * Returns the data for the parent entry of the given path\n     * @param path {String}\n     * @return {var}\n     */\n    getParentData(path) {\n      let data = {};\n\n      /**\n       * @param path\n       */\n      function traverseUp(path) {\n        const parts = path.split('_');\n        if (parts[parts.length - 1] === '') {\n          parts.pop();\n        } else {\n          parts[parts.length - 1] = '';\n        }\n        return parts.join('_');\n      }\n\n      let parentPath = traverseUp(path);\n      if (parentPath === 'id') {\n        // no parent\n        return null;\n      }\n\n      const model = cv.data.Model.getInstance();\n      while (parentPath.length >= 2) {\n        data = model.getWidgetData(parentPath);\n        if (parentPath === 'id_' || (data.children && data.children.indexOf(path) >= 0)) {\n          return data;\n        }\n        parentPath = traverseUp(parentPath);\n      }\n      return null;\n    },\n\n    /*\n     * *********************************************************\n     * DOM-Element tree helper functions\n     * ********************************************************\n     */\n    getChildElements(element, selector) {\n      return Array.from(element.childNodes).filter(function (child) {\n        if (selector) {\n          return Array.prototype.filter.call(child, function (m) {\n            return m.matches(selector);\n          });\n        }\n        return true;\n      }, this);\n    },\n\n    getParentPage(element) {\n      return this.getParent(element, '#pages', '.page', 1)[0];\n    },\n\n    getParentGroup(element) {\n      return this.getParent(element, '#pages', '.group', 1)[0];\n    },\n\n    getParent(element, until, selector, limit) {\n      let parents = [];\n      let parent = element.parentNode;\n      while (parent && parent.getAttribute('id') !== 'pages') {\n        let found = [parent];\n        if (selector) {\n          found = Array.prototype.filter.call(found, function (m) {\n            return m.matches(selector);\n          });\n        }\n        parents = parents.concat(found);\n        if (limit && parents.length >= limit) {\n          break;\n        }\n        if (\n          until &&\n          Array.prototype.filter.call([parent], function (m) {\n            return m.matches(until);\n          }).length > 0\n        ) {\n          break;\n        }\n        parent = parent.parentNode;\n      }\n      return parents;\n    },\n\n    getClosest(elem, selector) {\n      const findClosest = function (current) {\n        const found = Array.prototype.filter.call([current], function (m) {\n          return m.matches(selector);\n        });\n        if (found.length) {\n          return found[0];\n        }\n        current = current.parentNode; // One up\n        if (current && current.parentNode) {\n          return findClosest(current);\n        }\n        return null;\n      };\n      return findClosest(elem);\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}