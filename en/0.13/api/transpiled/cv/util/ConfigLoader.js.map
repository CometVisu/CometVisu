{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "__loadQueue",
    "data",
    "Array",
    "members",
    "__doneCallback",
    "__doneCallbackContext",
    "__xml",
    "load",
    "callback",
    "context",
    "uri",
    "util",
    "ResourceManager",
    "getInstance",
    "toUri",
    "cv",
    "Config",
    "configSuffix",
    "testMode",
    "indexOf",
    "replace",
    "debug",
    "ajaxRequest",
    "io",
    "request",
    "Xhr",
    "push",
    "set",
    "accept",
    "cache",
    "forceReload",
    "setUserData",
    "addListenerOnce",
    "e",
    "Init",
    "getApplication",
    "block",
    "req",
    "getTarget",
    "configServer",
    "getResponseHeader",
    "isTileStructure",
    "test",
    "getResponseText",
    "xml",
    "getResponse",
    "parser",
    "DOMParser",
    "parseFromString",
    "documentElement",
    "getElementsByTagName",
    "length",
    "configError",
    "xmlns",
    "rawContent",
    "querySelectorAll",
    "forEach",
    "loadInclude",
    "remove",
    "getUrl",
    "systemLibVersion",
    "Version",
    "LIBRARY_VERSION_TILE",
    "LIBRARY_VERSION_PURE",
    "xmlLibVersion",
    "getAttribute",
    "undefined",
    "parseInt",
    "libraryCheck",
    "server",
    "backendName",
    "error",
    "backendUrl",
    "endsWith",
    "backendKnxdUrl",
    "backendOpenHABUrl",
    "startsWith",
    "backendMQTTUrl",
    "backend",
    "_checkQueue",
    "addListener",
    "status",
    "getTransport",
    "Request",
    "isSuccessful",
    "getUserData",
    "demoUrl",
    "setUrl",
    "send",
    "includeElem",
    "url",
    "LibraryManager",
    "get",
    "xhr",
    "async",
    "Document",
    "fromString",
    "replaceWith",
    "firstChild",
    "childNodes",
    "call",
    "dispose",
    "textStatus",
    "additionalErrorInfo",
    "title",
    "locale",
    "Manager",
    "tr",
    "translate",
    "toString",
    "message",
    "actions",
    "link",
    "window",
    "location",
    "href",
    "split",
    "type",
    "action",
    "showManager",
    "needsConfirmation",
    "notification",
    "topic",
    "severity",
    "unique",
    "notifications",
    "Router",
    "dispatchMessage",
    "destruct",
    "ConfigLoader"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/util/ConfigLoader.js"
  ],
  "sourcesContent": [
    "/* ConfigLoader.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * The ConfigLoader loads CometVisu config files from the backend. If the loaded config file contains\n * <include> elements those config parts are loaded and add to the XML-Document.\n *\n * @author Tobias Br√§utigam <tbraeutigam@gmail.com>\n * @since 2018\n */\n\nqx.Class.define('cv.util.ConfigLoader', {\n  extend: qx.core.Object,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct() {\n    super();\n    this.__loadQueue = new qx.data.Array();\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __loadQueue: null,\n    __doneCallback: null,\n    __doneCallbackContext: null,\n    __xml: null,\n\n    /**\n     * Load a config file\n     * @param callback\n     * @param context\n     */\n    load(callback, context) {\n      this.__doneCallback = callback;\n      this.__doneCallbackContext = context;\n      // get the data once the page was loaded\n      let uri = qx.util.ResourceManager.getInstance().toUri(\n        'config/visu_config' + (cv.Config.configSuffix ? '_' + cv.Config.configSuffix : '') + '.xml'\n      );\n\n      if (cv.Config.testMode) {\n        // workaround for e2e-tests\n        uri = 'resource/config/visu_config' + (cv.Config.configSuffix ? '_' + cv.Config.configSuffix : '') + '.xml';\n      } else if (uri.indexOf('resource/') === -1) {\n        // unknown config, try to add the resource part manually\n        uri = uri.replace('config/', 'resource/config/');\n      }\n      this.debug('Requesting ' + uri);\n      const ajaxRequest = new qx.io.request.Xhr(uri);\n      this.__loadQueue.push(uri);\n      ajaxRequest.set({\n        accept: 'application/xml',\n        cache: !cv.Config.forceReload\n      });\n\n      ajaxRequest.setUserData('noDemo', true);\n      ajaxRequest.addListenerOnce('success', e => {\n        qx.core.Init.getApplication().block(false);\n        const req = e.getTarget();\n        cv.Config.configServer = req.getResponseHeader('Server');\n        const isTileStructure = /<config/m.test(req.getResponseText());\n        // Response parsed according to the server's response content type\n        let xml = req.getResponse();\n        if (xml && typeof xml === 'string') {\n          const parser = new DOMParser();\n          if (isTileStructure) {\n            xml = xml.replace('<config', '<config xmlns=\"http://www.w3.org/1999/xhtml\"');\n          }\n          xml = parser.parseFromString(xml, 'text/xml');\n        }\n\n        if (!xml || !xml.documentElement || xml.getElementsByTagName('parsererror').length) {\n          this.configError('parsererror');\n        } else {\n          if (isTileStructure && !xml.documentElement.xmlns) {\n            // wrong namespace\n            const rawContent = req.getResponseText().replace('<config', '<config xmlns=\"http://www.w3.org/1999/xhtml\"');\n\n            const parser = new DOMParser();\n            xml = parser.parseFromString(rawContent, 'text/xml');\n          }\n          this.__xml = xml;\n          xml.querySelectorAll('include').forEach(this.loadInclude, this);\n          this.__loadQueue.remove(ajaxRequest.getUrl());\n\n          const systemLibVersion = isTileStructure ? cv.Version.LIBRARY_VERSION_TILE : cv.Version.LIBRARY_VERSION_PURE;\n          // check the library version\n          let xmlLibVersion = isTileStructure\n            ? xml.documentElement.getAttribute('version')\n            : xml.documentElement.getAttribute('lib_version');\n          if (xmlLibVersion === undefined || xmlLibVersion === null) {\n            xmlLibVersion = -1;\n          } else if (xmlLibVersion === '0') {\n            // special wildcard mode used in screenshot generation fixtures\n            xmlLibVersion = systemLibVersion;\n          } else {\n            xmlLibVersion = parseInt(xmlLibVersion);\n          }\n          if (cv.Config.libraryCheck && xmlLibVersion < systemLibVersion) {\n            this.configError('libraryerror');\n          } else {\n            cv.Config.server = {};\n            let backendName = '';\n            if (req.getResponseHeader('X-CometVisu-Backend-Name')) {\n              backendName = req.getResponseHeader('X-CometVisu-Backend-Name');\n            }\n            if (req.getResponseHeader('X-CometVisu-Backend-LoginUrl')) {\n              this.error('The usage of \"X-CometVisu-Backend-LoginUrl\" is deprecated. Please update the server setup.');\n\n              let backendUrl = req.getResponseHeader('X-CometVisu-Backend-LoginUrl');\n\n              if (!backendUrl.endsWith('/')) {\n                backendUrl += '/';\n              }\n              cv.Config.server.backendKnxdUrl = backendUrl;\n              cv.Config.server.backendOpenHABUrl = backendUrl;\n              if (!backendName && backendUrl.startsWith('/rest/')) {\n                backendName = 'openhab';\n              }\n            }\n            if (req.getResponseHeader('X-CometVisu-Backend-KNXD-Url')) {\n              cv.Config.server.backendKnxdUrl = req.getResponseHeader('X-CometVisu-Backend-KNXD-Url');\n\n              if (backendName === '') {\n                backendName = 'knxd';\n              }\n            }\n            if (req.getResponseHeader('X-CometVisu-Backend-MQTT-Url')) {\n              cv.Config.server.backendMQTTUrl = req.getResponseHeader('X-CometVisu-Backend-MQTT-Url');\n\n              if (backendName === '') {\n                backendName = 'mqtt';\n              }\n            }\n            if (req.getResponseHeader('X-CometVisu-Backend-OpenHAB-Url')) {\n              cv.Config.server.backendOpenHABUrl = req.getResponseHeader('X-CometVisu-Backend-OpenHAB-Url');\n\n              if (backendName === '') {\n                backendName = 'openhab';\n              }\n            }\n            if (backendName) {\n              cv.Config.server.backend = backendName;\n            }\n            this._checkQueue();\n          }\n        }\n      });\n\n      ajaxRequest.addListener('statusError', e => {\n        const status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status) && ajaxRequest.getUserData('noDemo')) {\n          ajaxRequest.setUserData('noDemo', false);\n          ajaxRequest.setUserData('origUrl', ajaxRequest.getUrl());\n          this.__loadQueue.remove(ajaxRequest.getUrl());\n          const demoUrl = ajaxRequest.getUrl().replace('config/', 'demo/');\n          ajaxRequest.setUrl(demoUrl);\n          this.__loadQueue.push(demoUrl);\n          ajaxRequest.send();\n        } else if (!qx.util.Request.isSuccessful(status)) {\n          this.configError('filenotfound', [ajaxRequest.getUserData('origUrl'), ajaxRequest.getUrl()]);\n        } else {\n          this.configError(status, null);\n        }\n      });\n\n      ajaxRequest.send();\n    },\n\n    /**\n     * Load an include source and replace it with the loaded content\n     * @param includeElem {Element}\n     */\n    loadInclude(includeElem) {\n      let url = includeElem.getAttribute('src');\n      if (!url.startsWith('/')) {\n        url = qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/' + url;\n      }\n      this.__loadQueue.push(url);\n      const xhr = new qx.io.request.Xhr(url);\n      xhr.set({\n        accept: 'text/plain',\n        async: false\n      });\n\n      xhr.addListenerOnce('success', e => {\n        const req = e.getTarget();\n        const xml = qx.xml.Document.fromString('<root>' + req.getResponseText() + '</root>');\n\n        includeElem.replaceWith(...xml.firstChild.childNodes);\n        this.__loadQueue.remove(url);\n        this._checkQueue();\n      });\n      xhr.addListener('statusError', e => {\n        const status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status)) {\n          this.configError('filenotfound', [xhr.getUrl(), '']);\n        } else {\n          this.configError(status, null);\n        }\n      });\n      xhr.send();\n    },\n\n    /**\n     * Check if everything is loaded and call the callback in this case\n     * @private\n     */\n    _checkQueue() {\n      if (this.__loadQueue.length === 0) {\n        this.__doneCallback.call(this.__doneCallbackContext, this.__xml);\n        this.dispose();\n      }\n    },\n\n    /**\n     * Handle errors that occur during loading ot the config file\n     * @param textStatus {String} error status\n     * @param additionalErrorInfo {String} error message\n     */\n    configError(textStatus, additionalErrorInfo) {\n      const configSuffix = cv.Config.configSuffix ? cv.Config.configSuffix : '';\n      const title = qx.locale.Manager.tr('Config-File Error!').translate().toString();\n      let message = '';\n      let actions;\n      switch (textStatus) {\n        case 'parsererror':\n          message =\n            qx.locale.Manager.tr('Invalid config file!') +\n            '<br/><a href=\"javascript:showConfigErrors(\\'' +\n            configSuffix +\n            '\\')\">' +\n            qx.locale.Manager.tr('Please check!') +\n            '</a>';\n          break;\n        case 'libraryerror': {\n          let link = window.location.href.split('#')[0];\n          if (link.indexOf('?') <= 0) {\n            link += '?';\n          }\n          link += '&libraryCheck=false';\n          message =\n            qx.locale.Manager.tr('Config file has wrong library version!').translate().toString() +\n            '<br/>' +\n            qx.locale.Manager.tr('This can cause problems with your configuration').translate().toString() +\n            '</br>' +\n            '<p>' +\n            qx.locale.Manager.tr(\n              'You can run the %1Configuration Upgrader%2.',\n              '<a href=\"javascript:showConfigErrors(\\'' + configSuffix + '\\', {upgradeVersion: true})\">',\n              '</a>'\n            )\n              .translate()\n              .toString() +\n            '</br>' +\n            qx.locale.Manager.tr(\n              'Or you can start without upgrading %1with possible configuration problems%2',\n              '<a href=\"' + link + '\">',\n              '</a>'\n            )\n              .translate()\n              .toString() +\n            '</p>';\n          break;\n        }\n        case 'filenotfound':\n          message = qx.locale.Manager.tr(\n            '404: Config file not found. Neither as normal config (%1) nor as demo config (%2).',\n            additionalErrorInfo[0],\n            additionalErrorInfo[1]\n          )\n            .translate()\n            .toString();\n          message +=\n            '<br/>' +\n            qx.locale.Manager.tr('You can open the manager to create or upload a config file.').translate().toString();\n          actions = {\n            link: [\n              {\n                title: qx.locale.Manager.tr('Open manager'),\n                type: 'manager',\n                action: () => {\n                  qx.core.Init.getApplication().showManager();\n                },\n                needsConfirmation: false\n              }\n            ]\n          };\n\n          break;\n        default:\n          message = qx.locale.Manager.tr('Unhandled error of type \"%1\"', textStatus).translate().toString();\n          if (additionalErrorInfo) {\n            message += ': ' + additionalErrorInfo;\n          } else {\n            message += '.';\n          }\n      }\n\n      const notification = {\n        topic: 'cv.config.error',\n        title: title,\n        message: message,\n        severity: 'urgent',\n        unique: true\n      };\n\n      if (actions) {\n        notification.actions = actions;\n      }\n      cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n\n      this.error(this, message.toString());\n      qx.core.Init.getApplication().block(false);\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct() {\n    // remove references\n    this.__xml = null;\n    this.__doneCallback = null;\n    this.__doneCallbackContext = null;\n  }\n});\n"
  ],
  "mappings": "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"
}