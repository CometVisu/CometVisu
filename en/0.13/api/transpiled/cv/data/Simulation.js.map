{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "configFile",
    "client",
    "_client",
    "Init",
    "getApplication",
    "setServerHasPhpSupport",
    "init",
    "properties",
    "initialized",
    "check",
    "event",
    "members",
    "__simulations",
    "__encodeSimulatedStates",
    "__sequence",
    "__sequenceIndex",
    "_addressConfigs",
    "r",
    "io",
    "request",
    "Xhr",
    "addListener",
    "e",
    "cv",
    "Config",
    "initialDemoData",
    "getTarget",
    "getResponse",
    "__applyTestData",
    "setInitialized",
    "debug",
    "error",
    "send",
    "__xhr",
    "xhr",
    "now",
    "Date",
    "url",
    "startsWith",
    "forEach",
    "d",
    "data",
    "body",
    "offset",
    "length",
    "entry",
    "responseData",
    "feed",
    "entries",
    "date",
    "setDate",
    "getDate",
    "publishedDate",
    "toUTCString",
    "setTime",
    "getTime",
    "that",
    "sinon",
    "dev",
    "unit",
    "Sinon",
    "getSinon",
    "sandbox",
    "FakeXMLHttpRequest",
    "prototype",
    "open",
    "method",
    "async",
    "username",
    "password",
    "responseText",
    "responseXML",
    "requestHeaders",
    "sendFlag",
    "useFilters",
    "xhrArgs",
    "arguments",
    "defake",
    "filters",
    "some",
    "filter",
    "call",
    "deFake",
    "apply",
    "setRequestHeader",
    "readyStateChange",
    "OPENED",
    "FakeServer",
    "getInstance",
    "addFilter",
    "args",
    "indexOf",
    "getResourcePath",
    "test",
    "path",
    "split",
    "pop",
    "suffix",
    "window",
    "location",
    "pathname",
    "server",
    "getFakeServer",
    "respondWith",
    "parsed",
    "util",
    "Uri",
    "parseUri",
    "generatorName",
    "respond",
    "JSON",
    "stringify",
    "generate",
    "queryKey",
    "host",
    "report",
    "Record",
    "normalizeUrl",
    "substr",
    "log",
    "Logger",
    "response",
    "shift",
    "readyState",
    "status",
    "headers",
    "bind",
    "onWrite",
    "address",
    "value",
    "hasOwnProperty",
    "_processSimulation",
    "_registerSimulations",
    "simulations",
    "keys",
    "mainAddress",
    "simulation",
    "additionalAddresses",
    "addr",
    "_registerGenerators",
    "generators",
    "__generators",
    "gen",
    "name",
    "interval",
    "setInterval",
    "targetValue",
    "Math",
    "random",
    "deviation",
    "Transform",
    "encodeBusAndRaw",
    "raw",
    "receive",
    "i",
    "options",
    "generator",
    "end",
    "start",
    "match",
    "exec",
    "parseInt",
    "val",
    "resolution",
    "push",
    "_startSequence",
    "Timer",
    "once",
    "delay",
    "stop",
    "startValues",
    "stopValues",
    "type",
    "direction",
    "initValue",
    "Model",
    "getState",
    "targetAddress",
    "undefined",
    "decode",
    "timer",
    "stepSize",
    "newValue",
    "update",
    "sendValue",
    "prepareTestData",
    "addresses",
    "encodeFirst",
    "widgetData",
    "getWidgetDataModel",
    "id",
    "assign",
    "document",
    "querySelectorAll",
    "addressElement",
    "textContent",
    "trim",
    "transform",
    "getAttribute",
    "ga",
    "states",
    "sequence",
    "seq",
    "sim",
    "mapping",
    "valueArray",
    "map",
    "startAddress",
    "startVal",
    "fakeXhr",
    "workingXHR",
    "responseType",
    "copyAttrs",
    "attr",
    "navigator",
    "userAgent",
    "stateChangeStart",
    "HEADERS_RECEIVED",
    "LOADING",
    "DONE",
    "stateChangeEnd",
    "onreadystatechange",
    "target",
    "currentTarget",
    "stateChange",
    "addEventListener",
    "eventListeners",
    "handler",
    "listener",
    "capture",
    "destruct",
    "Simulation"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/data/Simulation.js"
  ],
  "sourcesContent": [
    "/**\n * Handles all status update simulation used together with the cv.io.Mockup backend e.g. in the demo configs\n */\nqx.Class.define('cv.data.Simulation', {\n  extend: qx.core.Object,\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct(configFile, client) {\n    super();\n    this._client = client;\n    // override PHP support check, because the responses are faked\n    qx.core.Init.getApplication().setServerHasPhpSupport(true);\n    this.init(configFile);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    initialized: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeInitialized'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {cv.io.Mockup}\n     */\n    _client: null,\n    __simulations: null,\n    __encodeSimulatedStates: false,\n    __sequence: null,\n    __sequenceIndex: 0,\n    _addressConfigs: null,\n\n    init(configFile) {\n      // load the demo data to fill the visu with some values\n      const r = new qx.io.request.Xhr(configFile);\n      r.addListener('success', e => {\n        cv.Config.initialDemoData = e.getTarget().getResponse();\n        this.__applyTestData();\n        this.setInitialized(true);\n        this.debug('simulator data has been loaded');\n      });\n      r.addListener('fail', () => {\n        this.error('failed parsing demo data');\n      });\n      r.send();\n    },\n\n    __applyTestData() {\n      this.__xhr = cv.Config.initialDemoData.xhr;\n\n      // we need to adjust the timestamps of the chart data\n      const now = Date.now();\n      for (let url in this.__xhr) {\n        if (url.startsWith('rrd')) {\n          this.__xhr[url].forEach(d => {\n            const data = d.body;\n            const offset = now - data[data.length - 1][0];\n            data.forEach(entry => (entry[0] += offset));\n          });\n        } else if (url.startsWith('resource/plugin/rsslog.php')) {\n          this.__xhr[url].forEach(d => {\n            const data = d.body.responseData.feed.entries;\n            let date = new Date();\n            date.setDate(date.getDate() - 1);\n            data.forEach(entry => {\n              entry.publishedDate = date.toUTCString();\n              date.setTime(date.getTime() + 60 * 60 * 1000);\n            });\n          });\n        }\n      }\n\n      const that = this;\n      const sinon = qx.dev.unit.Sinon.getSinon();\n      sinon.sandbox = sinon;\n\n      // override sinons filter handling to be able to manipulate the target URL from the filter\n      // eslint-disable-next-line consistent-return\n      sinon.FakeXMLHttpRequest.prototype.open = function open(method, url, async, username, password) {\n        this.method = method;\n        this.url = url;\n        this.async = typeof async == 'boolean' ? async : true;\n        this.username = username;\n        this.password = password;\n        this.responseText = null;\n        this.responseXML = null;\n        this.requestHeaders = {};\n        this.sendFlag = false;\n        if (sinon.FakeXMLHttpRequest.useFilters === true) {\n          let xhrArgs = arguments;\n          let defake = sinon.FakeXMLHttpRequest.filters.some(function (filter) {\n            return filter.call(this, xhrArgs);\n          });\n          if (defake) {\n            const xhr = that.deFake(this, xhrArgs);\n            xhr.open.apply(xhr, xhrArgs);\n            xhr.setRequestHeader('Accept', 'text/*, image/*');\n            return;\n          }\n        }\n        this.readyStateChange(sinon.FakeXMLHttpRequest.OPENED);\n      };\n\n      // configure server\n      qx.dev.FakeServer.getInstance().addFilter(args => {\n        const method = args[0];\n        const url = args[1];\n        if (url.startsWith('https://sentry.io')) {\n          return true;\n        } else if (\n          method === 'GET' &&\n          (url.indexOf('resource/visu_config') >= 0 ||\n            url.indexOf('resource/demo/visu_config') >= 0 ||\n            url.indexOf('resource/hidden-schema.json') >= 0 ||\n            url.indexOf('resource/manager/') >= 0) ||\n          (url.startsWith(this._client.getResourcePath('charts')) && !url.startsWith(this._client.getResourcePath('charts') + 'generator:'))\n        ) {\n          return true;\n        } else if (method === 'GET' && /rest\\/manager\\/index.php\\/fs\\?path=.+\\.[\\w]+$/.test(url)) {\n          // change url to avoid API access and do a real request\n          const path = url.split('=').pop();\n          const suffix = path.startsWith('demo/') ? '' : 'config/';\n          args[1] = window.location.pathname + 'resource/' + suffix + path;\n          return true;\n        }\n        return false;\n      });\n      const server = qx.dev.FakeServer.getInstance().getFakeServer();\n      server.respondWith(\n        function (request) {\n          const parsed = qx.util.Uri.parseUri(request.url);\n          let url = request.url;\n          if (url.startsWith(this._client.getResourcePath('charts') + 'generator:')) {\n            const generatorName = parsed.path.split('generator:').pop();\n            request.respond(200, {'Content-type': 'application/json'}, JSON.stringify(this.generate(generatorName, parsed.queryKey)));\n            return;\n          }\n          if (!parsed.host || parsed.host === window.location.host) {\n            url = cv.report.Record.normalizeUrl(request.url);\n            if (url.startsWith(window.location.pathname)) {\n              url = url.substr(window.location.pathname.length - 1);\n            }\n          }\n          if (!this.__xhr[url] || this.__xhr[url].length === 0) {\n            qx.log.Logger.error(this, '404: no logged responses for URI ' + url + ' found');\n          } else {\n            qx.log.Logger.debug(this, 'faking response for ' + url);\n            let response = '';\n            if (this.__xhr[url].length === 1) {\n              response = this.__xhr[url][0];\n            } else {\n              // multiple responses recorded use them as LIFO stack\n              response = this.__xhr[url].shift();\n            }\n\n            if (request.readyState === 4 && request.status === 404) {\n              // This is a hack, sometimes the request has a 404 status and send readystate\n              // the response would fail if we do not override it here\n              request.readyState = 1;\n            }\n            let body = response.body;\n            if (response.headers && response.headers['Content-type'] === 'application/json') {\n              body = JSON.stringify(response.body);\n            }\n            request.respond(response.status, response.headers, body);\n          }\n        }.bind(this)\n      );\n    },\n\n    onWrite(address, value) {\n      if (this.__simulations && Object.prototype.hasOwnProperty.call(this.__simulations, address)) {\n        this._processSimulation(address, value);\n        return true;\n      }\n      return false;\n    },\n\n    _registerSimulations(simulations) {\n      this.__simulations = {};\n      Object.keys(simulations).forEach(function (mainAddress) {\n        const simulation = simulations[mainAddress];\n        this.__simulations[mainAddress] = simulation;\n        if (Object.prototype.hasOwnProperty.call(simulation, 'additionalAddresses')) {\n          simulation.additionalAddresses.forEach(function (addr) {\n            this.__simulations[addr] = simulation;\n          }, this);\n        }\n      }, this);\n    },\n\n    _registerGenerators(generators) {\n      this.__generators = generators;\n      for (const name in this.__generators) {\n        const gen = this.__generators[name];\n        gen.interval = setInterval(() => {\n          const data = {};\n          let value = gen.targetValue + (Math.random() - 0.5) * gen.deviation * 2;\n          if (this.__encodeSimulatedStates && this._addressConfigs[gen.address]) {\n            value = cv.Transform.encodeBusAndRaw(this._addressConfigs[gen.address], value).raw;\n          }\n          data[gen.address] = value;\n          this._client.receive({\n            i: new Date().getTime(),\n            d: data\n          });\n        }, gen.interval);\n      }\n    },\n\n    generate(name, options) {\n      const generator = this.__generators ? this.__generators[name] : null;\n      const data = [];\n      if (generator) {\n        if (options) {\n          // currently only end=now and start=end-??? is implemented\n          let end = Date.now();\n          let start = Date.now();\n          if (options.start) {\n            const match = /end-(\\d+)(hour|day|month)/.exec(options.start);\n            if (match) {\n              let interval = 0;\n              switch (match[2]) {\n                case 'hour':\n                  interval = 60 * 60 * 1000;\n                  break;\n                case 'day':\n                  interval = 24 * 60 * 60 * 1000;\n                  break;\n                case 'month':\n                  // this is not really precise, but good enough to fake some data\n                  interval = 30 * 24 * 60 * 60 * 1000;\n                  break;\n              }\n              start -= parseInt(match[1]) * interval;\n            }\n          }\n          let val = 0;\n          for (let i = start; i <= end; i += generator.resolution) {\n            val = generator.targetValue + (Math.random() - 0.5) * generator.deviation * 2;\n            data.push([i, val]);\n          }\n        } else {\n          // generate only a single value\n          return generator.targetValue + (Math.random() - 0.5) * generator.deviation * 2;\n        }\n      }\n      return data;\n    },\n\n    _startSequence() {\n      if (this.__sequence.length <= this.__sequenceIndex) {\n        // start again\n        this.__sequenceIndex = 0;\n      }\n      qx.event.Timer.once(\n        function () {\n          this._client.receive({\n            i: new Date().getTime(),\n            d: this.__sequence[this.__sequenceIndex].data\n          });\n\n          this.__sequenceIndex++;\n          this._startSequence();\n        },\n        this,\n        this.__sequence[this.__sequenceIndex].delay\n      );\n    },\n\n    _processSimulation(address, value) {\n      const simulation = this.__simulations[address];\n      if (!simulation) {\n        return;\n      }\n      if (this.__encodeSimulatedStates && address in this._addressConfigs) {\n        value = cv.Transform.encodeBusAndRaw(this._addressConfigs[address], value).raw;\n      }\n      let start = false;\n      let stop = false;\n      if (Object.prototype.hasOwnProperty.call(simulation, 'startValues')) {\n        // try the more specific matches with address included\n        start = simulation.startValues.indexOf(address + '|' + value) >= 0;\n        if (Object.prototype.hasOwnProperty.call(simulation, 'stopValues')) {\n          stop = simulation.stopValues.indexOf(address + '|' + value) >= 0;\n        }\n        if (!stop) {\n          // the more general ones\n          start = simulation.startValues.indexOf(value) >= 0;\n          stop = simulation.startValues.indexOf(value) >= 0;\n        }\n      }\n      if (start) {\n        // start simulation\n        if (simulation.type === 'shutter') {\n          simulation.direction = value === '00' ? 'up' : 'down';\n          let initValue = cv.data.Model.getInstance().getState(simulation.targetAddress);\n          if (initValue === undefined) {\n            initValue = 0;\n          } else if (this.__encodeSimulatedStates && simulation.targetAddress in this._addressConfigs) {\n            initValue = cv.Transform.decode(this._addressConfigs[simulation.targetAddress], initValue);\n          }\n          simulation.value = initValue;\n\n          if (simulation.timer) {\n            simulation.timer.stop();\n          } else {\n            simulation.timer = new qx.event.Timer(simulation.interval || 100);\n            const stepSize = simulation.stepSize || 10;\n            simulation.timer.addListener('interval', () => {\n              let newValue = simulation.value;\n              if (simulation.direction === 'up') {\n                // drive up\n                newValue = simulation.value + stepSize;\n                if (newValue > 100) {\n                  simulation.timer.stop();\n                  return;\n                }\n              } else {\n                // drive down\n                newValue = simulation.value - stepSize;\n                if (newValue < 0) {\n                  simulation.timer.stop();\n                  return;\n                }\n              }\n              const update = {\n                i: new Date().getTime(),\n                d: {}\n              };\n              let sendValue = newValue;\n              if (this.__encodeSimulatedStates && simulation.targetAddress in this._addressConfigs) {\n                sendValue = cv.Transform.encodeBusAndRaw(this._addressConfigs[simulation.targetAddress], newValue).raw;\n              }\n\n              update.d[simulation.targetAddress] = sendValue;\n              this.receive(update);\n              if (simulation.value !== newValue) {\n                simulation.value = newValue;\n              }\n            });\n          }\n          simulation.timer.start();\n        }\n      } else if (stop) {\n        // stop simulation\n        if (simulation.timer) {\n          simulation.timer.stop();\n        }\n      }\n    },\n\n\n    prepareTestData(addresses) {\n      if (cv.Config.initialDemoData && addresses.length > 0) {\n        if (cv.Config.initialDemoData.encodeFirst) {\n          this.__encodeSimulatedStates = true;\n          // connect address data from widgets first\n          this._addressConfigs = {};\n          const widgetData = cv.data.Model.getInstance().getWidgetDataModel();\n          for (const id in widgetData) {\n            if (widgetData[id].address) {\n              this._addressConfigs = Object.assign(this._addressConfigs, widgetData[id].address);\n            }\n          }\n          // lookup cv-address elements (tile structure)\n          for (const addressElement of document.querySelectorAll('cv-address')) {\n            this._addressConfigs[addressElement.textContent.trim()] = {\n              transform: addressElement.getAttribute('transform')\n            };\n          }\n\n          for (let ga in cv.Config.initialDemoData.states) {\n            if (ga in this._addressConfigs) {\n              cv.Config.initialDemoData.states[ga] = cv.Transform.encodeBusAndRaw(this._addressConfigs[ga], cv.Config.initialDemoData.states[ga]).raw;\n            }\n          }\n          for (const seq of cv.Config.initialDemoData.sequence) {\n            for (const ga in seq.data) {\n              if (ga in this._addressConfigs) {\n                seq.data[ga] = cv.Transform.encodeBusAndRaw(this._addressConfigs[ga], seq.data[ga]).raw;\n              }\n            }\n          }\n          for (const ga in cv.Config.initialDemoData.simulations) {\n            if (ga in this._addressConfigs) {\n              // startValues\n              const sim = cv.Config.initialDemoData.simulations[ga];\n              const mapping = valueArray => valueArray.map(val => {\n                if (val.indexOf('|') >= 0) {\n                  const [startAddress, startVal] = val.split('|');\n                  if (startAddress in this._addressConfigs) {\n                    return startAddress + '|' + cv.Transform.encodeBusAndRaw(this._addressConfigs[ga], startVal).raw;\n                  }\n                  return val;\n                }\n                return cv.Transform.encodeBusAndRaw(this._addressConfigs[ga], val).raw;\n              });\n              sim.startValues = mapping(sim.startValues);\n              sim.stopValues = mapping(sim.stopValues);\n            }\n          }\n        }\n        this._client.receive({\n          i: new Date().getTime(),\n          d: cv.Config.initialDemoData.states\n        });\n\n        if (cv.Config.initialDemoData.sequence) {\n          this.__sequence = cv.Config.initialDemoData.sequence;\n          this._startSequence();\n        }\n        if (cv.Config.initialDemoData.simulations) {\n          this._registerSimulations(cv.Config.initialDemoData.simulations);\n        }\n        if (cv.Config.initialDemoData.generators) {\n          this._registerGenerators(cv.Config.initialDemoData.generators);\n        }\n        cv.Config.initialDemoData = null;\n      }\n    },\n\n    deFake(fakeXhr, xhrArgs) {\n      // eslint-disable-next-line new-cap\n      const xhr = new sinon.xhr.workingXHR();\n      [\n        'open',\n        'setRequestHeader',\n        'abort',\n        'getResponseHeader',\n        'getAllResponseHeaders',\n        'addEventListener',\n        'overrideMimeType',\n        'removeEventListener'\n      ].forEach(function (method) {\n        fakeXhr[method] = function () {\n          return xhr[method].apply(xhr, arguments);\n        };\n      });\n      fakeXhr.send = function() {\n        // Ref: https://xhr.spec.whatwg.org/#the-responsetype-attribute\n        if (xhr.responseType !== fakeXhr.responseType) {\n          xhr.responseType = fakeXhr.responseType;\n        }\n        return xhr.send.apply(xhr, arguments);\n      };\n\n      const copyAttrs = function (args) {\n        args.forEach(function (attr) {\n          try {\n            fakeXhr[attr] = xhr[attr];\n          } catch (e) {\n            if (!/MSIE 6/.test(navigator.userAgent)) {\n              throw e;\n            }\n          }\n        });\n      };\n\n      const stateChangeStart = function () {\n        fakeXhr.readyState = xhr.readyState;\n        if (xhr.readyState >= sinon.FakeXMLHttpRequest.HEADERS_RECEIVED) {\n          copyAttrs(['status', 'statusText']);\n        }\n        if (xhr.readyState >= sinon.FakeXMLHttpRequest.LOADING) {\n          copyAttrs(['responseText']);\n        }\n        if (xhr.readyState === sinon.FakeXMLHttpRequest.DONE &&\n          (xhr.responseType === '' || xhr.responseType === 'document')) {\n          copyAttrs(['responseXML']);\n        }\n      };\n      const stateChangeEnd = function() {\n        if (fakeXhr.onreadystatechange) {\n          // eslint-disable-next-line no-useless-call\n          fakeXhr.onreadystatechange.call(fakeXhr, {\n            target: fakeXhr,\n            currentTarget: fakeXhr\n          });\n        }\n      };\n\n      const stateChange = function stateChange() {\n        stateChangeStart();\n        stateChangeEnd();\n      };\n      if (xhr.addEventListener) {\n        xhr.addEventListener('readystatechange', stateChangeStart);\n\n        for (let event in fakeXhr.eventListeners) {\n          // eslint-disable-next-line no-prototype-builtins\n          if (fakeXhr.eventListeners.hasOwnProperty(event)) {\n            fakeXhr.eventListeners[event].forEach(function (handler) {\n              xhr.addEventListener(event, handler.listener, {\n                capture: handler.capture,\n                once: handler.once\n              });\n            });\n          }\n        }\n        xhr.addEventListener('readystatechange', stateChangeEnd);\n      } else {\n        xhr.onreadystatechange = stateChange;\n      }\n      return xhr;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this.__simulations = null;\n    this._addressConfigs = null;\n    this.__sequence = null;\n    this._client = null;\n  }\n});\n"
  ],
  "mappings": "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"
}