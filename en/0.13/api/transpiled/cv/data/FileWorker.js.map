{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "_files",
    "_worker",
    "Worker",
    "util",
    "ResourceManager",
    "getInstance",
    "toUri",
    "onmessage",
    "_onMessage",
    "bind",
    "_validationCallbacks",
    "events",
    "message",
    "members",
    "_counter",
    "postMessage",
    "msg",
    "validateConfig",
    "url",
    "Promise",
    "resolve",
    "reject",
    "prototype",
    "hasOwnProperty",
    "call",
    "path",
    "push",
    "validateXmlConfig",
    "code",
    "id",
    "e",
    "topic",
    "data",
    "shift",
    "callbacks",
    "forEach",
    "cb",
    "fireDataEvent",
    "destruct",
    "cv",
    "FileWorker"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/data/FileWorker.js"
  ],
  "sourcesContent": [
    "/* FileWorker.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Worker script that handles file related operations like modification checking or xml validation\n */\nqx.Class.define('cv.data.FileWorker', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct() {\n    super();\n    this._files = [];\n    this._worker = new Worker(qx.util.ResourceManager.getInstance().toUri('manager/worker.js'));\n\n    this._worker.onmessage = this._onMessage.bind(this);\n    this._validationCallbacks = {};\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    message: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _worker: null,\n    _validationCallbacks: null,\n    _counter: 0,\n\n    postMessage(msg) {\n      this._worker.postMessage(msg);\n    },\n\n    validateConfig(url) {\n      return new Promise(\n        function (resolve, reject) {\n          // check if there is already one validation request ongoing\n          if (!Object.prototype.hasOwnProperty.call(this._validationCallbacks, url)) {\n            this._validationCallbacks[url] = [resolve];\n            this._worker.postMessage([\n              'validateConfig',\n              {\n                path: url\n              }\n            ]);\n          } else {\n            this._validationCallbacks[url].push(resolve);\n          }\n        }.bind(this)\n      );\n    },\n\n    validateXmlConfig(code) {\n      return new Promise(\n        function (resolve, reject) {\n          const id = this._counter++;\n          this._validationCallbacks[id] = [resolve];\n          this._worker.postMessage(['validateXmlConfig', id, code, true]);\n        }.bind(this)\n      );\n    },\n\n    _onMessage(e) {\n      let topic = e.data.shift();\n      let data = e.data.shift();\n      let path = e.data.shift();\n      switch (topic) {\n        case 'validationResult':\n          if (Object.prototype.hasOwnProperty.call(this._validationCallbacks, path)) {\n            const callbacks = this._validationCallbacks[path];\n            delete this._validationCallbacks[path];\n            callbacks.forEach(function (cb) {\n              cb(data);\n            });\n          }\n          break;\n      }\n\n      this.fireDataEvent('message', {\n        topic: topic,\n        data: data,\n        path: path\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct() {\n    this._worker = null;\n  }\n});\n"
  ],
  "mappings": "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"
}