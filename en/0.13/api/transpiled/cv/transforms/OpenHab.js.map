{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "statics",
    "isUndefined",
    "value",
    "undefined",
    "indexOf",
    "defer",
    "cv",
    "Transform",
    "addTransform",
    "name",
    "encode",
    "phy",
    "decode",
    "string",
    "transforms",
    "OpenHab",
    "parseInt",
    "playPause",
    "contact",
    "rollershutter",
    "str",
    "dimmer",
    "number",
    "parseFloat",
    "datetime",
    "Date",
    "toLocaleDateString",
    "parse",
    "time",
    "toLocaleTimeString",
    "date",
    "parts",
    "split",
    "setHours",
    "setMinutes",
    "setSeconds",
    "color",
    "Map",
    "has",
    "hsv",
    "get",
    "join",
    "rgb",
    "util",
    "ColorUtil",
    "rgbToHsb",
    "hsbString",
    "variant",
    "hsbToRgb",
    "map",
    "val"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/transforms/OpenHab.js"
  ],
  "sourcesContent": [
    "/* OpenHab.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Transformations for the openHAB backend\n *\n * @author Tobias BrÃ¤utigam\n * @since 2012\n */\nqx.Class.define('cv.transforms.OpenHab', {\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    isUndefined(value) {\n      return ['NaN', 'Uninitialized', 'NULL', 'UNDEF', undefined, null].indexOf(value) >= 0;\n    }\n  },\n\n  /**\n   * This class defines the default transforms: encode: transform JavaScript to\n   * bus value decode: transform bus to JavaScript value\n   */\n  defer() {\n    cv.Transform.addTransform('OH', {\n      switch: {\n        name: 'OH_Switch',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          return phy == 1 ? 'ON' : 'OFF';\n        },\n        decode(string) {\n          if (cv.transforms.OpenHab.isUndefined(string)) {\n            return 0;\n          }\n          return string === 'ON' || parseInt(string) > 0 ? 1 : 0;\n        }\n      },\n\n      playPause: {\n        name: 'OH_PlayPause',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          return phy == 1 ? 'PLAY' : 'PAUSE';\n        },\n        decode(string) {\n          if (cv.transforms.OpenHab.isUndefined(string)) {\n            return 0;\n          }\n          return string === 'PLAY' || parseInt(string) > 0 ? 1 : 0;\n        }\n      },\n\n      contact: {\n        name: 'OH_Contact',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          return phy == 1 ? 'OPEN' : 'CLOSED';\n        },\n        decode(string) {\n          if (cv.transforms.OpenHab.isUndefined(string)) {\n            return 0;\n          }\n          return string === 'OPEN' ? 1 : 0;\n        }\n      },\n\n      rollershutter: {\n        name: 'OH_RollerShutter',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          // noinspection EqualityComparisonWithCoercionJS\n          if (phy == -1) {\n            return 'STOP';\n          }\n          // noinspection EqualityComparisonWithCoercionJS\n          if (phy == 1 || phy == 100) {\n            return 'DOWN';\n          }\n          // noinspection EqualityComparisonWithCoercionJS\n          if (phy == 0) {\n            // eslint-disable-line no-lonely-if\n            return 'UP';\n          }\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return undefined;\n          } else if (str === 'UP' || str === '0') {\n            return 0;\n          } else if (str === 'DOWN' || str === '100') {\n            return 100;\n          } else if (str === 'STOP') {\n            return -1;\n          }\n          return str;\n        }\n      },\n\n      dimmer: {\n        name: 'OH_Dimmer',\n        encode(phy) {\n          return parseInt(phy);\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return 0;\n          } else if (str === 'ON') {\n            return 100;\n          } else if (str === 'OFF') {\n            return 0;\n          }\n          return parseInt(str);\n        }\n      },\n\n      number: {\n        name: 'OH_Number',\n        encode(phy) {\n          return parseFloat(phy);\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return 0;\n          }\n          return parseFloat(str);\n        }\n      },\n\n      string: {\n        name: 'OH_String',\n        encode(phy) {\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return '';\n          }\n          return str;\n        }\n      },\n\n      datetime: {\n        name: 'OH_DateTime',\n        encode(phy) {\n          if (phy instanceof Date) {\n            return phy.toLocaleDateString();\n          }\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return '-';\n          }\n          return new Date(Date.parse(str));\n        }\n      },\n\n      time: {\n        name: 'OH_Time',\n        encode(phy) {\n          if (phy instanceof Date) {\n            return phy.toLocaleTimeString();\n          }\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return '-';\n          }\n          const date = new Date();\n          const parts = str.split(':');\n          date.setHours(parseInt(parts[0]));\n          date.setMinutes(parseInt(parts[1]));\n          date.setSeconds(parseInt(parts[2]));\n          return date;\n        }\n      },\n\n      color: {\n        name: 'OH_Color',\n        encode(phy) {\n          if (!(phy instanceof Map)) {\n            return '0, 0, 0';\n          }\n          if (phy.has('h') && phy.has('s') && phy.has('v')) {\n            let hsv = [phy.get('h') || 0, phy.get('s') || 0, phy.get('v') || 0];\n\n            return hsv.join(', ');\n          } else if (phy.has('r') && phy.has('g') && phy.has('b')) {\n            let rgb = [phy.get('r') || 0, phy.get('g') || 0, phy.get('b') || 0];\n\n            return qx.util.ColorUtil.rgbToHsb(rgb).join(', ');\n          }\n          return '0, 0, 0';\n        },\n        decode(hsbString, variant) {\n          if (cv.transforms.OpenHab.isUndefined(hsbString)) {\n            return variant === 'rgb'\n              ? new Map([\n                  ['r', 0],\n                  ['g', 0],\n                  ['b', 0]\n                ])\n              : new Map([\n                  ['h', 0],\n                  ['s', 0],\n                  ['v', 0]\n                ]);\n          }\n          // decode HSV/HSB to RGB\n          if (variant === 'rgb') {\n            // decode HSV/HSB to RGB\n            let rgb = qx.util.ColorUtil.hsbToRgb(hsbString.split(','));\n            return new Map([\n              ['r', rgb[0]],\n              ['g', rgb[1]],\n              ['b', rgb[2]]\n            ]);\n          }\n          let hsv = hsbString.split(',').map(parseFloat);\n          return new Map([\n            ['h', hsv[0]],\n            ['s', hsv[1]],\n            ['v', hsv[2]]\n          ]);\n        }\n      },\n\n      'thing-status': {\n        name: 'OH_Thing',\n        encode(val) {\n          return val ? 'ONLINE' : 'OFFLINE';\n        },\n        decode(val) {\n          return val === 'ONLINE';\n        }\n      }\n    });\n  }\n});\n"
  ],
  "mappings": "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"
}