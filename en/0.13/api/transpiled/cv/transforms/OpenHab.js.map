{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "statics",
    "isUndefined",
    "value",
    "undefined",
    "indexOf",
    "defer",
    "cv",
    "Transform",
    "addTransform",
    "name",
    "encode",
    "phy",
    "decode",
    "string",
    "transforms",
    "OpenHab",
    "parseInt",
    "playPause",
    "contact",
    "rollershutter",
    "str",
    "dimmer",
    "number",
    "parseFloat",
    "datetime",
    "Date",
    "toLocaleDateString",
    "parse",
    "time",
    "toLocaleTimeString",
    "date",
    "parts",
    "split",
    "setHours",
    "setMinutes",
    "setSeconds",
    "color",
    "Map",
    "has",
    "hsv",
    "get",
    "join",
    "rgb",
    "util",
    "ColorUtil",
    "rgbToHsb",
    "hsbString",
    "variant",
    "hsbToRgb",
    "map",
    "val"
  ],
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/transforms/OpenHab.js"
  ],
  "sourcesContent": [
    "/* OpenHab.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Transformations for the openHAB backend\n *\n * @author Tobias BrÃ¤utigam\n * @since 2012\n */\nqx.Class.define('cv.transforms.OpenHab', {\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    isUndefined(value) {\n      return ['NaN', 'Uninitialized', 'NULL', 'UNDEF', undefined, null].indexOf(value) >= 0;\n    }\n  },\n\n  /**\n   * This class defines the default transforms: encode: transform JavaScript to\n   * bus value decode: transform bus to JavaScript value\n   */\n  defer() {\n    cv.Transform.addTransform('OH', {\n      switch: {\n        name: 'OH_Switch',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          return phy == 1 ? 'ON' : 'OFF';\n        },\n        decode(string) {\n          if (cv.transforms.OpenHab.isUndefined(string)) {\n            return 0;\n          }\n          return string === 'ON' || parseInt(string) > 0 ? 1 : 0;\n        }\n      },\n\n      playPause: {\n        name: 'OH_PlayPause',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          return phy == 1 ? 'PLAY' : 'PAUSE';\n        },\n        decode(string) {\n          if (cv.transforms.OpenHab.isUndefined(string)) {\n            return 0;\n          }\n          return string === 'PLAY' || parseInt(string) > 0 ? 1 : 0;\n        }\n      },\n\n      contact: {\n        name: 'OH_Contact',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          return phy == 1 ? 'OPEN' : 'CLOSED';\n        },\n        decode(string) {\n          if (cv.transforms.OpenHab.isUndefined(string)) {\n            return 0;\n          }\n          return string === 'OPEN' ? 1 : 0;\n        }\n      },\n\n      rollershutter: {\n        name: 'OH_RollerShutter',\n        encode(phy) {\n          // using == comparisons to make sure that e.g. 1 equals \"1\"\n          // noinspection EqualityComparisonWithCoercionJS\n          if (phy == -1) {\n            return 'STOP';\n          }\n          // noinspection EqualityComparisonWithCoercionJS\n          if (phy == 1 || phy == 100) {\n            return 'DOWN';\n          }\n          // noinspection EqualityComparisonWithCoercionJS\n          if (phy == 0) {\n            // eslint-disable-line no-lonely-if\n            return 'UP';\n          }\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return undefined;\n          } else if (str === 'UP' || str === '0') {\n            return 0;\n          } else if (str === 'DOWN' || str === '100') {\n            return 100;\n          } else if (str === 'STOP') {\n            return -1;\n          }\n          return str;\n        }\n      },\n\n      dimmer: {\n        name: 'OH_Dimmer',\n        encode(phy) {\n          return parseInt(phy);\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return 0;\n          } else if (str === 'ON') {\n            return 100;\n          } else if (str === 'OFF') {\n            return 0;\n          }\n          return parseInt(str);\n        }\n      },\n\n      number: {\n        name: 'OH_Number',\n        encode(phy) {\n          return parseFloat(phy);\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return 0;\n          }\n          return parseFloat(str);\n        }\n      },\n\n      string: {\n        name: 'OH_String',\n        encode(phy) {\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return '';\n          }\n          return str;\n        }\n      },\n\n      datetime: {\n        name: 'OH_DateTime',\n        encode(phy) {\n          if (phy instanceof Date) {\n            return phy.toLocaleDateString();\n          }\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return '-';\n          }\n          return new Date(Date.parse(str));\n        }\n      },\n\n      time: {\n        name: 'OH_Time',\n        encode(phy) {\n          if (phy instanceof Date) {\n            return phy.toLocaleTimeString();\n          }\n          return phy;\n        },\n        decode(str) {\n          if (cv.transforms.OpenHab.isUndefined(str)) {\n            return '-';\n          }\n          const date = new Date();\n          const parts = str.split(':');\n          date.setHours(parseInt(parts[0]));\n          date.setMinutes(parseInt(parts[1]));\n          date.setSeconds(parseInt(parts[2]));\n          return date;\n        }\n      },\n\n      color: {\n        name: 'OH_Color',\n        encode(phy) {\n          if (!(phy instanceof Map)) {\n            return '0, 0, 0';\n          }\n          if (phy.has('h') && phy.has('s') && phy.has('v')) {\n            let hsv = [phy.get('h') || 0, phy.get('s') || 0, phy.get('v') || 0];\n\n            return hsv.join(', ');\n          } else if (phy.has('r') && phy.has('g') && phy.has('b')) {\n            let rgb = [phy.get('r') || 0, phy.get('g') || 0, phy.get('b') || 0];\n\n            return qx.util.ColorUtil.rgbToHsb(rgb).join(', ');\n          }\n          return '0, 0, 0';\n        },\n        decode(hsbString, variant) {\n          if (cv.transforms.OpenHab.isUndefined(hsbString)) {\n            return variant === 'rgb'\n              ? new Map([\n                  ['r', 0],\n                  ['g', 0],\n                  ['b', 0]\n                ])\n              : new Map([\n                  ['h', 0],\n                  ['s', 0],\n                  ['v', 0]\n                ]);\n          }\n          // decode HSV/HSB to RGB\n          if (variant === 'rgb') {\n            // decode HSV/HSB to RGB\n            let rgb = qx.util.ColorUtil.hsbToRgb(hsbString.split(','));\n            return new Map([\n              ['r', rgb[0]],\n              ['g', rgb[1]],\n              ['b', rgb[2]]\n            ]);\n          }\n          let hsv = hsbString.split(',').map(parseFloat);\n          return new Map([\n            ['h', hsv[0]],\n            ['s', hsv[1]],\n            ['v', hsv[2]]\n          ]);\n        }\n      },\n\n      'thing-status': {\n        name: 'OH_Thing',\n        encode(val) {\n          return val ? 'ONLINE' : 'OFFLINE';\n        },\n        decode(val) {\n          return val === 'ONLINE';\n        }\n      }\n    });\n  }\n});\n"
  ],
  "mappings": "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"
}