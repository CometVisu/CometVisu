{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/node_modules/@qooxdoo/compiler/node_modules/@qooxdoo/framework/source/class/qx/event/handler/Focus.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "event",
    "IEventHandler",
    "IDisposable",
    "construct",
    "manager",
    "_manager",
    "_window",
    "getWindow",
    "_document",
    "document",
    "_root",
    "documentElement",
    "_body",
    "body",
    "Environment",
    "get",
    "parseFloat",
    "application",
    "Inline",
    "Init",
    "getApplication",
    "__needsScrollFix",
    "_initObserver",
    "properties",
    "active",
    "apply",
    "nullable",
    "focus",
    "statics",
    "PRIORITY",
    "Registration",
    "PRIORITY_NORMAL",
    "SUPPORTED_TYPES",
    "blur",
    "focusin",
    "focusout",
    "activate",
    "deactivate",
    "IGNORE_CAN_HANDLE",
    "FOCUSABLE_ELEMENTS",
    "select",
    "a",
    "button",
    "frame",
    "iframe",
    "img",
    "input",
    "object",
    "textarea",
    "members",
    "__onNativeMouseDownWrapper",
    "__onNativeMouseUpWrapper",
    "__onNativeFocusWrapper",
    "__onNativeBlurWrapper",
    "__onNativeDragGestureWrapper",
    "__onNativeSelectStartWrapper",
    "__onNativeFocusInWrapper",
    "__onNativeFocusOutWrapper",
    "__previousFocus",
    "__previousActive",
    "__down",
    "__up",
    "__relatedTarget",
    "canHandleEvent",
    "target",
    "type",
    "registerEvent",
    "capture",
    "unregisterEvent",
    "element",
    "window",
    "setTimeout",
    "selection",
    "bom",
    "Selection",
    "length",
    "createTextRange",
    "textRange",
    "moveStart",
    "value",
    "collapse",
    "ex",
    "setFocus",
    "setActive",
    "getActive",
    "resetActive",
    "getFocus",
    "resetFocus",
    "tryActivate",
    "__findActivatableElement",
    "__fireEvent",
    "related",
    "bubbles",
    "evt",
    "createEvent",
    "Focus",
    "dispatchEvent",
    "_windowFocused",
    "__doWindowBlur",
    "__doWindowFocus",
    "lang",
    "Function",
    "listener",
    "__onNativeMouseDown",
    "__onNativeMouseUp",
    "__onNativeFocus",
    "__onNativeBlur",
    "__onNativeDragGesture",
    "Event",
    "addNativeListener",
    "__onNativeFocusIn",
    "__onNativeFocusOut",
    "__onNativeSelectStart",
    "domEvent",
    "_stopObserver",
    "removeNativeListener",
    "GlobalError",
    "observeMethod",
    "getTarget",
    "__isSelectable",
    "preventDefault",
    "focusTarget",
    "__findFocusableElement",
    "selectionStart",
    "selectionEnd",
    "relatedTarget",
    "getRelatedTarget",
    "unselectable",
    "empty",
    "current",
    "__fixFocus",
    "offsetWidth",
    "undefined",
    "parentNode",
    "__getCorrectFocusTarget",
    "focusedElement",
    "nodeName",
    "toLowerCase",
    "isClass",
    "widget",
    "ui",
    "Widget",
    "getWidgetByElement",
    "textField",
    "getChildControl",
    "getContentElement",
    "getDomElement",
    "__isFocusable",
    "el",
    "index",
    "Attribute",
    "focusable",
    "handler",
    "tagName",
    "nodeType",
    "getAttribute",
    "orig",
    "node",
    "attr",
    "_applyActive",
    "old",
    "scrollTo",
    "_applyFocus",
    "destruct",
    "__mouseActive",
    "defer",
    "addHandler",
    "entry",
    "toUpperCase"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2007-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Sebastian Werner (wpbasti)\n     * Fabian Jakobs (fjakobs)\n     * Christian Hagendorn (chris_schmidt)\n\n************************************************************************ */\n\n/**\n * This handler is used to normalize all focus/activation requirements\n * and normalize all cross browser quirks in this area.\n *\n * Notes:\n *\n * * Webkit and Opera (before 9.5) do not support tabIndex for all elements\n * (See also: https://bugs.webkit.org/show_bug.cgi?id=7138)\n *\n * * TabIndex is normally 0, which means all naturally focusable elements are focusable.\n * * TabIndex > 0 means that the element is focusable and tabable\n * * TabIndex < 0 means that the element, even if naturally possible, is not focusable.\n *\n * NOTE: Instances of this class must be disposed of after use\n *\n * @use(qx.event.dispatch.DomBubbling)\n */\nqx.Class.define(\"qx.event.handler.Focus\",\n{\n  extend : qx.core.Object,\n  implement : [ qx.event.IEventHandler, qx.core.IDisposable ],\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n\n  /**\n   * Create a new instance\n   *\n   * @param manager {qx.event.Manager} Event manager for the window to use\n   *\n   * @ignore(qx.application.Inline)\n   */\n  construct : function(manager)\n  {\n    this.base(arguments);\n\n    // Define shorthands\n    this._manager = manager;\n    this._window = manager.getWindow();\n    this._document = this._window.document;\n    this._root = this._document.documentElement;\n    this._body = this._document.body;\n\n    if ((qx.core.Environment.get(\"os.name\") == \"ios\" && parseFloat(qx.core.Environment.get(\"os.version\")) > 6) &&\n      (!qx.application.Inline || !qx.core.Init.getApplication() instanceof qx.application.Inline) )\n    {\n      this.__needsScrollFix = true;\n    }\n\n    // Initialize\n    this._initObserver();\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n\n  properties :\n  {\n    /** The active DOM element */\n    active :\n    {\n      apply : \"_applyActive\",\n      nullable : true\n    },\n\n    /** The focussed DOM element */\n    focus :\n    {\n      apply : \"_applyFocus\",\n      nullable : true\n    }\n  },\n\n  /*\n  *****************************************************************************\n     STATICS\n  *****************************************************************************\n  */\n\n  statics :\n  {\n    /** @type {Integer} Priority of this handler */\n    PRIORITY : qx.event.Registration.PRIORITY_NORMAL,\n\n    /** @type {Map} Supported event types */\n    SUPPORTED_TYPES :\n    {\n      focus : 1,\n      blur : 1,\n      focusin : 1,\n      focusout : 1,\n      activate : 1,\n      deactivate : 1\n    },\n\n    /** @type {Integer} Whether the method \"canHandleEvent\" must be called */\n    IGNORE_CAN_HANDLE : true,\n\n    /**\n     * @type {Map} See: http://msdn.microsoft.com/en-us/library/ms534654(VS.85).aspx\n     */\n    FOCUSABLE_ELEMENTS : qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" :\n      {\n        a : 1,\n        body : 1,\n        button : 1,\n        frame : 1,\n        iframe : 1,\n        img : 1,\n        input : 1,\n        object : 1,\n        select : 1,\n        textarea : 1\n      },\n\n      \"gecko\" :\n      {\n        a : 1,\n        body : 1,\n        button : 1,\n        frame : 1,\n        iframe : 1,\n        img : 1,\n        input : 1,\n        object : 1,\n        select : 1,\n        textarea : 1\n      },\n\n      \"opera\" :\n      {\n        button : 1,\n        input : 1,\n        select : 1,\n        textarea : 1\n      },\n\n      \"webkit\" :\n      {\n        button : 1,\n        input : 1,\n        select : 1,\n        textarea : 1\n      }\n    })\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n  members :\n  {\n    __onNativeMouseDownWrapper : null,\n    __onNativeMouseUpWrapper : null,\n    __onNativeFocusWrapper : null,\n    __onNativeBlurWrapper : null,\n    __onNativeDragGestureWrapper : null,\n    __onNativeSelectStartWrapper : null,\n    __onNativeFocusInWrapper : null,\n    __onNativeFocusOutWrapper : null,\n    __previousFocus : null,\n    __previousActive : null,\n    __down : \"\",\n    __up : \"\",\n    __needsScrollFix : false,\n    __relatedTarget : null,\n\n    /*\n    ---------------------------------------------------------------------------\n      EVENT HANDLER INTERFACE\n    ---------------------------------------------------------------------------\n    */\n\n    // interface implementation\n    canHandleEvent : function(target, type) {},\n\n    // interface implementation\n    registerEvent : function(target, type, capture) {\n      // Nothing needs to be done here\n    },\n\n    // interface implementation\n    unregisterEvent : function(target, type, capture) {\n      // Nothing needs to be done here\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      FOCUS/BLUR USER INTERFACE\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Focuses the given DOM element\n     *\n     * @param element {Element} DOM element to focus\n     */\n    focus : function(element)\n    {\n      // Fixed timing issue with IE, see [BUG #3267]\n      if ((qx.core.Environment.get(\"engine.name\") == \"mshtml\"))\n      {\n        window.setTimeout(function()\n        {\n          try {\n            // focus element before set cursor position\n            element.focus();\n\n            // Fixed cursor position issue with IE, only when nothing is selected.\n            // See [BUG #3519] for details.\n            var selection = qx.bom.Selection.get(element);\n            if (selection.length == 0 && typeof element.createTextRange == \"function\") {\n              var textRange = element.createTextRange();\n              textRange.moveStart('character', element.value.length);\n              textRange.collapse();\n              textRange.select();\n            }\n          } catch(ex) {}\n        }, 0);\n      }\n      else\n      {\n        // Fix re-focusing on mousup event\n        // See https://github.com/qooxdoo/qooxdoo/issues/9393 and\n        // discussion in https://github.com/qooxdoo/qooxdoo/pull/9394\n        window.setTimeout(function()\n        {\n          try {\n            element.focus();\n          } catch(ex) {}\n        }, 0);\n      }\n\n      this.setFocus(element);\n      this.setActive(element);\n    },\n\n    /**\n     * Activates the given DOM element\n     *\n     * @param element {Element} DOM element to activate\n     */\n    activate : function(element) {\n      this.setActive(element);\n    },\n\n    /**\n     * Blurs the given DOM element\n     *\n     * @param element {Element} DOM element to focus\n     */\n    blur : function(element)\n    {\n      try {\n        element.blur();\n      } catch(ex) {}\n\n      if (this.getActive() === element) {\n        this.resetActive();\n      }\n\n      if (this.getFocus() === element) {\n        this.resetFocus();\n      }\n    },\n\n    /**\n     * Deactivates the given DOM element\n     *\n     * @param element {Element} DOM element to activate\n     */\n    deactivate : function(element)\n    {\n      if (this.getActive() === element) {\n        this.resetActive();\n      }\n    },\n\n    /**\n     * Tries to activate the given element. This checks whether\n     * the activation is allowed first.\n     *\n     * @param element {Element} DOM element to activate\n     */\n    tryActivate : function(element)\n    {\n      var active = this.__findActivatableElement(element);\n      if (active) {\n        this.setActive(active);\n      }\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      HELPER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Shorthand to fire events from within this class.\n     *\n     * @param target {Element} DOM element which is the target\n     * @param related {Element} DOM element which is the related target\n     * @param type {String} Name of the event to fire\n     * @param bubbles {Boolean} Whether the event should bubble\n     * @return {qx.Promise?} a promise, if one or more of the event handlers returned a promise\n     */\n    __fireEvent : function(target, related, type, bubbles)\n    {\n      var Registration = qx.event.Registration;\n\n      var evt = Registration.createEvent(type, qx.event.type.Focus, [target, related, bubbles]);\n      return Registration.dispatchEvent(target, evt);\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      WINDOW FOCUS/BLUR SUPPORT\n    ---------------------------------------------------------------------------\n    */\n\n    /** @type {Boolean} Whether the window is focused currently */\n    _windowFocused : true,\n\n    /**\n     * Helper for native event listeners to react on window blur\n     */\n    __doWindowBlur : function()\n    {\n      // Omit doubled blur events\n      // which is a common behavior at least for gecko based clients\n      if (this._windowFocused)\n      {\n        this._windowFocused = false;\n        this.__fireEvent(this._window, null, \"blur\", false);\n      }\n    },\n\n\n    /**\n     * Helper for native event listeners to react on window focus\n     */\n    __doWindowFocus : function()\n    {\n      // Omit doubled focus events\n      // which is a common behavior at least for gecko based clients\n      if (!this._windowFocused)\n      {\n        this._windowFocused = true;\n        this.__fireEvent(this._window, null, \"focus\", false);\n      }\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      NATIVE OBSERVER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Initializes event listeners.\n     *\n     * @signature function()\n     */\n    _initObserver : qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function()\n      {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n        this.__onNativeFocusWrapper = qx.lang.Function.listener(this.__onNativeFocus, this);\n        this.__onNativeBlurWrapper = qx.lang.Function.listener(this.__onNativeBlur, this);\n\n        this.__onNativeDragGestureWrapper = qx.lang.Function.listener(this.__onNativeDragGesture, this);\n\n        // Register events\n        qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        // Capturing is needed for gecko to correctly\n        // handle focus of input and textarea fields\n        qx.bom.Event.addNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n        qx.bom.Event.addNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n\n        // Capture drag events\n        qx.bom.Event.addNativeListener(this._window, \"draggesture\", this.__onNativeDragGestureWrapper, true);\n      },\n\n      \"mshtml\" : function()\n      {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n        this.__onNativeFocusInWrapper = qx.lang.Function.listener(this.__onNativeFocusIn, this);\n        this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n\n        this.__onNativeSelectStartWrapper = qx.lang.Function.listener(this.__onNativeSelectStart, this);\n\n\n        // Register events\n        qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper);\n        qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper);\n\n        // MSHTML supports their own focusin and focusout events\n        // To detect which elements get focus the target is useful\n        // The window blur can detected using focusout and look\n        // for the toTarget property which is empty in this case.\n        qx.bom.Event.addNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n        qx.bom.Event.addNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n\n        // Add selectstart to prevent selection\n        qx.bom.Event.addNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper);\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function(domEvent)\n        {\n          // Bind methods\n          this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n          this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n          this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n          this.__onNativeFocusInWrapper = qx.lang.Function.listener(this.__onNativeFocusIn, this);\n          this.__onNativeSelectStartWrapper = qx.lang.Function.listener(this.__onNativeSelectStart, this);\n\n          // Register events\n          qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper, false);\n\n          qx.bom.Event.addNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n          qx.bom.Event.addNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n        },\n\n        \"default\" : function(domEvent)\n        {\n          // Bind methods\n          this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n          this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n          this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n\n          this.__onNativeFocusWrapper = qx.lang.Function.listener(this.__onNativeFocus, this);\n          this.__onNativeBlurWrapper = qx.lang.Function.listener(this.__onNativeBlur, this);\n\n          this.__onNativeSelectStartWrapper = qx.lang.Function.listener(this.__onNativeSelectStart, this);\n\n\n          // Register events\n          qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper, false);\n\n          qx.bom.Event.addNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n\n          qx.bom.Event.addNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n          qx.bom.Event.addNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n        }\n      }),\n\n      \"opera\" : function()\n      {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n        this.__onNativeFocusInWrapper = qx.lang.Function.listener(this.__onNativeFocusIn, this);\n        this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n\n\n        // Register events\n        qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        qx.bom.Event.addNativeListener(this._window, \"DOMFocusIn\", this.__onNativeFocusInWrapper, true);\n        qx.bom.Event.addNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n      }\n    }),\n\n    /**\n     * Disconnects event listeners.\n     *\n     * @signature function()\n     */\n    _stopObserver : qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function()\n      {\n        qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        qx.bom.Event.removeNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n        qx.bom.Event.removeNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n\n        qx.bom.Event.removeNativeListener(this._window, \"draggesture\", this.__onNativeDragGestureWrapper, true);\n      },\n\n      \"mshtml\" : function()\n      {\n        qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper);\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function()\n        {\n          qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper);\n        },\n\n        \"default\" : function()\n        {\n          qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n          qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n          qx.bom.Event.removeNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper, false);\n\n          qx.bom.Event.removeNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n\n          qx.bom.Event.removeNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n          qx.bom.Event.removeNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n        }\n      }),\n\n      \"opera\" : function()\n      {\n        qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        qx.bom.Event.removeNativeListener(this._window, \"DOMFocusIn\", this.__onNativeFocusInWrapper, true);\n        qx.bom.Event.removeNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n      }\n    }),\n\n    /*\n    ---------------------------------------------------------------------------\n      NATIVE LISTENERS\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Native event listener for <code>draggesture</code> event\n     * supported by gecko. Used to stop native drag and drop when\n     * selection is disabled.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Drag_and_Drop\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeDragGesture : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (!this.__isSelectable(target)) {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>DOMFocusIn</code> or <code>focusin</code>\n     * depending on the client's engine.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocusIn : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        // Force window focus to be the first\n        this.__doWindowFocus();\n\n        // Update internal data\n        var target = qx.bom.Event.getTarget(domEvent);\n\n        // IE focusin is also fired on elements which are not focusable at all\n        // We need to look up for the next focusable element.\n        var focusTarget = this.__findFocusableElement(target);\n        if (focusTarget) {\n          this.setFocus(focusTarget);\n        }\n\n        // Make target active\n        this.tryActivate(target);\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function(domEvent)\n        {\n          // Force window focus to be the first\n          this.__doWindowFocus();\n\n          // Update internal data\n          var target = qx.bom.Event.getTarget(domEvent);\n\n          // IE focusin is also fired on elements which are not focusable at all\n          // We need to look up for the next focusable element.\n          var focusTarget = this.__findFocusableElement(target);\n          if (focusTarget) {\n            this.setFocus(focusTarget);\n          }\n\n          // Make target active\n          this.tryActivate(target);\n        },\n\n        \"default\" : null\n      }),\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target == this._document || target == this._window)\n        {\n          this.__doWindowFocus();\n\n          if (this.__previousFocus)\n          {\n            this.setFocus(this.__previousFocus);\n            delete this.__previousFocus;\n          }\n\n          if (this.__previousActive)\n          {\n            this.setActive(this.__previousActive);\n            delete this.__previousActive;\n          }\n        }\n        else\n        {\n          this.setFocus(target);\n          this.tryActivate(target);\n\n          // Clear selection\n          if (!this.__isSelectable(target))\n          {\n            target.selectionStart = 0;\n            target.selectionEnd = 0;\n          }\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>DOMFocusOut</code> or <code>focusout</code>\n     * depending on the client's engine.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocusOut : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var relatedTarget = qx.bom.Event.getRelatedTarget(domEvent);\n\n        // If the focus goes to nowhere (the document is blurred)\n        if (relatedTarget == null)\n        {\n          // Update internal representation\n          this.__doWindowBlur();\n\n          // Reset active and focus\n          this.resetFocus();\n          this.resetActive();\n        }\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function(domEvent)\n        {\n          var relatedTarget = qx.bom.Event.getRelatedTarget(domEvent);\n\n          // If the focus goes to nowhere (the document is blurred)\n          if (relatedTarget == null)\n          {\n            // Update internal representation\n            this.__doWindowBlur();\n\n            // Reset active and focus\n            this.resetFocus();\n            this.resetActive();\n          }\n        },\n\n        \"default\" : function(domEvent)\n        {\n          var target = qx.bom.Event.getTarget(domEvent);\n\n          if (target === this.getFocus()) {\n            this.resetFocus();\n          }\n\n          if (target === this.getActive()) {\n            this.resetActive();\n          }\n        }\n      }),\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target == this._document)\n        {\n          this.__doWindowBlur();\n\n          // Store old focus/active elements\n          // Opera do not fire focus events for them\n          // when refocussing the window (in my opinion an error)\n          this.__previousFocus = this.getFocus();\n          this.__previousActive = this.getActive();\n\n          this.resetFocus();\n          this.resetActive();\n        }\n        else\n        {\n          if (target === this.getFocus()) {\n            this.resetFocus();\n          }\n\n          if (target === this.getActive()) {\n            this.resetActive();\n          }\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>blur</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeBlur : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowBlur();\n\n          this.resetActive();\n          this.resetFocus();\n        }\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowBlur();\n\n          // Store old focus/active elements\n          // Opera do not fire focus events for them\n          // when refocussing the window (in my opinion an error)\n          this.__previousFocus = this.getFocus();\n          this.__previousActive = this.getActive();\n\n          this.resetActive();\n          this.resetFocus();\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>focus</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocus : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowFocus();\n\n          // Always speak of the body, not the window or document\n          target = this._body;\n        }\n\n        this.setFocus(target);\n        this.tryActivate(target);\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowFocus();\n\n          if (this.__previousFocus)\n          {\n            this.setFocus(this.__previousFocus);\n            delete this.__previousFocus;\n          }\n\n          if (this.__previousActive)\n          {\n            this.setActive(this.__previousActive);\n            delete this.__previousActive;\n          }\n        }\n        else\n        {\n          this.__relatedTarget = domEvent.relatedTarget;\n          this.setFocus(target);\n          this.__relatedTarget = null;\n          this.tryActivate(target);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>mousedown</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeMouseDown : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n\n        // Stop events when no focus element available (or blocked)\n        var focusTarget = this.__findFocusableElement(target);\n        if (focusTarget)\n        {\n          // Add unselectable to keep selection\n          if (!this.__isSelectable(target))\n          {\n            // The element is not selectable. Block selection.\n            target.unselectable = \"on\";\n\n            // Unselectable may keep the current selection which\n            // is not what we like when changing the focus element.\n            // So we clear it\n            try {\n              if (document.selection) {\n                document.selection.empty();\n              }\n            } catch (ex) {\n              // ignore 'Unknown runtime error'\n            }\n\n            // The unselectable attribute stops focussing as well.\n            // Do this manually.\n            try {\n              focusTarget.focus();\n            } catch (ex) {\n              // ignore \"Can't move focus of this control\" error\n            }\n          }\n        }\n        else\n        {\n          // Stop event for blocking support\n          qx.bom.Event.preventDefault(domEvent);\n\n          // Add unselectable to keep selection\n          if (!this.__isSelectable(target)) {\n            target.unselectable = \"on\";\n          }\n        }\n      },\n\n      \"webkit\" : function(domEvent) {\n        var target = qx.bom.Event.getTarget(domEvent);\n        var focusTarget = this.__findFocusableElement(target);\n\n        if (focusTarget) {\n          this.setFocus(focusTarget);\n        } else {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"gecko\" : function(domEvent) {\n        var target = qx.bom.Event.getTarget(domEvent);\n        var focusTarget = this.__findFocusableElement(target);\n\n        if (focusTarget) {\n          this.setFocus(focusTarget);\n        } else {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        var focusTarget = this.__findFocusableElement(target);\n\n        if (!this.__isSelectable(target)) {\n          // Prevent the default action for all non-selectable\n          // targets. This prevents text selection and context menu.\n          qx.bom.Event.preventDefault(domEvent);\n\n          // The stopped event keeps the selection\n          // of the previously focused element.\n          // We need to clear the old selection.\n          if (focusTarget)\n          {\n            var current = this.getFocus();\n            if (current && current.selectionEnd)\n            {\n              current.selectionStart = 0;\n              current.selectionEnd = 0;\n              current.blur();\n            }\n\n            // The prevented event also stop the focus, do\n            // it manually if needed.\n            if (focusTarget) {\n              this.setFocus(focusTarget);\n            }\n          }\n        } else if (focusTarget) {\n          this.setFocus(focusTarget);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>mouseup</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeMouseUp : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target.unselectable) {\n          target.unselectable = \"off\";\n        }\n\n        this.tryActivate(this.__fixFocus(target));\n      },\n\n      \"gecko\" : function(domEvent)\n      {\n        // As of Firefox 3.0:\n        // Gecko fires mouseup on XUL elements\n        // We only want to deal with real HTML elements\n        var target = qx.bom.Event.getTarget(domEvent);\n        while (target && target.offsetWidth === undefined) {\n          target = target.parentNode;\n        }\n\n        if (target) {\n          this.tryActivate(target);\n        }\n\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        this.tryActivate(this.__fixFocus(target));\n      },\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        this.tryActivate(this.__fixFocus(target));\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Fix for bug #9331.\n     *\n     * @signature function(target)\n     * @param target {Element} element to check\n     * @return {Element} return correct target (in case of compound input controls should always return textfield);\n     */\n    __getCorrectFocusTarget: function(target)\n    {\n      var focusedElement = this.getFocus();\n      if (focusedElement && target != focusedElement) {\n        if (focusedElement.nodeName.toLowerCase() === \"input\" ||\n          focusedElement.nodeName.toLowerCase() === \"textarea\") {\n          return focusedElement;\n        }\n        if( qx.Class.isClass(\"qx.ui.core.Widget\") ) {\n          // Check compound widgets\n          var widget = qx.ui.core.Widget.getWidgetByElement(focusedElement),\n            textField = widget && widget.getChildControl && widget.getChildControl(\"textfield\", true);\n        }\n        if (textField) {\n          return textField.getContentElement().getDomElement();\n        }\n      }\n      return target;\n    },\n\n    /**\n     * Fix for bug #2602.\n     *\n     * @signature function(target)\n     * @param target {Element} target element from mouse up event\n     * @return {Element} Element to activate;\n     */\n    __fixFocus : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n      {\n        \"mshtml\" : function(target) {\n          return this.__getCorrectFocusTarget(target);\n        },\n\n        \"webkit\" : function(target) {\n          return this.__getCorrectFocusTarget(target);\n        },\n\n        \"default\" : function(target) {\n          return target;\n        }\n      })),\n\n    /**\n     * Native event listener for <code>selectstart</code>.\n     *\n     *@signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeSelectStart : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (!this.__isSelectable(target)) {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (!this.__isSelectable(target)) {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /*\n    ---------------------------------------------------------------------------\n      HELPER METHODS\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Whether the given element is focusable. This is perfectly modeled to the\n     * browsers behavior and this way may differ in the various clients.\n     *\n     * @param el {Element} DOM Element to query\n     * @return {Boolean} Whether the element is focusable\n     */\n    __isFocusable : function(el)\n    {\n      var index = qx.bom.element.Attribute.get(el, \"tabIndex\");\n      if (index >= 1) {\n        return true;\n      }\n\n      var focusable = qx.event.handler.Focus.FOCUSABLE_ELEMENTS;\n      if (index >= 0 && focusable[el.tagName]) {\n        return true;\n      }\n\n      return false;\n    },\n\n\n    /**\n     * Returns the next focusable parent element of an activated DOM element.\n     *\n     * @param el {Element} Element to start lookup with.\n     * @return {Element|null} The next focusable element.\n     */\n    __findFocusableElement : function(el)\n    {\n      while (el && el.nodeType === 1)\n      {\n        if (el.getAttribute(\"qxKeepFocus\") == \"on\") {\n          return null;\n        }\n\n        if (this.__isFocusable(el)) {\n          return el;\n        }\n\n        el = el.parentNode;\n      }\n\n      // This should be identical to the one which is selected when\n      // clicking into an empty page area. In mshtml this must be\n      // the body of the document.\n      return this._body;\n    },\n\n    /**\n     * Returns the next activatable element. May be the element itself.\n     * Works a bit different than the method {@link #__findFocusableElement}\n     * as it looks up for a parent which is has a keep focus flag. When\n     * there is such a parent it returns null otherwise the original\n     * incoming element.\n     *\n     * @param el {Element} Element to start lookup with.\n     * @return {Element} The next activatable element.\n     */\n    __findActivatableElement : function(el)\n    {\n      var orig = el;\n\n      while (el && el.nodeType === 1)\n      {\n        if (el.getAttribute(\"qxKeepActive\") == \"on\") {\n          return null;\n        }\n\n        el = el.parentNode;\n      }\n\n      return orig;\n    },\n\n    /**\n     * Whether the given el (or its content) should be selectable\n     * by the user.\n     *\n     * @param node {Element} Node to start lookup with\n     * @return {Boolean} Whether the content is selectable.\n     */\n    __isSelectable : function(node)\n    {\n      while(node && node.nodeType === 1)\n      {\n        var attr = node.getAttribute(\"qxSelectable\");\n        if (attr != null) {\n          return attr === \"on\";\n        }\n\n        node = node.parentNode;\n      }\n\n      return true;\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      PROPERTY APPLY ROUTINES\n    ---------------------------------------------------------------------------\n    */\n\n    // apply routine\n    _applyActive : function(value, old)\n    {\n      // Fire events\n      if (old) {\n        this.__fireEvent(old, value, \"deactivate\", true);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old, \"activate\", true);\n      }\n      // correct scroll position for iOS 7\n      if (this.__needsScrollFix) {\n        window.scrollTo(0, 0);\n      }\n    },\n\n    // apply routine\n    _applyFocus : function(value, old)\n    {\n      // Fire bubbling events\n      if (old) {\n        this.__fireEvent(old, value, \"focusout\", true);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old, \"focusin\", true);\n      }\n\n      // Fire after events\n      if (old) {\n        this.__fireEvent(old, value, \"blur\", false);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old || this.__relatedTarget, \"focus\", false);\n      }\n    }\n  },\n\n  /*\n  *****************************************************************************\n     DESTRUCTOR\n  *****************************************************************************\n  */\n\n  destruct : function()\n  {\n    this._stopObserver();\n    this._manager = this._window = this._document = this._root = this._body =\n      this.__mouseActive = this.__relatedTarget = null;\n  },\n\n  /*\n  *****************************************************************************\n     DEFER\n  *****************************************************************************\n  */\n\n  defer : function(statics)\n  {\n    qx.event.Registration.addHandler(statics);\n\n    // For faster lookups generate uppercase tag names dynamically\n    var focusable = statics.FOCUSABLE_ELEMENTS;\n    for (var entry in focusable) {\n      focusable[entry.toUpperCase()] = 1;\n    }\n  }\n});\n"
  ]
}