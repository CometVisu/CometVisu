{
  "version": 3,
  "sources": [
    "/home/travis/build/CometVisu/CometVisu/source/class/cv/util/ConfigLoader.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "__loadQueue",
    "data",
    "Array",
    "members",
    "__doneCallback",
    "__doneCallbackContext",
    "__xml",
    "load",
    "callback",
    "context",
    "uri",
    "util",
    "ResourceManager",
    "getInstance",
    "toUri",
    "cv",
    "Config",
    "configSuffix",
    "testMode",
    "indexOf",
    "replace",
    "debug",
    "ajaxRequest",
    "io",
    "request",
    "Xhr",
    "push",
    "set",
    "accept",
    "cache",
    "forceReload",
    "setUserData",
    "addListenerOnce",
    "e",
    "Init",
    "getApplication",
    "block",
    "req",
    "getTarget",
    "configServer",
    "getResponseHeader",
    "xml",
    "getResponse",
    "Document",
    "fromString",
    "querySelectorAll",
    "forEach",
    "loadInclude",
    "remove",
    "getUrl",
    "documentElement",
    "getElementsByTagName",
    "length",
    "configError",
    "xmlLibVersion",
    "querySelector",
    "getAttribute",
    "undefined",
    "libraryCheck",
    "libraryVersion",
    "backendUrl",
    "endsWith",
    "backend",
    "_checkQueue",
    "addListener",
    "status",
    "getTransport",
    "Request",
    "isSuccessful",
    "getUserData",
    "demoUrl",
    "setUrl",
    "send",
    "includeElem",
    "url",
    "startsWith",
    "LibraryManager",
    "get",
    "xhr",
    "async",
    "getResponseText",
    "parent",
    "parentElement",
    "removeChild",
    "firstChild",
    "childNodes",
    "child",
    "appendChild",
    "call",
    "dispose",
    "textStatus",
    "additionalErrorInfo",
    "title",
    "locale",
    "Manager",
    "tr",
    "translate",
    "toString",
    "message",
    "link",
    "window",
    "location",
    "href",
    "notification",
    "topic",
    "severity",
    "unique",
    "deletable",
    "notifications",
    "Router",
    "dispatchMessage",
    "error",
    "destruct",
    "ConfigLoader"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * The ConfigLoader loads CometVisu config files from the backend. If the loaded config file contains\n * <include> elements those config parts are loaded and add to the XML-Document.\n *\n * @author Tobias Bräutigam <tbraeutigam@gmail.com>\n * @since 2018\n */\n\nqx.Class.define('cv.util.ConfigLoader', {\n  extend: qx.core.Object,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__loadQueue = new qx.data.Array();\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __loadQueue: null,\n    __doneCallback: null,\n    __doneCallbackContext: null,\n    __xml: null,\n\n    /**\n     * Load a config file\n     */\n    load: function (callback, context) {\n      this.__doneCallback = callback;\n      this.__doneCallbackContext = context;\n      // get the data once the page was loaded\n      var uri = qx.util.ResourceManager.getInstance().toUri('config/visu_config' + (cv.Config.configSuffix ? '_' + cv.Config.configSuffix : '') + '.xml');\n      if (cv.Config.testMode) {\n        // workaround for e2e-tests\n        uri = 'resource/config/visu_config' + (cv.Config.configSuffix ? '_' + cv.Config.configSuffix : '') + '.xml';\n      } else if (uri.indexOf(\"resource/\") === -1) {\n        // unknown config, try to add the resource part manually\n        uri = uri.replace(\"config/\", \"resource/config/\");\n      }\n      this.debug(\"Requesting \"+uri);\n      var ajaxRequest = new qx.io.request.Xhr(uri);\n      this.__loadQueue.push(uri);\n      ajaxRequest.set({\n        accept: \"application/xml\",\n        cache: !cv.Config.forceReload\n      });\n      ajaxRequest.setUserData(\"noDemo\", true);\n      ajaxRequest.addListenerOnce(\"success\", function (e) {\n        qx.core.Init.getApplication().block(false);\n        var req = e.getTarget();\n        cv.Config.configServer = req.getResponseHeader(\"Server\");\n        // Response parsed according to the server's response content type\n        var xml = req.getResponse();\n        if (xml && (typeof xml === 'string')) {\n          xml = qx.xml.Document.fromString(xml);\n        }\n        this.__xml = xml;\n        xml.querySelectorAll('include').forEach(this.loadInclude, this);\n        this.__loadQueue.remove(ajaxRequest.getUrl());\n\n        if (!xml || !xml.documentElement || xml.getElementsByTagName(\"parsererror\").length) {\n          this.configError(\"parsererror\");\n        }\n        else {\n          // check the library version\n          var xmlLibVersion = xml.querySelector('pages').getAttribute(\"lib_version\");\n          if (xmlLibVersion === undefined) {\n            xmlLibVersion = -1;\n          }\n          if (cv.Config.libraryCheck && xmlLibVersion < cv.Config.libraryVersion) {\n            this.configError(\"libraryerror\");\n          }\n          else {\n            if (req.getResponseHeader(\"X-CometVisu-Backend-LoginUrl\")) {\n              cv.Config.backendUrl = req.getResponseHeader(\"X-CometVisu-Backend-LoginUrl\");\n              if (!cv.Config.backendUrl.endsWith('/')) {\n                cv.Config.backendUrl += '/';\n              }\n            }\n            if (req.getResponseHeader(\"X-CometVisu-Backend-Name\")) {\n              cv.Config.backend = req.getResponseHeader(\"X-CometVisu-Backend-Name\");\n            }\n            this._checkQueue();\n          }\n        }\n      }, this);\n\n      ajaxRequest.addListener(\"statusError\", function (e) {\n        var status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status) && ajaxRequest.getUserData(\"noDemo\")) {\n          ajaxRequest.setUserData(\"noDemo\", false);\n          ajaxRequest.setUserData(\"origUrl\", ajaxRequest.getUrl());\n          this.__loadQueue.remove(ajaxRequest.getUrl());\n          var demoUrl = ajaxRequest.getUrl().replace('config/', 'demo/');\n          ajaxRequest.setUrl(demoUrl);\n          this.__loadQueue.push(demoUrl);\n          ajaxRequest.send();\n        } else if (!qx.util.Request.isSuccessful(status)) {\n          this.configError(\"filenotfound\", [ajaxRequest.getUserData(\"origUrl\"), ajaxRequest.getUrl()]);\n        }\n        else {\n          this.configError(status, null);\n        }\n      }, this);\n\n      ajaxRequest.send();\n    },\n\n    /**\n     * Load an include source and replace it with the loaded content\n     * @param includeElem {Element}\n     */\n    loadInclude: function (includeElem) {\n      var url = includeElem.getAttribute('src');\n      if (!url.startsWith('/')) {\n        url = qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/' + url;\n      }\n      this.__loadQueue.push(url);\n      var xhr = new qx.io.request.Xhr(url);\n      xhr.set({\n        accept: \"text/plain\",\n        async: false\n      });\n      xhr.addListenerOnce(\"success\", function(e) {\n        var req = e.getTarget();\n        var xml = qx.xml.Document.fromString('<root>' + req.getResponseText() + '</root>');\n        var parent = includeElem.parentElement;\n        parent.removeChild(includeElem);\n        xml.firstChild.childNodes.forEach(function (child) {\n          parent.appendChild(child);\n        });\n        this.__loadQueue.remove(url);\n        this._checkQueue();\n      }, this);\n      xhr.addListener(\"statusError\", function (e) {\n        var status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status)) {\n          this.configError(\"filenotfound\", [xhr.getUrl(), '']);\n        } else {\n          this.configError(status, null);\n        }\n      }, this);\n      xhr.send();\n    },\n\n    /**\n     * Check if everything is loaded and call the callback in this case\n     * @private\n     */\n    _checkQueue: function () {\n      if (this.__loadQueue.length === 0) {\n        this.__doneCallback.call(this.__doneCallbackContext, this.__xml);\n        this.dispose();\n      }\n    },\n\n    /**\n     * Handle errors that occur during loading ot the config file\n     * @param textStatus {String} error status\n     * @param additionalErrorInfo {String} error message\n     */\n    configError: function( textStatus, additionalErrorInfo ) {\n      var configSuffix = (cv.Config.configSuffix ? cv.Config.configSuffix : '');\n      var title = qx.locale.Manager.tr('Config-File Error!').translate().toString();\n      var message = '';\n      switch (textStatus) {\n        case 'parsererror':\n          message = qx.locale.Manager.tr(\"Invalid config file!\")+'<br/><a href=\"check_config.php?config=' + configSuffix + '\">'+qx.locale.Manager.tr(\"Please check!\")+'</a>';\n          break;\n        case 'libraryerror':\n          var link = window.location.href;\n          if (link.indexOf('?') <= 0) {\n            link = link + '?';\n          }\n          link = link + '&libraryCheck=false';\n          message = qx.locale.Manager.tr('Config file has wrong library version!').translate().toString()+'<br/>' +\n            qx.locale.Manager.tr('This can cause problems with your configuration').translate().toString()+'</br>' +\n            '<p>'+qx.locale.Manager.tr(\"You can run the %1Configuration Upgrader%2.\", '<a href=\"./upgrade/index.php?config=' + configSuffix + '\">', '</a>').translate().toString() +'</br>' +\n            qx.locale.Manager.tr('Or you can start without upgrading %1with possible configuration problems%2', '<a href=\"' + link + '\">', '</a>').translate().toString()+'</p>';\n          break;\n        case 'filenotfound':\n          message = qx.locale.Manager.tr('404: Config file not found. Neither as normal config (%1) nor as demo config (%2).', additionalErrorInfo[0], additionalErrorInfo[1]).translate().toString();\n          break;\n        default:\n          message = qx.locale.Manager.tr('Unhandled error of type \"%1\"', textStatus).translate().toString();\n          if( additionalErrorInfo ) {\n            message += ': ' + additionalErrorInfo;\n          }\n          else {\n            message += '.';\n          }\n      }\n      var notification = {\n        topic: \"cv.config.error\",\n        title: title,\n        message: message,\n        severity: \"urgent\",\n        unique: true,\n        deletable: false\n      };\n      cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n      this.error(this, message.toString());\n      qx.core.Init.getApplication().block(false);\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function () {\n    // remove references\n    this.__xml = null;\n    this.__doneCallback = null;\n    this.__doneCallbackContext = null;\n  }\n});"
  ]
}