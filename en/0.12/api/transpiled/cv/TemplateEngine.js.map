{
  "version": 3,
  "sources": [
    "/home/travis/build/CometVisu/CometVisu/source/class/cv/TemplateEngine.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "pagePartsHandler",
    "cv",
    "ui",
    "PagePartsHandler",
    "__partQueue",
    "data",
    "Array",
    "_domFinishedQueue",
    "addListener",
    "ev",
    "setPartsLoaded",
    "getData",
    "defaults",
    "widget",
    "plugin",
    "group",
    "command",
    "Group",
    "setCommands",
    "app",
    "Init",
    "getApplication",
    "manager",
    "getCommandManager",
    "add",
    "setActive",
    "properties",
    "partsLoaded",
    "check",
    "init",
    "apply",
    "event",
    "scriptsLoaded",
    "ready",
    "currentPage",
    "nullable",
    "domFinished",
    "commands",
    "loggedIn",
    "members",
    "bindClickToWidget",
    "main_scroll",
    "old_scroll",
    "visu",
    "pluginsToLoadCount",
    "xml",
    "lazyPlugins",
    "__activeChangedTimer",
    "__hasBeenConnected",
    "loadParts",
    "parts",
    "isArray",
    "loadLazyParts",
    "filter",
    "part",
    "indexOf",
    "length",
    "p",
    "includes",
    "append",
    "io",
    "PartLoader",
    "require",
    "states",
    "forEach",
    "idx",
    "remove",
    "debug",
    "startsWith",
    "setStructureLoaded",
    "error",
    "_applyReady",
    "value",
    "setupPage",
    "_applyLoaded",
    "old",
    "name",
    "isPartsLoaded",
    "isScriptsLoaded",
    "setReady",
    "_applyDomFinished",
    "message",
    "Bus",
    "dispatchByName",
    "entry",
    "callback",
    "shift",
    "context",
    "executeWhenDomFinished",
    "isDomFinished",
    "push",
    "prototype",
    "slice",
    "call",
    "arguments",
    "addAddress",
    "address",
    "id",
    "warn",
    "Model",
    "getInstance",
    "getAddresses",
    "initBackendClient",
    "backendName",
    "Config",
    "configSettings",
    "backend",
    "Application",
    "createClient",
    "backendUrl",
    "model",
    "update",
    "bind",
    "reporting",
    "recordInstance",
    "report",
    "Record",
    "record",
    "d",
    "BACKEND",
    "showError",
    "_handleClientError",
    "user",
    "sentryEnabled",
    "window",
    "Sentry",
    "configureScope",
    "scope",
    "setTag",
    "webServer",
    "getServer",
    "configServer",
    "_updateClientScope",
    "_onActiveChanged",
    "_checkBackendConnection",
    "isActive",
    "isConnected",
    "restart",
    "Timer",
    "stop",
    "connected",
    "topic",
    "title",
    "locale",
    "Manager",
    "tr",
    "severity",
    "unique",
    "deletable",
    "condition",
    "lastError",
    "getLastError",
    "Date",
    "now",
    "time",
    "url",
    "code",
    "text",
    "notifications",
    "Router",
    "dispatchMessage",
    "errorCode",
    "varargs",
    "notification",
    "Client",
    "ERROR_CODES",
    "PROTOCOL_MISSING_VERSION",
    "JSON",
    "stringify",
    "PROTOCOL_INVALID_READ_RESPONSE_MISSING_I",
    "resetPageValues",
    "resetCurrentPage",
    "layout",
    "currentPageUnavailableWidth",
    "currentPageUnavailableHeight",
    "currentPageNavbarVisibility",
    "parseXML",
    "loaded_xml",
    "done",
    "settings",
    "pagesNode",
    "querySelector",
    "predefinedDesign",
    "getAttribute",
    "clientDesign",
    "selectDesign",
    "getStructure",
    "scrollSpeed",
    "parseInt",
    "defaultColumns",
    "minColumnWidth",
    "screensave_time",
    "screensave_page",
    "maxMobileScreenWidth",
    "globalClass",
    "document",
    "classList",
    "scriptsToLoad",
    "stylesToLoad",
    "design",
    "getDesign",
    "baseUri",
    "mobileDevice",
    "util",
    "ScriptLoader",
    "addListenerOnce",
    "alternativeStyles",
    "addStyles",
    "addScripts",
    "metaParser",
    "parser",
    "MetaParser",
    "pluginsToLoad",
    "concat",
    "parsePlugins",
    "parse",
    "login",
    "setLoggedIn",
    "querySelectorAll",
    "elem",
    "cacheUsed",
    "page",
    "createPages",
    "setDomFinished",
    "structure",
    "WidgetFactory",
    "getInstanceById",
    "initialPage",
    "setCurrentPage",
    "adjustColumns",
    "applyColumnWidths",
    "PageHandler",
    "undefined",
    "setSpeed",
    "DeferredCall",
    "scrollToPage",
    "schedule",
    "bom",
    "History",
    "e",
    "lastPage",
    "onload",
    "TrickOMatic",
    "run",
    "startInitialRequest",
    "IconTools",
    "fillRecoloredIcon",
    "startScreensaver",
    "screensave",
    "start",
    "Registration",
    "enableAddressQueue",
    "startPageAddresses",
    "pageWidget",
    "getChildWidgets",
    "child",
    "getAddress",
    "addr",
    "hasOwnProperty",
    "setInitialAddresses",
    "keys",
    "addressesToSubscribe",
    "subscribe",
    "path",
    "flavour",
    "WidgetParser",
    "renderTemplates",
    "parsedData",
    "i",
    "l",
    "createInstance",
    "$$type",
    "getDomString",
    "getPageIdByPath",
    "page_name",
    "match",
    "traversePath",
    "getPageIdByName",
    "root_page_id",
    "path_scope",
    "index",
    "substr",
    "next",
    "path_page_name",
    "page_id",
    "String",
    "decodeHtmlEntities",
    "decodeURI",
    "replace",
    "selector",
    "pages",
    "from",
    "h",
    "textContent",
    "getCurrentPage",
    "currentPageId",
    "getPath",
    "fallback",
    "Tree",
    "getClosest",
    "innerText",
    "pid",
    "target",
    "speed",
    "skipHistory",
    "treePath",
    "rememberLastPage",
    "Environment",
    "get",
    "localStorage",
    "lastpage",
    "headline",
    "pageTitle",
    "addToHistory",
    "seekTo",
    "initializeNavbars",
    "navbars",
    "left",
    "dynamic",
    "fadeNavbar",
    "body",
    "style",
    "display",
    "div",
    "dom",
    "Element",
    "create",
    "entries",
    "background",
    "width",
    "color",
    "margin",
    "padding",
    "key_value",
    "innerHTML",
    "appendChild",
    "store",
    "Json",
    "ResourceManager",
    "toUri",
    "html",
    "getModel",
    "element",
    "myDiv",
    "cursor",
    "borderBottom",
    "position",
    "tDiv",
    "height",
    "zIndex",
    "pos",
    "getBoundingClientRect",
    "top",
    "href",
    "location",
    "hash",
    "split",
    "search",
    "destruct",
    "_disposeObjects",
    "TemplateEngine"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* TemplateEngine.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.TemplateEngine', {\n  extend: qx.core.Object,\n  type: \"singleton\",\n\n  construct: function() {\n    // this.base(arguments);\n    this.pagePartsHandler = new cv.ui.PagePartsHandler();\n\n    this.__partQueue = new qx.data.Array();\n    this._domFinishedQueue = [];\n    this.__partQueue.addListener(\"changeLength\", function(ev) {\n      this.setPartsLoaded(ev.getData() === 0);\n    }, this);\n\n    this.defaults = {widget: {}, plugin: {}};\n    var group = new qx.ui.command.Group();\n    this.setCommands(group);\n    var app = qx.core.Init.getApplication();\n    if (app) {\n      // application is not available in tests\n      var manager = app.getCommandManager();\n      manager.add(group);\n      manager.setActive(group);\n    }\n  },\n\n  properties: {\n\n    /**\n     * Shows the loading state of the parts\n     */\n    partsLoaded: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyLoaded\",\n      event: \"changePartsLoaded\"\n    },\n\n    /**\n     * Shows the loading state of the scripts\n     */\n    scriptsLoaded: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyLoaded\"\n    },\n\n    /**\n     * Shows the initialization state of the TemplateEngine. It gets until when all\n     * external stuff (pars, scripts, etc.) has been loaded.\n     */\n    ready: {\n      check: \"Boolean\",\n      init: false,\n      event: \"changeReady\",\n      apply: \"_applyReady\"\n    },\n\n    currentPage: {\n      check: \"cv.ui.structure.IPage\",\n      nullable: true,\n      event: \"changeCurrentPage\"\n    },\n\n    domFinished: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyDomFinished\",\n      event: \"changeDomFinished\"\n    },\n\n    commands: {\n      check: \"qx.ui.command.Group\",\n      nullable: true\n    },\n    \n    // sent after the client is logged in to the backend\n    loggedIn: {\n      check: \"Boolean\",\n      init: false,\n      event: \"changeLoggedIn\"\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    pagePartsHandler: null,\n    // if true the whole widget reacts on click events\n    // if false only the actor in the widget reacts on click events\n    bindClickToWidget : false,\n    /**\n     * Structure where a design can set a default value that a widget or plugin\n     * can use.\n     * This is especially important for design relevant information like colors\n     * that can not be set though CSS.\n     *\n     * Usage: this.defaults.plugin.foo = {bar: 'baz'};\n     */\n    defaults : null,\n\n    main_scroll : null,\n    old_scroll : '',\n    visu : null,\n\n    pluginsToLoadCount : 0,\n    xml : null,\n\n    __partQueue: null,\n    _domFinishedQueue: null,\n\n    // plugins that do not need to be loaded to proceed with the initial setup\n    lazyPlugins: [\"plugin-openhab\"],\n    __activeChangedTimer: null,\n    __hasBeenConnected: false,\n\n    /**\n     * Load parts (e.g. plugins, structure)\n     *\n     * @param parts {String[]|String} parts to load\n     */\n    loadParts: function(parts) {\n      if (!Array.isArray(parts)) {\n        parts = [parts];\n      }\n      var loadLazyParts = this.lazyPlugins.filter(function(part) {\n        return parts.indexOf(part) >= 0;\n      });\n      if (loadLazyParts.length) {\n        parts = parts.filter(function(p){return !loadLazyParts.includes(p);});\n      }\n      this.__partQueue.append(parts);\n      qx.io.PartLoader.require(parts, function(states) {\n        parts.forEach(function(part, idx) {\n          if (states[idx] === \"complete\") {\n            this.__partQueue.remove(part);\n            this.debug(\"successfully loaded part \"+part);\n            if (part.startsWith('structure-')) {\n              qx.core.Init.getApplication().setStructureLoaded(true);\n            }\n          } else {\n            this.error(\"error loading part \"+part);\n          }\n        }, this);\n      }, this);\n\n      // load the lazy plugins no one needs to wait for\n      qx.io.PartLoader.require(loadLazyParts, function(states) {\n        loadLazyParts.forEach(function(part, idx) {\n          if (states[idx] === \"complete\") {\n            this.debug(\"successfully loaded part \"+part);\n          } else {\n            this.error(\"error loading part \"+part);\n          }\n        }, this);\n      }, this);\n    },\n\n    // property apply\n    _applyReady: function(value) {\n      if (value === true) {\n        this.setupPage();\n      }\n    },\n\n    // property apply\n    _applyLoaded: function(value, old, name) {\n      this.debug(name+\" is \"+value+\" now\");\n      if (this.isPartsLoaded() && this.isScriptsLoaded()) {\n        this.setReady(true);\n      }\n    },\n\n    // property apply\n    _applyDomFinished: function(value) {\n      if (value) {\n        qx.event.message.Bus.dispatchByName(\"setup.dom.finished\");\n        // flush the queue\n        this._domFinishedQueue.forEach(function(entry) {\n          var callback = entry.shift();\n          var context = entry.shift();\n          callback.apply(context, entry);\n        }, this);\n        this._domFinishedQueue = [];\n      }\n    },\n\n    /**\n     * Adds a callback to a queue which is executed after DOM has been rendered\n     * @param callback {Function}\n     * @param context {Object}\n     */\n    executeWhenDomFinished: function(callback, context) {\n      if (!this.isDomFinished()) {\n        // queue callback\n        this._domFinishedQueue.push(Array.prototype.slice.call(arguments));\n      } else {\n        callback.apply(context, Array.prototype.slice.call(arguments, 2));\n      }\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().addAddress()} instead\n     * @deprecated {0.11.0} Please use {cv.data.Model.getInstance().addAddress()} instead\n     */\n    addAddress: function (address, id) {\n      this.warn(\"addAddress is deprecated! Please use cv.data.Model.getInstance().addAddress() instead\");\n      cv.data.Model.getInstance().addAddress(address, id);\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().getAddresses()} instead\n     * @deprecated {0.11.0} Please use {cv.data.Model.getInstance().getAddresses()} instead\n     */\n    getAddresses: function () {\n      this.warn(\"getAddresses is deprecated! Please use cv.data.Model.getInstance().getAddresses() instead\");\n      return cv.data.Model.getInstance().getAddresses();\n    },\n\n    /**\n     * Initialize the {@link cv.io.Client} for backend communication\n     */\n    initBackendClient: function () {\n      var backendName = cv.Config.configSettings.backend || cv.Config.backend;\n      if (backendName === \"oh\") {\n        this.visu = cv.Application.createClient('openhab', cv.Config.backendUrl);\n      }\n      else if (backendName === \"oh2\") {\n        this.visu = cv.Application.createClient('openhab2', cv.Config.backendUrl);\n      } else {\n        this.visu = cv.Application.createClient(backendName, cv.Config.backendUrl);\n      }\n\n      var model = cv.data.Model.getInstance();\n      this.visu.update = model.update.bind(model); // override clients update function\n      if (cv.Config.reporting) {\n        var recordInstance = cv.report.Record.getInstance();\n        this.visu.record = function(p,d){recordInstance.record.apply(recordInstance,[cv.report.Record.BACKEND,p,d]);};\n      }\n      this.visu.showError = this._handleClientError.bind(this);\n      this.visu.user = 'demo_user'; // example for setting a user\n      var visu = this.visu;\n\n      if (cv.Config.sentryEnabled && window.Sentry) {\n        Sentry.configureScope(function (scope) {\n          scope.setTag('backend', visu.backendName);\n          var webServer = visu.getServer();\n          if (webServer) {\n            scope.setTag('server.backend', webServer);\n          }\n          if (cv.Config.configServer) {\n            scope.setTag('server.web', cv.Config.configServer);\n          }\n        })\n        visu.addListener('changedServer', this._updateClientScope, this);\n      }\n      var app = qx.core.Init.getApplication();\n      app.addListener('changeActive', this._onActiveChanged, this);\n\n      // show connection state in NotificationCenter\n      this.visu.addListener(\"changeConnected\", this._checkBackendConnection, this);\n    },\n\n    _onActiveChanged: function () {\n      var app = qx.core.Init.getApplication();\n      if (app.isActive()) {\n        if (!this.visu.isConnected() && this.__hasBeenConnected) {\n          // reconnect\n          this.visu.restart(true);\n        }\n        // wait for 3 seconds before checking the backend connection\n        if (!this.__activeChangedTimer) {\n          this.__activeChangedTimer = new qx.event.Timer(3000);\n          this.__activeChangedTimer.addListener('interval', function () {\n            if (app.isActive()) {\n              this._checkBackendConnection();\n            }\n            this.__activeChangedTimer.stop();\n          }, this);\n        }\n        this.__activeChangedTimer.restart();\n      } else {\n        this._checkBackendConnection();\n      }\n    },\n\n    _checkBackendConnection: function () {\n      var connected = this.visu.isConnected();\n      var message = {\n        topic: \"cv.client.connection\",\n        title: qx.locale.Manager.tr(\"Connection error\"),\n        severity: \"urgent\",\n        unique: true,\n        deletable: false,\n        condition: !connected && this.__hasBeenConnected && qx.core.Init.getApplication().isActive()\n      };\n      var lastError = this.visu.getLastError();\n      if (!connected) {\n        if (lastError && (Date.now() - lastError.time) < 100) {\n          message.message = qx.locale.Manager.tr(\"Error requesting %1: %2 - %3.\", lastError.url, lastError.code, lastError.text);\n        } else {\n          message.message = qx.locale.Manager.tr(\"Connection to backend is lost.\");\n        }\n      } else {\n        this.__hasBeenConnected = true;\n      }\n      cv.core.notifications.Router.dispatchMessage(message.topic, message);\n    },\n\n    _updateClientScope: function () {\n      var visu = this.visu;\n      Sentry.configureScope(function (scope) {\n        var webServer = visu.getServer();\n        if (webServer) {\n          scope.setTag('server.backend', webServer);\n        }\n      })\n    },\n\n    _handleClientError: function (errorCode, varargs) {\n      varargs = Array.prototype.slice.call(arguments, 1);\n      var notification;\n      var message = '';\n      switch (errorCode) {\n        case cv.io.Client.ERROR_CODES.PROTOCOL_MISSING_VERSION:\n          notification = {\n            topic: \"cv.error\",\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to the %1Login%2 request: missing protocol version.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n            '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + JSON.stringify(varargs[0], null, 2) +'</pre></div>',\n            severity: \"urgent\",\n            unique: true,\n            deletable: false\n          };\n          break;\n\n        case cv.io.Client.ERROR_CODES.PROTOCOL_INVALID_READ_RESPONSE_MISSING_I:\n          notification = {\n            topic: \"cv.error\",\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to a %1read%2 request: Missing \"i\" value.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n              '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + JSON.stringify(varargs[0], null, 2) +'</pre></div>',\n            severity: \"urgent\",\n            unique: true,\n            deletable: false\n          };\n          break;\n      }\n      if (notification) {\n        cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n      }\n    },\n\n    /**\n     * Reset some values related to the current page\n     */\n    resetPageValues: function () {\n      this.resetCurrentPage();\n      cv.ui.layout.Manager.currentPageUnavailableWidth = -1;\n      cv.ui.layout.Manager.currentPageUnavailableHeight = -1;\n      cv.ui.layout.Manager.currentPageNavbarVisibility = null;\n    },\n\n    /**\n     * Read basic settings and meta-section from config document\n     * @param loaded_xml {Document} XML-configuration document\n     * @param done {Function} callback that is called when the parsing has finished\n     */\n    parseXML: function (loaded_xml, done) {\n      /*\n       * First, we try to get a design by url. Secondly, we try to get a predefined\n       */\n      // read predefined design in config\n      var settings = cv.Config.configSettings;\n      var pagesNode = loaded_xml.querySelector(\"pages\");\n\n      var predefinedDesign = pagesNode.getAttribute(\"design\");\n      // design by url\n      // design by config file\n      if (!cv.Config.clientDesign && !settings.clientDesign) {\n        if (predefinedDesign) {\n          settings.clientDesign = predefinedDesign;\n        }\n        // selection dialog\n        else {\n          this.selectDesign();\n        }\n      }\n\n      // load structure-part\n      this.loadParts([cv.Config.getStructure()]);\n\n      if (pagesNode.getAttribute(\"backend\") !== null) {\n        settings.backend = pagesNode.getAttribute(\"backend\");\n      }\n      this.initBackendClient();\n\n      if (pagesNode.getAttribute('scroll_speed') === null) {\n        settings.scrollSpeed = 400;\n      } else {\n        settings.scrollSpeed = parseInt(pagesNode.getAttribute('scroll_speed'));\n      }\n\n      if (pagesNode.getAttribute('bind_click_to_widget') !== null) {\n        settings.bindClickToWidget = pagesNode.getAttribute('bind_click_to_widget') === \"true\";\n      }\n      if (pagesNode.getAttribute('default_columns') !== null) {\n        settings.defaultColumns = pagesNode.getAttribute('default_columns');\n      }\n      if (pagesNode.getAttribute('min_column_width') !== null) {\n        settings.minColumnWidth = pagesNode.getAttribute('min_column_width');\n      }\n      settings.screensave_time = pagesNode.getAttribute('screensave_time');\n      if (settings.screensave_time) {\n        settings.screensave_time = parseInt(settings.screensave_time, 10);\n      }\n      settings.screensave_page = pagesNode.getAttribute('screensave_page');\n\n      if (pagesNode.getAttribute('max_mobile_screen_width') !== null) {\n        settings.maxMobileScreenWidth = pagesNode.getAttribute('max_mobile_screen_width');\n      }\n\n      var globalClass = pagesNode.getAttribute('class');\n      if (globalClass !== null) {\n        document.querySelector('body').classList.add(globalClass);\n      }\n\n      settings.scriptsToLoad = [];\n      settings.stylesToLoad = [];\n      var design = cv.Config.getDesign();\n      if (design) {\n        var baseUri = 'designs/' + design;\n        settings.stylesToLoad.push(baseUri + '/basic.css');\n        this.debug('cv.Config.mobileDevice: ' + cv.Config.mobileDevice);\n        if (cv.Config.mobileDevice) {\n          settings.stylesToLoad.push(baseUri + '/mobile.css');\n          document.querySelector('body').classList.add('mobile');\n        }\n        settings.stylesToLoad.push(baseUri + '/custom.css');\n        settings.scriptsToLoad.push('designs/' + design + '/design_setup.js');\n\n        cv.util.ScriptLoader.getInstance().addListenerOnce(\"designError\", function(ev) {\n          if (ev.getData() === design) {\n            this.error('Failed to load \"'+design+'\" design! Falling back to simplified \"pure\"');\n\n            baseUri = 'designs/pure';\n            var alternativeStyles = [baseUri+'/basic.css'];\n            if (cv.Config.mobileDevice) {\n              alternativeStyles.push(baseUri+'/mobile.css');\n            }\n            alternativeStyles.push(baseUri+'/custom.css');\n            cv.util.ScriptLoader.getInstance().addStyles( alternativeStyles );\n            cv.util.ScriptLoader.getInstance().addScripts(baseUri+\"/design_setup.js\");\n          }\n        }, this);\n      }\n      var metaParser = new cv.parser.MetaParser();\n\n      // start with the plugins\n      settings.pluginsToLoad = settings.pluginsToLoad.concat(metaParser.parsePlugins(loaded_xml));\n      // and then the rest\n      metaParser.parse(loaded_xml, done);\n      this.debug(\"parsed\");\n    },\n\n    /**\n     * Main setup to get everything running and show the initial page.\n     */\n    setupPage: function () {\n      // and now setup the pages\n      this.debug(\"setup\");\n\n      // login to backend as it might change some settings needed for further processing\n      this.visu.login(true, function () {\n        this.debug(\"logged in\");\n        this.setLoggedIn(true);\n\n        // as we are sure that the default CSS were loaded now:\n        document.querySelectorAll('link[href*=\"mobile.css\"]').forEach(function (elem) {\n        });\n        if (!cv.Config.cacheUsed) {\n          this.debug(\"creating pages\");\n          var page = this.xml.querySelector('pages > page'); // only one page element allowed...\n\n          this.createPages(page, 'id');\n          this.debug(\"finalizing\");\n          qx.event.message.Bus.dispatchByName(\"setup.dom.append\");\n          this.debug(\"pages created\");\n        }\n        this.debug(\"setup.dom.finished\");\n        qx.event.message.Bus.dispatchByName(\"setup.dom.finished.before\");\n        this.setDomFinished(true);\n\n        var currentPage = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        if (currentPage) {\n          this.setCurrentPage(currentPage);\n        }\n        cv.ui.layout.Manager.adjustColumns();\n        cv.ui.layout.Manager.applyColumnWidths('#'+cv.Config.initialPage, true);\n\n        this.main_scroll = new cv.ui.PageHandler();\n        if (this.scrollSpeed !== undefined) {\n          this.main_scroll.setSpeed(this.scrollSpeed);\n        }\n\n        new qx.util.DeferredCall(function() {\n          this.scrollToPage(cv.Config.initialPage, 0);\n        }, this).schedule();\n\n        // reaction on browser back button\n        qx.bom.History.getInstance().addListener(\"request\", function(e) {\n          var lastPage = e.getData();\n          if (lastPage) {\n            this.scrollToPage(lastPage, 0, true);\n          }\n        }, this);\n\n        // run the Trick-O-Matic scripts for great SVG backdrops\n        document.querySelectorAll('embed').forEach(function(elem) {\n          elem.onload = cv.ui.TrickOMatic.run;\n        });\n\n        this.startInitialRequest();\n\n        this.xml = null; // not needed anymore - free the space\n\n        document.querySelectorAll('.icon').forEach(cv.util.IconTools.fillRecoloredIcon, cv.util.IconTools);\n        document.querySelectorAll('.loading').forEach(function(elem) {\n          elem.classList.remove('loading');\n        }, this);\n\n        this.startScreensaver();\n        if (qx.core.Environment.get(\"qx.aspects\")) {\n          qx.dev.Profile.stop();\n          qx.dev.Profile.showResults(50);\n        }\n      }, this);\n    },\n\n    /**\n     * Start the screensaver if a screensave time is set\n     */\n    startScreensaver: function() {\n      if (typeof cv.Config.configSettings.screensave_time === 'number') {\n        this.screensave = new qx.event.Timer(cv.Config.configSettings.screensave_time * 1000);\n        this.screensave.addListener(\"interval\", function () {\n          this.scrollToPage();\n        }, this);\n        this.screensave.start();\n        qx.event.Registration.addListener(window, \"useraction\", this.screensave.restart, this.screensave);\n      }\n    },\n\n    /**\n     * Start retrieving data from backend\n     */\n    startInitialRequest: function() {\n      if (qx.core.Environment.get(\"qx.debug\")) {\n        cv.report.Replay.start();\n      }\n      if (cv.Config.enableAddressQueue) {\n        // identify addresses on startpage\n        var startPageAddresses = {};\n        var pageWidget = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        pageWidget.getChildWidgets().forEach(function(child) {\n          var address = child.getAddress ? child.getAddress() : {};\n          for (var addr in address) {\n            if (address.hasOwnProperty(addr)) {\n              startPageAddresses[addr] = 1;\n            }\n          }\n        }, this);\n        this.visu.setInitialAddresses(Object.keys(startPageAddresses));\n      }\n      var addressesToSubscribe = cv.data.Model.getInstance().getAddresses();\n      if (0 !== addressesToSubscribe.length) {\n        this.visu.subscribe(addressesToSubscribe);\n      }\n    },\n\n    /**\n     * Start the parsing process\n     * @param page {Element} XML-configuration element\n     * @param path {String} internal poth\n     * @param flavour {String} inherited flavour\n     * @param type {String} page type (text, 2d, 3d)\n     */\n    createPages: function (page, path, flavour, type) {\n      cv.parser.WidgetParser.renderTemplates(page);\n      var parsedData = cv.parser.WidgetParser.parse(page, path, flavour, type);\n      if (!Array.isArray(parsedData)) {\n        parsedData = [parsedData];\n      }\n      for (var i = 0, l = parsedData.length; i < l; i++) {\n        var data = parsedData[i];\n        var widget = cv.ui.structure.WidgetFactory.createInstance(data.$$type, data);\n\n        // trigger DOM generation\n        if (widget) { widget.getDomString(); }\n      }\n    },\n\n    /**\n     * Returns the id of the page the given path is associated to\n     * @param page_name {String}\n     * @param path {String}\n     * @return {String}\n     */\n    getPageIdByPath: function (page_name, path) {\n      if (page_name === null) { return null; }\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } else {\n        if (path !== undefined) {\n          var scope = this.traversePath(path);\n          if (scope === null) {\n            // path is wrong\n            this.error(\"path '\" + path + \"' could not be traversed, no page found\");\n            return null;\n          }\n          return this.getPageIdByName(page_name, scope);\n        } else {\n          return this.getPageIdByName(page_name);\n        }\n      }\n    },\n\n    traversePath: function (path, root_page_id) {\n      var path_scope = null;\n      var index = path.indexOf(\"/\");\n      if (index >= 1) {\n        // skip escaped slashes like \\/\n        while (path.substr(index - 1, 1) === \"\\\\\") {\n          var next = path.indexOf(\"/\", index + 1);\n          if (next >= 0) {\n            index = next;\n          }\n        }\n      }\n      //    console.log(\"traversePath(\"+path+\",\"+root_page_id+\")\");\n      if (index >= 0) {\n        // traverse path one level down\n        var path_page_name = path.substr(0, index);\n        path_scope = this.getPageIdByName(path_page_name, root_page_id);\n        path = path.substr(path_page_name.length + 1);\n        path_scope = this.traversePath(path, path_scope);\n        //      console.log(path_page_name+\"=>\"+path_scope);\n        return path_scope;\n      } else {\n        // bottom path level reached\n        path_scope = this.getPageIdByName(path, root_page_id);\n        return path_scope;\n      }\n    },\n\n    getPageIdByName: function (page_name, scope) {\n      var page_id = null;\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } else {\n        // find Page-ID by name\n        // decode html code (e.g. like &apos; => ')\n        page_name = cv.util.String.decodeHtmlEntities(page_name);\n        // remove escaped slashes\n        page_name = decodeURI(page_name.replace(\"\\\\\\/\", \"/\"));\n\n        //      console.log(\"Page: \"+page_name+\", Scope: \"+scope);\n        var selector = (scope !== undefined && scope !== null) ? '.page[id^=\"' + scope + '\"] h1' : '.page h1';\n        var pages = document.querySelectorAll(selector);\n        pages = Array.from( pages ).filter(function(h){return h.textContent === page_name;});\n        if (pages.length > 1 && this.getCurrentPage() !== null) {\n          var currentPageId = this.getCurrentPage().getPath();\n          // More than one Page found -> search in the current pages descendants first\n          var fallback = true;\n          pages.forEach(function (page) {\n            var p = cv.util.Tree.getClosest(page, \".page\");\n            if (page.innerText === page_name) {\n              var pid = p.getAttribute('id');\n              if (pid.length < currentPageId.length) {\n                // found pages path is shorter the the current pages -> must be an ancestor\n                if (currentPageId.indexOf(pid) === 0) {\n                  // found page is an ancestor of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return false;\n                }\n              } else {\n                if (pid.indexOf(currentPageId) === 0) {\n                  // found page is an descendant of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return false;\n                }\n              }\n            }\n          }, this);\n          if (fallback) {\n            // take the first page that fits (old behaviour)\n            pages.forEach(function (page) {\n              if (page.innerText  === page_name) {\n                page_id = cv.util.Tree.getClosest(page, \".page\").getAttribute(\"id\");\n                // break loop\n                return false;\n              }\n            });\n          }\n        } else {\n          pages.forEach(function (page) {\n            if (page.innerText === page_name) {\n              page_id = cv.util.Tree.getClosest(page, \".page\").getAttribute(\"id\");\n              // break loop\n              return false;\n            }\n          });\n        }\n      }\n      if (page_id !== null && page_id.match(/^id_[0-9_]*$/) !== null) {\n        return page_id;\n      } else {\n        // not found\n        return null;\n      }\n    },\n\n    scrollToPage: function (target, speed, skipHistory) {\n      if (undefined === target) {\n        target = cv.Config.configSettings.screensave_page;\n      }\n      var page_id = this.getPageIdByPath(target);\n      if (page_id === null) {\n        return;\n      }\n      if (cv.Config.currentPageId === page_id) {\n        return;\n      }\n      cv.Config.currentPageId = page_id;\n      cv.Config.treePath = page_id;\n\n      if (undefined === speed) {\n        speed = cv.Config.configSettings.scrollSpeed;\n      }\n\n      if (cv.Config.rememberLastPage && qx.core.Environment.get(\"html.storage.local\")) {\n        localStorage.lastpage = page_id;\n      }\n\n      // push new state to history\n      if (skipHistory === undefined) {\n        var headline = document.querySelectorAll(\"#\"+page_id+\" h1\");\n        var pageTitle = \"CometVisu\";\n        if (headline.length) {\n          pageTitle = headline[0].textContent+ \" - \"+pageTitle;\n        }\n        qx.bom.History.getInstance().addToHistory(page_id, pageTitle);\n      }\n\n      this.main_scroll.seekTo(page_id, speed); // scroll to it\n\n      this.pagePartsHandler.initializeNavbars(page_id);\n      if (cv.Config.mobileDevice) {\n        switch (this.pagePartsHandler.navbars.left.dynamic) {\n          case null:\n          case true:\n            this.pagePartsHandler.fadeNavbar('Left', 'out', 0);\n            break;\n\n          case false:\n            this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n        }\n      } else {\n        this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n      }\n    },\n\n    selectDesign: function () {\n      var body = document.querySelector(\"body\");\n\n      document.querySelectorAll('body > *').forEach(function(elem) {\n        elem.style.display = 'none';\n      }, this);\n      body.style['background-color'] = \"black\";\n\n\n      var div = qx.dom.Element.create(\"div\", {id: \"designSelector\"});\n      Object.entries({\n        background: \"#808080\",\n        width: \"400px\",\n        color: \"white\",\n        margin: \"auto\",\n        padding: \"0.5em\"\n      }).forEach(function(key_value){body.style[key_value[0]]=key_value[1];});\n      div.innerHTML = \"Loading ...\";\n\n      body.appendChild(div);\n\n      var store = new qx.data.store.Json(qx.util.ResourceManager.getInstance().toUri(\"designs/get_designs.php\"));\n\n      store.addListener(\"loaded\", function () {\n        var html = \"<h1>Please select design</h1>\";\n        html += \"<p>The Location/URL will change after you have chosen your design. Please bookmark the new URL if you do not want to select the design every time.</p>\";\n\n        div.innerHTML = html;\n\n        store.getModel().forEach(function(element) {\n\n          var myDiv = qx.dom.Element.create(\"div\", {\n            cursor: \"pointer\",\n            padding: \"0.5em 1em\",\n            borderBottom: \"1px solid black\",\n            margin: \"auto\",\n            width: \"262px\",\n            position: \"relative\"\n          });\n\n          myDiv.innerHTML = \"<div style=\\\"font-weight: bold; margin: 1em 0 .5em;\\\">Design: \" + element + \"</div>\";\n          myDiv.innerHTML += \"<iframe src=\\\"\"+qx.util.ResourceManager.getInstance().toUri(\"designs/design_preview.html\")+\"?design=\" + element + \"\\\" width=\\\"160\\\" height=\\\"90\\\" border=\\\"0\\\" scrolling=\\\"auto\\\" frameborder=\\\"0\\\" style=\\\"z-index: 1;\\\"></iframe>\";\n          myDiv.innerHTML += \"<img width=\\\"60\\\" height=\\\"30\\\" src=\\\"\"+qx.util.ResourceManager.getInstance().toUri(\"demo/media/arrow.png\")+\"\\\" alt=\\\"select\\\" border=\\\"0\\\" style=\\\"margin: 60px 10px 10px 30px;\\\"/>\";\n\n          div.appendChild(myDiv);\n\n\n          var tDiv = qx.dom.Element.create(\"div\", {\n            background: \"transparent\",\n            position: \"absolute\",\n            height: \"90px\",\n            width: \"160px\",\n            zIndex: 2\n          });\n          var pos = document.querySelector(\"iframe\").getBoundingClientRect();\n          Object.entries({\n            left: pos.left + \"px\",\n            top: pos.top + \"px\"\n          }).forEach(function(key_value){tDiv.style[key_value[0]]=key_value[1];});\n          myDiv.appendChild(tDiv);\n\n          qx.event.Registration.addListener(myDiv, 'pointerover', function() {\n            myDiv.style.background = \"#bbbbbb\";\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'pointerout', function() {\n            myDiv.style.background = \"transparent\";\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'tap', function() {\n            var href = document.location.href;\n            if (document.location.hash) {\n              href = href.split('#')[0];\n            }\n            if (document.location.search === \"\") {\n              document.location.href = href + \"?design=\" + element;\n            } else {\n              document.location.href = href + \"&design=\" + element;\n            }\n          });\n        });\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('__activeChangedTimer');\n  }\n});"
  ]
}