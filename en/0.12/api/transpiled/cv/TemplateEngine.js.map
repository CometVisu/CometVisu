{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/TemplateEngine.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "pagePartsHandler",
    "cv",
    "ui",
    "PagePartsHandler",
    "lazyPlugins",
    "__partQueue",
    "data",
    "Array",
    "_domFinishedQueue",
    "addListener",
    "ev",
    "setPartsLoaded",
    "getData",
    "defaults",
    "widget",
    "plugin",
    "group",
    "command",
    "Group",
    "setCommands",
    "app",
    "Init",
    "getApplication",
    "manager",
    "getCommandManager",
    "add",
    "setActive",
    "statics",
    "getClient",
    "getInstance",
    "visu",
    "properties",
    "partsLoaded",
    "check",
    "init",
    "apply",
    "event",
    "scriptsLoaded",
    "ready",
    "currentPage",
    "nullable",
    "domFinished",
    "commands",
    "loggedIn",
    "highlightedWidget",
    "members",
    "bindClickToWidget",
    "main_scroll",
    "old_scroll",
    "pluginsToLoadCount",
    "xml",
    "__activeChangedTimer",
    "__hasBeenConnected",
    "loadParts",
    "parts",
    "isArray",
    "loadLazyParts",
    "filter",
    "part",
    "indexOf",
    "length",
    "p",
    "includes",
    "append",
    "io",
    "PartLoader",
    "require",
    "states",
    "forEach",
    "idx",
    "remove",
    "debug",
    "startsWith",
    "setStructureLoaded",
    "error",
    "_applyReady",
    "value",
    "setupPage",
    "_applyLoaded",
    "old",
    "name",
    "isPartsLoaded",
    "isScriptsLoaded",
    "setReady",
    "_applyDomFinished",
    "message",
    "Bus",
    "dispatchByName",
    "entry",
    "callback",
    "shift",
    "context",
    "executeWhenDomFinished",
    "isDomFinished",
    "push",
    "prototype",
    "slice",
    "call",
    "arguments",
    "addAddress",
    "address",
    "id",
    "warn",
    "Model",
    "getAddresses",
    "initBackendClient",
    "backendName",
    "Config",
    "configSettings",
    "backend",
    "backendUrl",
    "mapping",
    "oh",
    "oh2",
    "hasOwnProperty",
    "Application",
    "createClient",
    "model",
    "update",
    "bind",
    "reporting",
    "recordInstance",
    "report",
    "Record",
    "record",
    "d",
    "BACKEND",
    "showError",
    "_handleClientError",
    "user",
    "sentryEnabled",
    "window",
    "Sentry",
    "configureScope",
    "scope",
    "setTag",
    "webServer",
    "getServer",
    "configServer",
    "_updateClientScope",
    "_onActiveChanged",
    "_checkBackendConnection",
    "isActive",
    "isConnected",
    "restart",
    "Timer",
    "stop",
    "connected",
    "topic",
    "title",
    "locale",
    "Manager",
    "tr",
    "severity",
    "unique",
    "deletable",
    "condition",
    "lastError",
    "getLastError",
    "Date",
    "now",
    "time",
    "url",
    "code",
    "text",
    "notifications",
    "Router",
    "dispatchMessage",
    "errorCode",
    "varargs",
    "JSON",
    "stringify",
    "div",
    "document",
    "createElement",
    "innerText",
    "innerHTML",
    "notification",
    "Client",
    "ERROR_CODES",
    "PROTOCOL_MISSING_VERSION",
    "PROTOCOL_INVALID_READ_RESPONSE_MISSING_I",
    "resetPageValues",
    "resetCurrentPage",
    "layout",
    "currentPageUnavailableWidth",
    "currentPageUnavailableHeight",
    "currentPageNavbarVisibility",
    "parseXML",
    "loaded_xml",
    "done",
    "settings",
    "pagesNode",
    "querySelector",
    "predefinedDesign",
    "getAttribute",
    "clientDesign",
    "selectDesign",
    "getStructure",
    "credentials",
    "token",
    "username",
    "password",
    "scrollSpeed",
    "parseInt",
    "defaultColumns",
    "minColumnWidth",
    "screensave_time",
    "screensave_page",
    "maxMobileScreenWidth",
    "globalClass",
    "classList",
    "scriptsToLoad",
    "stylesToLoad",
    "design",
    "getDesign",
    "baseUri",
    "mobileDevice",
    "util",
    "ScriptLoader",
    "addListenerOnce",
    "alternativeStyles",
    "addStyles",
    "addScripts",
    "metaParser",
    "parser",
    "MetaParser",
    "pluginsToLoad",
    "parsePlugins",
    "parse",
    "login",
    "setLoggedIn",
    "querySelectorAll",
    "elem",
    "cacheUsed",
    "page",
    "createPages",
    "setDomFinished",
    "structure",
    "WidgetFactory",
    "getInstanceById",
    "initialPage",
    "setCurrentPage",
    "adjustColumns",
    "applyColumnWidths",
    "PageHandler",
    "undefined",
    "setSpeed",
    "DeferredCall",
    "scrollToPage",
    "schedule",
    "onload",
    "TrickOMatic",
    "run",
    "startInitialRequest",
    "IconTools",
    "fillRecoloredIcon",
    "startScreensaver",
    "screensave",
    "start",
    "Registration",
    "enableAddressQueue",
    "startPageAddresses",
    "pageWidget",
    "getChildWidgets",
    "child",
    "getAddress",
    "addr",
    "setInitialAddresses",
    "keys",
    "addressesToSubscribe",
    "subscribe",
    "path",
    "flavour",
    "WidgetParser",
    "renderTemplates",
    "parsedData",
    "i",
    "l",
    "createInstance",
    "$$type",
    "getDomString",
    "getPageIdByPath",
    "page_name",
    "match",
    "traversePath",
    "getPageIdByName",
    "root_page_id",
    "path_scope",
    "index",
    "substr",
    "next",
    "path_page_name",
    "page_id",
    "String",
    "decodeHtmlEntities",
    "decodeURI",
    "replace",
    "selector",
    "pages",
    "from",
    "h",
    "textContent",
    "getCurrentPage",
    "currentPageId",
    "getPath",
    "fallback",
    "some",
    "Tree",
    "getClosest",
    "pid",
    "target",
    "speed",
    "skipHistory",
    "treePath",
    "rememberLastPage",
    "Environment",
    "get",
    "localStorage",
    "lastpage",
    "headline",
    "pageTitle",
    "bom",
    "History",
    "addToHistory",
    "seekTo",
    "initializeNavbars",
    "navbars",
    "left",
    "dynamic",
    "fadeNavbar",
    "_applyHighlightedWidget",
    "oldElement",
    "getElementById",
    "element",
    "body",
    "style",
    "display",
    "dom",
    "Element",
    "create",
    "entries",
    "background",
    "width",
    "color",
    "margin",
    "padding",
    "key_value",
    "appendChild",
    "store",
    "Json",
    "ResourceManager",
    "toUri",
    "html",
    "getModel",
    "myDiv",
    "cursor",
    "borderBottom",
    "position",
    "tDiv",
    "height",
    "zIndex",
    "pos",
    "getBoundingClientRect",
    "top",
    "href",
    "location",
    "hash",
    "split",
    "search",
    "destruct",
    "_disposeObjects",
    "TemplateEngine"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* TemplateEngine.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.TemplateEngine', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  construct: function() {\n    // this.base(arguments);\n    this.pagePartsHandler = new cv.ui.PagePartsHandler();\n    this.lazyPlugins = ['plugin-openhab'];\n\n    this.__partQueue = new qx.data.Array();\n    this._domFinishedQueue = [];\n    this.__partQueue.addListener('changeLength', function(ev) {\n      this.setPartsLoaded(ev.getData() === 0);\n    }, this);\n\n    this.defaults = {widget: {}, plugin: {}};\n    const group = new qx.ui.command.Group();\n    this.setCommands(group);\n    const app = qx.core.Init.getApplication();\n    if (app) {\n      // application is not available in tests\n      const manager = app.getCommandManager();\n      manager.add(group);\n      manager.setActive(group);\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Shortcut access to client\n     */\n    getClient: function () {\n      return this.getInstance().visu;\n    }\n  },\n\n  properties: {\n\n    /**\n     * Shows the loading state of the parts\n     */\n    partsLoaded: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyLoaded',\n      event: 'changePartsLoaded'\n    },\n\n    /**\n     * Shows the loading state of the scripts\n     */\n    scriptsLoaded: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyLoaded'\n    },\n\n    /**\n     * Shows the initialization state of the TemplateEngine. It gets until when all\n     * external stuff (pars, scripts, etc.) has been loaded.\n     */\n    ready: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReady',\n      apply: '_applyReady'\n    },\n\n    currentPage: {\n      check: 'cv.ui.structure.IPage',\n      nullable: true,\n      event: 'changeCurrentPage'\n    },\n\n    domFinished: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDomFinished',\n      event: 'changeDomFinished'\n    },\n\n    commands: {\n      check: 'qx.ui.command.Group',\n      nullable: true\n    },\n    \n    // sent after the client is logged in to the backend\n    loggedIn: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeLoggedIn'\n    },\n\n    // highlight a widget\n    highlightedWidget: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyHighlightedWidget'\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    pagePartsHandler: null,\n    // if true the whole widget reacts on click events\n    // if false only the actor in the widget reacts on click events\n    bindClickToWidget : false,\n    /**\n     * Structure where a design can set a default value that a widget or plugin\n     * can use.\n     * This is especially important for design relevant information like colors\n     * that can not be set though CSS.\n     *\n     * Usage: this.defaults.plugin.foo = {bar: 'baz'};\n     */\n    defaults : null,\n\n    main_scroll : null,\n    old_scroll : '',\n    visu : null,\n\n    pluginsToLoadCount : 0,\n    xml : null,\n\n    __partQueue: null,\n    _domFinishedQueue: null,\n\n    // plugins that do not need to be loaded to proceed with the initial setup\n    lazyPlugins: null,\n    __activeChangedTimer: null,\n    __hasBeenConnected: false,\n\n    /**\n     * Load parts (e.g. plugins, structure)\n     *\n     * @param parts {String[]|String} parts to load\n     */\n    loadParts: function(parts) {\n      if (!Array.isArray(parts)) {\n        parts = [parts];\n      }\n      const loadLazyParts = this.lazyPlugins.filter(function (part) {\n        return parts.indexOf(part) >= 0;\n      });\n      if (loadLazyParts.length) {\n        parts = parts.filter(function(p) {\n return !loadLazyParts.includes(p); \n});\n      }\n      this.__partQueue.append(parts);\n      qx.io.PartLoader.require(parts, function(states) {\n        parts.forEach(function(part, idx) {\n          if (states[idx] === 'complete') {\n            this.__partQueue.remove(part);\n            this.debug('successfully loaded part '+part);\n            if (part.startsWith('structure-')) {\n              qx.core.Init.getApplication().setStructureLoaded(true);\n            }\n          } else {\n            this.error('error loading part '+part);\n          }\n        }, this);\n      }, this);\n\n      // load the lazy plugins no one needs to wait for\n      qx.io.PartLoader.require(loadLazyParts, function(states) {\n        loadLazyParts.forEach(function(part, idx) {\n          if (states[idx] === 'complete') {\n            this.debug('successfully loaded part '+part);\n          } else {\n            this.error('error loading part '+part);\n          }\n        }, this);\n      }, this);\n    },\n\n    // property apply\n    _applyReady: function(value) {\n      if (value === true) {\n        this.setupPage();\n      }\n    },\n\n    // property apply\n    _applyLoaded: function(value, old, name) {\n      this.debug(name+' is '+value+' now');\n      if (this.isPartsLoaded() && this.isScriptsLoaded()) {\n        this.setReady(true);\n      }\n    },\n\n    // property apply\n    _applyDomFinished: function(value) {\n      if (value) {\n        qx.event.message.Bus.dispatchByName('setup.dom.finished');\n        // flush the queue\n        this._domFinishedQueue.forEach(function(entry) {\n          const callback = entry.shift();\n          const context = entry.shift();\n          callback.apply(context, entry);\n        }, this);\n        this._domFinishedQueue = [];\n      }\n    },\n\n    /**\n     * Adds a callback to a queue which is executed after DOM has been rendered\n     * @param callback {Function}\n     * @param context {Object}\n     */\n    executeWhenDomFinished: function(callback, context) {\n      if (!this.isDomFinished()) {\n        // queue callback\n        this._domFinishedQueue.push(Array.prototype.slice.call(arguments));\n      } else {\n        callback.apply(context, Array.prototype.slice.call(arguments, 2));\n      }\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().addAddress()} instead\n     * @param address\n     * @param id\n     * @deprecated since version 0.11.0 Please use {cv.data.Model.getInstance().addAddress()} instead\n     */\n    addAddress: function (address, id) {\n      this.warn('addAddress is deprecated! Please use cv.data.Model.getInstance().addAddress() instead');\n      cv.data.Model.getInstance().addAddress(address, id);\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().getAddresses()} instead\n     * @deprecated since version 0.11.0 Please use {cv.data.Model.getInstance().getAddresses()} instead\n     */\n    getAddresses: function () {\n      this.warn('getAddresses is deprecated! Please use cv.data.Model.getInstance().getAddresses() instead');\n      return cv.data.Model.getInstance().getAddresses();\n    },\n\n    /**\n     * Initialize the {@link cv.io.Client} for backend communication\n     */\n    initBackendClient: function () {\n      let backendName = cv.Config.configSettings.backend || cv.Config.backend;\n      let backendUrl = cv.Config.configSettings.backendUrl || cv.Config.backendUrl;\n      const mapping = {\n        oh: 'openhab',\n        oh2: 'openhab2'\n      };\n      if (Object.prototype.hasOwnProperty.call(mapping, backendName)) {\n        backendName = mapping[backendName];\n      }\n      this.visu = cv.Application.createClient(backendName, backendUrl);\n\n      const model = cv.data.Model.getInstance();\n      this.visu.update = model.update.bind(model); // override clients update function\n      if (cv.Config.reporting) {\n        const recordInstance = cv.report.Record.getInstance();\n        this.visu.record = function(p, d) {\n         recordInstance.record(cv.report.Record.BACKEND, p, d);\n        };\n      }\n      this.visu.showError = this._handleClientError.bind(this);\n      this.visu.user = 'demo_user'; // example for setting a user\n      const visu = this.visu;\n\n      if (cv.Config.sentryEnabled && window.Sentry) {\n        Sentry.configureScope(function (scope) {\n          scope.setTag('backend', visu.backendName);\n          const webServer = visu.getServer();\n          if (webServer) {\n            scope.setTag('server.backend', webServer);\n          }\n          if (cv.Config.configServer) {\n            scope.setTag('server.web', cv.Config.configServer);\n          }\n        });\n        visu.addListener('changedServer', this._updateClientScope, this);\n      }\n      const app = qx.core.Init.getApplication();\n      app.addListener('changeActive', this._onActiveChanged, this);\n\n      // show connection state in NotificationCenter\n      this.visu.addListener('changeConnected', this._checkBackendConnection, this);\n    },\n\n    _onActiveChanged: function () {\n      const app = qx.core.Init.getApplication();\n      if (app.isActive()) {\n        if (!this.visu.isConnected() && this.__hasBeenConnected) {\n          // reconnect\n          this.visu.restart(true);\n        }\n        // wait for 3 seconds before checking the backend connection\n        if (!this.__activeChangedTimer) {\n          this.__activeChangedTimer = new qx.event.Timer(3000);\n          this.__activeChangedTimer.addListener('interval', function () {\n            if (app.isActive()) {\n              this._checkBackendConnection();\n            }\n            this.__activeChangedTimer.stop();\n          }, this);\n        }\n        this.__activeChangedTimer.restart();\n      } else {\n        this._checkBackendConnection();\n      }\n    },\n\n    _checkBackendConnection: function () {\n      const connected = this.visu.isConnected();\n      const message = {\n        topic: 'cv.client.connection',\n        title: qx.locale.Manager.tr('Connection error'),\n        severity: 'urgent',\n        unique: true,\n        deletable: false,\n        condition: !connected && this.__hasBeenConnected && qx.core.Init.getApplication().isActive()\n      };\n      const lastError = this.visu.getLastError();\n      if (!connected) {\n        if (lastError && (Date.now() - lastError.time) < 100) {\n          message.message = qx.locale.Manager.tr('Error requesting %1: %2 - %3.', lastError.url, lastError.code, lastError.text);\n        } else {\n          message.message = qx.locale.Manager.tr('Connection to backend is lost.');\n        }\n      } else {\n        this.__hasBeenConnected = true;\n      }\n      cv.core.notifications.Router.dispatchMessage(message.topic, message);\n    },\n\n    _updateClientScope: function () {\n      const visu = this.visu;\n      Sentry.configureScope(function (scope) {\n        const webServer = visu.getServer();\n        if (webServer) {\n          scope.setTag('server.backend', webServer);\n        }\n      });\n    },\n\n    _handleClientError: function (errorCode, varargs) {\n      varargs = Array.prototype.slice.call(arguments, 1);\n      varargs = JSON.stringify(varargs[0], null, 2);\n      // escape HTML:\n      let div = document.createElement('div');\n      div.innerText = varargs;\n      varargs = div.innerHTML;\n      let notification;\n      switch (errorCode) {\n        case cv.io.Client.ERROR_CODES.PROTOCOL_MISSING_VERSION:\n          notification = {\n            topic: 'cv.error',\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to the %1Login%2 request: missing protocol version.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n            '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + varargs + '</pre></div>',\n            severity: 'urgent',\n            unique: true,\n            deletable: false\n          };\n          break;\n\n        case cv.io.Client.ERROR_CODES.PROTOCOL_INVALID_READ_RESPONSE_MISSING_I:\n          notification = {\n            topic: 'cv.error',\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to a %1read%2 request: Missing \"i\" value.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n              '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + varargs +'</pre></div>',\n            severity: 'urgent',\n            unique: true,\n            deletable: false\n          };\n          break;\n      }\n      if (notification) {\n        cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n      }\n    },\n\n    /**\n     * Reset some values related to the current page\n     */\n    resetPageValues: function () {\n      this.resetCurrentPage();\n      cv.ui.layout.Manager.currentPageUnavailableWidth = -1;\n      cv.ui.layout.Manager.currentPageUnavailableHeight = -1;\n      cv.ui.layout.Manager.currentPageNavbarVisibility = null;\n    },\n\n    /**\n     * Read basic settings and meta-section from config document\n     * @param loaded_xml {Document} XML-configuration document\n     * @param done {Function} callback that is called when the parsing has finished\n     */\n    parseXML: function (loaded_xml, done) {\n      /*\n       * First, we try to get a design by url. Secondly, we try to get a predefined\n       */\n      // read predefined design in config\n      const settings = cv.Config.configSettings;\n      const pagesNode = loaded_xml.querySelector('pages');\n\n      const predefinedDesign = pagesNode.getAttribute('design');\n      // design by url\n      // design by config file\n      if (!cv.Config.clientDesign && !settings.clientDesign) {\n        if (predefinedDesign) {\n          settings.clientDesign = predefinedDesign;\n        } else {\n          // selection dialog\n          this.selectDesign();\n        }\n      }\n\n      // load structure-part\n      this.loadParts([cv.Config.getStructure()]);\n\n      if (pagesNode.getAttribute('backend') !== null) {\n        settings.backend = pagesNode.getAttribute('backend');\n      }\n      if (pagesNode.getAttribute('backend-url') !== null) {\n        settings.backendUrl = pagesNode.getAttribute('backend-url');\n      }\n\n      if (pagesNode.getAttribute('token') !== null) {\n        settings.credentials.token = pagesNode.getAttribute('token');\n      }\n      if (pagesNode.getAttribute('username') !== null) {\n        settings.credentials.username = pagesNode.getAttribute('username');\n      }\n      if (pagesNode.getAttribute('password') !== null) {\n        settings.credentials.password = pagesNode.getAttribute('password');\n      }\n      this.initBackendClient();\n\n      if (pagesNode.getAttribute('scroll_speed') === null) {\n        settings.scrollSpeed = 400;\n      } else {\n        settings.scrollSpeed = parseInt(pagesNode.getAttribute('scroll_speed'));\n      }\n\n      if (pagesNode.getAttribute('bind_click_to_widget') !== null) {\n        settings.bindClickToWidget = pagesNode.getAttribute('bind_click_to_widget') === 'true';\n      }\n      if (pagesNode.getAttribute('default_columns') !== null) {\n        settings.defaultColumns = pagesNode.getAttribute('default_columns');\n      }\n      if (pagesNode.getAttribute('min_column_width') !== null) {\n        settings.minColumnWidth = pagesNode.getAttribute('min_column_width');\n      }\n      settings.screensave_time = pagesNode.getAttribute('screensave_time');\n      if (settings.screensave_time) {\n        settings.screensave_time = parseInt(settings.screensave_time, 10);\n      }\n      settings.screensave_page = pagesNode.getAttribute('screensave_page');\n\n      if (pagesNode.getAttribute('max_mobile_screen_width') !== null) {\n        settings.maxMobileScreenWidth = pagesNode.getAttribute('max_mobile_screen_width');\n      }\n\n      const globalClass = pagesNode.getAttribute('class');\n      if (globalClass !== null) {\n        document.querySelector('body').classList.add(globalClass);\n      }\n\n      settings.scriptsToLoad = [];\n      settings.stylesToLoad = [];\n      const design = cv.Config.getDesign();\n      if (design) {\n        let baseUri = 'designs/' + design;\n        settings.stylesToLoad.push(baseUri + '/basic.css');\n        this.debug('cv.Config.mobileDevice: ' + cv.Config.mobileDevice);\n        if (cv.Config.mobileDevice) {\n          settings.stylesToLoad.push(baseUri + '/mobile.css');\n          document.querySelector('body').classList.add('mobile');\n        }\n        settings.stylesToLoad.push(baseUri + '/custom.css');\n        settings.scriptsToLoad.push('designs/' + design + '/design_setup.js');\n\n        cv.util.ScriptLoader.getInstance().addListenerOnce('designError', function(ev) {\n          if (ev.getData() === design) {\n            this.error('Failed to load \"'+design+'\" design! Falling back to simplified \"pure\"');\n\n            baseUri = 'designs/pure';\n            const alternativeStyles = [baseUri + '/basic.css'];\n            if (cv.Config.mobileDevice) {\n              alternativeStyles.push(baseUri+'/mobile.css');\n            }\n            alternativeStyles.push(baseUri+'/custom.css');\n            cv.util.ScriptLoader.getInstance().addStyles(alternativeStyles);\n            cv.util.ScriptLoader.getInstance().addScripts(baseUri+'/design_setup.js');\n          }\n        }, this);\n      }\n      const metaParser = new cv.parser.MetaParser();\n\n      // start with the plugins\n      settings.pluginsToLoad = metaParser.parsePlugins(loaded_xml);\n      // and then the rest\n      metaParser.parse(loaded_xml, done);\n      this.debug('parsed');\n    },\n\n    /**\n     * Main setup to get everything running and show the initial page.\n     */\n    setupPage: function () {\n      // and now setup the pages\n      this.debug('setup');\n\n      // login to backend as it might change some settings needed for further processing\n      this.visu.login(true, cv.Config.configSettings.credentials, function () {\n        this.debug('logged in');\n        this.setLoggedIn(true);\n\n        // as we are sure that the default CSS were loaded now:\n        document.querySelectorAll('link[href*=\"mobile.css\"]').forEach(function (elem) {\n        });\n        if (!cv.Config.cacheUsed) {\n          this.debug('creating pages');\n          const page = this.xml.querySelector('pages > page'); // only one page element allowed...\n\n          this.createPages(page, 'id');\n          this.debug('finalizing');\n          qx.event.message.Bus.dispatchByName('setup.dom.append');\n          this.debug('pages created');\n        }\n        this.debug('setup.dom.finished');\n        qx.event.message.Bus.dispatchByName('setup.dom.finished.before');\n        this.setDomFinished(true);\n\n        const currentPage = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        if (currentPage) {\n          this.setCurrentPage(currentPage);\n        }\n        cv.ui.layout.Manager.adjustColumns();\n        cv.ui.layout.Manager.applyColumnWidths('#'+cv.Config.initialPage, true);\n\n        this.main_scroll = new cv.ui.PageHandler();\n        if (this.scrollSpeed !== undefined) {\n          this.main_scroll.setSpeed(this.scrollSpeed);\n        }\n\n        new qx.util.DeferredCall(function() {\n          this.scrollToPage(cv.Config.initialPage, 0);\n        }, this).schedule();\n\n        // run the Trick-O-Matic scripts for great SVG backdrops\n        document.querySelectorAll('embed').forEach(function(elem) {\n          elem.onload = cv.ui.TrickOMatic.run;\n        });\n\n        this.startInitialRequest();\n\n        this.xml = null; // not needed anymore - free the space\n\n        document.querySelectorAll('.icon').forEach(cv.util.IconTools.fillRecoloredIcon, cv.util.IconTools);\n        document.querySelectorAll('.loading').forEach(function(elem) {\n          elem.classList.remove('loading');\n        }, this);\n\n        this.startScreensaver();\n        if (qx.core.Environment.get('qx.aspects')) {\n          qx.dev.Profile.stop();\n          qx.dev.Profile.showResults(50);\n        }\n      }, this);\n    },\n\n    /**\n     * Start the screensaver if a screensave time is set\n     */\n    startScreensaver: function() {\n      if (typeof cv.Config.configSettings.screensave_time === 'number') {\n        this.screensave = new qx.event.Timer(cv.Config.configSettings.screensave_time * 1000);\n        this.screensave.addListener('interval', function () {\n          this.scrollToPage();\n        }, this);\n        this.screensave.start();\n        qx.event.Registration.addListener(window, 'useraction', this.screensave.restart, this.screensave);\n      }\n    },\n\n    /**\n     * Start retrieving data from backend\n     */\n    startInitialRequest: function() {\n      if (qx.core.Environment.get('qx.debug')) {\n        cv.report.Replay.start();\n      }\n      if (cv.Config.enableAddressQueue) {\n        // identify addresses on startpage\n        const startPageAddresses = {};\n        const pageWidget = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        pageWidget.getChildWidgets().forEach(function(child) {\n          const address = child.getAddress ? child.getAddress() : {};\n          for (let addr in address) {\n            if (Object.prototype.hasOwnProperty.call(address, addr)) {\n              startPageAddresses[addr] = 1;\n            }\n          }\n        }, this);\n        this.visu.setInitialAddresses(Object.keys(startPageAddresses));\n      }\n      const addressesToSubscribe = cv.data.Model.getInstance().getAddresses();\n      if (addressesToSubscribe.length !== 0) {\n        this.visu.subscribe(addressesToSubscribe);\n      }\n    },\n\n    /**\n     * Start the parsing process\n     * @param page {Element} XML-configuration element\n     * @param path {String} internal poth\n     * @param flavour {String} inherited flavour\n     * @param type {String} page type (text, 2d, 3d)\n     */\n    createPages: function (page, path, flavour, type) {\n      cv.parser.WidgetParser.renderTemplates(page);\n      let parsedData = cv.parser.WidgetParser.parse(page, path, flavour, type);\n      if (!Array.isArray(parsedData)) {\n        parsedData = [parsedData];\n      }\n      let i = 0;\n      const l = parsedData.length;\n      for (; i < l; i++) {\n        const data = parsedData[i];\n        const widget = cv.ui.structure.WidgetFactory.createInstance(data.$$type, data);\n\n        // trigger DOM generation\n        if (widget) {\n widget.getDomString(); \n}\n      }\n    },\n\n    /**\n     * Returns the id of the page the given path is associated to\n     * @param page_name {String}\n     * @param path {String}\n     * @return {String}\n     */\n    getPageIdByPath: function (page_name, path) {\n      if (page_name === null) {\n return null; \n}\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } \n        if (path !== undefined) {\n          const scope = this.traversePath(path);\n          if (scope === null) {\n            // path is wrong\n            this.error('path \\'' + path + '\\' could not be traversed, no page found');\n            return null;\n          }\n          return this.getPageIdByName(page_name, scope);\n        } \n          return this.getPageIdByName(page_name);\n    },\n\n    traversePath: function (path, root_page_id) {\n      let path_scope = null;\n      let index = path.indexOf('/');\n      if (index >= 1) {\n        // skip escaped slashes like \\/\n        while (path.substr(index - 1, 1) === '\\\\') {\n          const next = path.indexOf('/', index + 1);\n          if (next >= 0) {\n            index = next;\n          }\n        }\n      }\n      //    console.log(\"traversePath(\"+path+\",\"+root_page_id+\")\");\n      if (index >= 0) {\n        // traverse path one level down\n        const path_page_name = path.substr(0, index);\n        path_scope = this.getPageIdByName(path_page_name, root_page_id);\n        path = path.substr(path_page_name.length + 1);\n        path_scope = this.traversePath(path, path_scope);\n        //      console.log(path_page_name+\"=>\"+path_scope);\n        return path_scope;\n      } \n        // bottom path level reached\n        path_scope = this.getPageIdByName(path, root_page_id);\n        return path_scope;\n    },\n\n    getPageIdByName: function (page_name, scope) {\n      let page_id = null;\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } \n        // find Page-ID by name\n        // decode html code (e.g. like &apos; => ')\n        page_name = cv.util.String.decodeHtmlEntities(page_name);\n        // remove escaped slashes\n        page_name = decodeURI(page_name.replace('\\\\\\/', '/'));\n\n        //      console.log(\"Page: \"+page_name+\", Scope: \"+scope);\n      const selector = (scope !== undefined && scope !== null) ? '.page[id^=\"' + scope + '\"] h1' : '.page h1';\n      let pages = document.querySelectorAll(selector);\n      pages = Array.from(pages).filter(function(h) {\n return h.textContent === page_name; \n});\n        if (pages.length > 1 && this.getCurrentPage() !== null) {\n          const currentPageId = this.getCurrentPage().getPath();\n          // More than one Page found -> search in the current pages descendants first\n          let fallback = true;\n          pages.some(function (page) {\n            const p = cv.util.Tree.getClosest(page, '.page');\n            if (page.innerText === page_name) {\n              const pid = p.getAttribute('id');\n              if (pid.length < currentPageId.length) {\n                // found pages path is shorter the the current pages -> must be an ancestor\n                if (currentPageId.indexOf(pid) === 0) {\n                  // found page is an ancestor of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return true;\n                }\n              } else if (pid.indexOf(currentPageId) === 0) {\n                  // found page is an descendant of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return true;\n                }\n            }\n            return false;\n          }, this);\n          if (fallback) {\n            // take the first page that fits (old behaviour)\n            pages.some(function (page) {\n              if (page.innerText === page_name) {\n                page_id = cv.util.Tree.getClosest(page, '.page').getAttribute('id');\n                // break loop\n                return true;\n              }\n              return false;\n            });\n          }\n        } else {\n          pages.some(function (page) {\n            if (page.innerText === page_name) {\n              page_id = cv.util.Tree.getClosest(page, '.page').getAttribute('id');\n              // break loop\n              return true;\n            }\n            return false;\n          });\n        }\n      \n      if (page_id !== null && page_id.match(/^id_[0-9_]*$/) !== null) {\n        return page_id;\n      } \n        // not found\n        return null;\n    },\n\n    scrollToPage: function (target, speed, skipHistory) {\n      if (undefined === target) {\n        target = cv.Config.configSettings.screensave_page;\n      }\n      const page_id = this.getPageIdByPath(target);\n      if (page_id === null) {\n        return;\n      }\n      if (cv.Config.currentPageId === page_id) {\n        return;\n      }\n      cv.Config.currentPageId = page_id;\n      cv.Config.treePath = page_id;\n\n      if (undefined === speed) {\n        speed = cv.Config.configSettings.scrollSpeed;\n      }\n\n      if (cv.Config.rememberLastPage && qx.core.Environment.get('html.storage.local')) {\n        localStorage.lastpage = page_id;\n      }\n\n      // push new state to history\n      if (skipHistory === undefined) {\n        const headline = document.querySelectorAll('#' + page_id + ' h1');\n        let pageTitle = 'CometVisu';\n        if (headline.length) {\n          pageTitle = headline[0].textContent+ ' - '+pageTitle;\n        }\n        qx.bom.History.getInstance().addToHistory(page_id, pageTitle);\n      }\n\n      this.main_scroll.seekTo(page_id, speed); // scroll to it\n\n      this.pagePartsHandler.initializeNavbars(page_id);\n      if (cv.Config.mobileDevice) {\n        switch (this.pagePartsHandler.navbars.left.dynamic) {\n          case null:\n          case true:\n            this.pagePartsHandler.fadeNavbar('Left', 'out', 0);\n            break;\n\n          case false:\n            this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n        }\n      } else {\n        this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n      }\n    },\n\n    _applyHighlightedWidget: function (value, old) {\n      if (old) {\n        const oldElement = document.getElementById(old);\n        if (oldElement) {\n          oldElement.classList.remove('highlightedWidget');\n        }\n      }\n      if (value) {\n        const element = document.getElementById(value);\n        if (element) {\n          element.classList.add('highlightedWidget');\n        }\n      }\n    },\n\n    selectDesign: function () {\n      const body = document.querySelector('body');\n\n      document.querySelectorAll('body > *').forEach(function(elem) {\n        elem.style.display = 'none';\n      }, this);\n      body.style['background-color'] = 'black';\n\n\n      const div = qx.dom.Element.create('div', {id: 'designSelector'});\n      Object.entries({\n        background: '#808080',\n        width: '400px',\n        color: 'white',\n        margin: 'auto',\n        padding: '0.5em'\n      }).forEach(function(key_value) {\n body.style[key_value[0]]=key_value[1]; \n});\n      div.innerHTML = 'Loading ...';\n\n      body.appendChild(div);\n\n      const store = new qx.data.store.Json(qx.util.ResourceManager.getInstance().toUri('designs/get_designs.php'));\n\n      store.addListener('loaded', function () {\n        let html = '<h1>Please select design</h1>';\n        html += '<p>The Location/URL will change after you have chosen your design. Please bookmark the new URL if you do not want to select the design every time.</p>';\n\n        div.innerHTML = html;\n\n        store.getModel().forEach(function(element) {\n          const myDiv = qx.dom.Element.create('div', {\n            cursor: 'pointer',\n            padding: '0.5em 1em',\n            borderBottom: '1px solid black',\n            margin: 'auto',\n            width: '262px',\n            position: 'relative'\n          });\n\n          myDiv.innerHTML = '<div style=\"font-weight: bold; margin: 1em 0 .5em;\">Design: ' + element + '</div>';\n          myDiv.innerHTML += '<iframe src=\"'+qx.util.ResourceManager.getInstance().toUri('designs/design_preview.html')+'?design=' + element + '\" width=\"160\" height=\"90\" border=\"0\" scrolling=\"auto\" frameborder=\"0\" style=\"z-index: 1;\"></iframe>';\n          myDiv.innerHTML += '<img width=\"60\" height=\"30\" src=\"'+qx.util.ResourceManager.getInstance().toUri('demo/media/arrow.png')+'\" alt=\"select\" border=\"0\" style=\"margin: 60px 10px 10px 30px;\"/>';\n\n          div.appendChild(myDiv);\n\n\n          const tDiv = qx.dom.Element.create('div', {\n            background: 'transparent',\n            position: 'absolute',\n            height: '90px',\n            width: '160px',\n            zIndex: 2\n          });\n          const pos = document.querySelector('iframe').getBoundingClientRect();\n          Object.entries({\n            left: pos.left + 'px',\n            top: pos.top + 'px'\n          }).forEach(function(key_value) {\n tDiv.style[key_value[0]]=key_value[1]; \n});\n          myDiv.appendChild(tDiv);\n\n          qx.event.Registration.addListener(myDiv, 'pointerover', function() {\n            myDiv.style.background = '#bbbbbb';\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'pointerout', function() {\n            myDiv.style.background = 'transparent';\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'tap', function() {\n            let href = document.location.href;\n            if (document.location.hash) {\n              href = href.split('#')[0];\n            }\n            if (document.location.search === '') {\n              document.location.href = href + '?design=' + element;\n            } else {\n              document.location.href = href + '&design=' + element;\n            }\n          });\n        });\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('__activeChangedTimer');\n  }\n});\n"
  ]
}