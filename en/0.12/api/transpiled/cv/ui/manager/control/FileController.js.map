{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileController.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "__fsClient",
    "cv",
    "io",
    "rest",
    "Client",
    "getFsClient",
    "members",
    "rename",
    "file",
    "newName",
    "newPath",
    "getPath",
    "length",
    "endsWith",
    "isTemporary",
    "createSync",
    "path",
    "getType",
    "err",
    "ui",
    "manager",
    "snackbar",
    "Controller",
    "error",
    "info",
    "locale",
    "Manager",
    "tr",
    "getDisplayName",
    "resetTemporary",
    "resetModified",
    "setName",
    "reload",
    "getFullPath",
    "moveSync",
    "src",
    "target",
    "resetEditing",
    "move",
    "event",
    "message",
    "Bus",
    "dispatchByName",
    "action",
    "restore",
    "isInTrash",
    "replace",
    "__moveFile",
    "match",
    "exec",
    "targetFileName",
    "parentFolder",
    "getParent",
    "targetFile",
    "getChildren",
    "some",
    "child",
    "readSync",
    "res",
    "updateSync",
    "hash",
    "getName",
    "getBusTopic",
    "data",
    "source",
    "callback",
    "context",
    "apply",
    "isTrash",
    "qxl",
    "dialog",
    "Dialog",
    "confirm",
    "confirmed",
    "__doDelete",
    "deleteSync",
    "force",
    "download",
    "element",
    "document",
    "createElement",
    "setAttribute",
    "getBaseUrl",
    "style",
    "display",
    "body",
    "appendChild",
    "click",
    "removeChild",
    "validate",
    "isConfigFile",
    "__validateConfig",
    "d",
    "alert",
    "editor",
    "Worker",
    "getInstance",
    "validateConfig",
    "then",
    "close",
    "setValid",
    "handler",
    "handlerOptions",
    "jumpToError",
    "trn",
    "destruct",
    "control",
    "FileController"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * The FileController is responsible for all file operations, like config check, move, replace, delete etc.\n */\nqx.Class.define('cv.ui.manager.control.FileController', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__fsClient = cv.io.rest.Client.getFsClient();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __fsClient: null,\n\n    rename: function (file, newName) {\n      let newPath = file.getPath() || '';\n      if (newPath.length > 0 && !newPath.endsWith('/')) {\n        newPath += '/';\n      }\n      newPath += newName;\n      if (file.isTemporary()) {\n        // create new item\n        this.__fsClient.createSync({path: newPath, type: file.getType()}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been created', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been created', file.getDisplayName())\n            );\n            file.resetTemporary();\n            file.resetModified();\n            file.setName(newName);\n            file.reload();\n          }\n        }, this);\n      } else if (file.getFullPath() !== newPath) {\n        this.__fsClient.moveSync({src: file.getFullPath(), target: newPath}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been renamed', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been renamed', file.getDisplayName())\n            );\n            file.setName(newName);\n            file.resetModified();\n            file.reload();\n          }\n          file.resetEditing();\n        }, this);\n      }\n    },\n\n    /**\n     * Move file to another path\n     * @param file {cv.ui.manager.model.FileItem} file to move\n     * @param target {String} new path of the file\n     */\n    move: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been moved', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been moved', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'moved',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    /**\n     * Restore file from trash by moving it out of the trash to the old path\n     * @param file {cv.ui.manager.model.FileItem} file to restore\n     */\n    restore: function (file) {\n      if (file.isInTrash()) {\n        const target = file.getFullPath().replace('.trash/', '');\n        this.__moveFile(file, target);\n      } else if (file.getType() === 'file' && !file.isTemporary()) {\n        const match = /^\\/?backup\\/visu_config(.*)-[0-9]{14}\\.xml$/.exec(file.getFullPath());\n        if (match) {\n          // find the existing target config to restore\n          const targetFileName = 'visu_config' + match[1] + '.xml';\n\n          // find the target file\n          const parentFolder = file.getParent().getParent();\n          let targetFile = null;\n          parentFolder.getChildren().some(function(child) {\n            if (child.getFullPath() === targetFileName) {\n              targetFile = child;\n              return true;\n            }\n            return false;\n          });\n\n          // load the backup content\n          this.__fsClient.readSync({path: file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else if (targetFile) {\n                this.__fsClient.updateSync({\n                  path: targetFile.getFullPath(),\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                    targetFile.resetModified();\n                    targetFile.resetTemporary();\n                    qx.event.message.Bus.dispatchByName(targetFile.getBusTopic(), {\n                      type: 'fsContentChanged',\n                      data: res,\n                      source: this\n                    });\n                  }\n                }, this);\n              } else {\n                // target file does not exist copy to a new file\n                this.__fsClient.createSync({\n                  path: targetFileName,\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                  }\n                }, this);\n              }\n          }, this);\n        }\n      }\n    },\n\n    __moveFile: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been restored', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been restored', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'restored',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    'delete': function(file, callback, context) {\n      if (file.isTemporary()) {\n        // new file, no need to call the backend\n        if (callback) {\n          callback.apply(context, true);\n        }\n      } else if (file) {\n        let message;\n        if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Do you really want to clear the trash?');\n          } else if (file.isInTrash()) {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\" from the trash?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\" from the trash?', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\"?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\"?', file.getDisplayName());\n          }\n          qxl.dialog.Dialog.confirm(message, function (confirmed) {\n            if (confirmed) {\n              this.__doDelete(file, callback, context);\n            } else if (callback) {\n              callback.apply(context, false);\n            }\n          }, this, qx.locale.Manager.tr('Confirm deletion'));\n        }\n    },\n\n    __doDelete: function (file, callback, context) {\n      this.__fsClient.deleteSync({path: file.getFullPath(), force: file.isTrash()}, null, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n          if (callback) {\n            callback.apply(context, false);\n          }\n        } else {\n          let message;\n          if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Trash has been cleared');\n          } else if (file.isInTrash()) {\n            message = this.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been removed from trash', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been removed from trash', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been deleted', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been deleted', file.getDisplayName());\n          }\n          cv.ui.manager.snackbar.Controller.info(message);\n          if (callback) {\n            callback.apply(context, true);\n          }\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'deleted',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    download: function (file) {\n      if (file.getType() === 'file') {\n        const element = document.createElement('a');\n        element.setAttribute('href', cv.io.rest.Client.getBaseUrl() + '/fs?download=true&path=' + file.getFullPath());\n        element.style.display = 'none';\n        document.body.appendChild(element);\n        element.click();\n        document.body.removeChild(element);\n      }\n    },\n\n    validate: function (file) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertInstance(file, cv.ui.manager.model.FileItem);\n      }\n      if (file.isConfigFile()) {\n        this.__validateConfig(file);\n      } else {\n        this.info('no validation available for file: ' + file.getFullPath());\n      }\n    },\n\n    __validateConfig: function (file) {\n      const d = qxl.dialog.Dialog.alert(qx.locale.Manager.tr('Validating %1', file.getFullPath()));\n      cv.ui.manager.editor.Worker.getInstance().validateConfig(file).then(function (res) {\n        d.close();\n        if (res === true) {\n          file.setValid(true);\n          cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has no errors!', file.getFullPath()));\n        } else {\n          file.setValid(false);\n          qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n            file: file,\n            handler: 'cv.ui.manager.editor.Source',\n            handlerOptions: {\n              jumpToError: true\n            }\n          });\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.trn(\n            '%1 error found in %2!',\n            '%1 errors found in %2!',\n            res.length,\n            res.length,\n            file.getFullPath())\n          );\n        }\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__fsClient = null;\n  }\n});\n"
  ]
}