{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/ConfigElement.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "menu",
    "Menu",
    "construct",
    "editor",
    "setEditor",
    "_commandGroup",
    "core",
    "Init",
    "getApplication",
    "getCommandManager",
    "getActive",
    "_init",
    "events",
    "properties",
    "element",
    "check",
    "nullable",
    "apply",
    "members",
    "_applyEditor",
    "value",
    "old",
    "removeListener",
    "_maintainClipboardButtons",
    "addListener",
    "_applyElement",
    "removeRelatedBindings",
    "getChildControl",
    "editable",
    "isEditable",
    "setEnabled",
    "bind",
    "exclude",
    "show",
    "getShowEditButton",
    "addable",
    "getAddableChildren",
    "length",
    "forEach",
    "name",
    "add",
    "addSeparator",
    "content",
    "getEditor",
    "getClipboard",
    "getElement",
    "enabled",
    "cv",
    "manager",
    "model",
    "XmlElement",
    "includes",
    "getName",
    "isChildAllowedAtPosition",
    "Number",
    "POSITIVE_INFINITY",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "__createButton",
    "tr",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "action",
    "title",
    "icon",
    "command",
    "button",
    "Button",
    "fireDataEvent",
    "destruct",
    "contextmenu",
    "ConfigElement"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ConfigElement.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Contextmenu for an XML-Element in a CometVisu config file.\n */\nqx.Class.define('cv.ui.manager.contextmenu.ConfigElement', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (editor) {\n    this.base(arguments);\n    if (editor) {\n      this.setEditor(editor);\n    }\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'action': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      apply: '_applyElement'\n    },\n\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      apply: '_applyEditor'\n    }\n\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {qx.ui.command.GroupManager}\n     */\n    _commandGroup: null,\n\n    _applyEditor: function (value, old) {\n      if (old) {\n        old.removeListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n      if (value) {\n        value.addListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n    },\n\n    _applyElement: function(value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n        old.removeRelatedBindings(this.getChildControl('cut-button'));\n      }\n      if (value) {\n        const editable = value.isEditable();\n        this.getChildControl('copy-button').setEnabled(true);\n        if (editable) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n          value.bind('deletable', this.getChildControl('cut-button'), 'enabled');\n          this.getChildControl('view-button').exclude();\n          this.getChildControl('edit-button').show();\n          this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n          let addable = value.getAddableChildren(true);\n          this.getChildControl('create-button').setEnabled(addable.length > 0);\n        } else {\n          this.getChildControl('delete-button').setEnabled(false);\n          this.getChildControl('cut-button').setEnabled(false);\n          this.getChildControl('create-button').setEnabled(false);\n          this.getChildControl('view-button').show();\n          // enable view button when there are attributes to show\n          this.getChildControl('view-button').setEnabled(value.getShowEditButton());\n          this.getChildControl('edit-button').exclude();\n        }\n      } else {\n        ['edit', 'delete', 'cut', 'copy', 'paste', 'create'].forEach(name => this.getChildControl(name + '-button').setEnabled(false));\n      }\n      this._maintainClipboardButtons();\n    },\n\n    _init: function () {\n      ['view', 'edit', 'delete'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      ['cut', 'copy', 'paste'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      this.add(this.getChildControl('create-button'));\n    },\n\n    _maintainClipboardButtons: function () {\n      const content = this.getEditor().getClipboard();\n      const element = this.getElement();\n      let enabled = (element ? element.isEditable() : false) && content instanceof cv.ui.manager.model.XmlElement;\n      if (enabled) {\n        // check if content is allowed as child here\n        let addable = element.getAddableChildren(true);\n        enabled = addable.includes(content.getName()) && element.isChildAllowedAtPosition(content, Number.POSITIVE_INFINITY);\n      }\n      this.getChildControl('paste-button').setEnabled(enabled);\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n       let control;\n\n       switch (id) {\n         case 'view-button':\n           control = this.__createButton('view', this.tr('View'), cv.theme.dark.Images.getIcon('view', 18));\n           control.exclude();\n           break;\n\n         case 'edit-button':\n           control = this.__createButton('edit', this.tr('Edit'), cv.theme.dark.Images.getIcon('edit', 18));\n           break;\n\n         case 'delete-button':\n           control = this.__createButton('delete', this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n           break;\n\n         case 'cut-button':\n           control = this.__createButton('cut', this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18));\n           break;\n\n         case 'copy-button':\n           control = this.__createButton('copy', this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18));\n           break;\n\n         case 'paste-button':\n           control = this.__createButton('paste', this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18));\n           break;\n\n         case 'create-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'create-button':\n           control = this.__createButton('create', this.tr('Add child'), cv.theme.dark.Images.getIcon('add', 18));\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    __createButton: function (action, title, icon, command, menu) {\n      const button = new qx.ui.menu.Button(title, icon, command, menu);\n      button.addListener('execute', function () {\n        this.fireDataEvent('action', {\n          action: action,\n          element: this.getElement()\n        });\n      }, this);\n      return button;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n  }\n});\n"
  ]
}