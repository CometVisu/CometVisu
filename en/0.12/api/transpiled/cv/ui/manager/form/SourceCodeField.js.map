{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SourceCodeField.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "implement",
    "form",
    "IStringForm",
    "IForm",
    "include",
    "MForm",
    "construct",
    "value",
    "type",
    "_init",
    "setType",
    "setValue",
    "events",
    "properties",
    "check",
    "init",
    "apply",
    "focusable",
    "refine",
    "autoSize",
    "members",
    "_editor",
    "__delayedValue",
    "__areaHeight",
    "_hasBeenEdited",
    "_applyType",
    "_autoSize",
    "isAutoSize",
    "contentHeight",
    "getModel",
    "getLineCount",
    "_setAreaHeight",
    "getType",
    "resetValue",
    "getValue",
    "window",
    "monaco",
    "cv",
    "manager",
    "editor",
    "Source",
    "load",
    "domElement",
    "getContentElement",
    "getDomElement",
    "addListenerOnce",
    "create",
    "suggestOnTriggerCharacters",
    "folding",
    "autoIndent",
    "automaticLayout",
    "dragAndDrop",
    "formatOnPaste",
    "formatOnType",
    "renderValidationDecorations",
    "minimap",
    "enabled",
    "theme",
    "model",
    "uri",
    "Uri",
    "parse",
    "newModel",
    "createModel",
    "updateOptions",
    "tabSize",
    "indentSize",
    "insertSpaces",
    "setModel",
    "onDidChangeModelContent",
    "_onContentChange",
    "bind",
    "fireDataEvent",
    "getFocusElement",
    "el",
    "height",
    "queue",
    "Layout",
    "add",
    "Manager",
    "flush",
    "layout",
    "_getContentHint",
    "hint",
    "destruct",
    "dispose",
    "SourceCodeField"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* SourceCodeField.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.form.SourceCodeField', {\n  extend : qx.ui.core.Widget,\n  implement : [\n    qx.ui.form.IStringForm,\n    qx.ui.form.IForm\n  ],\n  include : [\n    qx.ui.form.MForm\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (value, type) {\n    this.base(arguments);\n    this._init();\n\n    if (type) {\n      this.setType(type);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /** Fired when the value was modified */\n    'changeValue' : 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: 'String',\n      init: 'xml',\n      apply: '_applyType'\n    },\n    // overridden\n    focusable: {\n      refine : true,\n      init : true\n    },\n    autoSize: {\n      check: 'Boolean',\n      init: false,\n      apply: '_autoSize'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _editor: null,\n    __delayedValue: null,\n    __areaHeight: null,\n    _hasBeenEdited: false,\n\n    _applyType: function (value) {\n      if (value && this.__delayedValue) {\n        this.setValue(this.__delayedValue);\n        this.__delayedValue = null;\n      }\n    },\n\n    _autoSize: function () {\n      if (this._editor && this.isAutoSize()) {\n        const contentHeight = (this._editor.getModel().getLineCount() + 1) * 19;\n        this._setAreaHeight(contentHeight);\n      }\n    },\n\n    /**\n     * Sets the element's value.\n     *\n     * @param value {String|null} The new value of the element.\n     */\n    setValue: function(value) {\n      if (!this._hasBeenEdited) {\n        if (this._editor && this.getType()) {\n          this._editor.setValue(value);\n        } else {\n          this.__delayedValue = value;\n        }\n      }\n      this._autoSize();\n    },\n\n\n    /**\n     * Resets the element's value to its initial value.\n     */\n    resetValue : function() {\n      if (this._editor) {\n        this._editor.setValue('');\n      }\n    },\n\n\n    /**\n     * The element's user set value.\n     *\n     * @return {String|null} The value.\n     */\n    getValue : function() {\n      if (this._editor) {\n        return this._editor.getValue();\n      } else if (this.__delayedValue) {\n        return this.__delayedValue;\n      } \n        return '';\n    },\n\n    _init: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._init, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', () => {\n            this._init();\n          }, this);\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: false\n            },\n            theme: 'vs-dark'\n          });\n          if (this.getType()) {\n            const model = this._editor.getModel();\n            const uri = monaco.Uri.parse('cv://SourceCode.' + this.getType());\n            let newModel = window.monaco.editor.getModel(uri);\n            if (!newModel) {\n              newModel = window.monaco.editor.createModel(this.__delayedValue, this.getType(), uri);\n            } else {\n              newModel.setValue(this.__delayedValue);\n            }\n            if (model !== newModel) {\n              newModel.updateOptions({\n                tabSize: 2,\n                indentSize: 2,\n                insertSpaces: true\n              });\n              this._editor.setModel(newModel);\n            }\n          }\n          if (this.__delayedValue) {\n            this.__delayedValue = null;\n          }\n          this._editor.onDidChangeModelContent(this._onContentChange.bind(this));\n        }\n      }\n    },\n\n    _onContentChange: function () {\n      this._hasBeenEdited = true;\n      this.fireDataEvent('changeValue', this._editor.getValue());\n      this._autoSize();\n    },\n\n    // overridden\n    getFocusElement : function() {\n      const el = this.getContentElement();\n      if (el) {\n        return el;\n      }\n      return null;\n    },\n\n    _setAreaHeight: function(height) {\n      if (this.__areaHeight !== height) {\n        this.__areaHeight = height;\n        qx.ui.core.queue.Layout.add(this);\n        qx.ui.core.queue.Manager.flush();\n        if (this._editor) {\n          this._editor.layout();\n        }\n      }\n    },\n\n    // overridden\n    _getContentHint: function() {\n      const hint = this.base(arguments);\n\n      if (this.isAutoSize()) {\n        hint.height = this.__areaHeight || hint.height;\n      }\n\n      return hint;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._hasBeenEdited = false;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n  }\n});\n"
  ]
}