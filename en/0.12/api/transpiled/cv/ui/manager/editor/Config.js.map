{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Config.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "editor",
    "AbstractEditor",
    "construct",
    "_handledActions",
    "_setLayout",
    "layout",
    "VBox",
    "_createChildControl",
    "statics",
    "TITLE",
    "locale",
    "Manager",
    "tr",
    "properties",
    "appearance",
    "refine",
    "init",
    "members",
    "_model",
    "_listController",
    "__initialSectionCount",
    "_initClient",
    "_client",
    "io",
    "rest",
    "Client",
    "getConfigClient",
    "addListener",
    "_onModelValueChange",
    "_onSaved",
    "_loadFile",
    "file",
    "get",
    "section",
    "key",
    "ev",
    "getFile",
    "setContent",
    "getData",
    "_applyContent",
    "value",
    "model",
    "getModel",
    "removeAll",
    "Object",
    "keys",
    "length",
    "forEach",
    "sectionName",
    "config",
    "Section",
    "optionKey",
    "addOption",
    "push",
    "__checkForModification",
    "getCurrentContent",
    "getContent",
    "_onDeleteSection",
    "remove",
    "setModified",
    "modified",
    "getChildControl",
    "getChildren",
    "some",
    "sectionListItem",
    "isModified",
    "save",
    "valid",
    "getName",
    "includes",
    "snackbar",
    "Controller",
    "error",
    "optionKeys",
    "getOptions",
    "option",
    "getKey",
    "data",
    "options",
    "getValue",
    "saveSync",
    "err",
    "status",
    "statusText",
    "info",
    "_createChildControlImpl",
    "id",
    "control",
    "form",
    "List",
    "setEnableInlineFind",
    "controller",
    "Array",
    "setDelegate",
    "createItem",
    "SectionListItem",
    "configureItem",
    "item",
    "bind",
    "bindItem",
    "index",
    "bindProperty",
    "_add",
    "flex",
    "container",
    "Composite",
    "HBox",
    "Button",
    "add",
    "destruct",
    "_disposeObjects",
    "Config"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * Editor for the (hidden) configuration.\n */\nqx.Class.define('cv.ui.manager.editor.Config', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._handledActions = ['save'];\n    this._setLayout(new qx.ui.layout.VBox(8));\n    this._createChildControl('list');\n    this._createChildControl('add-section');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: qx.locale.Manager.tr('Hidden configuration')\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _model: null,\n    _listController: null,\n    __initialSectionCount: 0,\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getConfigClient();\n      this._client.addListener('getSuccess', this._onModelValueChange, this);\n      this._client.addListener('updateSuccess', this._onSaved, this);\n    },\n\n    _loadFile: function (file) {\n      if (file) {\n        this._client.get({section: '*', key: '*'});\n      }\n    },\n\n    _onModelValueChange: function (ev) {\n      if (this.getFile()) {\n        this.setContent(ev.getData());\n      }\n    },\n\n    // overridden\n    _applyContent: function(value) {\n      var model = this._listController.getModel();\n      model.removeAll();\n\n      this.__initialSectionCount = Object.keys(value).length;\n\n      Object.keys(value).forEach(function (sectionName) {\n        var section = new cv.ui.manager.model.config.Section(sectionName);\n        Object.keys(value[sectionName]).forEach(function (optionKey) {\n          section.addOption(optionKey, value[sectionName][optionKey]);\n        }, this);\n        model.push(section);\n      }, this);\n\n      this.__checkForModification();\n    },\n\n    // overridden\n    getCurrentContent: function () {\n      return this.getContent();\n    },\n\n    _onDeleteSection: function (ev) {\n      var section = ev.getData();\n      var model = this._listController.getModel();\n      model.remove(section);\n      this.__checkForModification();\n    },\n\n    // compare current controller model with the loaded config content\n    __checkForModification: function () {\n      var file = this.getFile();\n      if (this.__initialSectionCount !== this._listController.getModel().length) {\n        file.setModified(true);\n        return;\n      }\n      var modified = this.getChildControl('list').getChildren().some(function (sectionListItem) {\n        return sectionListItem.isModified();\n      }, this);\n      file.setModified(modified);\n    },\n\n    save: function () {\n      // check for duplicate section names of keys\n      var model = this._listController.getModel();\n      var keys = [];\n      var valid = true;\n      model.forEach(function (section) {\n        var key = section.getName();\n        if (!keys.includes(key)) {\n          keys.push(key);\n        } else {\n          valid = false;\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section name duplicate: \"%1\".', key));\n        }\n        // check for key duplicates in this sections options\n        var optionKeys = [];\n        section.getOptions().forEach(function (option) {\n          var optionKey = option.getKey();\n          if (!optionKeys.includes(optionKey)) {\n            optionKeys.push(optionKey);\n          } else {\n            valid = false;\n            cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Option key duplicate: \"%1\" in section \"%2\".', optionKey, key));\n          }\n        }, this);\n      }, this);\n\n      if (valid) {\n        var data = {};\n        this._listController.getModel().forEach(function (section) {\n          var options = {};\n          section.getOptions().forEach(function (option) {\n            options[option.getKey()] = option.getValue();\n          })\n          data[section.getName()] = options;\n        }, this);\n        this._client.saveSync(null, data, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(this.tr('Saving hidden config failed with error %1 (%2)', err.status, err.statusText));\n          } else {\n            cv.ui.manager.snackbar.Controller.info(this.tr('Hidden config has been saved'));\n            this._onSaved();\n          }\n        }, this);\n      } else {\n        cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section is invalid and has not been saved.'));\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n       var control;\n\n       switch (id) {\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(new qx.data.Array(), control);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.SectionListItem();\n             },\n\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteSection, this);\n               item.addListener('changeModified', this.__checkForModification, this);\n             }.bind(this),\n\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n             }\n           });\n           this._add(control, {flex: 1});\n           break;\n\n         case 'buttons':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox(8));\n           this._add(control);\n           break;\n\n         case 'add-section':\n           control = new qx.ui.form.Button(this.tr('Add section'));\n           control.addListener('execute', function () {\n             this._listController.getModel().push(new cv.ui.manager.model.config.Section(''));\n             this.__checkForModification();\n           }, this);\n           this.getChildControl('buttons').add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_model', '_listController');\n  }\n});\n"
  ]
}