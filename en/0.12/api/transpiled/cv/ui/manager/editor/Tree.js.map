{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "editor",
    "AbstractEditor",
    "construct",
    "_setLayout",
    "layout",
    "Grow",
    "_handledActions",
    "_initWorker",
    "_schema",
    "model",
    "Schema",
    "getInstance",
    "onLoaded",
    "setReady",
    "_draw",
    "__modifiedElements",
    "__modifiedPreviewElements",
    "data",
    "Array",
    "addListener",
    "ev",
    "getData",
    "setPreviewState",
    "structureChanges",
    "some",
    "element",
    "hasChildrenModified",
    "initUnDos",
    "initReDos",
    "__buttonListeners",
    "core",
    "Init",
    "getApplication",
    "getRoot",
    "_onElementKeyUp",
    "_maintainPreviewVisibility",
    "statics",
    "SUPPORTED_FILES",
    "TITLE",
    "locale",
    "Manager",
    "tr",
    "ICON",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "Allowed",
    "NONE",
    "BEFORE",
    "AFTER",
    "INSIDE",
    "FIRST_CHILD",
    "properties",
    "appearance",
    "refine",
    "init",
    "expert",
    "check",
    "ready",
    "selected",
    "nullable",
    "event",
    "apply",
    "clipboard",
    "unDos",
    "deferredInit",
    "reDos",
    "autoRefreshPreview",
    "previewState",
    "showPreview",
    "dragging",
    "members",
    "_workerWrapper",
    "__editing",
    "__searchResults",
    "__searchResultIndex",
    "isPreviewSynced",
    "getPreviewState",
    "_applyHandlerOptions",
    "handlerOptions",
    "getHandlerOptions",
    "setShowPreview",
    "bom",
    "Viewport",
    "getWidth",
    "noPreview",
    "_applyShowPreview",
    "value",
    "getChildControl",
    "setVisibility",
    "clearLayoutProperties",
    "updateLayoutProperties",
    "noStretch",
    "setLayoutProperties",
    "flex",
    "file",
    "getFile",
    "preview",
    "isWriteable",
    "previewConfig",
    "FileItem",
    "getParent",
    "setFile",
    "_updatePreview",
    "handleAction",
    "actionName",
    "canHandleAction",
    "undo",
    "redo",
    "_onCut",
    "_onCopy",
    "_onPaste",
    "_showHelp",
    "configureButton",
    "actionId",
    "button",
    "getUnDos",
    "length",
    "setEnabled",
    "setToolTipText",
    "getItem",
    "getTitle",
    "resetToolTipText",
    "getReDos",
    "bind",
    "converter",
    "isDeletable",
    "unConfigureButton",
    "removeListenerById",
    "removeRelatedBindings",
    "addUndo",
    "elementChange",
    "ElementChange",
    "push",
    "pop",
    "error",
    "clearUnDosReDos",
    "removeAll",
    "forEach",
    "elem",
    "dispose",
    "clearReDos",
    "_applyClipboard",
    "navigator",
    "writeText",
    "getNode",
    "outerHTML",
    "e",
    "CLIPBOARD",
    "Worker",
    "showErrors",
    "path",
    "errorList",
    "showDecorations",
    "decorators",
    "_loadFile",
    "old",
    "close",
    "getType",
    "isSupported",
    "hasChildControl",
    "resetFile",
    "resetPreviewState",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "container",
    "Composite",
    "HBox",
    "_add",
    "Canvas",
    "addAt",
    "VBox",
    "isShowPreview",
    "exclude",
    "viewer",
    "Config",
    "set",
    "target",
    "minWidth",
    "ok",
    "noSync",
    "notOk",
    "basic",
    "Atom",
    "setRich",
    "setWrap",
    "label",
    "icon",
    "removeState",
    "addState",
    "toolbar",
    "Button",
    "_onEdit",
    "add",
    "_onDelete",
    "CheckBox",
    "toggleExpert",
    "ToolBar",
    "top",
    "left",
    "right",
    "form",
    "TextField",
    "liveUpdate",
    "placeholder",
    "margin",
    "util",
    "Function",
    "debounce",
    "_onSearch",
    "getKeyIdentifier",
    "_showNextResult",
    "_showPreviousResult",
    "stopPropagation",
    "tree",
    "VirtualTree",
    "selectionMode",
    "width",
    "openMode",
    "itemHeight",
    "Environment",
    "get",
    "_initDragDrop",
    "setDelegate",
    "createItem",
    "item",
    "VirtualElementItem",
    "_onContextMenu",
    "_onContextMenuAction",
    "bindItem",
    "controller",
    "index",
    "bindProperty",
    "bindPropertyReverse",
    "getSelection",
    "_onChangeTreeSelection",
    "bottom",
    "setDraggable",
    "setMarginLeft",
    "setZIndex",
    "setAppearance",
    "getSelected",
    "_onCreate",
    "qxl",
    "dialog",
    "Dialog",
    "alert",
    "Widget",
    "setDecorator",
    "decoration",
    "Decorator",
    "widthTop",
    "styleTop",
    "colorTop",
    "setHeight",
    "setOpacity",
    "setDroppable",
    "contextmenu",
    "ConfigElement",
    "getCurrentTarget",
    "getModel",
    "replace",
    "setSelected",
    "menu",
    "setElement",
    "openAtPointer",
    "getBubbles",
    "stop",
    "action",
    "added",
    "resetSelected",
    "openByQuerySelector",
    "selector",
    "edit",
    "Promise",
    "resolve",
    "reject",
    "rootNode",
    "result",
    "querySelector",
    "__showSearchResult",
    "from",
    "querySelectorAll",
    "filter",
    "el",
    "tagName",
    "startsWith",
    "hasAttribute",
    "getAttribute",
    "firstMatch",
    "$$widget",
    "openNodeAndParents",
    "current",
    "ancestors",
    "parentElement",
    "load",
    "i",
    "p",
    "draggedXmlElement",
    "dragTarget",
    "getDragTarget",
    "setDragging",
    "isEditable",
    "preventDefault",
    "addAction",
    "addType",
    "addData",
    "addButton",
    "Tree",
    "accepted",
    "mode",
    "getCurrentAction",
    "supportsType",
    "addNew",
    "getTarget",
    "indicator",
    "debug",
    "isAncestor",
    "layerContent",
    "getPane",
    "getLayers",
    "getContentLocation",
    "getDocumentTop",
    "lastElem",
    "document",
    "elementFromPoint",
    "Math",
    "round",
    "getWidgetByElement",
    "isAnonymous",
    "getLayoutParent",
    "parent",
    "parentSchemaElement",
    "getSchemaElement",
    "allowedElements",
    "getAllowedElements",
    "Object",
    "keys",
    "addable",
    "getAddableChildren",
    "areChildrenSortable",
    "acc",
    "allowedSorting",
    "getAllowedElementsSorting",
    "elementName",
    "__getAllowedPositions",
    "getName",
    "isChildElementAllowed",
    "lookInside",
    "getFirstLevelElementSorting",
    "targetPosition",
    "undefined",
    "getChildren",
    "firstChild",
    "maxPosition",
    "firstChildPosition",
    "expandTimer",
    "lastTreeItem",
    "treeContainer",
    "onDrag",
    "position",
    "cursor",
    "getManager",
    "getCursor",
    "DragDropCursor",
    "_native",
    "pointerType",
    "hasState",
    "origElem",
    "getDocumentLeft",
    "orig",
    "skipDetection",
    "origCoords",
    "leftPos",
    "spacer",
    "_getChildren",
    "getPaddingLeft",
    "setWidth",
    "getBounds",
    "lastCoords",
    "distance",
    "isOpen",
    "getUserData",
    "setDomPosition",
    "Timer",
    "once",
    "openNode",
    "setUserData",
    "getAction",
    "resetAction",
    "console",
    "assert",
    "setAction",
    "onDrop",
    "clone",
    "getDisplayName",
    "moveAfter",
    "snackbar",
    "Controller",
    "info",
    "insertAfter",
    "moveBefore",
    "insertBefore",
    "moveInside",
    "insertChild",
    "onDragEnd",
    "resetUserData",
    "resetDragging",
    "children",
    "sorting",
    "minPosition",
    "targetIndex",
    "indexOf",
    "found",
    "sibling",
    "name",
    "prototype",
    "hasOwnProperty",
    "call",
    "typeChooserForm",
    "ElementForm",
    "allowCancel",
    "context",
    "message",
    "formData",
    "type",
    "help",
    "options",
    "sort",
    "a",
    "b",
    "localeCompare",
    "map",
    "validation",
    "required",
    "show",
    "promise",
    "then",
    "ownerDocument",
    "isElement",
    "createComment",
    "createTextNode",
    "createCDATASection",
    "createElement",
    "schemaElement",
    "getSchemaElementForElementName",
    "initChildren",
    "requiredChildren",
    "getRequiredElements",
    "schema",
    "Element",
    "sortChildNodes",
    "childName",
    "child",
    "appendChild",
    "isTextContentRequired",
    "xmlElement",
    "XmlElement",
    "getEditor",
    "res",
    "isShowEditButton",
    "setSelection",
    "err",
    "targetName",
    "depth",
    "currentPosition",
    "split",
    "test",
    "parseInt",
    "min",
    "__checkProvider",
    "provider",
    "Provider",
    "getLive",
    "userInputAllowed",
    "includes",
    "endsWith",
    "isArray",
    "unshift",
    "__getAttributeFormDefinition",
    "attribute",
    "docs",
    "getDocumentation",
    "def",
    "join",
    "enabled",
    "getDefaultValue",
    "isOptional",
    "validator",
    "ListItem",
    "getValue",
    "isValueValid",
    "ValidationError",
    "getTypeString",
    "enums",
    "getEnumeration",
    "isNew",
    "title",
    "caption",
    "getShowEditButton",
    "typeElement",
    "nodeType",
    "Node",
    "ELEMENT_NODE",
    "allowed",
    "getAllowedAttributes",
    "getExpert",
    "appInfo",
    "getAppinfo",
    "parser",
    "DOMParser",
    "attrName",
    "nodeName",
    "lines",
    "autoSize",
    "innerHTML",
    "dom",
    "parseFromString",
    "getElementsByTagName",
    "TEXT_NODE",
    "COMMENT_NODE",
    "CDATA_SECTION_NODE",
    "getTextContent",
    "isTextNode",
    "convertTextNodeType",
    "newNodeName",
    "formDialog",
    "maxWidth",
    "setAttributes",
    "validate",
    "destroy",
    "remove",
    "execCommand",
    "setClipboard",
    "copy",
    "clipboardElement",
    "getClipboard",
    "resetClipboard",
    "updateModified",
    "previewIndex",
    "$$removed",
    "splice",
    "isModified",
    "setModified",
    "_onContentChanged",
    "_createChildControl",
    "addSeparator",
    "addSpacer",
    "_applySelected",
    "_updateHighlightWidget",
    "node",
    "parentNode",
    "openPage",
    "setHighlightWidget",
    "getWidgetPath",
    "isVisible",
    "_applyContent",
    "open",
    "initialValidation",
    "modified",
    "validateXmlConfig",
    "getPath",
    "__loadContent",
    "Main",
    "closeFile",
    "Bus",
    "dispatchByName",
    "getFullPath",
    "handler",
    "jumpToError",
    "hide",
    "resetModel",
    "errors",
    "xml",
    "Document",
    "fromString",
    "getElementNode",
    "documentElement",
    "setEditable",
    "getWriteable",
    "setModel",
    "setContentPaddingBottom",
    "isTemporary",
    "parts",
    "substr",
    "part",
    "shift",
    "match",
    "exec",
    "toString",
    "setValid",
    "content",
    "getCurrentContent",
    "contentChanged",
    "isAutoRefreshPreview",
    "reset",
    "previewFile",
    "_client",
    "updateSync",
    "getBusTopic",
    "source",
    "fast",
    "XMLSerializer",
    "serializeToString",
    "_prettify",
    "level",
    "singleton",
    "tabs",
    "fill",
    "newLine",
    "textContent",
    "trim",
    "String",
    "escape",
    "output",
    "attributes",
    "childNodes",
    "onlyOneTextChild",
    "_onSaved",
    "onSaved",
    "focusedWidget",
    "FocusHandler",
    "getFocusedWidget",
    "dialogConf",
    "modal",
    "image",
    "maxHeight",
    "getHeight",
    "BigAlert",
    "destruct",
    "_disposeArray",
    "removeListener"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Tree.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n    this._initWorker();\n\n    // init schema\n    this._schema = cv.ui.manager.model.Schema.getInstance('visu_config.xsd');\n    this._schema.onLoaded(function () {\n      this.setReady(true);\n      this._draw();\n    }, this);\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', ev => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    }, this);\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener('keyup', this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schema: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n\n    isPreviewSynced: function () {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions: function () {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility: function () {\n      const handlerOptions = this.getHandlerOptions();\n      this.setShowPreview(qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview));\n    },\n\n    _applyShowPreview: function (value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({flex: 1});\n        }\n      }\n      const file = this.getFile();\n      if (value && file) {\n        const preview = this.getChildControl('preview');\n        if (file.isWriteable()) {\n          if (!preview.getFile()) {\n            const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', this.getFile().getParent());\n            preview.setFile(previewConfig);\n          }\n        } else {\n          // this file is not writable, we can use the real one for preview\n          preview.setFile(file);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'undo':\n            if (!this.__editing) {\n              this.undo();\n            }\n            break;\n\n          case 'redo':\n            if (!this.__editing) {\n              this.redo();\n            }\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            if (!this.__editing) {\n              this._showHelp();\n            }\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getUnDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getReDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return value ? !value.isDeletable() : false;\n            }\n          });\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n      }\n    },\n    unConfigureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo: function (elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo: function () {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error('could not undo ' + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo: function () {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error('could not redo ' + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos: function () {\n      this.getUnDos().removeAll().forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos: function () {\n      this.getReDos().removeAll().forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard: function (value) {\n      try {\n        if (value) {\n          navigator.clipboard.writeText(value.getNode().outerHTML);\n        } else {\n          navigator.clipboard.writeText('');\n        }\n      } catch (e) {\n        // clipboard api is only available in secure environment, otherwise we have to do it ourself\n        cv.ui.manager.editor.AbstractEditor.CLIPBOARD = value ? value.getNode().outerHTML : '';\n      }\n    },\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors: function (path, errorList) {\n    },\n    showDecorations: function (path, decorators) {\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        this.base(arguments, file, old);\n      } else {\n        this.base(arguments, null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'splitpane':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this._add(control);\n           break;\n\n         case 'left':\n           control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n           this.getChildControl('splitpane').addAt(control, 0);\n           break;\n\n         case 'right':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n           if (!this.isShowPreview()) {\n             control.exclude();\n           }\n           this.getChildControl('splitpane').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview':\n           control = new cv.ui.manager.viewer.Config();\n           control.set({\n             target: 'iframe',\n             minWidth: 600\n           });\n           this.getChildControl('right').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview-sync-hint': {\n           const ok = this.tr('Preview shows the current state of the edited configuration.');\n           const noSync = this.tr('Preview is out of sync. Click here to refresh.');\n           const notOk = this.tr('Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.');\n           control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n           control.setRich(true);\n           control.getChildControl('label').setWrap(true);\n           control.addListener('tap', () => {\n             if (!this.isPreviewSynced() && this.isShowPreview()) {\n               this._updatePreview();\n             }\n           }, this);\n           this.getChildControl('right').addAt(control, 0);\n           this.addListener('previewStateChanged', ev => {\n             switch (ev.getData()) {\n               case 'synced':\n                 control.set({\n                   label: ok,\n                   icon: cv.theme.dark.Images.getIcon('valid', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n\n               case 'changed':\n                 control.set({\n                   label: noSync,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').addState('warning');\n                 break;\n\n               case 'structureChanged':\n                 control.set({\n                   label: notOk,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').addState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n             }\n           }, this);\n           break;\n         }\n\n         case 'edit-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n           control.setEnabled(false);\n           control.addListener('execute', this._onEdit, this);\n           this.bind('file.writeable', control, 'icon', {\n             converter: function (value) {\n               return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16);\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n           control.setEnabled(false);\n           control.addListener('execute', this._onDelete, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toggle-expert':\n           control = new qx.ui.toolbar.CheckBox(this.tr('Expertview'),\n             cv.theme.dark.Images.getIcon('expert', 16));\n           control.addListener('execute', function () {\n             this.toggleExpert();\n           }, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'refresh-preview':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n           control.setToolTipText(this.tr('Reload preview'));\n           control.addListener('execute', this._updatePreview, this);\n           this.bind('showPreview', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'hidden';\n             }\n           });\n           this.bind('previewState', control, 'enabled', {\n             converter: function (value) {\n               return value !== 'synced';\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toolbar':\n           control = new qx.ui.toolbar.ToolBar();\n           this.getChildControl('left').add(control, {\n             top: 0,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar-container':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this.getChildControl('left').add(control, {\n             top: 36,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             placeholder: this.tr('Search...'),\n             margin: 8\n           });\n           control.addListener('changeValue', qx.util.Function.debounce(this._onSearch, 250), this);\n           control.addListener('keyup', function (ev) {\n             switch (ev.getKeyIdentifier()) {\n               case 'Enter':\n               case 'Down':\n                 this._showNextResult();\n                 break;\n               case 'Up':\n                 this._showPreviousResult();\n                 break;\n             }\n             ev.stopPropagation();\n           }, this);\n           this.getChildControl('searchbar-container').add(control, {flex: 1});\n           break;\n\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n           control.set({\n             selectionMode: 'single',\n             width: 350,\n             openMode: 'none',\n             itemHeight: qx.core.Environment.get('device.touch') ? 40 : 20\n           });\n           this.bind('file.writeable', control, 'droppable');\n           this.bind('file.writeable', control, 'draggable');\n           this._initDragDrop(control);\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualElementItem();\n               if (!qx.core.Environment.get('device.touch')) {\n                 item.addListener('contextmenu', this._onContextMenu, this);\n               } else {\n                 item.addListener('action', this._onContextMenuAction, this);\n               }\n               item.addListener('dbltap', this._onEdit, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindProperty('displayName', 'label', null, item, index);\n               controller.bindProperty('name', 'name', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('showEditButton', 'editable', null, item, index);\n               controller.bindProperty('sortable', 'sortable', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('status', 'status', null, item, index);\n               controller.bindProperty('invalidMessage', 'toolTipText', null, item, index);\n               controller.bindProperty('dragging', 'dragging', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this.getChildControl('left').add(control, {\n             top: 72,\n             left: 0,\n             right: 0,\n             bottom: 0\n           });\n           break;\n\n         case 'add-button':\n           control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n           control.setDraggable(true);\n           control.setMarginLeft(-16);\n           control.setZIndex(20);\n           this.addListener('changeDragging', ev => {\n             control.setLayoutProperties({\n               bottom: 16,\n               left: ev.getData() ? -1000 : '50%'\n             });\n           }, this);\n           control.setAppearance('round-button');\n           control.addListener('pointerover', () => control.addState('hovered'));\n           control.addListener('pointerout', () => control.removeState('hovered'));\n           control.addListener('tap', () => {\n             if (this.getSelected()) {\n               this._onCreate(this.getSelected(), 'inside');\n             } else {\n               qxl.dialog.Dialog.alert(this.tr('Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.'));\n             }\n           }, this);\n           this.getChildControl('left').add(control, {\n             bottom: 16,\n             left: '50%'\n           });\n           break;\n\n         case 'drag-indicator':\n           // Create drag indicator\n           control = new qx.ui.core.Widget();\n           control.setDecorator(new qx.ui.decoration.Decorator().set({\n             widthTop: 1,\n             styleTop: 'solid',\n             colorTop: 'white'\n           }));\n           control.setHeight(0);\n           control.setOpacity(0.5);\n           control.setZIndex(100);\n           control.setDroppable(true);\n           control.setLayoutProperties({left: -1000, top: -1000});\n           qx.core.Init.getApplication().getRoot().add(control);\n           break;\n\n         case 'context-menu':\n           control = new cv.ui.manager.contextmenu.ConfigElement(this);\n           control.addListener('action', this._onContextMenuAction, this);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    _onContextMenu: function (ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction: function (ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, 'inside');\n            break;\n\n          default:\n            this.error('unhandled context menu action', data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n\n    openByQuerySelector: function (selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch: function (ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || el.hasAttribute('name') && el.getAttribute('name').startsWith(value);\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult: function () {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult: function () {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult: function () {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length-1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop: function (control) {\n      let draggedXmlElement;\n      control.addListener('dragstart', function (ev) {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction('copy');\n          if (element.isDeletable()) {\n            ev.addAction('move');\n          }\n          ev.addType('cv/tree-element');\n          ev.addData('cv/tree-element', element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      }, this);\n\n      const addButton = this.getChildControl('add-button');\n      addButton.addListener('dragstart', function (ev) {\n        ev.addAction('copy');\n        ev.addType('cv/new-tree-element');\n        this.setDragging(true);\n      }, this);\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      };\n\n      control.addListener('dragover', function (ev) {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType('cv/tree-element')) {\n          element = ev.getData('cv/tree-element');\n        }\n        const addNew = action === 'copy' && !element && ev.supportsType('cv/new-tree-element');\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug('dragging over indicator');\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug('dropping on same element forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug('moving inside own subtree forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && (ev.getDocumentTop() - layerContent.bottom <= 20)) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(Math.round((layerContent.left + layerContent.right) / 2), layerContent.bottom - 20);\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug('drop target not found');\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug('drop not allowed here, no drag element');\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n                    if ((acc & Allowed.BEFORE) && (acc & Allowed.AFTER)) {\n                      // we cannot find more\n                      return true;\n                    }\n                    return false;\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug('no children allowed here');\n            }\n          } else if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n              // not allowed on this level\n              accepted.mode = Allowed.NONE;\n              this.debug('not allowed as child element of', parent.getName());\n            } else if (parentSchemaElement.areChildrenSortable()) {\n              // children can be put anywhere\n              // so this is allowed anywhere\n              accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n            } else {\n              // check position\n              accepted.mode = this.__getAllowedPositions(parentSchemaElement.getAllowedElementsSorting(), element.getName(), model.getName());\n            }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug('dropping not accepted here');\n        }\n      }, this);\n\n      const indicator = this.getChildControl('drag-indicator');\n\n      let expandTimer;\n\n      control.addListener('dragleave', function (ev) {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      }, this);\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = '';\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = 'after';\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if ((ev.getDocumentTop() - origCoords.top) <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = 'before';\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = 'inside';\n              }\n            } else if ((origCoords.bottom - ev.getDocumentTop()) <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = 'after';\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = 'inside';\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                // eslint-disable-next-line no-lonely-if\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                } else {\n                  this.debug('not allowed as first child');\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              // eslint-disable-next-line no-lonely-if\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData('position') !== 'first-child') {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = 'inside';\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(function () {\n                    if (accepted.target) {\n                      control.openNode(accepted.target);\n                    }\n                  }, this, 1000);\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData('position', position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData('action', ev.getCurrentAction());\n          cursor.resetAction();\n          // eslint-disable-next-line no-console\n          console.assert(left < 0);\n          // eslint-disable-next-line no-console\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData('action')) {\n          cursor.setAction(indicator.getUserData('action'));\n          indicator.setUserData('action', null);\n        }\n      };\n      control.addListener('drag', onDrag, this);\n      addButton.addListener('drag', onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction();\n        let element = ev.supportsType('cv/tree-element') ? ev.getData('cv/tree-element') : null;\n        if (action === 'copy') {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = 'add';\n          }\n        }\n        const elementName = element ? element.getDisplayName() : 'new';\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData('position')) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, 'after', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, 'before', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as first child');\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName() + ' as first child');\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as child');\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName(), 'as child');\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener('drop', onDrop, this);\n      indicator.addListener('drop', onDrop, this);\n\n      const onDragEnd = function(ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener('dragend', onDragEnd, this);\n      addButton.addListener('dragend', onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate: function (target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex-1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(name => Object.prototype.hasOwnProperty.call(sorting, name) && sorting[name] <= maxPosition && sorting[name] >= minPosition);\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm;\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr('<p style=\\'font-weight:bold\\'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>'),\n            formData: {\n              type: {\n                type: 'SelectBox',\n                label: this.tr('Choose element'),\n                help: this.tr('Please choose the element you want to add here.'),\n                options: addable.sort((a, b) => {\n                  if (a.startsWith('#') && !b.startsWith('#')) {\n                    return 1;\n                  } else if (!a.startsWith('#') && b.startsWith('#')) {\n                    return -1;\n                  }\n                  return a.localeCompare(b);\n                }).map(name => ({label: name, value: name})),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          }).show().promise();\n        } else {\n          typeChooserForm = Promise.resolve({type: addable[0]});\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment('');\n                break;\n\n              case '#text':\n                element = document.createTextNode('');\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection('');\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode('-');\n                element.appendChild(child);\n              }\n            };\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement, true);\n            }\n            res.then(data => {\n              if (data) {\n                // finally insert the new node\n                switch (position) {\n                  case 'before':\n                    xmlElement.insertBefore(target);\n                    break;\n\n                  case 'after':\n                    xmlElement.insertAfter(target);\n                    break;\n\n                  case 'inside':\n                    target.insertChild(xmlElement, -1, false, 'added');\n                    break;\n\n                  case 'first-child':\n                    target.insertChild(xmlElement, 0, false, 'added');\n                    break;\n                }\n                this.getChildControl('tree').openNodeAndParents(xmlElement);\n                this.getChildControl('tree').setSelection([xmlElement]);\n              }\n            }, this).catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions: function (allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === 'string') {\n          currentPosition = currentPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === 'string') {\n          targetPosition = targetPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length);\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n      }\n      return cv.ui.manager.editor.Tree.Allowed.NONE;\n    },\n\n    __checkProvider: function (id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error('misconfigured provider found for ' + id);\n        }\n        formData.type = provider.userInputAllowed ? 'VirtualComboBox' : 'VirtualSelectBox';\n      } else if (['mapping', 'styling'].includes(id.split('@').pop())) {\n        const type = id.split('@').pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = 'SelectBox';\n        formData.options = [];\n        rootNode.querySelectorAll('meta > ' + type + 's > ' + type).forEach(element => {\n          const name = element.getAttribute('name');\n          formData.options.push({label: name, value: name});\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options.then(res => {\n              if (Array.isArray(res)) {\n                res.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n              }\n            }).catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition: function (element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: 'TextField',\n        label: attribute.getName(),\n        placeholder: ' - ' + this.tr('not set') + ' - ',\n        help: docs.join('<br/>'),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator: function (value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n            }\n          }\n        }\n      };\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = 'CheckBox';\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string': {\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = 'SelectBox';\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({label: name, value: name});\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + '@' + attribute.getName(), def, element.getNode());\n          }\n          break;\n        }\n      }\n      return def;\n    },\n\n    _onEdit: function (ev, element, isNew) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return null;\n      }\n      let title;\n      let caption;\n      if (!element) {\n        if (this.getSelected()) {\n          element = this.getSelected();\n        } else {\n          return null;\n        }\n      }\n      if (!element.getShowEditButton()) {\n        return null;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (isNew) {\n        title = this.tr('Create new %1 element', element.getName());\n        caption = this.tr('Please edit the attributes of the new %1 element, that will be added to the chosen position.', element.getName());\n      } else {\n        title = this.tr('Edit element attributes');\n        caption = element.isEditable() ? this.tr('Edit %1', element.getName()) : this.tr('Show %1', element.getName());\n      }\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n        if (typeElement.isChildElementAllowed('*')) {\n          const parser = new DOMParser();\n          const attrName = element.getNode().nodeName === 'custom' ? '#innerHTML' : '#outerHTML';\n          if (isNew) {\n            title = this.tr('Create new %1 element', element.getName());\n            caption = this.tr('Please edit the content of the new %1 element, that will be added to the chosen position.', element.getName());\n          } else {\n            title = attrName === '#outerHTML' ? this.tr('Edit element and content') : this.tr('Edit element content');\n          }\n          formData[attrName] = {\n            type: 'TextArea',\n            label: '',\n            lines: 5,\n            autoSize: true,\n            width: Math.min(qx.bom.Viewport.getWidth(), 500),\n            enabled: element.isEditable(),\n            value: attrName === '#outerHTML' ? element.getNode().outerHTML : element.getNode().innerHTML,\n            validation: {\n              validator: function (value) {\n                if (value) {\n                  const dom = parser.parseFromString(value, 'text/xml');\n                  if (dom.getElementsByTagName('parsererror').length > 0) {\n                    throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n                  }\n                }\n              }\n            }\n          };\n        }\n      } else if (element.getNode().nodeType === Node.TEXT_NODE || element.getNode().nodeType === Node.COMMENT_NODE || element.getNode().nodeType === Node.CDATA_SECTION_NODE) {\n        title = this.tr('Edit text content', element.getName());\n        caption = '';\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: 'TextArea',\n          label: '',\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr('not set'),\n          help: docs.join('<br/>'),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator: function (value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n              }\n            }\n          }\n        };\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute('type');\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(element.getParent().getName() + '@' + element.getName(), formData[nodeName], element.getNode());\n      }\n      this.__editing = true;\n\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption:  title,\n        message: caption,\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          if (!Object.prototype.hasOwnProperty.call(data, '#outerHTML') && !Object.prototype.hasOwnProperty.call(data, '#innerHTML')) {\n            element.validate();\n          }\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete: function (ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n      return null;\n    },\n\n    _onCut: function () {\n      if (this.__editing) {\n        document.execCommand('cut');\n      } else {\n        const element = this._onDelete();\n        if (element) {\n          this.setClipboard(element);\n        }\n      }\n    },\n\n    _onCopy: function () {\n      if (this.__editing) {\n        document.execCommand('copy');\n      } else {\n        const element = this.getSelected();\n        if (element) {\n          const copy = element.clone();\n          this.setClipboard(copy);\n        }\n      }\n    },\n\n    _onPaste: function () {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified: function (element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else if (element.isModified()) {\n          if (index === -1) {\n            this.__modifiedElements.push(element);\n          }\n          if (previewIndex === -1) {\n            this.__modifiedPreviewElements.push(element);\n          }\n        } else {\n          if (index >= 0) {\n            this.__modifiedElements.splice(index, 1);\n          }\n          if (previewIndex >= 0) {\n            this.__modifiedPreviewElements.splice(index, 1);\n          }\n        }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw: function () {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget: function () {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          while (node && node.nodeName !== 'pages') {\n            if (node.nodeName === 'page') {\n              path.unshift(node.getAttribute('name'));\n            }\n            node = node.parentNode;\n          }\n          if (path.length > 0) {\n            preview.openPage(path.pop(), path.join('/'));\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp: function(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === 'Enter') {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent: function(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + ' is a valid config file');\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n              dialog.addListener('action', ev => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source': {\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: 'cv.ui.manager.editor.Source',\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n                    break;\n                  }\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n                dialog.hide();\n                dialog.destroy();\n              }, this);\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __loadContent: function (value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const document = qx.xml.Document.fromString(value);\n        const schemaElement = this._schema.getElementNode(document.documentElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(document.documentElement, schemaElement, this);\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n          // extra space fr add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (file.isWriteable()) {\n            if (!preview.getFile()) {\n              const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', file.getParent());\n              preview.setFile(previewConfig);\n            }\n          } else {\n            preview.setFile(file);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split('/');\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error('Error loading ' + current.getName() + ': ' + e.toString());\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error('patch segment format error: ' + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      }\n    },\n\n    _onContentChanged: function () {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview: function (ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        this._client.updateSync({\n          path: previewFile.getFullPath(),\n          hash: 'ignore'\n        }, content, () => {\n          qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n            type: 'contentChanged',\n            file: previewFile,\n            data: content,\n            source: this\n          });\n          this.__modifiedPreviewElements.removeAll();\n          this.resetPreviewState();\n        }, this);\n      }\n    },\n\n    getCurrentContent: function (fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        } \n          // prettify content\n          return '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n' + this._prettify(rootNode, 0);\n      } \n        return null;\n    },\n\n    _prettify: function (node, level, singleton) {\n      let tabs = Array(level + 1).fill('').join('\\t');\n      let newLine = '\\n';\n      if (node.nodeType === Node.TEXT_NODE) {\n        if (node.textContent.trim()) {\n          return (singleton ? '' : tabs) + qx.xml.String.escape(node.textContent.trim()) + (singleton ? '' : newLine);\n        } \n          return '';\n      }\n      if (node.nodeType === Node.COMMENT_NODE) {\n        return (singleton ? '' : tabs) + `<!--${node.textContent}--> ${(singleton ? '' : newLine)}`;\n      } else if (node.nodeType === Node.CDATA_SECTION_NODE) {\n        return (singleton ? '' : tabs) + `<![CDATA[${node.textContent}]]> ${(singleton ? '' : newLine)}`;\n      }\n      if (!node.tagName) {\n        return this._prettify(node.firstChild, level);\n      }\n      let output = tabs + `<${node.tagName}`; // >\\n\n      for (let i = 0; i < node.attributes.length; i++) {\n        output += ` ${node.attributes[i].name}=\"${node.attributes[i].value}\"`;\n      }\n      if (node.childNodes.length === 0) {\n        return output + ' />' + newLine;\n      } \n        output += '>';\n      \n      let onlyOneTextChild = ((node.childNodes.length === 1) && (node.childNodes[0].nodeType === 3));\n      if (!onlyOneTextChild) {\n        output += newLine;\n      }\n      for (let i = 0; i < node.childNodes.length; i++) {\n        output += this._prettify(node.childNodes[i], level + 1, onlyOneTextChild);\n      }\n      return output + (onlyOneTextChild ? '' : tabs) + `</${node.tagName}>` + newLine;\n    },\n\n    _onSaved: function () {\n      this.base(arguments);\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported: function (file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp: function () {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr('Help'),\n        modal: true,\n        image: 'qxl.dialog.icon.info',\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: ''\n      };\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr('<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with \\'Enter\\' or the \\'Down\\' key. Accordingly you can jump the the previous found element \\\nwith the \\'Up\\' key.</p>');\n      } else {\n        // show general help\n        dialogConf.message = this.tr('<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the \\'edit\\'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the \\'edit\\'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the \\'add child\\'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the \\'Expertview\\'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>');\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._schema = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener('keyup', this._onElementKeyUp, this);\n  }\n});\n"
  ]
}