{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "editor",
    "AbstractEditor",
    "construct",
    "_setLayout",
    "layout",
    "Grow",
    "_handledActions",
    "_initWorker",
    "_schema",
    "model",
    "Schema",
    "getInstance",
    "onLoaded",
    "setReady",
    "_draw",
    "__modifiedElements",
    "__modifiedPreviewElements",
    "data",
    "Array",
    "addListener",
    "ev",
    "getData",
    "setPreviewState",
    "structureChanges",
    "some",
    "element",
    "hasChildrenModified",
    "initUnDos",
    "initReDos",
    "__buttonListeners",
    "core",
    "Init",
    "getApplication",
    "getRoot",
    "_onElementKeyUp",
    "_maintainPreviewVisibility",
    "statics",
    "SUPPORTED_FILES",
    "TITLE",
    "locale",
    "Manager",
    "tr",
    "ICON",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "Allowed",
    "NONE",
    "BEFORE",
    "AFTER",
    "INSIDE",
    "FIRST_CHILD",
    "properties",
    "appearance",
    "refine",
    "init",
    "expert",
    "check",
    "ready",
    "selected",
    "nullable",
    "event",
    "apply",
    "clipboard",
    "unDos",
    "deferredInit",
    "reDos",
    "autoRefreshPreview",
    "previewState",
    "showPreview",
    "dragging",
    "members",
    "_workerWrapper",
    "__editing",
    "__searchResults",
    "__searchResultIndex",
    "isPreviewSynced",
    "getPreviewState",
    "_applyHandlerOptions",
    "handlerOptions",
    "getHandlerOptions",
    "setShowPreview",
    "bom",
    "Viewport",
    "getWidth",
    "noPreview",
    "_applyShowPreview",
    "value",
    "getChildControl",
    "setVisibility",
    "clearLayoutProperties",
    "updateLayoutProperties",
    "noStretch",
    "setLayoutProperties",
    "flex",
    "getFile",
    "preview",
    "previewConfig",
    "FileItem",
    "getParent",
    "setFile",
    "_updatePreview",
    "handleAction",
    "actionName",
    "canHandleAction",
    "undo",
    "redo",
    "_onCut",
    "_onCopy",
    "_onPaste",
    "_showHelp",
    "configureButton",
    "actionId",
    "button",
    "getUnDos",
    "length",
    "setEnabled",
    "setToolTipText",
    "getItem",
    "getTitle",
    "resetToolTipText",
    "getReDos",
    "bind",
    "converter",
    "isDeletable",
    "unConfigureButton",
    "removeListenerById",
    "removeRelatedBindings",
    "addUndo",
    "elementChange",
    "ElementChange",
    "push",
    "pop",
    "error",
    "clearUnDosReDos",
    "removeAll",
    "forEach",
    "elem",
    "dispose",
    "clearReDos",
    "_applyClipboard",
    "navigator",
    "writeText",
    "getNode",
    "outerHTML",
    "Worker",
    "showErrors",
    "path",
    "errorList",
    "showDecorations",
    "decorators",
    "_loadFile",
    "file",
    "old",
    "close",
    "getType",
    "isSupported",
    "hasChildControl",
    "resetFile",
    "resetPreviewState",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "container",
    "Composite",
    "HBox",
    "_add",
    "Canvas",
    "addAt",
    "VBox",
    "isShowPreview",
    "exclude",
    "viewer",
    "Config",
    "set",
    "target",
    "minWidth",
    "ok",
    "noSync",
    "notOk",
    "basic",
    "Atom",
    "setRich",
    "setWrap",
    "label",
    "icon",
    "removeState",
    "addState",
    "toolbar",
    "Button",
    "_onEdit",
    "add",
    "_onDelete",
    "CheckBox",
    "toggleExpert",
    "ToolBar",
    "top",
    "left",
    "right",
    "form",
    "TextField",
    "liveUpdate",
    "placeholder",
    "margin",
    "util",
    "Function",
    "debounce",
    "_onSearch",
    "getKeyIdentifier",
    "_showNextResult",
    "_showPreviousResult",
    "stopPropagation",
    "tree",
    "VirtualTree",
    "selectionMode",
    "width",
    "openMode",
    "itemHeight",
    "Environment",
    "get",
    "_initDragDrop",
    "setDelegate",
    "createItem",
    "item",
    "VirtualElementItem",
    "_onContextMenu",
    "_onContextMenuAction",
    "bindItem",
    "controller",
    "index",
    "bindProperty",
    "bindPropertyReverse",
    "getSelection",
    "_onChangeTreeSelection",
    "bottom",
    "setDraggable",
    "setMarginLeft",
    "setZIndex",
    "setAppearance",
    "getSelected",
    "_onCreate",
    "qxl",
    "dialog",
    "Dialog",
    "alert",
    "Widget",
    "setDecorator",
    "decoration",
    "Decorator",
    "widthTop",
    "styleTop",
    "colorTop",
    "setHeight",
    "setOpacity",
    "setDroppable",
    "contextmenu",
    "ConfigElement",
    "getCurrentTarget",
    "getModel",
    "replace",
    "setSelected",
    "menu",
    "setElement",
    "openAtPointer",
    "getBubbles",
    "stop",
    "action",
    "added",
    "resetSelected",
    "openByQuerySelector",
    "selector",
    "edit",
    "Promise",
    "resolve",
    "reject",
    "rootNode",
    "result",
    "querySelector",
    "__showSearchResult",
    "from",
    "querySelectorAll",
    "filter",
    "el",
    "tagName",
    "startsWith",
    "hasAttribute",
    "getAttribute",
    "firstMatch",
    "$$widget",
    "openNodeAndParents",
    "current",
    "ancestors",
    "parentElement",
    "load",
    "i",
    "p",
    "draggedXmlElement",
    "dragTarget",
    "getDragTarget",
    "setDragging",
    "isEditable",
    "preventDefault",
    "addAction",
    "addType",
    "addData",
    "addButton",
    "Tree",
    "accepted",
    "mode",
    "getCurrentAction",
    "supportsType",
    "addNew",
    "getTarget",
    "indicator",
    "debug",
    "isAncestor",
    "layerContent",
    "getPane",
    "getLayers",
    "getContentLocation",
    "getDocumentTop",
    "lastElem",
    "document",
    "elementFromPoint",
    "Math",
    "round",
    "getWidgetByElement",
    "isAnonymous",
    "getLayoutParent",
    "parent",
    "parentSchemaElement",
    "getSchemaElement",
    "allowedElements",
    "getAllowedElements",
    "Object",
    "keys",
    "addable",
    "getAddableChildren",
    "areChildrenSortable",
    "acc",
    "allowedSorting",
    "getAllowedElementsSorting",
    "elementName",
    "__getAllowedPositions",
    "getName",
    "isChildElementAllowed",
    "lookInside",
    "getFirstLevelElementSorting",
    "targetPosition",
    "undefined",
    "getChildren",
    "firstChild",
    "maxPosition",
    "firstChildPosition",
    "expandTimer",
    "lastTreeItem",
    "treeContainer",
    "onDrag",
    "position",
    "cursor",
    "getManager",
    "getCursor",
    "DragDropCursor",
    "_native",
    "pointerType",
    "hasState",
    "origElem",
    "getDocumentLeft",
    "orig",
    "skipDetection",
    "origCoords",
    "leftPos",
    "spacer",
    "_getChildren",
    "getPaddingLeft",
    "setWidth",
    "getBounds",
    "lastCoords",
    "distance",
    "isOpen",
    "getUserData",
    "setDomPosition",
    "Timer",
    "once",
    "openNode",
    "setUserData",
    "getAction",
    "resetAction",
    "console",
    "assert",
    "setAction",
    "onDrop",
    "clone",
    "getDisplayName",
    "moveAfter",
    "snackbar",
    "Controller",
    "info",
    "insertAfter",
    "moveBefore",
    "insertBefore",
    "moveInside",
    "insertChild",
    "onDragEnd",
    "resetUserData",
    "resetDragging",
    "children",
    "sorting",
    "minPosition",
    "targetIndex",
    "indexOf",
    "found",
    "sibling",
    "name",
    "hasOwnProperty",
    "typeChooserForm",
    "ElementForm",
    "allowCancel",
    "context",
    "message",
    "formData",
    "type",
    "help",
    "options",
    "sort",
    "a",
    "b",
    "localeCompare",
    "map",
    "validation",
    "required",
    "show",
    "promise",
    "then",
    "ownerDocument",
    "isElement",
    "createComment",
    "createTextNode",
    "createCDATASection",
    "createElement",
    "schemaElement",
    "getSchemaElementForElementName",
    "initChildren",
    "requiredChildren",
    "getRequiredElements",
    "schema",
    "Element",
    "sortChildNodes",
    "childName",
    "child",
    "appendChild",
    "isTextContentRequired",
    "xmlElement",
    "XmlElement",
    "getEditor",
    "res",
    "isShowEditButton",
    "setSelection",
    "err",
    "targetName",
    "depth",
    "currentPosition",
    "split",
    "test",
    "parseInt",
    "min",
    "__checkProvider",
    "provider",
    "Provider",
    "getLive",
    "userInputAllowed",
    "includes",
    "endsWith",
    "isArray",
    "unshift",
    "__getAttributeFormDefinition",
    "attribute",
    "docs",
    "getDocumentation",
    "def",
    "join",
    "enabled",
    "getDefaultValue",
    "isOptional",
    "validator",
    "ListItem",
    "getValue",
    "isValueValid",
    "ValidationError",
    "getTypeString",
    "enums",
    "getEnumeration",
    "title",
    "caption",
    "isWriteable",
    "getShowEditButton",
    "typeElement",
    "nodeType",
    "Node",
    "ELEMENT_NODE",
    "allowed",
    "getAllowedAttributes",
    "getExpert",
    "appInfo",
    "getAppinfo",
    "TEXT_NODE",
    "COMMENT_NODE",
    "CDATA_SECTION_NODE",
    "nodeName",
    "lines",
    "autoSize",
    "getTextContent",
    "isTextNode",
    "convertTextNodeType",
    "newNodeName",
    "formDialog",
    "maxWidth",
    "setAttributes",
    "validate",
    "destroy",
    "remove",
    "setClipboard",
    "copy",
    "clipboardElement",
    "getClipboard",
    "resetClipboard",
    "updateModified",
    "previewIndex",
    "$$removed",
    "splice",
    "isModified",
    "setModified",
    "_onContentChanged",
    "_createChildControl",
    "addSeparator",
    "addSpacer",
    "_applySelected",
    "_updateHighlightWidget",
    "node",
    "parentNode",
    "openPage",
    "setHighlightWidget",
    "getWidgetPath",
    "isVisible",
    "_applyContent",
    "open",
    "initialValidation",
    "modified",
    "validateXmlConfig",
    "getPath",
    "__loadContent",
    "Main",
    "closeFile",
    "Bus",
    "dispatchByName",
    "getFullPath",
    "handler",
    "jumpToError",
    "hide",
    "resetModel",
    "errors",
    "xml",
    "Document",
    "fromString",
    "getElementNode",
    "documentElement",
    "setEditable",
    "getWriteable",
    "setModel",
    "setContentPaddingBottom",
    "isTemporary",
    "parts",
    "substr",
    "part",
    "shift",
    "match",
    "exec",
    "e",
    "toString",
    "setValid",
    "content",
    "getCurrentContent",
    "contentChanged",
    "isAutoRefreshPreview",
    "reset",
    "previewFile",
    "_client",
    "updateSync",
    "getBusTopic",
    "source",
    "fast",
    "XMLSerializer",
    "serializeToString",
    "_prettify",
    "level",
    "singleton",
    "tabs",
    "fill",
    "newLine",
    "textContent",
    "trim",
    "String",
    "escape",
    "output",
    "attributes",
    "childNodes",
    "onlyOneTextChild",
    "_onSaved",
    "onSaved",
    "focusedWidget",
    "FocusHandler",
    "getFocusedWidget",
    "dialogConf",
    "modal",
    "maxHeight",
    "getHeight",
    "BigAlert",
    "destruct",
    "_disposeArray",
    "removeListener"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n    this._initWorker();\n\n    // init schema\n    this._schema = cv.ui.manager.model.Schema.getInstance('visu_config.xsd');\n    this._schema.onLoaded(function () {\n      this.setReady(true);\n      this._draw();\n    }, this);\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', (ev) => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    }, this);\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener(\"keyup\", this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schema: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n\n    isPreviewSynced: function () {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions: function () {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility: function () {\n      const handlerOptions = this.getHandlerOptions();\n      this.setShowPreview(qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview));\n    },\n\n    _applyShowPreview: function (value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({flex: 1});\n        }\n      }\n      if (value && this.getFile()) {\n        const preview = this.getChildControl('preview');\n        if (!preview.getFile()) {\n          const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', this.getFile().getParent());\n          preview.setFile(previewConfig);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName) && !this.__editing) {\n        switch (actionName) {\n          case 'undo':\n            this.undo();\n            break;\n\n          case 'redo':\n            this.redo();\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            this._showHelp();\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr(\"Undo: %1\", this.getUnDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr(\"Undo: %1\", this.getReDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return value ? !value.isDeletable() : false;\n            }\n          })\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          })\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          })\n          break;\n      }\n    },\n    unConfigureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo: function (elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo: function () {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error(\"could not undo \" + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo: function () {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error(\"could not redo \" + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos: function () {\n      this.getUnDos().removeAll().forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos: function () {\n      this.getReDos().removeAll().forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard: function (value) {\n      if (value) {\n        navigator.clipboard.writeText(value.getNode().outerHTML);\n      } else {\n        navigator.clipboard.writeText('');\n      }\n    },\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors: function (path, errorList) {\n    },\n    showDecorations: function (path, decorators) {\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        this.base(arguments, file, old);\n      } else {\n        this.base(arguments, null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n       var control;\n\n       switch (id) {\n         case 'splitpane':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this._add(control);\n           break;\n\n         case 'left':\n           control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n           this.getChildControl('splitpane').addAt(control, 0);\n           break;\n\n         case 'right':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n           if (!this.isShowPreview()) {\n             control.exclude();\n           }\n           this.getChildControl('splitpane').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview':\n           control = new cv.ui.manager.viewer.Config();\n           control.set({\n             target: 'iframe',\n             minWidth: 600\n           });\n           this.getChildControl('right').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview-sync-hint':\n           const ok = this.tr(\"Preview shows the current state of the edited configuration.\");\n           const noSync = this.tr(\"Preview is out of sync. Click here to refresh.\");\n           const notOk = this.tr(\"Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.\");\n           control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n           control.setRich(true);\n           control.getChildControl('label').setWrap(true);\n           control.addListener(\"tap\", () => {\n             if (!this.isPreviewSynced() && this.isShowPreview()) {\n               this._updatePreview();\n             }\n           }, this);\n           this.getChildControl('right').addAt(control, 0);\n           this.addListener('previewStateChanged', (ev) => {\n             switch (ev.getData()) {\n               case 'synced':\n               control.set({\n                 label: ok,\n                 icon: cv.theme.dark.Images.getIcon('valid', 16)\n               });\n               control.getChildControl(\"icon\").removeState('error');\n                 control.getChildControl(\"icon\").removeState('warning');\n               break;\n\n               case 'changed':\n                 control.set({\n                   label: noSync,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl(\"icon\").removeState('error');\n                 control.getChildControl(\"icon\").addState('warning');\n                 break;\n\n               case 'structureChanged':\n                 control.set({\n                   label: notOk,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl(\"icon\").addState('error');\n                 control.getChildControl(\"icon\").removeState('warning');\n                 break;\n             }\n           }, this);\n           break;\n\n         case 'edit-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n           control.setEnabled(false);\n           control.addListener('execute', this._onEdit, this);\n           this.bind(\"file.writeable\", control, 'icon', {\n             converter: function (value) {\n               return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16)\n             }\n           })\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n           control.setEnabled(false);\n           control.addListener('execute', this._onDelete, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toggle-expert':\n           control = new qx.ui.toolbar.CheckBox(this.tr(\"Expertview\"),\n             cv.theme.dark.Images.getIcon('expert', 16));\n           control.addListener('execute', function () {\n             this.toggleExpert();\n           }, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'refresh-preview':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n           control.setToolTipText(this.tr(\"Reload preview\"));\n           control.addListener('execute', this._updatePreview, this);\n           this.bind('showPreview', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'hidden'\n             }\n           });\n           this.bind('previewState', control, 'enabled', {\n             converter: function (value) {\n               return value !== 'synced';\n             }\n           })\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toolbar':\n           control = new qx.ui.toolbar.ToolBar();\n           this.getChildControl('left').add(control, {\n             top: 0,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar-container':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this.getChildControl('left').add(control, {\n             top: 36,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             placeholder: this.tr(\"Search...\"),\n             margin: 8\n           });\n           control.addListener(\"changeValue\", qx.util.Function.debounce(this._onSearch, 250), this);\n           control.addListener(\"keyup\", function (ev) {\n             switch (ev.getKeyIdentifier()) {\n               case 'Enter':\n               case 'Down':\n                 this._showNextResult();\n                 break;\n               case 'Up':\n                 this._showPreviousResult();\n                 break;\n             }\n             ev.stopPropagation();\n           }, this);\n           this.getChildControl('searchbar-container').add(control, {flex: 1});\n           break;\n\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n           control.set({\n             selectionMode: 'single',\n             width: 350,\n             openMode: 'none',\n             itemHeight: qx.core.Environment.get(\"device.touch\") ? 40 : 20\n           });\n           this.bind(\"file.writeable\", control, \"droppable\");\n           this.bind(\"file.writeable\", control, \"draggable\");\n           this._initDragDrop(control);\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualElementItem();\n               if (!qx.core.Environment.get(\"device.touch\")) {\n                 item.addListener('contextmenu', this._onContextMenu, this);\n               } else {\n                 item.addListener('action', this._onContextMenuAction, this);\n               }\n               item.addListener('dbltap', this._onEdit, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem: function (controller, item, index) {\n               controller.bindProperty(\"\", \"model\", null, item, index);\n               controller.bindProperty(\"displayName\", \"label\", null, item, index);\n               controller.bindProperty(\"name\", \"name\", null, item, index);\n               controller.bindPropertyReverse(\"open\", \"open\", null, item, index);\n               controller.bindProperty(\"open\", \"open\", null, item, index);\n               controller.bindProperty(\"showEditButton\", \"editable\", null, item, index);\n               controller.bindProperty(\"sortable\", \"sortable\", null, item, index);\n               controller.bindProperty(\"icon\", \"icon\", null, item, index);\n               controller.bindProperty(\"status\", 'status', null, item, index);\n               controller.bindProperty(\"invalidMessage\", \"toolTipText\", null, item, index);\n               controller.bindProperty(\"dragging\", \"dragging\", null, item, index);\n             }\n           });\n           control.getSelection().addListener(\"change\", this._onChangeTreeSelection, this);\n           this.getChildControl('left').add(control, {\n             top: 72,\n             left: 0,\n             right: 0,\n             bottom: 0\n           });\n           break;\n\n         case 'add-button':\n           control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n           control.setDraggable(true);\n           control.setMarginLeft(-16);\n           control.setZIndex(20);\n           this.addListener('changeDragging', ev => {\n             control.setLayoutProperties({\n               bottom: 16,\n               left: ev.getData() ? -1000 : \"50%\"\n             });\n           }, this);\n           control.setAppearance(\"round-button\");\n           control.addListener(\"pointerover\", () => control.addState(\"hovered\"));\n           control.addListener(\"pointerout\", () => control.removeState(\"hovered\"));\n           control.addListener(\"tap\", () => {\n             if (this.getSelected()) {\n               this._onCreate(this.getSelected(), 'inside');\n             } else {\n               qxl.dialog.Dialog.alert(this.tr(\"Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.\"));\n             }\n           }, this);\n           this.getChildControl(\"left\").add(control, {\n             bottom: 16,\n             left: \"50%\"\n           });\n           break;\n\n         case 'drag-indicator':\n           // Create drag indicator\n           control = new qx.ui.core.Widget();\n           control.setDecorator(new qx.ui.decoration.Decorator().set({\n             widthTop: 1,\n             styleTop: \"solid\",\n             colorTop: \"white\"\n           }));\n           control.setHeight(0);\n           control.setOpacity(0.5);\n           control.setZIndex(100);\n           control.setDroppable(true);\n           control.setLayoutProperties({left: -1000, top: -1000});\n           qx.core.Init.getApplication().getRoot().add(control);\n           break;\n\n         case 'context-menu':\n           control = new cv.ui.manager.contextmenu.ConfigElement(this);\n           control.addListener('action', this._onContextMenuAction, this);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    _onContextMenu: function (ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction: function (ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, \"inside\");\n            break;\n\n          default:\n            this.error(\"unhandled context menu action\", data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n\n    openByQuerySelector: function (selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch: function (ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || el.hasAttribute(\"name\") && el.getAttribute(\"name\").startsWith(value);\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult: function () {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult: function () {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult: function () {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length-1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop: function (control) {\n      let draggedXmlElement;\n      control.addListener(\"dragstart\", function (ev) {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction(\"copy\");\n          if (element.isDeletable()) {\n            ev.addAction(\"move\");\n          }\n          ev.addType(\"cv/tree-element\");\n          ev.addData(\"cv/tree-element\", element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      }, this);\n\n      const addButton = this.getChildControl(\"add-button\");\n      addButton.addListener(\"dragstart\", function (ev) {\n        ev.addAction(\"copy\");\n        ev.addType(\"cv/new-tree-element\");\n        this.setDragging(true);\n      }, this);\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      }\n\n      control.addListener(\"dragover\", function (ev) {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType(\"cv/tree-element\")) {\n          element = ev.getData(\"cv/tree-element\");\n        }\n        const addNew = action === \"copy\" && !element && ev.supportsType(\"cv/new-tree-element\");\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug(\"dragging over indicator\");\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem ) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug(\"dropping on same element forbidden\");\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug(\"moving inside own subtree forbidden\");\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && (ev.getDocumentTop() - layerContent.bottom <= 20)) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(Math.round((layerContent.left + layerContent.right) / 2), layerContent.bottom - 20);\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug(\"drop target not found\");\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug(\"drop not allowed here, no drag element\");\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n                    if ((acc & Allowed.BEFORE) && (acc & Allowed.AFTER)) {\n                      // we cannot find more\n                      return true;\n                    }\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug(\"no children allowed here\");\n            }\n          } else {\n            if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n              // not allowed on this level\n              accepted.mode = Allowed.NONE;\n              this.debug(\"not allowed as child element of\", parent.getName());\n            } else if (parentSchemaElement.areChildrenSortable()) {\n              // children can be put anywhere\n              // so this is allowed anywhere\n              accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n            } else {\n              // check position\n              accepted.mode = this.__getAllowedPositions(parentSchemaElement.getAllowedElementsSorting(), element.getName(), model.getName());\n            }\n          }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug(\"dropping not accepted here\");\n        }\n      }, this);\n\n      const indicator = this.getChildControl(\"drag-indicator\");\n\n      let expandTimer;\n\n      control.addListener(\"dragleave\", function (ev) {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      }, this);\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = \"\";\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = \"after\";\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if ((ev.getDocumentTop() - origCoords.top) <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = \"before\";\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = \"inside\";\n              }\n            } else if ((origCoords.bottom - ev.getDocumentTop()) <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = \"after\";\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = \"inside\";\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = \"first-child\";\n                } else {\n                  this.debug(\"not allowed as first child\");\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData(\"position\") !== \"first-child\") {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = \"first-child\";\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = \"inside\";\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(function () {\n                    if (accepted.target) {\n                      control.openNode(accepted.target);\n                    }\n                  }, this, 1000);\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData(\"position\", position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData(\"action\", ev.getCurrentAction());\n          cursor.resetAction();\n          console.assert(left < 0);\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData(\"action\")) {\n          cursor.setAction(indicator.getUserData(\"action\"));\n          indicator.setUserData(\"action\", null);\n        }\n      }\n      control.addListener(\"drag\", onDrag, this);\n      addButton.addListener(\"drag\", onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction()\n        let element = ev.supportsType(\"cv/tree-element\") ? ev.getData(\"cv/tree-element\") : null;\n        if (action === \"copy\") {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = \"add\";\n          }\n        }\n        const elementName = element ? element.getDisplayName() : \"new\";\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData(\"position\")) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, \"after\", target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", action, elementName, \"after\", target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, \"before\", target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", action, elementName, \"after\", target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, \"into\", target.getDisplayName(), \"as first child\");\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", elementName, \"into\", target.getDisplayName() + \" as first child\");\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, \"into\", target.getDisplayName(), \"as child\");\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", elementName, \"into\", target.getDisplayName(), \"as child\");\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener(\"drop\", onDrop, this);\n      indicator.addListener(\"drop\", onDrop, this);\n\n      const onDragEnd = function(ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener(\"dragend\", onDragEnd, this);\n      addButton.addListener(\"dragend\", onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate: function (target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex-1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(name => sorting.hasOwnProperty(name) && sorting[name] <= maxPosition && sorting[name] >= minPosition);\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr(\"<p style='font-weight:bold'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>\"),\n            formData: {\n              type: {\n                type: \"SelectBox\",\n                label: this.tr(\"Choose element\"),\n                help: this.tr(\"Please choose the element you want to add here.\"),\n                options: addable.sort((a, b) => {\n                  if (a.startsWith('#') && !b.startsWith('#')) {\n                    return 1;\n                  } else if (!a.startsWith('#') && b.startsWith('#')) {\n                    return -1;\n                  }\n                  return a.localeCompare(b);\n                }).map(name => ({label: name, value: name})),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          }).show().promise();\n        } else {\n          typeChooserForm = Promise.resolve({type: addable[0]});\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment(\"\");\n                break;\n\n              case '#text':\n                element = document.createTextNode(\"\");\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection(\"\");\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode(\"-\");\n                element.appendChild(child);\n              }\n            }\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement,\n                this.tr(\"Create new %1 element\", xmlElement.getName()),\n                this.tr(\"Please edit the attributes of the new %1 element, that will be added to the chosen position.\", xmlElement.getName())\n              );\n            }\n            res.then((data) => {\n              if (data) {\n                // finally insert the new node\n                switch (position) {\n                  case 'before':\n                    xmlElement.insertBefore(target);\n                    break;\n\n                  case 'after':\n                    xmlElement.insertAfter(target);\n                    break;\n\n                  case 'inside':\n                    target.insertChild(xmlElement, -1, false, 'added');\n                    break;\n\n                  case 'first-child':\n                    target.insertChild(xmlElement, 0, false, 'added');\n                    break;\n                }\n                this.getChildControl('tree').openNodeAndParents(xmlElement);\n                this.getChildControl('tree').setSelection([xmlElement]);\n              }\n            }, this).catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions: function (allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === \"string\") {\n          currentPosition = currentPosition.split(\".\").map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === \"string\") {\n          targetPosition = targetPosition.split(\".\").map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length)\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n        return cv.ui.manager.editor.Tree.Allowed.NONE;\n      }\n    },\n\n    __checkProvider: function (id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error(\"misconfigured provider found for \" + id);\n        }\n        formData.type = provider.userInputAllowed ? \"VirtualComboBox\" : \"VirtualSelectBox\";\n      } else if ([\"mapping\", \"styling\"].includes(id.split(\"@\").pop())) {\n        const type = id.split(\"@\").pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = \"SelectBox\";\n        formData.options = [];\n        rootNode.querySelectorAll(\"meta > \" + type + \"s > \" + type).forEach(element => {\n          const name = element.getAttribute(\"name\");\n          formData.options.push({label: name, value: name});\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options.then(res => {\n              if (Array.isArray(res)) {\n                res.unshift({label: \" - \" + this.tr(\"not set\") + \" - \", value: \"\"})\n              }\n            }).catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({label: \" - \" + this.tr(\"not set\") + \" - \", value: \"\"});\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition: function (element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: \"TextField\",\n        label: attribute.getName(),\n        placeholder: \" - \" + this.tr(\"not set\") + \" - \",\n        help: docs.join(\"<br/>\"),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator: function (value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr(\"This is not a valid value.\"));\n            }\n          }\n        }\n      }\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = \"CheckBox\";\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string':\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = \"SelectBox\";\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({label: name, value: name});\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({label: \" - \" + this.tr(\"not set\") + \" - \", value: \"\"});\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + \"@\" + attribute.getName(), def, element.getNode());\n          }\n          break;\n      }\n      return def;\n    },\n\n    _onEdit: function (ev, element, title, caption) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return;\n      }\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (!element.getShowEditButton()) {\n        return;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n      } else if (element.getNode().nodeType === Node.TEXT_NODE || element.getNode().nodeType === Node.COMMENT_NODE || element.getNode().nodeType === Node.CDATA_SECTION_NODE) {\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: \"TextArea\",\n          label: \"\",\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr(\"not set\"),\n          help: docs.join(\"<br/>\"),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator: function (value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr(\"This is not a valid value.\"));\n              }\n            }\n          }\n        }\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute(\"type\");\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(element.getParent().getName() + \"@\" + element.getName(), formData[nodeName], element.getNode());\n      }\n      this.__editing = true;\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption:  title || this.tr(\"Edit element attributes\"),\n        message: caption ? caption : (element.isEditable() ? this.tr(\"Edit %1\", element.getName()) : this.tr(\"Show %1\", element.getName())),\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          element.validate();\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete: function (ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n    },\n\n    _onCut: function () {\n      const element = this._onDelete();\n      if (element) {\n        this.setClipboard(element);\n      }\n    },\n\n    _onCopy: function () {\n      const element = this.getSelected();\n      if (element) {\n        const copy = element.clone();\n        this.setClipboard(copy);\n      }\n    },\n\n    _onPaste: function () {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified: function (element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else {\n        if (element.isModified()) {\n          if (index === -1) {\n            this.__modifiedElements.push(element);\n          }\n          if (previewIndex === -1) {\n            this.__modifiedPreviewElements.push(element);\n          }\n        } else {\n          if (index >= 0) {\n            this.__modifiedElements.splice(index, 1);\n          }\n          if (previewIndex >= 0) {\n            this.__modifiedPreviewElements.splice(index, 1);\n          }\n        }\n      }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw: function () {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget: function () {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          while (node && node.nodeName !== 'pages') {\n            if (node.nodeName === 'page') {\n              path.unshift(node.getAttribute(\"name\"));\n            }\n            node = node.parentNode;\n          }\n          if (path.length > 0) {\n            preview.openPage(path.pop(), path.join(\"/\"));\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp: function(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === \"Enter\") {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent: function(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + \" is a valid config file\");\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n              dialog.addListener('action', (ev) => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source':\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: \"cv.ui.manager.editor.Source\",\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n                    break;\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n                dialog.hide();\n                dialog.destroy();\n              }, this);\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __loadContent: function (value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const document = qx.xml.Document.fromString(value);\n        const schemaElement = this._schema.getElementNode(document.documentElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(document.documentElement, schemaElement, this);\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n          // extra space fr add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (!preview.getFile()) {\n            const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', file.getParent());\n            preview.setFile(previewConfig);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split(\"/\");\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error(\"Error loading \" + current.getName() + \": \" + e.toString());\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error(\"patch segment format error: \" + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      }\n    },\n\n    _onContentChanged: function () {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview: function (ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        this._client.updateSync({\n          path: previewFile.getFullPath(),\n          hash: 'ignore'\n        }, content, () => {\n          qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n            type: 'contentChanged',\n            file: previewFile,\n            data: content,\n            source: this\n          });\n          this.__modifiedPreviewElements.removeAll();\n          this.resetPreviewState();\n        }, this);\n      }\n    },\n\n    getCurrentContent: function (fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        } else {\n          // prettify content\n          return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n` + this._prettify(rootNode, 0);\n        }\n      } else {\n        return null;\n      }\n    },\n\n    _prettify: function (node, level, singleton) {\n      let tabs = Array(level + 1).fill('').join('\\t')\n      let newLine = '\\n';\n      if (node.nodeType === Node.TEXT_NODE) {\n        if (node.textContent.trim()) {\n          return (singleton ? '' : tabs) + qx.xml.String.escape(node.textContent.trim()) + (singleton ? '' : newLine);\n        } else {\n          return '';\n        }\n      }\n      if (node.nodeType === Node.COMMENT_NODE) {\n        return (singleton ? '' : tabs) + `<!--${node.textContent}--> ${(singleton ? '' : newLine)}`;\n      } else if (node.nodeType === Node.CDATA_SECTION_NODE) {\n        return (singleton ? '' : tabs) + `<![CDATA[${node.textContent}]]> ${(singleton ? '' : newLine)}`;\n      }\n      if (!node.tagName) {\n        return this._prettify(node.firstChild, level);\n      }\n      let output = tabs + `<${node.tagName}`; // >\\n\n      for (let i = 0; i < node.attributes.length; i++) {\n        output += ` ${node.attributes[i].name}=\"${node.attributes[i].value}\"`;\n      }\n      if (node.childNodes.length === 0) {\n        return output + ' />' + newLine;\n      } else {\n        output += '>';\n      }\n      let onlyOneTextChild = ((node.childNodes.length === 1) && (node.childNodes[0].nodeType === 3));\n      if (!onlyOneTextChild) {\n        output += newLine;\n      }\n      for (let i = 0; i < node.childNodes.length; i++) {\n        output += this._prettify(node.childNodes[i], level + 1, onlyOneTextChild);\n      }\n      return output + (onlyOneTextChild ? '' : tabs) + `</${node.tagName}>` + newLine;\n    },\n\n    _onSaved: function () {\n      this.base(arguments);\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported: function (file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp: function () {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr(\"Help\"),\n        modal: true,\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: \"\"\n      }\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr(\"<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with 'Enter' or the 'Down' key. Accordingly you can jump the the previous found element \\\nwith the 'Up' key.</p>\");\n      } else {\n        // show general help\n        dialogConf.message = this.tr(\"<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the 'edit'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the 'edit'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the 'add child'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the 'Expertview'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>\");\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._schema = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener(\"keyup\", this._onElementKeyUp, this);\n  }\n});\n"
  ]
}