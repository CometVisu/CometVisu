{
  "version": 3,
  "sources": [
    "/home/travis/build/CometVisu/CometVisu/source/class/cv/data/FileWorker.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "_files",
    "_worker",
    "Worker",
    "util",
    "ResourceManager",
    "getInstance",
    "toUri",
    "onmessage",
    "_onMessage",
    "bind",
    "_validationCallbacks",
    "events",
    "message",
    "members",
    "postMessage",
    "msg",
    "validateConfig",
    "url",
    "Promise",
    "resolve",
    "reject",
    "hasOwnProperty",
    "path",
    "push",
    "e",
    "topic",
    "data",
    "shift",
    "callbacks",
    "forEach",
    "cb",
    "fireDataEvent",
    "destruct",
    "cv",
    "FileWorker"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * Worker script that handles file related operations like modification checking or xml validation\n */\nqx.Class.define('cv.data.FileWorker', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._files = [];\n    this._worker = new Worker(qx.util.ResourceManager.getInstance().toUri('manager/worker.js'));\n    this._worker.onmessage = this._onMessage.bind(this);\n    this._validationCallbacks = {};\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    message: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _worker: null,\n    _validationCallbacks: null,\n\n    postMessage: function (msg) {\n      this._worker.postMessage(msg);\n    },\n\n    validateConfig: function (url) {\n      return new Promise(function (resolve, reject) {\n        // check if there is already one validation request ongoing\n        if (!this._validationCallbacks.hasOwnProperty(url)) {\n          this._validationCallbacks[url] = [resolve];\n          this._worker.postMessage([\"validateConfig\", {\n            path: url\n          }]);\n        } else {\n          this._validationCallbacks[url].push(resolve);\n        }\n      }.bind(this));\n    },\n\n    _onMessage: function (e) {\n      let topic = e.data.shift();\n      let data = e.data.shift();\n      let path = e.data.shift();\n      switch(topic) {\n        case 'validationResult':\n          if (this._validationCallbacks.hasOwnProperty(path)) {\n            const callbacks = this._validationCallbacks[path];\n            delete this._validationCallbacks[path];\n            callbacks.forEach(function(cb) {\n              cb(data);\n            });\n          }\n          break;\n      }\n      this.fireDataEvent('message', {\n        topic: topic,\n        data: data,\n        path: path\n      })\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._worker = null;\n  }\n});\n"
  ]
}