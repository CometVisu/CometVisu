{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/core/notifications/Router.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "__routes",
    "debug",
    "__dateFormat",
    "util",
    "format",
    "DateFormat",
    "locale",
    "Date",
    "getDateFormat",
    "__timeFormat",
    "getTimeFormat",
    "statics",
    "evaluateCondition",
    "message",
    "prototype",
    "hasOwnProperty",
    "call",
    "condition",
    "log",
    "Logger",
    "error",
    "dispatchMessage",
    "topic",
    "target",
    "getInstance",
    "getTarget",
    "name",
    "cv",
    "ui",
    "PopupHandler",
    "NotificationCenter",
    "window",
    "speechSynthesis",
    "warn",
    "notifications",
    "SpeechHandler",
    "ToastManager",
    "members",
    "__stateMessageConfig",
    "getStateMessageConfig",
    "registerStateUpdateHandler",
    "config",
    "getOwnPropertyNames",
    "forEach",
    "address",
    "data",
    "Model",
    "addUpdateListener",
    "_onIncomingData",
    "unregisterStateUpdatehandler",
    "addresses",
    "removeUpdateListener",
    "registerMessageHandler",
    "handler",
    "topics",
    "segments",
    "split",
    "firstSegment",
    "shift",
    "currentSegment",
    "__handlers__",
    "segment",
    "push",
    "state",
    "initial",
    "changed",
    "now",
    "formattedDate",
    "formattedTime",
    "skipInitial",
    "Transform",
    "decode",
    "addressConfig",
    "templateData",
    "value",
    "date",
    "time",
    "valueMapping",
    "common",
    "BasicUpdate",
    "applyMapping",
    "addressMapping",
    "title",
    "bom",
    "Template",
    "render",
    "titleTemplate",
    "messageTemplate",
    "deletable",
    "unique",
    "severity",
    "icon",
    "iconClasses",
    "__collectHandlers",
    "handlers",
    "Array",
    "last",
    "length",
    "some",
    "segmentName",
    "idx",
    "__collectAllFromSegment",
    "append",
    "Router",
    "handleMessage",
    "entry",
    "clear",
    "destruct",
    "_disposeObjects"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Router.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Global notification handler that routes messages topic-dependent to different {@link cv.core.notifications.IHandler}\n * (e.g. NotificationCenter, Dialog, Toast, console.log, native notification, internal message bus ...)\n *\n * @author Tobias Br√§utigam\n * @since 0.11.0\n */\nqx.Class.define('cv.core.notifications.Router', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function() {\n    this.base(arguments);\n    this.__routes = {};\n    this.debug('new router');\n\n    this.__dateFormat = new qx.util.format.DateFormat(qx.locale.Date.getDateFormat('short'));\n    this.__timeFormat = new qx.util.format.DateFormat(qx.locale.Date.getTimeFormat('short'));\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Evaluate the message condition, default to true is message has no condition set\n     * @param message {Map}\n     * @returns {Boolean}\n     */\n    evaluateCondition: function(message) {\n      if (!Object.prototype.hasOwnProperty.call(message, 'condition')) {\n        // nothing to evaluate\n        return true;\n      } else if (typeof message.condition === 'boolean') {\n        return message.condition;\n      } else if (typeof message.condition === 'function') {\n        return message.condition();\n      } \n      qx.log.Logger.error(this, 'unhandled message condition type: '+message.condition);\n      return false;\n    },\n\n    /**\n     * Shortcut to {@link cv.core.notifications.Router#dispatchMessage}\n     * @param topic\n     * @param message\n     * @param target\n     */\n    dispatchMessage: function(topic, message, target) {\n      return this.getInstance().dispatchMessage(topic, message, target);\n    },\n\n    /**\n     * Converts a target name to the related target object/function.\n     *\n     * @param name {String} target name, e.g. popup, notificationCenter, etc.\n     * @return {Object|Function|null} the target that can handle messages\n     */\n    getTarget: function(name) {\n      switch (name) {\n        case 'popup':\n          return cv.ui.PopupHandler;\n        case 'notificationCenter':\n          return cv.ui.NotificationCenter.getInstance();\n        case 'speech':\n          if (!window.speechSynthesis) {\n            // not supported\n            qx.log.Logger.warn(this, 'this browser does not support the Web Speech API');\n            return null;\n          }\n          return cv.core.notifications.SpeechHandler.getInstance();\n        case 'toast':\n          return cv.ui.ToastManager.getInstance();\n      }\n      return null;\n    }\n  },\n\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n  members: {\n    __routes: null,\n    __stateMessageConfig: null,\n    __dateFormat: null,\n    __timeFormat: null,\n\n    getStateMessageConfig: function () {\n      return this.__stateMessageConfig;\n    },\n\n    /**\n     * Register state update handler for one or more addresses.\n     *\n     * <h4>Config Map explanation:</h4>\n     * <pre class=\"javascript\">\n     * {\n     *   <address>: [{\n     *    topic: \"cv.state.<address>\", // message topic used for routing\n     *    target: \"popup\", // where to show the message\n     *    severity: \"normal\", // message severity e.g. high, normal, low\n     *    skipInitial: true, // do not show message for initial state update\n     *    deletable: true, // user can delete this message\n     *    unique: true, // show message once at a time\n     *    valueMapping: \"mapping-name\", // optional mapping for value\n     *    addressMapping: \"mapping-name\", // optional mapping name for address\n     *    titleTemplate: \"Kitchen light on\", // title template of the message\n     *    messageTemplate: \"turned on at {{ time }} o'clock\", // message content template\n     *    condition: 1 // show only when the value equals the condition value\n     *   }]\n     * }\n     * </pre>\n     *\n     * @param config {Map}\n     */\n    registerStateUpdateHandler: function(config) {\n      this.__stateMessageConfig = config;\n      Object.getOwnPropertyNames(this.__stateMessageConfig).forEach(function(address) {\n        cv.data.Model.getInstance().addUpdateListener(address, this._onIncomingData, this);\n      }, this);\n    },\n\n    /**\n     * Unregister state update listeners for a list of addresses\n     * @param addresses {Array}\n     */\n    unregisterStateUpdatehandler: function(addresses) {\n      addresses.forEach(function(address) {\n        cv.data.Model.getInstance().removeUpdateListener(address, this._onIncomingData, this);\n        if (this.__stateMessageConfig[address]) {\n          delete this.__stateMessageConfig[address];\n        }\n      }, this);\n    },\n\n    /**\n     * Register a handler for a list of topics\n     * @param handler {cv.core.notifications.IHandler}\n     * @param topics {Map} map of topics as key and configuration-maps as values\n     */\n    registerMessageHandler: function(handler, topics) {\n      Object.getOwnPropertyNames(topics).forEach(function(topic) {\n        const segments = topic.split('.');\n        const firstSegment = segments.shift();\n        let currentSegment = this.__routes[firstSegment];\n        if (!currentSegment) {\n          this.__routes[firstSegment] = {__handlers__: []};\n          currentSegment = this.__routes[firstSegment];\n        }\n        segments.forEach(function(segment) {\n          if (!currentSegment[segment]) {\n            currentSegment[segment] = {__handlers__: []};\n          }\n          currentSegment = currentSegment[segment];\n        }, this);\n\n        currentSegment.__handlers__.push({\n          handler: handler,\n          config: topics[topic]\n        });\n      }, this);\n    },\n\n    /**\n     * Handle address state updates and show them as message\n     * @param address {String} GA or openHAB item name\n     * @param state {var} received State\n     * @param initial {Boolean} true id this is the first state update for this address\n     * @param changed {Boolean} true if the incoming state update differs from the last one\n     * @protected\n     */\n    _onIncomingData: function(address, state, initial, changed) {\n      if (!this.__stateMessageConfig[address]) {\n        return;\n      }\n\n      const now = new Date();\n      const formattedDate = this.__dateFormat.format(now);\n      const formattedTime = this.__timeFormat.format(now);\n\n      this.__stateMessageConfig[address].forEach(function(config) {\n        if (initial === true && config.skipInitial === true || changed === false) {\n          // do not handle the first update\n          return;\n        }\n\n        // process value\n        state = cv.Transform.decode(config.addressConfig, state);\n\n        const templateData = {\n          address: address,\n          value: state,\n          date: formattedDate,\n          time: formattedTime\n        };\n\n        // transform the raw value to a JavaScript type\n        templateData.value = cv.Transform.decode(config.addressConfig, templateData.value);\n        if (config.valueMapping) {\n          // apply mapping\n          templateData.value = cv.ui.common.BasicUpdate.applyMapping(templateData.value, config.valueMapping);\n        }\n        if (config.addressMapping) {\n          templateData.address = cv.ui.common.BasicUpdate.applyMapping(templateData.address, config.addressMapping);\n        }\n\n        const message = {\n          topic: Object.prototype.hasOwnProperty.call(config, 'topic') ? config.topic : 'cv.state.update.' + address,\n          title: qx.bom.Template.render('' + config.titleTemplate, templateData),\n          message: qx.bom.Template.render('' + config.messageTemplate, templateData),\n          deletable: Object.prototype.hasOwnProperty.call(config, 'deletable') ? config.deletable : true,\n          unique: Object.prototype.hasOwnProperty.call(config, 'unique') ? config.unique : false,\n          severity: config.severity\n        };\n        if (Object.prototype.hasOwnProperty.call(config, 'condition')) {\n          message.condition = state == config.condition; // jshint ignore:line\n        }\n        if (config.icon) {\n          message.icon = config.icon;\n          if (config.iconClasses) {\n            message.iconClasses = config.iconClasses;\n          }\n        }\n        this.dispatchMessage(message.topic, message, config.target);\n      }, this);\n    },\n\n    __collectHandlers: function(topic) {\n      const handlers = new qx.data.Array();\n      const segments = topic.split('.');\n      const firstSegment = segments.shift();\n      let currentSegment = this.__routes[firstSegment];\n      const last = segments.length - 1;\n      segments.some(function (segmentName, idx) {\n        if (!currentSegment) {\n          // segment does not exists, stop searching\n          return true;\n        } else if (segmentName === '*') {\n          // collect all\n          this.__collectAllFromSegment(currentSegment, handlers);\n          return true;\n        }\n        if (currentSegment['*']) {\n          handlers.append(currentSegment['*'].__handlers__);\n        }\n        if (currentSegment[segmentName]) {\n          if (idx === last) {\n            handlers.append(currentSegment[segmentName].__handlers__);\n          }\n          currentSegment = currentSegment[segmentName];\n        } else {\n          // stop searching\n          return true;\n        }\n        return false;\n      }, this);\n      return handlers;\n    },\n\n    __collectAllFromSegment: function(segment, handlers) {\n      handlers.append(segment.__handlers__);\n      Object.getOwnPropertyNames(segment).forEach(function(segmentName) {\n        if (segmentName !== '__handlers__') {\n          this.__collectAllFromSegment(segment[segmentName], handlers);\n        }\n      }, this);\n      return handlers;\n    },\n\n    dispatchMessage: function(topic, message, target) {\n      if (message.target && !target) {\n        target = cv.core.notifications.Router.getTarget(message.target);\n      }\n      if (target && target.handleMessage) {\n        this.debug('dispatching \\'' + topic + '\\' message to handler: ' + target);\n        target.handleMessage(message, {});\n      } else {\n        this.__collectHandlers(topic).forEach(function (entry) {\n          this.debug('dispatching \\'' + topic + '\\' message to handler: ' + entry.handler);\n          entry.handler.handleMessage(message, entry.config);\n        }, this);\n      }\n    },\n\n    clear: function() {\n      this.__routes = {};\n      this.__stateMessageConfig = {};\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this.clear();\n    this._disposeObjects('__dateFormat', '__timeFormat');\n  }\n});\n"
  ]
}