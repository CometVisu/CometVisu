{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/io/Mockup.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "cv",
    "io",
    "IClient",
    "construct",
    "Client",
    "CLIENTS",
    "push",
    "window",
    "_receive",
    "receive",
    "bind",
    "model",
    "data",
    "Model",
    "getInstance",
    "_widgetDataGet",
    "getWidgetData",
    "_getWidgetDataModel",
    "getWidgetDataModel",
    "writeHistory",
    "testMode",
    "__loadTestData",
    "addresses",
    "properties",
    "dataReceived",
    "check",
    "init",
    "server",
    "connected",
    "event",
    "members",
    "backendName",
    "__xhr",
    "__sequence",
    "__sequenceIndex",
    "__simulations",
    "r",
    "request",
    "Xhr",
    "addListener",
    "e",
    "Config",
    "initialDemoData",
    "getTarget",
    "getResponse",
    "__applyTestData",
    "send",
    "xhr",
    "dev",
    "FakeServer",
    "addFilter",
    "method",
    "url",
    "startsWith",
    "getFakeServer",
    "respondWith",
    "report",
    "Record",
    "normalizeUrl",
    "indexOf",
    "replace",
    "length",
    "log",
    "Logger",
    "error",
    "debug",
    "response",
    "shift",
    "readyState",
    "status",
    "respond",
    "headers",
    "JSON",
    "stringify",
    "body",
    "json",
    "forEach",
    "client",
    "update",
    "d",
    "login",
    "loginOnly",
    "credentials",
    "callback",
    "context",
    "call",
    "_registerSimulations",
    "simulations",
    "keys",
    "mainAddress",
    "simulation",
    "hasOwnProperty",
    "additionalAddresses",
    "addr",
    "_startSequence",
    "Timer",
    "once",
    "i",
    "Date",
    "getTime",
    "delay",
    "_processSimulation",
    "address",
    "value",
    "start",
    "stop",
    "startValues",
    "stopValues",
    "type",
    "direction",
    "initValue",
    "getState",
    "targetAddress",
    "undefined",
    "timer",
    "interval",
    "stepSize",
    "newValue",
    "subscribe",
    "write",
    "REPLAYING",
    "ts",
    "answer",
    "restart",
    "getResourcePath",
    "name",
    "getLastError",
    "getBackend",
    "authorize",
    "req",
    "terminate",
    "record",
    "showError",
    "message",
    "args",
    "setInitialAddresses",
    "hasCustomChartsDataProcessor",
    "processChartsData",
    "hasProvider",
    "getProviderUrl",
    "getProviderConvertFunction",
    "format",
    "Mockup"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Mockup.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Mockup simulating a backend + client for the Cometvisu protocol\n *\n * @author Tobias BrÃ¤utigam\n * @since 2016\n */\n/* istanbul ignore next */\nqx.Class.define('cv.io.Mockup', {\n  extend: qx.core.Object,\n  implement: cv.io.IClient,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function() {\n    this.base(arguments);\n    cv.io.Client.CLIENTS.push(this);\n    // make some functions accessible for the protactor runner\n    window._receive = this.receive.bind(this);\n    var model = cv.data.Model.getInstance();\n    window._widgetDataGet = model.getWidgetData.bind(model);\n    window._getWidgetDataModel = model.getWidgetDataModel.bind(model);\n    window.writeHistory = [];\n\n    var testMode = qx.core.Environment.get('cv.testMode');\n    if (typeof testMode === \"string\" && testMode !== \"true\") {\n      this.__loadTestData();\n    }\n    this.addresses = [];\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    dataReceived : {\n      check: \"Boolean\",\n      init: true\n    },\n    server: {\n      check: \"String\",\n      init: \"Mockup\"\n    },\n    connected: {\n      check: \"Boolean\",\n      init: true,\n      event: \"changeConnected\"\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    backendName: 'mockup',\n    addresses: null,\n    __xhr: null,\n    __sequence: null,\n    __sequenceIndex: 0,\n    __simulations: null,\n\n    __loadTestData: function () {\n      // load the demo data to fill the visu with some values\n      var r = new qx.io.request.Xhr(qx.core.Environment.get('cv.testMode'));\n      r.addListener('success', function (e) {\n        cv.Config.initialDemoData = e.getTarget().getResponse();\n        this.__applyTestData();\n      }, this);\n      r.send();\n    },\n\n    __applyTestData: function () {\n      this.__xhr = cv.Config.initialDemoData.xhr;\n      // configure server\n      qx.dev.FakeServer.getInstance().addFilter(function (method, url) {\n        return url.startsWith('https://sentry.io');\n      }, this);\n      var server = qx.dev.FakeServer.getInstance().getFakeServer();\n      server.respondWith(function (request) {\n        var url = cv.report.Record.normalizeUrl(request.url);\n        if (url.indexOf(\"nocache=\") >= 0) {\n          url = url.replace(/[\\?|&]nocache=[0-9]+/, \"\");\n        }\n        if (!this.__xhr[url] || this.__xhr[url].length === 0) {\n          qx.log.Logger.error(this, \"404: no logged responses for URI \" + url + \" found\");\n        } else {\n          qx.log.Logger.debug(this, \"faking response for \" + url);\n          var response = \"\";\n          if (this.__xhr[url].length === 1) {\n            response = this.__xhr[url][0];\n          } else {\n            // multiple responses recorded use them as LIFO stack\n            response = this.__xhr[url].shift();\n          }\n\n          if (request.readyState === 4 && request.status === 404) {\n            // This is a hack, sometimes the request has a 404 status and send readystate\n            // the respond would fail if we do not override it here\n            request.readyState = 1;\n          }\n          request.respond(response.status, response.headers, JSON.stringify(response.body));\n        }\n      }.bind(this));\n    },\n\n    /**\n     * This function gets called once the communication is established and session information is available\n     *\n     */\n    receive: function (json) {\n      if (json) {\n        cv.io.Client.CLIENTS.forEach(function (client) {\n          client.update(json.d);\n        });\n      }\n    },\n\n    login: function (loginOnly, credentials, callback, context) {\n      if (callback) {\n        callback.call(context);\n        if (qx.core.Environment.get('cv.testMode')) {\n          if (cv.Config.initialDemoData) {\n            this.receive({\n              i: new Date().getTime(),\n              d: cv.Config.initialDemoData.states\n            });\n\n            if (cv.Config.initialDemoData.sequence) {\n              this.__sequence = cv.Config.initialDemoData.sequence;\n              this._startSequence();\n            }\n            if (cv.Config.initialDemoData.simulations) {\n              this._registerSimulations(cv.Config.initialDemoData.simulations);\n            }\n            cv.Config.initialDemoData = null;\n          }\n        }\n      }\n    },\n\n    _registerSimulations: function (simulations) {\n      this.__simulations = {};\n      Object.keys(simulations).forEach(function (mainAddress) {\n        var simulation = simulations[mainAddress];\n        this.__simulations[mainAddress] = simulation;\n        if (simulation.hasOwnProperty(\"additionalAddresses\")) {\n          simulation.additionalAddresses.forEach(function (addr) {\n            this.__simulations[addr] = simulation;\n          }, this);\n        }\n      }, this);\n    },\n\n    _startSequence: function () {\n      if (this.__sequence.length <= this.__sequenceIndex) {\n        // start again\n        this.__sequenceIndex = 0;\n      }\n      qx.event.Timer.once(function () {\n        this.receive({\n          i: new Date().getTime(),\n          d: this.__sequence[this.__sequenceIndex].data\n        });\n        this.__sequenceIndex++;\n        this._startSequence();\n      }, this, this.__sequence[this.__sequenceIndex].delay);\n    },\n\n    _processSimulation: function (address, value) {\n      var simulation = this.__simulations[address];\n      if (!simulation) {\n        return;\n      }\n      var start = false;\n      var stop = false;\n      if (simulation.hasOwnProperty('startValues')) {\n        // try the more specific matches with address included\n        start = simulation.startValues.indexOf(address + \"|\" + value) >= 0;\n        if (simulation.hasOwnProperty('stopValues')) {\n          stop = simulation.stopValues.indexOf(address + \"|\" + value) >= 0;\n        }\n        if (!stop) {\n          // the the more general ones\n          start = simulation.startValues.indexOf(value) >= 0;\n          stop = simulation.startValues.indexOf(value) >= 0;\n        }\n      }\n      if (start) {\n        // start simulation\n        if (simulation.type === \"shutter\") {\n          simulation.direction = value === \"0\" ? \"up\" : \"down\";\n          var initValue = cv.data.Model.getInstance().getState(simulation.targetAddress);\n          if (initValue === undefined) {\n            initValue = 0;\n          }\n          simulation.value = initValue;\n\n          if (simulation.timer) {\n            simulation.timer.stop();\n          } else {\n            simulation.timer = new qx.event.Timer(simulation.interval || 100);\n            var stepSize = simulation.stepSize || 10;\n            simulation.timer.addListener(\"interval\", function () {\n              var newValue = simulation.value;\n              if (simulation.direction === \"up\") {\n                // drive up\n                newValue = simulation.value + stepSize;\n                if (newValue > 100) {\n                  simulation.timer.stop();\n                  return;\n                }\n              } else {\n                // drive down\n                newValue = simulation.value - stepSize;\n                if (newValue < 0) {\n                  simulation.timer.stop();\n                  return;\n                }\n              }\n              var update = {\n                i: new Date().getTime(),\n                d: {}\n              };\n              update.d[simulation.targetAddress] = newValue;\n              this.receive(update);\n              if (simulation.value !== newValue) {\n                simulation.value = newValue;\n              }\n            }, this);\n          }\n          simulation.timer.start();\n        }\n      } else if (stop) {\n        // stop simulation\n        if (simulation.timer) {\n          simulation.timer.stop();\n        }\n      }\n    },\n\n    /**\n     * Subscribe to the addresses in the parameter\n     *\n     */\n    subscribe: function (addresses) {\n      this.addresses = addresses ? addresses : [];\n    },\n\n    /**\n     * This function sends a value\n     *\n     */\n    write: function (address, value) {\n      if (cv.report.Record.REPLAYING === true) {\n        // do nothing in replay mode\n        return;\n      }\n      var ts = new Date().getTime();\n      // store in window, to make it accessible for protractor\n      window.writeHistory.push({\n        address: address,\n        value: value,\n        ts: ts\n      });\n\n      if (this.__simulations && this.__simulations.hasOwnProperty(address)) {\n        this._processSimulation(address, value);\n      } else {\n        // send update\n        var answer = {\n          i: ts,\n          d: {}\n        };\n        answer.d[address] = value;\n        this.debug('sending value: ' + value + ' to address: ' + address);\n        this.receive(answer);\n      }\n    },\n\n    restart: function() {},\n\n    stop: function () {},\n\n    getResourcePath: function (name) {\n      return name;\n    },\n\n    getLastError: function () {\n      return null;\n    },\n\n    getBackend: function () {\n      return {};\n    },\n\n    authorize: function (req) {\n    },\n\n    terminate: function () {},\n\n    update: function(json) {},\n    record: function(type, data) {},\n    showError: function(type, message, args) {},\n\n    // not used / needed in this client\n    setInitialAddresses: function(addresses) {\n    },\n\n    hasCustomChartsDataProcessor : function () {\n      return false;\n    },\n    processChartsData : function (data) {\n      return data;\n    },\n    hasProvider: function (name) {\n      return false;\n    },\n    getProviderUrl: function (name) {\n      return null;\n    },\n    getProviderConvertFunction : function (name, format) {\n      return null\n    }\n  }\n});\n"
  ]
}