{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/CalendarList.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "AbstractWidget",
    "include",
    "common",
    "Refresh",
    "properties",
    "width",
    "check",
    "init",
    "height",
    "src",
    "days",
    "nullable",
    "maxquantity",
    "statics",
    "calendars",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "data",
    "parser",
    "WidgetParser",
    "parseElement",
    "getAttributeToPropertyMappings",
    "parseRefresh",
    "querySelectorAll",
    "forEach",
    "cal",
    "calData",
    "type",
    "getAttribute",
    "userid",
    "magiccookie",
    "hasAttribute",
    "push",
    "transform",
    "value",
    "parseInt",
    "members",
    "_getInnerDomString",
    "getPath",
    "getHeight",
    "getWidth",
    "_onDomReady",
    "refreshAction",
    "_setupRefreshAction",
    "_timer",
    "event",
    "Timer",
    "getRefresh",
    "addListener",
    "_refreshAction",
    "start",
    "calendarList",
    "getActor",
    "getSrc",
    "getMaxquantity",
    "plugins",
    "CalendarList",
    "$",
    "calendarListlocal",
    "util",
    "ResourceManager",
    "getInstance",
    "toUri",
    "calendar",
    "defer",
    "addHandler",
    "WidgetFactory",
    "registerClass",
    "jQuery",
    "fn",
    "options",
    "defaults",
    "html",
    "wrapper",
    "dataType",
    "datetime",
    "each",
    "o",
    "c",
    "console",
    "log",
    "formData",
    "i",
    "length",
    "calendarname",
    "ajax",
    "url",
    "error",
    "xhr",
    "status",
    "e",
    "attr",
    "success",
    "result",
    "items",
    "calendarListEntries",
    "itemnum",
    "date",
    "color",
    "format",
    "where",
    "item",
    "itemHtml",
    "ix",
    "calendarName",
    "StartDate",
    "StartTime",
    "EndDate",
    "EndTime",
    "replace",
    "description",
    "$row",
    "append"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAAAA,EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACAH,EAAAA,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,yBAAhB,EAA2C;AACzCC,IAAAA,MAAM,EAAEC,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBC,cADiB;AAEzCC,IAAAA,OAAO,EAAE,CAACJ,EAAE,CAACC,EAAH,CAAMI,MAAN,CAAaC,OAAd,CAFgC;;AAIzC;AACF;AACA;AACA;AACA;AACEC,IAAAA,UAAU,EAAE;AACVC,MAAAA,KAAK,EAAE;AACLC,QAAAA,KAAK,EAAE,QADF;AAELC,QAAAA,IAAI,EAAE;AAFD,OADG;AAKVC,MAAAA,MAAM,EAAE;AACNF,QAAAA,KAAK,EAAE,QADD;AAENC,QAAAA,IAAI,EAAE;AAFA,OALE;AASVE,MAAAA,GAAG,EAAE;AACHH,QAAAA,KAAK,EAAE,QADJ;AAEHC,QAAAA,IAAI,EAAE;AAFH,OATK;AAaVG,MAAAA,IAAI,EAAE;AACJJ,QAAAA,KAAK,EAAE,QADH;AAEJK,QAAAA,QAAQ,EAAE;AAFN,OAbI;AAiBVC,MAAAA,WAAW,EAAE;AACXN,QAAAA,KAAK,EAAE,QADI;AAEXK,QAAAA,QAAQ,EAAE;AAFC;AAjBH,KAT6B;;AAgCzC;AACF;AACA;AACA;AACA;AACEE,IAAAA,OAAO,EAAE;AACPC,MAAAA,SAAS,EAAE,EADJ;;AAGP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,MAAAA,KAAK,EAAE,eAAUC,GAAV,EAAeC,IAAf,EAAqBC,OAArB,EAA8BC,QAA9B,EAAwC;AAC7C,YAAIC,IAAI,GAAGvB,EAAE,CAACwB,MAAH,CAAUC,YAAV,CAAuBC,YAAvB,CAAoC,IAApC,EAA0CP,GAA1C,EAA+CC,IAA/C,EAAqDC,OAArD,EAA8DC,QAA9D,EAAwE,KAAKK,8BAAL,EAAxE,CAAX;AACA3B,QAAAA,EAAE,CAACwB,MAAH,CAAUC,YAAV,CAAuBG,YAAvB,CAAoCT,GAApC,EAAyCC,IAAzC;AACA,aAAKH,SAAL,CAAeG,IAAf,IAAuB,EAAvB;AACAD,QAAAA,GAAG,CAACU,gBAAJ,CAAqB,UAArB,EAAiCC,OAAjC,CAAyC,UAAUC,GAAV,EAAe;AACtD,cAAIC,OAAO,GAAG;AACZC,YAAAA,IAAI,EAAEF,GAAG,CAACG,YAAJ,CAAiB,MAAjB,CADM;AAEZC,YAAAA,MAAM,EAAEJ,GAAG,CAACG,YAAJ,CAAiB,QAAjB,CAFI;AAGZE,YAAAA,WAAW,EAAEL,GAAG,CAACM,YAAJ,CAAiB,aAAjB,IAAkCN,GAAG,CAACG,YAAJ,CAAiB,aAAjB,CAAlC,GAAoE,EAHrE;AAIZrB,YAAAA,IAAI,EAAEkB,GAAG,CAACM,YAAJ,CAAiB,MAAjB,IAA2BN,GAAG,CAACG,YAAJ,CAAiB,MAAjB,CAA3B,GAAsDX,IAAI,CAACV;AAJrD,WAAd;AAMA,eAAKI,SAAL,CAAeG,IAAf,EAAqBkB,IAArB,CAA0BN,OAA1B;AACD,SARD,EAQG,IARH;AASA,eAAOT,IAAP;AACD,OA3BM;AA6BPI,MAAAA,8BAA8B,EAAE,0CAAY;AAC1C,eAAO;AACL,mBAAS;AACPY,YAAAA,SAAS,EAAE,mBAAUC,KAAV,EAAiB;AAC1B,qBAAOA,KAAK,GAAG,WAAWA,KAAX,GAAmB,GAAtB,GAA4B,EAAxC;AACD;AAHM,WADJ;AAML,oBAAU;AACRD,YAAAA,SAAS,EAAE,mBAAUC,KAAV,EAAiB;AAC1B,qBAAOA,KAAK,GAAG,YAAYA,KAAZ,GAAoB,GAAvB,GAA6B,EAAzC;AACD;AAHO,WANL;AAWL,yBAAe;AACbD,YAAAA,SAAS,EAAE,mBAAUC,KAAV,EAAiB;AAC1B,qBAAOA,KAAK,GAAGC,QAAQ,CAACD,KAAD,CAAX,GAAqB,IAAjC;AACD;AAHY,WAXV;AAgBL,kBAAQ;AACND,YAAAA,SAAS,EAAE,mBAAUC,KAAV,EAAiB;AAC1B,qBAAOA,KAAK,GAAGC,QAAQ,CAACD,KAAD,CAAX,GAAqB,IAAjC;AACD;AAHK;AAhBH,SAAP;AAsBD;AApDM,KArCgC;;AA4FzC;AACF;AACA;AACA;AACA;AACEE,IAAAA,OAAO,EAAE;AACPC,MAAAA,kBAAkB,EAAE,8BAAY;AAC9B,eAAO,+FACiD,KAAKC,OAAL,EADjD,GACkE,WADlE,GACgF,KAAKC,SAAL,EADhF,GACmG,KAAKC,QAAL,EADnG,GACqH,UADrH,GAEL,QAFF;AAGD,OALM;AAOPC,MAAAA,WAAW,EAAE,uBAAY;AACvB;;AACA,aAAKC,aAAL;AACD,OAVM;AAYPC,MAAAA,mBAAmB,EAAE,+BAAW;AAC9B,aAAKC,MAAL,GAAc,IAAIzD,EAAE,CAAC0D,KAAH,CAASC,KAAb,CAAmB,KAAKC,UAAL,EAAnB,CAAd;;AACA,aAAKH,MAAL,CAAYI,WAAZ,CAAwB,UAAxB,EAAoC,KAAKC,cAAzC,EAAyD,IAAzD;;AACA,aAAKL,MAAL,CAAYM,KAAZ;AACD,OAhBM;AAkBPD,MAAAA,cAAc,EAAE,0BAAY;AAC1B,YAAIE,YAAY,GAAG,KAAKC,QAAL,EAAnB;AAEA,YAAI9C,GAAG,GAAG,KAAK+C,MAAL,EAAV;AACA,YAAI5C,WAAW,GAAG,KAAK6C,cAAL,EAAlB;AACA,YAAI3C,SAAS,GAAGjB,EAAE,CAAC6D,OAAH,CAAWC,YAAX,CAAwB7C,SAAxB,CAAkC,KAAK2B,OAAL,EAAlC,CAAhB,CAL0B,CAO1B;;AACAmB,QAAAA,CAAC,CAAC,YAAY;AACZA,UAAAA,CAAC,CAACN,YAAD,CAAD,CAAgBO,iBAAhB,CAAkC;AAChCpD,YAAAA,GAAG,EAAEnB,EAAE,CAACwE,IAAH,CAAQC,eAAR,CAAwBC,WAAxB,GAAsCC,KAAtC,CAA4CxD,GAA5C,CAD2B;AAEhCG,YAAAA,WAAW,EAAEA,WAFmB;AAGhCsD,YAAAA,QAAQ,EAAEpD;AAHsB,WAAlC;AAKD,SANA,CAAD;AAOA,eAAO,KAAP;AACD;AAlCM,KAjGgC;AAsIzCqD,IAAAA,KAAK,EAAE,eAAUtD,OAAV,EAAmB;AACxBhB,MAAAA,EAAE,CAACwB,MAAH,CAAUC,YAAV,CAAuB8C,UAAvB,CAAkC,cAAlC,EAAkDvD,OAAlD;AACAhB,MAAAA,EAAE,CAACC,EAAH,CAAMC,SAAN,CAAgBsE,aAAhB,CAA8BC,aAA9B,CAA4C,cAA5C,EAA4DzD,OAA5D;AACD;AAzIwC,GAA3C;;AA2IA,GAAC,UAAU+C,CAAV,EAAa;AACZW,IAAAA,MAAM,CAACC,EAAP,CAAU5E,MAAV,CAAiB;AACfiE,MAAAA,iBAAiB,EAAE,2BAAUY,OAAV,EAAmB;AACpC,YAAIC,QAAQ,GAAG;AACbjE,UAAAA,GAAG,EAAE,EADQ;AAEbC,UAAAA,IAAI,EAAE,EAFO;AAGbiE,UAAAA,IAAI,EAAE,oCAHO;AAIbC,UAAAA,OAAO,EAAE,IAJI;AAKbC,UAAAA,QAAQ,EAAE,MALG;AAMbC,UAAAA,QAAQ,EAAE;AANG,SAAf;AAQAL,QAAAA,OAAO,GAAGF,MAAM,CAAC3E,MAAP,CAAc8E,QAAd,EAAwBD,OAAxB,CAAV;AAEA,eAAO,KAAKM,IAAL,CAAU,YAAY;AAC3B,cAAIC,CAAC,GAAGP,OAAR;AACA,cAAIQ,CAAC,GAAGV,MAAM,CAAC,IAAD,CAAd;;AAEA,cAAIS,CAAC,CAACvE,GAAF,KAAU,EAAd,EAAkB;AAChByE,YAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AACA,mBAFgB,CAER;AACT;;AAED,cAAIC,QAAQ,GAAG;AACb,2BAAeJ,CAAC,CAACpE;AADJ,WAAf;;AAIA,eAAK,IAAIyE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,CAAC,CAACd,QAAF,CAAWoB,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC1C,gBAAIE,YAAY,GAAG,iBAAiBF,CAApC;AACA,gBAAIvD,IAAI,GAAG,SAASuD,CAApB;AACA,gBAAIrD,MAAM,GAAG,WAAWqD,CAAxB;AACA,gBAAIpD,WAAW,GAAG,gBAAgBoD,CAAlC;AACA,gBAAI3E,IAAI,GAAG,SAAS2E,CAApB;AACAD,YAAAA,QAAQ,CAACG,YAAD,CAAR,GAAyBF,CAAzB,CAN0C,CAMd;;AAC5BD,YAAAA,QAAQ,CAACtD,IAAD,CAAR,GAAiBkD,CAAC,CAACd,QAAF,CAAWmB,CAAX,EAAcvD,IAA/B;AACAsD,YAAAA,QAAQ,CAACpD,MAAD,CAAR,GAAmBgD,CAAC,CAACd,QAAF,CAAWmB,CAAX,EAAcrD,MAAjC;AACAoD,YAAAA,QAAQ,CAACnD,WAAD,CAAR,GAAwB+C,CAAC,CAACd,QAAF,CAAWmB,CAAX,EAAcpD,WAAtC;AACAmD,YAAAA,QAAQ,CAAC1E,IAAD,CAAR,GAAiBsE,CAAC,CAACd,QAAF,CAAWmB,CAAX,EAAc3E,IAA/B;AACD;;AAED6D,UAAAA,MAAM,CAACiB,IAAP,CAAY;AACVC,YAAAA,GAAG,EAAET,CAAC,CAACvE,GADG;AAEVqB,YAAAA,IAAI,EAAE,MAFI;AAGVV,YAAAA,IAAI,EAAEgE,QAHI;AAIVP,YAAAA,QAAQ,EAAEG,CAAC,CAACH,QAJF;AAKVa,YAAAA,KAAK,EAAE,eAAUC,GAAV,EAAeC,MAAf,EAAuBC,CAAvB,EAA0B;AAC/BX,cAAAA,OAAO,CAACC,GAAR,CAAY,qCAAZ,EAAmDvB,CAAC,CAACqB,CAAD,CAAD,CAAKa,IAAL,CAAU,IAAV,CAAnD,EAAoED,CAApE,EAAuEb,CAAC,CAACvE,GAAzE;AACD,aAPS;AAQVsF,YAAAA,OAAO,EAAE,iBAAUC,MAAV,EAAkB;AACzBf,cAAAA,CAAC,CAACN,IAAF,CAAO,EAAP;AACA,kBAAIsB,KAAK,GAAGD,MAAM,CAAC1C,YAAP,CAAoB4C,mBAAhC;AACA,kBAAIC,OAAO,GAAGF,KAAK,CAACX,MAApB;AACA,kBAAIc,IAAI,GAAG,EAAX;AACA,kBAAIC,KAAJ,EAAWC,MAAX,EAAmBC,KAAnB;;AAEA,mBAAK,IAAIlB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGc,OAApB,EAA6Bd,CAAC,EAA9B,EAAkC;AAChC,oBAAImB,IAAI,GAAGP,KAAK,CAACZ,CAAD,CAAhB;AACA,oBAAIoB,QAAQ,GAAGzB,CAAC,CAACL,IAAjB;AAEA0B,gBAAAA,KAAK,GAAG,SAAR;;AACA,qBAAK,IAAIK,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG1B,CAAC,CAACd,QAAF,CAAWoB,MAAjC,EAAyCoB,EAAE,EAA3C,EAA+C;AAC7C,sBAAIF,IAAI,CAACG,YAAL,KAAsBD,EAA1B,EAA8B;AAC5B,wBAAI1B,CAAC,CAACd,QAAF,CAAWwC,EAAX,EAAexE,YAAf,CAA4B,OAA5B,MAAyC,IAA7C,EAAmD;AACjDmE,sBAAAA,KAAK,GAAGrB,CAAC,CAACd,QAAF,CAAWwC,EAAX,EAAe3E,YAAf,CAA4B,OAA5B,CAAR;AACD,qBAFD,MAEO;AACLsE,sBAAAA,KAAK,GAAG,SAAR;AACD;;AAED,wBAAIrB,CAAC,CAACd,QAAF,CAAWwC,EAAX,EAAexE,YAAf,CAA4B,QAA5B,MAA0C,IAA9C,EAAoD;AAClDoE,sBAAAA,MAAM,GAAGtB,CAAC,CAACd,QAAF,CAAWwC,EAAX,EAAe3E,YAAf,CAA4B,QAA5B,CAAT;AACD,qBAFD,MAEO;AACLuE,sBAAAA,MAAM,GAAG,uBAAT;AACD;;AACDG,oBAAAA,QAAQ,GAAG,WAAWH,MAAX,GAAoB,SAA/B;AACD;AACF;;AAEDF,gBAAAA,IAAI,GAAGI,IAAI,CAACI,SAAZ;;AACA,oBAAIJ,IAAI,CAACK,SAAL,KAAmB,OAAvB,EAAgC;AAC9BT,kBAAAA,IAAI,GAAGA,IAAI,GAAG,IAAP,GAAcI,IAAI,CAACK,SAA1B;AACD;;AACD,oBAAIL,IAAI,CAACI,SAAL,KAAmBJ,IAAI,CAACM,OAAxB,IAAmCN,IAAI,CAACK,SAAL,KAAmBL,IAAI,CAACO,OAA/D,EAAwE;AACtEX,kBAAAA,IAAI,GAAGA,IAAI,GAAG,KAAd;AACD;;AACD,oBAAII,IAAI,CAACI,SAAL,KAAmBJ,IAAI,CAACM,OAA5B,EAAqC;AACnCV,kBAAAA,IAAI,GAAGA,IAAI,GAAGI,IAAI,CAACM,OAAZ,GAAsB,IAAtB,GAA6BN,IAAI,CAACO,OAAzC;AACD,iBAFD,MAEO;AACL,sBAAIP,IAAI,CAACK,SAAL,KAAmBL,IAAI,CAACO,OAA5B,EAAqC;AACnCX,oBAAAA,IAAI,GAAGA,IAAI,GAAGI,IAAI,CAACO,OAAnB;AACD;AACF;;AAEDN,gBAAAA,QAAQ,GAAGA,QAAQ,CAACO,OAAT,CAAiB,UAAjB,EAA6BR,IAAI,CAACS,WAAlC,CAAX;;AACA,oBAAIT,IAAI,CAACD,KAAL,KAAe,EAAnB,EAAuB;AACrBA,kBAAAA,KAAK,GAAG,OAAOC,IAAI,CAACD,KAAZ,GAAoB,GAA5B;AACD,iBAFD,MAEO;AACLA,kBAAAA,KAAK,GAAGC,IAAI,CAACD,KAAb;AACD;;AACDE,gBAAAA,QAAQ,GAAGA,QAAQ,CAACO,OAAT,CAAiB,WAAjB,EAA8BT,KAA9B,CAAX;AACAE,gBAAAA,QAAQ,GAAGA,QAAQ,CAACO,OAAT,CAAiB,UAAjB,EAA6BZ,IAA7B,CAAX,CA5CgC,CA6ChC;;AAEA,oBAAIc,IAAI,GAAGtD,CAAC,CAAC,wBAAwByC,KAAxB,GAAgC,IAAjC,CAAD,CAAwCc,MAAxC,CAA+CV,QAA/C,EAAyDU,MAAzD,CAAgE,aAAhE,CAAX,CA/CgC,CAgDhC;;AAEAlC,gBAAAA,CAAC,CAACkC,MAAF,CAASD,IAAT;AACD;AACF;AAnES,WAAZ;AAqED,SA/FM,CAAP;AAgGD;AA5Gc,KAAjB;AA8GD,GA/GD,EA+GG3C,MA/GH;;AAtKA1E,EAAAA,EAAE,CAAC6D,OAAH,CAAWC,YAAX,CAAwBlE,aAAxB,GAAwCA,aAAxC",
  "sourcesContent": [
    "/* CalendarList.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * @author mclb\n * @since 2014\n *\n * @ignore(jQuery.*)\n * @asset(plugins/calendarlist/*)\n */\nqx.Class.define('cv.plugins.CalendarList', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Refresh],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    width: {\n      check: \"String\",\n      init: ''\n    },\n    height: {\n      check: \"String\",\n      init: ''\n    },\n    src: {\n      check: \"String\",\n      init: \"plugins/calendarlist/calendarlist.php\"\n    },\n    days: {\n      check: \"Number\",\n      nullable: true\n    },\n    maxquantity: {\n      check: \"Number\",\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    calendars: {},\n\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse: function (xml, path, flavour, pageType) {\n      var data = cv.parser.WidgetParser.parseElement(this, xml, path, flavour, pageType, this.getAttributeToPropertyMappings());\n      cv.parser.WidgetParser.parseRefresh(xml, path);\n      this.calendars[path] = [];\n      xml.querySelectorAll('calendar').forEach(function (cal) {\n        var calData = {\n          type: cal.getAttribute('type'),\n          userid: cal.getAttribute('userid'),\n          magiccookie: cal.hasAttribute('magiccookie') ? cal.getAttribute('magiccookie') : '',\n          days: cal.hasAttribute('days') ? cal.getAttribute('days') : data.days\n        };\n        this.calendars[path].push(calData);\n      }, this);\n      return data;\n    },\n\n    getAttributeToPropertyMappings: function () {\n      return {\n        'width': {\n          transform: function (value) {\n            return value ? \"width:\" + value + \";\" : \"\";\n          }\n        },\n        'height': {\n          transform: function (value) {\n            return value ? \"height:\" + value + \";\" : \"\";\n          }\n        },\n        'maxquantity': {\n          transform: function (value) {\n            return value ? parseInt(value) : null;\n          }\n        },\n        'days': {\n          transform: function (value) {\n            return value ? parseInt(value) : null;\n          }\n        }\n      };\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    _getInnerDomString: function () {\n      return '<div class=\"actor calendarListBody\">' +\n        '<div class=\"calendarList_inline\" id=\"calendarList' + this.getPath() + '\" style=\"' + this.getHeight() + this.getWidth() + '\"></div>' +\n        '</div>';\n    },\n\n    _onDomReady: function () {\n      this.base(arguments);\n      this.refreshAction();\n    },\n\n    _setupRefreshAction: function() {\n      this._timer = new qx.event.Timer(this.getRefresh());\n      this._timer.addListener('interval', this._refreshAction, this);\n      this._timer.start();\n    },\n\n    _refreshAction: function () {\n      var calendarList = this.getActor();\n\n      var src = this.getSrc();\n      var maxquantity = this.getMaxquantity();\n      var calendars = cv.plugins.CalendarList.calendars[this.getPath()];\n\n      // TODO: replace jQuery\n      $(function () {\n        $(calendarList).calendarListlocal({\n          src: qx.util.ResourceManager.getInstance().toUri(src),\n          maxquantity: maxquantity,\n          calendar: calendars\n        });\n      });\n      return false;\n    }\n  },\n\n  defer: function (statics) {\n    cv.parser.WidgetParser.addHandler(\"calendarlist\", statics);\n    cv.ui.structure.WidgetFactory.registerClass(\"calendarlist\", statics);\n  }\n});\n(function ($) {\n  jQuery.fn.extend({\n    calendarListlocal: function (options) {\n      var defaults = {\n        src: '',\n        days: 30,\n        html: '<span>{date}: {text}{where}</span>',\n        wrapper: 'li',\n        dataType: 'json',\n        datetime: true\n      };\n      options = jQuery.extend(defaults, options);\n\n      return this.each(function () {\n        var o = options;\n        var c = jQuery(this);\n\n        if (o.src === '') {\n          console.log('calendarListlocal: no src URL');\n          return; // avoid the request\n        }\n\n        var formData = {\n          'maxquantity': o.maxquantity\n        };\n\n        for (var i = 0; i < o.calendar.length; i++) {\n          var calendarname = 'calendarname' + i;\n          var type = 'type' + i;\n          var userid = 'userid' + i;\n          var magiccookie = 'magiccookie' + i;\n          var days = 'days' + i;\n          formData[calendarname] = i; //o.calendar[i].textContent;\n          formData[type] = o.calendar[i].type;\n          formData[userid] = o.calendar[i].userid;\n          formData[magiccookie] = o.calendar[i].magiccookie;\n          formData[days] = o.calendar[i].days;\n        }\n\n        jQuery.ajax({\n          url: o.src,\n          type: 'POST',\n          data: formData,\n          dataType: o.dataType,\n          error: function (xhr, status, e) {\n            console.log('C: #%s, Error: %s, calendarList: %s', $(c).attr('id'), e, o.src);\n          },\n          success: function (result) {\n            c.html('');\n            var items = result.calendarList.calendarListEntries;\n            var itemnum = items.length;\n            var date = '';\n            var color, format, where;\n\n            for (var i = 0; i < itemnum; i++) {\n              var item = items[i];\n              var itemHtml = o.html;\n\n              color = '#FFFFFF';\n              for (var ix = 0; ix < o.calendar.length; ix++) {\n                if (item.calendarName === ix) {\n                  if (o.calendar[ix].hasAttribute('color') === true) {\n                    color = o.calendar[ix].getAttribute('color');\n                  } else {\n                    color = '#FFFFFF';\n                  }\n\n                  if (o.calendar[ix].hasAttribute('format') === true) {\n                    format = o.calendar[ix].getAttribute('format');\n                  } else {\n                    format = '{date}: {text}{where}';\n                  }\n                  itemHtml = '<span>' + format + '</span>';\n                }\n              }\n\n              date = item.StartDate;\n              if (item.StartTime !== '00:00') {\n                date = date + ', ' + item.StartTime;\n              }\n              if (item.StartDate !== item.EndDate || item.StartTime !== item.EndTime) {\n                date = date + ' - ';\n              }\n              if (item.StartDate !== item.EndDate) {\n                date = date + item.EndDate + ', ' + item.EndTime;\n              } else {\n                if (item.StartTime !== item.EndTime) {\n                  date = date + item.EndTime;\n                }\n              }\n\n              itemHtml = itemHtml.replace(/\\{text\\}/, item.description);\n              if (item.where !== '') {\n                where = ' (' + item.where + ')';\n              } else {\n                where = item.where;\n              }\n              itemHtml = itemHtml.replace(/\\{where\\}/, where);\n              itemHtml = itemHtml.replace(/\\{date\\}/, date);\n              //console.log('%i: %s', i, itemHtml);\n\n              var $row = $('<span style=\"color:' + color + '\">').append(itemHtml).append('</span><br>');\n              //console.log('%i: %s', i, $row);\n\n              c.append($row);\n            }\n          }\n        });\n      });\n    }\n  });\n})(jQuery);"
  ]
}