{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/Timeout.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "structure",
    "AbstractBasicWidget",
    "construct",
    "props",
    "__timeoutIdleCount",
    "__initialize",
    "statics",
    "parse",
    "xml",
    "path",
    "flavour",
    "pageType",
    "parser",
    "WidgetParser",
    "parseElement",
    "getAttributeToPropertyMappings",
    "transform",
    "parseFloat",
    "value",
    "properties",
    "target",
    "check",
    "init",
    "time",
    "debug",
    "members",
    "__timeoutCurrentPage",
    "__timeoutCurrentPageTitle",
    "__timeoutTargetPage",
    "__timer",
    "isDebug",
    "getTime",
    "getTarget",
    "deltaT",
    "event",
    "Timer",
    "addListener",
    "timeoutTrigger",
    "start",
    "Registration",
    "window",
    "_onUserAction",
    "message",
    "Bus",
    "subscribe",
    "ev",
    "getData",
    "document",
    "querySelector",
    "innerText",
    "templateEngine",
    "TemplateEngine",
    "getInstance",
    "scrollToPage",
    "getCurrentPage",
    "getDomElement",
    "scrollTop",
    "destruct",
    "_disposeObjects",
    "defer",
    "addHandler",
    "plugins",
    "Timeout",
    "WidgetFactory",
    "registerClass"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Timeout.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This plugins jumps back to a defined page after a given timeout period\n *\n * @author Carsten Tschach (Carsten@Tschach.com)\n * @since 2012\n */\nqx.Class.define('cv.plugins.Timeout', {\n  extend: cv.ui.structure.AbstractBasicWidget,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.base(arguments, props);\n    this.__timeoutIdleCount = 0;\n    this.__initialize();\n  },\n\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse: function (xml, path, flavour, pageType) {\n      return cv.parser.WidgetParser.parseElement(this, xml, path, flavour, pageType, this.getAttributeToPropertyMappings());\n    },\n\n    getAttributeToPropertyMappings: function() {\n      return {\n        'target': { 'default': 'id_' },\n        'time': { 'default': 600, transform: parseFloat },\n        'debug': {\n          'default': false,\n          transform: function(value) {\n            return value === 'true';\n          }\n        }\n      };\n    }\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    target: {\n      check: 'String',\n      init: 'id_'\n    },\n    time: {\n      check: 'Number',\n      init: 600\n    },\n    debug: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __timeoutIdleCount: null,\n    __timeoutCurrentPage: null,\n    __timeoutCurrentPageTitle: null,\n    __timeoutTargetPage: null,\n    __timer: null,\n\n    __initialize: function () {\n      if (this.isDebug()) {\n        this.debug('Timeout Set to : ' + this.getTime());\n        this.debug('Target Page: ' + this.getTarget());\n      }\n\n      const deltaT = this.getTime() * 100;\n      this.__timer = new qx.event.Timer(deltaT);\n      this.__timer.addListener('interval', this.timeoutTrigger, this);\n      this.__timer.start();\n\n      // Reset Counter on every interaction\n      qx.event.Registration.addListener(window, 'useraction', this._onUserAction, this);\n\n      // Keep track of current page\n      qx.event.message.Bus.subscribe('path.pageChanged', function (ev) {\n        const path = ev.getData();\n        this.__timeoutCurrentPage = path;\n        this.__timeoutCurrentPageTitle = document.querySelector('#' + path+ ' div > h1').innerText;\n        this.__timeoutIdleCount = 0;\n        /* We could trun on and off the above binds if we are already on the right page\n\n         if (timeoutCurrentPage === timeoutTargetPage) {\n         console.log(\"XXXXXX TIMEOUT: Scrolled to Target Page: \" + path);\n         } else {\n         console.log(\"XXXXXX TIMEOUT: Scrolled to: \" + path + \" (\"+timeoutTargetPage + \")\");\n         }\n         */\n      }, this);\n    },\n\n    _onUserAction: function() {\n      this.__timeoutIdleCount = 0;\n    },\n\n    timeoutTrigger: function () {\n      if (this.isDebug()) {\n        this.debug('TIMEOUT: Got Trigger (' + this.__timeoutIdleCount + ')');\n      }\n      this.__timeoutIdleCount++;\n      this.__timeoutTargetPage = this.getTarget();\n      if (this.__timeoutIdleCount >= 10) {\n        this.__timeoutIdleCount = 0;\n        const templateEngine = cv.TemplateEngine.getInstance();\n\n        if (this.__timeoutCurrentPage !== this.__timeoutTargetPage && this.__timeoutCurrentPageTitle !== this.__timeoutTargetPage) {\n          if (this.isDebug()) {\n            this.debug('TIMEOUT: Got Timeout - Now Goto Page ' + this.__timeoutTargetPage);\n          }\n          templateEngine.scrollToPage(this.__timeoutTargetPage);\n          templateEngine.getCurrentPage().getDomElement().scrollTop = 0;\n          //templateEngine.updateTopNavigation();\n        } else {\n          if (this.isDebug()) {\n            this.debug('TIMEOUT: Already on page ' + this.__timeoutTargetPage);\n          }\n          templateEngine.getCurrentPage().getDomElement().scrollTop = 0;\n        }\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this._disposeObjects('__timer');\n  },\n\n\n  defer: function(statics) {\n    cv.parser.WidgetParser.addHandler('timeout', cv.plugins.Timeout);\n    cv.ui.structure.WidgetFactory.registerClass('timeout', statics);\n  }\n\n});\n\n"
  ]
}