{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/parser/widgets/Page.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "statics",
    "parse",
    "page",
    "path",
    "flavour",
    "pageType",
    "storagePath",
    "cv",
    "parser",
    "WidgetParser",
    "getStoragePath",
    "addresses",
    "getAttribute",
    "src",
    "data",
    "Model",
    "getInstance",
    "addAddress",
    "READ",
    "name",
    "backdrop",
    "showtopnavigation",
    "showfooter",
    "shownavbar",
    "top",
    "bottom",
    "left",
    "right",
    "Array",
    "from",
    "children",
    "filter",
    "m",
    "matches",
    "forEach",
    "elem",
    "pos",
    "value",
    "bindClickToWidget",
    "TemplateEngine",
    "wstyle",
    "layout",
    "parseLayout",
    "backdropType",
    "substring",
    "length",
    "setWidgetData",
    "showTopNavigation",
    "showFooter",
    "showNavbarTop",
    "showNavbarBottom",
    "showNavbarLeft",
    "showNavbarRight",
    "backdropAlign",
    "size",
    "address",
    "linkVisible",
    "$$type",
    "parseAddress",
    "parseFormat",
    "parseChildren",
    "linkData",
    "classes",
    "setWidgetLayout",
    "defer",
    "addHandler",
    "widgets",
    "Page"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Page.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.parser.widgets.Page', {\n  type: 'static',\n\n  /*\n   ******************************************************\n   STATICS\n   ******************************************************\n   */\n  statics: {\n\n    parse: function(page, path, flavour, pageType) {\n      const storagePath = cv.parser.WidgetParser.getStoragePath(page, path);\n      const addresses = {};\n      if (page.getAttribute('ga')) {\n        const src = page.getAttribute('ga');\n        cv.data.Model.getInstance().addAddress(src, storagePath);\n        addresses[src] = [ 'DPT:1.001', cv.data.Model.READ ];\n      }\n\n      const name = page.getAttribute('name');\n      pageType = page.getAttribute('type') || 'text'; //text, 2d or 3d\n      const backdrop = page.getAttribute('backdrop');\n      const showtopnavigation = page.getAttribute('showtopnavigation') ? page.getAttribute('showtopnavigation') === 'true' : null;\n      const showfooter = page.getAttribute('showfooter') ? page.getAttribute('showfooter') === 'true' : true;\n      // make sure the type has the correct value as we need to use it ass CSS class\n      switch (pageType) {\n        case '2d':\n        case '3d':\n          // do nothing, type has correct value\n          break;\n        default:\n          pageType = 'text';\n          break;\n      }\n\n      // automatically set the navbars if not set in the config file\n      const shownavbar = {\n        top: path === 'id' ? false : null,\n        bottom: path === 'id' ? false : null,\n        left: path === 'id' ? false : null,\n        right: path === 'id' ? false : null\n      };\n      Array.from(page.children).filter(function(m) {\n return m.matches('navbar'); \n}).forEach(function(elem) {\n        shownavbar[elem.getAttribute('position') || 'left'] = true;\n      });\n      // overwrite default when set manually in the config\n      ['top', 'left', 'right', 'bottom'].forEach(function(pos) {\n        if (shownavbar[pos] !== null) {\n          // do not override current values\n          return;\n        }\n        const value = page.getAttribute('shownavbar-' + pos);\n        if (typeof value === 'string') {\n          shownavbar[pos] = value === 'true';\n        }\n      }, this);\n      let bindClickToWidget = cv.TemplateEngine.getInstance().bindClickToWidget;\n      if (page.getAttribute('bind_click_to_widget')) {\n        bindClickToWidget = page.getAttribute('bind_click_to_widget')==='true';\n      }\n      if (page.getAttribute('flavour')) {\n        flavour = page.getAttribute('flavour');// sub design choice\n      }\n      let wstyle = ''; // widget style\n      if (page.getAttribute('align')) {\n        wstyle += 'text-align:' + page.getAttribute('align') + ';';\n      }\n      if (wstyle !== '') {\n        wstyle = 'style=\"' + wstyle + '\"';\n      }\n\n      const layout = cv.parser.WidgetParser.parseLayout(Array.from(page.children).filter(function (m) {\n        return m.matches('layout');\n      })[0]);\n      let backdropType = null;\n      if (backdrop) {\n        backdropType = backdrop.substring(backdrop.length - 4) === '.svg' ? 'embed' : 'img';\n      }\n\n      const data = cv.data.Model.getInstance().setWidgetData(storagePath, {\n        path: storagePath,\n        name: name,\n        pageType: pageType,\n        showTopNavigation: showtopnavigation,\n        showFooter: showfooter,\n        showNavbarTop: shownavbar.top,\n        showNavbarBottom: shownavbar.bottom,\n        showNavbarLeft: shownavbar.left,\n        showNavbarRight: shownavbar.right,\n        backdropAlign: pageType === '2d' ? (page.getAttribute('backdropalign') || '50% 50%') : null,\n        size: page.getAttribute('size') || null,\n        address: addresses,\n        linkVisible: page.getAttribute('visible') ? page.getAttribute('visible') === 'true' : true,\n        flavour: flavour || null,\n        $$type: 'page',\n        backdrop: backdrop || null,\n        backdropType: backdropType\n      });\n      cv.parser.WidgetParser.parseAddress(page, path);\n      cv.parser.WidgetParser.parseFormat(page, path);\n      // this has to be called manually to allow inheritance of the flavour, pageType values\n      cv.parser.WidgetParser.parseChildren(page, path, flavour, pageType);\n      if (data.linkVisible === true) {\n        const linkData = cv.data.Model.getInstance().setWidgetData(path, {\n          $$type: 'pagelink',\n          path: path,\n          name: name,\n          classes: cv.parser.WidgetParser.setWidgetLayout(page, path) || '',\n          layout: layout || null,\n          address: addresses,\n          pageType: pageType,\n          wstyle: wstyle || '',\n          bindClickToWidget: bindClickToWidget\n        });\n        return [data, linkData];\n      } \n        return data;\n    }\n  },\n\n  defer: function(statics) {\n    cv.parser.WidgetParser.addHandler('page', statics);\n  }\n});\n"
  ]
}