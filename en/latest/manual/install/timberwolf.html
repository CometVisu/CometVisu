

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation on the Timberwolf with Portainer &mdash; CometVisu</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="CometVisu" href="../index.html"/>
        <link rel="up" title="Installation of the CometVisu" href="index.html"/>
        <link rel="next" title="&lt;no title&gt;" href="linux.html"/>
        <link rel="prev" title="Installation of the Docker container" href="docker.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> CometVisu
          

          
            
            <img src="../_static/comet_webapp_icon_android_48.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.11.0-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Installation of the CometVisu</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="generic.html">Prerequisites for the installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="wiregate.html">Installation on WireGate</a></li>
<li class="toctree-l2"><a class="reference internal" href="raspberry.html">Installation on Raspberry PI</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-dev.html">Developer version on the Wiregate</a></li>
<li class="toctree-l2"><a class="reference internal" href="openhab2.html">Installation on a Debian System with openHAB2</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html">Installation of the Docker container</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Installation on the Timberwolf with Portainer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-volumes">Create Volumes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-container">Creating a Container</a></li>
<li class="toctree-l4"><a class="reference internal" href="#proxy-setup">Proxy setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#updates">Updates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#replace-container">Replace Container</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cleanup">Cleanup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#development-version">Development version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#update-der-cometvisu">Update der CometVisu</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html">Configuration of the CometVisu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../colab/index.html">Help the CometVisu project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/index.html">Information for developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CometVisu</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Installation of the CometVisu</a> &raquo;</li>
        
      <li>Installation on the Timberwolf with Portainer</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p>This is the documentation for the current development branch of the CometVisu.
It is possible that some of the described features are not yet available in the current release.</p>
<p class="last">Also there might be lots of errors in this documentation as some parts of the content have been translated
by an online translation service.</p>
</div>
<div class="section" id="installation-on-the-timberwolf-with-portainer">
<span id="timberwolf"></span><h1>Installation on the Timberwolf with Portainer<a class="headerlink" href="#installation-on-the-timberwolf-with-portainer" title="Permalink to this headline">¶</a></h1>
<p>To install the CometVisu on the <cite>Timberwolf &lt;https://wiregate.de/&gt;</cite>
server, the administration interface at the device
(<cite>Portainer&lt;https://portainer.io/&gt;</cite>) is used.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>With this tutorial the CometVisu will be available on the Timberwolf
server via HTTPS under the address <code class="docutils literal"><span class="pre">https://&lt;my</span> <span class="pre">timberwolf&gt;/proxy/visu/</span></code>.</p>
<p>Basically, these steps are also suitable as a reference for installations
via portainer on other systems, but the steps must be adapted
in detail, as there usually no proxy is available, which makes
the CometVisu accessible via HTTPS.</p>
<div class="section" id="create-volumes">
<h3>Create Volumes<a class="headerlink" href="#create-volumes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="volume-for-config-files">
<h4>Volume for Config Files<a class="headerlink" href="#volume-for-config-files" title="Permalink to this headline">¶</a></h4>
<p>First, create a volume to store the configuration files and
keep them while rebooting and updating the container.</p>
<p>Nesseccary steps are: <em>Volumes</em> → <em>Add Volume</em> → Name:
<code class="docutils literal"><span class="pre">CometVisuConfig</span></code> → <em>Create the Volume</em></p>
<div class="figure" id="id2">
<a class="reference internal image-reference" href="../_images/portainer_volume_add.png"><img alt="../_images/portainer_volume_add.png" src="../_images/portainer_volume_add.png" style="width: 1362.0px; height: 615.0px;" /></a>
<p class="caption"><span class="caption-text">Create Volume with Portainer</span></p>
</div>
<p>This volume can be filled from the outside with the config
files or best by using the <a class="reference internal" href="../config/manager.html#manager"><span class="std std-ref">Config-Manager</span></a>.</p>
</div>
<div class="section" id="volume-for-rrd">
<h4>Volume for RRD<a class="headerlink" href="#volume-for-rrd" title="Permalink to this headline">¶</a></h4>
<p>This step is optional and only necessary if you want to use the
<a class="reference internal" href="../config/widgets/plugins/diagram/index.html#diagram"><span class="std std-ref">Diagram Plugin</span></a> with RRD files. When using the
InfluxDB this step can be skipped.</p>
<p>The steps for creating the <em>Volume for Config Files</em> must
be repeated, but the name <code class="docutils literal"><span class="pre">CometVisuRRD</span></code> is hereby meaningfully chosen.</p>
<p>The filling of this container must be external, e.g. by
another container that simultaneously incorporates this RRD container.</p>
<p><strong>Important:</strong> The internal format of the RRD files is architecture specific.
Thus, the RRG files from WireGate (32 bit architecture) can not be
used directly on the Timberwolf (64 bit architecture) [1].</p>
</div>
</div>
<div class="section" id="creating-a-container">
<h3>Creating a Container<a class="headerlink" href="#creating-a-container" title="Permalink to this headline">¶</a></h3>
<p>Under: <em>Containers</em> → <em>Add Container</em></p>
<ul>
<li><p class="first">Name: <code class="docutils literal"><span class="pre">CometVisu</span></code></p>
</li>
<li><p class="first">Image configuration: Name: <code class="docutils literal"><span class="pre">cometvisu/cometvisu:latest</span></code></p>
</li>
<li><p class="first">Port mapping: host <code class="docutils literal"><span class="pre">18080</span></code>, container <code class="docutils literal"><span class="pre">80</span></code></p>
</li>
<li><p class="first">Advanced container settings:</p>
<ul>
<li><p class="first">Volumes: Volume mapping</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">container</span></code>: <code class="docutils literal"><span class="pre">/var/www/html/config</span></code> ⭢ <code class="docutils literal"><span class="pre">volume</span></code>: <code class="docutils literal"><span class="pre">CometVisuConfig</span></code> <em>(bis einschließlich Version 0.10.2)</em></li>
<li><code class="docutils literal"><span class="pre">container</span></code>: <code class="docutils literal"><span class="pre">/var/www/html/resource/config</span></code> ⭢ <code class="docutils literal"><span class="pre">volume</span></code>: <code class="docutils literal"><span class="pre">CometVisuConfig</span></code> <em>(ab Version 0.11)</em></li>
<li><code class="docutils literal"><span class="pre">container</span></code>: <code class="docutils literal"><span class="pre">/var/www/rrd</span></code> ⭢ <code class="docutils literal"><span class="pre">volume</span></code>: <code class="docutils literal"><span class="pre">RRD</span></code> <em>(Optional, wenn RRD genutzt werden soll)</em></li>
</ul>
</li>
<li><p class="first">Env: Environment variables</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">name</span></code>: <code class="docutils literal"><span class="pre">CGI_URL_PATH</span></code> with <code class="docutils literal"><span class="pre">value</span></code>: <code class="docutils literal"><span class="pre">/proxy/visu/cgi-bin/</span></code></p>
</li>
<li><p class="first">Depending on the local environment, additional customizations may
be required, as specified in the section of the
<span class="xref std std-ref">Docker Container</span>.</p>
<p>So it may be necessary to set a value for <code class="docutils literal"><span class="pre">KNX_PA</span></code> other than the
default <code class="docutils literal"><span class="pre">1.1.238</span></code> if this physical address is already occupied
or if another line is to be used as <code class="docutils literal"><span class="pre">1.1</span></code>.</p>
</li>
</ul>
</li>
<li><p class="first">Restart policy: <code class="docutils literal"><span class="pre">Unless</span> <span class="pre">stopped</span></code></p>
</li>
</ul>
</li>
</ul>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="../_images/portainer_container_add.png"><img alt="../_images/portainer_container_add.png" src="../_images/portainer_container_add.png" style="width: 1346.0px; height: 755.0px;" /></a>
<p class="caption"><span class="caption-text">Create Container at Portainer</span></p>
</div>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="../_images/portainer_container_volumes_add.png"><img alt="../_images/portainer_container_volumes_add.png" src="../_images/portainer_container_volumes_add.png" style="width: 1082.0px; height: 369.0px;" /></a>
<p class="caption"><span class="caption-text">Configure Container <em>Volumes</em> at Portainer</span></p>
</div>
<div class="figure" id="id5">
<a class="reference internal image-reference" href="../_images/portainer_container_env_add.png"><img alt="../_images/portainer_container_env_add.png" src="../_images/portainer_container_env_add.png" style="width: 1081.0px; height: 259.0px;" /></a>
<p class="caption"><span class="caption-text">Configure Container <em>Env</em> at Portainer</span></p>
</div>
<div class="figure" id="id6">
<a class="reference internal image-reference" href="../_images/portainer_container_restart_add.png"><img alt="../_images/portainer_container_restart_add.png" src="../_images/portainer_container_restart_add.png" style="width: 763.0px; height: 217.0px;" /></a>
<p class="caption"><span class="caption-text">Configure Container <em>Restart policy</em> at Portainer</span></p>
</div>
<p>Then create the container by pressing <em>Deploy the container</em>.</p>
</div>
<div class="section" id="proxy-setup">
<h3>Proxy setup<a class="headerlink" href="#proxy-setup" title="Permalink to this headline">¶</a></h3>
<p>At the Timberwolf Frontend:
<em>Settings</em> → <em>Remote Access</em> → <em>Reverse Proxy</em></p>
<ul class="simple">
<li>URL: <code class="docutils literal"><span class="pre">visu</span></code>, Target <code class="docutils literal"><span class="pre">http://127.0.0.1:18080/</span></code></li>
</ul>
<p>Accept with <em>Add</em></p>
<div class="figure" id="id7">
<a class="reference internal image-reference" href="../_images/timberwolf_proxy_add.png"><img alt="../_images/timberwolf_proxy_add.png" src="../_images/timberwolf_proxy_add.png" style="width: 673.0px; height: 128.0px;" /></a>
<p class="caption"><span class="caption-text">Add Timberwolf Proxy-Entry</span></p>
</div>
<p>CometVisu is now available: <code class="docutils literal"><span class="pre">https://&lt;mein</span> <span class="pre">timberwolf&gt;/proxy/visu/</span></code></p>
</div>
</div>
<div class="section" id="updates">
<h2>Updates<a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h2>
<div class="section" id="replace-container">
<h3>Replace Container<a class="headerlink" href="#replace-container" title="Permalink to this headline">¶</a></h3>
<p>Under <em>Containers</em> → <code class="docutils literal"><span class="pre">CometVisu</span></code> pressing the button <em>Duplicate / Edit</em>
to invoked the menu for refreshing the container.</p>
<p>Here&#8217;s to make sure <em>Always pull the image</em> is active.</p>
<p>Under <em>Advanced container settings</em> → <em>Labels</em> the labels should
be deleted in order to be able to recognize later which CometVisu
container version is installed.</p>
<p>If you want to change from version 0.10.2 to a version from the 0.11
series, then under <em>Volumes</em> the config path from
<code class="docutils literal"><span class="pre">/var/www/html/config</span></code> to <code class="docutils literal"><span class="pre">/var/www/html/resource/config</span></code>.</p>
<p><em>Actions</em> → <em>Deploy the Container</em>  will now replace the container
with the latest version.</p>
<div class="figure" id="id8">
<a class="reference internal image-reference" href="../_images/portainer_container_replace.png"><img alt="../_images/portainer_container_replace.png" src="../_images/portainer_container_replace.png" style="width: 836.0px; height: 863.0px;" /></a>
<p class="caption"><span class="caption-text">Replace Container at Portainer with a new version</span></p>
</div>
<p>Afterwards the security question has to be confirmed.</p>
<div class="figure" id="id9">
<img alt="../_images/portainer_container_replace_confirm.png" src="../_images/portainer_container_replace_confirm.png" />
<p class="caption"><span class="caption-text">Confirmation to replace the container at portainer with a new version</span></p>
</div>
</div>
<div class="section" id="cleanup">
<h3>Cleanup<a class="headerlink" href="#cleanup" title="Permalink to this headline">¶</a></h3>
<p>When a container is replaced with a new one, the old one remains as
<em>Unused</em> in the system and continues to occupy space. This can
be deleted under <em>Images</em>.</p>
<p>By marking the image to be deleted (recognizable by the label
<em>Unused</em> and the corresponding tag) the image can be removed with <em>Remove</em>.</p>
<div class="figure" id="id10">
<a class="reference internal image-reference" href="../_images/portainer_image_remove.png"><img alt="../_images/portainer_image_remove.png" src="../_images/portainer_image_remove.png" style="width: 1349.0px; height: 601.0px;" /></a>
<p class="caption"><span class="caption-text">Portainer Dialog to remove an image</span></p>
</div>
</div>
</div>
<div class="section" id="development-version">
<h2>Development version<a class="headerlink" href="#development-version" title="Permalink to this headline">¶</a></h2>
<p>Basically, the same steps as for the release have to be carried
out for the current development version. Although theoretically
the same configuration volume can be used as for the productive
version, a separate volume (for example <code class="docutils literal"><span class="pre">CometVisuTestConfig</span></code>)
should be created, as the format of the config files may change
incompatibly due to future updates.</p>
<p>As described under <a class="reference internal" href="docker.html#docker"><span class="std std-ref">Docker</span></a> has the newest
Development version the day <code class="docutils literal"><span class="pre">testing</span></code>. Thus, under
<em>Creating the container</em> as <code class="docutils literal"><span class="pre">name</span></code> <code class="docutils literal"><span class="pre">cometvisu/cometvisu:testing</span></code>
to use.</p>
<p>In order to have a uniform environment for error reporting, etc.
the testing version should be installed with these parameters:</p>
<ul class="simple">
<li>Container:<ul>
<li>Name: <code class="docutils literal"><span class="pre">CometVisuTest</span></code></li>
<li>Image configuration: Name: <code class="docutils literal"><span class="pre">cometvisu/cometvisu:testing</span></code></li>
<li>Port mapping: host <code class="docutils literal"><span class="pre">28080</span></code>, container <code class="docutils literal"><span class="pre">80</span></code></li>
<li>Advanced container settings:<ul>
<li>Volumes: Volume mapping<ul>
<li><code class="docutils literal"><span class="pre">container</span></code>: <code class="docutils literal"><span class="pre">/var/www/html/resource/config</span></code> ⭢ <code class="docutils literal"><span class="pre">volume</span></code>: <code class="docutils literal"><span class="pre">CometVisuTestConfig</span></code></li>
<li><code class="docutils literal"><span class="pre">container</span></code>: <code class="docutils literal"><span class="pre">/var/www/rrd</span></code> ⭢ <code class="docutils literal"><span class="pre">volume</span></code>: <code class="docutils literal"><span class="pre">RRD</span></code> <em>(Optional)</em></li>
</ul>
</li>
<li>Env: Environment variables <code class="docutils literal"><span class="pre">name</span></code>: <code class="docutils literal"><span class="pre">CGI_URL_PATH</span></code> mit <code class="docutils literal"><span class="pre">value</span></code>: <code class="docutils literal"><span class="pre">/proxy/visu/cgi-bin/</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Proxy:<ul>
<li>URL: <code class="docutils literal"><span class="pre">visutest</span></code>, Target <code class="docutils literal"><span class="pre">http://127.0.0.1:28080/</span></code></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><p class="first">In order to transfer the contents of an RRD file <code class="docutils literal"><span class="pre">RRD_Name</span></code>
from one architecture to another, the command has to be
executed on the source system (eg, WireGate)</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>rrdtool dump /var/www/rrd/RRD_Name.rrd &gt; RRD_Name.xml
</pre></div>
</div>
<p>On the target system (for example, a container on the Timber Wolf)
is then the command</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>rrdtool restore -f RRD_Name.xml RRD_Name.rrd
</pre></div>
</div>
<p>executed to greate a new RRD-File.</p>
<p>If you work with a localization on the source system that
uses numbers with a comma as the decimal separator
(as usual in German), then it may be that the RRD export is
done with a comma instead of a point and thus the import fails.
Here export would then be performed with generic <code class="docutils literal"><span class="pre">LANG=C</span></code>.</p>
<p>To convert a larger amount of RRD files this can be done
through a loop:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">LANG</span><span class="o">=</span>C<span class="p">;</span> <span class="k">for</span> f in *.rrd<span class="p">;</span> <span class="k">do</span> rrdtool dump <span class="si">${</span><span class="nv">f</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">f</span><span class="si">}</span>.xml<span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
<p>or</p>
<div class="last highlight-bash"><div class="highlight"><pre><span></span><span class="k">for</span> f in *.xml<span class="p">;</span> <span class="k">do</span> rrdtool restore <span class="si">${</span><span class="nv">f</span><span class="si">}</span> <span class="si">${</span><span class="nv">f</span><span class="si">}</span>.rrd<span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="linux.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="docker.html" class="btn btn-neutral" title="Installation of the Docker container" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2019 Christian Mayer and the CometVisu contributers.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Version</span>
      v: 0.11.0-dev
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../../../0.10.0/manual/index.html">0.10.0</a></dd>
        
          <dd><a href="../../../0.10.2/manual/index.html">0.10.2</a></dd>
        
          <dd><a href="../../../latest/manual/index.html">latest</a></dd>
        
      </dl>
      
    </div>
  </div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>