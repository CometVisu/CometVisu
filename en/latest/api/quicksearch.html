<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"plugins_colorchooser_farbtastic_farbtastic.js.html":{"id":"plugins_colorchooser_farbtastic_farbtastic.js.html","title":"Source: plugins/colorchooser/farbtastic/farbtastic.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: plugins/colorchooser/farbtastic/farbtastic.js /*! * Farbtastic: jQuery color picker plug-in v1.3u * * Licensed under the GPL license: * http://www.gnu.org/licenses/gpl.html */ (function($) { $.fn.farbtastic = function (options) { $.farbtastic(this, options); return this; }; $.farbtastic = function (container, callback) { var container = $(container).get(0); return container.farbtastic || (container.farbtastic = new $._farbtastic(container, callback)); }; $._farbtastic = function (container, callback) { // Store farbtastic object var fb = this; // Insert markup $(container).html('&lt;div class=&quot;farbtastic&quot;&gt;&lt;div class=&quot;color&quot;&gt;&lt;/div&gt;&lt;div class=&quot;wheel&quot;&gt;&lt;/div&gt;&lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;&lt;div class=&quot;h-marker marker&quot;&gt;&lt;/div&gt;&lt;div class=&quot;sl-marker marker&quot;&gt;&lt;/div&gt;&lt;/div&gt;'); var e = $('.farbtastic', container); fb.wheel = $('.wheel', container).get(0); // Dimensions fb.radius = 84; fb.square = 100; fb.width = 194; // Fix background PNGs in IE6 if (navigator.appVersion.match(/MSIE [0-6]\\./)) { $('*', e).each(function () { if (this.currentStyle.backgroundImage != 'none') { var image = this.currentStyle.backgroundImage; image = this.currentStyle.backgroundImage.substring(5, image.length - 2); $(this).css({ 'backgroundImage': 'none', 'filter': &quot;progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='&quot; + image + &quot;')&quot; }); } }); } /** * Link to the given element(s) or callback. */ fb.linkTo = function (callback) { // Unbind previous nodes if (typeof fb.callback == 'object') { $(fb.callback).unbind('keyup', fb.updateValue); } // Reset color fb.color = null; // Bind callback or elements if (typeof callback == 'function') { fb.callback = callback; } else if (typeof callback == 'object' || typeof callback == 'string') { fb.callback = $(callback); fb.callback.bind('keyup', fb.updateValue); if (fb.callback.get(0).value) { fb.setColor(fb.callback.get(0).value); } } return this; }; fb.updateValue = function (event) { if (this.value &amp;&amp; this.value != fb.color) { fb.setColor(this.value); } }; /** * Change color with HTML syntax #123456 */ fb.setColor = function (color) { var unpack = fb.unpack(color); if (fb.color != color &amp;&amp; unpack) { fb.color = color; fb.rgb = unpack; fb.hsl = fb.RGBToHSL(fb.rgb); fb.updateDisplay(); } return this; }; /** * Change color with HSL triplet [0..1, 0..1, 0..1] */ fb.setHSL = function (hsl) { fb.hsl = hsl; fb.rgb = fb.HSLToRGB(hsl); fb.color = fb.pack(fb.rgb); fb.updateDisplay(); return this; }; ///////////////////////////////////////////////////// /** * Retrieve the coordinates of the given event relative to the center * of the widget. */ fb.widgetCoords = function (event) { var offset = $(fb.wheel).offset(); return { x: (event.pageX - offset.left) - fb.width / 2, y: (event.pageY - offset.top) - fb.width / 2 }; }; /** * Mousedown handler */ fb.mousedown = function (event) { // Capture mouse if (!document.dragging) { $(document).bind('mousemove', fb.mousemove).bind('mouseup', fb.mouseup); document.dragging = true; } // Check which area is being dragged var pos = fb.widgetCoords(event); fb.circleDrag = Math.max(Math.abs(pos.x), Math.abs(pos.y)) * 2 &gt; fb.square; // Process fb.mousemove(event); return false; }; /** * Mousemove handler */ fb.mousemove = function (event) { // Get coordinates relative to color picker center var pos = fb.widgetCoords(event); // Set new HSL parameters if (fb.circleDrag) { var hue = Math.atan2(pos.x, -pos.y) / 6.28; if (hue &lt; 0) hue += 1; fb.setHSL([hue, fb.hsl[1], fb.hsl[2]]); } else { var sat = Math.max(0, Math.min(1, -(pos.x / fb.square) + .5)); var lum = Math.max(0, Math.min(1, -(pos.y / fb.square) + .5)); fb.setHSL([fb.hsl[0], sat, lum]); } return false; }; /** * Mouseup handler */ fb.mouseup = function () { // Uncapture mouse $(document).unbind('mousemove', fb.mousemove); $(document).unbind('mouseup', fb.mouseup); document.dragging = false; }; /** * Update the markers and styles */ fb.updateDisplay = function () { // Markers var angle = fb.hsl[0] * 6.28; $('.h-marker', e).css({ left: Math.round(Math.sin(angle) * fb.radius + fb.width / 2) + 'px', top: Math.round(-Math.cos(angle) * fb.radius + fb.width / 2) + 'px' }); $('.sl-marker', e).css({ left: Math.round(fb.square * (.5 - fb.hsl[1]) + fb.width / 2) + 'px', top: Math.round(fb.square * (.5 - fb.hsl[2]) + fb.width / 2) + 'px' }); // Saturation/Luminance gradient $('.color', e).css('backgroundColor', fb.pack(fb.HSLToRGB([fb.hsl[0], 1, 0.5]))); // Linked elements or callback if (typeof fb.callback == 'object') { // Set background/foreground color $(fb.callback).css({ backgroundColor: fb.color, color: fb.hsl[2] &gt; 0.5 ? '#000' : '#fff' }); // Change linked value $(fb.callback).each(function() { if (this.value &amp;&amp; this.value != fb.color) { this.value = fb.color; } }); } else if (typeof fb.callback == 'function') { fb.callback.call(fb, fb.color); } }; /* Various color utility functions */ fb.pack = function (rgb) { var r = Math.round(rgb[0] * 255); var g = Math.round(rgb[1] * 255); var b = Math.round(rgb[2] * 255); return '#' + (r &lt; 16 ? '0' : '') + r.toString(16) + (g &lt; 16 ? '0' : '') + g.toString(16) + (b &lt; 16 ? '0' : '') + b.toString(16); }; fb.unpack = function (color) { if (color.length == 7) { return [parseInt('0x' + color.substring(1, 3)) / 255, parseInt('0x' + color.substring(3, 5)) / 255, parseInt('0x' + color.substring(5, 7)) / 255]; } else if (color.length == 4) { return [parseInt('0x' + color.substring(1, 2)) / 15, parseInt('0x' + color.substring(2, 3)) / 15, parseInt('0x' + color.substring(3, 4)) / 15]; } }; fb.HSLToRGB = function (hsl) { var m1, m2, r, g, b; var h = hsl[0], s = hsl[1], l = hsl[2]; m2 = (l &lt;= 0.5) ? l * (s + 1) : l + s - l*s; m1 = l * 2 - m2; return [this.hueToRGB(m1, m2, h+0.33333), this.hueToRGB(m1, m2, h), this.hueToRGB(m1, m2, h-0.33333)]; }; fb.hueToRGB = function (m1, m2, h) { h = (h &lt; 0) ? h + 1 : ((h &gt; 1) ? h - 1 : h); if (h * 6 &lt; 1) return m1 + (m2 - m1) * h * 6; if (h * 2 &lt; 1) return m2; if (h * 3 &lt; 2) return m1 + (m2 - m1) * (0.66666 - h) * 6; return m1; }; fb.RGBToHSL = function (rgb) { var min, max, delta, h, s, l; var r = rgb[0], g = rgb[1], b = rgb[2]; min = Math.min(r, Math.min(g, b)); max = Math.max(r, Math.max(g, b)); delta = max - min; l = (min + max) / 2; s = 0; if (l &gt; 0 &amp;&amp; l &lt; 1) { s = delta / (l &lt; 0.5 ? (2 * l) : (2 - 2 * l)); } h = 0; if (delta &gt; 0) { if (max == r &amp;&amp; max != g) h += (g - b) / delta; if (max == g &amp;&amp; max != b) h += (2 + (b - r) / delta); if (max == b &amp;&amp; max != r) h += (4 + (r - g) / delta); h /= 6; } return [h, s, l]; }; // Install mousedown handler (the others are set on the document on-demand) $('*', e).mousedown(fb.mousedown); // Init color fb.setColor('#000000'); // Set linked elements/callback if (callback) { fb.linkTo(callback); } }; })(jQuery); Ã— Search results Close "},"lib_ConfigCache.js.html":{"id":"lib_ConfigCache.js.html","title":"Source: lib/ConfigCache.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/ConfigCache.js /* ConfigCache.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Handles caches for cometvisu configs * * @author Tobias BrÃ¤utigam * @since 0.10.0 */ /* TODO: - cache icons */ define([], function() { var instance; function ConfigCache() { this._cacheKey = &quot;data&quot;; this._parseCacheData = null; this._valid = null; this.dump = function(xml) { this.save(this._cacheKey, { hash: this.toHash(xml), data: templateEngine.widgetData, addresses: templateEngine.ga_list, configSettings: templateEngine.configSettings }); localStorage.setItem(templateEngine.configSuffix+&quot;.body&quot;, $('body').html()); }; this.save = function(key, data) { localStorage.setItem(templateEngine.configSuffix+&quot;.&quot;+key, JSON.stringify(data)); }; this.getBody = function() { return localStorage.getItem(templateEngine.configSuffix + &quot;.body&quot;); }; this.getData = function(key) { if (!this._parseCacheData) { this._parseCacheData = JSON.parse(localStorage.getItem(templateEngine.configSuffix + &quot;.&quot; + this._cacheKey)); } if (!this._parseCacheData) { return null; } if (key) { return this._parseCacheData[key]; } else { return this._parseCacheData; } }; /** * Returns true if there is an existing cache for the current config file */ this.isCached = function() { return localStorage.getItem(templateEngine.configSuffix + &quot;.&quot; + this._cacheKey) !== null; }; this.isValid = function(xml) { // cache the result, as the config stays the same until next reload if (this._valid === null) { var hash = this.toHash(xml); // TODO: remove before release console.log(&quot;Current hash: '%s', cached hash: '%s'&quot;, hash, this.getData(&quot;hash&quot;)); this._valid = hash == this.getData(&quot;hash&quot;); } return this._valid; }; this.toHash = function(xml) { return this.hashCode((new XMLSerializer()).serializeToString(xml)); }; this.clear = function(configSuffix) { configSuffix = configSuffix || templateEngine.configSuffix; localStorage.removeItem(configSuffix+&quot;.&quot;+this._cacheKey); localStorage.removeItem(configSuffix+&quot;.body&quot;); }; /** * @see http://stackoverflow.com/q/7616461/940217 * @return {number} */ this.hashCode = function(string){ if (Array.prototype.reduce){ return string.split(&quot;&quot;).reduce(function(a,b){a=((a&lt;&lt;5)-a)+b.charCodeAt(0);return a&amp;a},0); } var hash = 0; if (string.length === 0) return hash; for (var i = 0, l = string.length; i &lt; l; i++) { var character = string.charCodeAt(i); hash = ((hash&lt;&lt;5)-hash)+character; hash = hash &amp; hash; // Convert to 32bit integer } return hash; } } return { // simulate a singleton getInstance : function() { if (!instance) { instance = new ConfigCache(); } return instance; } }; }); Ã— Search results Close "},"plugins_diagram_dep_flot_excanvas.js.html":{"id":"plugins_diagram_dep_flot_excanvas.js.html","title":"Source: plugins/diagram/dep/flot/excanvas.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: plugins/diagram/dep/flot/excanvas.js // Copyright 2006 Google Inc. // // Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); // you may not use this file except in compliance with the License. // You may obtain a copy of the License at // // http://www.apache.org/licenses/LICENSE-2.0 // // Unless required by applicable law or agreed to in writing, software // distributed under the License is distributed on an &quot;AS IS&quot; BASIS, // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. // See the License for the specific language governing permissions and // limitations under the License. // Known Issues: // // * Patterns only support repeat. // * Radial gradient are not implemented. The VML version of these look very // different from the canvas one. // * Clipping paths are not implemented. // * Coordsize. The width and height attribute have higher priority than the // width and height style values which isn't correct. // * Painting mode isn't implemented. // * Canvas width/height should is using content-box by default. IE in // Quirks mode will draw the canvas using border-box. Either change your // doctype to HTML5 // (http://www.whatwg.org/specs/web-apps/current-work/#the-doctype) // or use Box Sizing Behavior from WebFX // (http://webfx.eae.net/dhtml/boxsizing/boxsizing.html) // * Non uniform scaling does not correctly scale strokes. // * Filling very large shapes (above 5000 points) is buggy. // * Optimize. There is always room for speed improvements. // Only add this code if we do not already have a canvas implementation if (!document.createElement('canvas').getContext) { (function() { // alias some functions to make (compiled) code shorter var m = Math; var mr = m.round; var ms = m.sin; var mc = m.cos; var abs = m.abs; var sqrt = m.sqrt; // this is used for sub pixel precision var Z = 10; var Z2 = Z / 2; var IE_VERSION = +navigator.userAgent.match(/MSIE ([\\d.]+)?/)[1]; /** * This funtion is assigned to the &lt;canvas&gt; elements as element.getContext(). * @this {HTMLElement} * @return {CanvasRenderingContext2D_} */ function getContext() { return this.context_ || (this.context_ = new CanvasRenderingContext2D_(this)); } var slice = Array.prototype.slice; /** * Binds a function to an object. The returned function will always use the * passed in {@code obj} as {@code this}. * * Example: * * g = bind(f, obj, a, b) * g(c, d) // will do f.call(obj, a, b, c, d) * * @param {Function} f The function to bind the object to * @param {Object} obj The object that should act as this when the function * is called * @param {*} var_args Rest arguments that will be used as the initial * arguments when the function is called * @return {Function} A new function that has bound this */ function bind(f, obj, var_args) { var a = slice.call(arguments, 2); return function() { return f.apply(obj, a.concat(slice.call(arguments))); }; } function encodeHtmlAttribute(s) { return String(s).replace(/&amp;/g, '&amp;amp;').replace(/&quot;/g, '&amp;quot;'); } function addNamespace(doc, prefix, urn) { if (!doc.namespaces[prefix]) { doc.namespaces.add(prefix, urn, '#default#VML'); } } function addNamespacesAndStylesheet(doc) { addNamespace(doc, 'g_vml_', 'urn:schemas-microsoft-com:vml'); addNamespace(doc, 'g_o_', 'urn:schemas-microsoft-com:office:office'); // Setup default CSS. Only add one style sheet per document if (!doc.styleSheets['ex_canvas_']) { var ss = doc.createStyleSheet(); ss.owningElement.id = 'ex_canvas_'; ss.cssText = 'canvas{display:inline-block;overflow:hidden;' + // default size is 300x150 in Gecko and Opera 'text-align:left;width:300px;height:150px}'; } } // Add namespaces and stylesheet at startup. addNamespacesAndStylesheet(document); var G_vmlCanvasManager_ = { init: function(opt_doc) { var doc = opt_doc || document; // Create a dummy element so that IE will allow canvas elements to be // recognized. doc.createElement('canvas'); doc.attachEvent('onreadystatechange', bind(this.init_, this, doc)); }, init_: function(doc) { // find all canvas elements var els = doc.getElementsByTagName('canvas'); for (var i = 0; i &lt; els.length; i++) { this.initElement(els[i]); } }, /** * Public initializes a canvas element so that it can be used as canvas * element from now on. This is called automatically before the page is * loaded but if you are creating elements using createElement you need to * make sure this is called on the element. * @param {HTMLElement} el The canvas element to initialize. * @return {HTMLElement} the element that was created. */ initElement: function(el) { if (!el.getContext) { el.getContext = getContext; // Add namespaces and stylesheet to document of the element. addNamespacesAndStylesheet(el.ownerDocument); // Remove fallback content. There is no way to hide text nodes so we // just remove all childNodes. We could hide all elements and remove // text nodes but who really cares about the fallback content. el.innerHTML = ''; // do not use inline function because that will leak memory el.attachEvent('onpropertychange', onPropertyChange); el.attachEvent('onresize', onResize); var attrs = el.attributes; if (attrs.width &amp;&amp; attrs.width.specified) { // TODO: use runtimeStyle and coordsize // el.getContext().setWidth_(attrs.width.nodeValue); el.style.width = attrs.width.nodeValue + 'px'; } else { el.width = el.clientWidth; } if (attrs.height &amp;&amp; attrs.height.specified) { // TODO: use runtimeStyle and coordsize // el.getContext().setHeight_(attrs.height.nodeValue); el.style.height = attrs.height.nodeValue + 'px'; } else { el.height = el.clientHeight; } //el.getContext().setCoordsize_() } return el; } }; function onPropertyChange(e) { var el = e.srcElement; switch (e.propertyName) { case 'width': el.getContext().clearRect(); el.style.width = el.attributes.width.nodeValue + 'px'; // In IE8 this does not trigger onresize. el.firstChild.style.width = el.clientWidth + 'px'; break; case 'height': el.getContext().clearRect(); el.style.height = el.attributes.height.nodeValue + 'px'; el.firstChild.style.height = el.clientHeight + 'px'; break; } } function onResize(e) { var el = e.srcElement; if (el.firstChild) { el.firstChild.style.width = el.clientWidth + 'px'; el.firstChild.style.height = el.clientHeight + 'px'; } } G_vmlCanvasManager_.init(); // precompute &quot;00&quot; to &quot;FF&quot; var decToHex = []; for (var i = 0; i &lt; 16; i++) { for (var j = 0; j &lt; 16; j++) { decToHex[i * 16 + j] = i.toString(16) + j.toString(16); } } function createMatrixIdentity() { return [ [1, 0, 0], [0, 1, 0], [0, 0, 1] ]; } function matrixMultiply(m1, m2) { var result = createMatrixIdentity(); for (var x = 0; x &lt; 3; x++) { for (var y = 0; y &lt; 3; y++) { var sum = 0; for (var z = 0; z &lt; 3; z++) { sum += m1[x][z] * m2[z][y]; } result[x][y] = sum; } } return result; } function copyState(o1, o2) { o2.fillStyle = o1.fillStyle; o2.lineCap = o1.lineCap; o2.lineJoin = o1.lineJoin; o2.lineWidth = o1.lineWidth; o2.miterLimit = o1.miterLimit; o2.shadowBlur = o1.shadowBlur; o2.shadowColor = o1.shadowColor; o2.shadowOffsetX = o1.shadowOffsetX; o2.shadowOffsetY = o1.shadowOffsetY; o2.strokeStyle = o1.strokeStyle; o2.globalAlpha = o1.globalAlpha; o2.font = o1.font; o2.textAlign = o1.textAlign; o2.textBaseline = o1.textBaseline; o2.arcScaleX_ = o1.arcScaleX_; o2.arcScaleY_ = o1.arcScaleY_; o2.lineScale_ = o1.lineScale_; } var colorData = { aliceblue: '#F0F8FF', antiquewhite: '#FAEBD7', aquamarine: '#7FFFD4', azure: '#F0FFFF', beige: '#F5F5DC', bisque: '#FFE4C4', black: '#000000', blanchedalmond: '#FFEBCD', blueviolet: '#8A2BE2', brown: '#A52A2A', burlywood: '#DEB887', cadetblue: '#5F9EA0', chartreuse: '#7FFF00', chocolate: '#D2691E', coral: '#FF7F50', cornflowerblue: '#6495ED', cornsilk: '#FFF8DC', crimson: '#DC143C', cyan: '#00FFFF', darkblue: '#00008B', darkcyan: '#008B8B', darkgoldenrod: '#B8860B', darkgray: '#A9A9A9', darkgreen: '#006400', darkgrey: '#A9A9A9', darkkhaki: '#BDB76B', darkmagenta: '#8B008B', darkolivegreen: '#556B2F', darkorange: '#FF8C00', darkorchid: '#9932CC', darkred: '#8B0000', darksalmon: '#E9967A', darkseagreen: '#8FBC8F', darkslateblue: '#483D8B', darkslategray: '#2F4F4F', darkslategrey: '#2F4F4F', darkturquoise: '#00CED1', darkviolet: '#9400D3', deeppink: '#FF1493', deepskyblue: '#00BFFF', dimgray: '#696969', dimgrey: '#696969', dodgerblue: '#1E90FF', firebrick: '#B22222', floralwhite: '#FFFAF0', forestgreen: '#228B22', gainsboro: '#DCDCDC', ghostwhite: '#F8F8FF', gold: '#FFD700', goldenrod: '#DAA520', grey: '#808080', greenyellow: '#ADFF2F', honeydew: '#F0FFF0', hotpink: '#FF69B4', indianred: '#CD5C5C', indigo: '#4B0082', ivory: '#FFFFF0', khaki: '#F0E68C', lavender: '#E6E6FA', lavenderblush: '#FFF0F5', lawngreen: '#7CFC00', lemonchiffon: '#FFFACD', lightblue: '#ADD8E6', lightcoral: '#F08080', lightcyan: '#E0FFFF', lightgoldenrodyellow: '#FAFAD2', lightgreen: '#90EE90', lightgrey: '#D3D3D3', lightpink: '#FFB6C1', lightsalmon: '#FFA07A', lightseagreen: '#20B2AA', lightskyblue: '#87CEFA', lightslategray: '#778899', lightslategrey: '#778899', lightsteelblue: '#B0C4DE', lightyellow: '#FFFFE0', limegreen: '#32CD32', linen: '#FAF0E6', magenta: '#FF00FF', mediumaquamarine: '#66CDAA', mediumblue: '#0000CD', mediumorchid: '#BA55D3', mediumpurple: '#9370DB', mediumseagreen: '#3CB371', mediumslateblue: '#7B68EE', mediumspringgreen: '#00FA9A', mediumturquoise: '#48D1CC', mediumvioletred: '#C71585', midnightblue: '#191970', mintcream: '#F5FFFA', mistyrose: '#FFE4E1', moccasin: '#FFE4B5', navajowhite: '#FFDEAD', oldlace: '#FDF5E6', olivedrab: '#6B8E23', orange: '#FFA500', orangered: '#FF4500', orchid: '#DA70D6', palegoldenrod: '#EEE8AA', palegreen: '#98FB98', paleturquoise: '#AFEEEE', palevioletred: '#DB7093', papayawhip: '#FFEFD5', peachpuff: '#FFDAB9', peru: '#CD853F', pink: '#FFC0CB', plum: '#DDA0DD', powderblue: '#B0E0E6', rosybrown: '#BC8F8F', royalblue: '#4169E1', saddlebrown: '#8B4513', salmon: '#FA8072', sandybrown: '#F4A460', seagreen: '#2E8B57', seashell: '#FFF5EE', sienna: '#A0522D', skyblue: '#87CEEB', slateblue: '#6A5ACD', slategray: '#708090', slategrey: '#708090', snow: '#FFFAFA', springgreen: '#00FF7F', steelblue: '#4682B4', tan: '#D2B48C', thistle: '#D8BFD8', tomato: '#FF6347', turquoise: '#40E0D0', violet: '#EE82EE', wheat: '#F5DEB3', whitesmoke: '#F5F5F5', yellowgreen: '#9ACD32' }; function getRgbHslContent(styleString) { var start = styleString.indexOf('(', 3); var end = styleString.indexOf(')', start + 1); var parts = styleString.substring(start + 1, end).split(','); // add alpha if needed if (parts.length != 4 || styleString.charAt(3) != 'a') { parts[3] = 1; } return parts; } function percent(s) { return parseFloat(s) / 100; } function clamp(v, min, max) { return Math.min(max, Math.max(min, v)); } function hslToRgb(parts){ var r, g, b, h, s, l; h = parseFloat(parts[0]) / 360 % 360; if (h &lt; 0) h++; s = clamp(percent(parts[1]), 0, 1); l = clamp(percent(parts[2]), 0, 1); if (s == 0) { r = g = b = l; // achromatic } else { var q = l &lt; 0.5 ? l * (1 + s) : l + s - l * s; var p = 2 * l - q; r = hueToRgb(p, q, h + 1 / 3); g = hueToRgb(p, q, h); b = hueToRgb(p, q, h - 1 / 3); } return '#' + decToHex[Math.floor(r * 255)] + decToHex[Math.floor(g * 255)] + decToHex[Math.floor(b * 255)]; } function hueToRgb(m1, m2, h) { if (h &lt; 0) h++; if (h &gt; 1) h--; if (6 * h &lt; 1) return m1 + (m2 - m1) * 6 * h; else if (2 * h &lt; 1) return m2; else if (3 * h &lt; 2) return m1 + (m2 - m1) * (2 / 3 - h) * 6; else return m1; } var processStyleCache = {}; function processStyle(styleString) { if (styleString in processStyleCache) { return processStyleCache[styleString]; } var str, alpha = 1; styleString = String(styleString); if (styleString.charAt(0) == '#') { str = styleString; } else if (/^rgb/.test(styleString)) { var parts = getRgbHslContent(styleString); var str = '#', n; for (var i = 0; i &lt; 3; i++) { if (parts[i].indexOf('%') != -1) { n = Math.floor(percent(parts[i]) * 255); } else { n = +parts[i]; } str += decToHex[clamp(n, 0, 255)]; } alpha = +parts[3]; } else if (/^hsl/.test(styleString)) { var parts = getRgbHslContent(styleString); str = hslToRgb(parts); alpha = parts[3]; } else { str = colorData[styleString] || styleString; } return processStyleCache[styleString] = {color: str, alpha: alpha}; } var DEFAULT_STYLE = { style: 'normal', variant: 'normal', weight: 'normal', size: 10, family: 'sans-serif' }; // Internal text style cache var fontStyleCache = {}; function processFontStyle(styleString) { if (fontStyleCache[styleString]) { return fontStyleCache[styleString]; } var el = document.createElement('div'); var style = el.style; try { style.font = styleString; } catch (ex) { // Ignore failures to set to invalid font. } return fontStyleCache[styleString] = { style: style.fontStyle || DEFAULT_STYLE.style, variant: style.fontVariant || DEFAULT_STYLE.variant, weight: style.fontWeight || DEFAULT_STYLE.weight, size: style.fontSize || DEFAULT_STYLE.size, family: style.fontFamily || DEFAULT_STYLE.family }; } function getComputedStyle(style, element) { var computedStyle = {}; for (var p in style) { computedStyle[p] = style[p]; } // Compute the size var canvasFontSize = parseFloat(element.currentStyle.fontSize), fontSize = parseFloat(style.size); if (typeof style.size == 'number') { computedStyle.size = style.size; } else if (style.size.indexOf('px') != -1) { computedStyle.size = fontSize; } else if (style.size.indexOf('em') != -1) { computedStyle.size = canvasFontSize * fontSize; } else if(style.size.indexOf('%') != -1) { computedStyle.size = (canvasFontSize / 100) * fontSize; } else if (style.size.indexOf('pt') != -1) { computedStyle.size = fontSize / .75; } else { computedStyle.size = canvasFontSize; } // Different scaling between normal text and VML text. This was found using // trial and error to get the same size as non VML text. computedStyle.size *= 0.981; return computedStyle; } function buildStyle(style) { return style.style + ' ' + style.variant + ' ' + style.weight + ' ' + style.size + 'px ' + style.family; } var lineCapMap = { 'butt': 'flat', 'round': 'round' }; function processLineCap(lineCap) { return lineCapMap[lineCap] || 'square'; } /** * This class implements CanvasRenderingContext2D interface as described by * the WHATWG. * @param {HTMLElement} canvasElement The element that the 2D context should * be associated with */ function CanvasRenderingContext2D_(canvasElement) { this.m_ = createMatrixIdentity(); this.mStack_ = []; this.aStack_ = []; this.currentPath_ = []; // Canvas context properties this.strokeStyle = '#000'; this.fillStyle = '#000'; this.lineWidth = 1; this.lineJoin = 'miter'; this.lineCap = 'butt'; this.miterLimit = Z * 1; this.globalAlpha = 1; this.font = '10px sans-serif'; this.textAlign = 'left'; this.textBaseline = 'alphabetic'; this.canvas = canvasElement; var cssText = 'width:' + canvasElement.clientWidth + 'px;height:' + canvasElement.clientHeight + 'px;overflow:hidden;position:absolute'; var el = canvasElement.ownerDocument.createElement('div'); el.style.cssText = cssText; canvasElement.appendChild(el); var overlayEl = el.cloneNode(false); // Use a non transparent background. overlayEl.style.backgroundColor = 'red'; overlayEl.style.filter = 'alpha(opacity=0)'; canvasElement.appendChild(overlayEl); this.element_ = el; this.arcScaleX_ = 1; this.arcScaleY_ = 1; this.lineScale_ = 1; } var contextPrototype = CanvasRenderingContext2D_.prototype; contextPrototype.clearRect = function() { if (this.textMeasureEl_) { this.textMeasureEl_.removeNode(true); this.textMeasureEl_ = null; } this.element_.innerHTML = ''; }; contextPrototype.beginPath = function() { // TODO: Branch current matrix so that save/restore has no effect // as per safari docs. this.currentPath_ = []; }; contextPrototype.moveTo = function(aX, aY) { var p = getCoords(this, aX, aY); this.currentPath_.push({type: 'moveTo', x: p.x, y: p.y}); this.currentX_ = p.x; this.currentY_ = p.y; }; contextPrototype.lineTo = function(aX, aY) { var p = getCoords(this, aX, aY); this.currentPath_.push({type: 'lineTo', x: p.x, y: p.y}); this.currentX_ = p.x; this.currentY_ = p.y; }; contextPrototype.bezierCurveTo = function(aCP1x, aCP1y, aCP2x, aCP2y, aX, aY) { var p = getCoords(this, aX, aY); var cp1 = getCoords(this, aCP1x, aCP1y); var cp2 = getCoords(this, aCP2x, aCP2y); bezierCurveTo(this, cp1, cp2, p); }; // Helper function that takes the already fixed cordinates. function bezierCurveTo(self, cp1, cp2, p) { self.currentPath_.push({ type: 'bezierCurveTo', cp1x: cp1.x, cp1y: cp1.y, cp2x: cp2.x, cp2y: cp2.y, x: p.x, y: p.y }); self.currentX_ = p.x; self.currentY_ = p.y; } contextPrototype.quadraticCurveTo = function(aCPx, aCPy, aX, aY) { // the following is lifted almost directly from // http://developer.mozilla.org/en/docs/Canvas_tutorial:Drawing_shapes var cp = getCoords(this, aCPx, aCPy); var p = getCoords(this, aX, aY); var cp1 = { x: this.currentX_ + 2.0 / 3.0 * (cp.x - this.currentX_), y: this.currentY_ + 2.0 / 3.0 * (cp.y - this.currentY_) }; var cp2 = { x: cp1.x + (p.x - this.currentX_) / 3.0, y: cp1.y + (p.y - this.currentY_) / 3.0 }; bezierCurveTo(this, cp1, cp2, p); }; contextPrototype.arc = function(aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise) { aRadius *= Z; var arcType = aClockwise ? 'at' : 'wa'; var xStart = aX + mc(aStartAngle) * aRadius - Z2; var yStart = aY + ms(aStartAngle) * aRadius - Z2; var xEnd = aX + mc(aEndAngle) * aRadius - Z2; var yEnd = aY + ms(aEndAngle) * aRadius - Z2; // IE won't render arches drawn counter clockwise if xStart == xEnd. if (xStart == xEnd &amp;&amp; !aClockwise) { xStart += 0.125; // Offset xStart by 1/80 of a pixel. Use something // that can be represented in binary } var p = getCoords(this, aX, aY); var pStart = getCoords(this, xStart, yStart); var pEnd = getCoords(this, xEnd, yEnd); this.currentPath_.push({type: arcType, x: p.x, y: p.y, radius: aRadius, xStart: pStart.x, yStart: pStart.y, xEnd: pEnd.x, yEnd: pEnd.y}); }; contextPrototype.rect = function(aX, aY, aWidth, aHeight) { this.moveTo(aX, aY); this.lineTo(aX + aWidth, aY); this.lineTo(aX + aWidth, aY + aHeight); this.lineTo(aX, aY + aHeight); this.closePath(); }; contextPrototype.strokeRect = function(aX, aY, aWidth, aHeight) { var oldPath = this.currentPath_; this.beginPath(); this.moveTo(aX, aY); this.lineTo(aX + aWidth, aY); this.lineTo(aX + aWidth, aY + aHeight); this.lineTo(aX, aY + aHeight); this.closePath(); this.stroke(); this.currentPath_ = oldPath; }; contextPrototype.fillRect = function(aX, aY, aWidth, aHeight) { var oldPath = this.currentPath_; this.beginPath(); this.moveTo(aX, aY); this.lineTo(aX + aWidth, aY); this.lineTo(aX + aWidth, aY + aHeight); this.lineTo(aX, aY + aHeight); this.closePath(); this.fill(); this.currentPath_ = oldPath; }; contextPrototype.createLinearGradient = function(aX0, aY0, aX1, aY1) { var gradient = new CanvasGradient_('gradient'); gradient.x0_ = aX0; gradient.y0_ = aY0; gradient.x1_ = aX1; gradient.y1_ = aY1; return gradient; }; contextPrototype.createRadialGradient = function(aX0, aY0, aR0, aX1, aY1, aR1) { var gradient = new CanvasGradient_('gradientradial'); gradient.x0_ = aX0; gradient.y0_ = aY0; gradient.r0_ = aR0; gradient.x1_ = aX1; gradient.y1_ = aY1; gradient.r1_ = aR1; return gradient; }; contextPrototype.drawImage = function(image, var_args) { var dx, dy, dw, dh, sx, sy, sw, sh; // to find the original width we overide the width and height var oldRuntimeWidth = image.runtimeStyle.width; var oldRuntimeHeight = image.runtimeStyle.height; image.runtimeStyle.width = 'auto'; image.runtimeStyle.height = 'auto'; // get the original size var w = image.width; var h = image.height; // and remove overides image.runtimeStyle.width = oldRuntimeWidth; image.runtimeStyle.height = oldRuntimeHeight; if (arguments.length == 3) { dx = arguments[1]; dy = arguments[2]; sx = sy = 0; sw = dw = w; sh = dh = h; } else if (arguments.length == 5) { dx = arguments[1]; dy = arguments[2]; dw = arguments[3]; dh = arguments[4]; sx = sy = 0; sw = w; sh = h; } else if (arguments.length == 9) { sx = arguments[1]; sy = arguments[2]; sw = arguments[3]; sh = arguments[4]; dx = arguments[5]; dy = arguments[6]; dw = arguments[7]; dh = arguments[8]; } else { throw Error('Invalid number of arguments'); } var d = getCoords(this, dx, dy); var w2 = sw / 2; var h2 = sh / 2; var vmlStr = []; var W = 10; var H = 10; // For some reason that I've now forgotten, using divs didn't work vmlStr.push(' &lt;g_vml_:group', ' coordsize=&quot;', Z * W, ',', Z * H, '&quot;', ' coordorigin=&quot;0,0&quot;' , ' style=&quot;width:', W, 'px;height:', H, 'px;position:absolute;'); // If filters are necessary (rotation exists), create them // filters are bog-slow, so only create them if abbsolutely necessary // The following check doesn't account for skews (which don't exist // in the canvas spec (yet) anyway. if (this.m_[0][0] != 1 || this.m_[0][1] || this.m_[1][1] != 1 || this.m_[1][0]) { var filter = []; // Note the 12/21 reversal filter.push('M11=', this.m_[0][0], ',', 'M12=', this.m_[1][0], ',', 'M21=', this.m_[0][1], ',', 'M22=', this.m_[1][1], ',', 'Dx=', mr(d.x / Z), ',', 'Dy=', mr(d.y / Z), ''); // Bounding box calculation (need to minimize displayed area so that // filters don't waste time on unused pixels. var max = d; var c2 = getCoords(this, dx + dw, dy); var c3 = getCoords(this, dx, dy + dh); var c4 = getCoords(this, dx + dw, dy + dh); max.x = m.max(max.x, c2.x, c3.x, c4.x); max.y = m.max(max.y, c2.y, c3.y, c4.y); vmlStr.push('padding:0 ', mr(max.x / Z), 'px ', mr(max.y / Z), 'px 0;filter:progid:DXImageTransform.Microsoft.Matrix(', filter.join(''), &quot;, sizingmethod='clip');&quot;); } else { vmlStr.push('top:', mr(d.y / Z), 'px;left:', mr(d.x / Z), 'px;'); } vmlStr.push(' &quot;&gt;' , '&lt;g_vml_:image src=&quot;', image.src, '&quot;', ' style=&quot;width:', Z * dw, 'px;', ' height:', Z * dh, 'px&quot;', ' cropleft=&quot;', sx / w, '&quot;', ' croptop=&quot;', sy / h, '&quot;', ' cropright=&quot;', (w - sx - sw) / w, '&quot;', ' cropbottom=&quot;', (h - sy - sh) / h, '&quot;', ' /&gt;', '&lt;/g_vml_:group&gt;'); this.element_.insertAdjacentHTML('BeforeEnd', vmlStr.join('')); }; contextPrototype.stroke = function(aFill) { var W = 10; var H = 10; // Divide the shape into chunks if it's too long because IE has a limit // somewhere for how long a VML shape can be. This simple division does // not work with fills, only strokes, unfortunately. var chunkSize = 5000; var min = {x: null, y: null}; var max = {x: null, y: null}; for (var j = 0; j &lt; this.currentPath_.length; j += chunkSize) { var lineStr = []; var lineOpen = false; lineStr.push('&lt;g_vml_:shape', ' filled=&quot;', !!aFill, '&quot;', ' style=&quot;position:absolute;width:', W, 'px;height:', H, 'px;&quot;', ' coordorigin=&quot;0,0&quot;', ' coordsize=&quot;', Z * W, ',', Z * H, '&quot;', ' stroked=&quot;', !aFill, '&quot;', ' path=&quot;'); var newSeq = false; for (var i = j; i &lt; Math.min(j + chunkSize, this.currentPath_.length); i++) { if (i % chunkSize == 0 &amp;&amp; i &gt; 0) { // move into position for next chunk lineStr.push(' m ', mr(this.currentPath_[i-1].x), ',', mr(this.currentPath_[i-1].y)); } var p = this.currentPath_[i]; var c; switch (p.type) { case 'moveTo': c = p; lineStr.push(' m ', mr(p.x), ',', mr(p.y)); break; case 'lineTo': lineStr.push(' l ', mr(p.x), ',', mr(p.y)); break; case 'close': lineStr.push(' x '); p = null; break; case 'bezierCurveTo': lineStr.push(' c ', mr(p.cp1x), ',', mr(p.cp1y), ',', mr(p.cp2x), ',', mr(p.cp2y), ',', mr(p.x), ',', mr(p.y)); break; case 'at': case 'wa': lineStr.push(' ', p.type, ' ', mr(p.x - this.arcScaleX_ * p.radius), ',', mr(p.y - this.arcScaleY_ * p.radius), ' ', mr(p.x + this.arcScaleX_ * p.radius), ',', mr(p.y + this.arcScaleY_ * p.radius), ' ', mr(p.xStart), ',', mr(p.yStart), ' ', mr(p.xEnd), ',', mr(p.yEnd)); break; } // TODO: Following is broken for curves due to // move to proper paths. // Figure out dimensions so we can do gradient fills // properly if (p) { if (min.x == null || p.x &lt; min.x) { min.x = p.x; } if (max.x == null || p.x &gt; max.x) { max.x = p.x; } if (min.y == null || p.y &lt; min.y) { min.y = p.y; } if (max.y == null || p.y &gt; max.y) { max.y = p.y; } } } lineStr.push(' &quot;&gt;'); if (!aFill) { appendStroke(this, lineStr); } else { appendFill(this, lineStr, min, max); } lineStr.push('&lt;/g_vml_:shape&gt;'); this.element_.insertAdjacentHTML('beforeEnd', lineStr.join('')); } }; function appendStroke(ctx, lineStr) { var a = processStyle(ctx.strokeStyle); var color = a.color; var opacity = a.alpha * ctx.globalAlpha; var lineWidth = ctx.lineScale_ * ctx.lineWidth; // VML cannot correctly render a line if the width is less than 1px. // In that case, we dilute the color to make the line look thinner. if (lineWidth &lt; 1) { opacity *= lineWidth; } lineStr.push( '&lt;g_vml_:stroke', ' opacity=&quot;', opacity, '&quot;', ' joinstyle=&quot;', ctx.lineJoin, '&quot;', ' miterlimit=&quot;', ctx.miterLimit, '&quot;', ' endcap=&quot;', processLineCap(ctx.lineCap), '&quot;', ' weight=&quot;', lineWidth, 'px&quot;', ' color=&quot;', color, '&quot; /&gt;' ); } function appendFill(ctx, lineStr, min, max) { var fillStyle = ctx.fillStyle; var arcScaleX = ctx.arcScaleX_; var arcScaleY = ctx.arcScaleY_; var width = max.x - min.x; var height = max.y - min.y; if (fillStyle instanceof CanvasGradient_) { // TODO: Gradients transformed with the transformation matrix. var angle = 0; var focus = {x: 0, y: 0}; // additional offset var shift = 0; // scale factor for offset var expansion = 1; if (fillStyle.type_ == 'gradient') { var x0 = fillStyle.x0_ / arcScaleX; var y0 = fillStyle.y0_ / arcScaleY; var x1 = fillStyle.x1_ / arcScaleX; var y1 = fillStyle.y1_ / arcScaleY; var p0 = getCoords(ctx, x0, y0); var p1 = getCoords(ctx, x1, y1); var dx = p1.x - p0.x; var dy = p1.y - p0.y; angle = Math.atan2(dx, dy) * 180 / Math.PI; // The angle should be a non-negative number. if (angle &lt; 0) { angle += 360; } // Very small angles produce an unexpected result because they are // converted to a scientific notation string. if (angle &lt; 1e-6) { angle = 0; } } else { var p0 = getCoords(ctx, fillStyle.x0_, fillStyle.y0_); focus = { x: (p0.x - min.x) / width, y: (p0.y - min.y) / height }; width /= arcScaleX * Z; height /= arcScaleY * Z; var dimension = m.max(width, height); shift = 2 * fillStyle.r0_ / dimension; expansion = 2 * fillStyle.r1_ / dimension - shift; } // We need to sort the color stops in ascending order by offset, // otherwise IE won't interpret it correctly. var stops = fillStyle.colors_; stops.sort(function(cs1, cs2) { return cs1.offset - cs2.offset; }); var length = stops.length; var color1 = stops[0].color; var color2 = stops[length - 1].color; var opacity1 = stops[0].alpha * ctx.globalAlpha; var opacity2 = stops[length - 1].alpha * ctx.globalAlpha; var colors = []; for (var i = 0; i &lt; length; i++) { var stop = stops[i]; colors.push(stop.offset * expansion + shift + ' ' + stop.color); } // When colors attribute is used, the meanings of opacity and o:opacity2 // are reversed. lineStr.push('&lt;g_vml_:fill type=&quot;', fillStyle.type_, '&quot;', ' method=&quot;none&quot; focus=&quot;100%&quot;', ' color=&quot;', color1, '&quot;', ' color2=&quot;', color2, '&quot;', ' colors=&quot;', colors.join(','), '&quot;', ' opacity=&quot;', opacity2, '&quot;', ' g_o_:opacity2=&quot;', opacity1, '&quot;', ' angle=&quot;', angle, '&quot;', ' focusposition=&quot;', focus.x, ',', focus.y, '&quot; /&gt;'); } else if (fillStyle instanceof CanvasPattern_) { if (width &amp;&amp; height) { var deltaLeft = -min.x; var deltaTop = -min.y; lineStr.push('&lt;g_vml_:fill', ' position=&quot;', deltaLeft / width * arcScaleX * arcScaleX, ',', deltaTop / height * arcScaleY * arcScaleY, '&quot;', ' type=&quot;tile&quot;', // TODO: Figure out the correct size to fit the scale. //' size=&quot;', w, 'px ', h, 'px&quot;', ' src=&quot;', fillStyle.src_, '&quot; /&gt;'); } } else { var a = processStyle(ctx.fillStyle); var color = a.color; var opacity = a.alpha * ctx.globalAlpha; lineStr.push('&lt;g_vml_:fill color=&quot;', color, '&quot; opacity=&quot;', opacity, '&quot; /&gt;'); } } contextPrototype.fill = function() { this.stroke(true); }; contextPrototype.closePath = function() { this.currentPath_.push({type: 'close'}); }; function getCoords(ctx, aX, aY) { var m = ctx.m_; return { x: Z * (aX * m[0][0] + aY * m[1][0] + m[2][0]) - Z2, y: Z * (aX * m[0][1] + aY * m[1][1] + m[2][1]) - Z2 }; }; contextPrototype.save = function() { var o = {}; copyState(this, o); this.aStack_.push(o); this.mStack_.push(this.m_); this.m_ = matrixMultiply(createMatrixIdentity(), this.m_); }; contextPrototype.restore = function() { if (this.aStack_.length) { copyState(this.aStack_.pop(), this); this.m_ = this.mStack_.pop(); } }; function matrixIsFinite(m) { return isFinite(m[0][0]) &amp;&amp; isFinite(m[0][1]) &amp;&amp; isFinite(m[1][0]) &amp;&amp; isFinite(m[1][1]) &amp;&amp; isFinite(m[2][0]) &amp;&amp; isFinite(m[2][1]); } function setM(ctx, m, updateLineScale) { if (!matrixIsFinite(m)) { return; } ctx.m_ = m; if (updateLineScale) { // Get the line scale. // Determinant of this.m_ means how much the area is enlarged by the // transformation. So its square root can be used as a scale factor // for width. var det = m[0][0] * m[1][1] - m[0][1] * m[1][0]; ctx.lineScale_ = sqrt(abs(det)); } } contextPrototype.translate = function(aX, aY) { var m1 = [ [1, 0, 0], [0, 1, 0], [aX, aY, 1] ]; setM(this, matrixMultiply(m1, this.m_), false); }; contextPrototype.rotate = function(aRot) { var c = mc(aRot); var s = ms(aRot); var m1 = [ [c, s, 0], [-s, c, 0], [0, 0, 1] ]; setM(this, matrixMultiply(m1, this.m_), false); }; contextPrototype.scale = function(aX, aY) { this.arcScaleX_ *= aX; this.arcScaleY_ *= aY; var m1 = [ [aX, 0, 0], [0, aY, 0], [0, 0, 1] ]; setM(this, matrixMultiply(m1, this.m_), true); }; contextPrototype.transform = function(m11, m12, m21, m22, dx, dy) { var m1 = [ [m11, m12, 0], [m21, m22, 0], [dx, dy, 1] ]; setM(this, matrixMultiply(m1, this.m_), true); }; contextPrototype.setTransform = function(m11, m12, m21, m22, dx, dy) { var m = [ [m11, m12, 0], [m21, m22, 0], [dx, dy, 1] ]; setM(this, m, true); }; /** * The text drawing function. * The maxWidth argument isn't taken in account, since no browser supports * it yet. */ contextPrototype.drawText_ = function(text, x, y, maxWidth, stroke) { var m = this.m_, delta = 1000, left = 0, right = delta, offset = {x: 0, y: 0}, lineStr = []; var fontStyle = getComputedStyle(processFontStyle(this.font), this.element_); var fontStyleString = buildStyle(fontStyle); var elementStyle = this.element_.currentStyle; var textAlign = this.textAlign.toLowerCase(); switch (textAlign) { case 'left': case 'center': case 'right': break; case 'end': textAlign = elementStyle.direction == 'ltr' ? 'right' : 'left'; break; case 'start': textAlign = elementStyle.direction == 'rtl' ? 'right' : 'left'; break; default: textAlign = 'left'; } // 1.75 is an arbitrary number, as there is no info about the text baseline switch (this.textBaseline) { case 'hanging': case 'top': offset.y = fontStyle.size / 1.75; break; case 'middle': break; default: case null: case 'alphabetic': case 'ideographic': case 'bottom': offset.y = -fontStyle.size / 2.25; break; } switch(textAlign) { case 'right': left = delta; right = 0.05; break; case 'center': left = right = delta / 2; break; } var d = getCoords(this, x + offset.x, y + offset.y); lineStr.push('&lt;g_vml_:line from=&quot;', -left ,' 0&quot; to=&quot;', right ,' 0.05&quot; ', ' coordsize=&quot;100 100&quot; coordorigin=&quot;0 0&quot;', ' filled=&quot;', !stroke, '&quot; stroked=&quot;', !!stroke, '&quot; style=&quot;position:absolute;width:1px;height:1px;&quot;&gt;'); if (stroke) { appendStroke(this, lineStr); } else { // TODO: Fix the min and max params. appendFill(this, lineStr, {x: -left, y: 0}, {x: right, y: fontStyle.size}); } var skewM = m[0][0].toFixed(3) + ',' + m[1][0].toFixed(3) + ',' + m[0][1].toFixed(3) + ',' + m[1][1].toFixed(3) + ',0,0'; var skewOffset = mr(d.x / Z) + ',' + mr(d.y / Z); lineStr.push('&lt;g_vml_:skew on=&quot;t&quot; matrix=&quot;', skewM ,'&quot; ', ' offset=&quot;', skewOffset, '&quot; origin=&quot;', left ,' 0&quot; /&gt;', '&lt;g_vml_:path textpathok=&quot;true&quot; /&gt;', '&lt;g_vml_:textpath on=&quot;true&quot; string=&quot;', encodeHtmlAttribute(text), '&quot; style=&quot;v-text-align:', textAlign, ';font:', encodeHtmlAttribute(fontStyleString), '&quot; /&gt;&lt;/g_vml_:line&gt;'); this.element_.insertAdjacentHTML('beforeEnd', lineStr.join('')); }; contextPrototype.fillText = function(text, x, y, maxWidth) { this.drawText_(text, x, y, maxWidth, false); }; contextPrototype.strokeText = function(text, x, y, maxWidth) { this.drawText_(text, x, y, maxWidth, true); }; contextPrototype.measureText = function(text) { if (!this.textMeasureEl_) { var s = '&lt;span style=&quot;position:absolute;' + 'top:-20000px;left:0;padding:0;margin:0;border:none;' + 'white-space:pre;&quot;&gt;&lt;/span&gt;'; this.element_.insertAdjacentHTML('beforeEnd', s); this.textMeasureEl_ = this.element_.lastChild; } var doc = this.element_.ownerDocument; this.textMeasureEl_.innerHTML = ''; this.textMeasureEl_.style.font = this.font; // Don't use innerHTML or innerText because they allow markup/whitespace. this.textMeasureEl_.appendChild(doc.createTextNode(text)); return {width: this.textMeasureEl_.offsetWidth}; }; /******** STUBS ********/ contextPrototype.clip = function() { // TODO: Implement }; contextPrototype.arcTo = function() { // TODO: Implement }; contextPrototype.createPattern = function(image, repetition) { return new CanvasPattern_(image, repetition); }; // Gradient / Pattern Stubs function CanvasGradient_(aType) { this.type_ = aType; this.x0_ = 0; this.y0_ = 0; this.r0_ = 0; this.x1_ = 0; this.y1_ = 0; this.r1_ = 0; this.colors_ = []; } CanvasGradient_.prototype.addColorStop = function(aOffset, aColor) { aColor = processStyle(aColor); this.colors_.push({offset: aOffset, color: aColor.color, alpha: aColor.alpha}); }; function CanvasPattern_(image, repetition) { assertImageIsValid(image); switch (repetition) { case 'repeat': case null: case '': this.repetition_ = 'repeat'; break case 'repeat-x': case 'repeat-y': case 'no-repeat': this.repetition_ = repetition; break; default: throwException('SYNTAX_ERR'); } this.src_ = image.src; this.width_ = image.width; this.height_ = image.height; } function throwException(s) { throw new DOMException_(s); } function assertImageIsValid(img) { if (!img || img.nodeType != 1 || img.tagName != 'IMG') { throwException('TYPE_MISMATCH_ERR'); } if (img.readyState != 'complete') { throwException('INVALID_STATE_ERR'); } } function DOMException_(s) { this.code = this[s]; this.message = s +': DOM Exception ' + this.code; } var p = DOMException_.prototype = new Error; p.INDEX_SIZE_ERR = 1; p.DOMSTRING_SIZE_ERR = 2; p.HIERARCHY_REQUEST_ERR = 3; p.WRONG_DOCUMENT_ERR = 4; p.INVALID_CHARACTER_ERR = 5; p.NO_DATA_ALLOWED_ERR = 6; p.NO_MODIFICATION_ALLOWED_ERR = 7; p.NOT_FOUND_ERR = 8; p.NOT_SUPPORTED_ERR = 9; p.INUSE_ATTRIBUTE_ERR = 10; p.INVALID_STATE_ERR = 11; p.SYNTAX_ERR = 12; p.INVALID_MODIFICATION_ERR = 13; p.NAMESPACE_ERR = 14; p.INVALID_ACCESS_ERR = 15; p.VALIDATION_ERR = 16; p.TYPE_MISMATCH_ERR = 17; // set up externs G_vmlCanvasManager = G_vmlCanvasManager_; CanvasRenderingContext2D = CanvasRenderingContext2D_; CanvasGradient = CanvasGradient_; CanvasPattern = CanvasPattern_; DOMException = DOMException_; })(); } // if Ã— Search results Close "},"lib_EventHandler.js.html":{"id":"lib_EventHandler.js.html","title":"Source: lib/EventHandler.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/EventHandler.js /* EventHandler.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ define([], function() { /** * General handler for all mouse and touch actions. * * The general flow of mouse actions are: * 1. mousedown - &quot;button pressed&quot; * 2. mouseout - &quot;button released&quot; * 3. mouseout (mouse moved inside again) - &quot;button pressed&quot; * 4. mouseup - &quot;button released&quot; * * 2. gets mapped to a action cancel event * 3. gets mapped to a mousedown event * 2. and 3. can be repeated unlimited - or also be left out. * 4. triggers the real action * * For touch it's a little different as a touchmove cancels the current * action and translates into a scroll. * * All of this is the default or when the mousemove callback is returning * restrict=true (or undefined). * When restrict=false the widget captures the mouse until it is released. */ function EventHandler(templateEngine) { this._navbarRegEx = /navbar/; this._isTouchDevice = !!('ontouchstart' in window) || // works on most browsers !!('onmsgesturechange' in window); // works on ie10 this._isWidget = false; this._scrollElement = null; // object to hold the coordinated of the current mouse / touch event this._mouseEvent = templateEngine.handleMouseEvent = { moveFn: undefined, moveRestrict: true, actor: undefined, widget: undefined, widgetCreator: undefined, downtime: 0, alreadyCanceled: false }; this._touchStartX = null; this._touchStartY = null; // helper function to get the current actor and widget out of an event: this.getWidgetActor = function (element) { var actor, widget; while (element) { if (element.classList.contains('actor') || (element.classList.contains('group') &amp;&amp; element.classList.contains('clickable'))) { actor = element; } if (element.classList.contains('widget_container')) { widget = element; if (templateEngine.design.creators[widget.dataset.type].action !== undefined) { return {actor: actor, widget: widget}; } } if (element.classList.contains('page')) { // abort traversal return {actor: actor, widget: widget}; } element = element.parentElement; } return false; }; // helper function to determine the element to scroll (or undefined) this.getScrollElement = function (element) { while (element) { if (element.classList.contains('page')) { return this._navbarRegEx.test(element.id) ? undefined : element; } if (element.classList.contains('navbar')) { var parent = element.parentElement; if ('navbarTop' === parent.id || 'navbarBottom' === parent.id) { return element; } return; } element = element.parentElement; } }; this.onPointerDown = function (event) { // search if a widget was hit var widgetActor = this.getWidgetActor(event.target), bindWidget = widgetActor.widget ? templateEngine.widgetDataGet(widgetActor.widget.id).bind_click_to_widget : false; var touchobj; if (event.changedTouches) { touchobj = event.changedTouches[0]; this._touchStartX = parseInt(touchobj.clientX); this._touchStartY = parseInt(touchobj.clientY); } else { this._touchStartX = parseInt(event.clientX); this._touchStartY = parseInt(event.clientY); } this._isWidget = widgetActor.widget !== undefined &amp;&amp; (bindWidget || widgetActor.actor !== undefined); if (this._isWidget) { this._mouseEvent.actor = widgetActor.actor; this._mouseEvent.widget = widgetActor.widget; this._mouseEvent.widgetCreator = templateEngine.design.creators[widgetActor.widget.dataset.type]; this._mouseEvent.downtime = Date.now(); this._mouseEvent.alreadyCanceled = false; var actionFn = this._mouseEvent.widgetCreator.downaction; if (actionFn !== undefined) { var moveFnInfo = actionFn.call(this._mouseEvent.widget, this._mouseEvent.widget.id, this._mouseEvent.actor, false, event); if (moveFnInfo) { this._mouseEvent.moveFn = moveFnInfo.callback; this._mouseEvent.moveRestrict = moveFnInfo.restrict !== undefined ? moveFnInfo.restrict : true; } } } else { this._mouseEvent.actor = undefined; } if (this._mouseEvent.moveRestrict) { this._scrollElement = this.getScrollElement(event.target); } // stop the propagation if scrollable is at the end // inspired by if (this._scrollElement) { var startTopScroll = this._scrollElement.scrollTop; if (startTopScroll &lt;= 0) { this._scrollElement.scrollTop = 1; } if (startTopScroll + this._scrollElement.offsetHeight &gt;= this._scrollElement.scrollHeight) { this._scrollElement.scrollTop = this._scrollElement.scrollHeight - this._scrollElement.offsetHeight - 1; } } }; this.onPointerUp = function (event) { if (this._isWidget) { var widgetActor = this.getWidgetActor(event.target), widget = this._mouseEvent.widget, actionFn = this._mouseEvent.widgetCreator.action, bindWidget = templateEngine.widgetDataGet(widget.id).bind_click_to_widget, inCurrent = widgetActor.widget === widget &amp;&amp; (bindWidget || widgetActor.actor === this._mouseEvent.actor); if ( actionFn !== undefined &amp;&amp; inCurrent &amp;&amp; !this._mouseEvent.alreadyCanceled ) { actionFn.call(widget, widget.id, this._mouseEvent.actor, !inCurrent, event); } this._mouseEvent.moveFn = undefined; this._mouseEvent.moveRestrict = true; this._scrollElement = undefined; this._isWidget = false; } }; /** * mouse move: let the user cancel an action by dragging the mouse outside * and reactivate it when the dragged cursor is returning * @param event {Event} * @private */ this._onPointerMoveNoTouch = function (event) { if (this._isWidget) { var actionFn = null, widgetActor = this.getWidgetActor(event.target), widget = this._mouseEvent.widget, bindWidget = templateEngine.widgetDataGet(widget.id).bind_click_to_widget, inCurrent = !this._mouseEvent.moveRestrict || (widgetActor.widget === widget &amp;&amp; (bindWidget || widgetActor.actor === this._mouseEvent.actor)); if (inCurrent &amp;&amp; this._mouseEvent.moveFn) { this._mouseEvent.moveFn(event); } if (inCurrent &amp;&amp; this._mouseEvent.alreadyCanceled) { // reactivate this._mouseEvent.alreadyCanceled = false; actionFn = this._mouseEvent.widgetCreator.downaction; if (actionFn) { actionFn.call(widget, widget.id, this._mouseEvent.actor, false, event); } } else if ((!inCurrent &amp;&amp; !this._mouseEvent.alreadyCanceled)) { // cancel this._mouseEvent.alreadyCanceled = true; actionFn = this._mouseEvent.widgetCreator.action; if (actionFn) { actionFn.call(widget, widget.id, this._mouseEvent.actor, true, event); } } } }; /** * touch move: scroll when the finger is moving and cancel any pending * actions at the same time * @private */ this._onPointerMoveTouch = function (event) { if (this._isWidget) { var widget = this._mouseEvent.widget, touchobj = event.changedTouches[0]; if (this._mouseEvent.moveFn) { this._mouseEvent.moveFn(event); } // cancel when finger moved more than 5px if (this._mouseEvent.moveRestrict &amp;&amp; !this._mouseEvent.alreadyCanceled &amp;&amp; (Math.abs(this._touchStartX - parseInt(touchobj.clientX)) &gt; 5 || Math.abs(this._touchStartY - parseInt(touchobj.clientY)) &gt; 5 )) { // cancel this._mouseEvent.alreadyCanceled = true; var actionFn = this._mouseEvent.widgetCreator.action; if (actionFn) { actionFn.call(widget, widget.id, this._mouseEvent.actor, true, event); } } } // take care to prevent overscroll if (this._scrollElement) { var scrollTop = this._scrollElement.scrollTop, scrollLeft = this._scrollElement.scrollLeft; // prevent scrolling of an element that takes full height and width // as it doesn't need scrolling if ((scrollTop &lt;= 0) &amp;&amp; (scrollTop + this._scrollElement.offsetHeight &gt;= this._scrollElement.scrollHeight) &amp;&amp; (scrollLeft &lt;= 0) &amp;&amp; (scrollLeft + this._scrollElement.offsetWidth &gt;= this._scrollElement.scrollWidth )) { return; } event.stopPropagation(); } else { event.preventDefault(); } }; /** * The dispatcher registers listeners for all relevant events to the window object * and dispatched the event to the EventHandler. The dispatcher listens to similar events * like touchstart and mousedown but makes sure that these events are not fired * * @param handler * @constructor */ var Dispatcher = function(handler) { /** * register to all events */ this.register = function() { window.addEventListener('mousedown', this._onDown); window.addEventListener('touchstart', this._onDown); window.addEventListener('mouseup', this._onUp); window.addEventListener('touchend', this._onUp); window.addEventListener('mousemove', this._onMove); window.addEventListener('touchmove', this._onMove); }; this._onDown = function(event) { handler.onPointerDown(event); }; this._onUp = function(event) { handler.onPointerUp(event); if (event.type === &quot;touchend&quot;) { // prevent mouseup beeing fired event.preventDefault(); } }; this._onMove = function(event) { // dispatch by event type if (event.type === &quot;mousemove&quot;) { handler._onPointerMoveNoTouch(event); } else if (event.type === &quot;touchmove&quot;) { handler._onPointerMoveTouch(event); } else{ console.error(&quot;onhandled event type &quot;+event.type); } }; }; this.dispatcher = new Dispatcher(this); this.dispatcher.register(); } return EventHandler; }); Ã— Search results Close "},"plugins_diagram_dep_flot_jquery.flot.tooltip.js.html":{"id":"plugins_diagram_dep_flot_jquery.flot.tooltip.js.html","title":"Source: plugins/diagram/dep/flot/jquery.flot.tooltip.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: plugins/diagram/dep/flot/jquery.flot.tooltip.js /* * jquery.flot.tooltip * * description: easy-to-use tooltips for Flot charts * version: 0.6.6 * author: Krzysztof Urbas @krzysu [myviews.pl] * website: https://github.com/krzysu/flot.tooltip * * build on 2014-02-10 * released under MIT License, 2012 */ (function ($) { // plugin options, default values var defaultOptions = { tooltip: false, tooltipOpts: { content: &quot;%s | X: %x | Y: %y&quot;, // allowed templates are: // %s -&gt; series label, // %x -&gt; X value, // %y -&gt; Y value, // %x.2 -&gt; precision of X value, // %p -&gt; percent xDateFormat: null, yDateFormat: null, monthNames: null, dayNames: null, shifts: { x: 10, y: 20 }, defaultTheme: true, // callbacks onHover: function(flotItem, $tooltipEl) {} } }; // object var FlotTooltip = function(plot) { // variables this.tipPosition = {x: 0, y: 0}; this.init(plot); }; // main plugin function FlotTooltip.prototype.init = function(plot) { var that = this; plot.hooks.bindEvents.push(function (plot, eventHolder) { // get plot options that.plotOptions = plot.getOptions(); // if not enabled return if (that.plotOptions.tooltip === false || typeof that.plotOptions.tooltip === 'undefined') return; // shortcut to access tooltip options that.tooltipOptions = that.plotOptions.tooltipOpts; // create tooltip DOM element var $tip = that.getDomElement(); // bind event $( plot.getPlaceholder() ).bind(&quot;plothover&quot;, plothover); $(eventHolder).bind('mousemove', mouseMove); }); plot.hooks.shutdown.push(function (plot, eventHolder){ $(plot.getPlaceholder()).unbind(&quot;plothover&quot;, plothover); $(eventHolder).unbind(&quot;mousemove&quot;, mouseMove); }); function mouseMove(e){ var pos = {}; pos.x = e.pageX; pos.y = e.pageY; that.updateTooltipPosition(pos); } function plothover(event, pos, item) { var $tip = that.getDomElement(); if (item) { var tipText; // convert tooltip content template to real tipText tipText = that.stringFormat(that.tooltipOptions.content, item); $tip.html( tipText ); that.updateTooltipPosition({ x: pos.pageX, y: pos.pageY }); $tip.css({ left: that.tipPosition.x + that.tooltipOptions.shifts.x, top: that.tipPosition.y + that.tooltipOptions.shifts.y }) .show(); // run callback if(typeof that.tooltipOptions.onHover === 'function') { that.tooltipOptions.onHover(item, $tip); } } else { $tip.hide().html(''); } } }; /** * get or create tooltip DOM element * @return jQuery object */ FlotTooltip.prototype.getDomElement = function() { var $tip; if( $('#flotTip').length &gt; 0 ){ $tip = $('#flotTip'); } else { $tip = $('&lt;div /&gt;').attr('id', 'flotTip'); $tip.appendTo('body').hide().css({position: 'absolute'}); if(this.tooltipOptions.defaultTheme) { $tip.css({ 'background': '#fff', 'z-index': '1040', 'padding': '0.4em 0.6em', 'border-radius': '0.5em', 'font-size': '0.8em', 'border': '1px solid #111', 'display': 'none', 'white-space': 'nowrap' }); } } return $tip; }; // as the name says FlotTooltip.prototype.updateTooltipPosition = function(pos) { var totalTipWidth = $(&quot;#flotTip&quot;).outerWidth() + this.tooltipOptions.shifts.x; var totalTipHeight = $(&quot;#flotTip&quot;).outerHeight() + this.tooltipOptions.shifts.y; if ((pos.x - $(window).scrollLeft()) &gt; ($(window).innerWidth() - totalTipWidth)) { pos.x -= totalTipWidth; } if ((pos.y - $(window).scrollTop()) &gt; ($(window).innerHeight() - totalTipHeight)) { pos.y -= totalTipHeight; } this.tipPosition.x = pos.x; this.tipPosition.y = pos.y; }; /** * core function, create tooltip content * @param {string} content - template with tooltip content * @param {object} item - Flot item * @return {string} real tooltip content for current item */ FlotTooltip.prototype.stringFormat = function(content, item) { var percentPattern = /%p\\.{0,1}(\\d{0,})/; var seriesPattern = /%s/; var xPattern = /%x\\.{0,1}(\\d{0,})/; var yPattern = /%y\\.{0,1}(\\d{0,})/; var xPatternWithoutPrecision = &quot;%x&quot;; var yPatternWithoutPrecision = &quot;%y&quot;; var x = item.datapoint[0]; var y = item.datapoint[1]; // I think this is only in case of threshold plugin if (item.series.label === null &amp;&amp; item.series.originSeries) { item.series.label = item.series.originSeries.label; } // if it is a function callback get the content string if( typeof(content) === 'function' ) { content = content(item.series.label, x, y, item); } // percent match for pie charts if( typeof (item.series.percent) !== 'undefined' ) { content = this.adjustValPrecision(percentPattern, content, item.series.percent); } // series match if( typeof(item.series.label) !== 'undefined' ) { content = content.replace(seriesPattern, item.series.label); } else { //remove %s if label is undefined content = content.replace(seriesPattern, &quot;&quot;); } // time mode axes with custom dateFormat if(this.isTimeMode('xaxis', item) &amp;&amp; this.isXDateFormat(item)) { content = content.replace(xPattern, this.timestampToDate(x, this.tooltipOptions.xDateFormat)); } if(this.isTimeMode('yaxis', item) &amp;&amp; this.isYDateFormat(item)) { content = content.replace(yPattern, this.timestampToDate(y, this.tooltipOptions.yDateFormat)); } // set precision if defined if(typeof x === 'number') { content = this.adjustValPrecision(xPattern, content, x); } if(typeof y === 'number') { content = this.adjustValPrecision(yPattern, content, y); } // change x from number to given label, if given if(typeof item.series.xaxis.ticks !== 'undefined') { if(item.series.xaxis.ticks.length &gt; item.dataIndex &amp;&amp; !this.isTimeMode('xaxis', item)) content = content.replace(xPattern, item.series.xaxis.ticks[item.dataIndex].label); } // change y from number to given label, if given if(typeof item.series.yaxis.ticks !== 'undefined') { for (var index in item.series.yaxis.ticks) { if (item.series.yaxis.ticks.hasOwnProperty(index)) { var value = (this.isCategoriesMode('yaxis', item)) ? item.series.yaxis.ticks[index].label : item.series.yaxis.ticks[index].v; if (value === y) { content = content.replace(yPattern, item.series.yaxis.ticks[index].label); } } } } // if no value customization, use tickFormatter by default if(typeof item.series.xaxis.tickFormatter !== 'undefined') { //escape dollar content = content.replace(xPatternWithoutPrecision, item.series.xaxis.tickFormatter(x, item.series.xaxis).replace(/\\$/g, '$$')); } if(typeof item.series.yaxis.tickFormatter !== 'undefined') { //escape dollar content = content.replace(yPatternWithoutPrecision, item.series.yaxis.tickFormatter(y, item.series.yaxis).replace(/\\$/g, '$$')); } return content; }; // helpers just for readability FlotTooltip.prototype.isTimeMode = function(axisName, item) { return (typeof item.series[axisName].options.mode !== 'undefined' &amp;&amp; item.series[axisName].options.mode === 'time'); }; FlotTooltip.prototype.isXDateFormat = function(item) { return (typeof this.tooltipOptions.xDateFormat !== 'undefined' &amp;&amp; this.tooltipOptions.xDateFormat !== null); }; FlotTooltip.prototype.isYDateFormat = function(item) { return (typeof this.tooltipOptions.yDateFormat !== 'undefined' &amp;&amp; this.tooltipOptions.yDateFormat !== null); }; FlotTooltip.prototype.isCategoriesMode = function(axisName, item) { return (typeof item.series[axisName].options.mode !== 'undefined' &amp;&amp; item.series[axisName].options.mode === 'categories'); }; // FlotTooltip.prototype.timestampToDate = function(tmst, dateFormat) { var theDate = new Date(tmst*1); return $.plot.formatDate(theDate, dateFormat, this.tooltipOptions.monthNames, this.tooltipOptions.dayNames); }; // FlotTooltip.prototype.adjustValPrecision = function(pattern, content, value) { var precision; var matchResult = content.match(pattern); if( matchResult !== null ) { if(RegExp.$1 !== '') { precision = RegExp.$1; value = value.toFixed(precision); // only replace content if precision exists, in other case use thickformater content = content.replace(pattern, value); } } return content; }; // var init = function(plot) { new FlotTooltip(plot); }; // define Flot plugin $.plot.plugins.push({ init: init, options: defaultOptions, name: 'tooltip', version: '0.6.6' }); })(jQuery); Ã— Search results Close "},"lib_IconHandler.js.html":{"id":"lib_IconHandler.js.html","title":"Source: lib/IconHandler.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/IconHandler.js /* IconHandler.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * @author Christian Mayer * @since 2012 */ define( ['icon/iconconfig'], function( iconconfig ) { &quot;use strict&quot;; /** * The object &quot;icon&quot; contains the whole API necessary to handle the icons. * * @class icon * @constructor FOO */ function icon() { // Konstruktor // ////////////////////////////////////////////////////////////////////////// // private static variables and methods: // ... none ... // check and fix if the user forgot the &quot;new&quot; keyword if (!(this instanceof icon)) { return new icon(); } // ////////////////////////////////////////////////////////////////////////// // Definition of the private variables /** * Internal database of the known icons. * Initially filled with the default icons. * * @property db * @private */ var db = iconconfig; // ////////////////////////////////////////////////////////////////////////// // Definition of the public variables /* ... */ // ////////////////////////////////////////////////////////////////////////// // Definition of the private methods /* ... */ // ////////////////////////////////////////////////////////////////////////// // Definition of the public methods /** * Insert or overwrite one or many icons into the database. The parameter * might be a full hash of icon definitions or a single one consisting out of * a name and a URI path. Optional further parameters are a &quot;type&quot; and a * flavour. */ this.insert = function() { var name = arguments[0]; var uri = arguments[1]; var type = arguments[2] || '*'; var flavour = arguments[3] || '*'; var color = arguments[4] || '*'; var styling = arguments[5]; var dynamic = arguments[6]; if (!db[name]) db[name] = {}; if (!db[name][type]) db[name][type] = {}; if (!db[name][type][flavour]) db[name][type][flavour] = {}; if( dynamic &amp;&amp; window[ dynamic ] ) db[name][type][flavour][color] = window[ dynamic ]( uri ); else db[name][type][flavour][color] = { uri : uri, styling: styling }; } /** * Get the icon information for a name. * * @method get * @param {String} * name Name * @param {String} * type Type (optional) * @param {String} * flavour Flavour (optional) * @param {String} * color Color (optional, only relevant for monochrome icons) * @return {URI} The URI for the icon - or &quot;undefined&quot; if not known */ this.get = function() { var name = arguments[0]; var type = arguments[1]; var flavour = arguments[2]; var color = arguments[3]; if (!db[name]) return undefined; if (!db[name][type]) type = '*'; // undefined -&gt; use default if (typeof db[name][type] === 'string') { type = db[name][type]; // redirect link if( type.split('/').length &gt; 1 ) { var all = type.split('/'); type = all.shift(); if( flavour === undefined ) flavour = all.shift(); } } if (!db[name][type][flavour]) flavour = '*'; // undefined -&gt; use default if (typeof db[name][type][flavour] === 'string') { flavour = db[name][type][flavour]; // redirect link if( flavour.split('/').length &gt; 1 ) { var all = flavour.split('/'); flavour = all.shift(); if( color === undefined ) color = all.shift(); } } if (!db[name][type][flavour][color]) color = '*'; // undefined -&gt; use default // handle a generic mapping function if (typeof db[name][type][flavour]['*'] === 'function') return db[name][type][flavour]['*']; if (typeof db[name][type][flavour][color] === 'string') color = db[name][type][flavour][color]; // redirect link return db[name][type][flavour][color]; } this.getURI = function() { var i = this.get.apply(this, arguments); if (i) return i.uri; } /** * Return an icon DOM element. */ this.getIconElement = function() { var i = this.get.apply(this, arguments); if (i) { var styling = arguments[4]; if( i.icon &amp;&amp; styling === undefined &amp;&amp; typeof i !== 'function' ) return i.icon; // fetch and cache image if( styling === undefined ) styling = i.styling === undefined ? '' : ' style=&quot;' + i.styling + '&quot;'; else styling = ' style=&quot;' + styling + '&quot;'; var classes = 'icon' var iconclass = arguments[5]; if( iconclass !== undefined) { classes = classes + ' custom_' + iconclass; } if( typeof i === 'function' ) { i.icon = i( arguments[3], styling, classes, false ); } else { i.icon = $('&lt;img class=&quot;' + classes + '&quot; src=&quot;' + i.uri + '&quot;' + styling + '/&gt;')[0]; } return i.icon; } } /** * Return a String for the icon, e.g. build a DOM tree in a string before * passing it to ParseHTML. After the content was added to the DOM the * fillIcons method must be called to fill missing content (e.g. the &lt;canvas&gt; * icons. * @param {String} * name Name * @param {String} * type Type (optional) * @param {String} * flavour Flavour (optional) * @param {String} * color Color (optional, only relevant for monochrome icons) * @param {String} * styling * @param {String} * iconclass */ this.getIconText = function() { var i = this.get.apply(this, arguments); if (i) { var styling = arguments[4]; if( styling === undefined ) styling = i.styling === undefined ? '' : ' style=&quot;' + i.styling + '&quot;'; else styling = ' style=&quot;' + styling + '&quot;'; var classes = 'icon' var iconclass = arguments[5]; if( iconclass !== undefined) { classes = classes + ' custom_' + iconclass; } if( typeof i === 'function' ) { return i( arguments[3], styling, classes, true ); } else { return '&lt;img class=&quot;' + classes + '&quot; src=&quot;' + i.uri + '&quot;' + styling + '/&gt;'; } } } /** * Fill the icons in the array. */ this.fillIcons = function( array ) { array.each( function( thisIcon ){ window.fillRecoloredIcon( thisIcon ); }); }; /** * List all known icons * * @method list * @return {Array} List of all known icon names */ this.list = function() { return Object.keys(db); } /** * Return icon database for debuging purposes - use ONLY for debugging as it's * circumventing the data hiding and exposes a writeable reference to the * database object! * * @method debug * @return {Object} The icon database */ this.debug = function() { return db; } }; window.icons = new icon(); }); Ã— Search results Close "},"lib_TemplateEngine.js.html":{"id":"lib_TemplateEngine.js.html","title":"Source: lib/TemplateEngine.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/TemplateEngine.js /* TemplateEngine.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Main Template engine * * @author Christian Mayer * @since 2010 * @module lib/TemplateEngine * @requires dependencies/jquery * @requires structure/pure * @requires config/structure_custom * @requires lib/TrickOMatic * @requires lib/PageHandler * @requires lib/PagePartsHandler * @requires lib/CometVisuClient * @requires lib/mockup/Client * @requires lib/EventHandler */ /////////////////////////////////////////////////////////////////////// // // Main: // define([ 'jquery', '_common', 'structure_custom', 'TrickOMatic', 'PageHandler', 'PagePartsHandler', 'CometVisuClient', 'CometVisuMockup', 'EventHandler', 'MessageBroker', 'ConfigCache', 'Compatibility', 'jquery-ui', 'strftime', 'jquery.ui.touch-punch', 'jquery.svg.min', 'IconHandler', 'widget_break', 'widget_designtoggle', 'widget_group', 'widget_rgb', 'widget_web', 'widget_image', 'widget_imagetrigger', 'widget_include', 'widget_info', 'widget_infoaction', 'widget_infotrigger', 'widget_line', 'widget_multitrigger', 'widget_navbar', 'widget_page', 'widget_pagejump', 'widget_refresh', 'widget_reload', 'widget_slide', 'widget_switch', 'widget_text', 'widget_toggle', 'widget_trigger', 'widget_pushbutton', 'widget_urltrigger', 'widget_unknown', 'widget_audio', 'widget_video', 'widget_wgplugin_info', 'TransformDefault', 'TransformKnx', 'TransformOpenHab' ], function( $, design, VisuDesign_Custom, Trick_O_Matic, PageHandler, PagePartsHandler, CometVisu, ClientMockup, EventHandler, MessageBroker, ConfigCache ) { &quot;use strict&quot;; var instance; function TemplateEngine( undefined ) { var thisTemplateEngine = this; this.libraryVersion = 7; this.libraryCheck = true; if ($.getUrlVar('libraryCheck')) { this.libraryCheck = $.getUrlVar('libraryCheck') != 'false'; // true unless set to false } var loadReady = { page: false, plugins: false }; function delaySetup( id ) { loadReady[ id ] = false; return function() { delete loadReady[ id ]; thisTemplateEngine.setup_page(); }; }; this.design = new VisuDesign_Custom(); this.pagePartsHandler = new PagePartsHandler(); this.eventHandler = new EventHandler(this); this.messageBroker = MessageBroker.getInstance(); this.configCache = ConfigCache.getInstance(); var rememberLastPage = false; this.currentPage = null; this.currentPageNavbarVisibility = null; this.configSettings = { currentPageUnavailableWidth: -1, currentPageUnavailableHeight: -1, // if true the whole widget reacts on click events // if false only the actor in the widget reacts on click events bindClickToWidget: false, // threshold where the mobile.css is loaded maxMobileScreenWidth: 480, // threshold where different colspans are used maxScreenWidthColspanS: 599, maxScreenWidthColspanM: 839, mappings: {}, // store the mappings stylings: {} // store the stylings }; // use to recognize if the screen width has crossed the maxMobileScreenWidth var lastBodyWidth=0; this.ga_list = {}; this.widgetData = {}; // hash to store all widget specific data this.configSuffix; if ($.getUrlVar(&quot;config&quot;)) { this.configSuffix = $.getUrlVar(&quot;config&quot;); } if ($.getUrlVar('enableCache') === &quot;invalid&quot;) { this.configCache.clear(this.configSuffix); this.enableCache = true; } else { this.enableCache = $.getUrlVar('enableCache') ? $.getUrlVar('enableCache') === &quot;true&quot; : true; } /** * Return (reference to) widgetData object by path. */ this.widgetDataGet = function( path ) { return this.widgetData[ path ] || (this.widgetData[ path ] = {}); }; /** * Return (reference to) widget data by element */ this.widgetDataGetByElement = function( element ) { var parent = $(element).parent(), path = parent.attr('id'); if( path === undefined ) path = parent.parent().attr('id'); return this.widgetDataGet( path ); }; /** * Merge obj in the widgetData. */ this.widgetDataInsert = function( path, obj ) { var thisWidgetData = this.widgetDataGet( path ); for( var attrname in obj ) thisWidgetData[ attrname ] = obj[ attrname ]; return thisWidgetData; }; /** * Structure where a design can set a default value that a widget or plugin * can use. * This is especially important for design relevant information like colors * that can not be set though CSS. * * Useage: templateEngine.defaults.plugin.foo = {bar: 'baz'}; */ this.defaults = { widget: {}, plugin: {} }; /** * Function to test if the path is in a valid form. * Note: it doesn't check if it exists! */ var pathRegEx = /^id(_[0-9]+)+$/; this.main_scroll; this.old_scroll = ''; this.visu; this.scrollSpeed; this.defaultColumns = 12; this.minColumnWidth = 120; this.enableAddressQueue = $.getUrlVar('enableQueue') ? true : false; this.configSettings.backend = 'default'; if ($.getUrlVar(&quot;backend&quot;)) { this.configSettings.backend = $.getUrlVar(&quot;backend&quot;); } this.initBackendClient = function() { if ($.getUrlVar('testMode')) { thisTemplateEngine.visu = new ClientMockup(); require(['TransformMockup'], function() {}); } else if (thisTemplateEngine.configSettings.backend==&quot;oh&quot;) { thisTemplateEngine.visu = new CometVisu('openhab', thisTemplateEngine.configSettings.backendUrl); } else if (thisTemplateEngine.configSettings.backend==&quot;oh2&quot;) { thisTemplateEngine.visu = new CometVisu('openhab2', thisTemplateEngine.configSettings.backendUrl); } else { thisTemplateEngine.visu = new CometVisu(thisTemplateEngine.configSettings.backend, thisTemplateEngine.configSettings.backendUrl); } function update(json) { for( var key in json ) { //$.event.trigger('_' + key, json[key]); if( !(key in thisTemplateEngine.ga_list) ) continue; var data = json[ key ]; thisTemplateEngine.ga_list[ key ].forEach( function( id ){ if( typeof id === 'string' ) { var element = document.getElementById( id ); if (element) { var type = element.dataset.type || 'page'; // only pages have no datatype set var updateFn = thisTemplateEngine.design.creators[type].update; if (updateFn) { var children = element.children; if (children[0]) updateFn.call(children[0], key, data); else updateFn.call(element, key, data); } } else { console.error(&quot;no element with id %s found&quot;, id); } //console.log( element, type, updateFn ); } else if( typeof id === 'function' ) { id.call( key, data ); } }); } }; thisTemplateEngine.visu.update = function(json) { // overload the handler profileCV( 'first data start (' + thisTemplateEngine.visu.retryCounter + ')' ); update( json ); profileCV( 'first data updated', true ); thisTemplateEngine.visu.update = update; // handle future requests directly } thisTemplateEngine.visu.user = 'demo_user'; // example for setting a user }; this.configSettings.clientDesign = &quot;&quot;; if (typeof this.forceReload == &quot;undefined&quot;) { this.forceReload = false; } if ($.getUrlVar('forceReload')) { this.forceReload = $.getUrlVar('forceReload') != 'false'; // true unless set // to false } if ($.getUrlVar('forceDevice')) { this.forceMobile = $.getUrlVar('forceDevice') == 'mobile'; this.forceNonMobile = !this.forceMobile; } else { this.forceMobile = false; this.forceNonMobile = false; } var uagent = navigator.userAgent.toLowerCase(); this.mobileDevice = (/(android|blackberry|iphone|ipod|series60|symbian|windows ce|palm)/i.test(uagent)); if (/(nexus 7|tablet)/i.test(uagent)) this.mobileDevice = false; // Nexus 7 and Android Tablets have a &quot;big&quot; screen, so prevent Navbar from scrolling this.mobileDevice |= this.forceMobile; // overwrite detection when set by URL // &quot;Bug&quot;-Fix for ID: 3204682 &quot;Caching on web server&quot; // This isn't a real fix for the problem as that's part of the web browser, // but // it helps to avoid the problems on the client, e.g. when the config file // has changed but the browser doesn't even ask the server about it... this.forceReload = true; // Disable features that aren't ready yet // This can be overwritten in the URL with the parameter &quot;maturity&quot; this.use_maturity; if ($.getUrlVar('maturity')) { this.url_maturity = $.getUrlVar('maturity'); if (!isNaN(this.url_maturity - 0)) { this.use_maturity = this.url_maturity - 0; // given directly as number } else { this.use_maturity = Maturity[this.url_maturity]; // or as the ENUM name } } if (isNaN(this.use_maturity)) { this.use_maturity = design.Maturity.release; // default to release } this.transformEncode = function(transformation, value) { var basetrans = transformation.split('.')[0]; return transformation in Transform ? Transform[transformation] .encode(value) : (basetrans in Transform ? Transform[basetrans] .encode(value) : value); }; this.transformDecode = function(transformation, value) { var basetrans = transformation.split('.')[0]; return transformation in Transform ? Transform[transformation] .decode(value) : (basetrans in Transform ? Transform[basetrans] .decode(value) : value); }; this.addAddress = function( address, id ) { if( address in thisTemplateEngine.ga_list ) thisTemplateEngine.ga_list[ address ].push( id ); else thisTemplateEngine.ga_list[ address ] = [ id ]; }; this.getAddresses = function() { return Object.keys(thisTemplateEngine.ga_list); }; /* * this function implements widget stylings */ this.setWidgetStyling = function(e, value, styling) { var sty = thisTemplateEngine.configSettings.stylings[styling]; if (sty) { e.removeClass(sty['classnames']); // remove only styling classes var findValue = function(v, findExact) { if (undefined === v) { return false; } if (sty[v]) { // fixed value e.addClass(sty[v]); return true; } else { var range = sty['range']; if (findExact &amp;&amp; range[v]) { e.addClass(range[v][1]); return true; } var valueFloat = parseFloat(v); for (var min in range) { if (min &gt; valueFloat) continue; if (range[min][0] &lt; valueFloat) continue; // check max e.addClass(range[min][1]); return true; } } return false; } if (!findValue(value, false) &amp;&amp; sty['defaultValue'] !== undefined) { findValue(sty['defaultValue'], true); } } return this; } this.map = function(value, this_map) { if (this_map &amp;&amp; thisTemplateEngine.configSettings.mappings[this_map]) { var m = thisTemplateEngine.configSettings.mappings[this_map]; var ret = value; if (m.formula) { ret = m.formula(ret); } var mapValue = function(v) { if (m[v]) { return m[v]; } else if (m['range']) { var valueFloat = parseFloat(v); var range = m['range']; for (var min in range) { if (min &gt; valueFloat) continue; if (range[min][0] &lt; valueFloat) continue; // check max return range[min][1]; } } return v; // pass through when nothing was found } var ret = mapValue(ret); if (!ret &amp;&amp; m['defaultValue']) { ret = mapValue(m['defaultValue']); } if( ret !== undefined ) { return ret; } } return value; }; /** * Look up the entry for @param value in the mapping @param this_map and * @return the next value in the list (including wrap around). */ this.getNextMappedValue = function(value, this_map) { if (this_map &amp;&amp; thisTemplateEngine.configSettings.mappings[this_map]) { var keys = Object.keys(thisTemplateEngine.configSettings.mappings[this_map]); return keys[ (keys.indexOf( &quot;&quot; + value ) + 1) % keys.length ]; } return value; } this.resetPageValues = function() { thisTemplateEngine.currentPage = null; thisTemplateEngine.configSettings.currentPageUnavailableWidth=-1; thisTemplateEngine.currentPageNavbarVisibility=null; }; this.getCurrentPageNavbarVisibility = function() { if (thisTemplateEngine.currentPageNavbarVisibility==null) { thisTemplateEngine.currentPageNavbarVisibility = thisTemplateEngine.pagePartsHandler.getNavbarsVisibility(thisTemplateEngine.currentPage); } return thisTemplateEngine.currentPageNavbarVisibility; }; // return S, M or L depening on the passed width function getColspanClass( width ) { if( width &lt;= thisTemplateEngine.configSettings.maxScreenWidthColspanS ) return 'S'; if( width &lt;= thisTemplateEngine.configSettings.maxScreenWidthColspanM ) return 'M'; return 'L'; } var oldWidth = -1; this.adjustColumns = function() { var width = thisTemplateEngine.getAvailableWidth(), oldClass = getColspanClass( oldWidth ), newClass = getColspanClass( width ); oldWidth = width; return oldClass != newClass; }; /** * return the available width for a the currently visible page * the available width is calculated by subtracting the following elements widths (if they are visible) from the body width * - Left-Navbar * - Right-Navbar */ this.getAvailableWidth = function() { // currently this calculation is done once after every page scroll (where thisTemplateEngine.configSettings.currentPageUnavailableWidth is reseted) // if the screen width falls below the threshold which activates/deactivates the mobile.css // the calculation has to be done again, even if the page hasnÂ´t changed (e.g. switching between portrait and landscape mode on a mobile can cause that) var bodyWidth = $('body').width(); var mobileUseChanged = (lastBodyWidth&lt;thisTemplateEngine.configSettings.maxMobileScreenWidth)!=(bodyWidth&lt;thisTemplateEngine.configSettings.maxMobileScreenWidth); if (thisTemplateEngine.configSettings.currentPageUnavailableWidth&lt;0 || mobileUseChanged || true) { // console.log(&quot;Mobile.css use changed &quot;+mobileUseChanged); thisTemplateEngine.configSettings.currentPageUnavailableWidth=0; var navbarVisibility = thisTemplateEngine.getCurrentPageNavbarVisibility(thisTemplateEngine.currentPage); var widthNavbarLeft = navbarVisibility.left==&quot;true&quot; &amp;&amp; $('#navbarLeft').css('display')!=&quot;none&quot; ? Math.ceil( $('#navbarLeft').outerWidth() ) : 0; if (widthNavbarLeft&gt;=bodyWidth) { // Left-Navbar has the same size as the complete body, this can happen, when the navbar has no content // maybe there is a better solution to solve this problem widthNavbarLeft = 0; } var widthNavbarRight = navbarVisibility.right==&quot;true&quot; &amp;&amp; $('#navbarRight').css('display')!=&quot;none&quot; ? Math.ceil( $('#navbarRight').outerWidth() ) : 0; if (widthNavbarRight&gt;=bodyWidth) { // Right-Navbar has the same size as the complete body, this can happen, when the navbar has no content // maybe there is a better solution to solve this problem widthNavbarRight = 0; } thisTemplateEngine.configSettings.currentPageUnavailableWidth = widthNavbarLeft + widthNavbarRight + 1; // remove an additional pixel for Firefox // console.log(&quot;Width: &quot;+bodyWidth+&quot; - &quot;+widthNavbarLeft+&quot; - &quot;+widthNavbarRight); } lastBodyWidth = bodyWidth; return bodyWidth - thisTemplateEngine.configSettings.currentPageUnavailableWidth; }; /** * return the available height for a the currently visible page * the available height is calculated by subtracting the following elements heights (if they are visible) from the window height * - Top-Navigation * - Top-Navbar * - Bottom-Navbar * - Statusbar * * Notice: the former way to use the subtract the $main.position().top value from the total height leads to errors in certain cases * because the value of $main.position().top is not reliable all the time */ this.getAvailableHeight = function() { var windowHeight = $(window).height(); thisTemplateEngine.configSettings.currentPageUnavailableHeight=0; var navbarVisibility = thisTemplateEngine.getCurrentPageNavbarVisibility(thisTemplateEngine.currentPage); var heightStr = &quot;Height: &quot;+windowHeight; if ($('#top').css('display') != 'none' &amp;&amp; $('#top').outerHeight(true)&gt;0) { thisTemplateEngine.configSettings.currentPageUnavailableHeight+= Math.max( $('#top').outerHeight(true), $('.nav_path').outerHeight(true) ); heightStr+=&quot; - &quot;+Math.max( $('#top').outerHeight(true), $('.nav_path').outerHeight(true) ); } else { heightStr+=&quot; - 0&quot;; } // console.log($('#navbarTop').css('display')+&quot;: &quot;+$('#navbarTop').outerHeight(true)); if ($('#navbarTop').css('display') != 'none' &amp;&amp; navbarVisibility.top==&quot;true&quot; &amp;&amp; $('#navbarTop').outerHeight(true)&gt;0) { thisTemplateEngine.configSettings.currentPageUnavailableHeight+=$('#navbarTop').outerHeight(true); heightStr+=&quot; - &quot;+$('#navbarTop').outerHeight(true); } else { heightStr+=&quot; - 0&quot;; } if ($('#navbarBottom').css('display') != 'none' &amp;&amp; navbarVisibility.bottom==&quot;true&quot; &amp;&amp; $('#navbarBottom').outerHeight(true)&gt;0) { thisTemplateEngine.configSettings.currentPageUnavailableHeight+=$('#navbarBottom').outerHeight(true); heightStr+=&quot; - &quot;+$('#navbarBottom').outerHeight(true); } else { heightStr+=&quot; - 0&quot;; } if ($('#bottom').css('display') != 'none' &amp;&amp; $('#bottom').outerHeight(true)&gt;0) { thisTemplateEngine.configSettings.currentPageUnavailableHeight+=$('#bottom').outerHeight(true); heightStr+=&quot; - #bottom:&quot;+$('#bottom').outerHeight(true); } else { heightStr+=&quot; - 0&quot;; } if (thisTemplateEngine.configSettings.currentPageUnavailableHeight&gt;0) { thisTemplateEngine.configSettings.currentPageUnavailableHeight+=1;// remove an additional pixel for Firefox } //console.log(heightStr); //console.log(windowHeight+&quot; - &quot;+thisTemplateEngine.configSettings.currentPageUnavailableHeight); return windowHeight - thisTemplateEngine.configSettings.currentPageUnavailableHeight; }; /* * Make sure everything looks right when the window gets resized. This is * necessary as the scroll effect requires a fixed element size */ /** * Manager for all resizing issues. It ensures that the real resizing * calculations are only done as often as really necessary. */ this.resizeHandling = (function(){ var invalidBackdrop = true, invalidNavbar = true, invalidPagesize = true, invalidRowspan = true, invalidScreensize = true, $pageSize = $('#pageSize'), $navbarTop = $('#navbarTop'), $navbarBottom = $('#navbarBottom'), width = 0, height = 0; var request = null; function makeAllSizesValid() { if (!request) { request = requestAnimationFrame(function () { invalidPagesize &amp;&amp; makePagesizeValid(); // must be first due to depencies invalidNavbar &amp;&amp; makeNavbarValid(); invalidRowspan &amp;&amp; makeRowspanValid(); invalidBackdrop &amp;&amp; makeBackdropValid(); request = null; }); } } function makeBackdropValid() { if( !templateEngine.currentPage ) return; var widgetData = templateEngine.widgetData[ templateEngine.currentPage.attr('id') ]; if( '2d' === widgetData.type ) { var cssPosRegEx = /(\\d*)(.*)/, backdrop = templateEngine.currentPage.children().children().filter(widgetData.backdroptype)[0], backdropSVG = widgetData.backdroptype === 'embed' ? backdrop.getSVGDocument() : null, backdropBBox = backdropSVG ? backdropSVG.children[0].getBBox() : {}, backdropNWidth = backdrop.naturalWidth || backdropBBox.width || width, backdropNHeight = backdrop.naturalHeight || backdropBBox.height || height, backdropScale = Math.min( width/backdropNWidth, height/backdropNHeight ), backdropWidth = backdropNWidth * backdropScale, backdropHeight = backdropNHeight * backdropScale, backdropPos = widgetData.backdropalign.split(' '), backdropLeftRaw = backdropPos[0].match( cssPosRegEx ), backdropTopRaw = backdropPos[1].match( cssPosRegEx ), backdropLeft = backdropLeftRaw[2] === '%' ? (width &gt;backdropWidth ? ((width -backdropWidth )*(+backdropLeftRaw[1])/100) : 0) : +backdropLeftRaw[1], backdropTop = backdropTopRaw[2] === '%' ? (height&gt;backdropHeight ? ((height-backdropHeight)*(+backdropTopRaw[1] )/100) : 0) : +backdropTopRaw[1], uagent = navigator.userAgent.toLowerCase(); if( backdrop.complete === false || (widgetData.backdroptype === 'embed' &amp;&amp; backdropSVG === null) ) { // backdrop not available yet - reload setTimeout( thisTemplateEngine.resizeHandling.invalidateBackdrop, 100); return; } // Note 1: this here is a work around for older browsers that can't use // the object-fit property yet. // Currently (26.05.16) only Safari is known to not support // object-position although object-fit itself does work // Note 2: The embed element allways needs it if( widgetData.backdroptype === 'embed' || ( uagent.indexOf('safari') !== -1 &amp;&amp; uagent.indexOf('chrome') === -1 ) ) { $( backdrop ).css({ width: backdropWidth + 'px', height: backdropHeight + 'px', left: backdropLeft + 'px', top: backdropTop + 'px' }); } templateEngine.currentPage.find('.widget_container').toArray().forEach( function( widgetContainer ){ var widgetData = templateEngine.widgetDataGet( widgetContainer.id ); if( widgetData.layout ) { var layout = widgetData.layout, // this assumes that a .widget_container has only one child and this // is the .widget itself style = widgetContainer.children[0].style; if( 'x' in layout ) { var value = layout.x.match( cssPosRegEx ); if( 'px' === value[2] ) { style.left = (backdropLeft + value[1]*backdropScale) + 'px'; } else { style.left = layout.x; } } if( 'y' in layout ) { var value = layout.y.match( cssPosRegEx ); if( 'px' === value[2] ) { style.top = (backdropTop + value[1]*backdropScale) + 'px'; } else { style.top = layout.y; } } if( 'width' in layout ) style.width = layout.width; if( 'height' in layout ) style.height = layout.height; } }); } invalidBackdrop = false; } function makeNavbarValid() { if (thisTemplateEngine.mobileDevice) { //do nothing } else { if( ($navbarTop.css('display') !== 'none' &amp;&amp; $navbarTop.outerHeight(true)&lt;=2) || ($navbarBottom.css('display') !== 'none' &amp;&amp; $navbarBottom.innerHeight() &lt;=2) ) { // update references $navbarTop = $('#navbarTop'); $navbarBottom = $('#navbarBottom'); // Top/Bottom-Navbar is not initialized yet, wait some time and recalculate available height // this is an ugly workaround, if someone can come up with a better solution, feel free to implement it window.requestAnimationFrame( thisTemplateEngine.resizeHandling.invalidateNavbar ); return; } } if (thisTemplateEngine.adjustColumns()) { // the amount of columns has changed -&gt; recalculate the widgets widths thisTemplateEngine.applyColumnWidths(); } invalidNavbar = false; } function makePagesizeValid() { width = thisTemplateEngine.getAvailableWidth(); height = thisTemplateEngine.getAvailableHeight(); $pageSize.text('#main,.page{width:' + (width - 0) + 'px;height:' + height + 'px;}'); invalidPagesize = false; } function makeRowspanValid() { var dummyDiv = $( '&lt;div class=&quot;clearfix&quot; id=&quot;calcrowspan&quot;&gt;&lt;div id=&quot;containerDiv&quot; class=&quot;widget_container&quot;&gt;&lt;div class=&quot;widget clearfix text&quot; id=&quot;innerDiv&quot; /&gt;&lt;/div&gt;&lt;/div&gt;') .appendTo(document.body).show(), singleHeight = $('#containerDiv').outerHeight(false), singleHeightMargin = $('#containerDiv').outerHeight(true), styles = ''; for( var rowspan in thisTemplateEngine.configSettings.usedRowspans ) { styles += '.rowspan.rowspan' + rowspan + ' { height: ' + ((rowspan - 1) * singleHeightMargin + singleHeight) + &quot;px;}\\n&quot;; } $('#calcrowspan').remove(); // set css style $('#rowspanStyle').text( styles ); invalidRowspan = false; } return { invalidateBackdrop: function(){ invalidBackdrop = true; makeAllSizesValid(); }, invalidateNavbar: function(){ invalidNavbar = true; invalidPagesize = true; makeAllSizesValid(); }, invalidateRowspan: function(){ invalidRowspan = true; makeAllSizesValid(); }, invalidateScreensize: function(){ invalidScreensize = true; invalidPagesize = true; invalidBackdrop = true; makeAllSizesValid(); } }; })(); thisTemplateEngine.configSettings.usedRowspans = {}; this.rowspanClass = function(rowspan) { thisTemplateEngine.configSettings.usedRowspans[ rowspan ] = true; return 'rowspan rowspan' + rowspan; }; thisTemplateEngine.configSettings.pluginsToLoadCount = []; var xml; this.parseXML = function(loaded_xml) { profileCV( 'parseXML' ); xml = loaded_xml; // erst mal den Cache fÃ¼r AJAX-Requests wieder aktivieren /* $.ajaxSetup({ cache : true }); */ /* * First, we try to get a design by url. Secondly, we try to get a predefined */ // read predefined design in config var predefinedDesign = $('pages', xml).attr(&quot;design&quot;); if ($('pages', xml).attr(&quot;backend&quot;)) { thisTemplateEngine.configSettings.backend = $('pages', xml).attr(&quot;backend&quot;); } if( undefined === $('pages', xml).attr( 'scroll_speed' ) ) thisTemplateEngine.configSettings.scrollSpeed = 400; else thisTemplateEngine.configSettings.scrollSpeed = $('pages', xml).attr('scroll_speed') | 0; if ($('pages', xml).attr('bind_click_to_widget')!=undefined) { thisTemplateEngine.configSettings.bindClickToWidget = $('pages', xml).attr('bind_click_to_widget')==&quot;true&quot; ? true : false; } if ($('pages', xml).attr('default_columns')) { thisTemplateEngine.configSettings.defaultColumns = $('pages', xml).attr('default_columns'); } if ($('pages', xml).attr('min_column_width')) { thisTemplateEngine.configSettings.minColumnWidth = $('pages', xml).attr('min_column_width'); } thisTemplateEngine.configSettings.screensave_time = $('pages', xml).attr('screensave_time'); thisTemplateEngine.configSettings.screensave_page = $('pages', xml).attr('screensave_page'); // design by url if ($.getUrlVar(&quot;design&quot;)) { thisTemplateEngine.configSettings.clientDesign = $.getUrlVar(&quot;design&quot;); } // design by config file else if (predefinedDesign) { thisTemplateEngine.configSettings.clientDesign = predefinedDesign; } // selection dialog else { thisTemplateEngine.selectDesign(); } if ($('pages', xml).attr('max_mobile_screen_width')) thisTemplateEngine.configSettings.maxMobileScreenWidth = $('pages', xml).attr('max_mobile_screen_width'); thisTemplateEngine.configSettings.getCSSlist = []; if (thisTemplateEngine.configSettings.clientDesign) { thisTemplateEngine.configSettings.getCSSlist.push( 'css!designs/' + thisTemplateEngine.configSettings.clientDesign + '/basic.css' ); if (!thisTemplateEngine.forceNonMobile) { thisTemplateEngine.configSettings.getCSSlist.push( 'css!designs/' + thisTemplateEngine.configSettings.clientDesign + '/mobile.css' ); } thisTemplateEngine.configSettings.getCSSlist.push( 'css!designs/' + thisTemplateEngine.configSettings.clientDesign + '/custom.css' ); thisTemplateEngine.configSettings.getCSSlist.push( 'designs/' + thisTemplateEngine.configSettings.clientDesign + '/design_setup' ); } // start with the plugins thisTemplateEngine.configSettings.pluginsToLoad = []; $('meta &gt; plugins plugin', xml).each(function(i) { var name = $(this).attr('name'); if (name) { if (!thisTemplateEngine.configSettings.pluginsToLoad[name]) { /* pluginsToLoadCount++; $.includeScripts( ['plugins/' + name + '/structure_plugin.js'], delaySetup( 'plugin_' + name) ); pluginsToLoad[name] = true; */ thisTemplateEngine.configSettings.pluginsToLoad.push( 'plugins/' + name + '/structure_plugin' ); } } }); /* if (0 == pluginsToLoadCount) { delete loadReady.plugins; } */ // then the icons $('meta &gt; icons icon-definition', xml).each(function(i) { var $this = $(this); var name = $this.attr('name'); var uri = $this.attr('uri'); var type = $this.attr('type'); var flavour = $this.attr('flavour'); var color = $this.attr('color'); var styling = $this.attr('styling'); var dynamic = $this.attr('dynamic'); icons.insert(name, uri, type, flavour, color, styling, dynamic); }); // then the mappings $('meta &gt; mappings mapping', xml).each(function(i) { var $this = $(this); var name = $this.attr('name'); thisTemplateEngine.configSettings.mappings[name] = {}; var formula = $this.find('formula'); if (formula.length &gt; 0) { var func = eval('var func = function(x){var y;' + formula.text() + '; return y;}; func'); thisTemplateEngine.configSettings.mappings[name]['formula'] = func; } $this.find('entry').each(function() { var $localThis = $(this); var origin = $localThis.contents(); var value = []; for (var i = 0; i &lt; origin.length; i++) { var $v = $(origin[i]); if ($v.is('icon')) { value[i] = icons.getIconElement($v.attr('name'), $v.attr('type'), $v.attr('flavour'), $v.attr('color'), $v.attr('styling'), $v.attr('class')); } else { value[i] = $v.text(); } } // check for default entry var isDefaultValue = $localThis.attr('default'); if (isDefaultValue != undefined) { isDefaultValue = isDefaultValue == &quot;true&quot;; } else { isDefaultValue = false; } // now set the mapped values if ($localThis.attr('value')) { thisTemplateEngine.configSettings.mappings[name][$localThis.attr('value')] = value.length == 1 ? value[0] : value; if (isDefaultValue) { thisTemplateEngine.configSettings.mappings[name]['defaultValue'] = $localThis.attr('value'); } } else { if (!thisTemplateEngine.configSettings.mappings[name]['range']) { thisTemplateEngine.configSettings.mappings[name]['range'] = {}; } thisTemplateEngine.configSettings.mappings[name]['range'][parseFloat($localThis.attr('range_min'))] = [ parseFloat($localThis.attr('range_max')), value ]; if (isDefaultValue) { thisTemplateEngine.configSettings.mappings[name]['defaultValue'] = parseFloat($localThis.attr('range_min')); } } }); }); // then the stylings $('meta &gt; stylings styling', xml).each(function(i) { var name = $(this).attr('name'); var classnames = ''; thisTemplateEngine.configSettings.stylings[name] = {}; $(this).find('entry').each(function() { var $localThis = $(this); classnames += $localThis.text() + ' '; // check for default entry var isDefaultValue = $localThis.attr('default'); if (isDefaultValue != undefined) { isDefaultValue = isDefaultValue == &quot;true&quot;; } else { isDefaultValue = false; } // now set the styling values if ($localThis.attr('value')) { thisTemplateEngine.configSettings.stylings[name][$localThis.attr('value')] = $localThis.text(); if (isDefaultValue) { thisTemplateEngine.configSettings.stylings[name]['defaultValue'] = $localThis.attr('value'); } } else { // a range if (!thisTemplateEngine.configSettings.stylings[name]['range']) thisTemplateEngine.configSettings.stylings[name]['range'] = {}; thisTemplateEngine.configSettings.stylings[name]['range'][parseFloat($localThis.attr('range_min'))] = [parseFloat($localThis.attr('range_max')),$localThis.text()]; if (isDefaultValue) { thisTemplateEngine.configSettings.stylings[name]['defaultValue'] = parseFloat($localThis.attr('range_min')); } } }); thisTemplateEngine.configSettings.stylings[name]['classnames'] = classnames; }); var statusContent = &quot;&quot;; // then the status bar $('meta &gt; statusbar status', xml).each(function(i) { var type = $(this).attr('type'); var condition = $(this).attr('condition'); var extend = $(this).attr('hrefextend'); var sPath = window.location.pathname; var sPage = sPath.substring(sPath.lastIndexOf('/') + 1); // @TODO: make this match once the new editor is finished-ish. var editMode = 'edit_config.html' == sPage; // skip this element if it's edit-only and we are non-edit, or the other // way // round if (editMode &amp;&amp; '!edit' == condition) return; if (!editMode &amp;&amp; 'edit' == condition) return; var text = $(this).text(); switch (extend) { case 'all': // append all parameters var search = window.location.search.replace(/\\$/g, '$$$$'); text = text.replace(/(href=&quot;[^&quot;]*)(&quot;)/g, '$1' + search + '$2'); break; case 'config': // append config file info var search = window.location.search.replace(/\\$/g, '$$$$'); search = search.replace(/.*(config=[^&amp;]*).*|.*/, '$1'); var middle = text.replace(/.*href=&quot;([^&quot;]*)&quot;.*/g, '{$1}'); if( 0 &lt; middle.indexOf('?') ) search = '&amp;' + search; else search = '?' + search; text = text.replace(/(href=&quot;[^&quot;]*)(&quot;)/g, '$1' + search + '$2'); break; } statusContent += text; }); thisTemplateEngine.configSettings.footer = btoa(statusContent); delete loadReady.page; thisTemplateEngine.init(); thisTemplateEngine.setup_page(); }; this.init = function() { thisTemplateEngine.initBackendClient(); require( thisTemplateEngine.configSettings.getCSSlist, delaySetup('design') ); var delaySetupPluginsCallback = delaySetup('plugins'); require( thisTemplateEngine.configSettings.pluginsToLoad, delaySetupPluginsCallback, function( err ) { console.log( 'Plugin loading error! It happend with: &quot;' + err.requireModules[0] + '&quot;. Is the plugin available and written correctly?'); delaySetupPluginsCallback(); }); if (thisTemplateEngine.configSettings.footer) { $('.footer').append(atob(thisTemplateEngine.configSettings.footer)); } }; /** * applies the correct width to the widgets corresponding to the given colspan setting */ this.applyColumnWidths = function() { var width = thisTemplateEngine.getAvailableWidth(); function dataColspan( data ) { if( width &lt;= thisTemplateEngine.configSettings.maxScreenWidthColspanS ) return data.colspanS; if( width &lt;= thisTemplateEngine.configSettings.maxScreenWidthColspanM ) return data.colspanM; return data.colspan; } // all containers ['#navbarTop', '#navbarLeft', '#main', '#navbarRight', '#navbarBottom'].forEach( function( area ){ var allContainer = $(area + ' .widget_container'), areaColumns = $( area ).data( 'columns' ); allContainer.each(function(i, e) { var $e = $(e), data = thisTemplateEngine.widgetDataGet( e.id ), ourColspan = dataColspan( data ); var w = 'auto'; if (ourColspan &gt; 0) { var areaColspan = areaColumns || thisTemplateEngine.defaultColumns; w = Math.min(100, ourColspan / areaColspan * 100) + '%'; } $e.css('width', w); }); // and elements inside groups var areaColumns = $('#main').data('columns'); var adjustableElements = $('.group .widget_container'); adjustableElements.each(function(i, e) { var $e = $(e), data = thisTemplateEngine.widgetData[ e.id ], ourColspan = dataColspan( data ); if (ourColspan == undefined) { // workaround for nowidget groups ourColspan = dataColspan( thisTemplateEngine.widgetDataGetByElement($e.children('.group')) ); } var w = 'auto'; if (ourColspan &gt; 0) { var areaColspan = areaColumns || thisTemplateEngine.defaultColumns; var groupColspan = Math.min(areaColspan, dataColspan(thisTemplateEngine.widgetDataGetByElement($e.parentsUntil( '.widget_container', '.group')))); w = Math.min(100, ourColspan / groupColspan * 100) + '%'; // in percent } $e.css('width', w); }); }); }; this.setup_page = function() { // and now setup the pages profileCV( 'setup_page start' ); // check if the page and the plugins are ready now for( var key in loadReady ) // test for emptyness return; // we'll be called again... // login to backend as it might change some settings needed for further processing thisTemplateEngine.visu.login(true, function() { profileCV( 'setup_page running' ); // as we are sure that the default CSS were loaded now: $('link[href*=&quot;mobile.css&quot;]').each(function(){ this.media = 'only screen and (max-width: ' + thisTemplateEngine.configSettings.maxMobileScreenWidth + 'px)'; }); var cache = false; if (thisTemplateEngine.enableCache &amp;&amp; thisTemplateEngine.configCache.isCached()) { // check if cache is still valid if (!thisTemplateEngine.configCache.isValid(xml)) { // TODO: remove before release console.log(&quot;invalidating cache&quot;); // cache invalid cache = false; thisTemplateEngine.configCache.clear(); } else { // TODO: remove before release console.log(&quot;using cache&quot;); cache = thisTemplateEngine.configCache.getData(); thisTemplateEngine.widgetData = cache.data; thisTemplateEngine.ga_list = cache.addresses; var body = $('body'); body.empty(); body.prepend(thisTemplateEngine.configCache.getBody()); thisTemplateEngine.create_objects(); } } if (!cache) { // TODO: remove before release console.log(&quot;not using cache&quot;); var page = $('pages &gt; page', xml)[0]; // only one page element allowed... thisTemplateEngine.create_pages(page, 'id'); thisTemplateEngine.design.getCreator('page').createFinal(); } profileCV( 'setup_page created pages' ); thisTemplateEngine.messageBroker.publish(&quot;setup.dom.finished&quot;); if (!cache &amp;&amp; thisTemplateEngine.enableCache) { // cache dom + data thisTemplateEngine.configCache.dump(xml); } profileCV( 'setup_page finished setup.dom.finished' ); var startpage = 'id_'; if ($.getUrlVar('startpage')) { startpage = $.getUrlVar('startpage'); if( typeof(Storage) !== 'undefined' ) { if( 'remember' === startpage ) { startpage = localStorage.getItem( 'lastpage' ); rememberLastPage = true; if( 'string' !== typeof( startpage ) || 'id_' !== startpage.substr( 0, 3 ) ) startpage = 'id_'; // fix obvious wrong data } else if( 'noremember' === startpage ) { localStorage.removeItem( 'lastpage' ); startpage = 'id_'; rememberLastPage = false; } } } thisTemplateEngine.currentPage = $('#'+startpage); thisTemplateEngine.adjustColumns(); thisTemplateEngine.applyColumnWidths(); thisTemplateEngine.main_scroll = new PageHandler(); if (thisTemplateEngine.scrollSpeed != undefined) { thisTemplateEngine.main_scroll.setSpeed( thisTemplateEngine.scrollSpeed ); } thisTemplateEngine.scrollToPage(startpage,0); /* CM, 9.4.16: * TODO: Is this really needed? * I can't find any source for setting .fast - and when it's set, it's * most likely not working as scrollToPage should have been used instead * anyway... * $('.fast').bind('click', function() { thisTemplateEngine.main_scroll.seekTo($(this).text()); }); */ // reaction on browser back button window.onpopstate = function(e) { // where do we come frome? var lastpage = e.state; if (lastpage) { // browser back button takes back to the last page thisTemplateEngine.scrollToPage(lastpage, 0, true); } }; // run the Trick-O-Matic scripts for great SVG backdrops $('embed').each(function() { this.onload = Trick_O_Matic }); if (thisTemplateEngine.enableAddressQueue) { // identify addresses on startpage var startPageAddresses = {}; $('.actor','#'+startpage).each(function() { var $this = $(this), data = $this.data(); if( undefined === data.address ) data = $this.parent().data(); for( var addr in data.address ) { startPageAddresses[addr.substring(1)]=1; } }); thisTemplateEngine.visu.setInitialAddresses(Object.keys(startPageAddresses)); } var addressesToSubscribe = thisTemplateEngine.getAddresses(); if( 0 !== addressesToSubscribe.length ) thisTemplateEngine.visu.subscribe(addressesToSubscribe); xml = null; // not needed anymore - free the space $('.icon').each(function(){ fillRecoloredIcon(this);}); $('.loading').removeClass('loading'); this.messageBroker.publish(&quot;loading.done&quot;); if( undefined !== thisTemplateEngine.screensave_time ) { thisTemplateEngine.screensave = setTimeout( function(){thisTemplateEngine.scrollToPage();}, thisTemplateEngine.screensave_time*1000 ); $(document).click( function(){ clearInterval( thisTemplateEngine.screensave ); thisTemplateEngine.screensave = setTimeout( function(){thisTemplateEngine.scrollToPage();}, thisTemplateEngine.screensave_time*1000 ); }); } profileCV( 'setup_page finish' ); }, this); }; this.create_pages = function(page, path, flavour, type) { var creator = thisTemplateEngine.design.getCreator(page.nodeName); var retval = creator.create(page, path, flavour, type); if( undefined === retval ) return; var data = thisTemplateEngine.widgetDataGet( path ); data.type = page.nodeName; if( 'string' === typeof retval ) { return '&lt;div class=&quot;widget_container ' + (data.rowspanClass ? data.rowspanClass : '') + (data.containerClass ? data.containerClass : '') + ('break' === data.type ? 'break_container' : '') // special case for break widget + '&quot; id=&quot;'+path+'&quot; data-type=&quot;'+data.type+'&quot;&gt;' + retval + '&lt;/div&gt;'; } else { return jQuery( '&lt;div class=&quot;widget_container ' + (data.rowspanClass ? data.rowspanClass : '') + (data.containerClass ? data.containerClass : '') + '&quot; id=&quot;'+path+'&quot; data-type=&quot;'+data.type+'&quot;/&gt;').append(retval); } }; this.create_objects = function() { for (var path in thisTemplateEngine.widgetData) { var data = thisTemplateEngine.widgetData[path]; if (data.address &amp;&amp; data.updateFn) { thisTemplateEngine.design.constructDefaultObject(path); } var creator = thisTemplateEngine.design.getCreator(data.type); if (creator.construct) { creator.construct(path); } } }; /** * Little helper to find the relevant page path for a given widget. * @param element The XML element * @param widgetpath The path / ID of the widget * @return The path of the parent */ this.getPageIdForWidgetId = function( element, widgetpath ) { var parent = element.parentNode, parentpath = widgetpath.replace( /[0-9]*$/, '' ); while( parent &amp;&amp; parent.nodeName !== 'page' ) { parent = parent.parentNode; parentpath = parentpath.replace( /[0-9]*_$/, '' ); } return parentpath; }; this.getPageIdByPath = function(page_name, path) { if (page_name==null) return null; if (page_name.match(/^id_[0-9_]*$/) != null) { // already a page_id return page_name; } else { if (path!=undefined) { var scope = templateEngine.traversePath(path); if (scope==null) { // path is wrong console.error(&quot;path '&quot;+path+&quot;' could not be traversed, no page found&quot;); return null; } return templateEngine.getPageIdByName(page_name,scope); } else { return templateEngine.getPageIdByName(page_name); } } } this.traversePath = function(path,root_page_id) { var path_scope=null; var index = path.indexOf(&quot;/&quot;); if (index&gt;=1) { // skip escaped slashes like \\/ while (path.substr(index-1,1)==&quot;\\\\&quot;) { var next = path.indexOf(&quot;/&quot;,index+1); if (next&gt;=0) { index=next; } } } // console.log(&quot;traversePath(&quot;+path+&quot;,&quot;+root_page_id+&quot;)&quot;); if (index&gt;=0) { // traverse path one level down var path_page_name = path.substr(0,index); path_scope = templateEngine.getPageIdByName(path_page_name,root_page_id); path = path.substr(path_page_name.length+1); path_scope = templateEngine.traversePath(path,path_scope); // console.log(path_page_name+&quot;=&gt;&quot;+path_scope); return path_scope; } else { // bottom path level reached path_scope = templateEngine.getPageIdByName(path,root_page_id); return path_scope; } return null; } this.getPageIdByName = function(page_name,scope) { if (page_name.match(/^id_[0-9_]*$/) != null) { // already a page_id return page_name; } else { var page_id=null; // find Page-ID by name // decode html code (e.g. like &amp;apos; =&gt; ') page_name = $(&quot;&lt;textarea/&gt;&quot;).html(page_name).val(); // remove escaped slashes page_name = page_name.replace(&quot;\\\\\\/&quot;,&quot;/&quot;); // console.log(&quot;Page: &quot;+page_name+&quot;, Scope: &quot;+scope); var selector = (scope!=undefined &amp;&amp; scope!=null) ? '.page[id^=&quot;'+scope+'&quot;] h1:contains(' + page_name + ')' : '.page h1:contains(' + page_name + ')'; var pages = $(selector, '#pages'); if (pages.length&gt;1 &amp;&amp; thisTemplateEngine.currentPage!=null) { // More than one Page found -&gt; search in the current pages descendants first var fallback = true; pages.each(function(i) { var p = $(this).closest(&quot;.page&quot;); if ($(this).text() == page_name) { if (p.attr('id').length&lt;thisTemplateEngine.currentPage.attr('id').length) { // found pages path is shorter the the current pages -&gt; must be an ancestor if (thisTemplateEngine.currentPage.attr('id').indexOf(p.attr('id'))==0) { // found page is an ancenstor of the current page -&gt; we take this one page_id = p.attr(&quot;id&quot;); fallback = false; //break loop return false; } } else { if (p.attr('id').indexOf(thisTemplateEngine.currentPage.attr('id'))==0) { // found page is an descendant of the current page -&gt; we take this one page_id = p.attr(&quot;id&quot;); fallback = false; //break loop return false; } } } }); if (fallback) { // take the first page that fits (old behaviour) pages.each(function(i) { if ($(this).text() == page_name) { page_id = $(this).closest(&quot;.page&quot;).attr(&quot;id&quot;); // break loop return false; } }); } } else { pages.each(function(i) { if ($(this).text() == page_name) { page_id = $(this).closest(&quot;.page&quot;).attr(&quot;id&quot;); // break loop return false; } }); } } if (page_id!=null &amp;&amp; page_id.match(/^id_[0-9_]*$/) != null) { return page_id; } else { // not found return null; } } this.scrollToPage = function(target, speed, skipHistory) { if( undefined === target ) target = this.screensave_page; var page_id = thisTemplateEngine.getPageIdByPath(target); if (page_id==null) { return; } if( undefined === speed ) speed = thisTemplateEngine.scrollSpeed; if( rememberLastPage ) localStorage.lastpage = page_id; // push new state to history if (skipHistory === undefined) window.history.pushState(page_id, page_id, window.location.href); thisTemplateEngine.main_scroll.seekTo(page_id, speed); // scroll to it thisTemplateEngine.pagePartsHandler.initializeNavbars(page_id); $(window).trigger('scrolltopage', page_id); }; /* * Show a popup of type &quot;type&quot;. The attributes is an type dependend object * This function returnes a jQuery object that points to the whole popup, so * it's content can be easily extended */ this.showPopup = function(type, attributes) { return thisTemplateEngine.design.getPopup(type).create(attributes); }; /* * Remove the popup. The parameter is the jQuery object returned by the * showPopup function */ this.removePopup = function(jQuery_object) { jQuery_object.remove(); }; /** ************************************************************************* */ /* FIXME - Question: should this belong to the VisuDesign object so that it */ /* is possible to overload?!? */ /** ************************************************************************* */ this.refreshAction = function(target, src) { /* * Special treatment for (external) iframes: we need to clear it and reload * it in another thread as otherwise stays blank for some targets/sites and * src = src doesnt work anyway on external This creates though some * &quot;flickering&quot; so we avoid to use it on images, internal iframes and others */ var parenthost = window.location.protocol + &quot;//&quot; + window.location.host; if (target.nodeName == &quot;IFRAME&quot; &amp;&amp; src.indexOf(parenthost) != 0) { target.src = ''; setTimeout(function() { target.src = src; }, 0); } else { target.src = src + '&amp;' + new Date().getTime(); } }; this.setupRefreshAction = function( path, refresh ) { if (refresh &amp;&amp; refresh &gt; 0) { var element = $( '#' + path ), target = $('img', element)[0] || $('iframe', element)[0], src = target.src; if (src.indexOf('?') &lt; 0) src += '?'; thisTemplateEngine.widgetDataGet( path ).internal = setInterval(function() { thisTemplateEngine.refreshAction(target, src); }, refresh); } }; this.selectDesign = function() { var $body = $(&quot;body&quot;); $(&quot;body &gt; *&quot;).hide(); $body.css({ backgroundColor : &quot;black&quot; }); var $div = $(&quot;&lt;div id=\\&quot;designSelector\\&quot; /&gt;&quot;); $div.css({ background : &quot;#808080&quot;, width : &quot;400px&quot;, color : &quot;white&quot;, margin : &quot;auto&quot;, padding : &quot;0.5em&quot; }); $div.html(&quot;Loading ...&quot;); $body.append($div); $.getJSON(&quot;./designs/get_designs.php&quot;,function(data) { $div.empty(); $div.append(&quot;&lt;h1&gt;Please select design&lt;/h1&gt;&quot;); $div.append(&quot;&lt;p&gt;The Location/URL will change after you have chosen your design. Please bookmark the new URL if you do not want to select the design every time.&lt;/p&gt;&quot;); $.each(data,function(i, element) { var $myDiv = $(&quot;&lt;div /&gt;&quot;); $myDiv.css({ cursor : &quot;pointer&quot;, padding : &quot;0.5em 1em&quot;, borderBottom : &quot;1px solid black&quot;, margin : &quot;auto&quot;, width : &quot;262px&quot;, position : &quot;relative&quot; }); $myDiv .append(&quot;&lt;div style=\\&quot;font-weight: bold; margin: 1em 0 .5em;\\&quot;&gt;Design: &quot; + element + &quot;&lt;/div&gt;&quot;); $myDiv .append(&quot;&lt;iframe src=\\&quot;designs/design_preview.html?design=&quot; + element + &quot;\\&quot; width=\\&quot;160\\&quot; height=\\&quot;90\\&quot; border=\\&quot;0\\&quot; scrolling=\\&quot;auto\\&quot; frameborder=\\&quot;0\\&quot; style=\\&quot;z-index: 1;\\&quot;&gt;&lt;/iframe&gt;&quot;); $myDiv .append(&quot;&lt;img width=\\&quot;60\\&quot; height=\\&quot;30\\&quot; src=\\&quot;./demo/media/arrow.png\\&quot; alt=\\&quot;select\\&quot; border=\\&quot;0\\&quot; style=\\&quot;margin: 60px 10px 10px 30px;\\&quot;/&gt;&quot;); $div.append($myDiv); var $tDiv = $(&quot;&lt;div /&gt;&quot;); $tDiv.css({ background : &quot;transparent&quot;, position : &quot;absolute&quot;, height : &quot;90px&quot;, width : &quot;160px&quot;, zIndex : 2 }); var pos = $myDiv.find(&quot;iframe&quot;).position(); $tDiv.css({ left : pos.left + &quot;px&quot;, top : pos.top + &quot;px&quot; }); $myDiv.append($tDiv); $myDiv.hover(function() { // over $myDiv.css({ background : &quot;#bbbbbb&quot; }); }, function() { // out $myDiv.css({ background : &quot;transparent&quot; }); }); $myDiv.click(function() { if (document.location.search == &quot;&quot;) { document.location.href = document.location.href + &quot;?design=&quot; + element; } else { document.location.href = document.location.href + &quot;&amp;design=&quot; + element; } }); }); }); }; // tools for widget handling /** * Return a widget (to be precise: the widget_container) for the given path */ this.lookupWidget = function( path ) { var id = path.split( '_' ); var elementNumber = +id.pop(); return $( '.page#' + id.join('_') ).children().children()[ elementNumber+1 ]; }; this.getParentPage = function(page) { if (0 === page.length) return null; return getParentPageById(page.attr('id'), true); }; function getParentPageById(path, isPageId) { if (0 &lt; path.length) { var pathParts = path.split('_'); if (isPageId) pathParts.pop(); while (pathParts.length &gt; 1) { pathParts.pop(); var path = pathParts.join('_') + '_'; if ($('#' + path).hasClass(&quot;page&quot;)) { return $('#' + path); } } } return null; }; this.getParentPageFromPath = function(path) { return getParentPageById(path, false); }; /** * Load a script and run it before page setup. * This is needed for plugin that depend on an external library. */ this.getPluginDependency = function( url ){ $.getScriptSync( url ); } /** * This has to be called by a plugin once it was loaded. */ this.pluginLoaded = function(){ pluginsToLoadCount--; if( 0 &gt;= pluginsToLoadCount ) { delete loadReady.plugins; thisTemplateEngine.setup_page(); } } /** * Create a new widget. */ this.create = function( path, element ) { return &quot;created widget '&quot; + path + &quot;': '&quot; + element + &quot;'&quot;; }; /** * Delete an existing path, i.e. widget, group or even page - including * child elements. */ this.deleteCommand = function( path ) { console.log( this.lookupWidget( path ), $( '#'+path ) ); //$( this.lookupWidget( path ) ).remove(); return &quot;deleted widget '&quot; + path + &quot;'&quot;; }; /** * Focus a widget. */ this.focus = function( path ) { $('.focused').removeClass('focused') $( this.lookupWidget( path ) ).addClass( 'focused' ); }; ////////// Reflection API for possible Editor communication: Start ////////// /** * Return a list of all widgets. */ this.list = function() { var widgetTree = {}; $('.page').each( function(){ var id = this.id.split( '_' ); var thisEntry = widgetTree; if( 'id' === id.shift() ) { var thisNumber; while( thisNumber = id.shift() ) { if( !(thisNumber in thisEntry) ) thisEntry[ thisNumber ] = {}; thisEntry = thisEntry[ thisNumber ]; } $( this ).children().children( 'div.widget_container' ).each( function( i ){ if( undefined === thisEntry[ i ] ) { thisEntry[ i ] = {} } var thisWidget = $( this ).children()[0]; thisEntry[ i ].name = ('className' in thisWidget) ? thisWidget.className : 'TODO'; thisEntry[ i ].type = $(this).data('type'); }); } }); return widgetTree; }; /** * Return all attributes of a widget. */ this.read = function( path ) { var widget = this.lookupWidget( path ), data = $.extend( {}, $( widget ).children().data() ); // copy delete data.basicvalue; delete data.value; return data; }; /** * Set the selection state of a widget. */ this.select = function( path, state ) { var container = this.lookupWidget( path ) if( state ) $( container ).addClass( 'selected'); else $( container ).removeClass( 'selected'); }; /** * Set all attributes of a widget. */ this.write = function( path, attributes ) { $( this.lookupWidget( path ) ).children().data( attributes ); }; /** * Reflection API: communication * Handle messages that might be sent by the editor */ this.handleMessage = function( event ) { // prevend bad or even illegal requests if( event.origin !== window.location.origin || 'object' !== typeof event.data || !('command' in event.data ) || !('parameters' in event.data ) ) return; var answer = 'bad command', parameters = event.data.parameters; // note: as the commands are from external, we have to be a bit more // carefull for corectness testing switch( event.data.command ) { case 'create': if( 'object' === typeof parameters &amp;&amp; pathRegEx.test( parameters.path ) &amp;&amp; 'string' === typeof parameters.element ) answer = thisTemplateEngine.create( parameters.path, parameters.element ); else answer = 'bad path or element'; break; case 'delete': if( pathRegEx.test( parameters ) ) answer = thisTemplateEngine.deleteCommand( parameters ); else answer = 'bad path'; break; case 'focus': if( pathRegEx.test( parameters ) ) answer = thisTemplateEngine.focus( parameters ); else answer = 'bad path'; break; case 'list': answer = thisTemplateEngine.list(); break; case 'read': if( pathRegEx.test( parameters ) ) answer = thisTemplateEngine.read( parameters ); else answer = 'bad path'; break; case 'select': if( 'object' === typeof parameters &amp;&amp; pathRegEx.test( parameters.path ) &amp;&amp; 'boolean' === typeof parameters.state ) answer = thisTemplateEngine.select( parameters.path, parameters.state ); break; case 'write': if( 'object' === typeof parameters &amp;&amp; pathRegEx.test( parameters.path ) &amp;&amp; 'object' === typeof parameters.attributes ) answer = thisTemplateEngine.write( parameters.path, parameters.attributes ); break; } event.source.postMessage( answer, event.origin ); }; window.addEventListener( 'message', this.handleMessage, false); ////////// Reflection API for possible Editor communication: End ////////// } return { // simulate a singleton getInstance : function() { if (!instance) { instance = new TemplateEngine(); } return instance; } }; }); // end require Ã— Search results Close "},"lib_CometVisuClient.js.html":{"id":"lib_CometVisuClient.js.html","title":"Source: lib/CometVisuClient.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/CometVisuClient.js /* CometVisuClient.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * The JavaScript library that implements the CometVisu protocol. * * @module lib/CometVisuClient * @exports ComentVisuClient * @requires dependencies/jquery * @author Christan Mayer * @author Tobias BrÃ¤utigam * @since 0.5.3 (initial contribution) 0.10.0 (major refactoring) */ define( ['jquery'], function( $ ) { &quot;use strict&quot;; // //////////////////////////////////////////////////////////////////////// // module global static variables and methods: var // used for backwards compability backendNameAliases = { 'cgi-bin' : 'default', 'oh' : 'openhab', 'oh2' : 'openhab2' }, // setup of the different known backends backends = { 'default' : { name : 'default', baseURL : '/cgi-bin/', transport : 'long-polling', resources : { login : 'l', read : 'r', write : 'w', rrd : 'rrdfetch' }, maxConnectionAge: 60 * 1000, // in milliseconds - restart if last read is older maxDataAge: 3200 * 1000, // in milliseconds - reload all data when last successful read is older (should be faster than the index overflow at max data rate, i.e. 2^16 @ 20 tps for KNX TP) hooks : {} }, 'openhab' : { name : 'openHAB', baseURL : '/services/cv/', // keep the e.g. atmosphere tracking-id if there is one resendHeaders : { 'X-Atmosphere-tracking-id' : undefined }, // fixed headers that are send everytime headers : { 'X-Atmosphere-Transport' : 'long-polling' }, hooks : { onClose : function() { // send an close request to the openHAB server var oldValue = this.headers[&quot;X-Atmosphere-Transport&quot;]; this.headers[&quot;X-Atmosphere-Transport&quot;] = &quot;close&quot;; $.ajax({ url : this.getResourcePath('read'), dataType : 'json', context : this, beforeSend : this.beforeSend }); if (oldValue != undefined) { this.headers[&quot;X-Atmosphere-Transport&quot;] = oldValue; } else { delete this.headers[&quot;X-Atmosphere-Transport&quot;]; } } } } }, // definition of the different supported transport layers (OSI layer 4). transportLayers = { 'long-polling' : function( session ){ var self = this; this.doRestart = false; // are we currently in a restart, e.g. due to the watchdog this.xhr = false; // the ongoing AJAX request this.lastIndex = -1; // index returned by the last request this.retryCounter = 0; // count number of retries (reset with each valid response) /** * This function gets called once the communication is established * and session information is available. * * @param json * @param connect (boolean) wether to start the connection or not * @method handleSession */ this.handleSession = function(json, connect) { self.sessionId = json.s; self.version = json.v.split('.', 3); if (0 &lt; parseInt(self.version[0]) || 1 &lt; parseInt(self.version[1])) alert('ERROR CometVisu Client: too new protocol version (' + json.v + ') used!'); if (connect) { this.connect(); } }; this.connect = function() { self.running = true; // send first request if (session.initialAddresses.length) { this.xhr = $.ajax({ url : session.getResourcePath(&quot;read&quot;), dataType : 'json', context : this, data : session.buildRequest(session.initialAddresses) + '&amp;t=0', success : this.handleReadStart, beforeSend : this.beforeSend }); } else { // old behaviour -&gt; start full query this.xhr = $.ajax({ url : session.getResourcePath(&quot;read&quot;), dataType : 'json', context : this, data : session.buildRequest() + '&amp;t=0', success : this.handleRead, error : this.handleError, beforeSend : this.beforeSend }); } }; /** * This function gets called once the communication is established * and session information is available * * @method handleRead * @param json */ this.handleRead = function(json) { if( this.doRestart || (!json &amp;&amp; (-1 == this.lastIndex)) ) { session.dataReceived = false; if (self.running) { // retry initial request this.retryCounter++; this.xhr = $.ajax({ url : session.getResourcePath(&quot;read&quot;), dataType : 'json', context : this, data : session.buildRequest() + '&amp;t=0', success : this.handleRead, error : this.handleError, beforeSend : this.beforeSend }); session.watchdog.ping( true ); } return; } if (json &amp;&amp; !this.doRestart) { this.lastIndex = json.i; var data = json.d; this.readResendHeaderValues(); session.update(data); this.retryCounter = 0; session.dataReceived = true; } if (self.running) { // keep the requests going this.retryCounter++; this.xhr = $.ajax({ url : session.getResourcePath(&quot;read&quot;), dataType : 'json', context : this, data : session.buildRequest() + '&amp;i=' + this.lastIndex, success : this.handleRead, error : this.handleError, beforeSend : this.beforeSend }); session.watchdog.ping(); } }; this.handleReadStart = function(json) { if (!json &amp;&amp; (-1 == this.lastIndex)) { session.dataReceived = false; if (self.running) { // retry initial request this.xhr = $.ajax({ url : session.getResourcePath(&quot;read&quot;), dataType : 'json', context : this, data : session.buildRequest(session.initialAddresses) + '&amp;t=0', success : this.handleReadStart, beforeSend : this.beforeSend }); session.watchdog.ping(); } return; } if (json &amp;&amp; !this.doRestart) { this.readResendHeaderValues(); session.update(json.d); session.dataReceived = true; } if (self.running) { // keep the requests going, but only // request // addresses-startPageAddresses var diffAddresses = []; for (var i = 0; i &lt; session.addresses.length; i++) { if ($.inArray(self.addresses[i], session.initialAddresses) &lt; 0) diffAddresses.push(session.addresses[i]); } this.xhr = $.ajax({ url : session.getResourcePath(&quot;read&quot;), dataType : 'json', context : this, data : session.buildRequest(diffAddresses) + '&amp;t=0', success : this.handleRead, error : this.handleError, beforeSend : this.beforeSend }); session.watchdog.ping(); } }; /** * This function gets called on an error FIXME: this should be a * prototype, so that the application developer can override it * * @method handleError * @param xhr * @param str * @param excptObj */ this.handleError = function(xhr, str, excptObj) { if (self.running &amp;&amp; xhr.readyState != 4 &amp;&amp; !this.doRestart &amp;&amp; xhr.status !== 0) // ignore error when // connection is // irrelevant { var readyState = 'UNKNOWN'; switch (xhr.readyState) { case 0: readyState = 'UNINITIALIZED'; break; case 1: readyState = 'LOADING'; break; case 2: readyState = 'LOADED'; break; case 3: readyState = 'INTERACTIVE'; break; case 4: readyState = 'COMPLETED'; break; } alert('Error! Type: &quot;' + str + '&quot; ExceptionObject: &quot;' + excptObj + '&quot; readyState: ' + readyState); } }; /** * manipulates the header of the current ajax query before it is * been send to the server * * @param xhr * @method beforeSend */ this.beforeSend = function(xhr) { for ( var headerName in this.resendHeaders) { if (this.resendHeaders[headerName] != undefined) xhr.setRequestHeader(headerName, this.resendHeaders[headerName]); } for ( var headerName in this.headers) { if (this.headers[headerName] != undefined) xhr.setRequestHeader(headerName, this.headers[headerName]); } }; /** * read the header values of a response and stores them to the * resendHeaders array * * @method readResendHeaderValues */ this.readResendHeaderValues = function() { for ( var headerName in this.resendHeaders) { this.resendHeaders[headerName] = this.xhr .getResponseHeader(headerName); } }; /** * Check if the connection is still running. */ this.isConnectionRunning = function() { return true; } /** * Restart the read request, e.g. when the watchdog kicks in * * @method restart * @param {bool} doFullReload reload all data and not only restart connection */ this.restart = function( doFullReload ) { if( doFullReload ) this.lastIndex = -1; // reload all data self.doRestart = true; self.abort(); self.handleRead(); // restart self.doRestart = false; }; /** * Abort the read request properly * * @method restart */ this.abort = function() { if (this.xhr &amp;&amp; this.xhr.abort) { this.xhr.abort(); if (session.backend &amp;&amp; session.backend.hooks.onClose) { session.backend.hooks.onClose.bind(this); } } }; }, 'sse' : function( session ){ var self = this; /** * This function gets called once the communication is established * and session information is available * * @param connect (boolean) wether to start the connection or not * @method handleSession */ this.handleSession = function(json, connect) { self.sessionId = json.s; self.version = json.v.split('.', 3); if (0 &lt; parseInt(self.version[0]) || 1 &lt; parseInt(self.version[1])) alert('ERROR CometVisu Client: too new protocol version (' + json.v + ') used!'); if (connect) { this.connect(); } }; /** * Establish the SSE connection */ this.connect = function() { // send first request self.running = true; session.dataReceived = false; this.eventSource = new EventSource(session .getResourcePath(&quot;read&quot;) + &quot;?&quot; + session.buildRequest()); this.eventSource.addEventListener('message', this.handleMessage, false); this.eventSource.addEventListener('error', this.handleError, false); this.eventSource.onerror = function(event) { console.log(&quot;connection lost&quot;); }; this.eventSource.onopen = function(event) { console.log(&quot;connection established&quot;); }; session.watchdog.ping(); }; /** * Handle messages send from server as Server-Sent-Event */ this.handleMessage = function(e) { var json = JSON.parse(e.data); var data = json.d; session.watchdog.ping(); session.update(data); session.dataReceived = true; }; /** * Handle errors */ this.handleError = function(e) { if (e.readyState === EventSource.CLOSED) { // Connection was closed. self.running = false; // reconnect self.connect(); } }; /** * Check if the connection is still running. * * @returns {Boolean} */ this.isConnectionRunning = function() { return this.eventSource.readyState === EventSource.OPEN; }; /** * Restart the read request, e.g. when the watchdog kicks in * * @method restart */ this.restart = function() { self.abort(); self.connect(); }; /** * Abort the read request properly * * @method restart */ this.abort = function() { if (self.isConnectionRunning() === true) { this.eventSource.close(); } }; } }; /** * The CometVisuClient handles all communication issues to supply the user * ob this object with reliable realtime data. * Itself it can be seen as the session layer (layer 5) according to the OSI * model. * * @class CometVisuClient * @constructor * @alias module:cometvisu-client * @param {String} backendName - name of the backend (cgi-bin|default|oh|openhab|oh2|openhab2) * @param {String} [initPath] - optional path to login ressource */ function CometVisuClient( backendName, initPath ) { // Constructor // //////////////////////////////////////////////////////////////////////// // private static variables and methods: // ... none ... // check and fix if the user forgot the &quot;new&quot; keyword if (!(this instanceof CometVisuClient)) { return new CometVisuClient(); } /** * manipulates the header of the current ajax query before it is been send to the server */ this.beforeSend = function (xhr) { for (var headerName in this.resendHeaders) { if (this.resendHeaders[headerName] != undefined) xhr.setRequestHeader(headerName, this.resendHeaders[headerName]); } for (var headerName in this.headers) { if (this.headers[headerName] != undefined) xhr.setRequestHeader(headerName, this.headers[headerName]); } } /** * read the header values of a response and stores them to the resendHeaders array * @method readResendHeaderValues */ this.readResendHeaderValues = function () { for (var headerName in this.resendHeaders) { this.resendHeaders[headerName] = this.xhr.getResponseHeader(headerName); } } // //////////////////////////////////////////////////////////////////////// // Definition of the private variables var self = this, backend, watchdog = (function () { var last = new Date(), hardLast = last, maxConnectionAge, maxDataAge, aliveCheckFunction = function () { var now = new Date(); if (now - last &lt; maxConnectionAge &amp;&amp; self.currentTransport.isConnectionRunning()) return; self.currentTransport.restart(now - hardLast &gt; maxDataAge); last = now; }; return { start: function (watchdogTimer) { maxConnectionAge = backend.maxConnectionAge; maxDataAge = backend.maxDataAge; setInterval(aliveCheckFunction, watchdogTimer * 1000); }, ping: function (fullReload) { last = new Date(); if (fullReload) { hardLast = last; } } }; })(); // //////////////////////////////////////////////////////////////////////// // Definition of the public variables this.addresses = []; // the subscribed addresses this.initialAddresses = []; // the addresses which should be loaded // before the subscribed addresses this.filters = []; // the subscribed filters this.user = ''; // the current user this.pass = ''; // the current password this.device = ''; // the current device ID this.running = false; // is the communication running at the moment? this.currentTransport; // the currently used transport layer this.loginSettings = { loggedIn : false, callbackAfterLoggedIn : null, context : null, loginOnlyMode : false // login only for backend configuration, do not start address subscription }; this.dataReceived = false; // needed to be able to check if the incoming update is the initial answer or a successing update Object.defineProperty(this, 'backend', { get: function () { return backend; }, set: function (newBackend) { // override default settings backend = $.extend({}, backends['default'], newBackend); if (backend.transport === 'sse' &amp;&amp; backend.transportFallback) { if (window.EventSource === undefined) { // browser does not support EventSource object =&gt; use fallback // transport + settings $.extend(backend, backend.transportFallback); } } // add trailing slash to baseURL if not set if (backend.baseURL &amp;&amp; backend.baseURL.substr(-1) !== &quot;/&quot;) { backend.baseURL += &quot;/&quot;; } self.currentTransport = new transportLayers[backend.transport](self); } }); Object.defineProperty(this, 'watchdog', { get: function () { return watchdog; }, writeable: false }); // //////////////////////////////////////////////////////////////////////// // Definition of the private methods // ... none ... // //////////////////////////////////////////////////////////////////////// // Definition of the public methods /* return the relative path to a resource on the currently used backend * * @method getResourcePath * * @param name * {String} Name of the resource (e.g. login, read, write, rrd) * @returns {String} relative path to the resource */ this.getResourcePath = function (name) { return backend.baseURL + backend.resources[name]; }; /** * Subscribe to the addresses in the parameter. The second parameter * (filter) is optional * * @param addresses * @param filters * @method subscribe */ this.subscribe = function (addresses, filters) { var startCommunication = !this.addresses.length; // start when // addresses were // empty this.addresses = addresses ? addresses : []; this.filters = filters ? filters : []; if (!addresses.length) { this.stop(); // stop when new addresses are empty } else if (startCommunication) { if (this.loginSettings.loginOnly === true) { // connect to the backend this.currentTransport.connect(); // start the watchdog watchdog.start(5); this.loginSettings.loginOnly = false; } else { this.login(true); } } }; /** * This function starts the communication by a login and then runs the * ongoing communication task * * @param loginOnly (boolean) if true only login and backend configuration, no subscription to addresses (default: false) * @param callback (Function) cakk this function when login is done * @param context (Object) context for the callback (this) * @method login */ this.login = function (loginOnly, callback, context) { if (this.loginSettings.loggedIn === false) { this.loginSettings.loginOnly = !!loginOnly; this.loginSettings.callbackAfterLoggedIn = callback; this.loginSettings.context = context; var request = {}; if ('' !== this.user) { request.u = this.user; } if ('' !== this.pass) { request.p = this.pass; } if ('' !== this.device) { request.d = this.device; } $.ajax({ url: initPath ? initPath : this.getResourcePath(&quot;login&quot;), dataType: 'json', context: this, data: request, success: this.handleLogin }); } else if (this.loginSettings.callbackAfterLoggedIn) { // call callback immediately this.loginSettings.callbackAfterLoggedIn.call(this.loginSettings.context); this.loginSettings.callbackAfterLoggedIn = null; this.loginSettings.context = null; } }; /** * Handles login response, applies backend configuration if send by * backend and forwards to the configurated transport handleSession * function * * @param json */ this.handleLogin = function (json) { // read backend configuration if send by backend if (json.c) { self.backend = $.extend(self.backend, json.c); // assign itself to run setter } this.dataReceived = false; if (this.loginSettings.loginOnly) { this.currentTransport.handleSession(json, false); } else { this.currentTransport.handleSession(json, true); // once the connection is set up, start the watchdog watchdog.start(5); } this.loginSettings.loggedIn = true; if (this.loginSettings.callbackAfterLoggedIn) { this.loginSettings.callbackAfterLoggedIn.call(this.loginSettings.context); this.loginSettings.callbackAfterLoggedIn = null; this.loginSettings.context = null; } }; /** * This function stops an ongoing connection * * @method stop */ this.stop = function () { this.running = false; if (this.currentTransport.abort) { this.currentTransport.abort(); } this.loginSettings.loggedIn = false; }; /** * Build the URL part that contains the addresses and filters * @method buildRequest * @param addresses * @return {String} */ this.buildRequest = function (addresses) { addresses = addresses ? addresses : this.addresses; var requestAddresses = (addresses.length) ? 'a=' + addresses.join('&amp;a=') : '', requestFilters = (this.filters.length) ? 'f=' + this.filters.join('&amp;f=') : ''; return 's=' + this.session + '&amp;' + requestAddresses + ((addresses.length &amp;&amp; this.filters.length) ? '&amp;' : '') + requestFilters; }; /** * This function sends a value * @param address * @param value * @method write */ this.write = function (address, value) { /** * ts is a quirk to fix wrong caching on some Android-tablets/Webkit; * could maybe selective based on UserAgent but isn't that costly on writes */ var ts = new Date().getTime(); $.ajax({ url: this.getResourcePath(&quot;write&quot;), dataType: 'json', context: this, data: 's=' + this.session + '&amp;a=' + address + '&amp;v=' + value + '&amp;ts=' + ts }); }; // //////////////////////////////////////////////////////////////////////// // Constructor // init default settings if (backendNameAliases[backendName]) { backendName = backendNameAliases[backendName]; } if (backendName &amp;&amp; backendName !== 'default') { if ($.isPlainObject(backendName)) { // override default settings self.backend = $.extend({}, backends['default'], backendName); } else if (backends[backendName]) { // merge backend settings into default backend self.backend = $.extend({}, backends['default'], backends[backendName]); } } else { self.backend = backends['default']; } CometVisuClient.prototype.update = function (json) { }; } return CometVisuClient; }); Ã— Search results Close "},"lib_PagePartsHandler.js.html":{"id":"lib_PagePartsHandler.js.html","title":"Source: lib/PagePartsHandler.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/PagePartsHandler.js /* PagePartsHandler.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * @author Christian Mayer * @since 2010 */ define([ 'jquery' ], function( $ ) { &quot;use strict&quot;; return function PagePartsHandler() { var thisPagePartsHandler = this; this.navbars = { // store informations about the nav bars top : { dynamic : false }, left : { dynamic : false }, right : { dynamic : false }, bottom : { dynamic : false } }; this.updateTopNavigation = function( self ) { if( self === undefined ) self = this; var path = $('#main .page').eq(self.getIndex()).attr('id').split('_'); var id = 'id_'; // path[0]; var nav = '&lt;a href=&quot;javascript:templateEngine.scrollToPage(\\'' + id + '\\')&quot;&gt;' + $('#' + id + ' h1').text() + '&lt;/a&gt;'; for ( var i = 1; i &lt; path.length; i++) { // element 0 is id_ (JNK) id += path[i] + '_'; if ($('#' + id ).hasClass(&quot;page&quot;)) { // FIXME is this still needed?!? nav += '&lt;span&gt; &amp;#x25ba; &lt;/span&gt;' + '&lt;a href=&quot;javascript:templateEngine.scrollToPage(\\'' + id + '\\')&quot;&gt;' + $('#' + id + ' h1').text() + '&lt;/a&gt;'; } } $('.nav_path').html(nav); // templateEngine.handleResize(); - TODO CM160528: why? This shouldn't have // any effect on the page size =&gt; commented out }; /** * Change the size of the selected navbar * * currently only &quot;left&quot; and &quot;right&quot; are implemented */ this.navbarSetSize = function(position, size) { var cssSize = size + (isFinite(size) ? 'px' : ''); switch (position) { case 'left': $('#navbarLeft').css({ width : cssSize }); templateEngine.resizeHandling.invalidateNavbar(); break; case 'right': $('#centerContainer').css('padding-right', cssSize); $('#navbarRight').css({ width : cssSize, 'margin-right' : '-' + cssSize }); templateEngine.resizeHandling.invalidateNavbar(); break; } }; this.getNavbarsVisibility = function(page) { if (templateEngine.currentPageNavbarVisibility==null) { if (page==null) { page = templateEngine.currentPage; } if( page===null ) return { top : 'true', bottom : 'true', left : 'true', right : 'true' }; var pageData = templateEngine.widgetDataGet(page.attr('id')); if( pageData==null ) return { top : 'true', bottom : 'true', left : 'true', right : 'true' }; var shownavbar = (pageData.shownavbar != undefined ? pageData.shownavbar : { top : 'inherit', bottom : 'inherit', left : 'inherit', right : 'inherit' }); // set inherit for undefined for (var pos in shownavbar) { if (shownavbar[pos] == undefined) { shownavbar[pos] = 'inherit'; } } if (pageData != null) { // traverse up the page tree for shownavbar var parentPage = templateEngine.getParentPage(page); while (parentPage != null) { // do we need to go further? Check for inheritance var inherit = false; for (var pos in shownavbar) { if (shownavbar[pos] == 'inherit') { inherit = true; break; } } if (inherit) { var parentPageData=templateEngine.widgetDataGet(parentPage.attr('id')); if (parentPageData.shownavbar != undefined) { for (var pos in shownavbar) { if (shownavbar[pos] == 'inherit') { // set value of parent page shownavbar[pos] = parentPageData.shownavbar[pos]; if (shownavbar[pos] == undefined) { shownavbar[pos] = 'inherit'; } } } } } else { // we are done break; } parentPage = templateEngine.getParentPage(parentPage); } } // set default values for shownavbar if not set otherwise for (var pos in shownavbar) { if (shownavbar[pos] == undefined || shownavbar[pos] == 'inherit') { shownavbar[pos] = 'true'; } } templateEngine.currentPageNavbarVisibility = shownavbar; // console.log(shownavbar); } return templateEngine.currentPageNavbarVisibility; }; /** * update the visibility ob top-navigation, footer and navbar for this page * * @param page */ this.updatePageParts = function( page, speed ) { // default values var showtopnavigation = true; var showfooter = true; var shownavbar = thisPagePartsHandler.getNavbarsVisibility(page); var pageData = templateEngine.widgetDataGet(page.attr('id')); if (pageData != null) { if (pageData.showtopnavigation != undefined) { showtopnavigation = pageData.showtopnavigation != &quot;false&quot;; } else { // traverse up the page tree var parentPage = templateEngine.getParentPage(page); while (parentPage != null) { var parentData = templateEngine.widgetDataGet(parentPage.attr('id')); if (parentData.showtopnavigation != undefined) { showtopnavigation = parentData.showtopnavigation != &quot;false&quot;; break; } parentPage = templateEngine.getParentPage(parentPage); } } if (pageData.showfooter != undefined) { showfooter = pageData.showfooter != &quot;false&quot;; } else { // traverse up the page tree var parentPage = templateEngine.getParentPage(page); while (parentPage != null) { var parentData = templateEngine.widgetDataGet(parentPage.attr('id')); if (parentData.showfooter != undefined) { showfooter = parentData.showfooter != &quot;false&quot;; break; } parentPage = templateEngine.getParentPage(parentPage); } } } if (showtopnavigation) { if ($('#top').css(&quot;display&quot;) == &quot;none&quot;) { $('#top, #top &gt; *').css(&quot;display&quot;, &quot;block&quot;); thisPagePartsHandler.removeInactiveNavbars(page.attr('id')); } } else { if ($('#top').css(&quot;display&quot;) != &quot;none&quot;) { $('#top').css(&quot;display&quot;, &quot;none&quot;); thisPagePartsHandler.removeInactiveNavbars(page.attr('id')); } } if (showfooter) { if ($('#bottom').css(&quot;display&quot;) == &quot;none&quot;) { $('#bottom').css(&quot;display&quot;, &quot;block&quot;); thisPagePartsHandler.removeInactiveNavbars(page.attr('id')); } } else { if ($('#bottom').css(&quot;display&quot;) != &quot;none&quot;) { $('#bottom').css(&quot;display&quot;, &quot;none&quot;); thisPagePartsHandler.removeInactiveNavbars(page.attr('id')); } } [ 'Left', 'Top', 'Right', 'Bottom' ].forEach( function(value) { var key = value.toLowerCase(), $navbar = $('#navbar' + value), display = $navbar.css(&quot;display&quot;), isLoading = $navbar[0].classList.contains('loading'); if (shownavbar[key] == 'true') { if (display == &quot;none&quot; || isLoading) { thisPagePartsHandler.fadeNavbar( value, &quot;in&quot;, speed ); thisPagePartsHandler.removeInactiveNavbars(page.attr('id')); } } else { if (display != &quot;none&quot; || isLoading) { thisPagePartsHandler.fadeNavbar( value, &quot;out&quot;, speed ); } } }); templateEngine.resizeHandling.invalidateNavbar(); }; /** * fades in/out a navbar * * @param position * [Top|Left|Right|Bottom] * @param direction * [in|out] * @param speed * time in milliseconds */ this.fadeNavbar = function(position, direction, speed) { speed = (speed !== undefined) ? speed : templateEngine.main_scroll.getSpeed(); var initCss = {}; var targetCss = {}; var navbar = $('#navbar' + position); var key = position.toLowerCase(); var fn = function() { templateEngine.resizeHandling.invalidateNavbar(); }; switch (direction) { case &quot;in&quot;: if (navbar.css('display') == 'none') { initCss.display = 'block'; } targetCss[key] = 0; switch (position) { case &quot;Top&quot;: case &quot;Bottom&quot;: initCss[key] = -navbar.height(); break; case &quot;Left&quot;: case &quot;Right&quot;: initCss[key] = -navbar.width(); break; } break; case &quot;out&quot;: fn = function() { navbar.css(&quot;display&quot;, &quot;none&quot;); templateEngine.resizeHandling.invalidateNavbar(); }; switch (position) { case &quot;Top&quot;: case &quot;Bottom&quot;: targetCss[key] = -navbar.height(); break; case &quot;Left&quot;: case &quot;Right&quot;: targetCss[key] = -navbar.width(); break; } break; } navbar.css(initCss); if( speed == 0 ) { navbar.css(targetCss); fn(); } else { navbar.animate(targetCss, speed, templateEngine.main_scroll.getEasing(), fn); } }; /** * traverse down the page tree from root page id_ -&gt; .. -&gt; page_id activate * all navbars in that path deactivate all others * * @param page_id */ this.initializeNavbars = function(page_id) { thisPagePartsHandler.removeInactiveNavbars(page_id); var tree = [ $('#id_').get(0) ]; if (page_id != &quot;id_&quot;) { var parts = page_id.split(&quot;_&quot;); parts.pop(); parts[0] = ''; for ( var i = 0; i &lt; parts.length; i++) { var item = $('#id' + parts.slice(0, i + 1).join('_') + &quot;_.page&quot;, '#pages'); if (item.length == 1) { tree.push(item.get(0)); } } } var level = 1; $(tree).each(function(i) { var id = $(this).attr('id'); var topNav = $('#' + id + 'top_navbar'); var topData = templateEngine.widgetDataGet( id + 'top_navbar' ); var rightNav = $('#' + id + 'right_navbar'); var rightData = templateEngine.widgetDataGet( id + 'right_navbar' ); var bottomNav = $('#' + id + 'bottom_navbar'); var bottomData = templateEngine.widgetDataGet( id + 'bottom_navbar' ); var leftNav = $('#' + id + 'left_navbar'); var leftData = templateEngine.widgetDataGet( id + 'left_navbar' ); // console.log(tree.length+&quot;-&quot;+level+&quot;&lt;=&quot;+topData.scope); if (topNav.length &gt; 0) { if (topData.scope == undefined || topData.scope &lt; 0 || tree.length - level &lt;= topData.scope) { topNav.addClass('navbarActive'); } else { topNav.removeClass('navbarActive'); } } if (rightNav.length &gt; 0) { if (rightData.scope == undefined || rightData.scope &lt; 0 || tree.length - level &lt;= rightData.scope) { rightNav.addClass('navbarActive'); } else { rightNav.removeClass('navbarActive'); } } if (bottomNav.length &gt; 0) { if (bottomData.scope == undefined || bottomData.scope &lt; 0 || tree.length - level &lt;= bottomData.scope) { bottomNav.addClass('navbarActive'); } else { bottomNav.removeClass('navbarActive'); } } if (leftNav.length &gt; 0) { if (leftData.scope == undefined || leftData.scope &lt; 0 || tree.length - level &lt;= leftData.scope) { leftNav.addClass('navbarActive'); } else { leftNav.removeClass('navbarActive'); } } level++; }); templateEngine.resizeHandling.invalidateNavbar(); }; this.removeInactiveNavbars = function(page_id) { // remove all navbars that do not belong to this page $('.navbar.navbarActive').each(function(i) { var navBarPath = this.id.split('_'); // skip last 2 elements e.g. '_top_navbar' navBarPath = navBarPath.slice(0, navBarPath.length - 2).join('_'); var expr = new RegExp(&quot;^&quot; + navBarPath + &quot;.*&quot;, &quot;i&quot;); if (navBarPath != page_id &amp;&amp; !expr.test(page_id)) { $(this).removeClass('navbarActive'); } }); }; } }); // end define Ã— Search results Close "},"lib_mockup_Client.js.html":{"id":"lib_mockup_Client.js.html","title":"Source: lib/mockup/Client.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/mockup/Client.js /* Client.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Mockup simulating a backend + client for the Cometvisu protocol * * @author Tobias BrÃ¤utigam * @since 2016 */ define( [], function() { &quot;use strict&quot;; function CometVisu( ) { this.dataReceived = true; /** * This function gets called once the communication is established and session information is available * @method handleRead */ this.receive = function( json ) { if( json ) { this.update( json.d ); } }; this.login = function (loginOnly, callback, context) { if (callback) { callback.call(context); } }; // make some functions accessible for the protactor runner window._receive = this.receive.bind(this); window._widgetDataGet = templateEngine.widgetDataGet.bind(templateEngine); window.writeHistory = []; /** * Subscribe to the addresses in the parameter * @method subscribe */ this.subscribe = function( addresses ) { this.addresses = addresses ? addresses : []; }; /** * This function sends a value * @method write */ this.write = function( address, value ) { var ts = new Date().getTime(); // store in window, to make it accessible for protractor window.writeHistory.push({ address: address, value: value, ts: ts }); // send update var answer = { i: ts, d: {} }; answer.d[address] = value; this.receive(answer); }; this.stop = function() {}; this.getResourcePath = function(name) { return name; }; } CometVisu.prototype.update = function( json ) {}; return CometVisu; }); Ã— Search results Close "},"plugins_openweathermap_owm_jquery.owm.js.html":{"id":"plugins_openweathermap_owm_jquery.owm.js.html","title":"Source: plugins/openweathermap/owm/jquery.owm.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: plugins/openweathermap/owm/jquery.owm.js /** * Plugin: jquery.OWM * * jQuery plugin to display data from OpenWeatherMap. * * Version: 0.0.1 * Copyright (c) 2015, Stefan Borchert * * Licensed under the GPLv3 license. **/ var jOWM = jOWM || {}; (function ($) { $.fn.openweathermap = function(options, fn) { // Set plugin defaults. var defaults = { // Base URL to service. baseURL: 'http://api.openweathermap.org/data/2.5/', // Number of items to show detailed data for (0..4). detailItems: 4, // Number of items in forecast (0..16). forecastItems: 5, // Include today in forecast? forecastToday: true, // Default units. units: 'metric', // Type ('exact', 'like'). type: 'like', // Refresh interval in minutes. refresh: 30, // App-ID needed to access the service. appid: '' }; var options = $.extend(defaults, options); // Sanitize options. options.detailItems = parseInt(options.detailItems, 10); if (options.detailItems &lt; 0) { options.detailItems = 0; } if (options.detailItems &gt; 4) { options.detailItems = 4; } options.forecastItems = parseInt(options.forecastItems, 10); if (options.forecastItems &lt; 0) { options.forecastItems = 0; } if (options.forecastItems &gt; 16) { options.forecastItems = 16; } // extend locales by German and French Date.ext.locales['de'] = { a: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'], A: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'], b: ['Jan', 'Feb', 'MÃ¤r', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'], B: ['Januar', 'Februar', 'MÃ¤rz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'], }; return this.each(function(i, e) { $element = $(e); if (!$element.hasClass('jowm')) { $element.addClass('jowm'); } // Process element. _process(e, options); }); }; var _process = function (e, options) { var html = ''; var paramsDefault = _parametersFromOptions(options); var currentURL = options.baseURL + 'forecast?' + paramsDefault.join('&amp;'); var forecastItems = paramsDefault; // Limit results to specified number of days. forecastItems.push('cnt=' + options.forecastItems); var forecastURL = options.baseURL + 'forecast/daily?' + forecastItems.join('&amp;'); if ($('ul.detailed', $(e)).length === 0) { $('&lt;ul&gt;') .addClass('detailed') .addClass('clearfix') .appendTo($(e)); } if ($('ul.forecast', $(e)).length === 0) { $('&lt;ul&gt;') .addClass('forecast') .addClass('clearfix') .appendTo($(e)); } // Load location data. $.getJSON(options.baseURL + 'weather?' + paramsDefault.join('&amp;'), function (data) { if (data.cod == 200) { // Load sunrise/sunset. options.sunrise = data.sys.sunrise; options.sunset = data.sys.sunset; // Fetch data for detailed items. _processDataDetailed(e, currentURL, options); // Fetch data for forecast items. _processDataForecast(e, forecastURL, options); } else { $(e).after('&lt;!-- Failed to fetch detailed weather data. --&gt;'); } }); } /** * Process detailed weather data and generate output. */ var _processDataDetailed = function (e, url, options) { // Clear old markup. $('ul.detailed', $(e)).html(''); if (options.detailItems === 0) { // Detailed items are disabled. return; } $.getJSON(url, function (data) { if (data.cod == 200) { var dataItems = data.list.slice(0, options.detailItems); $.each(dataItems, function (index, elem) { $item = $('&lt;li&gt;'); if (elem.dt &lt; options.sunrise || elem.dt &gt; options.sunset) { $item.addClass('night'); } if (index === 0) { $item.addClass('first'); } if (index === (dataItems.length - 1)) { $item.addClass('last'); } $item.html(jOWM.theme('weatherDetailItem', elem, options)); $item.appendTo($('ul.detailed', $(e))); }); } else { $(e).after('&lt;!-- Failed to fetch detailed weather data. --&gt;'); } }); } /** * Process forecast weather data and generate output. */ var _processDataForecast = function (e, url, options) { // Clear old markup. $('ul.forecast', $(e)).html(''); if (options.forecastItems === 0) { // Forecast is disabled. return; } $.getJSON(url, function (data) { if (data.cod == 200) { var dataItems = data.list; if (!options.forecastToday) { // Remove first item from list. dataItems.shift(); } $.each(dataItems, function (index, elem) { $item = $('&lt;li&gt;'); if (index === 0) { $item.addClass('first'); } if (index === (dataItems.length - 1)) { $item.addClass('last'); } $item.html(jOWM.theme('weatherForecastItem', elem, options)); $item.appendTo($('ul.forecast', $(e))); }); } else { $(e).after('&lt;!-- Failed to fetch forecast weather data. --&gt;'); } }); } /** * Helper function to create URL parameters from options. * * @param options * List of widget options. */ var _parametersFromOptions = function(options) { var items = []; if (options.hasOwnProperty('lang')) { items.push('lang=' + options.lang); } if (options.hasOwnProperty('q')) { items.push('q=' + options.q); } else if (options.hasOwnProperty('lat') &amp;&amp; options.hasOwnProperty('lon')) { items.push('lat=' + options.lat); items.push('lon=' + options.lon); } if (options.hasOwnProperty('units')) { items.push('units=' + options.units); } if (options.hasOwnProperty('type')) { items.push('type=' + options.type); } if (options.hasOwnProperty('appid')) { items.push('appid=' + options.appid); } return items; } /** * Generic theme function. */ jOWM.theme = function (func) { var args = Array.prototype.slice.apply(arguments, [1]); return (jOWM.theme[func] || jOWM.theme.prototype[func]).apply(this, args); }; /** * Default theme function for weather temperature. */ jOWM.theme.prototype.weatherTemperature = function (temperature, precision, suffix) { suffix = suffix || 'Â°'; return parseFloat(temperature).toFixed(precision) + suffix; } /** * Default theme function for detailed weather item. */ jOWM.theme.prototype.weatherDetailItem = function (data, options) { var weather = data.weather[0]; var temperature = data.main; var d = new Date(data.dt * 1000); // We need ms, not s! d.locale = options.lang; var output = '&lt;div class=&quot;weather-detailed weather-' + weather.id + ' clearfix&quot;&gt;'; output += ' &lt;div class=&quot;weather&quot;&gt;'; output += ' &lt;span class=&quot;weather-icon&quot; data-weather-text=&quot;' + weather.description + '&quot; data-weather-code=&quot;' + weather.id + '&quot;&gt;&lt;/span&gt;'; output += ' &lt;/div&gt;'; output += ' &lt;div class=&quot;temperature&quot;&gt;' + jOWM.theme('weatherTemperature', temperature.temp, 1) + '&lt;/div&gt;'; output += '&lt;/div&gt;'; return output; }; /** * Default theme function for forecast weather item. */ jOWM.theme.prototype.weatherForecastItem = function (data, options) { var weather = data.weather[0]; var temperature = data.temp; var d = new Date(data.dt * 1000); // We need ms, not s! d.locale = options.lang; var output = '&lt;div class=&quot;weather-forecast weather-' + weather.id + ' clearfix&quot;&gt;'; output += ' &lt;div class=&quot;day&quot;&gt;' + d.strftime('%a') + '&lt;/div&gt;'; output += ' &lt;div class=&quot;weather-icon&quot; data-weather-text=&quot;' + weather.description + '&quot; data-weather-code=&quot;' + weather.id + '&quot;&gt;&lt;/div&gt;'; output += ' &lt;div class=&quot;temperature high&quot;&gt;' + jOWM.theme('weatherTemperature', temperature.max, 0, ' Â°C') + '&lt;/div&gt;'; output += ' &lt;div class=&quot;temperature low&quot;&gt;' + jOWM.theme('weatherTemperature', temperature.max, 0, ' Â°C') + '&lt;/div&gt;'; output += '&lt;/div&gt;'; return output; }; })(jQuery); Ã— Search results Close "},"plugins_powerspectrum_structure_plugin.js.html":{"id":"plugins_powerspectrum_structure_plugin.js.html","title":"Source: plugins/powerspectrum/structure_plugin.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: plugins/powerspectrum/structure_plugin.js /* structure_plugin.js (c) 2016 by Christian Mayer [CometVisu at ChristianMayer dot de] * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * The powerspectrum plugin and widget creates a graph to show the power * spectral data that the Enertex Smartmeter can send on the KNX bus. * * @module plugins/powerspectrum/structure_plugin * @requires structure/pure * @author Christian Mayer * @since 0.10.0 * */ require.config({ shim: { 'plugins/diagram/dep/flot/jquery.flot.min': ['jquery'], 'plugins/diagram/dep/flot/jquery.flot.canvas.min': ['plugins/diagram/dep/flot/jquery.flot.min'], 'plugins/diagram/dep/flot/jquery.flot.resize.min': ['plugins/diagram/dep/flot/jquery.flot.min'], 'plugins/diagram/dep/flot/jquery.flot.navigate.min': ['plugins/diagram/dep/flot/jquery.flot.min'] } }); define( ['structure_custom', 'plugins/diagram/dep/flot/jquery.flot.min', 'plugins/diagram/dep/flot/jquery.flot.canvas.min', 'plugins/diagram/dep/flot/jquery.flot.resize.min', 'plugins/diagram/dep/flot/jquery.flot.navigate.min' ], function( VisuDesign_Custom ) { &quot;use strict&quot;; // Constants var CURRENT = 0, VOLTAGE = 1, limitEN50160_1999 = [[2,0.02],[3,0.05],[4,0.01],[5,0.06],[6,0.005],[7,0.05], [8,0.005],[9,0.015],[10,0.005],[11,0.035],[12,0.005],[13,0.03],[14,0.005], [15,0.005],[16,0.005],[17,0.02],[18,0.005],[19,0.015],[20,0.005], [21,0.005],[22,0.005],[23,0.015],[24,0.005],[25,0.015] ], // limit for voltage in ratio limitEN61000_3_2 = [[2,1.620],[3,3.450],[4,0.650],[5,1.710],[6,0.450], [7,1.160],[8,0.350],[9,0.600],[10,0.280],[11,0.500],[12,0.233],[13,0.320], [14,0.200],[15,0.230],[16,0.175],[17,0.203],[18,0.155],[19,0.182], [20,0.140],[21,0.164],[22,0.127],[23,0.150],[24,0.117],[25,0.139] ], // limit for current in Ampere referenceSin = [[],[],[]]; // fix limits for better displaying function fixLimits( entry, index, array ) { array[index][0] -= 0.5; } function lastShifted( array ) { var last = array[ array.length-1 ]; return [ last[0]+1, last[1] ]; } limitEN50160_1999.forEach( fixLimits ); limitEN50160_1999.push( lastShifted( limitEN50160_1999 ) ); limitEN61000_3_2.forEach( fixLimits ); limitEN61000_3_2.push( lastShifted( limitEN61000_3_2 ) ); // fill reference for( var phi = 0; phi &lt; 50; phi++ ) { var time = phi * 20 / 50; // time in milliseconds referenceSin[0].push( [ time, Math.sin( (phi ) * Math.PI / 25 ) ] ); referenceSin[1].push( [ time, Math.sin( (phi+ 50/3) * Math.PI / 25 ) ] ); referenceSin[2].push( [ time, Math.sin( (phi+100/3) * Math.PI / 25 ) ] ); } /** * Setup helper */ function setupCurve() { return [[0,0],[0.4,0],[0.8,0],[1.2,0],[1.6,0],[2,0],[2.4,0],[2.8,0],[3.2,0], [3.6,0],[4,0],[4.4,0],[4.8,0],[5.2,0],[5.6,0],[6,0],[6.4,0],[6.8,0],[7.2,0], [7.6,0],[8,0],[8.4,0],[8.8,0],[9.2,0],[9.6,0],[10,0],[10.4,0],[10.8,0], [11.2,0],[11.6,0],[12,0],[12.4,0],[12.8,0],[13.2,0],[13.6,0],[14,0], [14.4,0],[14.8,0],[15.2,0],[15.6,0],[16,0],[16.4,0],[16.8,0],[17.2,0], [17.6,0],[18,0],[18.4,0],[18.8,0],[19.2,0],[19.6,0]]; } function setupSpectrum( offset ) { var ret_val = []; if( undefined === offset ) offset = 0; for( var i = 2; i &lt; 52; i++ ) ret_val.push( [ i + offset, 0 ] ); return ret_val; } /** * Convert a spectrum to a curve */ function updateCurve( input, target, phase ) { var inp = input[phase], out = target[phase], shift = (phase * 2 / 3 - 0.5) * Math.PI; for( var i = 0; i &lt; 50; i++ ) { var phi = i * Math.PI / 25, value = Math.cos( phi + shift ); // the base with 50 Hz // the harmonics for( var j = 2; j &lt; 50; j++ ) { value += Math.cos( (phi+shift) * j ) * inp[j][1]; } out[i][1] = value; } } /** * Little helper to setup the Flot dataset structure. */ function createDatasetCurve( widgetData ) { return widgetData.singlePhase ? [ { label: null, data: referenceSin[0], color:13 }, // trick flot to automatically make color darker { label: 'L', data: widgetData.curve[0], color:1 } ] : [ { label: null, data: referenceSin[0], color:13 }, { label: null, data: referenceSin[1], color:14 }, { label: null, data: referenceSin[2], color:15 }, { label: 'L1', data: widgetData.curve[0], color:1 }, { label: 'L2', data: widgetData.curve[1], color:2 }, { label: 'L3', data: widgetData.curve[2], color:3 } ]; } /** * Little helper to setup the Flot dataset structure. */ function createDatasetSpectrum( widgetData ) { return widgetData.singlePhase ? [ { label: widgetData.limitName, data:widgetData.displayType===VOLTAGE?limitEN50160_1999:limitEN61000_3_2, bars:{show:false}, lines:{steps:true}, color:0 }, { label: widgetData.name1, data:widgetData.spectrum[0] , color:1} ] : [ { label: widgetData.limitName, data:widgetData.displayType===VOLTAGE?limitEN50160_1999:limitEN61000_3_2, bars:{show:false}, lines:{steps:true}, color:0 }, { label: widgetData.name1, data:widgetData.spectrum[0], color:1 }, { label: widgetData.name2, data:widgetData.spectrum[1], color:2 }, { label: widgetData.name3, data:widgetData.spectrum[2], color:3 } ]; } /** * This will create a diagram to show the frequency that the Enertex * Smartmeter pushes on the KNX bus. */ VisuDesign_Custom.prototype.addCreator( 'powerspectrum', { create: function( element, path, flavour, type ) { var $e = $(element), displayType = $e.attr('type') === 'current' ? CURRENT : VOLTAGE, singlePhase = $e.attr('singlephase') === 'true' ? true : false; // create the main structure function handleVariant(src, transform, mode, variant) { if( !variant ) variant = 'spectrum'; // the default return [true, variant]; } var ret_val = templateEngine.design.createDefaultWidget( 'powerspectrum', $e, path, flavour, type, this.update, handleVariant ); var data = templateEngine.widgetDataInsert( path, { displayType: displayType, singlePhase: singlePhase, spectrum: singlePhase ? [ setupSpectrum() ] : [ setupSpectrum(-0.26), setupSpectrum(0), setupSpectrum(0.26) ], limitName: $e.attr('limitname') || 'limit', name1: $e.attr('name1') || (singlePhase ? 'L' : 'L1'), name2: $e.attr('name2') || 'L2', name3: $e.attr('name3') || 'L3', curve: singlePhase ? [ setupCurve() ] : [ setupCurve(), setupCurve(), setupCurve() ], current: [], showCurve: $e.attr('spectrumonly') === 'true' ? false : true, showLegend: $e.attr('showlegend') === 'true' ? true : false, colors: [ $e.attr('limitcolor') || &quot;#edc240&quot;, // default directly from flot code $e.attr('color1') || &quot;#afd8f8&quot;, $e.attr('color2') || &quot;#cb4b4b&quot;, $e.attr('color3') || &quot;#4da74d&quot; ] }); // create the actor var actor = '&lt;div class=&quot;actor clickable&quot;&gt;'; if( data.showCurve ) actor += '&lt;div class=&quot;diagram_inline curve&quot;&gt;loading...&lt;/div&gt;'; actor += '&lt;div class=&quot;diagram_inline spectrum&quot;&gt;loading...&lt;/div&gt;&lt;/div&gt;'; this.construct(path); return ret_val + actor + '&lt;/div&gt;'; }, construct: function(path) { var data = templateEngine.widgetDataGet(path); templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { var diagramCurve = data.showCurve &amp;&amp; $( '#' + path + ' .actor div.curve' ).empty(), optionsCurve = data.showCurve &amp;&amp; { colors: data.colors, legend: { show: data.showLegend // default to false }, xaxis: { show: false }, yaxis: { show: false } }, diagramSpectrum = $( '#' + path + ' .actor div.spectrum' ).empty(), optionsSpectrum = { colors: data.colors, series: { bars: { show: true, fill: 1, fillColor: null, lineWidth: 0 } }, bars: { align: &quot;center&quot;, barWidth: data.singlePhase ? 0.75 : 0.25 }, legend: { show: data.showLegend // default to true }, xaxis: { show: false }, yaxis: { show: false } }; data.plotCurve = data.showCurve &amp;&amp; $.plot(diagramCurve, createDatasetCurve( data ), optionsCurve); data.plot = $.plot(diagramSpectrum, createDatasetSpectrum( data ), optionsSpectrum); }); }, update: function( ga, data ) { var element = $(this), widgetData = templateEngine.widgetDataGetByElement( this ), addressInfo = widgetData.address[ ga ]; if( addressInfo[2][0] === 'I' ) { var phase = widgetData.singlePhase ? 1 : +(addressInfo[2][1] || 1), value = templateEngine.transformDecode( addressInfo[0], data ); widgetData.current[phase-1] = value / 1000; // transform mA to A } else if( widgetData.address[ ga ][2].substr(0,8) === 'spectrum' &amp;&amp; data.length === 28 ) // sanity check for 14 bytes { var phase = widgetData.singlePhase ? 1 : +(addressInfo[2][8] || 1), index = parseInt( data.substr( 0, 2 ), 16 ), factor = widgetData.current[phase-1] || 1, values = []; for( var i = 0; i &lt; 13; i++ ) { if( index + i &lt; 2 ) continue; values[i] = Math.pow( 10, (parseInt( data.substr( i*2 + 2, 2 ), 16 ) - 253) / 80); widgetData.spectrum[phase-1][ index + i - 2 ][1] = values[i] * factor; } widgetData.plot.setData( createDatasetSpectrum( widgetData ) ); widgetData.plot.draw(); if( widgetData.plotCurve ) { updateCurve( widgetData.spectrum, widgetData.curve, phase-1 ); widgetData.plotCurve.setData( createDatasetCurve( widgetData ) ); widgetData.plotCurve.draw(); } } } }); }); Ã— Search results Close "},"structure_pure__common.js.html":{"id":"structure_pure__common.js.html","title":"Source: structure/pure/_common.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/_common.js /* _common.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * This module defines the widgets for the CometVisu visualisation. * @module structure/pure * @title CometVisu Structure &quot;pure&quot; * @author Christian Mayer [CometVisu at ChristianMayer dot de] * @since 2010 */ define( ['jquery'], function($) { &quot;use strict&quot;; // Define ENUM of maturity levels for features, so that e.g. the editor can // ignore some widgets when they are not supported yet var Maturity = { release : 0, development : 1 }; /** * This class defines all the building blocks for a Visu in the &quot;Pure&quot; design * @class VisuDesign * @method VisuDesign */ function VisuDesign() { var self = this; this.creators = {}; /** * Description * @method addCreator * @param {} name * @param {} object */ this.addCreator = function (name, object) { this.creators[name] = object; } /** * Description * @method getCreator * @param {} name * @return MemberExpression */ this.getCreator = function(name) { if (this.creators[name] === undefined) { return this.creators.unknown; } return this.creators[name]; } var popups = {}; /** * Description * @method addPopup * @param {} name * @param {} object */ this.addPopup = function (name, object) { popups[name] = object; popups[name].type = name; } /** * Description * @method getPopup * @param {} name * @return MemberExpression */ this.getPopup = function(name) { var p = popups[name]; if (p === undefined) { return popups.unknown; } return popups[name]; } this.addPopup('unknown', { /** * Description * @method create * @param {} attributes * @return ret_val */ create: function( attributes ) { var reposition = false; var ret_val = $('&lt;div class=&quot;popup&quot; style=&quot;display:none&quot;&gt;&lt;div class=&quot;popup_close&quot;&gt;X&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;popup_background&quot; style=&quot;display:none&quot; /&gt;').appendTo('body'); ret_val.addClass( this.type ); if (attributes.title) { ret_val.filter(&quot;.popup&quot;).append( $('&lt;div class=&quot;head&quot; /&gt;').append(attributes.title)); } if( attributes.content) { ret_val.filter(&quot;.popup&quot;).append( $('&lt;div class=&quot;main&quot; /&gt;').append(attributes.content)); } if( attributes.width ) { ret_val.width( attributes.width ); reposition = true; } if( attributes.height ) { ret_val.height( attributes.height ); reposition = true; } var anchor = {x: -1, y: -1, w: 0, h: 0}; var align; if( attributes.position ) { if( attributes.position.offset ) { var offset = attributes.position.offset(); anchor.x = offset.left; anchor.y = offset.top; anchor.w = attributes.position.width(); anchor.h = attributes.position.height(); } else { if( attributes.position.hasOwnProperty('x') ) anchor.x = attributes.position.x; if( attributes.position.hasOwnProperty('y') ) anchor.y = attributes.position.y; if( attributes.position.hasOwnProperty('w') ) anchor.w = attributes.position.w; if( attributes.position.hasOwnProperty('h') ) anchor.h = attributes.position.h; if( anchor.w == 0 &amp;&amp; anchor.h == 0 ) align = 5; } } if( attributes.align !== undefined ) align = attributes.align; var placement = placementStrategy( anchor, { w:ret_val.outerWidth(), h:ret_val.outerHeight() }, { w:$(window).width() , h:$(window).height() }, align ); ret_val.css( 'left', placement.x ); ret_val.css( 'top' , placement.y ); ret_val.bind( 'close', this.close ); ret_val.bind( 'click', function() { // note: this will call two events - one for the popup itself and // one for the popup_background. ret_val.trigger( 'close' ); return false; }); $('.popup_close').bind( 'touchend', function() { // note: this will call two events - one for the popup itself and // one for the popup_background. ret_val.trigger( 'close' ); return false; }); ret_val.css( 'display', 'block' ); $('#centerContainer').addClass('inactiveMain'); return ret_val; }, /** * Description * @method close * @param {} event */ close: function( event ) { $('#centerContainer').removeClass('inactiveMain'); event.currentTarget.remove(); } }); this.addPopup('info' , $.extend(true, {}, this.getPopup('unknown')) ); this.addPopup('warning', $.extend(true, {}, this.getPopup('unknown')) ); this.addPopup('error' , $.extend(true, {}, this.getPopup('unknown')) ) ; /** * Description * @method defaultValueHandling * @param ga address * @param data the raw value from the bus * @param widgetData the data structure in the widget * @return value */ this.defaultValueHandling = function( ga, data, widgetData ) { var thisTransform = ''; var value = data; if( undefined !== ga ) { thisTransform = widgetData.address[ ga ][0]; // #1: transform the raw value to a JavaScript type value = templateEngine.transformDecode( thisTransform, data ); } widgetData.basicvalue = value; // store it to be able to supress sending of unchanged data // #2: map it to a value the user wants to see value = templateEngine.map( value, widgetData.mapping ); // #3: format it in a way the user understands the value if( widgetData.precision ) value = Number( value ).toPrecision( widgetData.precision ); if( widgetData.format ) { if( !('formatValueCache' in widgetData) ) widgetData.formatValueCache = [widgetData.format]; var argListPos = (widgetData.address &amp;&amp; widgetData.address[ga])? widgetData.address[ga][3] : 1; widgetData.formatValueCache[argListPos] = value; value = sprintf.apply(this, widgetData.formatValueCache); } widgetData.value = value; if (undefined !== value &amp;&amp; value.constructor == Date) { switch( thisTransform ) // special case for KNX { case 'DPT:10.001': value = value.toLocaleTimeString(); break; case 'DPT:11.001': value = value.toLocaleDateString(); break; case 'OH:datetime': value = value.toLocaleDateString(); break; case 'OH:time': value = value.toLocaleTimeString(); break; } } // #4 will happen outside: style the value to be pretty return value; }; /** * Method to handle all special cases for the value. The might come from * the mapping where it can be quite complex as it can contain icons. * value: the value that will be inserted * modifyFn: callback function that modifies the DOM * @method defaultValue2DOM * @param {} value * @param {} modifyFn */ this.defaultValue2DOM = function( value, modifyFn ) { if (('string' === typeof value) || ('number' === typeof value)) modifyFn( value ); else if ('function' === typeof value) // thisValue(valueElement); console.error( 'typeof value === function - special case not handled anymore!' ); else if( !Array.isArray( value ) ) { var element = value.cloneNode(); if( value.getContext ) { fillRecoloredIcon( element ); } modifyFn( element ); } else { for (var i = 0; i &lt; value.length; i++) { var thisValue = value[i]; if (!thisValue) continue; if( ('string' === typeof thisValue) || ('number' === typeof thisValue) ) modifyFn( thisValue ); else if( 'function' === typeof thisValue ) // thisValue(valueElement); console.error( 'typeof value === function - special case not handled anymore!' ); else { var element = thisValue.cloneNode(); if( thisValue.getContext ) { fillRecoloredIcon( element ); } modifyFn( element ); } } } } /** * ga: address * data: the raw value from the bus * passedElement: the element to update * @method defaultUpdate * @param {} ga * @param {} data * @param {} passedElement * @param {} newVersion * @param {} path * @return value */ this.defaultUpdate = function( ga, data, passedElement, newVersion, path ) { ///console.log(ga, data, passedElement, newVersion ); var element = passedElement || $(this); var elementData = templateEngine.widgetData[ path ]; var actor = newVersion ? element.find('.actor:has(&quot;.value&quot;)') : element; var value = self.defaultValueHandling( ga, data, elementData ); templateEngine.setWidgetStyling( actor, elementData.basicvalue, elementData.styling ); if (elementData['align']) element.addClass(elementData['align']); var valueElement = element.find('.value'); valueElement.empty(); if (undefined !== value) self.defaultValue2DOM( value, function(e){ valueElement.append( e ) } ); else valueElement.append('-'); return value; } /** * Description * @method defaultUpdate3d * @param {} ev * @param {} data * @param {} passedElement */ this.defaultUpdate3d = function( ev, data, passedElement ) { //var element = passedElement || $(this); var l = ev.data.layout; var pos = data.building2screen( new THREE.Vector3( l.x, l.y, l.z ) ); ev.data.element.css( 'left', pos.x + 'px' ); ev.data.element.css( 'top' , pos.y + 'px' ); var floorFilter = true; if( l.floorFilter) floorFilter = data.getState('showFloor') == data.buildingProperties.floorNames[ l.floorFilter ]; ev.data.element.css( 'display', floorFilter ? '' : 'none' ); } /** * Parse config file layout element and convert it to an object * @method parseLayout * @param {} layout * @param {} defaultValues * @return ret_val */ this.parseLayout = function( layout, defaultValues ) { var ret_val = {}; if( !layout ) return ret_val; if( undefined === defaultValues ) defaultValues = {}; if( layout.getAttribute('x' ) ) ret_val.x = layout.getAttribute('x' ); else if( defaultValues.x ) ret_val.x = defaultValues.x; if( layout.getAttribute('y' ) ) ret_val.y = layout.getAttribute('y' ); else if( defaultValues.y ) ret_val.y = defaultValues.y; if( layout.getAttribute('width' ) ) ret_val.width = layout.getAttribute('width' ); else if( defaultValues.width ) ret_val.width = defaultValues.width; if( layout.getAttribute('height') ) ret_val.height = layout.getAttribute('height'); else if( defaultValues.height ) ret_val.height = defaultValues.height; return ret_val; } /** * Description * @method extractLayout * @param {} layout * @param {} type * @return ret_val */ this.extractLayout = function( layout, type ) { var ret_val = (type == '2d') ? 'position:absolute;' : ''; if( layout.x ) ret_val += 'left:' + layout.x + ';'; if( layout.y ) ret_val += 'top:' + layout.y + ';'; if( layout.width ) ret_val += 'width:' + layout.width + ';'; if( layout.height ) ret_val += 'height:' + layout.height + ';'; return ret_val; } /** * Description * @method extractLayout3d * @param {} layout * @return ret_val */ this.extractLayout3d = function( layout ) { var ret_val = {}; if( layout.getAttribute('x' ) ) ret_val.x = layout.getAttribute('x' ); if( layout.getAttribute('y' ) ) ret_val.y = layout.getAttribute('y' ); if( layout.getAttribute('z' ) ) ret_val.z = layout.getAttribute('z' ); if( layout.getAttribute('floor') ) ret_val.floor = layout.getAttribute('floor'); if( layout.getAttribute('floorFilter') ) ret_val.floorFilter = layout.getAttribute('floorFilter'); if( layout.getAttribute('roomFilter') ) ret_val.roomFilter = layout.getAttribute('roomFilter' ); return ret_val; } /** * Description * @method extractLabel * @param {} label * @param {} flavour * @param {} labelClass * @param {} style * @return BinaryExpression */ this.extractLabel = function( label, flavour, labelClass, style ) { if( !label ) return ''; if( !labelClass ) var ret_val = '&lt;div class=&quot;' + (undefined===labelClass ? 'label' : labelClass) + '&quot;' + ( style ? (' style=&quot;' + style + '&quot;') : '' ) + '&gt;'; $( label ).contents().each( function(){ var $v = $(this); if( $v.is('icon') ) { ret_val += icons.getIconText($v.attr('name'), $v.attr('type'), $v.attr('flavour') || flavour, $v.attr('color'), $v.attr('styling') ); } else ret_val += this.textContent; }); return ret_val + '&lt;/div&gt;'; } /** * this function extracts all addresses with attributes (JNK) * elements. The first is a boolean that determins if * the visu should listen for that address. The second * is added as it is to the returned object. * @method makeAddressList * @param {} element * @param handleVariant is a callback function that returns an array of two * @param id id / path to the widget * @return address */ this.makeAddressList = function( element, handleVariant, id ) { var address = {}; element.find('address').each( function(){ var src = this.textContent, transform = this.getAttribute('transform'), formatPos = +(this.getAttribute('format-pos') || 1)|0, // force integer mode = 1|2; // Bit 0 = read, Bit 1 = write =&gt; 1|2 = 3 = readwrite if ((!src) || (!transform)) // fix broken address-entries in config return; switch( this.getAttribute('mode') ) { case 'disable': mode = 0; break; case 'read': mode = 1; break; case 'write': mode = 2; break; case 'readwrite': mode = 1|2; break; } var variantInfo = handleVariant ? handleVariant( src, transform, mode, this.getAttribute('variant') ) : [true, undefined]; if( (mode&amp;1) &amp;&amp; variantInfo[0]) // add only addresses when reading from them templateEngine.addAddress( src, id ); address[ src ] = [ transform, mode, variantInfo[1], formatPos ]; return; // end of each-func }); return address; }; /** * this function implements all widget layouts that are identical (JNK) * implemented: rowspan, colspan * @method setWidgetLayout * @param {} page * @param {} path * @return ret_val */ this.setWidgetLayout = function( page, path ) { var elementData = templateEngine.widgetDataGet( path ), layout = page.children('layout'), lookupM = [ 0, 2, 4, 6, 6, 6, 6, 12, 12, 12, 12, 12, 12 ], lookupS = [ 0, 3, 6, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12 ], ret_val = ''; elementData.colspan = layout.attr('colspan') || $('head').data('colspanDefault') || 6; elementData.colspanM = layout.attr('colspan-m') || lookupM[Math.floor(elementData.colspan)] || elementData.colspan; elementData.colspanS = layout.attr('colspan-s') || lookupS[Math.floor(elementData.colspan)] || elementData.colspan; if( layout.attr('rowspan') ) { elementData.rowspanClass = templateEngine.rowspanClass( layout.attr('rowspan') || 1 ); ret_val = 'innerrowspan'; } return ret_val; }; /** * Create a default widget to be filled by the creator afterwards. * Note: the reciever of the returned string must add an &lt;/div&gt; closing element! * @method createDefaultWidget * @param widgetType string of the widget type * @param $element jQuery object of the XML element * @param path string of the path ID * @param flavour * @param type * @param updateFn The callback function for updates * @param {} makeAddressListFn * @return ret_val */ this.createDefaultWidget = function( widgetType, $element, path, flavour, type, updateFn, makeAddressListFn ) { var layout = this.parseLayout( $element.children('layout')[0] ); var style = layout ? 'style=&quot;' + this.extractLayout( layout, type ) + '&quot;' : ''; var classes = 'widget clearfix ' + widgetType; if( $element.attr('align') ) { classes+=&quot; &quot;+$element.attr('align'); } classes += ' ' + this.setWidgetLayout( $element, path ); if( $element.attr('flavour') ) flavour = $element.attr('flavour');// sub design choice if( flavour ) classes += ' flavour_' + flavour; if($element.attr('class')) classes += ' custom_' + $element.attr('class'); var label = (widgetType==='text')?this.extractLabel( $element.find('label')[0], flavour, '' ):this.extractLabel( $element.find('label')[0], flavour ); var address = this.makeAddressList( $element, makeAddressListFn, path ); var bindClickToWidget = templateEngine.bindClickToWidget; if ($element.attr(&quot;bind_click_to_widget&quot;)) bindClickToWidget = $element.attr(&quot;bind_click_to_widget&quot;)==&quot;true&quot;; templateEngine.widgetDataInsert( path, { 'address' : address, 'bind_click_to_widget': bindClickToWidget, 'mapping' : $element.attr('mapping'), 'styling' : $element.attr('styling'), 'format' : $element.attr('format'), 'align' : $element.attr('align'), 'layout' : layout, 'path' : path, 'updateFn': updateFn }); var ret_val = '&lt;div class=&quot;'+classes+'&quot; ' + style + '&gt;' + label; this.constructDefaultObject(path); return ret_val; }; this.constructDefaultObject = function(path) { var data = templateEngine.widgetDataGet(path); if (data.address &amp;&amp; data.updateFn) { templateEngine.messageBroker.subscribeOnce(&quot;setup.dom.finished&quot;, function() { // initially setting a value data.updateFn.bind( $(&quot;#&quot;+path), undefined, undefined ); }, this); } }; /** * Create an action handling that shows a button press animation. * Note: use this function when multiple action elements are used and thus * bind_click_to_widget is not available. * @method defaultButtonDownAnimation * @param {} path * @param {} actor */ this.defaultButtonDownAnimation = function( path, actor ) { if( actor ) { actor.classList.remove('switchUnpressed'); actor.classList.add('switchPressed'); } }; /** * Create an action handling that shows a button press animation. * When the action is not set, it will be searched for - so that widgets * with bind_click_to_widget will also work. * @method defaultButtonDownAnimationInheritAction * @param {} path * @param {} actor */ this.defaultButtonDownAnimationInheritAction = function( path, actor ) { if( !actor ) actor = templateEngine.handleMouseEvent.widget.getElementsByClassName('actor')[0]; actor.classList.remove('switchUnpressed'); actor.classList.add('switchPressed'); }; /** * Create an action handling that shows a button unpress animation. * Note: use this function when multiple action elements are used and thus * bind_click_to_widget is not available. * @method defaultButtonUpAnimation * @param {} path * @param {} actor */ this.defaultButtonUpAnimation = function( path, actor ) { if( actor ) { actor.classList.remove('switchPressed'); actor.classList.add('switchUnpressed'); } }; /** * Create an action handling that shows a button unpress animation. * When the action is not set, it will be searched for - so that widgets * with bind_click_to_widget will also work. * @method defaultButtonUpAnimationInheritAction * @param {} path * @param {} actor */ this.defaultButtonUpAnimationInheritAction = function( path, actor ) { if( !actor ) actor = templateEngine.handleMouseEvent.widget.getElementsByClassName('actor')[0]; actor.classList.remove('switchPressed'); actor.classList.add('switchUnpressed'); }; }; /** * Figure out best placement of popup. * A preference can optionally be passed. The position is that of the numbers * on the numeric keypad. I.e. a value of &quot;6&quot; means centered above the anchor. * A value of &quot;0&quot; means centered to the page * @method placementStrategy * @param {} anchor * @param {} popup * @param {} page * @param {} preference * @return ObjectExpression */ function placementStrategy( anchor, popup, page, preference ) { var position_order = [ 8, 2, 6, 4, 9, 3, 7, 1, 5, 0 ]; if( preference !== undefined ) position_order.unshift( preference ); for( var pos in position_order ) { var xy = {}; switch(position_order[pos]) { case 0: // page center - will allways work return { x: (page.w-popup.w)/2, y: (page.h-popup.h)/2 }; case 1: xy.x = anchor.x - popup.w; xy.y = anchor.y + anchor.h; break; case 2: xy.x = anchor.x + anchor.w/2 - popup.w/2; xy.y = anchor.y + anchor.h; break; case 3: xy.x = anchor.x + anchor.w; xy.y = anchor.y + anchor.h; break; case 4: xy.x = anchor.x - popup.w; xy.y = anchor.y + anchor.h/2 - popup.h/2; break; case 5: xy.x = anchor.x + anchor.w/2 - popup.w/2; xy.y = anchor.y + anchor.h/2 - popup.h/2; break; case 6: xy.x = anchor.x + anchor.w; xy.y = anchor.y + anchor.h/2 - popup.h/2; break; case 7: xy.x = anchor.x - popup.w; xy.y = anchor.y - popup.h; break; case 8: xy.x = anchor.x + anchor.w/2 - popup.w/2; xy.y = anchor.y - popup.h; break; case 9: xy.x = anchor.x + anchor.w; xy.y = anchor.y - popup.h; break; } // test if that solution is valid if( xy.x &gt;= 0 &amp;&amp; xy.y &gt;= 0 &amp;&amp; xy.x+popup.w&lt;=page.w &amp;&amp; xy.y+popup.h&lt;=page.h ) return xy; } return { x: 0, y: 0 }; // sanity return } var basicdesign = new VisuDesign(); return { basicdesign: basicdesign, Maturity: Maturity, placementStrategy: placementStrategy } }); // end define Ã— Search results Close "},"structure_pure_Audio.js.html":{"id":"structure_pure_Audio.js.html","title":"Source: structure/pure/Audio.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Audio.js /* Audio.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * The audio widget embeds an audio file, which can be automatically played by incoming data * @widget_example &lt;settings&gt; * &lt;screenshot name=&quot;audio_example&quot;&gt; * &lt;caption&gt;Default example for defining an audio widget in the configuration&lt;/caption&gt; * &lt;data address=&quot;0/0/0&quot;&gt;1&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;audio id=&quot;audio_widget&quot; src=&quot;path/to/audio_file.mp3&quot;&gt; * &lt;layout colspan=&quot;4&quot; /&gt; * &lt;label&gt;Audio&lt;/label&gt; * &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;read&quot;&gt;0/0/0&lt;/address&gt; * &lt;/audio&gt; * * @module structure/pure/Audio * @requires structure/pure * @author Markus Damman * @since 0.8.4 (2014) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('audio', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'audio', $e, path, flavour, type, this.update); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { 'src' : $e.attr('src'), 'id' : $e.attr('id'), 'width' : $e.attr('width'), 'height' : $e.attr('height'), 'autoplay': $e.attr('autoplay') === &quot;autoplay&quot; || $e.attr('autoplay') === &quot;true&quot;, 'loop' : $e.attr('loop') === &quot;loop&quot; || $e.attr('loop') === &quot;true&quot;, 'threshold_value' : $e.attr('threshold_value' ) || 1 } ); // create the actor var style = ''; if( data.width ) style += 'width:' + data.width + ';'; if( data.height ) style += 'height:' + data.height + ';'; if( style != '' ) style = 'style=&quot;' + style + '&quot;'; var autoplay = (data.autoplay) ? ' autoplay ' : ''; var loop = (data.loop) ? ' loop ' : ''; var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;audio id=&quot;' + $e.attr('id') + '&quot; ' + autoplay + loop + style + ' controls&gt; &lt;source src=&quot;' +$e.attr('src') + '&quot; &gt; &lt;/audio&gt; &lt;/div&gt;'; return ret_val + actor + '&lt;/div&gt;'; }, /** * Handles updates of incoming data for this widget * @method update * @param {String} address - Source address of the incoming data * @param {String} value - Incoming data */ update: function(address, value) { var element = $(this); var actor = element.find('.actor'); var value = basicdesign.defaultUpdate( address, value, element, true, element.parent().attr('id') ); var data = templateEngine.widgetDataGetByElement( element ); var on = templateEngine.map( data[ 'threshold_value' ], data['mapping'] ); if (value &gt;= on) { var audioWidget = document.getElementById(data['id']); if (audioWidget.paused == true) audioWidget.play(); } } }); }); // end define Ã— Search results Close "},"structure_pure_Break.js.html":{"id":"structure_pure_Break.js.html","title":"Source: structure/pure/Break.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Break.js /* Break.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * A break tag is used to start in new line for a grouped and thereby tidy display of * elements on one page. * * @example &lt;caption&gt;The break tag has no content&lt;/caption&gt; * &lt;break/&gt; * * @module structure/pure/Break * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('break', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var data = templateEngine.widgetDataInsert( path, { path: path }); return '&lt;br /&gt;'; } }); }); // end define Ã— Search results Close "},"structure_pure_DesignToggle.js.html":{"id":"structure_pure_DesignToggle.js.html","title":"Source: structure/pure/DesignToggle.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/DesignToggle.js /* DesignToggle.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Adds a button to toggle through the available designs * @widget_example * &lt;designtoggle&gt; * &lt;layout colspan=&quot;6&quot;/&gt; * &lt;label&gt;Change Design&lt;/label&gt; * &lt;/designtoggle&gt; * * @module structure/pure/DesignToggle * @requires structure/pure * @author Christian Mayer * @since 0.5.3 (2010) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('designtoggle', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'toggle', $e, path, flavour, type ); // create the actor var actor = '&lt;div class=&quot;actor switchUnpressed&quot;&gt;&lt;div class=&quot;value&quot;&gt;' + templateEngine.configSettings.clientDesign + '&lt;/div&gt;&lt;/div&gt;'; this.construct(path); return ret_val + actor + '&lt;/div&gt;'; }, construct: function(path) { var data = templateEngine.widgetDataGet( path ); $.getJSON(&quot;./designs/get_designs.php&quot;,function(d) { data['availableDesigns'] = d; }); }, downaction: basicdesign.defaultButtonDownAnimationInheritAction, /** * Action performed when the widget got clicked * * @method action * @param {String} path - Internal path of the widget * @param {Element} actor - DOMElement * @param {Boolean} isCanceled - If true the action does nothing */ action: function( path, actor, isCanceled ) { basicdesign.defaultButtonUpAnimationInheritAction( path, actor ); if( isCanceled ) return; var data = templateEngine.widgetDataGet( path ); var $this = $(this); var designs = data.availableDesigns; var oldDesign = $('.value',$this).text(); var newDesign = designs[ (designs.indexOf(oldDesign) + 1) % designs.length ]; var creator = design.basicdesign.getCreator(&quot;designtoggle&quot;); var URL = creator.getLocation(); var regexp = new RegExp(&quot;design=&quot;+oldDesign); if (URL.search(regexp) != -1) { // has URL-parameter design creator.setLocation(URL.replace(regexp, &quot;design=&quot;+newDesign)); } else { if (URL.indexOf(&quot;?&quot;) != -1) { // has other parameters, append design creator.setLocation(URL+&quot;&amp;design=&quot;+newDesign); } else { // has now parameters creator.setLocation(URL+&quot;?design=&quot;+newDesign); } } }, /** * Wrapper for getting the `window.location.href` value * * @method getLocation * @return {String} URI of the page the browser is currently showing */ getLocation : function() { return window.location.href; }, /** * Changes `window.location.href` to trigger a redirect * * @method setLocation * @param {String} loc - URI of the location the browser should be redirected to */ setLocation : function(loc) { window.location.href = loc; } }); }); // end define Ã— Search results Close "},"structure_pure_Group.js.html":{"id":"structure_pure_Group.js.html","title":"Source: structure/pure/Group.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Group.js /* Group.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * A group can be used to group a couple of widgets and optionally surround them with a border or name the group. * * @widget_example &lt;settings selector=&quot;.widget_container[data-type=group]&quot;&gt; * &lt;screenshot name=&quot;group_with_border&quot;&gt; * &lt;caption&gt;Group with border and name&lt;/caption&gt; * &lt;data address=&quot;0/0/0&quot;&gt;1&lt;/data&gt; * &lt;data address=&quot;0/0/1&quot;&gt;21&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;group name=&quot;Example Group&quot;&gt; * &lt;layout colspan=&quot;6&quot; /&gt; * &lt;text&gt;&lt;label&gt;Some Text&lt;/label&gt;&lt;/text&gt; * &lt;switch&gt; * &lt;layout colspan=&quot;3&quot; /&gt; * &lt;label&gt;Switch&lt;/label&gt; * &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; * &lt;/switch&gt; * &lt;info format=&quot;%.1f Â°C&quot;&gt; * &lt;layout colspan=&quot;3&quot; /&gt; * &lt;label&gt;Temperature&lt;/label&gt; * &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/1&lt;/address&gt; * &lt;/info&gt; * &lt;/group&gt; * * @widget_example &lt;settings selector=&quot;.widget_container[data-type=group]&quot;&gt; * &lt;screenshot name=&quot;group_without_border&quot;&gt; * &lt;caption&gt;Hidden Group: no border no name&lt;/caption&gt; * &lt;data address=&quot;0/0/0&quot;&gt;1&lt;/data&gt; * &lt;data address=&quot;0/0/1&quot;&gt;21&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;group nowidget=&quot;true&quot;&gt; * &lt;layout colspan=&quot;6&quot; /&gt; * &lt;text&gt;&lt;label&gt;Some Text&lt;/label&gt;&lt;/text&gt; * &lt;switch&gt; * &lt;layout colspan=&quot;3&quot; /&gt; * &lt;label&gt;Switch&lt;/label&gt; * &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; * &lt;/switch&gt; * &lt;info format=&quot;%.1f Â°C&quot;&gt; * &lt;layout colspan=&quot;3&quot; /&gt; * &lt;label&gt;Temperature&lt;/label&gt; * &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/1&lt;/address&gt; * &lt;/info&gt; * &lt;/group&gt; * * @module structure/pure/Group * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('group', { maturity: design.Maturity.development, /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var $e = $(element); var classes = 'clearfix group ' + basicdesign.setWidgetLayout( $e, path ); if ( $e.attr('class') ) { classes += ' custom_' + $e.attr( 'class' ); } if ($e.attr('nowidget')!=='true') classes = 'widget ' + classes; if( $e.attr('flavour') ) flavour = $e.attr('flavour');// sub design choice if( flavour ) classes += ' flavour_' + flavour; var hstyle = ''; // heading style if( $e.attr('align') ) hstyle += 'text-align:' + $e.attr('align') + ';'; if( hstyle != '' ) hstyle = 'style=&quot;' + hstyle + '&quot;'; var childs = $e.children().not('layout'); var container = '&lt;div class=&quot;clearfix&quot;&gt;'; if( $e.attr('name') ) container += '&lt;h2 ' + hstyle + '&gt;' + $e.attr('name') + '&lt;/h2&gt;'; $( childs ).each( function(i){ container += templateEngine.create_pages( childs[i], path + '_' + i, flavour ); } ); container += '&lt;/div&gt;'; if ( $e.attr('target') ) { var target = $e.attr('target') ; classes += ' clickable'; templateEngine.widgetDataInsert( path, { 'bind_click_to_widget': true, // for groups with pagejumps this is mandatory 'target' : target } ); } return '&lt;div class=&quot;' + classes + '&quot;&gt;' + container + '&lt;/div&gt;'; }, /** * Action performed when the group got clicked. If a target is specified in the group attributes * the action will switch to the page defined by the target. * * @method action * @param {String} path - Internal path of the widget * @param {Element} actor - DOMElement * @param {Boolean} isCanceled - If true the action does nothing */ action: function( path, actor, isCanceled ) { if( isCanceled ) { return; } var data = templateEngine.widgetDataGet( path ); if (data.target != 0) { templateEngine.scrollToPage( data.target ); } } }); }); // end define Ã— Search results Close "},"structure_pure_Image.js.html":{"id":"structure_pure_Image.js.html","title":"Source: structure/pure/Image.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Image.js /* Image.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Adds an image to your visualization. Using the auto-refresh setting this widget can be used e.g. to show * a camera picture. * * @widget_example * &lt;image src=&quot;icon/CometVisu_orange.png&quot; width=&quot;45px&quot; height=&quot;32px&quot;&gt; * &lt;layout colspan=&quot;2&quot; /&gt; * &lt;/image&gt; * * @module structure/pure/Image * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('image', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function(element, path, flavour, type) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget('image', $e, path, flavour, type); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { 'width' : $e.attr('width'), 'height' : $e.attr('height'), 'src' : $e.attr('src'), 'refresh': $e.attr('refresh') ? $e.attr('refresh') * 1000 : 0 }); // create the actor var imgStyle = ''; if (data.width) { imgStyle += 'width:' + data.width + ';'; } if( $e.attr('widthfit') === 'true' ) { imgStyle += 'max-width:100%;'; } if (data.height) { imgStyle += 'height:' + data.height + ';'; } var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;img src=&quot;' + data.src + '&quot; style=&quot;' + imgStyle + '&quot; /&gt;&lt;/div&gt;'; this.construct(path); return ret_val + actor + '&lt;/div&gt;'; }, construct : function(path) { var data = templateEngine.widgetDataGet(path); if (data.refresh) { templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { templateEngine.setupRefreshAction( path, data.refresh ); }); } } }); }); // end define Ã— Search results Close "},"structure_pure_ImageTrigger.js.html":{"id":"structure_pure_ImageTrigger.js.html","title":"Source: structure/pure/ImageTrigger.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/ImageTrigger.js /* ImageTrigger.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Adds an image like the {@link structure/pure/Image} widget, but additionally the image can be changed by incoming * data and can send data to the backend by clicking on it. * There modes to react on incoming data: * * * type=&quot;show&quot;: Hides the image when incoming data == 0 * * type=&quot;select&quot;: Changes the image by appending the incoming data to the initial configured image source, * or hide it when incoming data == 0 * * Example: * ``` * &lt;imagetrigger src=&quot;icon/comet&quot; suffix=&quot;svg&quot; sendValue=&quot;clicked&quot; type=&quot;select&quot;&gt; * &lt;address transform=&quot;DPT:16.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; * &lt;/imagetrigger&gt; * ``` * initially shows nothing. When the CometVisu receives the string '_icon' in address `0/0/0`, * the image `icon/comet_opt_icon.svg` is shown. When the CometVisu receives '0' on address `0/0/0`, * this image is hidden. * * @widget_example &lt;settings&gt; * &lt;screenshot name=&quot;image_trigger&quot;&gt; * &lt;caption&gt;Image changed by incoming data 'blue'&lt;/caption&gt; * &lt;data address=&quot;0/0/0&quot;&gt;blue&lt;/data&gt; * &lt;/screenshot&gt; * &lt;screenshot name=&quot;image_trigger_changes&quot;&gt; * &lt;caption&gt;Image changed by incoming data 'grey'&lt;/caption&gt; * &lt;data address=&quot;0/0/0&quot;&gt;grey&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;imagetrigger src=&quot;icon/CometVisu_&quot; suffix=&quot;png&quot; sendValue=&quot;clicked&quot; type=&quot;select&quot; width=&quot;45px&quot; height=&quot;32px&quot;&gt; * &lt;layout colspan=&quot;1&quot; /&gt; * &lt;address transform=&quot;DPT:16.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; * &lt;/imagetrigger&gt; * * @widget_example &lt;settings&gt; * &lt;caption&gt;Disable layout width by settings it to '0', to have widget with == image width&lt;/caption&gt; * &lt;screenshot name=&quot;image_trigger_colspan0&quot;&gt; * &lt;data address=&quot;0/0/0&quot;&gt;1&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;imagetrigger src=&quot;icon/CometVisu_orange&quot; suffix=&quot;png&quot; sendValue=&quot;clicked&quot; type=&quot;show&quot; width=&quot;45px&quot; height=&quot;32px&quot;&gt; * &lt;layout colspan=&quot;0&quot; /&gt; * &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; * &lt;/imagetrigger&gt; * * @module structure/pure/ImageTrigger * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('imagetrigger', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var $e = $(element), classes = basicdesign.setWidgetLayout( $e, path ); classes += ' imagetrigger'; if( $e.attr('flavour') ) flavour = $e.attr('flavour');// sub design choice if( flavour ) classes += ' flavour_' + flavour; var ret_val = '&lt;div class=&quot;widget clearfix image '+classes+'&quot;&gt;'; ret_val += basicdesign.extractLabel( $e.find('label')[0], flavour ); var address = basicdesign.makeAddressList($e, null, path); var width = $e.attr('width') || &quot;100%&quot;; var layout = basicdesign.parseLayout( $e.children('layout')[0], {width:width} ); var style = &quot;&quot;; if (!$.isEmptyObject(layout)) { style += basicdesign.extractLayout(layout, type); } if ($e.attr('height')) { style += 'height:' + $e.attr('height') + ';'; } if (style.length &gt; 0) { style = 'style=&quot;'+style+'&quot;'; } var actor = '&lt;div class=&quot;actor&quot;&gt;'; if ( $e.attr('type')=='show' ) actor += '&lt;img src=&quot;' + $e.attr('src') + '.' + $e.attr('suffix') + '&quot; ' + style + ' /&gt;'; else actor += '&lt;img src=&quot;&quot; ' + style + ' /&gt;'; actor += '&lt;/div&gt;'; actor += '&lt;/div&gt;'; var refresh = $e.attr('refresh') ? $e.attr('refresh')*1000 : 0; templateEngine.widgetDataInsert( path, { 'path' : path, 'address': address, 'refresh': refresh, 'layout' : layout, 'width' : $e.attr('width'), 'height' : $e.attr('height'), 'src': $e.attr('src'), 'suffix': $e.attr('suffix'), 'sendValue': $e.attr('sendValue') || &quot;&quot;, 'update_type': $e.attr('type') } ); this.construct(path); return ret_val + actor + '&lt;/div&gt;'; }, construct : function(path) { var data = templateEngine.widgetDataGet(path); if (data.refresh) { templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { templateEngine.setupRefreshAction( path, data.refresh ); }); } }, /** * Handles updates of incoming data for this widget * @method update * @param {String} address - Source address of the incoming data * @param {String} value - Incoming data */ update: function( address, value ) { var element = $(this), data = templateEngine.widgetDataGetByElement( element ), val = templateEngine.transformDecode(data.address[ address ][0], value); var imageChildren = element.find(&quot;img&quot;); if (data.update_type == &quot;show&quot;) { if (val == 0) { imageChildren.hide(); } else { imageChildren.attr(&quot;src&quot;, data.src + '.' + data.suffix).show(); } } else if (data.update_type == &quot;select&quot;) { if (val == 0) { imageChildren.hide(); } else { imageChildren.attr(&quot;src&quot;, data.src + val + '.' + data.suffix).show(); } } //TODO: add value if mapping exists //TODO: get image name from mapping //TODO: add bitmask for multiple images //TODO: add SVG-magics }, /** * Action performed when the image got clicked * * @method action * @param {String} path - Internal path of the widget * @param {Element} actor - DOMElement * @param {Boolean} isCanceled - If true the action does nothing */ action: function( path, actor, isCanceled ) { if( isCanceled ) return; var data = templateEngine.widgetDataGet( path ); for( var addr in data.address ) { if( !(data.address[addr][1] &amp; 2) ) continue; // skip when write flag not set if( data.sendValue == &quot;&quot; ) continue; // skip empty templateEngine.visu.write( addr, templateEngine.transformEncode( data.address[addr][0], data.sendValue ) ); } } }); }); // end define Ã— Search results Close "},"structure_pure_Include.js.html":{"id":"structure_pure_Include.js.html","title":"Source: structure/pure/Include.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Include.js /* Include.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Includes other configuration snippets. Note that this is no widget shown in your visualization it just gives * you the opportunity to split you configuration into multiple files. If you have a large configuration file * splitting it up might help to keep track of your configuration. * * @module structure/pure/Include * @requires structure/pure/ * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('include', { maturity: design.Maturity.development, /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( page, path, flavour, type ) { // FIXME: the file gets requested twice, check which one can be removed var p = $.get( $(page).attr('src') ); var p = $.ajax({ url: $(page).attr('src'), dataType: 'xml', async: false }); var child = (p.responseXML.childNodes[0]); return templateEngine.create_pages( child, path , flavour ); } }); }); // end define Ã— Search results Close "},"structure_pure_Info.js.html":{"id":"structure_pure_Info.js.html","title":"Source: structure/pure/Info.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Info.js /* Info.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * * @widget_example &lt;settings&gt; * &lt;caption&gt;Show temperature in degree celcius&lt;/caption&gt; * &lt;screenshot name=&quot;info_temp&quot;&gt; * &lt;data address=&quot;0/0/0&quot;&gt;19&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;info format=&quot;%.1f Â°C&quot;&gt; * &lt;label&gt;outside temperature&lt;/label&gt; * &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/0&lt;/address&gt; * &lt;/info&gt; * * @module structure/pure/Info * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('info', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'info', $e, path, flavour, type, this.update ); // create the actor var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;div class=&quot;value&quot;&gt;-&lt;/div&gt;&lt;/div&gt;'; ret_val += actor; return ret_val + '&lt;/div&gt;'; }, /** * Handles updates of incoming data for this widget * @method update * @param {String} address - Source address of the incoming data * @param {String} value - Incoming data */ update: function( address, value ) { var element = $(this); basicdesign.defaultUpdate( address, value, element, true, element.parent().attr('id') ); }, update3d: design.basicdesign.defaultUpdate3d }); }); // end define Ã— Search results Close "},"structure_pure_InfoAction.js.html":{"id":"structure_pure_InfoAction.js.html","title":"Source: structure/pure/InfoAction.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/InfoAction.js /* InfoAction.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * The infoaction widget is a combination of an info/text widget and an &quot;action&quot;-widget, e.g. switch or trigger. * * Use case: if you have a group of lights, you can show the number of lights currently switched on * and control the whole group in one widget. * * @widget_example &lt;settings&gt; * &lt;caption&gt;Example combines an info widget to show the number of lights currently switched on, and an Switch to control them&lt;/caption&gt; * &lt;screenshot name=&quot;infoaction_lights&quot;&gt; * &lt;data address=&quot;0/0/0&quot;&gt;4&lt;/data&gt; * &lt;data address=&quot;0/0/1&quot;&gt;1&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;meta&gt; * &lt;mappings&gt; * &lt;mapping name=&quot;OnOff&quot;&gt; * &lt;entry value=&quot;0&quot;&gt;Off&lt;/entry&gt; * &lt;entry value=&quot;1&quot;&gt;On&lt;/entry&gt; * &lt;/mapping&gt; * &lt;/mappings&gt; * &lt;stylings&gt; * &lt;styling name=&quot;GreyGreen&quot;&gt; * &lt;entry value=&quot;0&quot;&gt;grey&lt;/entry&gt; * &lt;entry value=&quot;1&quot;&gt;green&lt;/entry&gt; * &lt;/styling&gt; * &lt;/stylings&gt; * &lt;/meta&gt; * &lt;infoaction&gt; * &lt;layout colspan=&quot;4&quot;/&gt; * &lt;label&gt;Lights&lt;/label&gt; * &lt;widgetinfo&gt; * &lt;info&gt; * &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/0&lt;/address&gt; * &lt;/info&gt; * &lt;/widgetinfo&gt; * &lt;widgetaction&gt; * &lt;switch mapping=&quot;OnOff&quot; styling=&quot;GreyGreen&quot;&gt; * &lt;layout colspan=&quot;3&quot; /&gt; * &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/1&lt;/address&gt; * &lt;/switch&gt; * &lt;/widgetaction&gt; * &lt;/infoaction&gt; * * @module structure/pure/InfoAction * @requires structure/pure * @author Tobias BrÃ¤utigam * @since 0.10.0 (as widget), 0.9.2 (as plugin) */ define( ['_common' ], function( design ) { &quot;use strict&quot;; design.basicdesign.addCreator(&quot;infoaction&quot;, { /** * Creates the InfoAction widget * * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return String - HTML representation if the widget as string */ create: function(element, path, flavour, type) { return createWidget(false, element, path, flavour, type); } }); /** * Creates the InfoAction widget * * @method createWidget * @param {} isInfo * @param {} element * @param {} path * @param {} flavour * @param {} type * @return String - HTML representation if the widget as string */ function createWidget(isInfo, element, path, flavour, type) { var $e = $(element); // create the main structure var ret_val = templateEngine.design.createDefaultWidget('infoaction', $e, path, flavour, type); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { content : getWidgetElements($e, path) } ); ret_val += data.content; return ret_val + '&lt;/div&gt;'; } /** * Description * @method getWidgetElements * @param {} xmlElement * @param {} path * @param {} flavour * @param {} type * @return ret_val */ function getWidgetElements(xmlElement, path, flavour, type) { var infoWidget = $('widgetinfo &gt; *', xmlElement).first()[0]; var actionWidget = $('widgetaction &gt; *', xmlElement).first()[0]; var data = templateEngine.widgetDataInsert( path+&quot;_0&quot;, { containerClass : &quot;widgetinfo&quot; } ); data = templateEngine.widgetDataInsert( path+&quot;_1&quot;, { containerClass : &quot;widgetaction&quot; } ); var ret_val = templateEngine.create_pages(infoWidget, path+&quot;_0&quot;, flavour, infoWidget.nodeName); ret_val += templateEngine.create_pages(actionWidget, path+&quot;_1&quot;, flavour, actionWidget.nodeName); return ret_val; } }); Ã— Search results Close "},"structure_pure_InfoTrigger.js.html":{"id":"structure_pure_InfoTrigger.js.html","title":"Source: structure/pure/InfoTrigger.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/InfoTrigger.js /* InfoTrigger.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * @module structure/pure/InfoTrigger * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('infotrigger', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure /** * Description * @method makeAddressListFn * @param {} src * @param {} transform * @param {} mode * @param {} variant * @return ArrayExpression */ var makeAddressListFn = function( src, transform, mode, variant ) { // Bit 0 = short, Bit 1 = button =&gt; 1|2 = 3 = short + button return [ true, variant == 'short' ? 1 : (variant == 'button' ? 2 : 1|2) ]; } var ret_val = basicdesign.createDefaultWidget( 'infotrigger', $e, path, flavour, type, this.update, makeAddressListFn ); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { 'downvalue' : $e.attr('downvalue' ) || 0, 'shortdownvalue': $e.attr('shortdownvalue') || 0, 'downlabel' : $e.attr('downlabel') , 'upvalue' : $e.attr('upvalue' ) || 0, 'shortupvalue' : $e.attr('shortupvalue') || 0, 'uplabel' : $e.attr('uplabel') , 'shorttime' : parseFloat($e.attr('shorttime')) || -1, 'isAbsolute' : ($e.attr('change') || 'relative') == 'absolute', 'min' : parseFloat($e.attr('min')) || 0, 'max' : parseFloat($e.attr('max')) || 255, 'align' : $e.attr('align') } ); // create buttons + info ret_val += '&lt;div style=&quot;float:left;&quot;&gt;'; var actordown = '&lt;div class=&quot;actor switchUnpressed downlabel&quot; '; if ( data.align ) actordown += 'style=&quot;text-align: ' + data.align + '&quot; '; actordown += '&gt;'; actordown += '&lt;div class=&quot;label&quot;&gt;' + (data.downlabel || '-') + '&lt;/div&gt;'; actordown += '&lt;/div&gt;'; var actorup = '&lt;div class=&quot;actor switchUnpressed uplabel&quot; '; if ( data.align ) actorup += 'style=&quot;text-align: ' + data.align + '&quot; '; actorup += '&gt;'; actorup += '&lt;div class=&quot;label&quot;&gt;' + (data.uplabel || '+') + '&lt;/div&gt;'; actorup += '&lt;/div&gt;'; var actorinfo = '&lt;div class=&quot;actor switchInvisible&quot; '; if ( data.align ) actorinfo += 'style=&quot;text-align: ' + data.align + '&quot; '; actorinfo += '&gt;&lt;div class=&quot;value&quot;&gt;-&lt;/div&gt;&lt;/div&gt;'; switch ($e.attr('infoposition')) { case 'middle': ret_val += actordown; ret_val += actorinfo; ret_val += actorup; break; case 'right': ret_val += actordown; ret_val += actorup; ret_val += actorinfo; break; default: ret_val += actorinfo; ret_val += actordown; ret_val += actorup; break; } return ret_val+ '&lt;/div&gt;&lt;/div&gt;'; }, /** * Description * @method update * @param {} ga * @param {} d */ update: function( ga, d ) { var element = $(this); var value = basicdesign.defaultUpdate( ga, d, element, true, element.parent().attr('id') ); }, downaction: basicdesign.defaultButtonDownAnimation, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { basicdesign.defaultButtonUpAnimation( path, actor ); if( isCanceled ) return; var isDown = actor.classList.contains('downlabel'), data = templateEngine.widgetDataGet( path ), buttonDataValue = data[ isDown ? 'downvalue' : 'upvalue' ], buttonDataShortvalue = data[ isDown ? 'shortdownvalue' : 'shortupvalue' ], isShort = Date.now() - templateEngine.handleMouseEvent.downtime &lt; data.shorttime, value = isShort ? buttonDataShortvalue : buttonDataValue, bitMask = (isShort ? 1 : 2); if( data.isAbsolute ) { value = parseFloat(data.basicvalue); if( isNaN( value ) ) value = 0; // anything is better than NaN... value = value + parseFloat(isShort ? buttonDataShortvalue : buttonDataValue); if (value &lt; data.min ) value = data.min; if( value &gt; data.max ) value = data.max; } for( var addr in data.address ) { if( !(data.address[addr][1] &amp; 2) ) continue; // skip when write flag not set if (data.address[addr][2] &amp; bitMask) { templateEngine.visu.write( addr, templateEngine.transformEncode( data.address[addr][0], value ) ); } } } }); }); // end define Ã— Search results Close "},"structure_pure_Line.js.html":{"id":"structure_pure_Line.js.html","title":"Source: structure/pure/Line.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Line.js /* Line.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * A line tag is used to display a horizontal line in the browser to allow for a grouped and thereby tidy display of * elements on one page. To specify the width of the line an optional &amp;lt;layout/&amp;gt;-child can be added. * * @widget_example &lt;settings selector=&quot;hr&quot;&gt; * &lt;caption&gt;A line tag which uses 50% of the screen size (6 of 12 available columns)&lt;/caption&gt; * &lt;/settings&gt; * &lt;line&gt;&lt;layout colspan=&quot;6&quot;/&gt;&lt;/line&gt; * * @module structure/pure/Line * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('line', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var $e = $(element), classes = basicdesign.setWidgetLayout( $e, path ), ret_val = '&lt;hr ' + (classes ? 'class=&quot;'+classes+'&quot;' : '') + '/&gt;'; templateEngine.widgetDataInsert( path, { path: path }); return ret_val; } }); }); // end define Ã— Search results Close "},"structure_pure_MultiTrigger.js.html":{"id":"structure_pure_MultiTrigger.js.html","title":"Source: structure/pure/MultiTrigger.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/MultiTrigger.js /* MultiTrigger.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * @module structure/pure/Multitrigger * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('multitrigger', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var showstatus = $e.attr('showstatus') === 'true', ret_val = basicdesign.createDefaultWidget( 'multitrigger', $e, path, flavour, type, showstatus ? this.update : undefined ); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { showstatus : showstatus, button1label: $e.attr('button1label'), button1value: $e.attr('button1value'), button2label: $e.attr('button2label'), button2value: $e.attr('button2value'), button3label: $e.attr('button3label'), button3value: $e.attr('button3value'), button4label: $e.attr('button4label'), button4value: $e.attr('button4value') } ); // create the actor ret_val += '&lt;div class=&quot;actor_container&quot; style=&quot;float:left&quot;&gt;'; if( data.button1label ) { ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;'; ret_val += '&lt;div class=&quot;value&quot;&gt;' + data.button1label + '&lt;/div&gt;'; ret_val += '&lt;/div&gt;'; } if( data.button2label ) { ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;'; ret_val += '&lt;div class=&quot;value&quot;&gt;' + data.button2label + '&lt;/div&gt;'; ret_val += '&lt;/div&gt;'; ret_val += '&lt;br/&gt;'; } if( data.button3label ) { ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;'; ret_val += '&lt;div class=&quot;value&quot;&gt;' + data.button3label + '&lt;/div&gt;'; ret_val += '&lt;/div&gt;'; } if( data.button4label ) { ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;'; ret_val += '&lt;div class=&quot;value&quot;&gt;' + data.button4label + '&lt;/div&gt;'; ret_val += '&lt;/div&gt;'; ret_val += '&lt;br/&gt;'; } this.construct(path); return ret_val + '&lt;/div&gt;&lt;/div&gt;'; }, construct: function(path) { var data = templateEngine.widgetDataGet(path); // replace button labels by mapped values if( undefined !== data.mapping ) { templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function(){ var $actor = $( '#' + path + ' .actor .value' ), v0 = basicdesign.defaultValueHandling( undefined, data.button1value, data ), $v0 = $actor.filter(':eq(0)'), v1 = basicdesign.defaultValueHandling( undefined, data.button2value, data ), $v1 = $actor.filter(':eq(1)'), v2 = basicdesign.defaultValueHandling( undefined, data.button3value, data ), $v2 = $actor.filter(':eq(2)'), v3 = basicdesign.defaultValueHandling( undefined, data.button4value, data ), $v3 = $actor.filter(':eq(3)'); $v0.empty(); basicdesign.defaultValue2DOM( v0, function(e){ $v0.append( e ) } ); $v1.empty(); basicdesign.defaultValue2DOM( v1, function(e){ $v1.append( e ) } ); $v2.empty(); basicdesign.defaultValue2DOM( v2, function(e){ $v2.append( e ) } ); $v3.empty(); basicdesign.defaultValue2DOM( v3, function(e){ $v3.append( e ) } ); }, this); } }, /** * Description * @method update * @param {} ga * @param {} d */ update: function( ga, d ) { var element = $(this), data = templateEngine.widgetDataGetByElement( this ), thisTransform = data.address[ ga ][0], value = templateEngine.transformDecode( thisTransform, d ); element.find('.actor').each( function(){ var $this = $(this), index = $this.index() &lt; 3 ? $this.index()+1 : $this.index(), isPressed = value === data['button'+index+'value']; $this.removeClass( isPressed ? 'switchUnpressed' : 'switchPressed' ) .addClass( isPressed ? 'switchPressed' : 'switchUnpressed' ); }); }, downaction: basicdesign.defaultButtonDownAnimation, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { basicdesign.defaultButtonUpAnimation( path, actor ); if( isCanceled ) return; var $actor = $(actor), data = templateEngine.widgetDataGet( path ), index = $actor.index() &lt; 3 ? $actor.index()+1 : $actor.index(), value = data['button'+index+'value']; for( var addr in data.address ) { if( !(data.address[addr][1] &amp; 2) ) continue; // skip when write flag not set templateEngine.visu.write( addr, templateEngine.transformEncode( data.address[addr][0], value ) ); } } }); }); // end define Ã— Search results Close "},"structure_pure_NavBar.js.html":{"id":"structure_pure_NavBar.js.html","title":"Source: structure/pure/NavBar.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/NavBar.js /* NavBar.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/NavBar * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign, isNotSubscribed = true, navbarTop = '', navbarLeft = '', navbarRight = '', navbarBottom = '', $navbarLeftSize = $( '#navbarLeft' ).data('size'), $navbarRightSize = $( '#navbarRight' ).data('size'); design.basicdesign.addCreator('navbar', { /** * Description * @method create * @param {} navbar * @param {} path * @param {} flavour * @param {} type * @return Literal */ create: function( navbar, path, flavour, type ) { var $n = $(navbar); var childs = $n.children(); var id = path.split('_'); id.pop(); var position = $n.attr('position') || 'left'; var scope = $n.attr('scope') || -1; if( $n.attr('flavour') ) flavour = $n.attr('flavour');// sub design choice var flavourClass = flavour ? ( ' flavour_' + flavour ) : ''; var container = '&lt;div class=&quot;navbar clearfix' + flavourClass + '&quot; id=&quot;' + id.join('_')+'_'+ position + '_navbar&quot;&gt;'; if( $n.attr('name') ) container += '&lt;h2&gt;' + $n.attr('name') + '&lt;/h2&gt;'; $( childs ).each( function(i){ container += templateEngine.create_pages( childs[i], path + '_' + i, flavour ); } ); container+='&lt;/div&gt;'; var data = templateEngine.widgetDataInsert( id.join('_')+'_'+ position + '_navbar', { 'scope': scope }); var dynamic = $n.attr('dynamic') == 'true' ? true : false; var size = $n.attr('width') || 300; switch( position ) { case 'top': navbarTop += container; break; case 'left': navbarLeft += container; var thisSize = $navbarLeftSize || size; // FIXME - only a temporal solution if( dynamic ) templateEngine.pagePartsHandler.navbarSetSize( 'left', thisSize ); break; case 'right': navbarRight += container; var thisSize = $navbarRightSize || size; // FIXME - only a temporal solution if( dynamic ) templateEngine.pagePartsHandler.navbarSetSize( 'right', thisSize ); break; case 'bottom': navbarBottom += container; break; } templateEngine.pagePartsHandler.navbars[position].dynamic |= dynamic; if( isNotSubscribed ) { isNotSubscribed = false; templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { if( navbarTop ) $( '#navbarTop' ).append( navbarTop ); if( navbarLeft ) $( '#navbarLeft' ).append( navbarLeft ); if( navbarRight ) $( '#navbarRight' ).append( navbarRight ); if( navbarBottom ) $( '#navbarBottom' ).append( navbarBottom ); }, this, 100); } return ''; } }); }); // end define Ã— Search results Close "},"structure_pure_Page.js.html":{"id":"structure_pure_Page.js.html","title":"Source: structure/pure/Page.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Page.js /* Page.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Page * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign, allPages = ''; design.basicdesign.addCreator('page', { /** * Description * @method create * @param {} page * @param {} path * @param {} flavour * @param {} type * @return ret_val */ create: function( page, path, flavour, type ) { var $p = $(page); var address = {}; if ($p.attr('ga')) { var src = $p.attr('ga'); templateEngine.addAddress( src, path + '_' ); address[ src ] = [ 'DPT:1.001', 0 ]; } var name = $p.attr('name'); var type = $p.attr('type') || 'text'; //text, 2d or 3d var backdrop = $p.attr('backdrop'); var showtopnavigation = $p.attr('showtopnavigation'); var showfooter = $p.attr('showfooter'); // make sure the type has the correct value as we need to use it ass CSS class switch (type) { case '2d': case '3d': // do nothing, type has correct value break; default: type = 'text'; break; } // automatically set the navbars if not set in the config file var shownavbar = { top : 'id' === path ? 'false' : 'inherit', bottom : 'id' === path ? 'false' : 'inherit', left : 'id' === path ? 'false' : 'inherit', right : 'id' === path ? 'false' : 'inherit' }; $p.children('navbar').each( function(){ shownavbar[ $(this).attr('position') || 'left' ] = 'true'; }); // overwrite default when set manually in the config shownavbar.top = $p.attr('shownavbar-top') || shownavbar.top; shownavbar.bottom = $p.attr('shownavbar-bottom') || shownavbar.bottom; shownavbar.left = $p.attr('shownavbar-left') || shownavbar.left; shownavbar.right = $p.attr('shownavbar-right') || shownavbar.right; var bindClickToWidget = templateEngine.bindClickToWidget; if ($p.attr(&quot;bind_click_to_widget&quot;)) bindClickToWidget = $p.attr(&quot;bind_click_to_widget&quot;)==&quot;true&quot;; if( $p.attr('flavour') ) flavour = $p.attr('flavour');// sub design choice var wstyle = ''; // widget style if( $p.attr('align') ) wstyle += 'text-align:' + $p.attr('align') + ';'; if( wstyle != '' ) wstyle = 'style=&quot;' + wstyle + '&quot;'; var ret_val; var layout = basicdesign.parseLayout( $p.children('layout')[0] ); if ($p.attr('visible')=='false') { ret_val=''; } else { // default is visible var style = $.isEmptyObject(layout) ? '' : 'style=&quot;' + basicdesign.extractLayout( layout, type ) + '&quot;'; var classes = basicdesign.setWidgetLayout( $p, path ); ret_val = '&lt;div class=&quot;widget clearfix link pagelink '+(classes?classes:'')+'&quot; ' + style + '&gt;'; ret_val += '&lt;div class=&quot;actor&quot; ' + wstyle + '&gt;&lt;a href=&quot;javascript:&quot;&gt;' + name + '&lt;/a&gt;&lt;/div&gt;'; ret_val += '&lt;/div&gt;'; /* var clickable = bindClickToWidget ? ret_val : actor; clickable.bind( 'click', function() { templateEngine.scrollToPage(name); }); */ } var childs = $p.children().not('layout'); var subpageClass = flavour ? (' flavour_' + flavour) : ''; var subpage = '&lt;div class=&quot;page type_' + type + subpageClass + '&quot; id=&quot;' + path + '_&quot;&gt;'; var data = templateEngine.widgetDataInsert( path + '_', { name : name, type : type, showtopnavigation: showtopnavigation, showfooter : showfooter, shownavbar : shownavbar, layout : layout, backdropalign : '2d' === type ? ($p.attr('backdropalign' ) || '50% 50%') : undefined }); var container = '&lt;div class=&quot;clearfix&quot; style=&quot;height:100%;position:relative;&quot;&gt;&lt;h1&gt;' + name + '&lt;/h1&gt;'; if( '2d' == type ) { var size = 'width:100%;height:100%;'; switch( $p.attr('size') ) { case 'fixed': size = ''; break; case 'contained': size += 'object-fit:contain;'; if( $p.attr('backdropalign' ) ) { size += 'object-position:' + data.backdropalign + ';'; } break; case 'scaled': default: // default: assume scaled } if (undefined != backdrop) { var elemType = '.svg' == backdrop.substring( backdrop.length - 4 ) ? 'embed' : 'img'; container += '&lt;' + elemType + ' src=&quot;' + backdrop + '&quot; style=&quot;position: absolute; top: 0px; left: 0px;z-index:-1;' + size + '&quot;/&gt;'; data.backdroptype = elemType; } } else if( '3d' == type &amp;&amp; false ) //---Disable 3D for 0.8--- { /* var floorplan = JSFloorPlan3D( container, backdrop ); floorplan.moveToRoom( 'Underground', false, true, false ); container.data( 'JSFloorPlan3D', floorplan ); container.find('canvas').css({position: 'absolute', top: '0px', left: '0px', 'z-index':'-1', width:'100%',height:'100%'}); subpage.click( {JSFloorPlan3D:floorplan,callback:function(event){ var j = this.JSFloorPlan3D; j.moveToRoom( j.getState('showFloor'), event.room.room, true, true, function(){ container.trigger( 'update3d', j ); }); }}, floorplan.translateMouseEvent ); $(window).bind( 'resize', function(){ floorplan.resize($('.page').width(), $('.page').height(), true);} ); if ($p.attr('azimut')) { templateEngine.addAddress( $p.attr('azimut'), path + '_' ); address[ $p.attr('azimut') ] = [ 'DPT:9.001', 0, 'azimut' ]; } if ($p.attr('elevation')) { templateEngine.addAddress( $p.attr('elevation'), path + '_' ); address[ $p.attr('elevation') ] = [ 'DPT:9.001', 0, 'elevation' ]; }; if ($p.attr('floor')) { templateEngine.addAddress( $p.attr('floor'), path + '_' ); address[ $p.attr('floor') ] = [ 'DPT:5.004', 0, 'floor' ]; }; $( childs ).each( function(i,a){ if( this.tagName == 'filter' ) { var floorFilter = $(this).attr('floor'); var roomFilter = $(this).attr('room'); childs.splice( i, 1 ); // remove filter element $(this).children().each( function(j){ // and add it's children $(this).find('layout').attr({floorFilter:floorFilter,roomFilter:roomFilter}); childs.splice( i+j, 0, this ); }); } }); */ } templateEngine.widgetDataInsert( path + '_', { 'address': address }); $( childs ).each( function(i){ var subelement = templateEngine.create_pages( childs[i], path + '_' + i, flavour, type ); if( undefined === subelement ) return; container += subelement; } ); subpage += container + '&lt;/div&gt;&lt;/div&gt;'; allPages = subpage + allPages; return ret_val; }, /** * Description * @method createFinal */ createFinal: function() { // special function - only for pages! $('#pages').prepend( allPages ); }, /** * Description * @method update * @param {} ga * @param {} data */ update: function( ga, data ) { var element = $(this); // widgetData = templateEngine.widgetDataGetByElement( element ); // var value = basicdesign.defaultValueHandling( ga, data, widgetData ); // var type = widgetData.address[ ga ][2]; // switch( type ) // { // case 'azimut': // widgetData.JSFloorPlan3D.setState('currentAzimut', value, true); // element.trigger( 'update3d', widgetData.JSFloorPlan3D ); // break; // // case 'elevation': // widgetData.JSFloorPlan3D.setState('currentElevation', value, true); // element.trigger( 'update3d', widgetData.JSFloorPlan3D ); // break; // // case 'floor': // widgetData.JSFloorPlan3D.moveToRoom( value, false, true, true, function(){ // element.trigger( 'update3d', widgetData.JSFloorPlan3D ); // }); // break; // // default: // TODO: data comparision has to be refactored to use DPT and a value if (data==1) { templateEngine.scrollToPage(element.context.firstChild.textContent); templateEngine.visu.write( ga, templateEngine.transformEncode('DPT:1.001', 0)); } // } }, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { if( isCanceled ) return; templateEngine.scrollToPage( path + '_' ); } }); }); // end define Ã— Search results Close "},"structure_pure_PageJump.js.html":{"id":"structure_pure_PageJump.js.html","title":"Source: structure/pure/PageJump.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/PageJump.js /* PageJump.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/PageJump * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('pagejump', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); var layout = basicdesign.parseLayout( $e.children('layout')[0] ); var style = $.isEmptyObject(layout) ? '' : 'style=&quot;' + basicdesign.extractLayout( layout, type ) + '&quot;'; var target = $e.attr('target') ? $e.attr('target') : '0'; var classes = 'widget clearfix pagejump'; if( $e.attr('align') ) { classes+=&quot; &quot;+$e.attr('align'); } var layoutClass = basicdesign.setWidgetLayout( $e, path ); if( layoutClass ) classes += ' ' + layoutClass; if( $e.attr('flavour') ) flavour = $e.attr('flavour');// sub design choice if( flavour ) classes += ' flavour_' + flavour; var widgetInfo = $('widgetinfo &gt; *', $e).first()[0]; var info = ''; if (widgetInfo!=undefined) { classes+=&quot; infoaction&quot;; var data = templateEngine.widgetDataInsert( path+&quot;_0&quot;, { containerClass : &quot;widgetinfo&quot; } ); info = templateEngine.create_pages(widgetInfo, path+&quot;_0&quot;, flavour, widgetInfo.nodeName); } var ret_val = '&lt;div class=&quot;'+classes+'&quot; ' + style + '&gt;'; ret_val += basicdesign.extractLabel( $e.find('label')[0], flavour ); var actor = '&lt;div class=&quot;actor switchUnpressed '; if ( $e.attr( 'align' ) ) actor += $e.attr( 'align' ); actor += '&quot;&gt;'; if( $e.attr( 'name' ) ) actor += '&lt;div class=&quot;value&quot;&gt;' + $e.attr( 'name' ) + '&lt;/div&gt;'; actor += '&lt;/div&gt;'; var data = templateEngine.widgetDataInsert( path, { 'bind_click_to_widget': true, // for pagejumps this is mandatory 'styling' : $e.attr('styling'), 'layout' : layout, 'align' : $e.attr('align'), 'target' : target, 'target_path': $e.attr('path'), 'path' : path, 'active_scope': $e.attr('active_scope') ? $e.attr('active_scope') : 'target' } ); return ret_val + actor + info +'&lt;/div&gt;'; }, /** * Description * @method downaction * @param {} path * @param {} actor * @param {} isCanceled */ downaction: function( path, actor, isCanceled ) { if (!$(actor).parent().hasClass(&quot;info&quot;)) { basicdesign.defaultButtonDownAnimationInheritAction( path, actor ); } }, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { if (!$(actor).parent().hasClass(&quot;info&quot;)) { basicdesign.defaultButtonUpAnimationInheritAction( path, actor ); } if( isCanceled ) return; var data = templateEngine.widgetDataGet( path ); var target = data.target; if (data.target_path !== undefined) { target = templateEngine.getPageIdByPath(data.target,data.target_path); } templateEngine.scrollToPage( target ); } }); $(window).bind('scrolltopage', function( event, page_id ){ var page = $('#' + page_id); var name = templateEngine.widgetData[page_id].name; // remove old active classes $('.pagejump.active').removeClass('active'); $('.pagejump.active_ancestor').removeClass('active_ancestor'); // and set the new active ones $('.pagejump').each( function(){ var $pagejump = $(this); var data = templateEngine.widgetDataGetByElement( this ); if( name == data.target) { $pagejump.addClass('active'); } }); // now set the active ancestors var parentPage = templateEngine.getParentPage(page); // set for all parent pages apart from the root page while (parentPage != null &amp;&amp; templateEngine.getParentPage(parentPage) != null) { var parentId = parentPage.attr('id'), parentName = templateEngine.widgetData[ parentId ].name; $('.pagejump').each( function(){ var $pagejump = $(this); var data = templateEngine.widgetDataGetByElement( this ); if( parentName == data.target || (data.active_scope==&quot;path&quot; &amp;&amp; data.path!=undefined &amp;&amp; data.path.match(parentName+&quot;$&quot;)) ) { $pagejump.addClass('active_ancestor'); } }); // recursively find pagejumps for parent pages parentPage = templateEngine.getParentPage(parentPage); } }); }); // end define Ã— Search results Close "},"structure_pure_PushButton.js.html":{"id":"structure_pure_PushButton.js.html","title":"Source: structure/pure/PushButton.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/PushButton.js /* PushButton.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/PushButton * @requires structure/pure * @since 2013 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('pushbutton', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'pushbutton', $e, path, flavour, type, this.update, function( src, transform, mode, variant ) { return [ true, variant ]; } ); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { 'downValue' : $e.attr('downValue' ) || 1, 'upValue' : $e.attr('upValue') || 0 } ); ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;&lt;div class=&quot;value&quot;&gt;-&lt;/div&gt;&lt;/div&gt;'; return ret_val + '&lt;/div&gt;'; }, /** * Description * @method update * @param {} ga * @param {} d */ update: function( ga, d ) { var element = $(this), data = templateEngine.widgetDataGetByElement( element ); var actor = element.find('.actor'); var value = basicdesign.defaultUpdate( ga, d, element, true, element.parent().attr('id') ); var off = templateEngine.map( data['upValue'], data['mapping'] ); actor.removeClass( value == off ? 'switchPressed' : 'switchUnpressed' ); actor.addClass( value == off ? 'switchUnpressed' : 'switchPressed' ); }, /** * Description * @method downaction * @param {} path * @param {} actor */ downaction: function( path, actor ) { var data = templateEngine.widgetDataGet( path ); for (var addr in data.address) { if (!(data.address[addr][1] &amp; 2)) continue; // skip when write flag not set if (data.address[addr][2]!=undefined &amp;&amp; data.address[addr][2]!=&quot;down&quot;) continue; // skip when not down-variant templateEngine.visu.write(addr, templateEngine.transformEncode(data.address[addr][0], data.downValue)); } }, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { var data = templateEngine.widgetDataGet( path ); for (var addr in data.address) { if (!(data.address[addr][1] &amp; 2)) continue; // skip when write flag not set if (data.address[addr][2]!=undefined &amp;&amp; data.address[addr][2]!=&quot;up&quot;) continue; // skip when not up-variant templateEngine.visu.write(addr, templateEngine.transformEncode(data.address[addr][0], data.upValue)); } } }); }); // end define Ã— Search results Close "},"structure_pure_Refresh.js.html":{"id":"structure_pure_Refresh.js.html","title":"Source: structure/pure/Refresh.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Refresh.js /* Refresh.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Refresh * @requires structure/pure * @author Christian Mayer * @since 2014 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('refresh', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'refresh', $e, path, flavour, type, null ); ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;&lt;div class=&quot;value&quot;&gt;-&lt;/div&gt;&lt;/div&gt;'; var data = templateEngine.widgetDataGet( path ); data.value = $e.attr('value'); // initially setting a value templateEngine.messageBroker.subscribeOnce(&quot;setup.dom.finished&quot;, function() { basicdesign.defaultUpdate( undefined, data.value, $('#'+path), true, path ); }, this); return ret_val + '&lt;/div&gt;'; }, downaction: basicdesign.defaultButtonDownAnimationInheritAction, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { basicdesign.defaultButtonUpAnimationInheritAction( path, actor ); if( isCanceled ) return; templateEngine.visu.restart(); } }); }); // end define Ã— Search results Close "},"structure_pure_Reload.js.html":{"id":"structure_pure_Reload.js.html","title":"Source: structure/pure/Reload.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Reload.js /* Reload.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Reload * @requires structure/pure * @author Christian Mayer * @since 2014 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('reload', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return Literal */ create: function( element, path, flavour, type ) { var e = $(element), address = basicdesign.makeAddressList(e, null); templateEngine.widgetDataInsert( path, { address: address, path: path }); return ''; }, /** * Description * @method update * @param {} ga * @param {} d */ update: function( ga, d ) { var data = templateEngine.widgetDataGetByElement( this ), value = templateEngine.transformDecode( data['address'][ ga ][0], d ); if (value &gt; 0) { window.location.reload(true); } } }); }); // end define Ã— Search results Close "},"structure_pure_Rgb.js.html":{"id":"structure_pure_Rgb.js.html","title":"Source: structure/pure/Rgb.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Rgb.js /* Rgb.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Rgb * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('rgb', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return ret_val */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure /** * Description * @method rgb_handleVariant * @param {} src * @param {} transform * @param {} mode * @param {} variant * @return ArrayExpression */ function rgb_handleVariant(src, transform, mode, variant) { return [true, variant]; } var ret_val = basicdesign.createDefaultWidget( 'rgb', $e, path, flavour, type, this.update, rgb_handleVariant ); // create the actor var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;div class=&quot;value&quot;&gt;&lt;/div&gt;&lt;/div&gt;'; ret_val += actor + '&lt;/div&gt;'; return ret_val; }, /** * Description * @method update * @param {} ga * @param {} d */ update: function( ga, d ) { var element = $(this), valElem = element.find('.value'), data = templateEngine.widgetDataGetByElement( this ); var value = templateEngine.transformDecode( data['address'][ ga ][0], d ); var bg = valElem.css('background-color').replace(/[a-zA-Z()\\s]/g, '').split(/,/); if( 3 !== bg.length ) bg = [0, 0, 0]; switch (data['address'][ ga ][2]) { case 'r' : bg[0] = value; break; case 'g' : bg[1] = value; break; case 'b' : bg[2] = value; break; default: } var bgs = &quot;rgb(&quot; + bg[0] + &quot;, &quot; + bg[1] + &quot;, &quot; + bg[2] + &quot;)&quot;; valElem.css('background-color', bgs ); } }); }); // end define Ã— Search results Close "},"structure_pure_Slide.js.html":{"id":"structure_pure_Slide.js.html","title":"Source: structure/pure/Slide.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Slide.js /* Slide.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Slide * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign, $main = $('#main'); /** * Description * @method transformSlider * @param {} value * @param {} handle */ function transformSlider( value, handle ) { if (!$main.data('disableSliderTransform')) { if (!isNaN(value)) { value = parseFloat(value); // force any (string) value to float var sliderMax = $(handle).parent().slider(&quot;option&quot;,&quot;max&quot;)+($(handle).parent().slider(&quot;option&quot;,&quot;min&quot;)*-1); var percent = Math.round((100/sliderMax)*(value+($(handle).parent().slider(&quot;option&quot;,&quot;min&quot;)*-1))); //console.log(&quot;Value: &quot;+value+&quot;, Max/Min: &quot;+sliderMax+&quot;, %: &quot;+percent+&quot; =&gt; &quot;+percent); $(handle).css('transform', 'translateX(-'+percent+'%)'); } } } design.basicdesign.addCreator('slide', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'slide', $e, path, flavour, type, this.update ); // and fill in widget specific data var datatype_min = undefined; var datatype_max = undefined; $e.find('address').each( function(){ var transform = this.getAttribute('transform'); if( Transform[ transform ] &amp;&amp; Transform[ transform ].range ) { if( !( datatype_min &gt; Transform[ transform ].range.min ) ) datatype_min = Transform[ transform ].range.min; if( !( datatype_max &lt; Transform[ transform ].range.max ) ) datatype_max = Transform[ transform ].range.max; } }); var min = parseFloat( $e.attr('min') || datatype_min || 0 ); var max = parseFloat( $e.attr('max') || datatype_max || 100 ); var step = parseFloat( $e.attr('step') || 0.5 ); var send_on_finish = $e.attr('send_on_finish') || 'false'; templateEngine.widgetDataInsert( path, { //???///'events': $(actor).data( 'events' ), 'min' : min, 'max' : max, 'step' : step, 'send_on_finish' : send_on_finish, 'valueInternal' : true, 'inAction' : false }); this.construct(path); return ret_val + '&lt;div class=&quot;actor&quot;/&gt;&lt;/div&gt;'; }, construct: function(path) { var data = templateEngine.widgetDataGet(path); // check provided address-items for at least one address which has write-access var readonly = true; for (var addrIdx in data.address) { if (data.address[addrIdx][1] &amp; 2) { // write-access detected --&gt; no read-only mode readonly = false; break; } } // create the actor templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { var $actor = $( '#' + path + ' .actor' ); $actor.slider({ step: data.step, min: data.min, max: data.max, range: 'min', animate: true, send_on_finish : data.send_on_finish, start: this.slideStart, change: this.slideChange }); // disable slider interaction if in read-only mode --&gt; just show the value if (readonly) { $actor.slider({ disabled: true }); } $actor.on( 'slide', this.slideUpdateValue ); if( data['format']) { // initially setting a value $actor.children('.ui-slider-handle').text(sprintf(data['format'],templateEngine.map( undefined, data['mapping'] ))); } }, this); }, /** * Description * @method update * @param {} ga * @param {} d */ update: function( ga, d ) { var element = $(this), actor = element.find('.actor'), data = templateEngine.widgetDataGetByElement( this ); if( data.inAction ) return; var value = templateEngine.transformDecode( data.address[ ga ][0], d ); if( data.value != value ) { data.value = value; data.valueInternal = false; actor.slider('value', value); data.valueInternal = true; if( data.format != null ) actor.children('.ui-slider-handle').text(sprintf( data.format, templateEngine.map( value, data.mapping ))); } transformSlider(value,actor.children('.ui-slider-handle')); }, /** * Description * @method slideUpdateValue * @param {} event * @param {} ui */ slideUpdateValue:function(event,ui) { var element = $(this).parent(), actor = element.find('.actor'), data = templateEngine.widgetDataGetByElement( this ); if( data.format) { $(ui.handle).text(sprintf( data.format, templateEngine.map( ui.value, data.mapping ))); } transformSlider(ui.value,ui.handle); }, /** * Start a thread that regularily sends the silder position to the bus * @method slideStart * @param {} event * @param {} ui */ slideStart:function(event,ui) { var element = $(this).parent(), actor = element.find('.actor'), data = templateEngine.widgetDataGetByElement( this ); if ( data.send_on_finish == 'true') return; data.inAction = true; data.valueInternal = true; data.updateFn = setInterval( function(){ var asv = actor.slider('value'); if( data.value == asv ) return; for( var addr in data.address ) { if( !(data.address[addr][1] &amp; 2) ) continue; // skip when write flag not set var dv = templateEngine.transformEncode( data.address[addr][0], asv ); if( dv != templateEngine.transformEncode( data.address[addr][0], data.value ) ) templateEngine.visu.write( addr, dv ); } data.value = asv; }, 250 ); // update KNX every 250 ms }, /** * Delete the update thread and send the final value of the slider to the bus * @method slideChange * @param {} event * @param {} ui */ slideChange:function(event,ui) { var data = templateEngine.widgetDataGetByElement( this ); clearInterval( data.updateFn, ui.value); data.inAction = false; if( data.valueInternal &amp;&amp; data.value != ui.value ) { for( var addr in data.address ) { if( !(data.address[addr][1] &amp; 2) ) continue; // skip when write flag not set var uv = templateEngine.transformEncode( data.address[addr][0], ui.value ); if( uv != templateEngine.transformEncode( data.address[addr][0], data.value ) ) templateEngine.visu.write( addr, uv ); } } transformSlider(ui.value,ui.handle); } }); }); // end define Ã— Search results Close "},"structure_pure_Switch.js.html":{"id":"structure_pure_Switch.js.html","title":"Source: structure/pure/Switch.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Switch.js /* Switch.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * The switch widget shows two states (e.g. ON and OFF) and can toggle between them. * * @widget_example &lt;settings&gt; * &lt;caption&gt;Configuration example of a switch widget using mapping and styling&lt;/caption&gt; * &lt;screenshot name=&quot;switch_example_on&quot;&gt; * &lt;caption&gt;Switch turned on&lt;/caption&gt; * &lt;data address=&quot;0/0/0&quot;&gt;1&lt;/data&gt; * &lt;/screenshot&gt; * &lt;screenshot name=&quot;switch_example_off&quot;&gt; * &lt;caption&gt;Switch turned off&lt;/caption&gt; * &lt;data address=&quot;0/0/0&quot;&gt;0&lt;/data&gt; * &lt;/screenshot&gt; * &lt;/settings&gt; * &lt;meta&gt; * &lt;mappings&gt; * &lt;mapping name=&quot;OnOff&quot;&gt; * &lt;entry value=&quot;0&quot;&gt;O&lt;/entry&gt; * &lt;entry value=&quot;1&quot;&gt;I&lt;/entry&gt; * &lt;/mapping&gt; * &lt;/mappings&gt; * &lt;stylings&gt; * &lt;styling name=&quot;GreyGreen&quot;&gt; * &lt;entry value=&quot;0&quot;&gt;grey&lt;/entry&gt; * &lt;entry value=&quot;1&quot;&gt;green&lt;/entry&gt; * &lt;/styling&gt; * &lt;/stylings&gt; * &lt;/meta&gt; * &lt;switch mapping=&quot;OnOff&quot; styling=&quot;GreyGreen&quot;&gt; * &lt;layout colspan=&quot;3&quot; /&gt; * &lt;label&gt;Switch&lt;/label&gt; * &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; * &lt;/switch&gt; * @module structure/pure/Switch * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('switch', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'switch', $e, path, flavour, type, this.update ); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { 'on_value' : $e.attr('on_value' ) || 1, 'off_value' : $e.attr('off_value') || 0 } ); ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;&lt;div class=&quot;value&quot;&gt;-&lt;/div&gt;&lt;/div&gt;'; return ret_val + '&lt;/div&gt;'; }, /** * Handles updates of incoming data for this widget * @method update * @param {String} address - Source address of the incoming data * @param {String} value - Incoming data */ update: function( address, value ) { var element = $(this), data = templateEngine.widgetDataGetByElement( element ), actor = element.find('.actor'), value = basicdesign.defaultUpdate( address, value, element, true, element.parent().attr('id') ), off = templateEngine.map( data['off_value'], data['mapping'] ); actor.removeClass( value == off ? 'switchPressed' : 'switchUnpressed' ); actor.addClass( value == off ? 'switchUnpressed' : 'switchPressed' ); }, /** * Action performed when the switch got clicked * * @method action * @param {String} path - Internal path of the widget * @param {Element} actor - DOMElement * @param {Boolean} isCanceled - If true the action does nothing */ action: function( path, actor, isCanceled ) { if( isCanceled ) return; var widgetData = templateEngine.widgetDataGet( path ); for( var addr in widgetData.address ) { if( !(widgetData.address[addr][1] &amp; 2) ) continue; // skip when write flag not set templateEngine.visu.write( addr, templateEngine.transformEncode( widgetData.address[addr][0], widgetData.basicvalue == widgetData.off_value ? widgetData.on_value : widgetData.off_value ) ); } } }); }); // end define Ã— Search results Close "},"structure_pure_Text.js.html":{"id":"structure_pure_Text.js.html","title":"Source: structure/pure/Text.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Text.js /* Text.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * The text-tag defines static (non-changing) text to be displayed on a page. The content of a &amp;lt;label&amp;gt; with free text. * * @widget_example &lt;settings&gt; * &lt;caption&gt;Configuration example of a centered text widget&lt;/caption&gt; * &lt;screenshot name=&quot;text_example&quot; /&gt; * &lt;/settings&gt; * &lt;text align=&quot;center&quot;&gt;&lt;label&gt;Example text&lt;/label&gt;&lt;/text&gt; * * @module structure/pure/Text * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('text', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create : function(element, path, flavour, type) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'text', $e, path, flavour, type, this.update ); var data = templateEngine.widgetDataInsert( path, { path: path }); return ret_val + '&lt;/div&gt;'; } }); }); // end define Ã— Search results Close "},"structure_pure_Toggle.js.html":{"id":"structure_pure_Toggle.js.html","title":"Source: structure/pure/Toggle.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Toggle.js /* Toggle.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Toggle * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('toggle', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'toggle', $e, path, flavour, type, this.update ); // create the actor ret_val += '&lt;div class=&quot;actor switchUnpressed&quot;&gt;&lt;div class=&quot;value&quot;&gt;-&lt;/div&gt;&lt;/div&gt;'; var data = templateEngine.widgetDataGet( path ); return ret_val + '&lt;/div&gt;'; }, /** * Description * @method update * @param {} ga * @param {} d */ update: function( ga, d ) { var element = $(this); basicdesign.defaultUpdate( ga, d, element, true, element.parent().attr('id') ); }, downaction: basicdesign.defaultButtonDownAnimationInheritAction, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { basicdesign.defaultButtonUpAnimationInheritAction( path, actor ); if( isCanceled ) return; var data = templateEngine.widgetDataGet( path ); var sendValue = templateEngine.getNextMappedValue( data.basicvalue, data.mapping ); for( var addr in data.address ) { if( !(data.address[addr][1] &amp; 2) ) continue; // skip when write flag not set templateEngine.visu.write( addr, templateEngine.transformEncode( data.address[addr][0], sendValue ) ); } } }); }); // end define Ã— Search results Close "},"structure_pure_Trigger.js.html":{"id":"structure_pure_Trigger.js.html","title":"Source: structure/pure/Trigger.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Trigger.js /* Trigger.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Trigger * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('trigger', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure /** * Description * @method makeAddressListFn * @param {} src * @param {} transform * @param {} mode * @param {} variant * @return ArrayExpression */ var makeAddressListFn = function( src, transform, mode, variant ) { // Bit 0 = short, Bit 1 = button =&gt; 1|2 = 3 = short + button return [ true, variant == 'short' ? 1 : (variant == 'button' ? 2 : 1|2) ]; } var ret_val = basicdesign.createDefaultWidget( 'trigger', $e, path, flavour, type, null, makeAddressListFn ); // and fill in widget specific data templateEngine.widgetDataInsert( path, { 'sendValue' : $e.attr('value' ) || 0, 'shorttime' : parseFloat($e.attr('shorttime')) || -1, 'shortValue' : $e.attr('shortvalue') || 0 } ); // create the actor var actor = '&lt;div class=&quot;actor switchUnpressed&quot;&gt;&lt;div class=&quot;value&quot;&gt;&lt;/div&gt;&lt;/div&gt;'; this.construct(path); return ret_val + actor + '&lt;/div&gt;'; }, construct : function(path) { var data = templateEngine.widgetDataGet(path); // initially setting a value templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { basicdesign.defaultUpdate( undefined, data['sendValue'], $('#'+path), true, path ); }); }, downaction: basicdesign.defaultButtonDownAnimationInheritAction, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { basicdesign.defaultButtonUpAnimationInheritAction( path, actor ); if( isCanceled ) return; var data = templateEngine.widgetDataGet( path ), isShort = Date.now() - templateEngine.handleMouseEvent.downtime &lt; data.shorttime, bitMask = (isShort ? 1 : 2); for( var addr in data.address ) { if (!(data.address[addr][1] &amp; 2)) continue; // skip when write flag not set if (data.address[addr][2] &amp; bitMask) { templateEngine.visu.write( addr, templateEngine.transformEncode( data.address[addr][0], isShort ? data.shortValue : data.sendValue ) ); } } } }); }); // end define Ã— Search results Close "},"structure_pure_Unknown.js.html":{"id":"structure_pure_Unknown.js.html","title":"Source: structure/pure/Unknown.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Unknown.js /* Unknown.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * Fallback widget shown when an unknown widget is defined in the configuration. * You must not use this one directly. * * @module structure/pure/Unknown * @requires structure/pure * @author Christian Mayer * @since 0.8.0 (2012) */ define( ['_common'], function( design ) { &quot;use strict&quot;; design.basicdesign.addCreator('unknown', { /** * Creates the widget HTML code * * @method create * @param {Element} element - DOM-Element * @param {String} path - internal path of the widget * @param {String} flavour - Flavour of the widget * @param {String} type - Page type (2d, 3d, ...) * @return {String} HTML code */ create: function( element, path, flavour, type ) { return '&lt;div class=&quot;widget clearfix&quot;&gt;' + '&lt;pre&gt;unknown: ' + element.nodeName + '&lt;/pre&gt;' + '&lt;/div&gt;'; } }); }); // end define Ã— Search results Close "},"structure_pure_UrlTrigger.js.html":{"id":"structure_pure_UrlTrigger.js.html","title":"Source: structure/pure/UrlTrigger.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/UrlTrigger.js /* UrlTrigger.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/UrlTrigger * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('urltrigger', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); var layout = basicdesign.parseLayout( $e.children('layout')[0] ); var style = $.isEmptyObject(layout) ? '' : 'style=&quot;' + basicdesign.extractLayout( layout, type ) + '&quot;'; var value = $e.attr('value') ? $e.attr('value') : 0; var classes = 'widget clearfix trigger'; if( $e.attr('align') ) { classes+=&quot; &quot;+$e.attr('align'); } var layoutClass = basicdesign.setWidgetLayout( $e, path ); if( layoutClass ) classes += ' ' + layoutClass; if( flavour ) classes += ' flavour_' + flavour; var ret_val = '&lt;div class=&quot;'+classes+'&quot; ' + style + '&gt;'; if( $e.attr('flavour') ) flavour = $e.attr('flavour');// sub design choice var label = basicdesign.extractLabel( $e.find('label')[0], flavour ); var actor = '&lt;div class=&quot;actor switchUnpressed '; if ( $e.attr( 'align' ) ) actor += $e.attr( 'align' ); actor += '&quot;&gt;&lt;div class=&quot;value&quot;&gt;&lt;/div&gt;&lt;/div&gt;'; var data = templateEngine.widgetDataInsert( path, { 'path' : path, 'url' : $(element).attr('url'), 'mapping' : $(element).attr('mapping'), 'styling' : $(element).attr('styling'), 'layout' : layout, 'align' : $e.attr('align'), 'params' : $(element).attr('params'), 'sendValue': value //value is currently ignored in XHR! maybe for multitrigger } ); this.construct(path); return ret_val + label + actor + '&lt;/div&gt;'; }, construct : function(path) { var data = templateEngine.widgetDataGet(path); // initially setting a value templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { basicdesign.defaultUpdate( undefined, data['sendValue'], $('#'+path), true, path ); }); }, downaction: basicdesign.defaultButtonDownAnimationInheritAction, /** * Description * @method action * @param {} path * @param {} actor * @param {} isCanceled */ action: function( path, actor, isCanceled ) { basicdesign.defaultButtonUpAnimationInheritAction( path, actor ); if( isCanceled ) return; var data = templateEngine.widgetDataGet( path ); data.params = data.params ? data.params : ''; $.ajax({ type: &quot;GET&quot;, datatype: &quot;html&quot;, data: encodeURI(data.params), url: data.url, success: function(data){ //maybe do something useful with the response? } }); } }); }); // end define Ã— Search results Close "},"structure_pure_Video.js.html":{"id":"structure_pure_Video.js.html","title":"Source: structure/pure/Video.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Video.js /* Video.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Video * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('video', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return ret_val */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'video', $e, path, flavour, type ); // and fill in widget specific data var data = templateEngine.widgetDataInsert( path, { 'width' : $e.attr('with'), 'height' : $e.attr('height'), 'src' : $e.attr('src'), 'autoplay': $e.attr('autoplay') } ); // create the actor var style = ''; if( data.width ) style += 'width:' + data.width + ';'; if( data.height ) style += 'height:' + data.height + ';'; if( style != '' ) style = 'style=&quot;' + style + '&quot;'; var autoplay = (data.autoplay === 'true') ? ' autoplay=&quot;autoplay&quot;' : ''; var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;video src=&quot;' +$e.attr('src') + '&quot; ' + style + autoplay + ' controls=&quot;controls&quot; /&gt;&lt;/div&gt;'; ret_val += actor + '&lt;/div&gt;'; return ret_val; } }); }); // end define Ã— Search results Close "},"structure_pure_Web.js.html":{"id":"structure_pure_Web.js.html","title":"Source: structure/pure/Web.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/Web.js /* Web.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/Web * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('web', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); var address = {}, src; if ($e.attr('ga')) { src = $e.attr('ga'); templateEngine.addAddress($e.attr('ga')); address[ '_' + $e.attr('ga') ] = [ 'DPT:1.001', 0 ]; } var layout = basicdesign.parseLayout( $e.children('layout')[0] ); var style = $.isEmptyObject(layout) ? '' : 'style=&quot;' + basicdesign.extractLayout( layout, type ) + '&quot;'; var classes = basicdesign.setWidgetLayout( $e, path ); if( $e.attr('flavour') ) flavour = $e.attr('flavour');// sub design choice if( flavour ) classes += ' flavour_' + flavour; var ret_val = '&lt;div class=&quot;widget web '+(classes?classes:'')+'&quot; ' + style + '&gt;'; ret_val += basicdesign.extractLabel( $e.find('label')[0], flavour ); var webStyle = ''; if( $e.attr('width' ) ) { webStyle += 'width:' + $e.attr('width' ) + ';'; } else { // default width is 100% of widget space (fix bug #3175343 part 1) webStyle += 'width: 100%;'; } if( $e.attr('height') ) webStyle += 'height:' + $e.attr('height') + ';'; if( $e.attr('frameborder') == 'false' ) style += 'border: 0px ;'; if( $e.attr('background') ) webStyle += 'background-color:' + $e.attr('background') + ';'; if( webStyle != '' ) webStyle = 'style=&quot;' + webStyle + '&quot;'; var scrolling = ''; if( $e.attr('scrolling') ) scrolling = 'scrolling=&quot;' + $e.attr('scrolling') +'&quot;'; // add scrolling parameter to iframe // var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;iframe src=&quot;' +$e.attr('src') + '&quot; ' + webStyle + scrolling + '&gt;&lt;/iframe&gt;&lt;/div&gt;'; var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;iframe src=&quot;' +$e.attr('src') + '&quot; ' + webStyle + scrolling + '&gt;&lt;/iframe&gt;&lt;/div&gt;'; var refresh = $e.attr('refresh') ? $e.attr('refresh')*1000 : 0; templateEngine.widgetDataInsert( path, { 'path' : path, 'address': address, 'layout' : layout, 'refresh': refresh } ); this.construct(path); return ret_val + actor + '&lt;/div&gt;'; }, construct : function(path) { var data = templateEngine.widgetDataGet(path); if (data.refresh) { templateEngine.messageBroker.subscribe(&quot;setup.dom.finished&quot;, function() { templateEngine.setupRefreshAction( path, data.refresh ); }); } }, /** * Description * @method update * @param {} ga * @param {} data */ update: function( ga, data) { var element = $(this), widgetData = templateEngine.widgetDataGetByElement( element ), value = basicdesign.defaultValueHandling( ga, data, widgetData ), type = widgetData.address[ ga ][2]; switch( type ) { default: if (data==1) { var iframe = element.find('iframe'); iframe.attr('src', iframe.attr('src')); templateEngine.visu.write( ga, templateEngine.transformEncode('DPT:1.001', 0)); } } } }); }); // end define Ã— Search results Close "},"structure_pure_WgPluginInfo.js.html":{"id":"structure_pure_WgPluginInfo.js.html","title":"Source: structure/pure/WgPluginInfo.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: structure/pure/WgPluginInfo.js /* WgPluginInfo.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * TODO: complete docs * * @module structure/pure/WgPluginInfo * @requires structure/pure * @author Christian Mayer * @since 2012 */ define( ['_common'], function( design ) { &quot;use strict&quot;; var basicdesign = design.basicdesign; design.basicdesign.addCreator('wgplugin_info', { /** * Description * @method create * @param {} element * @param {} path * @param {} flavour * @param {} type * @return BinaryExpression */ create: function( element, path, flavour, type ) { var $e = $(element); // create the main structure var ret_val = basicdesign.createDefaultWidget( 'info', $e, path, flavour, type, this.update ); templateEngine.widgetDataInsert( path, { 'variable' : $e.attr('variable') } ); // create the actor var actor = '&lt;div class=&quot;actor&quot;&gt;&lt;div class=&quot;value&quot;&gt;-&lt;/div&gt;&lt;/div&gt;'; ret_val += actor; return ret_val + '&lt;/div&gt;'; }, /** * Description * @method update * @param {} ga * @param {} d * @param {} passedElement */ update: function( ga, d, passedElement ) { var element = passedElement || $(this), widgetData = templateEngine.widgetDataGetByElement( element ), variable = widgetData[ 'variable' ], valueElement = element.find('.value'); $.getJSON('/wg-plugindb.pl?name=' + variable, function(data) { basicdesign.defaultUpdate( undefined, data[variable], element, true, element.parent().attr('id') ); }); }, update3d: design.basicdesign.defaultUpdate3d }); }); // end define Ã— Search results Close "},"lib_IconTools.js.html":{"id":"lib_IconTools.js.html","title":"Source: lib/IconTools.js","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Source: lib/IconTools.js /* IconTools.js * * copyright (c) 2010-2016, Christian Mayer and the CometVisu contributers. * * This program is free software; you can redistribute it and/or modify it * under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 3 of the License, or (at your option) * any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for * more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA */ /** * @author Christian Mayer * @since 2015 */ define([ 'jquery' ], function( $ ) { &quot;use strict&quot;; (function( window, undefined ){ // &quot;global&quot; functions (=&gt; state less) var hexColorRegEx = /#[0-9a-fA-F]{6}/, colorMapping = { // as a convenience, definition of a few colors white: '#ffffff', orange: '#ff8000', red: '#ff4444', green: '#44ff44', blue: '#4444ff', purple: '#ff44ff', yellow: '#ffff00', grey: '#777777', black: '#000000' }, iconCache = {}, // the Image() of all knows (i.e. used) icons iconCacheMap = [], // mapping of ID to Cache entry (URL) iconDelay = [], // array of all icons to fill where the Image is not ready yet iconDelayFn, // handler for dealy function iconDelayed = function( icon, colors, color ) { iconDelay.push( [ icon, colors, color ] ); if( !iconDelayFn ) iconDelayFn = setInterval( function(){ while( iconDelay.length ) { // it should be enough to test only the first element - the other // elements will be covered anyway... if( iconDelay[0][2] in iconDelay[0][1] ) window.fillRecoloredIcon( iconDelay.shift()[0] ); else break; } if( 0 === iconDelay.length ) { clearInterval( iconDelayFn ); iconDelayFn = 0; } }, 10 ); }, /** * Create the HTML for the canvas element and return it. */ createCanvas = function( iconId, styling, classes ) { return '&lt;canvas class=&quot;' + iconId + ' ' + classes + '&quot; ' + styling + '/&gt;'; }, /** * Fill the canvas with the ImageData. Also resize the * canvas at the same time. */ fillCanvas = function( canvas, imageData ) { canvas.width = imageData.width; canvas.height = imageData.height; canvas.getContext('2d').putImageData( imageData, 0, 0 ); }, /** * Two versions of a recoloring funtion to work around an Android bug: * http://stackoverflow.com/questions/14969496/html5-canvas-pixel-manipulation-problems-on-mobile-devices-when-setting-the-alph * https://code.google.com/p/android/issues/detail?id=17565 * */ innerRecolorLoop = navigator.userAgent.toLowerCase().indexOf('android') &gt; -1 &amp;&amp; parseFloat(navigator.userAgent.slice(navigator.userAgent.toLowerCase().indexOf('android')+8)) &lt; 4.4 ? function( r, g, b, data, length ) // for Android version &lt; 4.4 { for( var i = 0; i &lt; length; i += 4 ) { var a = data[ i+3 ]; if( a &gt; 127 ) { data[ i ] = r; data[ i+1 ] = g; data[ i+2 ] = b; data[ i+3 ] = 255; } else { // brute force it... data[ i ] = 0; data[ i+1 ] = 0; data[ i+2 ] = 0; data[ i+3 ] = 0; } } } : function( r, g, b, data, length ) // the normal version { for( var i = 0; i &lt; length; i += 4 ) { if( 0 != data[ i+3 ] ) { data[ i ] = r; data[ i+1 ] = g; data[ i+2 ] = b; } } }, tmpCanvas = $('&lt;canvas/&gt;')[0], tmpCtx = tmpCanvas.getContext('2d'), /** * Do the recoloring based on @param thisIcon and store it in the * hash @param thisIconColors. */ doRecolorNonTransparent = function( color, thisIcon, thisIconColors ) { if( thisIconColors[color] ) return; // done, already recolored var width = tmpCanvas.width = thisIcon.width, height = tmpCanvas.height = thisIcon.height; tmpCtx.drawImage( thisIcon, 0, 0 ); var imageData = tmpCtx.getImageData( 0, 0, width, height ); if( color !== undefined ) { if( !hexColorRegEx.test( color ) ) alert( 'Error! &quot;' + color + '&quot; is not a valid color for icon recoloring! It must have a shape like &quot;#aabbcc&quot;.' ); var r = parseInt( color.substr( 1, 2 ), 16 ), g = parseInt( color.substr( 3, 2 ), 16 ), b = parseInt( color.substr( 5, 2 ), 16 ); innerRecolorLoop( r, g, b, imageData.data, width * height * 4 ); } thisIconColors[color] = imageData; }; /** * Funtion to call for each icon that should be dynamically recolored. * This will be called for each known URL, so only remember the string but * don't load the image yet as it might not be needed. */ window.recolorNonTransparent = function( url ) { var loadHandler = function(){ var toFill = iconCache[url].toFill, thisIcon = iconCache[url].icon, thisIconColors = iconCache[url].colors, thisFillColor; while( thisFillColor = toFill.pop() ) { doRecolorNonTransparent( thisFillColor, thisIcon, thisIconColors ); } }; /** * will be called for each color that is actually used * =&gt; load image for all colors * =&gt; transform image * @return {Function} a function that will append the recolored image to * the jQuery element passed to that function */ return function( color, styling, classes, asText ) { if( undefined === iconCache[url] ) { var thisIcon = new Image(); thisIcon.onload = loadHandler; thisIcon.src = url; iconCache[url] = { icon : thisIcon, // the original Image() of the icon id : iconCacheMap.length, // the unique ID for this icon colors: {}, // cache all the transformed ImageDatas toFill: [] // all the icon colors to fill once the image was loaded }; iconCacheMap.push( url ); } if( color === undefined ) color = '#ffffff'; if( color in colorMapping ) color = colorMapping[ color ]; var c = 'icon' + iconCache[url].id + '_' + color.substr( 1, 6 ); iconCache[url].toFill.push( color ); // when already available - fill it now. Otherwise the onLoad will do it. if( iconCache[url].icon.complete ) loadHandler(); var newCanvas = createCanvas( c, styling, classes ); if( asText ) return newCanvas; var newElement = $(newCanvas)[0]; if( iconCache[url].icon.complete ) fillCanvas( newElement, iconCache[url].colors[ color ] ); else iconDelayed( newElement, iconCache[url].colors, color ); return newElement; } }; /** * This function must be called to fill a specific icon that was created */ window.fillRecoloredIcon = function( icon ) { var parameters = (icon.className.split ? icon.className.split(' ') : icon.className.baseVal.split(' '))[0].substring(4).split('_'); if( 2 === parameters.length ) { var cacheEntry = iconCache[ iconCacheMap[ parameters[0] ] ], coloredIcon = cacheEntry.colors[ '#' + parameters[1] ]; if( undefined === coloredIcon ) iconDelayed( icon, cacheEntry.colors, '#' + parameters[1] ); else fillCanvas( icon, coloredIcon ); } }; window.svgKUF = function( iconID ) { return function( color, styling, classes, asText ) { if( color in colorMapping ) color = colorMapping[ color ]; var style=''; if( color ) style = 'style=&quot;color:' + color + '&quot; '; return '&lt;svg ' + style + 'class=&quot;' + classes + '&quot;&gt;&lt;use xlink:href=&quot;icon/knx-uf-iconset.svg#kuf-' + iconID + '&quot;&gt;&lt;/use&gt;&lt;/svg&gt;'; } }; })(window); }); Ã— Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Global Members jOWM Plugin: jquery.OWM jQuery plugin to display data from OpenWeatherMap. Version: 0.0.1Copyright (c) 2015, Stefan Borchert Licensed under the GPLv3 license. Source: plugins/openweathermap/owm/jquery.owm.js, line 12 Methods debug() Return icon database for debuging purposes - use ONLY for debugging as it'scircumventing the data hiding and exposes a writeable reference to thedatabase object! Source: lib/IconHandler.js, line 260 Returns: The icon database Type Object fadeNavbar(position, direction, speed) fades in/out a navbar Parameters: Name Type Description position [Top|Left|Right|Bottom] direction [in|out] speed time in milliseconds Source: lib/PagePartsHandler.js, line 247 get(name, type, flavour, color) Get the icon information for a name. Parameters: Name Type Description name String Name type String Type (optional) flavour String Flavour (optional) color String Color (optional, only relevant for monochrome icons) Source: lib/IconHandler.js, line 100 Returns: The URI for the icon - or &quot;undefined&quot; if not known Type URI handleRead() This function gets called once the communication is established and session information is available Source: lib/mockup/Client.js, line 33 initializeNavbars(page_id) traverse down the page tree from root page id_ -&gt; .. -&gt; page_id activateall navbars in that path deactivate all others Parameters: Name Type Description page_id Source: lib/PagePartsHandler.js, line 305 list() List all known icons Source: lib/IconHandler.js, line 250 Returns: List of all known icon names Type Array navbarSetSize() Change the size of the selected navbar currently only &quot;left&quot; and &quot;right&quot; are implemented Source: lib/PagePartsHandler.js, line 68 subscribe() Subscribe to the addresses in the parameter Source: lib/mockup/Client.js, line 56 updatePageParts(page) update the visibility ob top-navigation, footer and navbar for this page Parameters: Name Type Description page Source: lib/PagePartsHandler.js, line 158 write() This function sends a value Source: lib/mockup/Client.js, line 65 Ã— Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Modules Classes Dispatcher FOO module:cometvisu-client Ã— Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Classes Classes Dispatcher FOO module:cometvisu-client Ã— Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Ã— Search results Close "},"-_anonymous_-EventHandler-Dispatcher.html":{"id":"-_anonymous_-EventHandler-Dispatcher.html","title":"Class: Dispatcher","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Class: Dispatcher Dispatcher new Dispatcher(handler) The dispatcher registers listeners for all relevant events to the window objectand dispatched the event to the EventHandler. The dispatcher listens to similar eventslike touchstart and mousedown but makes sure that these events are not fired Parameters: Name Type Description handler Source: lib/EventHandler.js, line 268 Methods register() register to all events Source: lib/EventHandler.js, line 273 Ã— Search results Close "},"FOO.html":{"id":"FOO.html","title":"Class: FOO","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Class: FOO FOO icon new FOO() The object &quot;icon&quot; contains the whole API necessary to handle the icons. Source: lib/IconHandler.js, line 28 Ã— Search results Close "},"module-cometvisu-client.html":{"id":"module-cometvisu-client.html","title":"Class: module:cometvisu-client","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Class: module:cometvisu-client module:cometvisu-client CometVisuClient new module:cometvisu-client(backendName [, initPath]) The CometVisuClient handles all communication issues to supply the userob this object with reliable realtime data.Itself it can be seen as the session layer (layer 5) according to the OSImodel. Parameters: Name Type Argument Description backendName String name of the backend (cgi-bin|default|oh|openhab|oh2|openhab2) initPath String &lt;optional&gt; optional path to login ressource Source: lib/CometVisuClient.js, line 461 Methods beforeSend() manipulates the header of the current ajax query before it is been send to the server Source: lib/CometVisuClient.js, line 476 handleLogin(json) Handles login response, applies backend configuration if send bybackend and forwards to the configurated transport handleSessionfunction Parameters: Name Type Description json Source: lib/CometVisuClient.js, line 679 Ã— Search results Close "},"module-lib_CometVisuClient.html":{"id":"module-lib_CometVisuClient.html","title":"Module: lib/CometVisuClient","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: lib/CometVisuClient The JavaScript library that implements the CometVisu protocol. Since: 0.5.3 (initial contribution) 0.10.0 (major refactoring) Author: Christan Mayer Tobias BrÃ¤utigam Source: lib/CometVisuClient.js, line 21 Requires module:dependencies/jquery Methods &lt;inner&gt; beforeSend(xhr) manipulates the header of the current ajax query before it isbeen send to the server Parameters: Name Type Description xhr Source: lib/CometVisuClient.js, line 278 &lt;inner&gt; buildRequest(addresses) Build the URL part that contains the addresses and filters Parameters: Name Type Description addresses Source: lib/CometVisuClient.js, line 713 Returns: Type String &lt;inner&gt; handleError(xhr, str, excptObj) This function gets called on an error FIXME: this should be aprototype, so that the application developer can override it Parameters: Name Type Description xhr str excptObj Source: lib/CometVisuClient.js, line 240 &lt;inner&gt; handleRead(json) This function gets called once the communication is establishedand session information is available Parameters: Name Type Description json Source: lib/CometVisuClient.js, line 147 &lt;inner&gt; handleSession(json, connect) This function gets called once the communication is establishedand session information is available. Parameters: Name Type Description json connect (boolean) wether to start the connection or not Source: lib/CometVisuClient.js, line 100 &lt;inner&gt; handleSession(connect) This function gets called once the communication is establishedand session information is available Parameters: Name Type Description connect (boolean) wether to start the connection or not Source: lib/CometVisuClient.js, line 350 &lt;inner&gt; login(loginOnly, callback, context) This function starts the communication by a login and then runs theongoing communication task Parameters: Name Type Description loginOnly (boolean) if true only login and backend configuration, no subscription to addresses (default: false) callback (Function) cakk this function when login is done context (Object) context for the callback (this) Source: lib/CometVisuClient.js, line 632 &lt;inner&gt; readResendHeaderValues() read the header values of a response and stores them to theresendHeaders array Source: lib/CometVisuClient.js, line 297 &lt;inner&gt; readResendHeaderValues() read the header values of a response and stores them to the resendHeaders array Source: lib/CometVisuClient.js, line 487 &lt;inner&gt; restart(doFullReload) Restart the read request, e.g. when the watchdog kicks in Parameters: Name Type Description doFullReload bool reload all data and not only restart connection Source: lib/CometVisuClient.js, line 317 &lt;inner&gt; restart() Abort the read request properly Source: lib/CometVisuClient.js, line 436 &lt;inner&gt; restart() Abort the read request properly Source: lib/CometVisuClient.js, line 332 &lt;inner&gt; restart() Restart the read request, e.g. when the watchdog kicks in Source: lib/CometVisuClient.js, line 426 &lt;inner&gt; stop() This function stops an ongoing connection Source: lib/CometVisuClient.js, line 700 &lt;inner&gt; subscribe(addresses, filters) Subscribe to the addresses in the parameter. The second parameter(filter) is optional Parameters: Name Type Description addresses filters Source: lib/CometVisuClient.js, line 600 &lt;inner&gt; write(address, value) This function sends a value Parameters: Name Type Description address value Source: lib/CometVisuClient.js, line 731 Ã— Search results Close "},"module-lib_TemplateEngine.html":{"id":"module-lib_TemplateEngine.html","title":"Module: lib/TemplateEngine","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: lib/TemplateEngine Main Template engine Since: 2010 Author: Christian Mayer Source: lib/TemplateEngine.js, line 21 Requires module:dependencies/jquery module:structure/pure module:config/structure_custom module:lib/TrickOMatic module:lib/PageHandler module:lib/PagePartsHandler module:lib/CometVisuClient module:lib/mockup/Client module:lib/EventHandler Ã— Search results Close "},"module-plugins_powerspectrum_structure_plugin.html":{"id":"module-plugins_powerspectrum_structure_plugin.html","title":"Module: plugins/powerspectrum/structure_plugin","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: plugins/powerspectrum/structure_plugin The powerspectrum plugin and widget creates a graph to show the powerspectral data that the Enertex Smartmeter can send on the KNX bus. Since: 0.10.0 Author: Christian Mayer Source: plugins/powerspectrum/structure_plugin.js, line 19 Requires module:structure/pure Ã— Search results Close "},"module-structure_pure.html":{"id":"module-structure_pure.html","title":"Module: structure/pure","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure This module defines the widgets for the CometVisu visualisation. Since: 2010 Author: &lt;p&gt;Christian Mayer [CometVisu at ChristianMayer dot de]&lt;/p&gt; Source: structure/pure/_common.js, line 21 Methods &lt;inner&gt; addCreator(name, object) Description Parameters: Name Type Description name object Source: structure/pure/_common.js, line 48 &lt;inner&gt; addPopup(name, object) Description Parameters: Name Type Description name object Source: structure/pure/_common.js, line 73 &lt;inner&gt; close(event) Description Parameters: Name Type Description event Source: structure/pure/_common.js, line 175 &lt;inner&gt; create(attributes) Description Parameters: Name Type Description attributes Source: structure/pure/_common.js, line 99 Returns: ret_val &lt;inner&gt; createDefaultWidget(widgetType, $element, path, flavour, type, updateFn, makeAddressListFn) Create a default widget to be filled by the creator afterwards.Note: the reciever of the returned string must add an closing element! Parameters: Name Type Description widgetType string of the widget type $element jQuery object of the XML element path string of the path ID flavour type updateFn The callback function for updates makeAddressListFn Source: structure/pure/_common.js, line 520 Returns: ret_val &lt;inner&gt; defaultButtonDownAnimation(path, actor) Create an action handling that shows a button press animation.Note: use this function when multiple action elements are used and thusbind_click_to_widget is not available. Parameters: Name Type Description path actor Source: structure/pure/_common.js, line 575 &lt;inner&gt; defaultButtonDownAnimationInheritAction(path, actor) Create an action handling that shows a button press animation.When the action is not set, it will be searched for - so that widgetswith bind_click_to_widget will also work. Parameters: Name Type Description path actor Source: structure/pure/_common.js, line 591 &lt;inner&gt; defaultButtonUpAnimation(path, actor) Create an action handling that shows a button unpress animation.Note: use this function when multiple action elements are used and thusbind_click_to_widget is not available. Parameters: Name Type Description path actor Source: structure/pure/_common.js, line 607 &lt;inner&gt; defaultButtonUpAnimationInheritAction(path, actor) Create an action handling that shows a button unpress animation.When the action is not set, it will be searched for - so that widgetswith bind_click_to_widget will also work. Parameters: Name Type Description path actor Source: structure/pure/_common.js, line 623 &lt;inner&gt; defaultUpdate(ga, data, passedElement, newVersion, path) ga: addressdata: the raw value from the buspassedElement: the element to update Parameters: Name Type Description ga data passedElement newVersion path Source: structure/pure/_common.js, line 296 Returns: value &lt;inner&gt; defaultUpdate3d(ev, data, passedElement) Description Parameters: Name Type Description ev data passedElement Source: structure/pure/_common.js, line 331 &lt;inner&gt; defaultValue2DOM(value, modifyFn) Method to handle all special cases for the value. The might come fromthe mapping where it can be quite complex as it can contain icons.value: the value that will be insertedmodifyFn: callback function that modifies the DOM Parameters: Name Type Description value modifyFn Source: structure/pure/_common.js, line 251 &lt;inner&gt; defaultValueHandling(ga, data, widgetData) Description Parameters: Name Type Description ga address data the raw value from the bus widgetData the data structure in the widget Source: structure/pure/_common.js, line 190 Returns: value &lt;inner&gt; extractLabel(label, flavour, labelClass, style) Description Parameters: Name Type Description label flavour labelClass style Source: structure/pure/_common.js, line 419 Returns: BinaryExpression &lt;inner&gt; extractLayout(layout, type) Description Parameters: Name Type Description layout type Source: structure/pure/_common.js, line 382 Returns: ret_val &lt;inner&gt; extractLayout3d(layout) Description Parameters: Name Type Description layout Source: structure/pure/_common.js, line 401 Returns: ret_val &lt;inner&gt; getCreator(name) Description Parameters: Name Type Description name Source: structure/pure/_common.js, line 58 Returns: MemberExpression &lt;inner&gt; getPopup(name) Description Parameters: Name Type Description name Source: structure/pure/_common.js, line 84 Returns: MemberExpression &lt;inner&gt; makeAddressList(element, handleVariant, id) this function extracts all addresses with attributes (JNK) elements. The first is a boolean that determins if the visu should listen for that address. The second is added as it is to the returned object. Parameters: Name Type Description element handleVariant is a callback function that returns an array of two id id / path to the widget Source: structure/pure/_common.js, line 447 Returns: address &lt;inner&gt; parseLayout(layout, defaultValues) Parse config file layout element and convert it to an object Parameters: Name Type Description layout defaultValues Source: structure/pure/_common.js, line 351 Returns: ret_val &lt;inner&gt; placementStrategy(anchor, popup, page, preference) Figure out best placement of popup.A preference can optionally be passed. The position is that of the numberson the numeric keypad. I.e. a value of &quot;6&quot; means centered above the anchor.A value of &quot;0&quot; means centered to the page Parameters: Name Type Description anchor popup page preference Source: structure/pure/_common.js, line 641 Returns: ObjectExpression &lt;inner&gt; setWidgetLayout(page, path) this function implements all widget layouts that are identical (JNK)implemented: rowspan, colspan Parameters: Name Type Description page path Source: structure/pure/_common.js, line 494 Returns: ret_val &lt;inner&gt; VisuDesign() This class defines all the building blocks for a Visu in the &quot;Pure&quot; design Source: structure/pure/_common.js, line 38 Ã— Search results Close "},"module-structure_pure_Audio.html":{"id":"module-structure_pure_Audio.html","title":"Module: structure/pure/Audio","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Audio The audio widget embeds an audio file, which can be automatically played by incoming data Since: 0.8.4 (2014) Author: Markus Damman Source: structure/pure/Audio.js, line 21 Example Default example for defining an audio widget in the configurationDefault example for defining an audio widget in the configuration &lt;audio id=&quot;audio_widget&quot; src=&quot;path/to/audio_file.mp3&quot;&gt; &lt;layout colspan=&quot;4&quot;/&gt; &lt;label&gt;Audio&lt;/label&gt; &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;read&quot;&gt;0/0/0&lt;/address&gt; &lt;/audio&gt; Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Audio.js, line 45 Returns: HTML code Type String &lt;inner&gt; update(address, value) Handles updates of incoming data for this widget Parameters: Name Type Description address String Source address of the incoming data value String Incoming data Source: structure/pure/Audio.js, line 82 Ã— Search results Close "},"module-structure_pure_Break.html":{"id":"module-structure_pure_Break.html","title":"Module: structure/pure/Break","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Break A break tag is used to start in new line for a grouped and thereby tidy display ofelements on one page. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Break.js, line 21 Example The break tag has no content &lt;break/&gt; Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Break.js, line 38 Returns: HTML code Type String Ã— Search results Close "},"module-structure_pure_DesignToggle.html":{"id":"module-structure_pure_DesignToggle.html","title":"Module: structure/pure/DesignToggle","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/DesignToggle Adds a button to toggle through the available designs Since: 0.5.3 (2010) Author: Christian Mayer Source: structure/pure/DesignToggle.js, line 21 Example &lt;designtoggle&gt; &lt;layout colspan=&quot;6&quot;/&gt; &lt;label&gt;Change Design&lt;/label&gt; &lt;/designtoggle&gt; Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Action performed when the widget got clicked Parameters: Name Type Description path String Internal path of the widget actor Element DOMElement isCanceled Boolean If true the action does nothing Source: structure/pure/DesignToggle.js, line 70 &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/DesignToggle.js, line 39 Returns: HTML code Type String &lt;inner&gt; getLocation() Wrapper for getting the window.location.href value Source: structure/pure/DesignToggle.js, line 107 Returns: URI of the page the browser is currently showing Type String &lt;inner&gt; setLocation(loc) Changes window.location.href to trigger a redirect Parameters: Name Type Description loc String URI of the location the browser should be redirected to Source: structure/pure/DesignToggle.js, line 117 Ã— Search results Close "},"module-structure_pure_Group.html":{"id":"module-structure_pure_Group.html","title":"Module: structure/pure/Group","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Group A group can be used to group a couple of widgets and optionally surround them with a border or name the group. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Group.js, line 21 Examples Group with border and nameGroup with border and name &lt;group name=&quot;Example Group&quot;&gt; &lt;layout colspan=&quot;6&quot;/&gt; &lt;text&gt;&lt;label&gt;Some Text&lt;/label&gt;&lt;/text&gt; &lt;switch&gt; &lt;layout colspan=&quot;3&quot;/&gt; &lt;label&gt;Switch&lt;/label&gt; &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; &lt;/switch&gt; &lt;info format=&quot;%.1f Â°C&quot;&gt; &lt;layout colspan=&quot;3&quot;/&gt; &lt;label&gt;Temperature&lt;/label&gt; &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/1&lt;/address&gt; &lt;/info&gt; &lt;/group&gt; Hidden Group: no border no nameHidden Group: no border no name &lt;group nowidget=&quot;true&quot;&gt; &lt;layout colspan=&quot;6&quot;/&gt; &lt;text&gt;&lt;label&gt;Some Text&lt;/label&gt;&lt;/text&gt; &lt;switch&gt; &lt;layout colspan=&quot;3&quot;/&gt; &lt;label&gt;Switch&lt;/label&gt; &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; &lt;/switch&gt; &lt;info format=&quot;%.1f Â°C&quot;&gt; &lt;layout colspan=&quot;3&quot;/&gt; &lt;label&gt;Temperature&lt;/label&gt; &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/1&lt;/address&gt; &lt;/info&gt; &lt;/group&gt; Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Action performed when the group got clicked. If a target is specified in the group attributesthe action will switch to the page defined by the target. Parameters: Name Type Description path String Internal path of the widget actor Element DOMElement isCanceled Boolean If true the action does nothing Source: structure/pure/Group.js, line 121 &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Group.js, line 79 Returns: HTML code Type String Ã— Search results Close "},"module-structure_pure_Image.html":{"id":"module-structure_pure_Image.html","title":"Module: structure/pure/Image","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Image Adds an image to your visualization. Using the auto-refresh setting this widget can be used e.g. to showa camera picture. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Image.js, line 21 Example &lt;image src=&quot;icon/CometVisu_orange.png&quot; width=&quot;45px&quot; height=&quot;32px&quot;&gt; &lt;layout colspan=&quot;2&quot;/&gt; &lt;/image&gt; Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Image.js, line 40 Returns: HTML code Type String Ã— Search results Close "},"module-structure_pure_ImageTrigger.html":{"id":"module-structure_pure_ImageTrigger.html","title":"Module: structure/pure/ImageTrigger","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/ImageTrigger Adds an image like the structure/pure/Image widget, but additionally the image can be changed by incomingdata and can send data to the backend by clicking on it.There modes to react on incoming data: type=&quot;show&quot;: Hides the image when incoming data == 0 type=&quot;select&quot;: Changes the image by appending the incoming data to the initial configured image source,or hide it when incoming data == 0 Example: &lt;imagetrigger src=&quot;icon/comet&quot; suffix=&quot;svg&quot; sendValue=&quot;clicked&quot; type=&quot;select&quot;&gt; &lt;address transform=&quot;DPT:16.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; &lt;/imagetrigger&gt;initially shows nothing. When the CometVisu receives the string '_icon' in address 0/0/0,the image icon/comet_opt_icon.svg is shown. When the CometVisu receives '0' on address 0/0/0,this image is hidden. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/ImageTrigger.js, line 21 Examples Image changed by incoming data 'blue'Image changed by incoming data 'grey' &lt;imagetrigger src=&quot;icon/CometVisu_&quot; suffix=&quot;png&quot; sendValue=&quot;clicked&quot; type=&quot;select&quot; width=&quot;45px&quot; height=&quot;32px&quot;&gt; &lt;layout colspan=&quot;1&quot;/&gt; &lt;address transform=&quot;DPT:16.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; &lt;/imagetrigger&gt; Disable layout width by settings it to '0', to have widget with == image width &lt;imagetrigger src=&quot;icon/CometVisu_orange&quot; suffix=&quot;png&quot; sendValue=&quot;clicked&quot; type=&quot;show&quot; width=&quot;45px&quot; height=&quot;32px&quot;&gt; &lt;layout colspan=&quot;0&quot;/&gt; &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; &lt;/imagetrigger&gt; Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Action performed when the image got clicked Parameters: Name Type Description path String Internal path of the widget actor Element DOMElement isCanceled Boolean If true the action does nothing Source: structure/pure/ImageTrigger.js, line 178 &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/ImageTrigger.js, line 76 Returns: HTML code Type String &lt;inner&gt; update(address, value) Handles updates of incoming data for this widget Parameters: Name Type Description address String Source address of the incoming data value String Incoming data Source: structure/pure/ImageTrigger.js, line 143 Ã— Search results Close "},"module-structure_pure_Include.html":{"id":"module-structure_pure_Include.html","title":"Module: structure/pure/Include","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Include Includes other configuration snippets. Note that this is no widget shown in your visualization it just givesyou the opportunity to split you configuration into multiple files. If you have a large configuration filesplitting it up might help to keep track of your configuration. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Include.js, line 21 Requires module:structure/pure/ Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Include.js, line 37 Returns: HTML code Type String Ã— Search results Close "},"module-structure_pure_Info.html":{"id":"module-structure_pure_Info.html","title":"Module: structure/pure/Info","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Info Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Info.js, line 21 Example Show temperature in degree celcius &lt;info format=&quot;%.1f Â°C&quot;&gt; &lt;label&gt;outside temperature&lt;/label&gt; &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/0&lt;/address&gt; &lt;/info&gt; Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Info.js, line 44 Returns: HTML code Type String &lt;inner&gt; update(address, value) Handles updates of incoming data for this widget Parameters: Name Type Description address String Source address of the incoming data value String Incoming data Source: structure/pure/Info.js, line 67 Ã— Search results Close "},"module-structure_pure_InfoAction.html":{"id":"module-structure_pure_InfoAction.html","title":"Module: structure/pure/InfoAction","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/InfoAction The infoaction widget is a combination of an info/text widget and an &quot;action&quot;-widget, e.g. switch or trigger. Use case: if you have a group of lights, you can show the number of lights currently switched onand control the whole group in one widget. Since: 0.10.0 (as widget), 0.9.2 (as plugin) Author: Tobias BrÃ¤utigam Source: structure/pure/InfoAction.js, line 21 Example Example combines an info widget to show the number of lights currently switched on, and an Switch to control them ... &lt;meta&gt; &lt;mappings&gt; &lt;mapping name=&quot;OnOff&quot;&gt; &lt;entry value=&quot;0&quot;&gt;Off&lt;/entry&gt; &lt;entry value=&quot;1&quot;&gt;On&lt;/entry&gt; &lt;/mapping&gt; &lt;/mappings&gt; &lt;stylings&gt; &lt;styling name=&quot;GreyGreen&quot;&gt; &lt;entry value=&quot;0&quot;&gt;grey&lt;/entry&gt; &lt;entry value=&quot;1&quot;&gt;green&lt;/entry&gt; &lt;/styling&gt; &lt;/stylings&gt; &lt;/meta&gt; ... &lt;infoaction&gt; &lt;layout colspan=&quot;4&quot;/&gt; &lt;label&gt;Lights&lt;/label&gt; &lt;widgetinfo&gt; &lt;info&gt; &lt;address transform=&quot;DPT:9.001&quot;&gt;0/0/0&lt;/address&gt; &lt;/info&gt; &lt;/widgetinfo&gt; &lt;widgetaction&gt; &lt;switch mapping=&quot;OnOff&quot; styling=&quot;GreyGreen&quot;&gt; &lt;layout colspan=&quot;3&quot;/&gt; &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/1&lt;/address&gt; &lt;/switch&gt; &lt;/widgetaction&gt; &lt;/infoaction&gt; Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the InfoAction widget Parameters: Name Type Description element path flavour type Source: structure/pure/InfoAction.js, line 73 Returns: String - HTML representation if the widget as string &lt;inner&gt; createWidget(isInfo, element, path, flavour, type) Creates the InfoAction widget Parameters: Name Type Description isInfo element path flavour type Source: structure/pure/InfoAction.js, line 87 Returns: String - HTML representation if the widget as string &lt;inner&gt; getWidgetElements(xmlElement, path, flavour, type) Description Parameters: Name Type Description xmlElement path flavour type Source: structure/pure/InfoAction.js, line 111 Returns: ret_val Ã— Search results Close "},"module-structure_pure_InfoTrigger.html":{"id":"module-structure_pure_InfoTrigger.html","title":"Module: structure/pure/InfoTrigger","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/InfoTrigger Since: 2012 Author: Christian Mayer Source: structure/pure/InfoTrigger.js, line 21 Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/InfoTrigger.js, line 127 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/InfoTrigger.js, line 31 Returns: BinaryExpression &lt;inner&gt; makeAddressListFn(src, transform, mode, variant) Description Parameters: Name Type Description src transform mode variant Source: structure/pure/InfoTrigger.js, line 44 Returns: ArrayExpression &lt;inner&gt; update(ga, d) Description Parameters: Name Type Description ga d Source: structure/pure/InfoTrigger.js, line 116 Ã— Search results Close "},"module-structure_pure_Line.html":{"id":"module-structure_pure_Line.html","title":"Module: structure/pure/Line","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Line A line tag is used to display a horizontal line in the browser to allow for a grouped and thereby tidy display ofelements on one page. To specify the width of the line an optional &lt;layout/&gt;-child can be added. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Line.js, line 21 Example A line tag which uses 50% of the screen size (6 of 12 available columns) &lt;line&gt; &lt;layout colspan=&quot;6&quot;/&gt; &lt;/line&gt; Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Line.js, line 40 Returns: HTML code Type String Ã— Search results Close "},"module-structure_pure_Multitrigger.html":{"id":"module-structure_pure_Multitrigger.html","title":"Module: structure/pure/Multitrigger","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Multitrigger TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/MultiTrigger.js, line 21 Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/MultiTrigger.js, line 144 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/MultiTrigger.js, line 32 Returns: BinaryExpression &lt;inner&gt; update(ga, d) Description Parameters: Name Type Description ga d Source: structure/pure/MultiTrigger.js, line 124 Ã— Search results Close "},"module-structure_pure_NavBar.html":{"id":"module-structure_pure_NavBar.html","title":"Module: structure/pure/NavBar","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/NavBar TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/NavBar.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; create(navbar, path, flavour, type) Description Parameters: Name Type Description navbar path flavour type Source: structure/pure/NavBar.js, line 42 Returns: Literal Ã— Search results Close "},"module-structure_pure_Page.html":{"id":"module-structure_pure_Page.html","title":"Module: structure/pure/Page","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Page TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/Page.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/Page.js, line 253 &lt;inner&gt; create(page, path, flavour, type) Description Parameters: Name Type Description page path flavour type Source: structure/pure/Page.js, line 36 Returns: ret_val &lt;inner&gt; createFinal() Description Source: structure/pure/Page.js, line 208 &lt;inner&gt; update(ga, data) Description Parameters: Name Type Description ga data Source: structure/pure/Page.js, line 215 Ã— Search results Close "},"module-structure_pure_PageJump.html":{"id":"module-structure_pure_PageJump.html","title":"Module: structure/pure/PageJump","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/PageJump TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/PageJump.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/PageJump.js, line 98 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/PageJump.js, line 34 Returns: BinaryExpression &lt;inner&gt; downaction(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/PageJump.js, line 86 Ã— Search results Close "},"module-structure_pure_PushButton.html":{"id":"module-structure_pure_PushButton.html","title":"Module: structure/pure/PushButton","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/PushButton TODO: complete docs Since: 2013 Source: structure/pure/PushButton.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/PushButton.js, line 89 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/PushButton.js, line 33 Returns: BinaryExpression &lt;inner&gt; downaction(path, actor) Description Parameters: Name Type Description path actor Source: structure/pure/PushButton.js, line 74 &lt;inner&gt; update(ga, d) Description Parameters: Name Type Description ga d Source: structure/pure/PushButton.js, line 59 Ã— Search results Close "},"module-structure_pure_Refresh.html":{"id":"module-structure_pure_Refresh.html","title":"Module: structure/pure/Refresh","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Refresh TODO: complete docs Since: 2014 Author: Christian Mayer Source: structure/pure/Refresh.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/Refresh.js, line 62 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Refresh.js, line 34 Returns: BinaryExpression Ã— Search results Close "},"module-structure_pure_Reload.html":{"id":"module-structure_pure_Reload.html","title":"Module: structure/pure/Reload","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Reload TODO: complete docs Since: 2014 Author: Christian Mayer Source: structure/pure/Reload.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Reload.js, line 34 Returns: Literal &lt;inner&gt; update(ga, d) Description Parameters: Name Type Description ga d Source: structure/pure/Reload.js, line 53 Ã— Search results Close "},"module-structure_pure_Rgb.html":{"id":"module-structure_pure_Rgb.html","title":"Module: structure/pure/Rgb","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Rgb TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/Rgb.js, line 21 Methods &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Rgb.js, line 33 Returns: ret_val &lt;inner&gt; rgb_handleVariant(src, transform, mode, variant) Description Parameters: Name Type Description src transform mode variant Source: structure/pure/Rgb.js, line 46 Returns: ArrayExpression &lt;inner&gt; update(ga, d) Description Parameters: Name Type Description ga d Source: structure/pure/Rgb.js, line 66 Ã— Search results Close "},"module-structure_pure_Slide.html":{"id":"module-structure_pure_Slide.html","title":"Module: structure/pure/Slide","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Slide TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/Slide.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Slide.js, line 55 Returns: BinaryExpression &lt;inner&gt; slideChange(event, ui) Delete the update thread and send the final value of the slider to the bus Parameters: Name Type Description event ui Source: structure/pure/Slide.js, line 208 &lt;inner&gt; slideStart(event, ui) Start a thread that regularily sends the silder position to the bus Parameters: Name Type Description event ui Source: structure/pure/Slide.js, line 177 &lt;inner&gt; slideUpdateValue(event, ui) Description Parameters: Name Type Description event ui Source: structure/pure/Slide.js, line 162 &lt;inner&gt; transformSlider(value, handle) Description Parameters: Name Type Description value handle Source: structure/pure/Slide.js, line 35 &lt;inner&gt; update(ga, d) Description Parameters: Name Type Description ga d Source: structure/pure/Slide.js, line 136 Ã— Search results Close "},"module-structure_pure_Switch.html":{"id":"module-structure_pure_Switch.html","title":"Module: structure/pure/Switch","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Switch The switch widget shows two states (e.g. ON and OFF) and can toggle between them. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Switch.js, line 21 Example Configuration example of a switch widget using mapping and stylingSwitch turned onSwitch turned off ... &lt;meta&gt; &lt;mappings&gt; &lt;mapping name=&quot;OnOff&quot;&gt; &lt;entry value=&quot;0&quot;&gt;O&lt;/entry&gt; &lt;entry value=&quot;1&quot;&gt;I&lt;/entry&gt; &lt;/mapping&gt; &lt;/mappings&gt; &lt;stylings&gt; &lt;styling name=&quot;GreyGreen&quot;&gt; &lt;entry value=&quot;0&quot;&gt;grey&lt;/entry&gt; &lt;entry value=&quot;1&quot;&gt;green&lt;/entry&gt; &lt;/styling&gt; &lt;/stylings&gt; &lt;/meta&gt; ... &lt;switch mapping=&quot;OnOff&quot; styling=&quot;GreyGreen&quot;&gt; &lt;layout colspan=&quot;3&quot;/&gt; &lt;label&gt;Switch&lt;/label&gt; &lt;address transform=&quot;DPT:1.001&quot; mode=&quot;readwrite&quot;&gt;0/0/0&lt;/address&gt; &lt;/switch&gt; Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Action performed when the switch got clicked Parameters: Name Type Description path String Internal path of the widget actor Element DOMElement isCanceled Boolean If true the action does nothing Source: structure/pure/Switch.js, line 107 &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Switch.js, line 64 Returns: HTML code Type String &lt;inner&gt; update(address, value) Handles updates of incoming data for this widget Parameters: Name Type Description address String Source address of the incoming data value String Incoming data Source: structure/pure/Switch.js, line 90 Ã— Search results Close "},"module-structure_pure_Text.html":{"id":"module-structure_pure_Text.html","title":"Module: structure/pure/Text","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Text The text-tag defines static (non-changing) text to be displayed on a page. The content of a &lt;label&gt; with free text. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Text.js, line 21 Example Configuration example of a centered text widget &lt;text align=&quot;center&quot;&gt; &lt;label&gt;Example text&lt;/label&gt; &lt;/text&gt; Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Text.js, line 40 Returns: HTML code Type String Ã— Search results Close "},"module-structure_pure_Toggle.html":{"id":"module-structure_pure_Toggle.html","title":"Module: structure/pure/Toggle","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Toggle TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/Toggle.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/Toggle.js, line 67 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Toggle.js, line 34 Returns: BinaryExpression &lt;inner&gt; update(ga, d) Description Parameters: Name Type Description ga d Source: structure/pure/Toggle.js, line 56 Ã— Search results Close "},"module-structure_pure_Trigger.html":{"id":"module-structure_pure_Trigger.html","title":"Module: structure/pure/Trigger","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Trigger TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/Trigger.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/Trigger.js, line 84 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Trigger.js, line 34 Returns: BinaryExpression &lt;inner&gt; makeAddressListFn(src, transform, mode, variant) Description Parameters: Name Type Description src transform mode variant Source: structure/pure/Trigger.js, line 48 Returns: ArrayExpression Ã— Search results Close "},"module-structure_pure_Unknown.html":{"id":"module-structure_pure_Unknown.html","title":"Module: structure/pure/Unknown","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Unknown Fallback widget shown when an unknown widget is defined in the configuration.You must not use this one directly. Since: 0.8.0 (2012) Author: Christian Mayer Source: structure/pure/Unknown.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Creates the widget HTML code Parameters: Name Type Description element Element DOM-Element path String internal path of the widget flavour String Flavour of the widget type String Page type (2d, 3d, ...) Source: structure/pure/Unknown.js, line 34 Returns: HTML code Type String Ã— Search results Close "},"module-structure_pure_UrlTrigger.html":{"id":"module-structure_pure_UrlTrigger.html","title":"Module: structure/pure/UrlTrigger","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/UrlTrigger TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/UrlTrigger.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; action(path, actor, isCanceled) Description Parameters: Name Type Description path actor isCanceled Source: structure/pure/UrlTrigger.js, line 85 &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/UrlTrigger.js, line 34 Returns: BinaryExpression Ã— Search results Close "},"module-structure_pure_Video.html":{"id":"module-structure_pure_Video.html","title":"Module: structure/pure/Video","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Video TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/Video.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Video.js, line 34 Returns: ret_val Ã— Search results Close "},"module-structure_pure_Web.html":{"id":"module-structure_pure_Web.html","title":"Module: structure/pure/Web","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/Web TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/Web.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/Web.js, line 34 Returns: BinaryExpression &lt;inner&gt; update(ga, data) Description Parameters: Name Type Description ga data Source: structure/pure/Web.js, line 98 Ã— Search results Close "},"module-structure_pure_WgPluginInfo.html":{"id":"module-structure_pure_WgPluginInfo.html","title":"Module: structure/pure/WgPluginInfo","body":" CometVisu Modules lib/CometVisuClientlib/TemplateEngineplugins/powerspectrum/structure_pluginstructure/purestructure/pure/Audiostructure/pure/Breakstructure/pure/DesignTogglestructure/pure/Groupstructure/pure/Imagestructure/pure/ImageTriggerstructure/pure/Includestructure/pure/Infostructure/pure/InfoActionstructure/pure/InfoTriggerstructure/pure/Linestructure/pure/Multitriggerstructure/pure/NavBarstructure/pure/Pagestructure/pure/PageJumpstructure/pure/PushButtonstructure/pure/Refreshstructure/pure/Reloadstructure/pure/Rgbstructure/pure/Slidestructure/pure/Switchstructure/pure/Textstructure/pure/Togglestructure/pure/Triggerstructure/pure/Unknownstructure/pure/UrlTriggerstructure/pure/Videostructure/pure/Webstructure/pure/WgPluginInfo Classes ~EventHandler~DispatcherFOOcometvisu-client Global debugfadeNavbargethandleReadinitializeNavbarsjOWMlistnavbarSetSizesubscribeupdatePagePartswrite Module: structure/pure/WgPluginInfo TODO: complete docs Since: 2012 Author: Christian Mayer Source: structure/pure/WgPluginInfo.js, line 21 Requires module:structure/pure Methods &lt;inner&gt; create(element, path, flavour, type) Description Parameters: Name Type Description element path flavour type Source: structure/pure/WgPluginInfo.js, line 34 Returns: BinaryExpression &lt;inner&gt; update(ga, d, passedElement) Description Parameters: Name Type Description ga d passedElement Source: structure/pure/WgPluginInfo.js, line 60 Ã— Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
