define(["_common"],function(e){var t=e.basicdesign;e.basicdesign.addCreator("pushbutton",{create:function(e,n,r,i){var s=$(e),o=t.createDefaultWidget("pushbutton",s,n,r,i,this.update);o.data({downValue:s.attr("downValue")||1,upValue:s.attr("upValue")||0});var u=$('<div class="actor switchUnpressed"><div class="value"></div></div>');o.append(u);var a=templateEngine.bindClickToWidget;o.data("bind_click_to_widget")&&(a=o.data("bind_click_to_widget")==="true");var f=a?o:u;return t.createDefaultButtonAction(f,u,this.downAction,this.upAction),t.defaultUpdate(undefined,undefined,o,!0),o},update:function(e,n){var r=$(this),i=r.find(".actor"),s=t.defaultUpdate(e,n,r,!0),o=templateEngine.map(r.data("upValue"),r.data("mapping"));i.removeClass(s==o?"switchPressed":"switchUnpressed"),i.addClass(s==o?"switchUnpressed":"switchPressed")},downAction:function(){var e=$(this),t=e.data();undefined===t.address&&(t=e.parent().data());for(var n in t.address){if(!(t.address[n][1]&2))continue;templateEngine.visu.write(n.substr(1),templateEngine.transformEncode(t.address[n][0],t.downValue))}},upAction:function(){var e=$(this),t=e.data();undefined===t.address&&(t=e.parent().data());for(var n in t.address){if(!(t.address[n][1]&2))continue;templateEngine.visu.write(n.substr(1),templateEngine.transformEncode(t.address[n][0],t.upValue))}}})});