{"version":3,"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Audio.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Break.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/ColorChooser.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/DesignToggle.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Group.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/ImageTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Info.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/InfoAction.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/InfoTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Line.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/MultiTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/NavBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/NotificationCenterBadge.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Page.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/PageJump.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/PageLink.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/PushButton.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Refresh.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Reload.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Rgb.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Roundbar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Slide.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Switch.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Text.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Toggle.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Trigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Unknown.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/UrlTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Video.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Web.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/WgPluginInfo.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/WidgetInfoAction.js"],"names":["qx","Class","define","extend","cv","ui","structure","AbstractWidget","include","common","Update","properties","src","check","nullable","id","width","height","autoplay","init","loop","thresholdValue","members","_getInnerDomString","style","this","getWidth","getHeight","isLoop","getId","getSrc","getActor","getDomElement","querySelector","_update","address","value","applyMapping","getThresholdValue","audioWidget","play","defer","statics","WidgetFactory","registerClass","pure","Audio","$$dbClassInfo","Bootstrap","executePendingDefers","AbstractBasicWidget","getDomString","Break","Operate","coord2sv","x","y","hue","radius","hue2angle","Math","PI","Sx","sin","Sy","cos","Wx","Wy","Bx","By","WBx","WBy","SBx","SBy","CBx","CBy","uv","util","Color","solve2d","u","min","max","v","abs","construct","props","_this","constructor","call","base","getBaseColors","__P_54_0","r","g","b","w","__P_54_1","LimitedRateUpdateAnimator","__P_54_2","setAnimationSpeed","__P_54_3","layout","ResizeHandler","states","addListener","__P_54_4","__P_54_5","Set","Object","entries","getAddress","map","variantInfo","__P_54_6","destruct","removeListenerById","__P_54_7","controls","baseColors","sendOnFinish","__P_54_8","__P_54_9","undefined","__P_54_10","__P_54_11","__P_54_12","__P_54_13","__P_54_14","__P_54_15","__P_54_16","placeholder","getFormat","self","retval","historicWidth","getLayout","colspan","getControls","split","forEach","control","parts","temperatures","rgbTmin","xy2sRGB","temperature2xy","rgbTmax","disp","c","round","join","colors","_onDomReady","_this2","ColorChooser","prototype","__P_54_17","Function","throttle","__P_54_18","trailing","querySelectorAll","actor","addEventListener","data","variantType","addressObj","showInvalidDataErrorMessage","message","locale","Manager","tr","transform","selector","variant","Config","testMode","console","error","toString","core","notifications","Router","dispatchMessage","Transform","decode","Number","isFinite","get","h","s","invCurve","curve","scale","Map","_typeof","Y","notKnown","_defineProperty","__P_54_19","isVisible","instant","copy","changeComponent","delta","setTo","newColor","actorStyle","actors","type","className","replace","window","getComputedStyle","sv_element","inner","handle","handle_hue","isLCh","classList","contains","handle_hueTop","parseFloat","getPropertyValue","handle_hueWidth","innerRadius","outerRadius","button","range","buttonWidth","marginLeft","borderRadius","angle","LCh","getComponent","WSt","C","WSl","top","L","left","background","hsv","_WSt","_WSl","_angle","_LCh","_r","_g","_b","_hsv","transformOrigin","ratioComponent","length","clipPath","handleEvent","event","relCoordX","relCoordY","actorType","currentTarget","boundingRect","getBoundingClientRect","computedStyle","__P_54_20","paddingLeft","__P_54_21","clientX","clientY","sv","distSqrd","pow","clearlyOnWheel","closeToInerior","closeToTriangleCorners","atan2","boxSize","_sv","ratio","document","buttons","removeEventListener","_type","_type2","_actor","_radius","_sv2","_boxSize","_sv3","getSendOnFinish","_this3","typeCategory","includes","sendToBackend","t","HasAnimatedButton","store","Json","io","rest","Client","getBaseUrl","ev","setAvailableDesigns","getData","availableDesigns","getDesign","_action","path","isCanceled","designs","getAvailableDesigns","oldDesign","textContent","newDesign","getItem","indexOf","URL","Location","getHref","regexp","RegExp","search","setHref","req","Uri","appendParamsToUrl","design","DesignToggle","HasChildren","noWidget","name","target","action","getTarget","TemplateEngine","getInstance","scrollToPage","getBubbles","stopPropagation","Group","hstyle","getAlign","container","getName","getChildrenDomString","getClasses","getStyle","Refresh","cropTop","cropBottom","widthFit","__P_55_0","imgStyle","getWidthFit","getCropTop","getCropBottom","bottom","__P_55_1","getPlaceholder","ResourceManager","toUri","parseUri","protocol","startsWith","handleUpdate","text","valueElem","getValueElement","display","setAttribute","_applyVisible","getRefresh","Image","updateType","suffix","sendValue","keys","parser","WidgetParser","extractLayout","getPageType","getUpdateType","__P_56_0","getSuffix","trim","imageChild","url","getSendValue","ImageTrigger","Info","anonymous","refine","InfoAction","HandleLongpress","downValue","shortDownValue","downLabel","upValue","shortUpValue","upLabel","isAbsolute","infoPosition","ret_val","actordown","getDownLabel","actorup","getUpLabel","actorinfo","getInfoPosition","getActors","initListeners","Registration","_onPointerDown","__P_57_0","element","parentNode","_onLongTap","__P_57_1","getCurrentTarget","isShort","isDown","getShortDownValue","getShortUpValue","getDownValue","getUpValue","bitMask","getIsAbsolute","bvalue","getBasicValue","getMin","getMax","getDownActor","getUpActor","getInfoActor","InfoTrigger","Line","showstatus","elementsPerLine","buttonConfiguration","mapping","getMapping","getElementsPerLine","config","getButtonConfiguration","sort","i","buttonConfig","label","mappedValue","defaultValueHandling","div","createElement","defaultValue2DOM","innerHTML","_processIncomingValue","applyTransform","children","index","Array","hasOwnProperty","isPressed","DeferredCall","remove","add","schedule","getActionValue","isAnonymous","MultiTrigger","scope","position","dynamic","visible","_navbarTop","_navbarLeft","_navbarRight","_navbarBottom","_touchX","_touchY","initializeNavbars","pos","elem","content","body","evt","touches","pPH","pagePartsHandler","navbars","Init","getApplication","getMobile","fadeVisible","composedPath","some","passive","enoughDistance","toRight","preventDefault","fadeNavbar","getGlobalPath","getPath","pop","getPosition","NavBar","Bus","subscribe","classes","i_right","setContainerClass","splice","counter","apply","hideWhenEmpty","__P_58_0","NotificationCenterBadge","center","NotificationCenter","getMessages","_onChangeCounter","_onChangeGlobalSeverity","disableBadge","_skipNextEvent","getType","toggleVisibility","__P_58_1","getSeverities","messages","isHideWhenEmpty","getCounter","removeListener","implement","IPage","__P_59_0","_onChangeVisible","parentPage","getParentPage","debug","tuple","property","defaultValue","charAt","toUpperCase","substr","bind","setInitialized","_initOnCreate","allPages","createFinal","unsubscribe","initialized","showTopNavigation","showFooter","showNavbarTop","showNavbarBottom","showNavbarLeft","showNavbarRight","backdropAlign","backdropType","linkVisible","size","backdrop","__P_59_1","__P_59_2","_applyNavbarVisibility","old","i_name","COLSPAN_CLASS","applyColumnWidths","getBackdrop","invalidateBackdrop","pageType","subpage","getFlavour","getSize","getBackdropAlign","getBackdropType","Page","ga","parseInt","list","Model","isWriteAddress","visu","write","encode","bindClickToWidget","activeScope","targetPath","_onScrollToPage","page_id","page","getInstanceById","model","getWidgetDataByElement","Tree","getParentWidget","pageJumps","markPageJumps","parentName","match","getTargetPath","getPageIdByPath","PageJump","wstyle","getWstyle","PageLink","addElementListener","_onPointerUp","off","PushButton","BasicUpdate","defaultUpdate","restart","reload","Reload","valElem","bg","Rgb","__P_60_0","coord","toFixed","createBarPath","startAngle","startArrowPoint","endAngle","endArrowPoint","getBBox","arguments","startArrowPointAngle","endArrowPointAngle","clockwise","rI","rIM","rM","rMO","rO","startInner","startMiddle","startOuter","centerInner","centerOuter","endInner","endMiddle","endOuter","startMiddleFlag","startEndFlag","endMiddleFlag","startMiddleDir","endMiddleDir","arc","start","end","flag","cw","Roundbar","rMax","isInside","a","rMiddle","uMiddle","lMiddle","dMiddle","d","l","createPointerPath","p","wx","wy","thickness","tx","ty","indicators","axisradius","axiswidth","axiscolor","ranges","minorradius","minorwidth","minorspacing","minorcolor","majorradius","majorwidth","majorposition","majorcolor","labels","labelstyle","arrowtype","spacing","overflowarrow","fontsize","textx","texty","textlength","textanchor","linespace","bboxgrow","currentRatioValue","targetRatioValue","__P_60_1","bboxAdd","bbox","setCurrentRatioValue","getIndicators","fill","setTargetRatioValue","getStart","e","getEnd","cntValues","svgMajor","svgMinor","svgLabels","svgRanges","svgIndicators","svgText","getAxisradius","getAxiswidth","sMax","eMax","indicator","startarrow","endarrow","BBox","getMinorwidth","getMinorspacing","rIn","getMinorradius","rOut","test","cnt","getMinorcolor","getMajorwidth","_rIn","getMajorradius","_rOut","getMajorposition","getMajorcolor","getLabelstyle","getLabels","labelnumber","alignmentBaseline","textAnchor","textAngle","orientation","_textAngle","labelid","$$user_path","align","getRanges","sRange","eRange","rRange","wRange","thisBBox","number","push","__P_60_2","showValue","getTexty","getTextanchor","getFontsize","getTextx","getLinespace","repeat","textDistribution","middle","textU","textD","getTextlength","html","getBboxgrow","getDebug","sectorPath","axisPath","stroke","getAxiscolor","getTargetRatioValue","tspan","from","getElementsByTagName","valueFormat","applyFormat","indicatorNumber","getElementsByClassName","targetAngle","getOverflowarrow","isBar","__P_61_0","__P_61_1","__P_61_2","__P_61_3","__P_61_4","__P_61_5","step","showInvalidValues","__P_61_6","__P_61_7","__P_61_8","__P_61_9","__P_61_10","Slide","__P_61_11","__P_61_12","__P_61_13","relaxDisplay","getStep","realValue","getShowInvalidValues","stepValue","floor","stepCount","factor","sign","setBasicValue","displayValue","setValue","applyStyling","replaceChildren","actorStyles","_disposeObjects","newRatio","newValue","onValue","offValue","getOffValue","getOnValue","Switch","Text","getNextMappedValue","Toggle","shortValue","Trigger","getShortThreshold","isShortDefault","getShortValue","set","$$type","unknownType","parentWidget","getUnknownType","Unknown","params","__P_62_0","getXhr","_applyUrl","setUrl","xhr","request","Xhr","method","accept","requestData","getParams","UrlTrigger","send","isAutoplay","video","pause","Video","frameborder","scrolling","webStyle","getFrameborder","getBackground","getScrolling","addr","iframe","refreshAction","getAttribute","Web","variable","__P_63_0","_applyVariable","_onSuccess","executeWhenDomFinished","getRequest","getResponse","getVariable","WgPluginInfo","childObjects","WidgetInfoAction"],"mappings":"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","sourcesContent":["/* Audio.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The audio widget embeds an audio file, which can be automatically played by incoming data\n *\n * @widgetexample <settings>\n *   <screenshot name=\"audio_example\">\n *    <caption>Default example for defining an audio widget in the configuration</caption>\n *    <data address=\"0/0/0\">1</data>\n *   </screenshot>\n * </settings>\n * <audio id=\"audio_widget\" src=\"path/to/audio_file.mp3\">\n *   <layout colspan=\"4\" />\n *   <label>Audio</label>\n *   <address transform=\"DPT:1.001\" mode=\"read\">0/0/0</address>\n * </audio>\n *\n *\n * @author Markus Damman\n * @since 0.8.4 (2014)\n */\n  qx.Class.define('cv.ui.structure.pure.Audio', {\n    extend: cv.ui.structure.AbstractWidget,\n\n    include: cv.ui.common.Update,\n\n    /*\n    ******************************************************\n      PROPERTIES\n    ******************************************************\n    */\n    properties: {\n      src: { check: 'String', nullable: true },\n      id: { check: 'String', nullable: true },\n      width: { check: 'String', nullable: true },\n      height: { check: 'String', nullable: true },\n      autoplay: { check: 'Boolean', init: false },\n      loop: { check: 'Boolean', init: false },\n      thresholdValue: { check: 'Number', init: 1 }\n    },\n\n    /*\n    ******************************************************\n      MEMBERS\n    ******************************************************\n    */\n    members: {\n\n      // overridden\n      _getInnerDomString: function () {\n        // create the main structure\n        // create the actor\n        let style = '';\n        if (this.getWidth()) {\n style += 'width:' + this.getWidth() + ';'; \n}\n        if (this.getHeight()) {\n style += 'height:' + this.getHeight() + ';'; \n}\n        if (style !== '') {\n style = 'style=\"' + style + '\"'; \n}\n        const autoplay = (this.isAutoplay()) ? ' autoplay ' : '';\n        const loop = (this.isLoop()) ? ' loop ' : '';\n        return '<div class=\"actor\"><audio id=\"' + this.getId() + '\" ' + autoplay + loop + style + ' controls> <source src=\"' + this.getSrc()+ '\" > </audio> </div>';\n      },\n\n      // overridden\n      getActor: function() {\n        return this.getDomElement().querySelector('.actor audio');\n      },\n\n      /**\n       * Handles updates of incoming data for this widget\n       *\n       * @param address {String} Source address of the incoming data\n       * @param value {String} Incoming data\n       */\n      _update: function (address, value) {\n        const on = this.applyMapping(this.getThresholdValue());\n        if (value >= on) {\n          const audioWidget = this.getActor();\n          if (audioWidget.paused === true) {\n            audioWidget.play();\n          }\n        }\n      }\n    },\n\n    defer: function(statics) {\n      cv.ui.structure.WidgetFactory.registerClass('audio', statics);\n    }\n  });\n","/* Break.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A break tag is used to start in new line for a grouped and thereby tidy display of\n * elements on one page.\n *\n * <pre class=\"sunlight-highlight-xml\">\n * &lt;break/&gt;\n * </pre>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Break', {\n  extend: cv.ui.structure.AbstractBasicWidget,\n\n  /*\n   ******************************************************\n     MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    getDomString: function () {\n      return '<br/>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('break', statics);\n  }\n});\n","/* ColorChooser.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The ColorChooser let you select and display a color, e.g. for lighting effects.\n * It supports a RGB light source with red, green and blue light components as well\n * as a RGBW light source that also has a white channel.\n *\n * @widgetexample\n * <settings>\n *      <screenshot name=\"colorchooser_example\">\n *          <caption>ColorChooser, simple example</caption>\n *      </screenshot>\n * </settings>\n * <colorchooser>\n *   <layout colspan=\"6\" rowspan=\"4\"/>\n *   <label>RGB kitchen</label>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"r\">1/2/59</address>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"g\">1/2/60</address>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"b\">1/2/61</address>\n * </colorchooser>\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.ColorChooser', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Calculate the saturation and value from (x,y) relative widget coordinates\n     * based on a centered SV-triangle.\n     * @param x position for the calculation\n     * @param y position for the calculation\n     * @param hue value for the orientation of the triangle\n     * @param radius (outside) radius of the triangle\n     */\n    coord2sv: function(x, y, hue, radius) {\n      const hue2angle = 2 * Math.PI;\n      // coordinates of the triangle corners\n      const Sx = 0.5 - Math.sin(hue2angle * (-hue)) * radius; // 100% saturation\n      const Sy = 0.5 - Math.cos(hue2angle * (-hue)) * radius;\n      const Wx = 0.5 - Math.sin(hue2angle * (2/3-hue)) * radius; // 100% white\n      const Wy = 0.5 - Math.cos(hue2angle * (2/3-hue)) * radius;\n      const Bx = 0.5 - Math.sin(hue2angle * (1/3-hue)) * radius; // 100% black\n      const By = 0.5 - Math.cos(hue2angle * (1/3-hue)) * radius;\n      // differences to determine (u,v) coordinates of (x,y)\n      const WBx = Wx - Bx;\n      const WBy = Wy - By;\n      const SBx = Sx - Bx;\n      const SBy = Sy - By;\n      const CBx = x - Bx;\n      const CBy = y - By;\n      const uv = cv.util.Color.solve2d(WBx, WBy, SBx, SBy, CBx, CBy);\n      const u = Math.min(Math.max(0, uv[0]), 1);\n      const v = Math.min(Math.max(0, uv[1]), 1);\n      // convert (u,v) to S and V\n      const value = u + v;\n      const saturation = Math.abs(value) < 1e-3 ? 0 : v/value;\n      return [saturation, value];\n    }\n  },\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.base(arguments, props);\n\n    const base = this.getBaseColors();\n    this.__color = new cv.util.Color(base.r, base.g, base.b, base.w);\n    this.__animator = new cv.util.LimitedRateUpdateAnimator(this.__updateHandlePosition, this);\n    this.__animator.setAnimationSpeed(100, 0.5);\n    this.__pageSizeListener = cv.ui.layout.ResizeHandler.states.addListener('changePageSizeInvalid', () => {\n      this.__invalidateScreensize();\n    });\n    this.__components = new Set(Object.entries(this.getAddress()).map(v => v[1].variantInfo));\n    this.__lastBusValue = {};\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    cv.ui.layout.ResizeHandler.states.removeListenerById(this.__pageSizeListener);\n    this.__pageSizeListener = null;\n    this.__button = null;\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    controls: {\n      check: 'String'\n    },\n    baseColors: {\n      check: 'Object'\n    },\n    sendOnFinish: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __mode: '',\n    __colorOld: undefined,      // the color where the animation started\n    __colorCurrent: undefined,  // the current color of the running animation\n    __color: undefined,         // the current color of the widget, also the target for the animation\n    __lastBusValue: undefined,  // initialize with empty object in the constructor to prevent object being shared between instances\n    __animator: null,\n    __button: undefined, // cache for DOM element\n    __range: undefined,  // cache for DOM element\n    __actors: undefined,\n    __pageSizeListener: undefined,\n    __components: undefined, // set of all color components required to send\n    __inDrag: false,       // is the handle currently dragged?\n    __coordMin: undefined, // minimal screen coordinate of slider\n    __Tmin: 2000,   // minimal color temperature to show in slider\n    __Tmax: 12500,  // maximal color temperature to show in slider\n\n    // overridden\n    _getInnerDomString: function () {\n      const placeholder = this.getFormat() === '' ? '' : '-';\n      const self = this;\n      let retval = '';\n      const historicWidth = this.getLayout().colspan === undefined ? ' style=\"width:195px\"' : '';\n      let controls = this.getControls().split(';');\n      if (controls[0] === '') {\n        controls[0] = 'box';\n      }\n      controls.forEach(function(control) {\n        switch (control) {\n          case 'box':\n          case 'LCh-box': {\n            let hue_type = control === 'box' ? 'hsv_hue' : 'lch_hue';\n            retval += '<div class=\"actor cc_box\"><div class=\"hue ' + hue_type;\n            retval += '\"></div><div class=\"handle_hue\"></div><div class=\"sv_box\"><div class=\"inner\"></div><div class=\"handle\"></div></div></div>';\n            break;\n          }\n\n          case 'triangle':\n          case 'LCh-triangle': {\n            let hue_type = control === 'triangle' ? 'hsv_hue' : 'lch_hue';\n            retval += '<div class=\"actor cc_wheel\"><div class=\"hue ' + hue_type;\n            retval += '\"></div><div class=\"sv_triangle\"><div class=\"inner\"></div><div class=\"handle_hue\"></div><div class=\"handle\"></div></div></div>';\n            break;\n          }\n\n          case 'RGB-r':\n          case 'RGB-g':\n          case 'RGB-b':\n          case 'RGBW-r':\n          case 'RGBW-g':\n          case 'RGBW-b':\n          case 'RGBW-w':\n          case 'h':\n          case 's':\n          case 'v':\n          case 'LCh-L':\n          case 'LCh-C':\n          case 'LCh-h':\n          case 'Y':\n            retval += '<div class=\"actor cc_' + control + ` ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n              <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">`+placeholder+`</button>\n              <div class=\"ui-slider-range\" style=\"margin-left: 0px; clip-path: inset(0 100% 0 0);\"></div>\n            </div>`;\n            break;\n\n          default: {\n            let parts = control.split(':');\n            if (parts[0] === 'T') {\n              const temperatures = (parts[1] || '-').split('-');\n              self.__Tmin = Math.max(1667, Math.min(temperatures[0] || 2500, 25000));\n              self.__Tmax = Math.max(1667, Math.min(temperatures[1] || 9000, 25000));\n              const rgbTmin = cv.util.Color.xy2sRGB(cv.util.Color.temperature2xy(self.__Tmin));\n              const rgbTmax = cv.util.Color.xy2sRGB(cv.util.Color.temperature2xy(self.__Tmax));\n              const disp = c => [Math.round(255 * c.r), Math.round(255 * c.g), Math.round(255 * c.b)].join(',');\n              const colors = 'rgb(' + disp(rgbTmin) + '), rgb(' + disp(rgbTmax) + ')';\n\n              retval += `<div class=\"actor cc_T ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n                <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">` + placeholder + `</button>\n                <div class=\"ui-slider-range\" style=\"margin-left: 0px; clip-path: inset(0 100% 0 0);background: linear-gradient(90deg, ` + colors + `);\"></div>\n              </div>`;\n            }\n          }\n        }\n      });\n      return '<div class=\"actors\"'+historicWidth+'>' + retval + '</div>';\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n\n      this.__throttled = cv.util.Function.throttle(this.__onChangeValue, 250, {trailing: true}, this);\n\n      this.getDomElement().querySelectorAll('.actor').forEach(actor => actor.addEventListener('pointerdown', this));\n    },\n\n    _update: function (address, data) {\n      const addressObj = this.getAddress()[address];\n      const showInvalidDataErrorMessage = function () {\n        const message = qx.locale.Manager.tr(\n          'Updating ColorChooser with invalid data<br/>Address: \"%1\"<br/>transform: \"%2\"<br/>selector: \"%3\"<br/>variant: \"%4\"<br/>data: \"%5\"',\n          address,\n          addressObj.transform,\n          addressObj.selector,\n          addressObj.variant,\n          data\n        );\n        if (cv.Config.testMode === true) {\n          // eslint-disable-next-line no-console\n          console.error(message.toString());\n        }\n        cv.core.notifications.Router.dispatchMessage('cv.config.error', {message});\n      };\n\n      const transform = addressObj.transform;\n      let variant = addressObj.variantInfo;\n\n      let variantType;\n      let value = cv.Transform.decode(addressObj, data);\n      let base;\n\n      switch (variant) {\n        case 'h':\n        case 's':\n        case 'v':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value /= 100;\n          variantType = 'hsv-single';\n          break;\n\n        case 'hsv':\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = { h: value.get('h')/360, s: value.get('s')/100, v: value.get('v')/100 };\n          variantType = 'hsv';\n          break;\n\n        case 'RGB-r':\n        case 'RGB-g':\n        case 'RGB-b':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          base = this.getBaseColors()[variant.split('-')[1]];\n          value = cv.util.Color.invCurve(value, base.curve, base.scale);\n          variantType = 'rgb-single';\n          break;\n\n        case 'rgb':\n          base = this.getBaseColors();\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = {\n            r: cv.util.Color.invCurve(value.get('r'), base.r.curve, base.r.scale),\n            g: cv.util.Color.invCurve(value.get('g'), base.g.curve, base.g.scale),\n            b: cv.util.Color.invCurve(value.get('b'), base.b.curve, base.b.scale)\n          };\n          variantType = 'rgb';\n          break;\n\n        case 'RGBW-r':\n        case 'RGBW-g':\n        case 'RGBW-b':\n        case 'RGBW-w':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          base = this.getBaseColors()[variant.split('-')[1]];\n          value = cv.util.Color.invCurve(value, base.curve, base.scale);\n          variantType = 'rgbw-single';\n          break;\n\n        case 'rgbw':\n          base = this.getBaseColors();\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = {\n            r: cv.util.Color.invCurve(value.get('r'), base.r.curve, base.r.scale),\n            g: cv.util.Color.invCurve(value.get('g'), base.g.curve, base.g.scale),\n            b: cv.util.Color.invCurve(value.get('b'), base.b.curve, base.b.scale),\n            w: cv.util.Color.invCurve(value.get('w'), base.w.curve, base.w.scale)\n          };\n          variantType = 'rgbw';\n          break;\n\n        case 'x':\n        case 'y':\n          variantType = 'xyY';\n          break;\n\n        case 'Y':\n          if (value instanceof Map && value.get('YValid') !== false) {\n            value = value.get('Y');\n          } else if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n\n        case 'xy':\n          if (value instanceof Map && value.get('cValid') !== false) {\n            value = { x: value.get('x'), y: value.get('y') };\n          } else if (!(typeof value === 'object' && 'x' in value && 'y' in value)) {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n\n        case 'xyY':\n          if (value instanceof Map) {\n            variant = (value.get('cValid') !== false ? 'xy' : '') + (value.get('YValid') !== false ? 'Y' : '');\n            value = {\n              x: value.get('x'),\n              y: value.get('y'),\n              Y: value.get('Y')\n            };\n            if (variant === '') {\n              return; // no valid data in the value\n            }\n          } else {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n      }\n\n      if (this.__inDrag || (this.__lastBusValue[variantType] && this.__lastBusValue[variantType][variant] && this.__lastBusValue[variantType][variant][transform] === data)) {\n        // slider in use -> ignore value from bus\n        // internal state unchanged -> also do nothing\n        return;\n      }\n      const notKnown = this.__lastBusValue[variantType] === undefined;\n      if (notKnown) {\n        this.__lastBusValue[variantType] = {};\n      }\n\n      // forget all other transforms as they might not be valid anymore\n      this.__lastBusValue = {[variantType]: this.__lastBusValue[variantType]};\n      this.__lastBusValue[variantType][variant] = {[transform]: data};\n\n      // animate when visible, otherwise jump to the target value\n      this.__setSliderTo(value, variant, !this.isVisible() || notKnown);\n    },\n\n    /**\n     * The the internal slider state and its handle and displayed value\n     * @param {number} value The new value\n     * @param {string} variant The color component to change\n     * @param {boolean} instant Animate or instant change\n     * @private\n     */\n    __setSliderTo: function(value, variant, instant) {\n      this.__colorOld = this.__colorCurrent === undefined ? this.__color.copy() : this.__colorCurrent.copy();\n      this.__color.changeComponent(variant, value);\n      instant = instant || this.__color.delta(this.__colorOld) < 0.5;\n      if (!instant) {\n        this.__animator.setTo(this.__colorOld, true, false);\n      }\n      this.__animator.setTo(this.__color, instant);\n    },\n\n    __updateHandlePosition: function (newColor) {\n      // check cache\n      if (this.__actors === undefined) {\n        let actors = {};\n        let actorStyle;\n        this.getDomElement().querySelectorAll('.actor').forEach(function (actor) {\n          let type = actor.className.replace(/.*cc_([^ ]*).*/, '$1');\n          switch (type) {\n            case 'box':\n            case 'wheel': {\n              actorStyle = window.getComputedStyle(actor);\n              let sv_element = type === 'box' ? actor.querySelector('.sv_box') : actor.querySelector('.sv_triangle');\n              let inner = sv_element.querySelector('.inner');\n              let handle = actor.querySelector('.handle');\n              let handle_hue = actor.querySelector('.handle_hue');\n              let hue = actor.querySelector('.hue');\n              actors[type] = {\n                isLCh: hue.classList.contains('lch_hue'),\n                sv_element: sv_element,\n                inner: inner,\n                handle: handle,\n                handle_hue: handle_hue,\n                handle_hueTop: parseFloat(window.getComputedStyle(handle_hue).getPropertyValue('top')),\n                handle_hueWidth: parseFloat(window.getComputedStyle(handle_hue).getPropertyValue('width')),\n                width: parseFloat(actorStyle.getPropertyValue('width')),\n                height: parseFloat(actorStyle.getPropertyValue('padding-top')),\n                innerRadius: parseFloat(window.getComputedStyle(sv_element).getPropertyValue('width')),\n                outerRadius: parseFloat(window.getComputedStyle(hue).getPropertyValue('width'))\n              };\n              break;\n            }\n\n            default: {\n              actorStyle = window.getComputedStyle(actor);\n              let button = actor.querySelector('button');\n              let range = actor.querySelector('.ui-slider-range');\n              actors[type] = {\n                button: button,\n                range: range,\n                width: parseFloat(actorStyle.getPropertyValue('width')),\n                buttonWidth: parseFloat(window.getComputedStyle(button).getPropertyValue('width'))\n              };\n              range.style.marginLeft = '-' + actorStyle.getPropertyValue('padding-left');\n              range.style.borderRadius = actorStyle.getPropertyValue('border-radius');\n            }\n          }\n        });\n        this.__actors = actors;\n      }\n\n      this.__colorCurrent = newColor;\n      // move handles\n      for (let type in this.__actors) {\n        let actor = this.__actors[type];\n        if (type === 'wheel') {\n          const Bt = 75;\n          const St = 0;\n          const Wt = 75;\n          const Bl = 50-85/2;\n          const Sl = 50;\n          const Wl = 50+85/2;\n          let angle;\n          if (actor.isLCh) {\n            let LCh = this.__colorCurrent.getComponent('LCh');\n            let r = cv.util.Color.curve(LCh.h, [246, 255,  46,   0, 246], 1);\n            let g = cv.util.Color.curve(LCh.h, [ 27, 224, 255, 136,  27], 1);\n            let b = cv.util.Color.curve(LCh.h, [136,  32, 224, 245, 136], 1);\n            angle = (LCh.h*360)+'deg';\n            const WSt = LCh.C*St + (1-LCh.C)*Wt;\n            const WSl = LCh.C*Sl + (1-LCh.C)*Wl;\n            actor.handle.style.top  = (LCh.L*WSt + (1-LCh.L)*Bt) + '%';\n            actor.handle.style.left = (LCh.L*WSl + (1-LCh.L)*Bl) + '%';\n            actor.inner.style.background = 'linear-gradient(210deg, transparent 45%, black 90%),linear-gradient(150deg, transparent 45%, white 90%),rgb('+[r, g, b].join(',')+')';\n          } else {\n            let hsv = this.__colorCurrent.getComponent('hsv');\n            angle = (hsv.h*360)+'deg';\n            const WSt = hsv.s*St + (1-hsv.s)*Wt;\n            const WSl = hsv.s*Sl + (1-hsv.s)*Wl;\n            actor.handle.style.top  = (hsv.v*WSt + (1-hsv.v)*Bt) + '%';\n            actor.handle.style.left = (hsv.v*WSl + (1-hsv.v)*Bl) + '%';\n            actor.inner.style.background = 'linear-gradient(210deg, transparent 45%, black 90%),linear-gradient(150deg, transparent 45%, white 90%),hsl('+angle+' 100% 50%)';\n          }\n          actor.sv_element.style.transform = 'rotate('+angle+')';\n        } else if (type === 'box') {\n          let angle;\n          if (actor.isLCh) {\n            let LCh = this.__colorCurrent.getComponent('LCh');\n            let r = cv.util.Color.curve(LCh.h, [246, 255,  46,   0, 246], 1);\n            let g = cv.util.Color.curve(LCh.h, [ 27, 224, 255, 136,  27], 1);\n            let b = cv.util.Color.curve(LCh.h, [136,  32, 224, 245, 136], 1);\n            angle = (LCh.h*360)+'deg';\n            actor.handle.style.top = (1-LCh.L) * 100 + '%';\n            actor.handle.style.left = (1-LCh.C) * 100 + '%';\n            actor.inner.style.background = 'linear-gradient(0deg, black 0%, transparent 50%, white 100%), linear-gradient(90deg,rgb('+[r, g, b].join(',')+'), #808080 100%)';\n          } else {\n            let hsv = this.__colorCurrent.getComponent('hsv');\n            angle = (hsv.h*360)+'deg';\n            actor.handle.style.top = (1-hsv.v) * 100 + '%';\n            actor.handle.style.left = (1-hsv.s) * 100 + '%';\n            actor.inner.style.background = 'linear-gradient(0deg, black 0%, transparent 50%, white 100%), linear-gradient(90deg,hsl('+angle+' 100% 50%), #808080 100%)';\n          }\n          actor.handle_hue.style.transform = 'rotate('+angle+')';\n          actor.handle_hue.style.transformOrigin = actor.handle_hueWidth/2 + 'px '+(actor.width/2 - actor.handle_hueTop)+'px'; //calc(195px / 2 - 3px)';\n        } else {\n          let ratioComponent = this.__colorCurrent.getComponent(type);\n          if (type === 'T') {\n            ratioComponent = (ratioComponent - this.__Tmin)/(this.__Tmax - this.__Tmin);\n          }\n          let length = Math.max(0, Math.min(ratioComponent, 1)) * actor.width;\n          actor.button.style.transform = 'translate3d(' + (length-actor.buttonWidth/2) + 'px, 0px, 0px)';\n          actor.range.style.clipPath = 'inset(0 ' + (1-ratioComponent)*100 + '% 0 0)';\n        }\n      }\n    },\n\n    __invalidateScreensize: function () {\n      this.__actors = undefined; // invalidate cached values\n      this.__animator.setTo(this.__color, true /* tmp */);\n    },\n\n    handleEvent: function (event) {\n      let relCoordX = 0;\n      let relCoordY = 0;\n      let actor;\n\n      switch (event.type) {\n        case 'pointerdown': {\n          let actorType = event.currentTarget.className.replace(/.*cc_([^ ]*).*/, '$1');\n          actor = this.__actors[actorType];\n          let boundingRect = event.currentTarget.getBoundingClientRect();\n          let computedStyle = window.getComputedStyle(event.currentTarget);\n          this.__coordMinX = boundingRect.left + parseFloat(computedStyle.paddingLeft);\n          this.__coordMinY = boundingRect.top;\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          if (actorType === 'wheel') {\n            let radius = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            let sv = cv.ui.structure.pure.ColorChooser.coord2sv(relCoordX, relCoordY, this.__color.getComponent(actor.isLCh ? 'LCh' : 'hsv').h, radius);\n            let distSqrd = (relCoordX - 0.5)**2 + (relCoordY - 0.5)**2;\n            if (distSqrd < (0.5*1.07)**2) { // ignore clicks outside of the wheel, with 7% safety margin on the outside\n              const clearlyOnWheel = (radius * 1.10)**2 < distSqrd; // with 10% safety margin to the interior triangle\n              const closeToInerior = radius**2 < distSqrd && !clearlyOnWheel;\n              const closeToTriangleCorners = (sv[1] < 0.01) || (sv[0] < 0.01 && sv[1] > 0.99) || (sv[0] > 0.99 && sv[1] > 0.99);\n              if (clearlyOnWheel || (closeToInerior && !closeToTriangleCorners)) {\n                this.__mode = 'wheel_h';\n                this.__color.changeComponent(actor.isLCh ? 'LCh-h' : 'h', 0.5 + Math.atan2(-relCoordX + 0.5, relCoordY - 0.5) / 2 / Math.PI);\n                this.__inDrag = true;\n              } else {\n                this.__mode = 'wheel_sv';\n                this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', sv);\n                this.__inDrag = true;\n              }\n            }\n          } else if (actorType === 'box') {\n            let boxSize = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            let x = relCoordX - 0.5;\n            let y = relCoordY - 0.5;\n            let sv = [-x / boxSize / 2 + 0.5, -y / boxSize / 2 + 0.5];\n            if ((Math.abs(x) < boxSize) && (Math.abs(y) < boxSize)) {\n              this.__mode = 'box_sv';\n              this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', sv);\n              this.__inDrag = true;\n            } else {\n              this.__mode = 'box_h';\n              this.__color.changeComponent(actor.isLCh ? 'LCh-h' : 'h', 0.5 + Math.atan2(-x, y) / 2 / Math.PI);\n              this.__inDrag = true;\n            }\n          } else {\n            let ratio = relCoordX;\n            if (actorType === 'T') {\n              ratio = this.__Tmin + ratio * (this.__Tmax - this.__Tmin);\n            }\n            this.__mode = actorType;\n            this.__color.changeComponent(actorType, ratio);\n            this.__inDrag = true;\n          }\n          if (this.__inDrag) {\n            document.addEventListener('pointermove', this);\n            document.addEventListener('pointerup', this);\n          } else {\n            this.__mode = undefined;\n          }\n          break;\n        }\n\n        case 'pointermove': {\n          if (!this.__inDrag) {\n            return;\n          }\n          if (event.buttons === 0) { // move with no button could only happen during debug sessions\n            this.__inDrag = false;\n            document.removeEventListener('pointermove', this);\n            document.removeEventListener('pointerup', this);\n          }\n          let type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n          actor = this.__actors[type];\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          break;\n        }\n\n        case 'pointerup': {\n          this.__inDrag = false;\n          document.removeEventListener('pointermove', this);\n          document.removeEventListener('pointerup', this);\n          const type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n          actor = this.__actors[type];\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          break;\n        }\n      }\n\n      if (event.type !== 'pointerdown') {\n        let type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n        let actor = this.__actors[type];\n        switch (this.__mode) {\n          case 'wheel_sv': {\n            const radius = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            const sv = cv.ui.structure.pure.ColorChooser.coord2sv(relCoordX, relCoordY, this.__color.getComponent(actor.isLCh ? 'LCh' : 'hsv').h, radius);\n            this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', [Math.min(Math.max(sv[0], 0), 1), Math.min(Math.max(sv[1], 0), 1)]);\n            break;\n          }\n          case 'box_sv': {\n            const boxSize = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            const x = relCoordX - 0.5;\n            const y = relCoordY - 0.5;\n            const sv = [-x / boxSize / 2 + 0.5, -y / boxSize / 2 + 0.5];\n            this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', [Math.min(Math.max(sv[0], 0), 1), Math.min(Math.max(sv[1], 0), 1)]);\n            break;\n          }\n          case 'wheel_h':\n          case 'box_h':\n            this.__color.changeComponent(actor.isLCh?'LCh-h':'h', 0.5 + Math.atan2(-relCoordX + 0.5, relCoordY - 0.5) / 2 / Math.PI);\n            break;\n          case 'T':\n            this.__color.changeComponent('T', this.__Tmin + Math.max(0, Math.min(relCoordX, 1)) * (this.__Tmax - this.__Tmin));\n            break;\n          default:\n            this.__color.changeComponent(this.__mode, relCoordX);\n        }\n      }\n      this.__animator.setTo(this.__color, true);\n      if (!this.getSendOnFinish() || event.type === 'pointerup') {\n        this.__throttled.call();\n      }\n    },\n\n    __onChangeValue: function() {\n      this.__components.forEach(type => {\n        let value = this.__color.getComponent(['xyY', 'x', 'y'].includes(type) ? 'xy' : type);\n        let typeCategory;\n        let base;\n\n        switch (type) {\n          case 'h':\n            value *= 360;\n            typeCategory = 'hsv-single';\n            break;\n\n          case 's':\n          case 'v':\n            value *= 100;\n            typeCategory = 'hsv-single';\n            break;\n\n          case 'hsv':\n            value = new Map([['h', value.h*360], ['s', value.s*100], ['v', value.v*100]]);\n            typeCategory = 'hsv';\n            break;\n\n          case 'RGB-r':\n          case 'RGB-g':\n          case 'RGB-b':\n            base = this.getBaseColors()[type.split('-')[1]];\n            value = cv.util.Color.curve(value, base.curve, base.scale);\n            typeCategory = 'rgb-single';\n            break;\n\n          case 'RGBW-r':\n          case 'RGBW-g':\n          case 'RGBW-b':\n          case 'RGBW-w':\n            base = this.getBaseColors()[type.split('-')[1]];\n            value = cv.util.Color.curve(value, base.curve, base.scale);\n            typeCategory = 'rgbw-single';\n            break;\n\n          case 'rgb':\n            base = this.getBaseColors();\n            value = new Map([\n              ['r', cv.util.Color.curve(value.r, base.r.curve, base.r.scale)],\n              ['g', cv.util.Color.curve(value.g, base.g.curve, base.g.scale)],\n              ['b', cv.util.Color.curve(value.b, base.b.curve, base.b.scale)]\n            ]);\n            typeCategory = 'rgb';\n            break;\n\n          case 'rgbw':\n            base = this.getBaseColors();\n            value = new Map([\n              ['r', cv.util.Color.curve(value.r, base.r.curve, base.r.scale)],\n              ['g', cv.util.Color.curve(value.g, base.g.curve, base.g.scale)],\n              ['b', cv.util.Color.curve(value.b, base.b.curve, base.b.scale)],\n              ['w', cv.util.Color.curve(value.w, base.w.curve, base.w.scale)]\n            ]);\n            typeCategory = 'rgbw';\n            break;\n\n          case 'xy':\n            value = new Map([\n              ['x', value.x],\n              ['y', value.y]\n            ]);\n            typeCategory = 'xyY';\n            break;\n\n          case 'xyY': {\n            let Y = this.__color.getComponent('Y');\n            value = new Map([\n              ['x', value.x],\n              ['y', value.y],\n              ['Y', Y]\n            ]);\n            typeCategory = 'xyY';\n            break;\n          }\n\n          case 'Y':\n            typeCategory = 'xyY';\n            break;\n\n          case 'x':\n          case 'y':\n            value = value[type];\n            typeCategory = 'xyY';\n            break;\n        }\n        if (this.__lastBusValue[typeCategory] === undefined) {\n          this.__lastBusValue[typeCategory] = {};\n        }\n        this.__lastBusValue[typeCategory][type] = this.sendToBackend(value, t => t.variantInfo===type, this.__lastBusValue[typeCategory][type]);\n      });\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('colorchooser', statics);\n  }\n});\n","/* DesignToggle.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to toggle through the available designs\n * @widgetexample\n * <designtoggle>\n *   <layout colspan=\"6\"/>\n *   <label>Change Design</label>\n * </designtoggle>\n *\n *\n *\n * @author Christian Mayer\n * @since 0.5.3 (2010)\n */\nqx.Class.define('cv.ui.structure.pure.DesignToggle', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.HasAnimatedButton],\n\n  /*\n   ******************************************************\n   CONSTRUCTOR\n   ******************************************************\n   */\n  construct: function(props) {\n    this.base(arguments, props);\n    const store = new qx.data.store.Json(cv.io.rest.Client.getBaseUrl() + '/data/designs');\n    store.addListener('loaded', function (ev) {\n      this.setAvailableDesigns(ev.getData());\n    }, this);\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    availableDesigns: { check: 'Array', init: [] }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">' + cv.Config.getDesign() + '</div></div>';\n    },\n    /**\n     * Action performed when the widget got clicked\n     *\n     *\n     * @param path {String} - Internal path of the widget\n     * @param actor {Element} - DOMElement\n     * @param isCanceled {Boolean} - If true the action does nothing\n     */\n    _action: function(path, actor, isCanceled) {\n      if (isCanceled) {\n return; \n}\n\n      const designs = this.getAvailableDesigns();\n\n      const oldDesign = this.getDomElement().querySelector('.value').textContent;\n      const newDesign = designs.getItem((designs.indexOf(oldDesign) + 1) % designs.length);\n\n      const URL = cv.util.Location.getHref();\n      const regexp = new RegExp('design=' + oldDesign);\n      if (URL.search(regexp) !== -1) { // has URL-parameter design\n        cv.util.Location.setHref(URL.replace(regexp, 'design='+newDesign));\n      } else {\n        const parts = cv.util.Location.getHref().split('#');\n        let req = qx.util.Uri.appendParamsToUrl(parts[0], {design: newDesign});\n        if (parts.length > 1) {\n          req += '#'+parts[1];\n        }\n        cv.util.Location.setHref(req);\n      }\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('designtoggle', statics);\n  }\n});\n","/* Group.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A group can be used to group a couple of widgets and optionally surround them with a border or name the group.\n *\n * @widgetexample <settings selector=\".widget_container[data-type=group]\">\n *  <screenshot name=\"group_with_border\">\n *    <caption>Group with border and name</caption>\n *    <data address=\"0/0/0\">1</data>\n *    <data address=\"0/0/1\">21</data>\n *  </screenshot>\n *  </settings>\n *  <group name=\"Example Group\">\n *    <layout colspan=\"6\" />\n *    <text><label>Some Text</label></text>\n *    <switch>\n *      <layout colspan=\"3\" />\n *      <label>Switch</label>\n *      <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *    </switch>\n *    <info format=\"%.1f °C\">\n *      <layout colspan=\"3\" />\n *      <label>Temperature</label>\n *      <address transform=\"DPT:9.001\">0/0/1</address>\n *    </info>\n *  </group>\n *\n * @widgetexample <settings selector=\".widget_container[data-type=group]\">\n *  <screenshot name=\"group_without_border\">\n *    <caption>Hidden Group: no border no name</caption>\n *    <data address=\"0/0/0\">1</data>\n *    <data address=\"0/0/1\">21</data>\n *  </screenshot>\n *  </settings>\n *  <group nowidget=\"true\">\n *    <layout colspan=\"6\" />\n *    <text><label>Some Text</label></text>\n *    <switch>\n *      <layout colspan=\"3\" />\n *      <label>Switch</label>\n *      <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *    </switch>\n *    <info format=\"%.1f °C\">\n *      <layout colspan=\"3\" />\n *      <label>Temperature</label>\n *      <address transform=\"DPT:9.001\">0/0/1</address>\n *    </info>\n *  </group>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Group', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    noWidget: {\n      check: 'Boolean',\n      init: false\n    },\n    name: {\n      check: 'String',\n      init: ''\n    },\n    target: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n\n    /**\n     * Action performed when the group got clicked. If a target is specified in the group attributes\n     * the action will switch to the page defined by the target.\n     *\n     *\n     * @param  event {Event}\n     */\n    action: function (event) {\n      if (this.getTarget()) {\n        cv.TemplateEngine.getInstance().scrollToPage(this.getTarget());\n        if (event.getBubbles()) {\n          event.stopPropagation();\n        }\n      }\n    },\n\n    // overridden, group has no actor\n    getActor: function() {\n      return this.getDomElement();\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.getDomElement().style['z-index'] = 1;\n    },\n\n    // overridden\n    getDomString: function () {\n      // heading style\n      let hstyle = '';\n      if (this.getAlign()) {\n        hstyle += 'style=\"text-align:' + this.getAlign() + '\"';\n      }\n\n      let container = '<div class=\"clearfix\">';\n      if (this.getName()) {\n        container += '<h2 ' + hstyle + '>' + this.getName() + '</h2>';\n      }\n\n      container += this.getChildrenDomString();\n      container += '</div>';\n\n      return '<div class=\"' + this.getClasses() + '\" ' + this.getStyle() + '>' + container + '</div>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('group', statics);\n  }\n});\n","/* Image.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an image to your visualization. Using the auto-refresh setting this widget can be used e.g. to show\n * a camera picture.\n *\n * @widgetexample\n * <image src=\"resource/icons/CometVisu_orange.png\" width=\"45px\" height=\"32px\">\n *   <layout colspan=\"2\" />\n * </image>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n * @asset(qx/static/blank.gif)\n */\nqx.Class.define('cv.ui.structure.pure.Image', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  include: [cv.ui.common.Refresh, cv.ui.common.Update ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    width      : { check: 'String', init: '100%' },\n    height     : { check: 'String', nullable: true },\n    cropTop    : { check: 'String' },\n    cropBottom : { check: 'String' },\n    src        : { check: 'String', init: '' },\n    widthFit   : { check: 'Boolean', init: false },\n    placeholder: {\n      check: ['none', 'src', 'hide', 'exclude'],\n      init: 'none'\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __src: null,\n\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      let imgStyle = '';\n      if (this.getWidth()) {\n        imgStyle += 'width:' + this.getWidth() + ';';\n      }\n      if (this.getWidthFit() === true) {\n        imgStyle += 'max-width:100%;';\n      }\n      if (this.getHeight()) {\n        imgStyle += 'height:' + this.getHeight() + ';';\n      }\n      if (this.getCropTop() !== '' || this.getCropBottom() !== '') {\n        let top = '0%';\n        let bottom = '';\n        if (this.getCropTop() !== '') {\n          top = '-' + this.getCropTop();\n          bottom = 'margin-bottom:' + top;\n        }\n        if (this.getCropBottom() !== '') {\n          bottom = 'margin-bottom:calc(' + top + ' - ' + this.getCropBottom() + ');';\n        }\n        imgStyle += 'object-position:0% ' + top + ';' + bottom;\n      }\n\n      let src = this.__getSrc();\n      if (!src) {\n        switch (this.getPlaceholder()) {\n          case 'hide':\n            src = qx.util.ResourceManager.getInstance().toUri('qx/static/blank.gif');\n            break;\n\n          case 'exclude':\n            imgStyle += 'display:none;';\n            break;\n\n          case 'src':\n            this.error('no src placeholder defined');\n            break;\n        }\n      }\n      return '<div class=\"actor\"><img src=\"' + src + '\" style=\"' + imgStyle + '\" /></div>';\n    },\n\n    /**\n     * Return the real src value\n     */\n    __getSrc: function() {\n      if (!this.__src) {\n        let src = this.getSrc();\n        const parsedUri = qx.util.Uri.parseUri(this.getSrc());\n        if (!parsedUri.protocol && !src.startsWith('/')) {\n          // is relative URI, use the ResourceManager\n          src = qx.util.ResourceManager.getInstance().toUri(src);\n        }\n        this.__src = src || '';\n      }\n      return this.__src;\n    },\n\n    handleUpdate: function(text, address) {\n      const valueElem = this.getValueElement();\n      if (!text) {\n        switch (this.getPlaceholder()) {\n          case 'src':\n            text = this.__getSrc();\n            valueElem.style.display = 'inline';\n            break;\n\n          case 'hide':\n            text = qx.util.ResourceManager.getInstance().toUri('qx/static/blank.gif');\n            valueElem.style.display = 'inline';\n            break;\n\n          case 'exclude':\n            valueElem.style.display = 'none';\n            break;\n        }\n      } else {\n        valueElem.style.display = 'inline';\n      }\n      valueElem.setAttribute('src', text);\n    },\n\n    // overridden\n    getValueElement: function() {\n      return this.getDomElement().querySelector('img');\n    },\n\n    // overridden\n    _applyVisible: function(value) {\n      const valueElem = this.getValueElement();\n      if (!valueElem || this.getRefresh() > 0) {\n        return;\n      }\n      if (value === true) {\n        valueElem.setAttribute('src', this.__getSrc());\n      } else {\n        valueElem.setAttribute('src', '');\n      }\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('image', statics);\n  }\n});\n","/* ImageTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an image like the {@link cv.ui.structure.pure.Image} widget, but additionally the image can be changed by incoming\n * data and can send data to the backend by clicking on it.\n * There are two modes to react on incoming data:\n *\n * <ul>\n *  <li><code>type=\"show\"</code>: Hides the image when incoming data === 0</li>\n *  <li><code>type=\"select\"</code>: Changes the image by appending the incoming data to the initial configured image source, or hide it when incoming data === 0</li>\n * </ul>\n * Example:\n * <pre class=\"sunlight-highlight-xml\">\n * &lt;imagetrigger src=\"resource/icons/comet\" suffix=\"svg\" sendValue=\"clicked\" type=\"select\"&gt;\n *    &lt;address transform=\"DPT:16.001\" mode=\"readwrite\"&gt;0/0/0&lt;/address&gt;\n * &lt;/imagetrigger&gt;\n * </pre>\n *\n * initially shows nothing. When the CometVisu receives the string <code>_icon</code> in address <code>0/0/0</code>,\n * the image <code>icons/comet_opt_icon.svg</code> is shown. When the CometVisu receives '0' on address <code>0/0/0</code>,\n * this image is hidden.\n *\n * @widgetexample <settings>\n *   <screenshot name=\"image_trigger\">\n *     <caption>Image changed by incoming data 'blue'</caption>\n *     <data address=\"0/0/0\">blue</data>\n *   </screenshot>\n *   <screenshot name=\"image_trigger_changes\">\n *     <caption>Image changed by incoming data 'grey'</caption>\n *     <data address=\"0/0/0\">grey</data>\n *   </screenshot>\n *  </settings>\n *  <imagetrigger src=\"resource/icons/CometVisu_\" suffix=\"png\" sendValue=\"clicked\" type=\"select\" width=\"45px\" height=\"32px\">\n *    <layout colspan=\"1\" />\n *    <address transform=\"DPT:16.001\" mode=\"readwrite\">0/0/0</address>\n *  </imagetrigger>\n *\n * @widgetexample <settings>\n *   <caption>Disable layout width by settings it to '0', to have widget with === image width</caption>\n *   <screenshot name=\"image_trigger_colspan0\">\n *     <data address=\"0/0/0\">1</data>\n *   </screenshot>\n *  </settings>\n *  <imagetrigger src=\"resource/icons/CometVisu_orange\" suffix=\"png\" sendValue=\"clicked\" type=\"show\" width=\"45px\" height=\"32px\">\n *    <layout colspan=\"0\" />\n *    <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *  </imagetrigger>\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.ImageTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.Refresh,\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    height: { check: 'String', nullable: true },\n    updateType: {check: 'String', init: ''},\n    width: {check: 'String', init: '100%'},\n    src: { check: 'String', nullable: true },\n    suffix: { check: 'String', nullable: true },\n    sendValue: { check: 'String', init: ''}\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      let style = '';\n      if (Object.keys(this.getLayout()).length === 0) {\n        style += cv.parser.WidgetParser.extractLayout(this.getLayout(), this.getPageType());\n      }\n      if (this.getHeight()) {\n        style += 'height:' + this.getHeight() + ';';\n      }\n      if (style.length > 0) {\n        style = ' style=\"'+style+'\"';\n      }\n\n      let actor = '<div class=\"actor\">';\n      if (this.getUpdateType() === 'show') {\n        actor += '<img src=\"' + this.__getUrl(this.getSrc() + '.' + this.getSuffix()) + '\"' + style.trim() + ' />';\n      } else {\n        actor += '<img src=\"\"' + style + ' />';\n      }\n\n      actor += '</div>';\n      return actor;\n    },\n\n    _update: function(address, value) {\n      const imageChild = this.getDomElement().querySelector('img');\n      if (this.getUpdateType() === 'show') {\n        if (value === 0) {\n          imageChild.style.display = 'none';\n        } else {\n          imageChild.setAttribute('src', this.__getUrl(this.getSrc() + '.' + this.getSuffix()));\n          imageChild.style.display = 'block';\n        }\n      } else if (this.getUpdateType() === 'select') {\n        if (value === 0) {\n          imageChild.style.display = 'none';\n        } else {\n          imageChild.setAttribute('src', this.__getUrl(this.getSrc() + value + '.' + this.getSuffix()));\n          imageChild.style.display = 'block';\n        }\n      }\n\n      //TODO: add value if mapping exists\n      //TODO: get image name from mapping\n      //TODO: add bitmask for multiple images\n      //TODO: add SVG-magics\n    },\n\n    __getUrl: function(url) {\n      const parsedUri = qx.util.Uri.parseUri(url);\n      if (!parsedUri.protocol && !url.startsWith('/')) {\n        // is relative URI, use the ResourceManager\n        url = qx.util.ResourceManager.getInstance().toUri(url);\n      }\n      return url;\n    },\n\n    _action: function() {\n      if (this.getSendValue() === '') {\n return; \n}\n      this.sendToBackend(this.getSendValue());\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('imagetrigger', statics);\n  }\n});\n","/* Info.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a dynamic field to the visu that can represent values from the BUS\n * (e.g. 14-byte text or temperature measurements).\n *\n * @widgetexample <settings>\n *   <caption>Show temperature in degree celsius</caption>\n *   <screenshot name=\"info_temp\">\n *     <data address=\"0/0/0\">19</data>\n *   </screenshot>\n * </settings>\n * <info format=\"%.1f °C\">\n *   <label>outside temperature</label>\n *   <address transform=\"DPT:9.001\">0/0/0</address>\n * </info>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Info', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\">-</div></div>';\n    }\n  }\n});\n\n","/* InfoAction.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The infoaction widget is a combination of an info/text widget and an \"action\"-widget, e.g. switch or trigger.\n *\n * Use case: if you have a group of lights, you can show the number of lights currently switched on\n * and control the whole group in one widget.\n *\n * @widgetexample <settings>\n *   <caption>Example combines an info widget to show the number of lights currently switched on, and an Switch to control them</caption>\n *   <screenshot name=\"infoaction_lights\">\n *     <data address=\"0/0/0\">4</data>\n *     <data address=\"0/0/1\">1</data>\n *   </screenshot>\n * </settings>\n * <meta>\n *  <mappings>\n *    <mapping name=\"OnOff\">\n *      <entry value=\"0\">Off</entry>\n *      <entry value=\"1\">On</entry>\n *    </mapping>\n *  </mappings>\n *  <stylings>\n *    <styling name=\"GreyGreen\">\n *      <entry value=\"0\">grey</entry>\n *      <entry value=\"1\">green</entry>\n *    </styling>\n *  </stylings>\n * </meta>\n * <infoaction>\n *  <layout colspan=\"4\"/>\n *  <label>Lights</label>\n *  <widgetinfo>\n *    <info>\n *     <address transform=\"DPT:9.001\">0/0/0</address>\n *    </info>\n *  </widgetinfo>\n *  <widgetaction>\n *   <switch mapping=\"OnOff\" styling=\"GreyGreen\">\n *    <layout colspan=\"3\" />\n *    <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/1</address>\n *   </switch>\n *  </widgetaction>\n * </infoaction>\n *\n *\n *\n * @author Tobias Bräutigam\n * @since 0.10.0 (as widget), 0.9.2 (as plugin)\n */\nqx.Class.define('cv.ui.structure.pure.InfoAction', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    }\n  },\n\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return this.getChildrenDomString();\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('infoaction', statics);\n  }\n});\n","/* InfoTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an element to the visu that contains two buttons and a value indication for feedback\n * from the BUS. (E.g. for multimedia control\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.InfoTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.Update,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.HandleLongpress\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    'downValue': {\n      check: 'Number',\n      init: 0\n    },\n    'shortDownValue': {\n      check: 'Number',\n      nullable: true\n    },\n    'downLabel': {\n      check: 'String',\n      nullable: true\n    },\n    'upValue': {\n      check: 'Number',\n      init: 0\n    },\n    'shortUpValue': {\n      check: 'Number',\n      nullable: true\n    },\n    'upLabel': {\n      check: 'String',\n      nullable: true\n    },\n    'isAbsolute': {\n      check: 'Boolean',\n      init: false\n    },\n    'min': {\n      check: 'Number',\n      init: 0\n    },\n    'max': {\n      check: 'Number',\n      init: 255\n    },\n    'infoPosition': {\n      check: ['left', 'middle', 'right'],\n      init: 'middle'\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create buttons + info\n      let ret_val = '<div style=\"float:left;\">';\n\n      let actordown = '<div class=\"actor switchUnpressed downlabel\" ';\n      if (this.getAlign()) {\n        actordown += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actordown += '>';\n      actordown += '<div class=\"label\">' + (this.getDownLabel() || '-') + '</div>';\n      actordown += '</div>';\n\n      let actorup = '<div class=\"actor switchUnpressed uplabel\" ';\n      if (this.getAlign()) {\n        actorup += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actorup += '>';\n      actorup += '<div class=\"label\">' + (this.getUpLabel() || '+') + '</div>';\n      actorup += '</div>';\n\n      let actorinfo = '<div class=\"actor switchInvisible\" ';\n      if (this.getAlign()) {\n        actorinfo += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actorinfo += '><div class=\"value\">-</div></div>';\n\n      switch (this.getInfoPosition()) {\n        case 'middle':\n          ret_val += actordown;\n          ret_val += actorinfo;\n          ret_val += actorup;\n          break;\n        case 'right':\n          ret_val += actordown;\n          ret_val += actorup;\n          ret_val += actorinfo;\n          break;\n        default:\n          ret_val += actorinfo;\n          ret_val += actordown;\n          ret_val += actorup;\n          break;\n      }\n\n      return ret_val + '</div>';\n    },\n\n    getActors: function() {\n      return this.getDomElement().querySelectorAll('.actor.uplabel, .actor.downlabel');\n    },\n\n    // overridden\n    initListeners: function() {\n      this.getActors().forEach(function(actor) {\n        qx.event.Registration.addListener(actor, 'pointerdown', this._onPointerDown, this);\n      }, this);\n    },\n\n    __findActor: function (element) {\n      while (!element.classList.contains('actor')) {\n        element = element.parentNode;\n        if (element.classList.contains('widget')) {\n          // thats too far\n          return null;\n        }\n      }\n      return element;\n    },\n\n    _onLongTap: function(event) {\n      this.__action(false, this.__findActor(event.getCurrentTarget()).classList.contains('downlabel'));\n    },\n\n    _action: function(event) {\n      this.__action(true, this.__findActor(event.getCurrentTarget()).classList.contains('downlabel'));\n    },\n\n    __action: function (isShort, isDown) {\n      let value;\n      if (isShort && this.getShortDownValue() !== null && this.getShortUpValue() !== null) {\n        value = isDown ? this.getShortDownValue() : this.getShortUpValue();\n      } else {\n        value = isDown ? this.getDownValue() : this.getUpValue();\n      }\n\n      const bitMask = (isShort ? 1 : 2);\n\n      if (this.getIsAbsolute()) {\n        let bvalue = parseFloat(this.getBasicValue());\n        if (!Number.isFinite(bvalue)) {\n          bvalue = 0; // anything is better than NaN...\n        }\n        value = bvalue + value;\n        value = Math.max(value, this.getMin());\n        value = Math.min(value, this.getMax());\n      }\n      this.sendToBackend(value, function(address) {\n        return !!(address.variantInfo & bitMask);\n      });\n    },\n\n    getDownActor: function() {\n      return this.getDomElement().querySelector('.actor.downlabel');\n    },\n\n    getUpActor: function() {\n      return this.getDomElement().querySelector('.actor.uplabel');\n    },\n\n    getInfoActor: function() {\n      return this.getDomElement().querySelector('.actor.switchInvisible');\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('infotrigger', statics);\n  }\n});\n","/* Line.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A line tag is used to display a horizontal line in the browser to allow for a grouped and thereby tidy display of\n * elements on one page. To specify the width of the line an optional &lt;layout/&gt;-child can be added.\n *\n * @widgetexample <settings selector=\"hr\">\n *   <caption>A line tag which uses 50% of the screen size (6 of 12 available columns)</caption>\n * </settings>\n * <line><layout colspan=\"6\"/></line>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Line', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    getDomString: function () {\n      return '<hr ' + (this.getClasses() ? 'class=\"'+this.getClasses()+'\"' : '') + '/>';\n    }\n  }\n});\n","/* MultiTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a widget with multiple buttons to the visu.\n * Thus, e.g. change the operating mode of the heating system\n * (Comfort -> Night -> Absent -> Frost protection) or create scene functions.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.MultiTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update, cv.ui.common.HasAnimatedButton],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    showstatus: {\n      check: 'Boolean',\n      init: false\n    },\n    elementsPerLine: {\n      check: 'Number',\n      init: 2\n    },\n    buttonConfiguration: {\n      check: 'Object',\n      nullable: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      let ret_val = '<div class=\"actor_container\" style=\"float:left\">';\n      const mapping = this.getMapping();\n      const elementsPerLine = this.getElementsPerLine();\n\n      const config = this.getButtonConfiguration();\n      const indices = Object.keys(config).sort();\n\n      indices.forEach(function (i) {\n        const buttonConfig = config[i];\n        let label = buttonConfig.label;\n        if (mapping) {\n          const mappedValue = this.defaultValueHandling(undefined, buttonConfig.value);\n          if (mappedValue !== buttonConfig.value || !label) {\n            const div = document.createElement('div');\n            this.defaultValue2DOM(mappedValue, div);\n            label = div.innerHTML;\n          }\n        }\n\n        if (label) {\n          ret_val += '<div class=\"actor switchUnpressed\"><div class=\"value\">' + label + '</div></div>';\n        }\n        if (elementsPerLine > 0 && i % elementsPerLine === 0) {\n          ret_val+= '<br/>';\n        }\n      }, this);\n      return ret_val + '</div>';\n    },\n\n    getActors: function() {\n      return this.getDomElement().querySelectorAll('.actor_container .actor');\n    },\n\n    // overridden, only transform the value, do not apply it to DOM\n    _processIncomingValue: function (address, data) {\n      return this.applyTransform(address, data);\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     */\n    handleUpdate: function () {\n      const children = this.getActors();\n      const buttonConfiguration = this.getButtonConfiguration();\n      children.forEach(function(actor) {\n        const index = Array.prototype.indexOf.call(children, actor) + 1;\n        if (Object.prototype.hasOwnProperty.call(buttonConfiguration, index)) {\n          const isPressed = ('' + this.getBasicValue()) === ('' + buttonConfiguration[index].value); // compare as string\n\n          // delay this a little bit to give the HasAnimatedButton stuff time to finish\n          // otherwise it might override the settings here\n          new qx.util.DeferredCall(function () {\n            actor.classList.remove(isPressed ? 'switchUnpressed' : 'switchPressed');\n            actor.classList.add(isPressed ? 'switchPressed' : 'switchUnpressed');\n          }, this).schedule();\n        }\n      }, this);\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @param event\n     */\n    getActionValue: function (event) {\n      const index = Array.prototype.indexOf.call(this.getDomElement().querySelectorAll('.actor_container .actor'), event.getCurrentTarget()) + 1;\n      return this.getButtonConfiguration()[index].value;\n    },\n\n    // overridden\n    initListeners: function() {\n      if (this.isAnonymous()) {\n return; \n}\n\n      this.getActors().forEach(function(actor) {\n        qx.event.Registration.addListener(actor, 'tap', this.action, this);\n        qx.event.Registration.addListener(actor, 'pointerdown', this._onPointerDown, this);\n      }, this);\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('multitrigger', statics);\n  }\n});\n","/* NavBar.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the widget navbar, you can add a navigation menu to the entire visu.\n * The menu can be displayed on a page (top, bottom, left, right).\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.NavBar', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    name: {\n      check: 'String',\n      nullable: true\n    },\n    scope: {\n      check: 'Number',\n      init: -1\n    },\n    width: {\n      check: 'String',\n      init: '300'\n    },\n    position: {\n      check: ['top', 'left', 'right', 'bottom'], \n      init: 'left'\n    },\n    dynamic: {\n      check: 'Boolean',\n      nullable : true,\n      init: null\n    },\n    visible: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    _navbarTop: '',\n    _navbarLeft: '',\n    _navbarRight: '',\n    _navbarBottom: '',\n    _touchX: null,\n    _touchY: null,\n\n    /**\n     * Called on setup.dom.finished event with high priority. Adds the navbar dom string\n     * to the DOM-Tree\n     */\n    initializeNavbars: function() {\n      ['Top', 'Left', 'Right', 'Bottom'].forEach(function(pos) {\n        if (this['_navbar'+pos]) {\n          const elem = document.querySelector('#navbar' + pos);\n          if (elem) {\n            elem.innerHTML += this['_navbar' + pos];\n          }\n        }\n      }, this);\n\n      const self = this;\n      // Event handlers to allow navbar fade in and fade out.\n      // Currently only implemented for the major use case of a left navbar.\n      // TODO add logic for other navbars as well\n      // Logic:\n      //   To fade in the touch must start on the left screen side and then\n      //   swipe right.\n      //   To fade out all places on the screen are fine.\n      //   There is a minimum swipe distance and the direction must be mostly\n      //   horizontal (up to +/-45° tolerance is allowed)\n      //   When during a valid swipe the direction is reversed the fading\n      //   action is also reverted.\n      const content = document.body.querySelector('#centerContainer');\n      content.addEventListener('touchstart', function (evt) {\n        const touches = evt.touches[0];\n        const pPH = cv.TemplateEngine.getInstance().pagePartsHandler;\n\n        if (pPH.navbars.left.dynamic === false ||\n          (!qx.core.Init.getApplication().getMobile() && pPH.navbars.left.dynamic !== true) ||\n          (pPH.navbars.left.fadeVisible && !evt.composedPath().some(i => i.id==='navbarLeft')) || // left navbar is visible, but the touch is somewhere else\n          (!pPH.navbars.left.fadeVisible && touches.clientX > 20)) { // left navbar is not visible but the finger isn't on the left end -> not relevant\n          return;\n        }\n\n        self._touchX = touches.clientX;\n        self._touchY = touches.clientY;\n      }, {passive: true});\n      content.addEventListener('touchend', function () {\n        self._touchX = null;\n        self._touchY = null;\n      }, false);\n      content.addEventListener('touchmove', function (evt) {\n        if (self._touchX === null) {\n          return; // early exit as this touch isn't relevant for us\n        }\n\n        const touches = evt.touches[0];\n        const x = touches.clientX - self._touchX;\n        const y = touches.clientY - self._touchY;\n        const necessaryDistance = 10;\n        const enoughDistance = Math.abs(x) > necessaryDistance;\n        const horizontal = Math.abs(x) > Math.abs(y);\n        const toRight = x > 0;\n        if (horizontal && enoughDistance) {\n          evt.preventDefault();\n          const pPH = cv.TemplateEngine.getInstance().pagePartsHandler;\n          if (toRight) {\n            self._touchX = touches.clientX - necessaryDistance;\n            self._touchY = touches.clientY;\n            if (!pPH.navbars.left.fadeVisible) {\n              pPH.fadeNavbar('Left', 'in', 250);\n            }\n          } else { // !toRight\n            self._touchX = touches.clientX + necessaryDistance;\n            self._touchY = touches.clientY;\n            if (pPH.navbars.left.fadeVisible) {\n              pPH.fadeNavbar('Left', 'out', 250);\n            }\n          }\n        }\n      }, {passive: false});\n    }\n  },\n  \n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n    },\n    \n    getGlobalPath: function () {\n      const id = this.getPath().split('_');\n      id.pop();\n      return id.join('_') + '_' + this.getPosition() + '_navbar';\n    },\n\n    // overridden\n    getDomString: function () {\n      let container = '<div class=\"' + this.getClasses() + '\" id=\"' + this.getGlobalPath() + '\">';\n      if (this.getName()) {\n        container += '<h2>' + this.getName() + '</h2>';\n      }\n      container += this.getChildrenDomString();\n\n      container += '</div>';\n\n      // add this to the navbars in DOM not inside the page\n      switch (this.getPosition()) {\n        case 'top':\n          this.self(arguments)._navbarTop += container;\n          break;\n\n        case 'left':\n          this.self(arguments)._navbarLeft += container;\n          break;\n\n        case 'right':\n          this.self(arguments)._navbarRight += container;\n          break;\n\n        case 'bottom':\n          this.self(arguments)._navbarBottom += container;\n          break;\n      }\n\n      return '';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('navbar', statics);\n    qx.event.message.Bus.subscribe('setup.dom.finished.before', statics.initializeNavbars, statics);\n  }\n});\n","/* NotificationCenterBadge.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Shows the current number of messages in {@link cv.ui.NotificationCenter} and opens it on click.\n *\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a centered text widget</caption>\n *   <screenshot name=\"text_example\" />\n * </settings>\n * <notificationcenterbadge>\n *  <layout colspan=\"0\" />\n * </notificationcenterbadge>\n *\n * @author Tobias Bräutigam\n * @since 0.11.0\n */\nqx.Class.define('cv.ui.structure.pure.NotificationCenterBadge', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    const classes = props.classes.trim().split(' ');\n    const i_right = classes.indexOf('right');\n\n    if (i_right !== -1) {\n      // do not align, but float the container instead\n      this.setContainerClass('float-right');\n      classes.splice(i_right, 1);\n      props.classes = classes.join(' ');\n    }\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    counter: {\n      check: 'Number',\n      init: 0,\n      apply: '_applyCounter'\n    },\n    hideWhenEmpty: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __badgeElement: null,\n\n    _onDomReady: function() {\n      this.base(arguments);\n      const center = cv.ui.NotificationCenter.getInstance();\n      center.getMessages().addListener('changeLength', this._onChangeCounter, this);\n      this._onChangeCounter();\n      center.addListener('changedGlobalSeverity', this._onChangeGlobalSeverity, this);\n    },\n\n    // property apply\n    _applyVisible: function(value) {\n      // hide NotificationCenters own badge while we are visible\n      cv.ui.NotificationCenter.getInstance().disableBadge(value);\n    },\n\n    action: function(ev) {\n      if (this._skipNextEvent === ev.getType()) {\n        this._skipNextEvent = null;\n        return;\n      }\n      cv.ui.NotificationCenter.getInstance().toggleVisibility();\n    },\n\n    __getBadgeElement: function() {\n      if (!this.__badgeElement) {\n        this.__badgeElement = this.getDomElement().querySelector('.badge');\n      }\n      return this.__badgeElement;\n    },\n\n    _onChangeGlobalSeverity: function(ev) {\n      const classList = this.__getBadgeElement().classList;\n      classList.remove.apply(classList, cv.ui.NotificationCenter.getInstance().getSeverities());\n      if (ev.getData()) {\n        classList.add(ev.getData());\n      }\n    },\n\n    _onChangeCounter: function() {\n      const messages = cv.ui.NotificationCenter.getInstance().getMessages().length;\n      this.__getBadgeElement().innerHTML = ''+messages;\n      if (this.isHideWhenEmpty()) {\n        this.__getBadgeElement().style.display = messages === 0 ? 'none' : 'block';\n      }\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      let style = '';\n      if (this.isHideWhenEmpty() && this.getCounter() === 0) {\n        style = ' style=\"display: none;\"';\n      }\n      return '<div class=\"actor badge\"'+style+'>'+this.getCounter()+'</div>';\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    const center = cv.ui.NotificationCenter.getInstance();\n    center.getMessages().removeListener('changeLength', this._onChangeCounter, this);\n    center.removeListener('changedGlobalSeverity', this._onChangeGlobalSeverity, this);\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('notificationcenterbadge', statics);\n  }\n});\n","/* Page.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Creates a new sub page and adds a corresponding link to the current page.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Page', {\n  extend: cv.ui.structure.AbstractWidget,\n  implement: cv.ui.structure.IPage,\n\n  include: [\n    cv.ui.common.HasChildren,\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.__waitForProperties = ['showNavbarTop', 'showNavbarBottom', 'showNavbarLeft', 'showNavbarRight'];\n    this.base(arguments, props);\n\n    this.addListener('changeVisible', this._onChangeVisible, this);\n\n    // break out of the constructor\n    new qx.util.DeferredCall(function() {\n      const parentPage = this.getParentPage();\n      if (!parentPage) {\n        this.__waitForProperties = [];\n      } else {\n        this.debug('binding navbar visibility from ' + parentPage.getPath() + ' to ' + this.getPath());\n      }\n      [\n        ['showTopNavigation', true],\n        ['showFooter', true],\n        ['showNavbarTop', false],\n        ['showNavbarBottom', false],\n        ['showNavbarLeft', false],\n        ['showNavbarRight', false]\n      ].forEach(function (tuple) {\n        const property = tuple[0];\n        const defaultValue = tuple[1];\n        if (this['get' + property.charAt(0).toUpperCase() + property.substr(1)]() === null) {\n          // inherit from parent\n          if (parentPage) {\n            parentPage.bind(property, this, property);\n          } else {\n            // we have not parent page, because we are the root page, use the default value\n            this['set' + property.charAt(0).toUpperCase() + property.substr(1)](defaultValue);\n          }\n        }\n        if (!parentPage) {\n          this.setInitialized(true);\n        }\n      }, this);\n    }, this).schedule();\n\n    if (this.getAddress()) {\n      this._initOnCreate = true;\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    allPages : '',\n\n    /**\n     * Append the complete generated HTML code to the DOM tree at the end of the generation process\n     */\n    createFinal: function() { // special function - only for pages!\n      document.querySelector('#pages').innerHTML = this.allPages;\n      qx.event.message.Bus.unsubscribe('setup.dom.append', this.createFinal, this);\n    }\n\n  },\n\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    initialized: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeInitialized'\n    },\n\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    name: {\n      check: 'String',\n      init: '', nullable: true\n    },\n    showTopNavigation : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowTopNavigation'\n    },\n    showFooter        : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowFooter'\n    },\n    showNavbarTop : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarTop',\n      apply: '_applyNavbarVisibility'\n    },\n    showNavbarBottom : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarBottom',\n      apply: '_applyNavbarVisibility'\n    },\n    showNavbarLeft : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarLeft',\n      apply: '_applyNavbarVisibility'\n    },\n    showNavbarRight : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarRight',\n      apply: '_applyNavbarVisibility'\n    },\n    backdropAlign     : {\n      init: '50% 50%',\n      nullable: true\n    },\n    backdropType      : { check: 'String', nullable: true },\n    linkVisible       : { check: 'Boolean', init: true, nullable: true },\n    size              : { check: 'String', nullable: true },\n    backdrop          : { check: 'String', nullable: true }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __waitForProperties: null,\n    __colspanClass: null,\n    __normalizedDomId: null,\n\n    _applyNavbarVisibility: function(value, old, name) {\n      if (value !== null) {\n        const i_name = this.__waitForProperties.indexOf(name);\n        if (i_name !== -1) {\n          this.__waitForProperties.splice(i_name, 1);\n        }\n        if (this.__waitForProperties.length === 0) {\n          this.setInitialized(true);\n        }\n      }\n    },\n\n    /**\n     * If the page gets visible the colspan sized must be checked\n     * @param ev {Event}\n     */\n    _onChangeVisible: function(ev) {\n      if (ev.getData()) {\n        if (this.__colspanClass !== cv.ui.layout.Manager.COLSPAN_CLASS) {\n          this.applyColumnWidths();\n        }\n        if (this.getBackdrop()) {\n          cv.ui.layout.ResizeHandler.invalidateBackdrop();\n        }\n      }\n    },\n\n    /**\n     * Set childrens column widths\n     */\n    applyColumnWidths: function() {\n      cv.ui.layout.Manager.applyColumnWidths('#'+this.getPath(), false);\n      this.__colspanClass = cv.ui.layout.Manager.COLSPAN_CLASS;\n    },\n\n    // overridden\n    getDomString: function() {\n      const pageType = this.getPageType();\n\n      const subpageClass = this.getFlavour() ? (' flavour_' + this.getFlavour()) : '';\n      let subpage = '<div class=\"page type_' + pageType + subpageClass + '\" id=\"' + this.getPath() + '\">';\n      let container = '<div class=\"clearfix\"><h1>' + this.getName() + '</h1>';\n\n      if (pageType === '2d') {\n        let size = 'width:100%;height:100%;';\n        switch (this.getSize()) {\n          case 'fixed':\n            size = '';\n            break;\n\n          case 'contained':\n            size += 'object-fit:contain;';\n            if (this.getBackdropAlign()) {\n              size += 'object-position:' + this.getBackdropAlign() + ';';\n            }\n            break;\n\n          default: // default: assume scaled\n        }\n\n        const backdrop = this.getBackdrop();\n        if (backdrop) {\n          container += '<' + this.getBackdropType() + ' src=\"' + qx.util.ResourceManager.getInstance().toUri(backdrop) + '\" style=\"position: absolute; top: 0px; left: 0px;z-index:-1;' + size + '\"/>';\n        }\n      } /* ---Disable 3D for 0.8---\n      else if (pageType === \"3d\" && false) {\n         var floorplan = JSFloorPlan3D( container, backdrop );\n         floorplan.moveToRoom( 'Underground', false, true, false );\n         container.data( 'JSFloorPlan3D', floorplan );\n         container.find('canvas').css({position: 'absolute', top: '0px', left: '0px', 'z-index':'-1', width:'100%',height:'100%'});\n         subpage.click( {JSFloorPlan3D:floorplan,callback:function(event){\n         var j = this.JSFloorPlan3D;\n         j.moveToRoom( j.getState('showFloor'), event.room.room, true, true, function(){\n         container.trigger( 'update3d', j );\n         });\n         }}, floorplan.translateMouseEvent );\n         $(window).bind( 'resize', function(){ floorplan.resize($('.page').width(), $('.page').height(), true);} );\n         if (page.getAttribute('azimut')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('azimut'), path + '_' );\n         address[ page.getAttribute('azimut') ] = [ 'DPT:9.001', 0, 'azimut' ];\n         }\n         if (page.getAttribute('elevation')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('elevation'), path + '_' );\n         address[ page.getAttribute('elevation') ] = [ 'DPT:9.001', 0, 'elevation' ];\n         };\n         if (page.getAttribute('floor')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('floor'), path + '_' );\n         address[ page.getAttribute('floor') ] = [ 'DPT:5.004', 0, 'floor' ];\n         };\n\n         $( childs ).each( function(i,a){\n         if( this.tagName === 'filter' )\n         {\n         var floorFilter = $(this).attr('floor');\n         var roomFilter  = $(this).attr('room');\n         childs.splice( i, 1 );                 // remove filter element\n         $(this).children().each( function(j){  // and add it's children\n         $(this).find('layout').attr({floorFilter:floorFilter,roomFilter:roomFilter});\n         childs.splice( i+j, 0, this );\n         });\n         }\n         });\n      } */\n      container += this.getChildrenDomString();\n      subpage += container + '</div></div>';\n      cv.ui.structure.pure.Page.allPages = subpage + cv.ui.structure.pure.Page.allPages;\n      return undefined;\n    },\n\n    _update: function(ga, data) {\n      // widgetData  = cv.data.Model.getInstance().getWidgetDataByElement( element );\n      // var value = this.defaultValueHandling( ga, data, widgetData );\n      // var type = widgetData.address[ ga ][2];\n      // switch( type )\n      // {\n      //   case 'azimut':\n      //     widgetData.JSFloorPlan3D.setState('currentAzimut', value, true);\n      //     element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     break;\n      //\n      //   case 'elevation':\n      //     widgetData.JSFloorPlan3D.setState('currentElevation', value, true);\n      //     element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     break;\n      //\n      //   case 'floor':\n      //     widgetData.JSFloorPlan3D.moveToRoom( value, false, true, true, function(){\n      //       element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     });\n      //     break;\n      //\n      //   default:\n      // TODO: data comparision has to be refactored to use DPT and a value\n      if (parseInt(data) === 1) {\n        cv.TemplateEngine.getInstance().scrollToPage(this.getPath());\n        this.sendToBackend('0');\n      }\n      // }\n    },\n\n    sendToBackend: function (value) {\n      if (this.getAddress) {\n        const list = this.getAddress();\n        for (let id in list) {\n          if (Object.prototype.hasOwnProperty.call(list, id)) {\n            const address = list[id];\n            if (cv.data.Model.isWriteAddress(address)) {\n              cv.TemplateEngine.getInstance().visu.write(id, cv.Transform.encode(address, value));\n            }\n          }\n        }\n      }\n    }\n  },\n\n  defer: function(statics) {\n    qx.event.message.Bus.subscribe('setup.dom.append', statics.createFinal, statics);\n  }\n});\n","/* PageJump.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The pagejump widget can be used to link the visu pages.\n * The function is similar to hyperlinks.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.PageJump', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.HasChildren,\n    cv.ui.common.HasAnimatedButton\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (props) {\n    if (!props.name) {\n      // when there is no name the widget has no actor as clickable subelement, so we need\n      // to bind the click events to the whole widget\n      props.bindClickToWidget = true;\n    }\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    target : {\n      check: 'String',\n      init: '0'\n    },\n    activeScope : {\n      check: ['target', 'path'],\n      init: 'target'\n    },\n    name : {\n      check: 'String',\n      nullable: true\n    },\n    targetPath : {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Handle page change events and update the active state of this PageJump\n     *\n     * @param ev {Event}\n     * @protected\n     */\n    _onScrollToPage: function(ev) {\n      const page_id = ev.getData();\n      const page = cv.ui.structure.WidgetFactory.getInstanceById(page_id);\n      const model = cv.data.Model.getInstance();\n      const name = page.getName();\n\n      // remove old active classes\n      document.querySelectorAll('.pagejump.active').forEach(function(elem) {\n        elem.classList.remove('active');\n      }, this);\n      document.querySelectorAll('.pagejump.active_ancestor').forEach(function(elem) {\n        elem.classList.remove('active_ancestor');\n      }, this);\n\n      // and set the new active ones\n      document.querySelectorAll('.pagejump').forEach(function(elem) {\n        const data = model.getWidgetDataByElement(elem);\n        if (name === data.target) {\n          elem.classList.add('active');\n        }\n      }, this);\n\n      // now set the active ancestors\n      let parentPage = cv.util.Tree.getParentWidget(page, 'page');\n      // set for all parent pages apart from the root page\n\n      const pageJumps = document.querySelectorAll('.pagejump');\n      const markPageJumps = function (parentName, elem) {\n        const data = model.getWidgetDataByElement(elem);\n        if (parentName === data.target || (data.activeScope === 'path' && (\n            (typeof data.path === 'string') && data.path.match(parentName + '$') ||\n            (typeof data.targetPath === 'string') && data.targetPath.match(parentName + '$'))\n        )) {\n          elem.classList.add('active_ancestor');\n        }\n      };\n\n      while (parentPage && cv.util.Tree.getParentWidget(parentPage, 'page')) {\n        pageJumps.forEach(function(elem) {\n markPageJumps(parentPage.getName(), elem); \n});\n        // recursively find pagejumps for parent pages\n        parentPage = cv.util.Tree.getParentWidget(parentPage, 'page');\n      }\n    }\n  },\n\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n\n    // overridden\n    _getInnerDomString: function() {\n      let actor = '<div class=\"actor switchUnpressed';\n      if (this.getAlign()) {\n        actor += ' ' + this.getAlign();\n      }\n      actor += '\">';\n      if (this.getName()) {\n        actor += '<div class=\"value\">' + this.getName() + '</div>';\n      }\n      actor += '</div>';\n      return actor + this.getChildrenDomString();\n    },\n\n    // overridden\n    action: function() {\n      let target = this.getTarget();\n      if (this.getTargetPath() !== null) {\n        target = cv.TemplateEngine.getInstance().getPageIdByPath(target, this.getTargetPath());\n      }\n      cv.TemplateEngine.getInstance().scrollToPage(target);\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('pagejump', statics);\n    qx.event.message.Bus.subscribe('path.pageChanged', statics._onScrollToPage, statics);\n  }\n});\n","/* PageLink.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * PageLink Widget for visible pages. Do not use this directly because the pagelink widget\n * is automatically added when you use a page widget with parameter <code>visible=true</code>.\n *\n * @author Tobias Bräutigam\n * @since 0.10.0 (2017)\n */\nqx.Class.define('cv.ui.structure.pure.PageLink', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    name : {\n      check: 'String',\n      init: '',\n      nullable: true\n    },\n    wstyle : {\n      check: 'String',\n      init: ''\n    },\n    address : {\n      check: 'Object',\n      init: {}\n    },\n    bindClickToWidget: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    getDomString: function() {\n      const layout = this.getLayout();\n\n      const style = typeof layout === 'object' ? '' : 'style=\"' + cv.parser.WidgetParser.extractLayout(layout, this.getPageType()) + '\"';\n\n      let ret_val = '<div class=\"widget clearfix link pagelink ' + this.getClasses() + '\" ' + style + '>';\n      ret_val += '<div class=\"actor\" ' + this.getWstyle() + '><a href=\"javascript:void(0)\">' + this.getName() + '</a></div>';\n      ret_val += '</div>';\n      return ret_val;\n    },\n\n    // overridden\n    action: function() {\n      cv.TemplateEngine.getInstance().scrollToPage(this.getPath() + '_');\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('pagelink', statics);\n  }\n});\n","/* PushButton.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to the visu that sends a defined value to the BUS when you press and release.\n * E.g. pushing a 1 and releasing a 0. This makes it possible, for example,\n * to simulate a push button to open and close a garage door, blinds or blinds.\n *\n * @since 2013\n */\nqx.Class.define('cv.ui.structure.pure.PushButton', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    'downValue': {check: 'String', init: '1'},\n    'upValue': {check: 'String', init: '0'}\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    // overridden\n    initListeners: function() {\n      this.addElementListener('pointerdown', this._onPointerDown, this);\n      this.addElementListener('pointerup', this._onPointerUp, this);\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     *\n     * @param value {any} incoming data (already transformed + mapped)\n     */\n    handleUpdate: function (value) {\n      const actor = this.getActor();\n      // compare against the unmapped value\n      value = '' + this.getBasicValue();\n      const off = this.getUpValue();\n      actor.classList.remove(value === off ? 'switchPressed' : 'switchUnpressed');\n      actor.classList.add(value === off ? 'switchUnpressed' : 'switchPressed');\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @param event\n     */\n    getActionValue: function (event) {\n      if (event.type === 'pointerup') {\n        return this.getUpValue();\n      } \n        return this.getDownValue();\n    },\n\n    _onPointerUp: function () {\n      const sendValue = this.getUpValue();\n      this.sendToBackend(sendValue, function (address) {\n        return (!address.variantInfo || address.variantInfo === 'up');\n      });\n    },\n\n    _onPointerDown: function () {\n      const sendValue = this.getDownValue();\n      this.sendToBackend(sendValue, function (address) {\n        return (!address.variantInfo || address.variantInfo === 'down');\n      });\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('pushbutton', statics);\n  }\n});\n","/* Refresh.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the widget refresh, the visu is added a switch, which allows the visu to reload the displayed data.\n *\n * @author Christian Mayer\n * @since 2014\n */\nqx.Class.define('cv.ui.structure.pure.Refresh', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.HasAnimatedButton, cv.ui.common.BasicUpdate],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: 'String', nullable: true }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    _action: function() {\n      cv.TemplateEngine.getInstance().visu.restart(true);\n    }\n  }\n});\n","/* Reload.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the reload widget, the visu is added a switch, which allows to reload the full visu in the browser.\n *\n * @author Christian Mayer\n * @since 2014\n */\nqx.Class.define('cv.ui.structure.pure.Reload', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden, return undefined to prevent widget from being renderered into DOM\n    getDomString: function() {\n      return;\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return;\n    },\n\n    _update: function (address, data) {\n      const value = this.defaultValueHandling(address, data);\n      if (value > 0) {\n        cv.util.Location.reload(true);\n      }\n    }\n  }\n});\n","/* Rgb.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the RGB widget you can display a colour in the visu.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Rgb', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Update],\n\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\"></div></div>';\n    },\n\n    /**\n     * Updates the RGB widget by setting the background color\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data\n     */\n    _update: function(address, data) {\n      if (data === undefined || address === undefined) {\n        return;\n      }\n      const valElem = this.getValueElement();\n\n      const value = cv.Transform.decode(this.getAddress()[address], data);\n\n      let bg = window.getComputedStyle(valElem)['background-color'].replace(/[a-zA-Z()\\s]/g, '').split(/,/);\n      if (bg.length !== 3) {\n        bg = [0, 0, 0];\n      }\n      switch (this.getAddress()[address].variantInfo) {\n        case 'r':\n          bg[0] = value;\n          break;\n        case 'g':\n          bg[1] = value;\n          break;\n        case 'b':\n          bg[2] = value;\n          break;\n      }\n      valElem.style['background-color'] = 'rgb(' + bg[0] + ', ' + bg[1] + ', ' + bg[2] + ')';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('rgb', statics);\n  }\n});\n","/* Roundbar.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a display to the visu that can represent values from the BUS\n * and shows them with a round bar.\n *\n * @widgetexample <settings>\n *    <caption>Example roundbar widget</caption>\n *    <screenshot name=\"roundbar_simple\">\n *      <data address=\"3/3/1\">63.3</data>\n *    </screenshot>\n *  </settings>\n *  <roundbar>\n *      <address transform=\"DPT:9.001\" mode=\"read\">3/3/1</address>\n *  </roundbar>\n *\n * @author Christian Mayer\n * @since 0.12.0 (2020)\n */\nqx.Class.define('cv.ui.structure.pure.Roundbar', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (props) {\n    this.__indicatorDOMElement = [];\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    coord: function(position) {\n      return position.x.toFixed(1) + ' ' + position.y.toFixed(1);\n    },\n    /**\n     * Create the SVG path for the round bar.\n     * Angle = 0 === horizontal on the right\n     *\n     * @param startAngle {Float}\n     * @param startArrowPoint {Float}\n     * @param endAngle {Float}\n     * @param endArrowPoint {Float}\n     * @param radius {Float}\n     * @param width {Float}\n     * @param getBBox {Boolean} return the bounding box instead of the path itself\n     */\n    createBarPath: function(startAngle, startArrowPoint, endAngle, endArrowPoint, radius, width, getBBox = false) {\n      const startArrowPointAngle = startAngle + startArrowPoint;\n      const endArrowPointAngle = endAngle + endArrowPoint;\n\n      // The path to generate is using those positions:\n      // rO             -- outer --\n      // rMO        /// outermiddle \\\\\\\n      // rM      //       middle        \\\\\n      // rIM   /        innermiddle        \\\n      // rI   /         -- inner --         \\\n      //     |        /             \\        |\n      //     |_______|               |_______|\n      //       start      center        end\n      const clockwise = startAngle > endAngle ? 1 : 0;\n      const rI = radius;\n      const rIM = radius + width * 1 / 4;\n      const rM = radius + width * 2 / 4;\n      const rMO = radius + width * 3 / 4;\n      const rO = radius + width;\n      const startInner = {x: Math.cos(startAngle) * rI, y: -Math.sin(startAngle) * rI};\n      const startMiddle = {x: Math.cos(startArrowPointAngle) * rM, y: -Math.sin(startArrowPointAngle) * rM};\n      const startOuter = {x: Math.cos(startAngle) * rO, y: -Math.sin(startAngle) * rO};\n      const centerInner = {\n        x: Math.cos((startAngle + endAngle) / 2) * rI,\n        y: -Math.sin((startAngle + endAngle) / 2) * rI\n      };\n      const centerOuter = {\n        x: Math.cos((startAngle + endAngle) / 2) * rO,\n        y: -Math.sin((startAngle + endAngle) / 2) * rO\n      };\n      const endInner = {x: Math.cos(endAngle) * rI, y: -Math.sin(endAngle) * rI};\n      const endMiddle = {x: Math.cos(endArrowPointAngle) * rM, y: -Math.sin(endArrowPointAngle) * rM};\n      const endOuter = {x: Math.cos(endAngle) * rO, y: -Math.sin(endAngle) * rO};\n      const startMiddleFlag = Math.abs(startAngle - startArrowPointAngle) > Math.PI ? 1 : 0;\n      const startEndFlag = Math.abs(startAngle - endAngle) / 2 > Math.PI ? 1 : 0;\n      const endMiddleFlag = Math.abs(endAngle - endArrowPointAngle) > Math.PI ? 1 : 0;\n      const startMiddleDir = startAngle < startArrowPointAngle ? 1 : 0;\n      const endMiddleDir = endAngle < endArrowPointAngle ? 1 : 0;\n\n      /**\n       * @param start\n       * @param end\n       * @param r\n       * @param flag\n       * @param cw\n       */\n      function arc(start, end, r, flag, cw) {\n        return (start.x===end.x) && (start.y===end.y)\n          ? ''\n          : (Math.abs(start.x-end.x)+Math.abs(start.y-end.y) < 2)\n            ? 'L' + cv.ui.structure.pure.Roundbar.coord(end)\n            : ['A', r, r, 0, flag, cw, cv.ui.structure.pure.Roundbar.coord(end)].join(' ');\n      }\n\n      if (getBBox) {\n        const rMax = Math.max(rI, rO);\n        const isInside = function (a) {\n          return (startAngle < a && a < endAngle) || (startAngle > a && a > endAngle);\n        };\n        const rMiddle = isInside(-Math.PI * 4 / 2) || isInside(Math.PI * 0 / 2) ? rMax : startInner.x;\n        const uMiddle = isInside(-Math.PI * 3 / 2) || isInside(Math.PI * 1 / 2) ? -rMax : startInner.y;\n        const lMiddle = isInside(-Math.PI * 2 / 2) || isInside(Math.PI * 2 / 2) ? -rMax : startInner.x;\n        const dMiddle = isInside(-Math.PI * 1 / 2) || isInside(Math.PI * 3 / 2) ? rMax : startInner.y;\n        return {\n          u: Math.min(startInner.y, startMiddle.y, startOuter.y, endInner.y, endMiddle.y, endOuter.y, uMiddle),\n          d: Math.max(startInner.y, startMiddle.y, startOuter.y, endInner.y, endMiddle.y, endOuter.y, dMiddle),\n          l: Math.min(startInner.x, startMiddle.x, startOuter.x, endInner.x, endMiddle.x, endOuter.x, lMiddle),\n          r: Math.max(startInner.x, startMiddle.x, startOuter.x, endInner.x, endMiddle.x, endOuter.x, rMiddle)\n        };\n      }\n\n      // a thin bar path should just be a single line\n      if (width < 1.0) {\n        return [\n          'M', cv.ui.structure.pure.Roundbar.coord(startOuter),\n          arc(startOuter, centerOuter, rO, startEndFlag, clockwise),\n          arc(centerOuter, endOuter, rO, startEndFlag, clockwise)\n        ].join('');\n      }\n\n      return ['M', cv.ui.structure.pure.Roundbar.coord(startInner),\n        startArrowPointAngle === startAngle\n          ? 'L' + cv.ui.structure.pure.Roundbar.coord(startOuter)\n          : arc(startInner, startMiddle, rIM, startMiddleFlag, 1-startMiddleDir) +\n            arc(startMiddle, startOuter, rMO, startMiddleFlag, startMiddleDir),\n        arc(startOuter, centerOuter, rO, startEndFlag, clockwise),\n        arc(centerOuter, endOuter, rO, startEndFlag, clockwise),\n        endArrowPointAngle === endAngle\n          ? 'L' + cv.ui.structure.pure.Roundbar.coord(endInner)\n          : arc(endOuter, endMiddle, rMO, endMiddleFlag, 1-endMiddleDir) +\n            arc(endMiddle, endInner, rIM, endMiddleFlag, endMiddleDir),\n        arc(startInner, centerInner, rI, startEndFlag, 1-clockwise),\n        arc(centerInner, startInner, rI, startEndFlag, 1-clockwise),\n        'Z'\n      ].join('');\n    },\n    /**\n     * Create the SVG path for an pointer.\n     * @param angle {Float}\n     * @param p {Object} Indicator object\n     */\n    createPointerPath: function(angle, p) {\n      const s = Math.sin(angle);\n      const c = Math.cos(angle);\n      const wx = c * p.width;\n      const wy = s * p.width;\n\n      if (p.thickness > 0) {\n        const tx = -s * p.thickness / 2;\n        const ty = c * p.thickness / 2;\n        return [\n          'M', this.coord({x:c*p.radius+wx-tx, y: -(s*p.radius+wy-ty)}),\n          'L', this.coord({x:c*p.radius, y: -(s*p.radius)}),\n          'L', this.coord({x:c*p.radius+wx+tx, y: -(s*p.radius+wy+ty)})\n        ].join('');\n      } \n        return [\n          'M', this.coord({x:c*p.radius, y: -(s*p.radius)}),\n          'L', this.coord({x:c*p.radius+wx, y: -(s*p.radius+wy)})\n        ].join('');\n    }\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    type: { check: 'Array' },\n    indicators: { check: 'Array' },\n\n    min: { check: 'Number' },\n    max: { check: 'Number' },\n    axisradius: { check: 'Number' },\n    axiswidth: { check: 'Number' },\n    axiscolor: { check: 'String' },\n    ranges: { check: 'Array' },\n    minorradius: { check: 'Number' },\n    minorwidth: { check: 'Number' },\n    minorspacing: { check: 'String' },\n    minorcolor: { check: 'String' },\n    majorradius: { check: 'Number' },\n    majorwidth: { check: 'Number' },\n    majorposition: { check: 'String' },\n    majorcolor: { check: 'String' },\n    labels: { check: 'Array' },\n    labelstyle: { check: 'String' },\n    start: { check: 'Number' },\n    end: { check: 'Number' },\n    arrowtype: { check: 'Number' },\n    spacing: { check: 'Number' },\n    overflowarrow: { check: 'Boolean' },\n    fontsize: { check: 'Number' },\n    textx: { check: 'Number' },\n    texty: { check: 'Number' },\n    textlength: { check: 'Number' },\n    textanchor: { check: 'String' },\n    linespace: { check: 'Number' },\n    bboxgrow: { check: 'Object' },\n    debug: { check: 'Boolean' },\n    currentRatioValue: { check: 'Array', init: [] },\n    targetRatioValue: { check: 'Array', init: [] }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __animator: undefined,\n    __indicatorDOMElement: null,\n\n    // overridden\n    _getInnerDomString: function () {\n      /**\n       * Grow the bounding box to also contain the parameters x and y\n       * @param bbox {Object} The initial bounding box\n       * @param x {Float}\n       * @param y {Float}\n       * @returns {Object} The enlarged bounding box\n       */\n      function bboxAdd(bbox, x, y) {\n        if (bbox.u > y) {\n bbox.u = y; \n}\n        if (bbox.d < y) {\n bbox.d = y; \n}\n        if (bbox.l > x) {\n bbox.l = x; \n}\n        if (bbox.r < x) {\n bbox.r = x; \n}\n        return bbox;\n      }\n\n      this.setCurrentRatioValue(Array(this.getIndicators().length).fill(0));\n      this.setTargetRatioValue(Array(this.getIndicators().length).fill([0, false, false]));\n\n      const self = this;\n      const s = this.getStart();\n      const e = this.getEnd();\n      const min = this.getMin();\n      const max = this.getMax();\n      let cntValues = 0;\n      let svgMajor = '';\n      let svgMinor = '';\n      let svgLabels = '';\n      let svgRanges = '';\n      let svgIndicators = '';\n      let svgText = '';\n      const createBarPath = cv.ui.structure.pure.Roundbar.createBarPath;\n\n      // Determine the bounding box, first get the biggest radius that must fit\n      let rMax = this.getAxisradius() + this.getAxiswidth();\n      let sMax = 0;\n      let eMax = 0;\n      this.getIndicators().forEach(function (indicator) {\n        rMax = Math.max(rMax, indicator.radius, indicator.radius+indicator.width);\n        sMax = Math.max(sMax, indicator.startarrow);\n        eMax = Math.max(eMax, indicator.endarrow);\n      });\n      let BBox = createBarPath(s, sMax, e, eMax, rMax, 0, true);\n\n      if (this.getMinorwidth() > 0) {\n        let\n          spacing = parseFloat(this.getMinorspacing());\n          let rIn = this.getMinorradius();\n          let rOut = this.getMinorwidth() + rIn;\n\n        if (/^[0-9]+%/.test(this.getMinorspacing())) { // special case: percentage\n          spacing = (max-min) * spacing / 100;\n        }\n\n        svgMinor += '<path class=\"minor\" d=\"';\n        for (var angle=s, delta = (e-s)*spacing/(max-min), cnt=(max-min)/spacing; cnt >= 0; angle+=delta, cnt--) {\n          var\n            sin = Math.sin(angle);\n            var cos = Math.cos(angle);\n          svgMinor += [\n            'M', cv.ui.structure.pure.Roundbar.coord({x:cos*rIn, y:-sin*rIn }),\n            'L', cv.ui.structure.pure.Roundbar.coord({x:cos*rOut, y:-sin*rOut})\n          ].join('');\n\n          BBox = bboxAdd(BBox, cos*rIn, -sin*rIn);\n          BBox = bboxAdd(BBox, cos*rOut, -sin*rOut);\n        }\n        if (this.getMinorcolor() !== '') {\n svgMinor += '\" style=\"stroke:' + this.getMinorcolor(); \n}\n        svgMinor += '\" />';\n      }\n\n      if (this.getMajorwidth() > 0) {\n        let\n          rIn = this.getMajorradius();\n          let rOut = this.getMajorwidth() + rIn;\n\n        svgMajor += '<path class=\"major\" d=\"';\n\n        this.getMajorposition().split(';').forEach(function (position) {\n          switch (position) {\n            case 'min':\n              position = min;\n              break;\n\n            case 'max':\n              position = max;\n              break;\n          }\n          const angle = s + (e - s) * (position - min) / (max - min);\n          const sin = Math.sin(angle);\n          const cos = Math.cos(angle);\n          svgMajor += [\n            'M', cv.ui.structure.pure.Roundbar.coord({x:cos*rIn, y:-sin*rIn }),\n            'L', cv.ui.structure.pure.Roundbar.coord({x:cos*rOut, y:-sin*rOut})\n          ].join('');\n\n          BBox = bboxAdd(BBox, cos*rIn, -sin*rIn);\n          BBox = bboxAdd(BBox, cos*rOut, -sin*rOut);\n        });\n        if (this.getMajorcolor() !== '') {\n svgMajor += '\" style=\"stroke:' + this.getMajorcolor(); \n}\n        svgMajor += '\" />';\n      }\n\n      const labelstyle = this.getLabelstyle();\n      this.getLabels().forEach(function (label, labelnumber) {\n        const angle = s + (e - s) * (label.value - min) / (max - min);\n        const x = label.radius * Math.cos(angle);\n        const y = label.radius * -Math.sin(angle);\n        let alignmentBaseline = '';\n        let textAnchor = '';\n        let textAngle = 0;\n\n        if (label.orientation < 3) {\n          svgLabels += '<text class=\"axislabel\" x=\"' + x + '\" y=\"' + y + '\"';\n          switch (label.orientation) {\n            default:\n            case 0: // horizontal\n              if (x < 0) {\n                textAnchor = (['end', 'middle', 'start'])[label.position];\n              } else {\n                textAnchor = (['start', 'middle', 'end'])[label.position];\n              }\n              if (Math.abs(x) < 1) {\n                textAnchor = 'middle';\n              }\n              if (y < 0) {\n                alignmentBaseline = (['baseline', 'middle', 'hanging'])[label.position];\n              } else {\n                alignmentBaseline = (['hanging', 'middle', 'baseline'])[label.position];\n              }\n              if (Math.abs(y) < 1) {\n                alignmentBaseline = 'middle';\n              }\n              break;\n\n            case 1: { // parallel\n              let textAngle = -angle * 180 / Math.PI + 90;\n              if (y < 0) {\n                alignmentBaseline = (['baseline', 'middle', 'hanging'])[label.position];\n              } else {\n                alignmentBaseline = (['hanging', 'middle', 'baseline'])[label.position];\n                textAngle += 180;\n              }\n              textAnchor = 'middle';\n              svgLabels += ' transform=\"rotate(' + textAngle + ',' + x + ',' + y + ')\"';\n              break;\n            }\n\n            case 2: // perpendicular\n              textAngle = -angle * 180 / Math.PI;\n              if (x < 0) {\n                textAnchor = (['end', 'middle', 'start'])[label.position];\n                textAngle += 180;\n              } else {\n                textAnchor = (['start', 'middle', 'end'])[label.position];\n              }\n              alignmentBaseline = 'middle';\n              svgLabels += ' transform=\"rotate(' + textAngle + ',' + x + ',' + y + ')\"';\n              break;\n          }\n          svgLabels += ' dominant-baseline=\"' + alignmentBaseline + '\"';\n          svgLabels += ' text-anchor=\"' + textAnchor + '\"';\n\n          if (labelstyle !== '') {\n            svgLabels += ' style=\"' + labelstyle + '\"';\n          }\n\n          svgLabels += '>' + label.name + '</text>';\n        } else { // label.orientation >= 3 -> round\n          const labelid = self.$$user_path + '_label' + labelnumber;\n          const cw = s < e ? 0 : 1;\n          let path = '';\n          let align = '';\n\n          switch (label.orientation) {\n            case 3: // roundstart\n              path = ['M', x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y].join(' ');\n              break;\n\n            case 4: // roundmiddle\n              path = ['M', -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y].join(' ');\n              align = ' startOffset=\"50%\" text-anchor=\"middle\"';\n              break;\n\n            case 5: // roundend\n              path = ['M', x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y].join(' ');\n              align = ' startOffset=\"100%\" text-anchor=\"end\"';\n              break;\n          }\n          svgLabels += '<path style=\"stroke:none; fill:none; stroke-width:0\" id=\"' + labelid + '\" d=\"' + path + '\"/>';\n          svgLabels += '<text class=\"axislabel\"';\n\n          if (labelstyle !== '') {\n            svgLabels += ' style=\"' + labelstyle + '\"';\n          }\n\n          svgLabels += '><textPath href=\"#'+labelid+'\"' + align + '>' + label.name + '</textPath></text>';\n        }\n      });\n\n      this.getRanges().forEach(function (range) {\n        const sRange = (e - s) * (range.start - min) / (max - min) + s;\n        const eRange = (e - s) * (range.end - min) / (max - min) + s;\n        const rRange = range.radius || self.getAxisradius();\n        const wRange = range.width || self.getAxiswidth();\n        const thisBBox = createBarPath(sRange, 0, eRange, 0, rRange, wRange, true);\n        svgRanges += '<path class=\"range\" d=\"';\n        svgRanges += createBarPath(sRange, 0, eRange, 0, rRange, wRange);\n        if (range.style) {\n          svgRanges += '\" style=\"' + range.style;\n        }\n        svgRanges += '\" />';\n\n        BBox = bboxAdd(BBox, thisBBox.l, thisBBox.u);\n        BBox = bboxAdd(BBox, thisBBox.r, thisBBox.d);\n      });\n\n      this.__animator = [];\n      this.getIndicators().forEach(function (indicator, number) {\n        self.__animator.push(new cv.util.LimitedRateUpdateAnimator(self.__updateIndicatorPosition, self, number));\n        svgIndicators += '<path class=\"indicator\" style=\"' + indicator.style + '\" />';\n\n        if (indicator.showValue) {\n cntValues++; \n}\n      });\n\n      if (cntValues>0) {\n        svgText += '<text class=\"value\" y=\"'+this.getTexty()+'\"' +\n          ' text-anchor=\"' + this.getTextanchor() +'\"' +\n          ' font-size=\"' + this.getFontsize() + '\">' +\n          '<tspan x=\"'+this.getTextx()+'\" dy=\"0\">-</tspan>' +\n          ('<tspan x=\"'+this.getTextx()+'\" dy=\"' + this.getLinespace() + '\">-</tspan>').repeat(cntValues-1) +\n          '</text>';\n\n        const textDistribution = ({start: [0, 1], middle: [0.5, 0.5], end: [1, 0]})[this.getTextanchor()] || [0, 1];\n        const textU = Math.min(0, -this.getFontsize(), this.getLinespace() * (cntValues - 1) - (this.getLinespace() < 0 ? this.getFontsize() : 0));\n        const textD = Math.max(0, -this.getFontsize(), this.getLinespace() * (cntValues - 1) - (this.getLinespace() < 0 ? this.getFontsize() : 0));\n        BBox = bboxAdd(BBox, this.getTextx()-textDistribution[0]*this.getTextlength(), this.getTexty()+textU);\n        BBox = bboxAdd(BBox, this.getTextx()+textDistribution[1]*this.getTextlength(), this.getTexty()+textD);\n      }\n\n      let html = '<div class=\"actor\">' +\n        '<svg width=\"100%\" height=\"100%\" viewBox=\"' + [\n          BBox.l - this.getBboxgrow().l,\n          BBox.u - this.getBboxgrow().u,\n          BBox.r - BBox.l + this.getBboxgrow().l + this.getBboxgrow().r,\n          BBox.d - BBox.u + this.getBboxgrow().u + this.getBboxgrow().d\n        ].join(' ') + '\">';\n      if (this.getDebug()) {\n        html += '<rect width=\"'+(BBox.r-BBox.l)+'\" height=\"'+(BBox.d-BBox.u)+'\" x=\"'+(BBox.l)+'\" y=\"'+(BBox.u)+'\" stroke=\"blue\" fill=\"none\" />' +\n          '<rect width=\"'+(BBox.r-BBox.l + this.getBboxgrow().l + this.getBboxgrow().r)+'\" height=\"'+(BBox.d-BBox.u + this.getBboxgrow().u + this.getBboxgrow().d)+'\" x=\"'+(BBox.l - this.getBboxgrow().l)+'\" y=\"'+(BBox.u - this.getBboxgrow().u)+'\" stroke=\"green\" fill=\"none\" />' +\n          '<circle cx=\"0\" cy=\"0\" r=\"3\" fill=\"red\" />';\n      }\n\n      if (this.getAxisradius() > 0) {\n        const sectorPath = createBarPath(s, 0, e, 0, this.getAxisradius(), 0);\n        const axisPath = createBarPath(s, 0, e, 0, this.getAxisradius(), this.getAxiswidth());\n        const stroke = this.getAxiscolor() === '' ? undefined : this.getAxiscolor();\n        const fill = this.getAxiswidth() < 1 ? 'none' : stroke;\n        html +=\n          '<path class=\"sector\" d=\"'+sectorPath+' L0 0Z\"/>' +\n          '<path class=\"axis\" d=\"'+axisPath+'\" style=\"' +\n          (stroke ? 'stroke:'+stroke : '') +\n          (fill ? ';fill:' +fill : '') +\n          '\"/>';\n      }\n\n      html += svgMinor + svgMajor + svgRanges + svgLabels + svgIndicators + svgText;\n      html += '</svg></div>';\n\n      return html;\n    },\n\n    /**\n     * Updates the roundbar widget\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data\n     */\n    _update: function(address, data) {\n      if (data === undefined || address === undefined) {\n return; \n}\n      const self = this;\n      const value = cv.Transform.decode(this.getAddress()[address], data);\n      const target = this.getTargetRatioValue();\n      const tspan = Array.from(this.getDomElement().getElementsByTagName('tspan'));\n      const valueFormat = this.applyFormat(address, value);\n\n      this.getIndicators().forEach(function(indicator, i) {\n        if (address === indicator.address) {\n          target[i] = [\n            (Math.min(Math.max(value, indicator.min), indicator.max)-indicator.min)/(indicator.max-indicator.min),\n            value < indicator.min,\n            value > indicator.max\n          ];\n          if (tspan[i] !== undefined) {\n            tspan[i].textContent = valueFormat;\n          }\n          self.__animator[i].setTo(target[i][0], !self.isVisible());\n        }\n      });\n\n      this.setTargetRatioValue(target);\n    },\n\n    /**\n     * Callback to update the display of the indicators.\n     *\n     * Note: It is a design decision not to pool multiple updates in one requestAnimationFrame which might be beneficial\n     * performance wise. But as it's assumed that a typical visu config is only containing one roundbar per address\n     * a pooling wouldn't make a difference on the one hand but complicate the code on the other hand.\n     * Even with a few roundbars using the same address the performance impact is negligible.\n     * @param ratio\n     * @param indicatorNumber\n     */\n    __updateIndicatorPosition: function (ratio, indicatorNumber) {\n      if (this.__indicatorDOMElement.length === 0) {\n        // cache\n        this.__indicatorDOMElement = Array.from(this.getDomElement().getElementsByClassName('indicator'));\n      }\n\n      const indicator = this.getIndicators()[indicatorNumber];\n      const target = this.getTargetRatioValue()[indicatorNumber];\n      const startAngle = this.getStart();\n      const endAngle = this.getEnd();\n      let targetAngle = startAngle + ratio * (endAngle - startAngle);\n      const overflowarrow = this.getOverflowarrow();\n\n      if (!overflowarrow) {\n        targetAngle = (endAngle > startAngle)\n          ? Math.max(startAngle, targetAngle - indicator.endarrow)\n          : Math.min(startAngle, targetAngle - indicator.endarrow);\n      }\n      if (indicator.isBar) {\n        this.__indicatorDOMElement[indicatorNumber].setAttribute('d',\n          cv.ui.structure.pure.Roundbar.createBarPath(\n            startAngle,\n            (overflowarrow&&!(target[1]&&ratio<0.01)) ? 0 : indicator.startarrow,\n            targetAngle,\n            (overflowarrow&&!(target[2]&&ratio>0.99)) ? 0 : indicator.endarrow,\n            indicator.radius,\n            indicator.width\n          )\n        );\n      } else {\n        this.__indicatorDOMElement[indicatorNumber].setAttribute('d',\n          cv.ui.structure.pure.Roundbar.createPointerPath(targetAngle, indicator)\n        );\n      }\n    }\n  }\n});\n\n","/* Slide.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a horizontal slider to the visu. This can be used, for example, to dim a light or change temperature values.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Slide', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.base(arguments, props);\n    this.__animator = new cv.util.LimitedRateUpdateAnimator(this.__updateHandlePosition, this);\n    this.__pageSizeListener = cv.ui.layout.ResizeHandler.states.addListener('changePageSizeInvalid', () => {\n      this.__invalidateScreensize();\n    });\n    this.__lastBusValue = {};\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    cv.ui.layout.ResizeHandler.states.removeListenerById(this.__pageSizeListener);\n    this.__pageSizeListener = null;\n    this.__button = null;\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    min: {\n      check: 'Number',\n      init: 0\n    },\n    max: {\n      check: 'Number',\n      init: 100\n    },\n    step: {\n      check: 'Number',\n      init: 0.5\n    },\n    showInvalidValues: {\n      check: 'Boolean',\n      init: false\n    },\n    sendOnFinish: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __lastBusValue: null,\n    __animator: null,\n    __button: undefined, // cache for DOM element\n    __range: undefined, // cache for DOM element\n    __actorWidth: undefined,\n    __buttonWidth: undefined,\n    __pageSizeListener: undefined,\n    __inDrag: false, // is the handle currently dragged?\n    __coordMin: undefined, // minimal screen coordinate of slider\n\n    // overridden\n    _getInnerDomString: function () {\n      const placeholder = this.getFormat() === '' ? '' : '-';\n      return `\n        <div class=\"actor ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n          <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">`+placeholder+`</button>\n          <div class=\"ui-slider-range value\" style=\"margin-left: 0px; width: 0px;\"></div>\n        </div>\n      `;\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n\n      this.__throttled = cv.util.Function.throttle(this.__onChangeValue, 250, {trailing: true}, this);\n\n      this.getActor().addEventListener('pointerdown', this);\n    },\n\n    _update: function (address, data) {\n      let transform = this.getAddress()[address].transform;\n      if (this.__inDrag || this.__lastBusValue[transform] === data) {\n        // slider in use -> ignore value from bus\n        // internal state unchanged -> also do nothing\n        return;\n      }\n      this.__lastBusValue = {}; // forget all other transforms as they might not be valid anymore\n      this.__lastBusValue[transform] = data;\n\n      let value = cv.Transform.decode(this.getAddress()[address], data);\n\n      // animate when visible, otherwise jump to the target value\n      this.__setSliderTo(value, !this.isVisible());\n    },\n\n    /**\n     * The the internal slider state and its handle and displayed value\n     * @param value {Number} The new value\n     * @param instant {Boolean} Animate or instant change\n     * @param relaxDisplay {Boolean} Let the handle move to an unstable position\n     *   to give visual feedback that something does happen during interaction\n     * @private\n     */\n    __setSliderTo: function(value, instant, relaxDisplay = false) {\n      let min = this.getMin();\n      let max = this.getMax();\n      let step = this.getStep();\n      if (step === 0 || Math.abs((max-min)/step) > 10000) {\n        // limit too small step size - it's not necessary to have more than\n        // 10000 steps for the range as even the biggest screen doesn't have\n        // that many pixels\n        step = (max-min)/10000;\n      }\n      let realValue = Math.min(Math.max(value, min), max);\n\n      if (!this.getShowInvalidValues()) {\n        // map to closest allowed value\n        let stepValue = Math.round((realValue - min) / step) * step + min;\n        // use max when the value is greater than the middle point between the\n        // biggest allowed step and the maximum\n        let maxSwitchValue = (Math.floor((max - min) / step) * step + min + max) / 2;\n        realValue = realValue < maxSwitchValue ? stepValue : max;\n      }\n\n      let ratio = max===min ? 0 : (realValue-min)/(max-min);\n\n      if (relaxDisplay) {\n        let valueRatio = max===min ? 0 : (Math.min(Math.max(value, min), max)-min)/(max-min);\n        let delta = ratio - valueRatio;\n        let stepCount = (max - min) / step;\n        let factor = (2*stepCount) ** 3;\n        ratio -= Math.min(factor * delta**4, Math.abs(delta)) * Math.sign(delta);\n      }\n\n      // store it to be able to suppress sending of unchanged data\n      this.setBasicValue(realValue);\n\n      if (this.getFormat() !== '') {\n        // #2: map it to a value the user wants to see\n        let displayValue = this.applyMapping(realValue);\n\n        // #3: format it in a way the user understands the value\n        displayValue = this.applyFormat(undefined, displayValue);\n        this.setValue(displayValue);\n\n        this.applyStyling(realValue);\n\n        let button = this.getDomElement().querySelector('button');\n        button.replaceChildren(); // delete anything inside\n        this.defaultValue2DOM(displayValue, button);\n      }\n\n      this.__animator.setTo(ratio, instant);\n    },\n\n    __updateHandlePosition: function (ratio) {\n      if (this.__button === undefined) {\n        let element = this.getDomElement();\n        this.__button = element.querySelector('button');\n        this.__range = element.querySelector('.ui-slider-range');\n      }\n      if (this.__button === null) {\n        // most likely reason: the widget / DOM tree was deleted (e.g. due to\n        // browsing to a new page or during unit tests)\n        this._disposeObjects('__animator');\n        return;\n      }\n      if (this.__actorWidth === undefined || this.__buttonWidth === undefined) {\n        let\n          actor = this.getDomElement().querySelector('.actor');\n          let actorStyles = window.getComputedStyle(actor);\n        this.__actorWidth = parseFloat(actorStyles.getPropertyValue('width'));\n        this.__buttonWidth = parseFloat(window.getComputedStyle(this.__button).getPropertyValue('width'));\n        this.__range.style.marginLeft = '-' + actorStyles.getPropertyValue('padding-left');\n        this.__range.style.borderRadius = actorStyles.getPropertyValue('border-radius');\n      }\n      let length = ratio * this.__actorWidth;\n      this.__button.style.transform = 'translate3d(' + (length-this.__buttonWidth/2) + 'px, 0px, 0px)';\n      this.__range.style.width = length + 'px';\n    },\n\n    __invalidateScreensize: function () {\n      let min = this.getMin();\n      let max = this.getMax();\n      this.__actorWidth = undefined; // invalidate cached values\n      this.__animator.setTo(max===min ? 0 : (this.getBasicValue()-min)/(max-min), true);\n    },\n\n    handleEvent: function (event) {\n      let newRatio = 0;\n\n      switch (event.type) {\n        case 'pointerdown': {\n          this.__inDrag = true;\n          document.addEventListener('pointermove', this);\n          document.addEventListener('pointerup', this);\n          let boundingRect = event.currentTarget.getBoundingClientRect();\n          let computedStyle = window.getComputedStyle(event.currentTarget);\n          this.__coordMin = boundingRect.left + parseFloat(computedStyle.paddingLeft);\n          newRatio = (event.clientX - this.__coordMin) / this.__actorWidth;\n          break;\n        }\n\n        case 'pointermove':\n          if (!this.__inDrag) {\n            return;\n          }\n          newRatio = (event.clientX - this.__coordMin)/this.__actorWidth;\n          break;\n\n        case 'pointerup':\n          this.__inDrag = false;\n          document.removeEventListener('pointermove', this);\n          document.removeEventListener('pointerup', this);\n          newRatio = (event.clientX - this.__coordMin)/this.__actorWidth;\n          break;\n      }\n\n      newRatio = Math.min(Math.max(newRatio, 0.0), 1.0); // limit to 0..1\n      let newValue = this.getMin() + newRatio * (this.getMax() - this.getMin());\n      this.__setSliderTo(newValue, this.__inDrag, this.__inDrag);\n      if (!this.getSendOnFinish() || event.type === 'pointerup') {\n        this.__throttled.call(newValue);\n      }\n    },\n\n    __onChangeValue: function(value) {\n      this.__lastBusValue = this.sendToBackend(value, false, this.__lastBusValue);\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('slide', statics);\n  }\n});\n","/* Switch.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The switch widget shows two states (e.g. ON and OFF) and can toggle between them.\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a switch widget using mapping and styling</caption>\n *   <screenshot name=\"switch_example_on\">\n *    <caption>Switch turned on</caption>\n *    <data address=\"0/0/0\">1</data>\n *   </screenshot>\n *   <screenshot name=\"switch_example_off\">\n *    <caption>Switch turned off</caption>\n *    <data address=\"0/0/0\">0</data>\n *   </screenshot>\n * </settings>\n * <meta>\n *  <mappings>\n *    <mapping name=\"OnOff\">\n *      <entry value=\"0\">O</entry>\n *      <entry value=\"1\">I</entry>\n *    </mapping>\n *  </mappings>\n *  <stylings>\n *    <styling name=\"GreyGreen\">\n *      <entry value=\"0\">grey</entry>\n *      <entry value=\"1\">green</entry>\n *    </styling>\n *  </stylings>\n * </meta>\n * <switch mapping=\"OnOff\" styling=\"GreyGreen\">\n *   <layout colspan=\"3\" />\n *   <label>Switch</label>\n *   <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n * </switch>\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Switch', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    onValue: {\n      check: 'String',\n      init: '1'\n    },\n    offValue: {\n      check: 'String',\n      init: '0'\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param value {any} incoming data (already transformed + mapped)\n     */\n    handleUpdate: function(value) {\n      const actor = this.getActor();\n      // compare against the unmapped value\n      value = this.getBasicValue();\n      const off = this.getOffValue();\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      actor.classList.remove(value == off ? 'switchPressed' : 'switchUnpressed'); // jshint ignore:line\n      actor.classList.add(value == off ? 'switchUnpressed' : 'switchPressed'); // jshint ignore:line\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @return {var}\n     */\n    getActionValue: function () {\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      return (this.getBasicValue() == this.getOffValue() ? this.getOnValue() : this.getOffValue()); // jshint ignore:line\n    }\n  }\n});\n","/* Text.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The text-tag defines static (non-changing) text to be displayed on a page. The content of a &lt;label&gt; with free text.\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a centered text widget</caption>\n *   <screenshot name=\"text_example\" />\n * </settings>\n * <text align=\"center\"><label>Example text</label></text>\n *\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Text', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '';\n    }\n  }\n});\n","/* Toggle.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The toggle widget is similar to the switch, but it can take more than two states.\n * Can be used to change the operating modes of the heating system.\n * Each time the toggle is pressed, the toggle takes the next possible state.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Toggle', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update, cv.ui.common.HasAnimatedButton],\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @return {var}\n     */\n    getActionValue: function () {\n      return this.getNextMappedValue(this.getBasicValue(), this.getMapping());\n    }\n  }\n});\n","/* Trigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to the visu with which exactly a defined value for a short,\n * as well as a defined value for a long key pressure, can be sent to the BUS,\n * e.g. for recalling and storing scenes or driving roller blinds. (Short = stop, long = drive).\n * The address for short and long term may vary.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Trigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.BasicUpdate,\n    cv.ui.common.HandleLongpress\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: 'String', init: '0' },\n    shortValue: { check: 'String', init: '0' }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue(), this.getDomElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Handle a short tap event and send the value for short pressing the trigger to the backend.\n     * If there is no short threshold set, this send the value for long presses to the backend.\n     */\n    _action: function() {\n      const value = (this.getShortThreshold() > 0 || this.isShortDefault()) ? this.getShortValue() : this.getSendValue();\n      this.sendToBackend(value, function(address) {\n        return !!(address.variantInfo & 1);\n      });\n    },\n\n    /**\n     * Handle a long tap event and send the value for long pressing the trigger to the backend.\n     */\n    _onLongTap: function() {\n      this.sendToBackend(this.getSendValue(), function(address) {\n        return !!(address.variantInfo & 2);\n      });\n    }\n  }\n});\n","/* Unknown.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Fallback widget shown when an unknown widget is defined in the configuration.\n * You must not use this one directly.\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Unknown', {\n  extend: qx.core.Object,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.set(props);\n  },\n\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    path: {\n      check: 'String',\n      init: ''\n    },\n    $$type: {\n      check: 'String',\n      init: 'Unknown'\n    },\n    unknownType: {\n      check: 'String',\n      init: ''\n    },\n    pageType: {\n      check: ['text', '2d', '3d'],\n      init: 'text'\n    },\n    parentWidget: {\n      check: 'cv.ui.structure.AbstractBasicWidget',\n      init: null\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    /**\n     * Returns the DOM-Element of this widget\n     * @return {Element} the DOM element\n     */\n    getDomElement: function () {\n      return document.querySelector('#' + this.getPath());\n    },\n\n    /**\n     * Return the HTML string for this widget\n     * @return {String} HTML code\n     */\n    getDomString: function () {\n      return '<div class=\"widget clearfix\"><pre>'+qx.locale.Manager.tr('unknown: %1', this.getUnknownType()) + '</pre></div>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('unknown', statics);\n  }\n});\n\n","/* UrlTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The UrlTrigger widget adds a button to the visualization that queries data from a URL in the background.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.UrlTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.BasicUpdate\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: 'String', init: '0' },\n    params: { check: 'String', init: '' },\n    url: { check: 'String', nullable: true, apply: '_applyUrl' }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __xhr: null,\n\n    getXhr: function () {\n      return this.__xhr;\n    },\n\n    // property apply\n    _applyUrl: function(value) {\n      if (value) {\n        if (!this.__xhr) {\n          const xhr = new qx.io.request.Xhr(qx.util.ResourceManager.getInstance().toUri(value));\n          xhr.set({\n            method: 'GET',\n            accept: 'application/html',\n            requestData: this.getParams()\n          });\n          this.__xhr = xhr;\n        } else {\n          this.__xhr.setUrl(qx.util.ResourceManager.getInstance().toUri(value));\n        }\n      }\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue(), this.getDomElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      let actor = '<div class=\"actor switchUnpressed ';\n      if (this.getAlign()) {\n        actor += this.getAlign();\n      }\n      actor += '\"><div class=\"value\"></div></div>';\n      return actor;\n    },\n\n    // overridden\n    _action: function() {\n      if (this.__xhr) {\n        this.__xhr.send();\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this._disposeObjects('__xhr');\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('urltrigger', statics);\n  }\n});\n","/* Video.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a video or live stream to the visu. Currently, most sources do not support this yet.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Video', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    width   : { check: 'String', nullable: true },\n    height  : { check: 'String', nullable: true },\n    src     : { check: 'String', init: '' },\n    autoplay: { check: 'Boolean', init: false }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      let style = '';\n      if (this.getWidth()) {\n        style += 'width:' + this.getWidth() + ';';\n      }\n      if (this.getHeight()) {\n        style += 'height:' + this.getHeight() + ';';\n      }\n      if (style !== '') {\n style = 'style=\"' + style + '\"'; \n}\n      const autoplay = this.isAutoplay() ? ' autoplay=\"autoplay\"' : '';\n      return '<div class=\"actor\"><video src=\"' + this.getSrc() + '\" ' + style + autoplay + '  controls=\"controls\" /></div>';\n    },\n\n    // overridden\n    getValueElement: function() {\n      return this.getDomElement().querySelector('video');\n    },\n\n    // overridden\n    _applyVisible: function(value) {\n      const video = this.getValueElement();\n      if (video) {\n        if (value === true && this.isAutoplay()) {\n          video.play();\n        } else {\n          video.pause();\n        }\n      }\n    }\n  }\n});\n","/* Web.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an area to the visu, where external websites can be displayed.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Web', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Update,\n    cv.ui.common.Refresh\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n\n    width: {\n      check: 'String',\n      nullable: true\n    },\n    height: {\n      check: 'String',\n      nullable: true\n    },\n    frameborder: {\n      check: 'Boolean',\n      init: false\n    },\n    background: {\n      check: 'String',\n      nullable: true\n    },\n    scrolling: {\n      check: ['auto', 'yes', 'no'],\n      nullable: true\n    },\n    src: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      let webStyle = this.getStyle();\n      if (this.getWidth()) {\n        webStyle += 'width:' + this.getWidth() + ';';\n      } else { // default width is 100% of widget space (fix bug #3175343 part 1)\n        webStyle += 'width: 100%;';\n      }\n      if (this.getHeight()) {\n        webStyle += 'height:' + this.getHeight() + ';';\n      }\n      if (this.getFrameborder() === false) {\n        webStyle += 'border: 0px ;';\n      }\n      if (this.getBackground()) {\n        webStyle += 'background-color:' + this.getBackground() + ';';\n      }\n      if (webStyle !== '') {\n        webStyle = 'style=\"' + webStyle + '\"';\n      }\n\n      let scrolling = '';\n      if (this.getScrolling()) {\n        scrolling = 'scrolling=\"' + this.getScrolling() + '\"';\n      } // add scrolling parameter to iframe\n      return '<div class=\"actor\"><iframe src=\"' + this.getSrc() + '\" ' + webStyle + scrolling + '></iframe></div>';\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data (already transformed + mapped)\n     */\n    _update: function(address, data) {\n      let addr = this.getAddress()[address];\n      if (!addr) {\n        return;\n      }\n      if (data === 1) {\n        const iframe = this.getDomElement().querySelector('iframe');\n        this.refreshAction(iframe, iframe.getAttribute('src'));\n        // reset the value\n        cv.TemplateEngine.getInstance().visu.write(address, cv.Transform.encode(addr, 0));\n      }\n    }\n  }\n});\n\n","/* WgPluginInfo.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an dynamic field to the visu that shows live information from a WireGate plugin.\n * \n * Note: The service helper from\n * https://raw.githubusercontent.com/OpenAutomationProject/Wiregate/master/tools/wg-plugindb/wg-plugindb.php\n * must be \"installed\" in the directory /var/www/ (i.e. the web root)\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.WgPluginInfo', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    variable   : { check: 'String', nullable: true, apply: '_applyVariable' }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __request: null,\n\n    // property apply\n    _applyVariable: function(value) {\n      if (value) {\n        if (!this.__request) {\n          // create the request\n          this.__request = new qx.io.request.Xhr('/wg-plugindb.php?name=' + value);\n          this.__request.set({\n            accept: 'application/json'\n          });\n          this.__request.addListener('success', this._onSuccess, this);\n        } else {\n          this.__request.setUrl('/wg-plugindb.php?name=' + value);\n        }\n        cv.TemplateEngine.getInstance().executeWhenDomFinished(this.__request.send, this.__request);\n      }\n    },\n\n    getRequest: function () {\n      return this.__request;\n    },\n\n    /**\n     * Handle successful requests from {@link qx.io.request.Xhr}\n     * @param ev {Event}\n     */\n    _onSuccess: function(ev) {\n      const req = ev.getTarget();\n      const data = req.getResponse();\n      this.defaultUpdate(undefined, data[this.getVariable()], this.getValueElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Triggers an {@link qx.io.request.Xhr} request to query the plugin value\n     */\n    handleUpdate: function() {\n      if (this.__request) {\n        this.__request.send();\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this._disposeObjects('__request');\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('wgplugin_info', statics);\n  }\n});\n","/* WidgetInfoAction.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This is a helper class for the InfoAction widget it cannot be used directly\n *\n * @author Tobias Bräutigam\n * @since 0.10.0 (as widget), 0.9.2 (as plugin)\n */\nqx.Class.define('cv.ui.structure.pure.WidgetInfoAction', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    childObjects: {check: 'Array', init: []}\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    getDomString: function () {\n      return this.getChildrenDomString();\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('widgetinfo', statics);\n    cv.ui.structure.WidgetFactory.registerClass('widgetaction', statics);\n  }\n});\n"]}