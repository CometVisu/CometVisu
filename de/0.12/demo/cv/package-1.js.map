{"version":3,"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Audio.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Break.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/ColorChooser.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/DesignToggle.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Group.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/ImageTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Info.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/InfoAction.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/InfoTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Line.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/MultiTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/NavBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/NotificationCenterBadge.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Page.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/PageJump.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/PageLink.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/PushButton.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Refresh.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Reload.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Rgb.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Roundbar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Slide.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Switch.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Text.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Toggle.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Trigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Unknown.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/UrlTrigger.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Video.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/Web.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/WgPluginInfo.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/pure/WidgetInfoAction.js"],"names":["qx","Class","define","extend","cv","ui","structure","AbstractWidget","include","common","Update","properties","src","check","nullable","id","width","height","autoplay","init","loop","thresholdValue","members","_getInnerDomString","style","this","getWidth","getHeight","isLoop","getId","getSrc","getActor","getDomElement","querySelector","_update","address","value","applyMapping","getThresholdValue","audioWidget","play","defer","statics","WidgetFactory","registerClass","pure","Audio","$$dbClassInfo","Bootstrap","executePendingDefers","AbstractBasicWidget","getDomString","Break","Operate","coord2sv","x","y","hue","radius","hue2angle","Math","PI","Sx","sin","Sy","cos","Wx","Wy","Bx","By","WBx","WBy","SBx","SBy","CBx","CBy","uv","util","Color","solve2d","u","min","max","v","abs","construct","props","_this","constructor","call","base","getBaseColors","__P_54_0","r","g","b","w","__P_54_1","LimitedRateUpdateAnimator","__P_54_2","setAnimationSpeed","__P_54_3","layout","ResizeHandler","states","addListener","__P_54_4","__P_54_5","Set","Object","entries","getAddress","map","variantInfo","__P_54_6","destruct","removeListenerById","__P_54_7","controls","baseColors","sendOnFinish","__P_54_8","__P_54_9","undefined","__P_54_10","__P_54_11","__P_54_12","__P_54_13","__P_54_14","__P_54_15","__P_54_16","placeholder","getFormat","self","retval","historicWidth","getLayout","colspan","getControls","split","forEach","control","parts","temperatures","rgbTmin","xy2sRGB","temperature2xy","rgbTmax","disp","c","round","join","colors","_onDomReady","_this2","ColorChooser","prototype","__P_54_17","Function","throttle","__P_54_18","trailing","querySelectorAll","actor","addEventListener","data","variantType","addressObj","showInvalidDataErrorMessage","message","locale","Manager","tr","transform","selector","variant","Config","testMode","console","error","toString","core","notifications","Router","dispatchMessage","Transform","decode","Number","isFinite","get","h","s","invCurve","curve","scale","Map","_typeof","Y","notKnown","_defineProperty","__P_54_19","isVisible","instant","copy","changeComponent","delta","setTo","newColor","actorStyle","actors","type","className","replace","window","getComputedStyle","sv_element","inner","handle","handle_hue","isLCh","classList","contains","handle_hueTop","parseFloat","getPropertyValue","handle_hueWidth","innerRadius","outerRadius","button","range","buttonWidth","marginLeft","borderRadius","angle","LCh","getComponent","WSt","C","WSl","top","L","left","background","hsv","_WSt","_WSl","_angle","_LCh","_r","_g","_b","_hsv","transformOrigin","ratioComponent","length","clipPath","handleEvent","event","relCoordX","relCoordY","actorType","currentTarget","boundingRect","getBoundingClientRect","computedStyle","__P_54_20","paddingLeft","__P_54_21","clientX","clientY","sv","distSqrd","pow","clearlyOnWheel","closeToInerior","closeToTriangleCorners","atan2","boxSize","_sv","ratio","document","buttons","removeEventListener","_type","_type2","_actor","_radius","_sv2","_boxSize","_sv3","getSendOnFinish","_this3","typeCategory","includes","sendToBackend","t","HasAnimatedButton","getDesign","_action","path","isCanceled","designs","designStructureMap","oldDesign","textContent","newDesign","indexOf","URL","Location","getHref","regexp","RegExp","search","setHref","req","Uri","appendParamsToUrl","design","DesignToggle","HasChildren","noWidget","name","target","action","getTarget","TemplateEngine","getInstance","scrollToPage","getBubbles","stopPropagation","Group","hstyle","getAlign","container","getName","getChildrenDomString","getClasses","getStyle","Refresh","cropTop","cropBottom","widthFit","__P_55_0","imgStyle","getWidthFit","getCropTop","getCropBottom","bottom","__P_55_1","getPlaceholder","ResourceManager","toUri","parseUri","protocol","startsWith","handleUpdate","text","valueElem","getValueElement","display","setAttribute","_applyVisible","getRefresh","Image","updateType","suffix","sendValue","keys","parser","WidgetParser","extractLayout","getPageType","getUpdateType","__P_56_0","getSuffix","trim","imageChild","url","getSendValue","ImageTrigger","Info","anonymous","refine","InfoAction","HandleLongpress","downValue","shortDownValue","downLabel","upValue","shortUpValue","upLabel","isAbsolute","infoPosition","ret_val","actordown","getDownLabel","actorup","getUpLabel","actorinfo","getInfoPosition","getActors","initListeners","Registration","_onPointerDown","__P_57_0","element","parentNode","_onLongTap","__P_57_1","getCurrentTarget","isShort","isDown","getShortDownValue","getShortUpValue","getDownValue","getUpValue","bitMask","getIsAbsolute","bvalue","getBasicValue","getMin","getMax","getDownActor","getUpActor","getInfoActor","InfoTrigger","Line","showstatus","elementsPerLine","buttonConfiguration","mapping","getMapping","getElementsPerLine","config","getButtonConfiguration","sort","i","buttonConfig","label","mappedValue","defaultValueHandling","div","createElement","defaultValue2DOM","innerHTML","_processIncomingValue","applyTransform","children","index","Array","hasOwnProperty","isPressed","DeferredCall","remove","add","schedule","getActionValue","isAnonymous","MultiTrigger","scope","position","dynamic","visible","_navbarTop","_navbarLeft","_navbarRight","_navbarBottom","_touchX","_touchY","initializeNavbars","pos","elem","content","body","evt","touches","pPH","pagePartsHandler","navbars","Init","getApplication","getMobile","fadeVisible","composedPath","some","passive","enoughDistance","toRight","preventDefault","fadeNavbar","getGlobalPath","getPath","pop","getPosition","NavBar","Bus","subscribe","classes","i_right","setContainerClass","splice","counter","apply","hideWhenEmpty","__P_58_0","NotificationCenterBadge","center","NotificationCenter","getMessages","_onChangeCounter","_onChangeGlobalSeverity","disableBadge","ev","_skipNextEvent","getType","toggleVisibility","__P_58_1","getSeverities","getData","messages","isHideWhenEmpty","getCounter","removeListener","implement","IPage","__P_59_0","_onChangeVisible","parentPage","getParentPage","debug","tuple","property","defaultValue","charAt","toUpperCase","substr","bind","setInitialized","_initOnCreate","allPages","createFinal","unsubscribe","initialized","showTopNavigation","showFooter","showNavbarTop","showNavbarBottom","showNavbarLeft","showNavbarRight","backdropAlign","backdropType","linkVisible","size","backdrop","__P_59_1","__P_59_2","_applyNavbarVisibility","old","i_name","COLSPAN_CLASS","applyColumnWidths","getBackdrop","invalidateBackdrop","pageType","subpage","getFlavour","getSize","getBackdropAlign","getBackdropType","Page","ga","parseInt","list","Model","isWriteAddress","visu","write","encode","bindClickToWidget","activeScope","targetPath","_onScrollToPage","page_id","page","getInstanceById","model","getWidgetDataByElement","Tree","getParentWidget","pageJumps","markPageJumps","parentName","match","getTargetPath","getPageIdByPath","PageJump","wstyle","getWstyle","PageLink","addElementListener","_onPointerUp","off","PushButton","BasicUpdate","defaultUpdate","restart","reload","Reload","valElem","bg","Rgb","__P_60_0","coord","toFixed","createBarPath","startAngle","startArrowPoint","endAngle","endArrowPoint","getBBox","arguments","startArrowPointAngle","endArrowPointAngle","clockwise","rI","rIM","rM","rMO","rO","startInner","startMiddle","startOuter","centerInner","centerOuter","endInner","endMiddle","endOuter","startMiddleFlag","startEndFlag","endMiddleFlag","startMiddleDir","endMiddleDir","arc","start","end","flag","cw","Roundbar","rMax","isInside","a","rMiddle","uMiddle","lMiddle","dMiddle","d","l","createPointerPath","p","wx","wy","thickness","tx","ty","indicators","axisradius","axiswidth","axiscolor","ranges","minorradius","minorwidth","minorspacing","minorcolor","majorradius","majorwidth","majorposition","majorcolor","labels","labelstyle","arrowtype","spacing","overflowarrow","fontsize","textx","texty","textlength","textanchor","linespace","bboxgrow","currentRatioValue","targetRatioValue","__P_60_1","bboxAdd","bbox","setCurrentRatioValue","getIndicators","fill","setTargetRatioValue","getStart","e","getEnd","cntValues","svgMajor","svgMinor","svgLabels","svgRanges","svgIndicators","svgText","getAxisradius","getAxiswidth","sMax","eMax","indicator","startarrow","endarrow","BBox","getMinorwidth","getMinorspacing","rIn","getMinorradius","rOut","test","cnt","getMinorcolor","getMajorwidth","_rIn","getMajorradius","_rOut","getMajorposition","getMajorcolor","getLabelstyle","getLabels","labelnumber","alignmentBaseline","textAnchor","textAngle","orientation","_textAngle","labelid","$$user_path","align","getRanges","sRange","eRange","rRange","wRange","thisBBox","number","push","__P_60_2","showValue","getTexty","getTextanchor","getFontsize","getTextx","getLinespace","repeat","textDistribution","middle","textU","textD","getTextlength","html","getBboxgrow","getDebug","sectorPath","axisPath","stroke","getAxiscolor","getTargetRatioValue","tspan","from","getElementsByTagName","valueFormat","applyFormat","indicatorNumber","getElementsByClassName","targetAngle","getOverflowarrow","isBar","__P_61_0","__P_61_1","__P_61_2","requestAnimationFrame","__P_61_3","__P_61_4","__P_61_5","step","showInvalidValues","__P_61_6","__P_61_7","__P_61_8","__P_61_9","__P_61_10","Slide","__P_61_11","__P_61_12","__P_61_13","relaxDisplay","getStep","realValue","getShowInvalidValues","stepValue","floor","stepCount","factor","sign","setBasicValue","displayValue","setValue","applyStyling","replaceChildren","actorWidth","__P_61_14","_disposeObjects","newRatio","newValue","isPageSizeInvalid","actorStyles","onValue","offValue","getOffValue","getOnValue","Switch","Text","getNextMappedValue","Toggle","shortValue","Trigger","getShortThreshold","isShortDefault","getShortValue","set","$$type","unknownType","parentWidget","getUnknownType","Unknown","params","__P_62_0","getXhr","_applyUrl","setUrl","xhr","io","request","Xhr","method","accept","requestData","getParams","UrlTrigger","send","isAutoplay","video","pause","Video","frameborder","scrolling","webStyle","substring","getFrameborder","getBackground","getScrolling","addr","iframe","refreshAction","getAttribute","Web","variable","__P_63_0","_applyVariable","_onSuccess","executeWhenDomFinished","getRequest","getResponse","getVariable","WgPluginInfo","childObjects","WidgetInfoAction"],"mappings":"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","sourcesContent":["/* Audio.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The audio widget embeds an audio file, which can be automatically played by incoming data\n *\n * @widgetexample <settings>\n *   <screenshot name=\"audio_example\">\n *    <caption>Default example for defining an audio widget in the configuration</caption>\n *    <data address=\"0/0/0\">1</data>\n *   </screenshot>\n * </settings>\n * <audio id=\"audio_widget\" src=\"path/to/audio_file.mp3\">\n *   <layout colspan=\"4\" />\n *   <label>Audio</label>\n *   <address transform=\"DPT:1.001\" mode=\"read\">0/0/0</address>\n * </audio>\n *\n *\n * @author Markus Damman\n * @since 0.8.4 (2014)\n */\n  qx.Class.define('cv.ui.structure.pure.Audio', {\n    extend: cv.ui.structure.AbstractWidget,\n\n    include: cv.ui.common.Update,\n\n    /*\n    ******************************************************\n      PROPERTIES\n    ******************************************************\n    */\n    properties: {\n      src: { check: 'String', nullable: true },\n      id: { check: 'String', nullable: true },\n      width: { check: 'String', nullable: true },\n      height: { check: 'String', nullable: true },\n      autoplay: { check: 'Boolean', init: false },\n      loop: { check: 'Boolean', init: false },\n      thresholdValue: { check: 'Number', init: 1 }\n    },\n\n    /*\n    ******************************************************\n      MEMBERS\n    ******************************************************\n    */\n    members: {\n\n      // overridden\n      _getInnerDomString: function () {\n        // create the main structure\n        // create the actor\n        let style = '';\n        if (this.getWidth()) {\n style += 'width:' + this.getWidth() + ';'; \n}\n        if (this.getHeight()) {\n style += 'height:' + this.getHeight() + ';'; \n}\n        if (style !== '') {\n style = 'style=\"' + style + '\"'; \n}\n        const autoplay = (this.isAutoplay()) ? ' autoplay ' : '';\n        const loop = (this.isLoop()) ? ' loop ' : '';\n        return '<div class=\"actor\"><audio id=\"' + this.getId() + '\" ' + autoplay + loop + style + ' controls> <source src=\"' + this.getSrc()+ '\" > </audio> </div>';\n      },\n\n      // overridden\n      getActor: function() {\n        return this.getDomElement().querySelector('.actor audio');\n      },\n\n      /**\n       * Handles updates of incoming data for this widget\n       *\n       * @param address {String} Source address of the incoming data\n       * @param value {String} Incoming data\n       */\n      _update: function (address, value) {\n        const on = this.applyMapping(this.getThresholdValue());\n        if (value >= on) {\n          const audioWidget = this.getActor();\n          if (audioWidget.paused === true) {\n            audioWidget.play();\n          }\n        }\n      }\n    },\n\n    defer: function(statics) {\n      cv.ui.structure.WidgetFactory.registerClass('audio', statics);\n    }\n  });\n","/* Break.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A break tag is used to start in new line for a grouped and thereby tidy display of\n * elements on one page.\n *\n * <pre class=\"sunlight-highlight-xml\">\n * &lt;break/&gt;\n * </pre>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Break', {\n  extend: cv.ui.structure.AbstractBasicWidget,\n\n  /*\n   ******************************************************\n     MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    getDomString: function () {\n      return '<br/>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('break', statics);\n  }\n});\n","/* ColorChooser.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The ColorChooser let you select and display a color, e.g. for lighting effects.\n * It supports a RGB light source with red, green and blue light components as well\n * as a RGBW light source that also has a white channel.\n *\n * @widgetexample\n * <settings>\n *      <screenshot name=\"colorchooser_example\">\n *          <caption>ColorChooser, simple example</caption>\n *      </screenshot>\n * </settings>\n * <colorchooser>\n *   <layout colspan=\"6\" rowspan=\"4\"/>\n *   <label>RGB kitchen</label>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"r\">1/2/59</address>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"g\">1/2/60</address>\n *   <address transform=\"DPT:5.001\" mode=\"readwrite\" variant=\"b\">1/2/61</address>\n * </colorchooser>\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.ColorChooser', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Calculate the saturation and value from (x,y) relative widget coordinates\n     * based on a centered SV-triangle.\n     * @param x position for the calculation\n     * @param y position for the calculation\n     * @param hue value for the orientation of the triangle\n     * @param radius (outside) radius of the triangle\n     */\n    coord2sv: function(x, y, hue, radius) {\n      const hue2angle = 2 * Math.PI;\n      // coordinates of the triangle corners\n      const Sx = 0.5 - Math.sin(hue2angle * (-hue)) * radius; // 100% saturation\n      const Sy = 0.5 - Math.cos(hue2angle * (-hue)) * radius;\n      const Wx = 0.5 - Math.sin(hue2angle * (2/3-hue)) * radius; // 100% white\n      const Wy = 0.5 - Math.cos(hue2angle * (2/3-hue)) * radius;\n      const Bx = 0.5 - Math.sin(hue2angle * (1/3-hue)) * radius; // 100% black\n      const By = 0.5 - Math.cos(hue2angle * (1/3-hue)) * radius;\n      // differences to determine (u,v) coordinates of (x,y)\n      const WBx = Wx - Bx;\n      const WBy = Wy - By;\n      const SBx = Sx - Bx;\n      const SBy = Sy - By;\n      const CBx = x - Bx;\n      const CBy = y - By;\n      const uv = cv.util.Color.solve2d(WBx, WBy, SBx, SBy, CBx, CBy);\n      const u = Math.min(Math.max(0, uv[0]), 1);\n      const v = Math.min(Math.max(0, uv[1]), 1);\n      // convert (u,v) to S and V\n      const value = u + v;\n      const saturation = Math.abs(value) < 1e-3 ? 0 : v/value;\n      return [saturation, value];\n    }\n  },\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.base(arguments, props);\n\n    const base = this.getBaseColors();\n    this.__color = new cv.util.Color(base.r, base.g, base.b, base.w);\n    this.__animator = new cv.util.LimitedRateUpdateAnimator(this.__updateHandlePosition, this);\n    this.__animator.setAnimationSpeed(100, 0.5);\n    this.__pageSizeListener = cv.ui.layout.ResizeHandler.states.addListener('changePageSizeInvalid', () => {\n      this.__invalidateScreensize();\n    });\n    this.__components = new Set(Object.entries(this.getAddress()).map(v => v[1].variantInfo));\n    this.__lastBusValue = {};\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    cv.ui.layout.ResizeHandler.states.removeListenerById(this.__pageSizeListener);\n    this.__pageSizeListener = null;\n    this.__button = null;\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    controls: {\n      check: 'String'\n    },\n    baseColors: {\n      check: 'Object'\n    },\n    sendOnFinish: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __mode: '',\n    __colorOld: undefined,      // the color where the animation started\n    __colorCurrent: undefined,  // the current color of the running animation\n    __color: undefined,         // the current color of the widget, also the target for the animation\n    __lastBusValue: undefined,  // initialize with empty object in the constructor to prevent object being shared between instances\n    __animator: null,\n    __button: undefined, // cache for DOM element\n    __range: undefined,  // cache for DOM element\n    __actors: undefined,\n    __pageSizeListener: undefined,\n    __components: undefined, // set of all color components required to send\n    __inDrag: false,       // is the handle currently dragged?\n    __coordMin: undefined, // minimal screen coordinate of slider\n    __Tmin: 2000,   // minimal color temperature to show in slider\n    __Tmax: 12500,  // maximal color temperature to show in slider\n\n    // overridden\n    _getInnerDomString: function () {\n      const placeholder = this.getFormat() === '' ? '' : '-';\n      const self = this;\n      let retval = '';\n      const historicWidth = this.getLayout().colspan === undefined ? ' style=\"width:195px\"' : '';\n      let controls = this.getControls().split(';');\n      if (controls[0] === '') {\n        controls[0] = 'box';\n      }\n      controls.forEach(function(control) {\n        switch (control) {\n          case 'box':\n          case 'LCh-box': {\n            let hue_type = control === 'box' ? 'hsv_hue' : 'lch_hue';\n            retval += '<div class=\"actor cc_box\"><div class=\"hue ' + hue_type;\n            retval += '\"></div><div class=\"handle_hue\"></div><div class=\"sv_box\"><div class=\"inner\"></div><div class=\"handle\"></div></div></div>';\n            break;\n          }\n\n          case 'triangle':\n          case 'LCh-triangle': {\n            let hue_type = control === 'triangle' ? 'hsv_hue' : 'lch_hue';\n            retval += '<div class=\"actor cc_wheel\"><div class=\"hue ' + hue_type;\n            retval += '\"></div><div class=\"sv_triangle\"><div class=\"inner\"></div><div class=\"handle_hue\"></div><div class=\"handle\"></div></div></div>';\n            break;\n          }\n\n          case 'RGB-r':\n          case 'RGB-g':\n          case 'RGB-b':\n          case 'RGBW-r':\n          case 'RGBW-g':\n          case 'RGBW-b':\n          case 'RGBW-w':\n          case 'h':\n          case 's':\n          case 'v':\n          case 'LCh-L':\n          case 'LCh-C':\n          case 'LCh-h':\n          case 'Y':\n            retval += '<div class=\"actor cc_' + control + ` ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n              <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">`+placeholder+`</button>\n              <div class=\"ui-slider-range\" style=\"margin-left: 0px; clip-path: inset(0 100% 0 0);\"></div>\n            </div>`;\n            break;\n\n          default: {\n            let parts = control.split(':');\n            if (parts[0] === 'T') {\n              const temperatures = (parts[1] || '-').split('-');\n              self.__Tmin = Math.max(1667, Math.min(temperatures[0] || 2500, 25000));\n              self.__Tmax = Math.max(1667, Math.min(temperatures[1] || 9000, 25000));\n              const rgbTmin = cv.util.Color.xy2sRGB(cv.util.Color.temperature2xy(self.__Tmin));\n              const rgbTmax = cv.util.Color.xy2sRGB(cv.util.Color.temperature2xy(self.__Tmax));\n              const disp = c => [Math.round(255 * c.r), Math.round(255 * c.g), Math.round(255 * c.b)].join(',');\n              const colors = 'rgb(' + disp(rgbTmin) + '), rgb(' + disp(rgbTmax) + ')';\n\n              retval += `<div class=\"actor cc_T ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n                <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">` + placeholder + `</button>\n                <div class=\"ui-slider-range\" style=\"margin-left: 0px; clip-path: inset(0 100% 0 0);background: linear-gradient(90deg, ` + colors + `);\"></div>\n              </div>`;\n            }\n          }\n        }\n      });\n      return '<div class=\"actors\"'+historicWidth+'>' + retval + '</div>';\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n\n      this.__throttled = cv.util.Function.throttle(this.__onChangeValue, 250, {trailing: true}, this);\n\n      this.getDomElement().querySelectorAll('.actor').forEach(actor => actor.addEventListener('pointerdown', this));\n    },\n\n    _update: function (address, data) {\n      const addressObj = this.getAddress()[address];\n      const showInvalidDataErrorMessage = function () {\n        const message = qx.locale.Manager.tr(\n          'Updating ColorChooser with invalid data<br/>Address: \"%1\"<br/>transform: \"%2\"<br/>selector: \"%3\"<br/>variant: \"%4\"<br/>data: \"%5\"',\n          address,\n          addressObj.transform,\n          addressObj.selector,\n          addressObj.variant,\n          data\n        );\n        if (cv.Config.testMode === true) {\n          // eslint-disable-next-line no-console\n          console.error(message.toString());\n        }\n        cv.core.notifications.Router.dispatchMessage('cv.config.error', {message});\n      };\n\n      const transform = addressObj.transform;\n      let variant = addressObj.variantInfo;\n\n      let variantType;\n      let value = cv.Transform.decode(addressObj, data);\n      let base;\n\n      switch (variant) {\n        case 'h':\n        case 's':\n        case 'v':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value /= 100;\n          variantType = 'hsv-single';\n          break;\n\n        case 'hsv':\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = { h: value.get('h')/360, s: value.get('s')/100, v: value.get('v')/100 };\n          variantType = 'hsv';\n          break;\n\n        case 'RGB-r':\n        case 'RGB-g':\n        case 'RGB-b':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          base = this.getBaseColors()[variant.split('-')[1]];\n          value = cv.util.Color.invCurve(value, base.curve, base.scale);\n          variantType = 'rgb-single';\n          break;\n\n        case 'rgb':\n          base = this.getBaseColors();\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = {\n            r: cv.util.Color.invCurve(value.get('r'), base.r.curve, base.r.scale),\n            g: cv.util.Color.invCurve(value.get('g'), base.g.curve, base.g.scale),\n            b: cv.util.Color.invCurve(value.get('b'), base.b.curve, base.b.scale)\n          };\n          variantType = 'rgb';\n          break;\n\n        case 'RGBW-r':\n        case 'RGBW-g':\n        case 'RGBW-b':\n        case 'RGBW-w':\n          if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          base = this.getBaseColors()[variant.split('-')[1]];\n          value = cv.util.Color.invCurve(value, base.curve, base.scale);\n          variantType = 'rgbw-single';\n          break;\n\n        case 'rgbw':\n          base = this.getBaseColors();\n          if (value.get === undefined) {\n            showInvalidDataErrorMessage();\n            return;\n          }\n          value = {\n            r: cv.util.Color.invCurve(value.get('r'), base.r.curve, base.r.scale),\n            g: cv.util.Color.invCurve(value.get('g'), base.g.curve, base.g.scale),\n            b: cv.util.Color.invCurve(value.get('b'), base.b.curve, base.b.scale),\n            w: cv.util.Color.invCurve(value.get('w'), base.w.curve, base.w.scale)\n          };\n          variantType = 'rgbw';\n          break;\n\n        case 'x':\n        case 'y':\n          variantType = 'xyY';\n          break;\n\n        case 'Y':\n          if (value instanceof Map && value.get('YValid') !== false) {\n            value = value.get('Y');\n          } else if (!Number.isFinite(value)) {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n\n        case 'xy':\n          if (value instanceof Map && value.get('cValid') !== false) {\n            value = { x: value.get('x'), y: value.get('y') };\n          } else if (!(typeof value === 'object' && 'x' in value && 'y' in value)) {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n\n        case 'xyY':\n          if (value instanceof Map) {\n            variant = (value.get('cValid') !== false ? 'xy' : '') + (value.get('YValid') !== false ? 'Y' : '');\n            value = {\n              x: value.get('x'),\n              y: value.get('y'),\n              Y: value.get('Y')\n            };\n            if (variant === '') {\n              return; // no valid data in the value\n            }\n          } else {\n            showInvalidDataErrorMessage();\n            return; // nothing that can be done with this data\n          }\n          variantType = 'xyY';\n          break;\n      }\n\n      if (this.__inDrag || (this.__lastBusValue[variantType] && this.__lastBusValue[variantType][variant] && this.__lastBusValue[variantType][variant][transform] === data)) {\n        // slider in use -> ignore value from bus\n        // internal state unchanged -> also do nothing\n        return;\n      }\n      const notKnown = this.__lastBusValue[variantType] === undefined;\n      if (notKnown) {\n        this.__lastBusValue[variantType] = {};\n      }\n\n      // forget all other transforms as they might not be valid anymore\n      this.__lastBusValue = {[variantType]: this.__lastBusValue[variantType]};\n      this.__lastBusValue[variantType][variant] = {[transform]: data};\n\n      // animate when visible, otherwise jump to the target value\n      this.__setSliderTo(value, variant, !this.isVisible() || notKnown);\n    },\n\n    /**\n     * The the internal slider state and its handle and displayed value\n     * @param {number} value The new value\n     * @param {string} variant The color component to change\n     * @param {boolean} instant Animate or instant change\n     * @private\n     */\n    __setSliderTo: function(value, variant, instant) {\n      this.__colorOld = this.__colorCurrent === undefined ? this.__color.copy() : this.__colorCurrent.copy();\n      this.__color.changeComponent(variant, value);\n      instant = instant || this.__color.delta(this.__colorOld) < 0.5;\n      if (!instant) {\n        this.__animator.setTo(this.__colorOld, true, false);\n      }\n      this.__animator.setTo(this.__color, instant);\n    },\n\n    __updateHandlePosition: function (newColor) {\n      // check cache\n      if (this.__actors === undefined) {\n        let actors = {};\n        let actorStyle;\n        this.getDomElement().querySelectorAll('.actor').forEach(function (actor) {\n          let type = actor.className.replace(/.*cc_([^ ]*).*/, '$1');\n          switch (type) {\n            case 'box':\n            case 'wheel': {\n              actorStyle = window.getComputedStyle(actor);\n              let sv_element = type === 'box' ? actor.querySelector('.sv_box') : actor.querySelector('.sv_triangle');\n              let inner = sv_element.querySelector('.inner');\n              let handle = actor.querySelector('.handle');\n              let handle_hue = actor.querySelector('.handle_hue');\n              let hue = actor.querySelector('.hue');\n              actors[type] = {\n                isLCh: hue.classList.contains('lch_hue'),\n                sv_element: sv_element,\n                inner: inner,\n                handle: handle,\n                handle_hue: handle_hue,\n                handle_hueTop: parseFloat(window.getComputedStyle(handle_hue).getPropertyValue('top')),\n                handle_hueWidth: parseFloat(window.getComputedStyle(handle_hue).getPropertyValue('width')),\n                width: parseFloat(actorStyle.getPropertyValue('width')),\n                height: parseFloat(actorStyle.getPropertyValue('padding-top')),\n                innerRadius: parseFloat(window.getComputedStyle(sv_element).getPropertyValue('width')),\n                outerRadius: parseFloat(window.getComputedStyle(hue).getPropertyValue('width'))\n              };\n              break;\n            }\n\n            default: {\n              actorStyle = window.getComputedStyle(actor);\n              let button = actor.querySelector('button');\n              let range = actor.querySelector('.ui-slider-range');\n              actors[type] = {\n                button: button,\n                range: range,\n                width: parseFloat(actorStyle.getPropertyValue('width')),\n                buttonWidth: parseFloat(window.getComputedStyle(button).getPropertyValue('width'))\n              };\n              range.style.marginLeft = '-' + actorStyle.getPropertyValue('padding-left');\n              range.style.borderRadius = actorStyle.getPropertyValue('border-radius');\n            }\n          }\n        });\n        this.__actors = actors;\n      }\n\n      this.__colorCurrent = newColor;\n      // move handles\n      for (let type in this.__actors) {\n        let actor = this.__actors[type];\n        if (type === 'wheel') {\n          const Bt = 75;\n          const St = 0;\n          const Wt = 75;\n          const Bl = 50-85/2;\n          const Sl = 50;\n          const Wl = 50+85/2;\n          let angle;\n          if (actor.isLCh) {\n            let LCh = this.__colorCurrent.getComponent('LCh');\n            let r = cv.util.Color.curve(LCh.h, [246, 255,  46,   0, 246], 1);\n            let g = cv.util.Color.curve(LCh.h, [ 27, 224, 255, 136,  27], 1);\n            let b = cv.util.Color.curve(LCh.h, [136,  32, 224, 245, 136], 1);\n            angle = (LCh.h*360)+'deg';\n            const WSt = LCh.C*St + (1-LCh.C)*Wt;\n            const WSl = LCh.C*Sl + (1-LCh.C)*Wl;\n            actor.handle.style.top  = (LCh.L*WSt + (1-LCh.L)*Bt) + '%';\n            actor.handle.style.left = (LCh.L*WSl + (1-LCh.L)*Bl) + '%';\n            actor.inner.style.background = 'linear-gradient(210deg, transparent 45%, black 90%),linear-gradient(150deg, transparent 45%, white 90%),rgb('+[r, g, b].join(',')+')';\n          } else {\n            let hsv = this.__colorCurrent.getComponent('hsv');\n            angle = (hsv.h*360)+'deg';\n            const WSt = hsv.s*St + (1-hsv.s)*Wt;\n            const WSl = hsv.s*Sl + (1-hsv.s)*Wl;\n            actor.handle.style.top  = (hsv.v*WSt + (1-hsv.v)*Bt) + '%';\n            actor.handle.style.left = (hsv.v*WSl + (1-hsv.v)*Bl) + '%';\n            actor.inner.style.background = 'linear-gradient(210deg, transparent 45%, black 90%),linear-gradient(150deg, transparent 45%, white 90%),hsl('+angle+' 100% 50%)';\n          }\n          actor.sv_element.style.transform = 'rotate('+angle+')';\n        } else if (type === 'box') {\n          let angle;\n          if (actor.isLCh) {\n            let LCh = this.__colorCurrent.getComponent('LCh');\n            let r = cv.util.Color.curve(LCh.h, [246, 255,  46,   0, 246], 1);\n            let g = cv.util.Color.curve(LCh.h, [ 27, 224, 255, 136,  27], 1);\n            let b = cv.util.Color.curve(LCh.h, [136,  32, 224, 245, 136], 1);\n            angle = (LCh.h*360)+'deg';\n            actor.handle.style.top = (1-LCh.L) * 100 + '%';\n            actor.handle.style.left = (1-LCh.C) * 100 + '%';\n            actor.inner.style.background = 'linear-gradient(0deg, black 0%, transparent 50%, white 100%), linear-gradient(90deg,rgb('+[r, g, b].join(',')+'), #808080 100%)';\n          } else {\n            let hsv = this.__colorCurrent.getComponent('hsv');\n            angle = (hsv.h*360)+'deg';\n            actor.handle.style.top = (1-hsv.v) * 100 + '%';\n            actor.handle.style.left = (1-hsv.s) * 100 + '%';\n            actor.inner.style.background = 'linear-gradient(0deg, black 0%, transparent 50%, white 100%), linear-gradient(90deg,hsl('+angle+' 100% 50%), #808080 100%)';\n          }\n          actor.handle_hue.style.transform = 'rotate('+angle+')';\n          actor.handle_hue.style.transformOrigin = actor.handle_hueWidth/2 + 'px '+(actor.width/2 - actor.handle_hueTop)+'px'; //calc(195px / 2 - 3px)';\n        } else {\n          let ratioComponent = this.__colorCurrent.getComponent(type);\n          if (type === 'T') {\n            ratioComponent = (ratioComponent - this.__Tmin)/(this.__Tmax - this.__Tmin);\n          }\n          let length = Math.max(0, Math.min(ratioComponent, 1)) * actor.width;\n          actor.button.style.transform = 'translate3d(' + (length-actor.buttonWidth/2) + 'px, 0px, 0px)';\n          actor.range.style.clipPath = 'inset(0 ' + (1-ratioComponent)*100 + '% 0 0)';\n        }\n      }\n    },\n\n    __invalidateScreensize: function () {\n      this.__actors = undefined; // invalidate cached values\n      this.__animator.setTo(this.__color, true /* tmp */);\n    },\n\n    handleEvent: function (event) {\n      let relCoordX = 0;\n      let relCoordY = 0;\n      let actor;\n\n      switch (event.type) {\n        case 'pointerdown': {\n          let actorType = event.currentTarget.className.replace(/.*cc_([^ ]*).*/, '$1');\n          actor = this.__actors[actorType];\n          let boundingRect = event.currentTarget.getBoundingClientRect();\n          let computedStyle = window.getComputedStyle(event.currentTarget);\n          this.__coordMinX = boundingRect.left + parseFloat(computedStyle.paddingLeft);\n          this.__coordMinY = boundingRect.top;\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          if (actorType === 'wheel') {\n            let radius = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            let sv = cv.ui.structure.pure.ColorChooser.coord2sv(relCoordX, relCoordY, this.__color.getComponent(actor.isLCh ? 'LCh' : 'hsv').h, radius);\n            let distSqrd = (relCoordX - 0.5)**2 + (relCoordY - 0.5)**2;\n            if (distSqrd < (0.5*1.07)**2) { // ignore clicks outside of the wheel, with 7% safety margin on the outside\n              const clearlyOnWheel = (radius * 1.10)**2 < distSqrd; // with 10% safety margin to the interior triangle\n              const closeToInerior = radius**2 < distSqrd && !clearlyOnWheel;\n              const closeToTriangleCorners = (sv[1] < 0.01) || (sv[0] < 0.01 && sv[1] > 0.99) || (sv[0] > 0.99 && sv[1] > 0.99);\n              if (clearlyOnWheel || (closeToInerior && !closeToTriangleCorners)) {\n                this.__mode = 'wheel_h';\n                this.__color.changeComponent(actor.isLCh ? 'LCh-h' : 'h', 0.5 + Math.atan2(-relCoordX + 0.5, relCoordY - 0.5) / 2 / Math.PI);\n                this.__inDrag = true;\n              } else {\n                this.__mode = 'wheel_sv';\n                this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', sv);\n                this.__inDrag = true;\n              }\n            }\n          } else if (actorType === 'box') {\n            let boxSize = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            let x = relCoordX - 0.5;\n            let y = relCoordY - 0.5;\n            let sv = [-x / boxSize / 2 + 0.5, -y / boxSize / 2 + 0.5];\n            if ((Math.abs(x) < boxSize) && (Math.abs(y) < boxSize)) {\n              this.__mode = 'box_sv';\n              this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', sv);\n              this.__inDrag = true;\n            } else {\n              this.__mode = 'box_h';\n              this.__color.changeComponent(actor.isLCh ? 'LCh-h' : 'h', 0.5 + Math.atan2(-x, y) / 2 / Math.PI);\n              this.__inDrag = true;\n            }\n          } else {\n            let ratio = relCoordX;\n            if (actorType === 'T') {\n              ratio = this.__Tmin + ratio * (this.__Tmax - this.__Tmin);\n            }\n            this.__mode = actorType;\n            this.__color.changeComponent(actorType, ratio);\n            this.__inDrag = true;\n          }\n          if (this.__inDrag) {\n            document.addEventListener('pointermove', this);\n            document.addEventListener('pointerup', this);\n          } else {\n            this.__mode = undefined;\n          }\n          break;\n        }\n\n        case 'pointermove': {\n          if (!this.__inDrag) {\n            return;\n          }\n          if (event.buttons === 0) { // move with no button could only happen during debug sessions\n            this.__inDrag = false;\n            document.removeEventListener('pointermove', this);\n            document.removeEventListener('pointerup', this);\n          }\n          let type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n          actor = this.__actors[type];\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          break;\n        }\n\n        case 'pointerup': {\n          this.__inDrag = false;\n          document.removeEventListener('pointermove', this);\n          document.removeEventListener('pointerup', this);\n          const type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n          actor = this.__actors[type];\n          relCoordX = (event.clientX - this.__coordMinX) / actor.width;\n          relCoordY = (event.clientY - this.__coordMinY) / actor.height;\n          break;\n        }\n      }\n\n      if (event.type !== 'pointerdown') {\n        let type = this.__mode.split('_')[0]; // clamp \"wheel_*\" to \"wheel\"\n        let actor = this.__actors[type];\n        switch (this.__mode) {\n          case 'wheel_sv': {\n            const radius = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            const sv = cv.ui.structure.pure.ColorChooser.coord2sv(relCoordX, relCoordY, this.__color.getComponent(actor.isLCh ? 'LCh' : 'hsv').h, radius);\n            this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', [Math.min(Math.max(sv[0], 0), 1), Math.min(Math.max(sv[1], 0), 1)]);\n            break;\n          }\n          case 'box_sv': {\n            const boxSize = actor !== undefined ? (0.5 * actor.innerRadius / actor.outerRadius) : 1;\n            const x = relCoordX - 0.5;\n            const y = relCoordY - 0.5;\n            const sv = [-x / boxSize / 2 + 0.5, -y / boxSize / 2 + 0.5];\n            this.__color.changeComponent(actor.isLCh ? 'LCh-CL' : 'sv', [Math.min(Math.max(sv[0], 0), 1), Math.min(Math.max(sv[1], 0), 1)]);\n            break;\n          }\n          case 'wheel_h':\n          case 'box_h':\n            this.__color.changeComponent(actor.isLCh?'LCh-h':'h', 0.5 + Math.atan2(-relCoordX + 0.5, relCoordY - 0.5) / 2 / Math.PI);\n            break;\n          case 'T':\n            this.__color.changeComponent('T', this.__Tmin + Math.max(0, Math.min(relCoordX, 1)) * (this.__Tmax - this.__Tmin));\n            break;\n          default:\n            this.__color.changeComponent(this.__mode, relCoordX);\n        }\n      }\n      this.__animator.setTo(this.__color, true);\n      if (!this.getSendOnFinish() || event.type === 'pointerup') {\n        this.__throttled.call();\n      }\n    },\n\n    __onChangeValue: function() {\n      this.__components.forEach(type => {\n        let value = this.__color.getComponent(['xyY', 'x', 'y'].includes(type) ? 'xy' : type);\n        let typeCategory;\n        let base;\n\n        switch (type) {\n          case 'h':\n            value *= 360;\n            typeCategory = 'hsv-single';\n            break;\n\n          case 's':\n          case 'v':\n            value *= 100;\n            typeCategory = 'hsv-single';\n            break;\n\n          case 'hsv':\n            value = new Map([['h', value.h*360], ['s', value.s*100], ['v', value.v*100]]);\n            typeCategory = 'hsv';\n            break;\n\n          case 'RGB-r':\n          case 'RGB-g':\n          case 'RGB-b':\n            base = this.getBaseColors()[type.split('-')[1]];\n            value = cv.util.Color.curve(value, base.curve, base.scale);\n            typeCategory = 'rgb-single';\n            break;\n\n          case 'RGBW-r':\n          case 'RGBW-g':\n          case 'RGBW-b':\n          case 'RGBW-w':\n            base = this.getBaseColors()[type.split('-')[1]];\n            value = cv.util.Color.curve(value, base.curve, base.scale);\n            typeCategory = 'rgbw-single';\n            break;\n\n          case 'rgb':\n            base = this.getBaseColors();\n            value = new Map([\n              ['r', cv.util.Color.curve(value.r, base.r.curve, base.r.scale)],\n              ['g', cv.util.Color.curve(value.g, base.g.curve, base.g.scale)],\n              ['b', cv.util.Color.curve(value.b, base.b.curve, base.b.scale)]\n            ]);\n            typeCategory = 'rgb';\n            break;\n\n          case 'rgbw':\n            base = this.getBaseColors();\n            value = new Map([\n              ['r', cv.util.Color.curve(value.r, base.r.curve, base.r.scale)],\n              ['g', cv.util.Color.curve(value.g, base.g.curve, base.g.scale)],\n              ['b', cv.util.Color.curve(value.b, base.b.curve, base.b.scale)],\n              ['w', cv.util.Color.curve(value.w, base.w.curve, base.w.scale)]\n            ]);\n            typeCategory = 'rgbw';\n            break;\n\n          case 'xy':\n            value = new Map([\n              ['x', value.x],\n              ['y', value.y]\n            ]);\n            typeCategory = 'xyY';\n            break;\n\n          case 'xyY': {\n            let Y = this.__color.getComponent('Y');\n            value = new Map([\n              ['x', value.x],\n              ['y', value.y],\n              ['Y', Y]\n            ]);\n            typeCategory = 'xyY';\n            break;\n          }\n\n          case 'Y':\n            typeCategory = 'xyY';\n            break;\n\n          case 'x':\n          case 'y':\n            value = value[type];\n            typeCategory = 'xyY';\n            break;\n        }\n        if (this.__lastBusValue[typeCategory] === undefined) {\n          this.__lastBusValue[typeCategory] = {};\n        }\n        this.__lastBusValue[typeCategory][type] = this.sendToBackend(value, t => t.variantInfo===type, this.__lastBusValue[typeCategory][type]);\n      });\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('colorchooser', statics);\n  }\n});\n","/* DesignToggle.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to toggle through the available designs\n * @widgetexample\n * <designtoggle>\n *   <layout colspan=\"6\"/>\n *   <label>Change Design</label>\n * </designtoggle>\n *\n *\n *\n * @author Christian Mayer\n * @since 0.5.3 (2010)\n */\nqx.Class.define('cv.ui.structure.pure.DesignToggle', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.HasAnimatedButton],\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">' + cv.Config.getDesign() + '</div></div>';\n    },\n    /**\n     * Action performed when the widget got clicked\n     *\n     *\n     * @param path {String} - Internal path of the widget\n     * @param actor {Element} - DOMElement\n     * @param isCanceled {Boolean} - If true the action does nothing\n     */\n    _action: function(path, actor, isCanceled) {\n      if (isCanceled) {\n return; \n}\n\n      const designs = cv.Config.designStructureMap.pure;\n\n      const oldDesign = this.getDomElement().querySelector('.value').textContent;\n      const newDesign = designs[(designs.indexOf(oldDesign) + 1) % designs.length];\n\n      const URL = cv.util.Location.getHref();\n      const regexp = new RegExp('design=' + oldDesign);\n      if (URL.search(regexp) !== -1) { // has URL-parameter design\n        cv.util.Location.setHref(URL.replace(regexp, 'design='+newDesign));\n      } else {\n        const parts = cv.util.Location.getHref().split('#');\n        let req = qx.util.Uri.appendParamsToUrl(parts[0], {design: newDesign});\n        if (parts.length > 1) {\n          req += '#'+parts[1];\n        }\n        cv.util.Location.setHref(req);\n      }\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('designtoggle', statics);\n  }\n});\n","/* Group.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A group can be used to group a couple of widgets and optionally surround them with a border or name the group.\n *\n * @widgetexample <settings selector=\".widget_container[data-type=group]\">\n *  <screenshot name=\"group_with_border\">\n *    <caption>Group with border and name</caption>\n *    <data address=\"0/0/0\">1</data>\n *    <data address=\"0/0/1\">21</data>\n *  </screenshot>\n *  </settings>\n *  <group name=\"Example Group\">\n *    <layout colspan=\"6\" />\n *    <text><label>Some Text</label></text>\n *    <switch>\n *      <layout colspan=\"3\" />\n *      <label>Switch</label>\n *      <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *    </switch>\n *    <info format=\"%.1f C\">\n *      <layout colspan=\"3\" />\n *      <label>Temperature</label>\n *      <address transform=\"DPT:9.001\">0/0/1</address>\n *    </info>\n *  </group>\n *\n * @widgetexample <settings selector=\".widget_container[data-type=group]\">\n *  <screenshot name=\"group_without_border\">\n *    <caption>Hidden Group: no border no name</caption>\n *    <data address=\"0/0/0\">1</data>\n *    <data address=\"0/0/1\">21</data>\n *  </screenshot>\n *  </settings>\n *  <group nowidget=\"true\">\n *    <layout colspan=\"6\" />\n *    <text><label>Some Text</label></text>\n *    <switch>\n *      <layout colspan=\"3\" />\n *      <label>Switch</label>\n *      <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *    </switch>\n *    <info format=\"%.1f C\">\n *      <layout colspan=\"3\" />\n *      <label>Temperature</label>\n *      <address transform=\"DPT:9.001\">0/0/1</address>\n *    </info>\n *  </group>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Group', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    noWidget: {\n      check: 'Boolean',\n      init: false\n    },\n    name: {\n      check: 'String',\n      init: ''\n    },\n    target: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n\n    /**\n     * Action performed when the group got clicked. If a target is specified in the group attributes\n     * the action will switch to the page defined by the target.\n     *\n     *\n     * @param  event {Event}\n     */\n    action: function (event) {\n      if (this.getTarget()) {\n        cv.TemplateEngine.getInstance().scrollToPage(this.getTarget());\n        if (event.getBubbles()) {\n          event.stopPropagation();\n        }\n      }\n    },\n\n    // overridden, group has no actor\n    getActor: function() {\n      return this.getDomElement();\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.getDomElement().style['z-index'] = 1;\n    },\n\n    // overridden\n    getDomString: function () {\n      // heading style\n      let hstyle = '';\n      if (this.getAlign()) {\n        hstyle += 'style=\"text-align:' + this.getAlign() + '\"';\n      }\n\n      let container = '<div class=\"clearfix\">';\n      if (this.getName()) {\n        container += '<h2 ' + hstyle + '>' + this.getName() + '</h2>';\n      }\n\n      container += this.getChildrenDomString();\n      container += '</div>';\n\n      return '<div class=\"' + this.getClasses() + '\" ' + this.getStyle() + '>' + container + '</div>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('group', statics);\n  }\n});\n","/* Image.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an image to your visualization. Using the auto-refresh setting this widget can be used e.g. to show\n * a camera picture.\n *\n * @widgetexample\n * <image src=\"resource/icons/CometVisu_orange.png\" width=\"45px\" height=\"32px\">\n *   <layout colspan=\"2\" />\n * </image>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n * @asset(qx/static/blank.gif)\n */\nqx.Class.define('cv.ui.structure.pure.Image', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  include: [cv.ui.common.Refresh, cv.ui.common.Update ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    width      : { check: 'String', init: '100%' },\n    height     : { check: 'String', nullable: true },\n    cropTop    : { check: 'String' },\n    cropBottom : { check: 'String' },\n    src        : { check: 'String', init: '' },\n    widthFit   : { check: 'Boolean', init: false },\n    placeholder: {\n      check: ['none', 'src', 'hide', 'exclude'],\n      init: 'none'\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __src: null,\n\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      let imgStyle = '';\n      if (this.getWidth()) {\n        imgStyle += 'width:' + this.getWidth() + ';';\n      }\n      if (this.getWidthFit() === true) {\n        imgStyle += 'max-width:100%;';\n      }\n      if (this.getHeight()) {\n        imgStyle += 'height:' + this.getHeight() + ';';\n      }\n      if (this.getCropTop() !== '' || this.getCropBottom() !== '') {\n        let top = '0%';\n        let bottom = '';\n        if (this.getCropTop() !== '') {\n          top = '-' + this.getCropTop();\n          bottom = 'margin-bottom:' + top;\n        }\n        if (this.getCropBottom() !== '') {\n          bottom = 'margin-bottom:calc(' + top + ' - ' + this.getCropBottom() + ');';\n        }\n        imgStyle += 'object-position:0% ' + top + ';' + bottom;\n      }\n\n      let src = this.__getSrc();\n      if (!src) {\n        switch (this.getPlaceholder()) {\n          case 'hide':\n            src = qx.util.ResourceManager.getInstance().toUri('qx/static/blank.gif');\n            break;\n\n          case 'exclude':\n            imgStyle += 'display:none;';\n            break;\n\n          case 'src':\n            this.error('no src placeholder defined');\n            break;\n        }\n      }\n      return '<div class=\"actor\"><img src=\"' + src + '\" style=\"' + imgStyle + '\" /></div>';\n    },\n\n    /**\n     * Return the real src value\n     */\n    __getSrc: function() {\n      if (!this.__src) {\n        let src = this.getSrc();\n        const parsedUri = qx.util.Uri.parseUri(this.getSrc());\n        if (!parsedUri.protocol && !src.startsWith('/')) {\n          // is relative URI, use the ResourceManager\n          src = qx.util.ResourceManager.getInstance().toUri(src);\n        }\n        this.__src = src || '';\n      }\n      return this.__src;\n    },\n\n    handleUpdate: function(text, address) {\n      const valueElem = this.getValueElement();\n      if (!text) {\n        switch (this.getPlaceholder()) {\n          case 'src':\n            text = this.__getSrc();\n            valueElem.style.display = 'inline';\n            break;\n\n          case 'hide':\n            text = qx.util.ResourceManager.getInstance().toUri('qx/static/blank.gif');\n            valueElem.style.display = 'inline';\n            break;\n\n          case 'exclude':\n            valueElem.style.display = 'none';\n            break;\n        }\n      } else {\n        valueElem.style.display = 'inline';\n      }\n      valueElem.setAttribute('src', text);\n    },\n\n    // overridden\n    getValueElement: function() {\n      return this.getDomElement().querySelector('img');\n    },\n\n    // overridden\n    _applyVisible: function(value) {\n      const valueElem = this.getValueElement();\n      if (!valueElem || this.getRefresh() > 0) {\n        return;\n      }\n      if (value === true) {\n        valueElem.setAttribute('src', this.__getSrc());\n      } else {\n        valueElem.setAttribute('src', '');\n      }\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('image', statics);\n  }\n});\n","/* ImageTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an image like the {@link cv.ui.structure.pure.Image} widget, but additionally the image can be changed by incoming\n * data and can send data to the backend by clicking on it.\n * There are two modes to react on incoming data:\n *\n * <ul>\n *  <li><code>type=\"show\"</code>: Hides the image when incoming data === 0</li>\n *  <li><code>type=\"select\"</code>: Changes the image by appending the incoming data to the initial configured image source, or hide it when incoming data === 0</li>\n * </ul>\n * Example:\n * <pre class=\"sunlight-highlight-xml\">\n * &lt;imagetrigger src=\"resource/icons/comet\" suffix=\"svg\" sendValue=\"clicked\" type=\"select\"&gt;\n *    &lt;address transform=\"DPT:16.001\" mode=\"readwrite\"&gt;0/0/0&lt;/address&gt;\n * &lt;/imagetrigger&gt;\n * </pre>\n *\n * initially shows nothing. When the CometVisu receives the string <code>_icon</code> in address <code>0/0/0</code>,\n * the image <code>icons/comet_opt_icon.svg</code> is shown. When the CometVisu receives '0' on address <code>0/0/0</code>,\n * this image is hidden.\n *\n * @widgetexample <settings>\n *   <screenshot name=\"image_trigger\">\n *     <caption>Image changed by incoming data 'blue'</caption>\n *     <data address=\"0/0/0\">blue</data>\n *   </screenshot>\n *   <screenshot name=\"image_trigger_changes\">\n *     <caption>Image changed by incoming data 'grey'</caption>\n *     <data address=\"0/0/0\">grey</data>\n *   </screenshot>\n *  </settings>\n *  <imagetrigger src=\"resource/icons/CometVisu_\" suffix=\"png\" sendValue=\"clicked\" type=\"select\" width=\"45px\" height=\"32px\">\n *    <layout colspan=\"1\" />\n *    <address transform=\"DPT:16.001\" mode=\"readwrite\">0/0/0</address>\n *  </imagetrigger>\n *\n * @widgetexample <settings>\n *   <caption>Disable layout width by settings it to '0', to have widget with === image width</caption>\n *   <screenshot name=\"image_trigger_colspan0\">\n *     <data address=\"0/0/0\">1</data>\n *   </screenshot>\n *  </settings>\n *  <imagetrigger src=\"resource/icons/CometVisu_orange\" suffix=\"png\" sendValue=\"clicked\" type=\"show\" width=\"45px\" height=\"32px\">\n *    <layout colspan=\"0\" />\n *    <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *  </imagetrigger>\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.ImageTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.Refresh,\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    height: { check: 'String', nullable: true },\n    updateType: {check: 'String', init: ''},\n    width: {check: 'String', init: '100%'},\n    src: { check: 'String', nullable: true },\n    suffix: { check: 'String', nullable: true },\n    sendValue: { check: 'String', init: ''}\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      let style = '';\n      if (Object.keys(this.getLayout()).length === 0) {\n        style += cv.parser.WidgetParser.extractLayout(this.getLayout(), this.getPageType());\n      }\n      if (this.getHeight()) {\n        style += 'height:' + this.getHeight() + ';';\n      }\n      if (style.length > 0) {\n        style = ' style=\"'+style+'\"';\n      }\n\n      let actor = '<div class=\"actor\">';\n      if (this.getUpdateType() === 'show') {\n        actor += '<img src=\"' + this.__getUrl(this.getSrc() + '.' + this.getSuffix()) + '\"' + style.trim() + ' />';\n      } else {\n        actor += '<img src=\"\"' + style + ' />';\n      }\n\n      actor += '</div>';\n      return actor;\n    },\n\n    _update: function(address, value) {\n      const imageChild = this.getDomElement().querySelector('img');\n      if (this.getUpdateType() === 'show') {\n        if (value === 0) {\n          imageChild.style.display = 'none';\n        } else {\n          imageChild.setAttribute('src', this.__getUrl(this.getSrc() + '.' + this.getSuffix()));\n          imageChild.style.display = 'block';\n        }\n      } else if (this.getUpdateType() === 'select') {\n        if (value === 0) {\n          imageChild.style.display = 'none';\n        } else {\n          imageChild.setAttribute('src', this.__getUrl(this.getSrc() + value + '.' + this.getSuffix()));\n          imageChild.style.display = 'block';\n        }\n      }\n\n      //TODO: add value if mapping exists\n      //TODO: get image name from mapping\n      //TODO: add bitmask for multiple images\n      //TODO: add SVG-magics\n    },\n\n    __getUrl: function(url) {\n      const parsedUri = qx.util.Uri.parseUri(url);\n      if (!parsedUri.protocol && !url.startsWith('/')) {\n        // is relative URI, use the ResourceManager\n        url = qx.util.ResourceManager.getInstance().toUri(url);\n      }\n      return url;\n    },\n\n    _action: function() {\n      if (this.getSendValue() === '') {\n return; \n}\n      this.sendToBackend(this.getSendValue());\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('imagetrigger', statics);\n  }\n});\n","/* Info.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a dynamic field to the visu that can represent values from the BUS\n * (e.g. 14-byte text or temperature measurements).\n *\n * @widgetexample <settings>\n *   <caption>Show temperature in degree celsius</caption>\n *   <screenshot name=\"info_temp\">\n *     <data address=\"0/0/0\">19</data>\n *   </screenshot>\n * </settings>\n * <info format=\"%.1f C\">\n *   <label>outside temperature</label>\n *   <address transform=\"DPT:9.001\">0/0/0</address>\n * </info>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Info', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\">-</div></div>';\n    }\n  }\n});\n\n","/* InfoAction.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The infoaction widget is a combination of an info/text widget and an \"action\"-widget, e.g. switch or trigger.\n *\n * Use case: if you have a group of lights, you can show the number of lights currently switched on\n * and control the whole group in one widget.\n *\n * @widgetexample <settings>\n *   <caption>Example combines an info widget to show the number of lights currently switched on, and an Switch to control them</caption>\n *   <screenshot name=\"infoaction_lights\">\n *     <data address=\"0/0/0\">4</data>\n *     <data address=\"0/0/1\">1</data>\n *   </screenshot>\n * </settings>\n * <meta>\n *  <mappings>\n *    <mapping name=\"OnOff\">\n *      <entry value=\"0\">Off</entry>\n *      <entry value=\"1\">On</entry>\n *    </mapping>\n *  </mappings>\n *  <stylings>\n *    <styling name=\"GreyGreen\">\n *      <entry value=\"0\">grey</entry>\n *      <entry value=\"1\">green</entry>\n *    </styling>\n *  </stylings>\n * </meta>\n * <infoaction>\n *  <layout colspan=\"4\"/>\n *  <label>Lights</label>\n *  <widgetinfo>\n *    <info>\n *     <address transform=\"DPT:9.001\">0/0/0</address>\n *    </info>\n *  </widgetinfo>\n *  <widgetaction>\n *   <switch mapping=\"OnOff\" styling=\"GreyGreen\">\n *    <layout colspan=\"3\" />\n *    <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/1</address>\n *   </switch>\n *  </widgetaction>\n * </infoaction>\n *\n *\n *\n * @author Tobias Brutigam\n * @since 0.10.0 (as widget), 0.9.2 (as plugin)\n */\nqx.Class.define('cv.ui.structure.pure.InfoAction', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    }\n  },\n\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return this.getChildrenDomString();\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('infoaction', statics);\n  }\n});\n","/* InfoTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an element to the visu that contains two buttons and a value indication for feedback\n * from the BUS. (E.g. for multimedia control\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.InfoTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.Update,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.HandleLongpress\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    'downValue': {\n      check: 'Number',\n      init: 0\n    },\n    'shortDownValue': {\n      check: 'Number',\n      nullable: true\n    },\n    'downLabel': {\n      check: 'String',\n      nullable: true\n    },\n    'upValue': {\n      check: 'Number',\n      init: 0\n    },\n    'shortUpValue': {\n      check: 'Number',\n      nullable: true\n    },\n    'upLabel': {\n      check: 'String',\n      nullable: true\n    },\n    'isAbsolute': {\n      check: 'Boolean',\n      init: false\n    },\n    'min': {\n      check: 'Number',\n      init: 0\n    },\n    'max': {\n      check: 'Number',\n      init: 255\n    },\n    'infoPosition': {\n      check: ['left', 'middle', 'right'],\n      init: 'middle'\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create buttons + info\n      let ret_val = '<div style=\"float:left;\">';\n\n      let actordown = '<div class=\"actor switchUnpressed downlabel\" ';\n      if (this.getAlign()) {\n        actordown += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actordown += '>';\n      actordown += '<div class=\"label\">' + (this.getDownLabel() || '-') + '</div>';\n      actordown += '</div>';\n\n      let actorup = '<div class=\"actor switchUnpressed uplabel\" ';\n      if (this.getAlign()) {\n        actorup += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actorup += '>';\n      actorup += '<div class=\"label\">' + (this.getUpLabel() || '+') + '</div>';\n      actorup += '</div>';\n\n      let actorinfo = '<div class=\"actor switchInvisible\" ';\n      if (this.getAlign()) {\n        actorinfo += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actorinfo += '><div class=\"value\">-</div></div>';\n\n      switch (this.getInfoPosition()) {\n        case 'middle':\n          ret_val += actordown;\n          ret_val += actorinfo;\n          ret_val += actorup;\n          break;\n        case 'right':\n          ret_val += actordown;\n          ret_val += actorup;\n          ret_val += actorinfo;\n          break;\n        default:\n          ret_val += actorinfo;\n          ret_val += actordown;\n          ret_val += actorup;\n          break;\n      }\n\n      return ret_val + '</div>';\n    },\n\n    getActors: function() {\n      return this.getDomElement().querySelectorAll('.actor.uplabel, .actor.downlabel');\n    },\n\n    // overridden\n    initListeners: function() {\n      this.getActors().forEach(function(actor) {\n        qx.event.Registration.addListener(actor, 'pointerdown', this._onPointerDown, this);\n      }, this);\n    },\n\n    __findActor: function (element) {\n      while (!element.classList.contains('actor')) {\n        element = element.parentNode;\n        if (element.classList.contains('widget')) {\n          // thats too far\n          return null;\n        }\n      }\n      return element;\n    },\n\n    _onLongTap: function(event) {\n      this.__action(false, this.__findActor(event.getCurrentTarget()).classList.contains('downlabel'));\n    },\n\n    _action: function(event) {\n      this.__action(true, this.__findActor(event.getCurrentTarget()).classList.contains('downlabel'));\n    },\n\n    __action: function (isShort, isDown) {\n      let value;\n      if (isShort && this.getShortDownValue() !== null && this.getShortUpValue() !== null) {\n        value = isDown ? this.getShortDownValue() : this.getShortUpValue();\n      } else {\n        value = isDown ? this.getDownValue() : this.getUpValue();\n      }\n\n      const bitMask = (isShort ? 1 : 2);\n\n      if (this.getIsAbsolute()) {\n        let bvalue = parseFloat(this.getBasicValue());\n        if (!Number.isFinite(bvalue)) {\n          bvalue = 0; // anything is better than NaN...\n        }\n        value = bvalue + value;\n        value = Math.max(value, this.getMin());\n        value = Math.min(value, this.getMax());\n      }\n      this.sendToBackend(value, function(address) {\n        return !!(address.variantInfo & bitMask);\n      });\n    },\n\n    getDownActor: function() {\n      return this.getDomElement().querySelector('.actor.downlabel');\n    },\n\n    getUpActor: function() {\n      return this.getDomElement().querySelector('.actor.uplabel');\n    },\n\n    getInfoActor: function() {\n      return this.getDomElement().querySelector('.actor.switchInvisible');\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('infotrigger', statics);\n  }\n});\n","/* Line.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A line tag is used to display a horizontal line in the browser to allow for a grouped and thereby tidy display of\n * elements on one page. To specify the width of the line an optional &lt;layout/&gt;-child can be added.\n *\n * @widgetexample <settings selector=\"hr\">\n *   <caption>A line tag which uses 50% of the screen size (6 of 12 available columns)</caption>\n * </settings>\n * <line><layout colspan=\"6\"/></line>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Line', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    getDomString: function () {\n      return '<hr ' + (this.getClasses() ? 'class=\"'+this.getClasses()+'\"' : '') + '/>';\n    }\n  }\n});\n","/* MultiTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a widget with multiple buttons to the visu.\n * Thus, e.g. change the operating mode of the heating system\n * (Comfort -> Night -> Absent -> Frost protection) or create scene functions.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.MultiTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update, cv.ui.common.HasAnimatedButton],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    showstatus: {\n      check: 'Boolean',\n      init: false\n    },\n    elementsPerLine: {\n      check: 'Number',\n      init: 2\n    },\n    buttonConfiguration: {\n      check: 'Object',\n      nullable: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      let ret_val = '<div class=\"actor_container\" style=\"float:left\">';\n      const mapping = this.getMapping();\n      const elementsPerLine = this.getElementsPerLine();\n\n      const config = this.getButtonConfiguration();\n      const indices = Object.keys(config).sort();\n\n      indices.forEach(function (i) {\n        const buttonConfig = config[i];\n        let label = buttonConfig.label;\n        if (mapping) {\n          const mappedValue = this.defaultValueHandling(undefined, buttonConfig.value);\n          if (mappedValue !== buttonConfig.value || !label) {\n            const div = document.createElement('div');\n            this.defaultValue2DOM(mappedValue, div);\n            label = div.innerHTML;\n          }\n        }\n\n        if (label) {\n          ret_val += '<div class=\"actor switchUnpressed\"><div class=\"value\">' + label + '</div></div>';\n        }\n        if (elementsPerLine > 0 && i % elementsPerLine === 0) {\n          ret_val+= '<br/>';\n        }\n      }, this);\n      return ret_val + '</div>';\n    },\n\n    getActors: function() {\n      return this.getDomElement().querySelectorAll('.actor_container .actor');\n    },\n\n    // overridden, only transform the value, do not apply it to DOM\n    _processIncomingValue: function (address, data) {\n      return this.applyTransform(address, data);\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     */\n    handleUpdate: function () {\n      const children = this.getActors();\n      const buttonConfiguration = this.getButtonConfiguration();\n      children.forEach(function(actor) {\n        const index = Array.prototype.indexOf.call(children, actor) + 1;\n        if (Object.prototype.hasOwnProperty.call(buttonConfiguration, index)) {\n          const isPressed = ('' + this.getBasicValue()) === ('' + buttonConfiguration[index].value); // compare as string\n\n          // delay this a little bit to give the HasAnimatedButton stuff time to finish\n          // otherwise it might override the settings here\n          new qx.util.DeferredCall(function () {\n            actor.classList.remove(isPressed ? 'switchUnpressed' : 'switchPressed');\n            actor.classList.add(isPressed ? 'switchPressed' : 'switchUnpressed');\n          }, this).schedule();\n        }\n      }, this);\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @param event\n     */\n    getActionValue: function (event) {\n      const index = Array.prototype.indexOf.call(this.getDomElement().querySelectorAll('.actor_container .actor'), event.getCurrentTarget()) + 1;\n      return this.getButtonConfiguration()[index].value;\n    },\n\n    // overridden\n    initListeners: function() {\n      if (this.isAnonymous()) {\n return; \n}\n\n      this.getActors().forEach(function(actor) {\n        qx.event.Registration.addListener(actor, 'tap', this.action, this);\n        qx.event.Registration.addListener(actor, 'pointerdown', this._onPointerDown, this);\n      }, this);\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('multitrigger', statics);\n  }\n});\n","/* NavBar.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the widget navbar, you can add a navigation menu to the entire visu.\n * The menu can be displayed on a page (top, bottom, left, right).\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.NavBar', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    name: {\n      check: 'String',\n      nullable: true\n    },\n    scope: {\n      check: 'Number',\n      init: -1\n    },\n    width: {\n      check: 'String',\n      init: '300'\n    },\n    position: {\n      check: ['top', 'left', 'right', 'bottom'], \n      init: 'left'\n    },\n    dynamic: {\n      check: 'Boolean',\n      nullable : true,\n      init: null\n    },\n    visible: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    _navbarTop: '',\n    _navbarLeft: '',\n    _navbarRight: '',\n    _navbarBottom: '',\n    _touchX: null,\n    _touchY: null,\n\n    /**\n     * Called on setup.dom.finished event with high priority. Adds the navbar dom string\n     * to the DOM-Tree\n     */\n    initializeNavbars: function() {\n      ['Top', 'Left', 'Right', 'Bottom'].forEach(function(pos) {\n        if (this['_navbar'+pos]) {\n          const elem = document.querySelector('#navbar' + pos);\n          if (elem) {\n            elem.innerHTML += this['_navbar' + pos];\n          }\n        }\n      }, this);\n\n      const self = this;\n      // Event handlers to allow navbar fade in and fade out.\n      // Currently only implemented for the major use case of a left navbar.\n      // TODO add logic for other navbars as well\n      // Logic:\n      //   To fade in the touch must start on the left screen side and then\n      //   swipe right.\n      //   To fade out all places on the screen are fine.\n      //   There is a minimum swipe distance and the direction must be mostly\n      //   horizontal (up to +/-45 tolerance is allowed)\n      //   When during a valid swipe the direction is reversed the fading\n      //   action is also reverted.\n      const content = document.body.querySelector('#centerContainer');\n      content.addEventListener('touchstart', function (evt) {\n        const touches = evt.touches[0];\n        const pPH = cv.TemplateEngine.getInstance().pagePartsHandler;\n\n        if (pPH.navbars.left.dynamic === false ||\n          (!qx.core.Init.getApplication().getMobile() && pPH.navbars.left.dynamic !== true) ||\n          (pPH.navbars.left.fadeVisible && !evt.composedPath().some(i => i.id==='navbarLeft')) || // left navbar is visible, but the touch is somewhere else\n          (!pPH.navbars.left.fadeVisible && touches.clientX > 20)) { // left navbar is not visible but the finger isn't on the left end -> not relevant\n          return;\n        }\n\n        self._touchX = touches.clientX;\n        self._touchY = touches.clientY;\n      }, {passive: true});\n      content.addEventListener('touchend', function () {\n        self._touchX = null;\n        self._touchY = null;\n      }, false);\n      content.addEventListener('touchmove', function (evt) {\n        if (self._touchX === null) {\n          return; // early exit as this touch isn't relevant for us\n        }\n\n        const touches = evt.touches[0];\n        const x = touches.clientX - self._touchX;\n        const y = touches.clientY - self._touchY;\n        const necessaryDistance = 10;\n        const enoughDistance = Math.abs(x) > necessaryDistance;\n        const horizontal = Math.abs(x) > Math.abs(y);\n        const toRight = x > 0;\n        if (horizontal && enoughDistance) {\n          evt.preventDefault();\n          const pPH = cv.TemplateEngine.getInstance().pagePartsHandler;\n          if (toRight) {\n            self._touchX = touches.clientX - necessaryDistance;\n            self._touchY = touches.clientY;\n            if (!pPH.navbars.left.fadeVisible) {\n              pPH.fadeNavbar('Left', 'in', 250);\n            }\n          } else { // !toRight\n            self._touchX = touches.clientX + necessaryDistance;\n            self._touchY = touches.clientY;\n            if (pPH.navbars.left.fadeVisible) {\n              pPH.fadeNavbar('Left', 'out', 250);\n            }\n          }\n        }\n      }, {passive: false});\n    }\n  },\n  \n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n    },\n    \n    getGlobalPath: function () {\n      const id = this.getPath().split('_');\n      id.pop();\n      return id.join('_') + '_' + this.getPosition() + '_navbar';\n    },\n\n    // overridden\n    getDomString: function () {\n      let container = '<div class=\"' + this.getClasses() + '\" id=\"' + this.getGlobalPath() + '\">';\n      if (this.getName()) {\n        container += '<h2>' + this.getName() + '</h2>';\n      }\n      container += this.getChildrenDomString();\n\n      container += '</div>';\n\n      // add this to the navbars in DOM not inside the page\n      switch (this.getPosition()) {\n        case 'top':\n          this.self(arguments)._navbarTop += container;\n          break;\n\n        case 'left':\n          this.self(arguments)._navbarLeft += container;\n          break;\n\n        case 'right':\n          this.self(arguments)._navbarRight += container;\n          break;\n\n        case 'bottom':\n          this.self(arguments)._navbarBottom += container;\n          break;\n      }\n\n      return '';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('navbar', statics);\n    qx.event.message.Bus.subscribe('setup.dom.finished.before', statics.initializeNavbars, statics);\n  }\n});\n","/* NotificationCenterBadge.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Shows the current number of messages in {@link cv.ui.NotificationCenter} and opens it on click.\n *\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a centered text widget</caption>\n *   <screenshot name=\"text_example\" />\n * </settings>\n * <notificationcenterbadge>\n *  <layout colspan=\"0\" />\n * </notificationcenterbadge>\n *\n * @author Tobias Brutigam\n * @since 0.11.0\n */\nqx.Class.define('cv.ui.structure.pure.NotificationCenterBadge', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    const classes = props.classes.trim().split(' ');\n    const i_right = classes.indexOf('right');\n\n    if (i_right !== -1) {\n      // do not align, but float the container instead\n      this.setContainerClass('float-right');\n      classes.splice(i_right, 1);\n      props.classes = classes.join(' ');\n    }\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    counter: {\n      check: 'Number',\n      init: 0,\n      apply: '_applyCounter'\n    },\n    hideWhenEmpty: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __badgeElement: null,\n\n    _onDomReady: function() {\n      this.base(arguments);\n      const center = cv.ui.NotificationCenter.getInstance();\n      center.getMessages().addListener('changeLength', this._onChangeCounter, this);\n      this._onChangeCounter();\n      center.addListener('changedGlobalSeverity', this._onChangeGlobalSeverity, this);\n    },\n\n    // property apply\n    _applyVisible: function(value) {\n      // hide NotificationCenters own badge while we are visible\n      cv.ui.NotificationCenter.getInstance().disableBadge(value);\n    },\n\n    action: function(ev) {\n      if (this._skipNextEvent === ev.getType()) {\n        this._skipNextEvent = null;\n        return;\n      }\n      cv.ui.NotificationCenter.getInstance().toggleVisibility();\n    },\n\n    __getBadgeElement: function() {\n      if (!this.__badgeElement) {\n        this.__badgeElement = this.getDomElement().querySelector('.badge');\n      }\n      return this.__badgeElement;\n    },\n\n    _onChangeGlobalSeverity: function(ev) {\n      const classList = this.__getBadgeElement().classList;\n      classList.remove.apply(classList, cv.ui.NotificationCenter.getInstance().getSeverities());\n      if (ev.getData()) {\n        classList.add(ev.getData());\n      }\n    },\n\n    _onChangeCounter: function() {\n      const messages = cv.ui.NotificationCenter.getInstance().getMessages().length;\n      this.__getBadgeElement().innerHTML = ''+messages;\n      if (this.isHideWhenEmpty()) {\n        this.__getBadgeElement().style.display = messages === 0 ? 'none' : 'block';\n      }\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      let style = '';\n      if (this.isHideWhenEmpty() && this.getCounter() === 0) {\n        style = ' style=\"display: none;\"';\n      }\n      return '<div class=\"actor badge\"'+style+'>'+this.getCounter()+'</div>';\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    const center = cv.ui.NotificationCenter.getInstance();\n    center.getMessages().removeListener('changeLength', this._onChangeCounter, this);\n    center.removeListener('changedGlobalSeverity', this._onChangeGlobalSeverity, this);\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('notificationcenterbadge', statics);\n  }\n});\n","/* Page.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Creates a new sub page and adds a corresponding link to the current page.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Page', {\n  extend: cv.ui.structure.AbstractWidget,\n  implement: cv.ui.structure.IPage,\n\n  include: [\n    cv.ui.common.HasChildren,\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.__waitForProperties = ['showNavbarTop', 'showNavbarBottom', 'showNavbarLeft', 'showNavbarRight'];\n    this.base(arguments, props);\n\n    this.addListener('changeVisible', this._onChangeVisible, this);\n\n    // break out of the constructor\n    new qx.util.DeferredCall(function() {\n      const parentPage = this.getParentPage();\n      if (!parentPage) {\n        this.__waitForProperties = [];\n      } else {\n        this.debug('binding navbar visibility from ' + parentPage.getPath() + ' to ' + this.getPath());\n      }\n      [\n        ['showTopNavigation', true],\n        ['showFooter', true],\n        ['showNavbarTop', false],\n        ['showNavbarBottom', false],\n        ['showNavbarLeft', false],\n        ['showNavbarRight', false]\n      ].forEach(function (tuple) {\n        const property = tuple[0];\n        const defaultValue = tuple[1];\n        if (this['get' + property.charAt(0).toUpperCase() + property.substr(1)]() === null) {\n          // inherit from parent\n          if (parentPage) {\n            parentPage.bind(property, this, property);\n          } else {\n            // we have not parent page, because we are the root page, use the default value\n            this['set' + property.charAt(0).toUpperCase() + property.substr(1)](defaultValue);\n          }\n        }\n        if (!parentPage) {\n          this.setInitialized(true);\n        }\n      }, this);\n    }, this).schedule();\n\n    if (this.getAddress()) {\n      this._initOnCreate = true;\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    allPages : '',\n\n    /**\n     * Append the complete generated HTML code to the DOM tree at the end of the generation process\n     */\n    createFinal: function() { // special function - only for pages!\n      document.querySelector('#pages').innerHTML = this.allPages;\n      qx.event.message.Bus.unsubscribe('setup.dom.append', this.createFinal, this);\n    }\n\n  },\n\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    initialized: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeInitialized'\n    },\n\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    name: {\n      check: 'String',\n      init: '', nullable: true\n    },\n    showTopNavigation : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowTopNavigation'\n    },\n    showFooter        : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowFooter'\n    },\n    showNavbarTop : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarTop',\n      apply: '_applyNavbarVisibility'\n    },\n    showNavbarBottom : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarBottom',\n      apply: '_applyNavbarVisibility'\n    },\n    showNavbarLeft : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarLeft',\n      apply: '_applyNavbarVisibility'\n    },\n    showNavbarRight : {\n      check: 'Boolean',\n      nullable: true,\n      event: 'changeShowNavbarRight',\n      apply: '_applyNavbarVisibility'\n    },\n    backdropAlign     : {\n      init: '50% 50%',\n      nullable: true\n    },\n    backdropType      : { check: 'String', nullable: true },\n    linkVisible       : { check: 'Boolean', init: true, nullable: true },\n    size              : { check: 'String', nullable: true },\n    backdrop          : { check: 'String', nullable: true }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __waitForProperties: null,\n    __colspanClass: null,\n    __normalizedDomId: null,\n\n    _applyNavbarVisibility: function(value, old, name) {\n      if (value !== null) {\n        const i_name = this.__waitForProperties.indexOf(name);\n        if (i_name !== -1) {\n          this.__waitForProperties.splice(i_name, 1);\n        }\n        if (this.__waitForProperties.length === 0) {\n          this.setInitialized(true);\n        }\n      }\n    },\n\n    /**\n     * If the page gets visible the colspan sized must be checked\n     * @param ev {Event}\n     */\n    _onChangeVisible: function(ev) {\n      if (ev.getData()) {\n        if (this.__colspanClass !== cv.ui.layout.Manager.COLSPAN_CLASS) {\n          this.applyColumnWidths();\n        }\n        if (this.getBackdrop()) {\n          cv.ui.layout.ResizeHandler.invalidateBackdrop();\n        }\n      }\n    },\n\n    /**\n     * Set children column widths\n     */\n    applyColumnWidths: function() {\n      cv.ui.layout.Manager.applyColumnWidths('#'+this.getPath(), false);\n      this.__colspanClass = cv.ui.layout.Manager.COLSPAN_CLASS;\n    },\n\n    // overridden\n    getDomString: function() {\n      const pageType = this.getPageType();\n\n      const subpageClass = this.getFlavour() ? (' flavour_' + this.getFlavour()) : '';\n      let subpage = '<div class=\"page type_' + pageType + subpageClass + '\" id=\"' + this.getPath() + '\">';\n      let container = '<div class=\"clearfix\"><h1>' + this.getName() + '</h1>';\n\n      if (pageType === '2d') {\n        let size = 'width:100%;height:100%;';\n        switch (this.getSize()) {\n          case 'fixed':\n            size += 'object-fit:none;';\n            if (this.getBackdropAlign()) {\n              size += 'object-position:' + this.getBackdropAlign() + ';';\n            }\n            break;\n\n          case 'contained':\n            size += 'object-fit:contain;';\n            if (this.getBackdropAlign()) {\n              size += 'object-position:' + this.getBackdropAlign() + ';';\n            }\n            break;\n\n          default: // default: assume scaled\n        }\n\n        const backdrop = this.getBackdrop();\n        if (backdrop) {\n          container += '<' + this.getBackdropType() + ' src=\"' + qx.util.ResourceManager.getInstance().toUri(backdrop) + '\" style=\"position: absolute; top: 0px; left: 0px;z-index:-1;' + size + '\"/>';\n        }\n      } /* ---Disable 3D for 0.8---\n      else if (pageType === \"3d\" && false) {\n         var floorplan = JSFloorPlan3D( container, backdrop );\n         floorplan.moveToRoom( 'Underground', false, true, false );\n         container.data( 'JSFloorPlan3D', floorplan );\n         container.find('canvas').css({position: 'absolute', top: '0px', left: '0px', 'z-index':'-1', width:'100%',height:'100%'});\n         subpage.click( {JSFloorPlan3D:floorplan,callback:function(event){\n         var j = this.JSFloorPlan3D;\n         j.moveToRoom( j.getState('showFloor'), event.room.room, true, true, function(){\n         container.trigger( 'update3d', j );\n         });\n         }}, floorplan.translateMouseEvent );\n         $(window).bind( 'resize', function(){ floorplan.resize($('.page').width(), $('.page').height(), true);} );\n         if (page.getAttribute('azimut')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('azimut'), path + '_' );\n         address[ page.getAttribute('azimut') ] = [ 'DPT:9.001', 0, 'azimut' ];\n         }\n         if (page.getAttribute('elevation')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('elevation'), path + '_' );\n         address[ page.getAttribute('elevation') ] = [ 'DPT:9.001', 0, 'elevation' ];\n         };\n         if (page.getAttribute('floor')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('floor'), path + '_' );\n         address[ page.getAttribute('floor') ] = [ 'DPT:5.004', 0, 'floor' ];\n         };\n\n         $( childs ).each( function(i,a){\n         if( this.tagName === 'filter' )\n         {\n         var floorFilter = $(this).attr('floor');\n         var roomFilter  = $(this).attr('room');\n         childs.splice( i, 1 );                 // remove filter element\n         $(this).children().each( function(j){  // and add it's children\n         $(this).find('layout').attr({floorFilter:floorFilter,roomFilter:roomFilter});\n         childs.splice( i+j, 0, this );\n         });\n         }\n         });\n      } */\n      container += this.getChildrenDomString();\n      subpage += container + '</div></div>';\n      cv.ui.structure.pure.Page.allPages = subpage + cv.ui.structure.pure.Page.allPages;\n      return undefined;\n    },\n\n    _update: function(ga, data) {\n      // widgetData  = cv.data.Model.getInstance().getWidgetDataByElement( element );\n      // var value = this.defaultValueHandling( ga, data, widgetData );\n      // var type = widgetData.address[ ga ][2];\n      // switch( type )\n      // {\n      //   case 'azimut':\n      //     widgetData.JSFloorPlan3D.setState('currentAzimut', value, true);\n      //     element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     break;\n      //\n      //   case 'elevation':\n      //     widgetData.JSFloorPlan3D.setState('currentElevation', value, true);\n      //     element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     break;\n      //\n      //   case 'floor':\n      //     widgetData.JSFloorPlan3D.moveToRoom( value, false, true, true, function(){\n      //       element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     });\n      //     break;\n      //\n      //   default:\n      // TODO: data comparision has to be refactored to use DPT and a value\n      if (parseInt(data) === 1) {\n        cv.TemplateEngine.getInstance().scrollToPage(this.getPath());\n        this.sendToBackend('0');\n      }\n      // }\n    },\n\n    sendToBackend: function (value) {\n      if (this.getAddress) {\n        const list = this.getAddress();\n        for (let id in list) {\n          if (Object.prototype.hasOwnProperty.call(list, id)) {\n            const address = list[id];\n            if (cv.data.Model.isWriteAddress(address)) {\n              cv.TemplateEngine.getInstance().visu.write(id, cv.Transform.encode(address, value));\n            }\n          }\n        }\n      }\n    }\n  },\n\n  defer: function(statics) {\n    qx.event.message.Bus.subscribe('setup.dom.append', statics.createFinal, statics);\n  }\n});\n","/* PageJump.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The pagejump widget can be used to link the visu pages.\n * The function is similar to hyperlinks.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.PageJump', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.HasChildren,\n    cv.ui.common.HasAnimatedButton\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (props) {\n    if (!props.name) {\n      // when there is no name the widget has no actor as clickable subelement, so we need\n      // to bind the click events to the whole widget\n      props.bindClickToWidget = true;\n    }\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    target : {\n      check: 'String',\n      init: '0'\n    },\n    activeScope : {\n      check: ['target', 'path'],\n      init: 'target'\n    },\n    name : {\n      check: 'String',\n      nullable: true\n    },\n    targetPath : {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Handle page change events and update the active state of this PageJump\n     *\n     * @param ev {Event}\n     * @protected\n     */\n    _onScrollToPage: function(ev) {\n      const page_id = ev.getData();\n      const page = cv.ui.structure.WidgetFactory.getInstanceById(page_id);\n      const model = cv.data.Model.getInstance();\n      const name = page.getName();\n\n      // remove old active classes\n      document.querySelectorAll('.pagejump.active').forEach(function(elem) {\n        elem.classList.remove('active');\n      }, this);\n      document.querySelectorAll('.pagejump.active_ancestor').forEach(function(elem) {\n        elem.classList.remove('active_ancestor');\n      }, this);\n\n      // and set the new active ones\n      document.querySelectorAll('.pagejump').forEach(function(elem) {\n        const data = model.getWidgetDataByElement(elem);\n        if (name === data.target) {\n          elem.classList.add('active');\n        }\n      }, this);\n\n      // now set the active ancestors\n      let parentPage = cv.util.Tree.getParentWidget(page, 'page');\n      // set for all parent pages apart from the root page\n\n      const pageJumps = document.querySelectorAll('.pagejump');\n      const markPageJumps = function (parentName, elem) {\n        const data = model.getWidgetDataByElement(elem);\n        if (parentName === data.target || (data.activeScope === 'path' && (\n            (typeof data.path === 'string') && data.path.match(parentName + '$') ||\n            (typeof data.targetPath === 'string') && data.targetPath.match(parentName + '$'))\n        )) {\n          elem.classList.add('active_ancestor');\n        }\n      };\n\n      while (parentPage && cv.util.Tree.getParentWidget(parentPage, 'page')) {\n        pageJumps.forEach(function(elem) {\n markPageJumps(parentPage.getName(), elem); \n});\n        // recursively find pagejumps for parent pages\n        parentPage = cv.util.Tree.getParentWidget(parentPage, 'page');\n      }\n    }\n  },\n\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n\n    // overridden\n    _getInnerDomString: function() {\n      let actor = '<div class=\"actor switchUnpressed';\n      if (this.getAlign()) {\n        actor += ' ' + this.getAlign();\n      }\n      actor += '\">';\n      if (this.getName()) {\n        actor += '<div class=\"value\">' + this.getName() + '</div>';\n      }\n      actor += '</div>';\n      return actor + this.getChildrenDomString();\n    },\n\n    // overridden\n    action: function() {\n      let target = this.getTarget();\n      if (this.getTargetPath() !== null) {\n        target = cv.TemplateEngine.getInstance().getPageIdByPath(target, this.getTargetPath());\n      }\n      cv.TemplateEngine.getInstance().scrollToPage(target);\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('pagejump', statics);\n    qx.event.message.Bus.subscribe('path.pageChanged', statics._onScrollToPage, statics);\n  }\n});\n","/* PageLink.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * PageLink Widget for visible pages. Do not use this directly because the pagelink widget\n * is automatically added when you use a page widget with parameter <code>visible=true</code>.\n *\n * @author Tobias Brutigam\n * @since 0.10.0 (2017)\n */\nqx.Class.define('cv.ui.structure.pure.PageLink', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    name : {\n      check: 'String',\n      init: '',\n      nullable: true\n    },\n    wstyle : {\n      check: 'String',\n      init: ''\n    },\n    address : {\n      check: 'Object',\n      init: {}\n    },\n    bindClickToWidget: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    getDomString: function() {\n      const layout = this.getLayout();\n\n      const style = typeof layout === 'object' ? '' : 'style=\"' + cv.parser.WidgetParser.extractLayout(layout, this.getPageType()) + '\"';\n\n      let ret_val = '<div class=\"widget clearfix link pagelink ' + this.getClasses() + '\" ' + style + '>';\n      ret_val += '<div class=\"actor\" ' + this.getWstyle() + '><a href=\"javascript:void(0)\">' + this.getName() + '</a></div>';\n      ret_val += '</div>';\n      return ret_val;\n    },\n\n    // overridden\n    action: function() {\n      cv.TemplateEngine.getInstance().scrollToPage(this.getPath() + '_');\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('pagelink', statics);\n  }\n});\n","/* PushButton.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to the visu that sends a defined value to the BUS when you press and release.\n * E.g. pushing a 1 and releasing a 0. This makes it possible, for example,\n * to simulate a push button to open and close a garage door, blinds or blinds.\n *\n * @since 2013\n */\nqx.Class.define('cv.ui.structure.pure.PushButton', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    'downValue': {check: 'String', init: '1'},\n    'upValue': {check: 'String', init: '0'}\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    // overridden\n    initListeners: function() {\n      this.addElementListener('pointerdown', this._onPointerDown, this);\n      this.addElementListener('pointerup', this._onPointerUp, this);\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     *\n     * @param value {any} incoming data (already transformed + mapped)\n     */\n    handleUpdate: function (value) {\n      const actor = this.getActor();\n      // compare against the unmapped value\n      value = '' + this.getBasicValue();\n      const off = this.getUpValue();\n      actor.classList.remove(value === off ? 'switchPressed' : 'switchUnpressed');\n      actor.classList.add(value === off ? 'switchUnpressed' : 'switchPressed');\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @param event\n     */\n    getActionValue: function (event) {\n      if (event.type === 'pointerup') {\n        return this.getUpValue();\n      } \n        return this.getDownValue();\n    },\n\n    _onPointerUp: function () {\n      const sendValue = this.getUpValue();\n      this.sendToBackend(sendValue, function (address) {\n        return (!address.variantInfo || address.variantInfo === 'up');\n      });\n    },\n\n    _onPointerDown: function () {\n      const sendValue = this.getDownValue();\n      this.sendToBackend(sendValue, function (address) {\n        return (!address.variantInfo || address.variantInfo === 'down');\n      });\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('pushbutton', statics);\n  }\n});\n","/* Refresh.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the widget refresh, the visu is added a switch, which allows the visu to reload the displayed data.\n *\n * @author Christian Mayer\n * @since 2014\n */\nqx.Class.define('cv.ui.structure.pure.Refresh', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.HasAnimatedButton, cv.ui.common.BasicUpdate],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: 'String', nullable: true }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    _action: function() {\n      cv.TemplateEngine.getInstance().visu.restart(true);\n    }\n  }\n});\n","/* Reload.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the reload widget, the visu is added a switch, which allows to reload the full visu in the browser.\n *\n * @author Christian Mayer\n * @since 2014\n */\nqx.Class.define('cv.ui.structure.pure.Reload', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden, return undefined to prevent widget from being renderered into DOM\n    getDomString: function() {\n      return;\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return;\n    },\n\n    _update: function (address, data) {\n      const value = this.defaultValueHandling(address, data);\n      if (value > 0) {\n        cv.util.Location.reload(true);\n      }\n    }\n  }\n});\n","/* Rgb.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the RGB widget you can display a colour in the visu.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Rgb', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Update],\n\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\"></div></div>';\n    },\n\n    /**\n     * Updates the RGB widget by setting the background color\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data\n     */\n    _update: function(address, data) {\n      if (data === undefined || address === undefined) {\n        return;\n      }\n      const valElem = this.getValueElement();\n\n      const value = cv.Transform.decode(this.getAddress()[address], data);\n\n      let bg = window.getComputedStyle(valElem)['background-color'].replace(/[a-zA-Z()\\s]/g, '').split(/,/);\n      if (bg.length !== 3) {\n        bg = [0, 0, 0];\n      }\n      switch (this.getAddress()[address].variantInfo) {\n        case 'r':\n          bg[0] = value;\n          break;\n        case 'g':\n          bg[1] = value;\n          break;\n        case 'b':\n          bg[2] = value;\n          break;\n      }\n      valElem.style['background-color'] = 'rgb(' + bg[0] + ', ' + bg[1] + ', ' + bg[2] + ')';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('rgb', statics);\n  }\n});\n","/* Roundbar.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a display to the visu that can represent values from the BUS\n * and shows them with a round bar.\n *\n * @widgetexample <settings>\n *    <caption>Example roundbar widget</caption>\n *    <screenshot name=\"roundbar_simple\">\n *      <data address=\"3/3/1\">63.3</data>\n *    </screenshot>\n *  </settings>\n *  <roundbar>\n *      <address transform=\"DPT:9.001\" mode=\"read\">3/3/1</address>\n *  </roundbar>\n *\n * @author Christian Mayer\n * @since 0.12.0 (2020)\n */\nqx.Class.define('cv.ui.structure.pure.Roundbar', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (props) {\n    this.__indicatorDOMElement = [];\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    coord: function(position) {\n      return position.x.toFixed(1) + ' ' + position.y.toFixed(1);\n    },\n    /**\n     * Create the SVG path for the round bar.\n     * Angle = 0 === horizontal on the right\n     *\n     * @param startAngle {Float}\n     * @param startArrowPoint {Float}\n     * @param endAngle {Float}\n     * @param endArrowPoint {Float}\n     * @param radius {Float}\n     * @param width {Float}\n     * @param getBBox {Boolean} return the bounding box instead of the path itself\n     */\n    createBarPath: function(startAngle, startArrowPoint, endAngle, endArrowPoint, radius, width, getBBox = false) {\n      const startArrowPointAngle = startAngle + startArrowPoint;\n      const endArrowPointAngle = endAngle + endArrowPoint;\n\n      // The path to generate is using those positions:\n      // rO             -- outer --\n      // rMO        /// outermiddle \\\\\\\n      // rM      //       middle        \\\\\n      // rIM   /        innermiddle        \\\n      // rI   /         -- inner --         \\\n      //     |        /             \\        |\n      //     |_______|               |_______|\n      //       start      center        end\n      const clockwise = startAngle > endAngle ? 1 : 0;\n      const rI = radius;\n      const rIM = radius + width * 1 / 4;\n      const rM = radius + width * 2 / 4;\n      const rMO = radius + width * 3 / 4;\n      const rO = radius + width;\n      const startInner = {x: Math.cos(startAngle) * rI, y: -Math.sin(startAngle) * rI};\n      const startMiddle = {x: Math.cos(startArrowPointAngle) * rM, y: -Math.sin(startArrowPointAngle) * rM};\n      const startOuter = {x: Math.cos(startAngle) * rO, y: -Math.sin(startAngle) * rO};\n      const centerInner = {\n        x: Math.cos((startAngle + endAngle) / 2) * rI,\n        y: -Math.sin((startAngle + endAngle) / 2) * rI\n      };\n      const centerOuter = {\n        x: Math.cos((startAngle + endAngle) / 2) * rO,\n        y: -Math.sin((startAngle + endAngle) / 2) * rO\n      };\n      const endInner = {x: Math.cos(endAngle) * rI, y: -Math.sin(endAngle) * rI};\n      const endMiddle = {x: Math.cos(endArrowPointAngle) * rM, y: -Math.sin(endArrowPointAngle) * rM};\n      const endOuter = {x: Math.cos(endAngle) * rO, y: -Math.sin(endAngle) * rO};\n      const startMiddleFlag = Math.abs(startAngle - startArrowPointAngle) > Math.PI ? 1 : 0;\n      const startEndFlag = Math.abs(startAngle - endAngle) / 2 > Math.PI ? 1 : 0;\n      const endMiddleFlag = Math.abs(endAngle - endArrowPointAngle) > Math.PI ? 1 : 0;\n      const startMiddleDir = startAngle < startArrowPointAngle ? 1 : 0;\n      const endMiddleDir = endAngle < endArrowPointAngle ? 1 : 0;\n\n      /**\n       * @param start\n       * @param end\n       * @param r\n       * @param flag\n       * @param cw\n       */\n      function arc(start, end, r, flag, cw) {\n        return (start.x===end.x) && (start.y===end.y)\n          ? ''\n          : (Math.abs(start.x-end.x)+Math.abs(start.y-end.y) < 2)\n            ? 'L' + cv.ui.structure.pure.Roundbar.coord(end)\n            : ['A', r, r, 0, flag, cw, cv.ui.structure.pure.Roundbar.coord(end)].join(' ');\n      }\n\n      if (getBBox) {\n        const rMax = Math.max(rI, rO);\n        const isInside = function (a) {\n          return (startAngle < a && a < endAngle) || (startAngle > a && a > endAngle);\n        };\n        const rMiddle = isInside(-Math.PI * 4 / 2) || isInside(Math.PI * 0 / 2) ? rMax : startInner.x;\n        const uMiddle = isInside(-Math.PI * 3 / 2) || isInside(Math.PI * 1 / 2) ? -rMax : startInner.y;\n        const lMiddle = isInside(-Math.PI * 2 / 2) || isInside(Math.PI * 2 / 2) ? -rMax : startInner.x;\n        const dMiddle = isInside(-Math.PI * 1 / 2) || isInside(Math.PI * 3 / 2) ? rMax : startInner.y;\n        return {\n          u: Math.min(startInner.y, startMiddle.y, startOuter.y, endInner.y, endMiddle.y, endOuter.y, uMiddle),\n          d: Math.max(startInner.y, startMiddle.y, startOuter.y, endInner.y, endMiddle.y, endOuter.y, dMiddle),\n          l: Math.min(startInner.x, startMiddle.x, startOuter.x, endInner.x, endMiddle.x, endOuter.x, lMiddle),\n          r: Math.max(startInner.x, startMiddle.x, startOuter.x, endInner.x, endMiddle.x, endOuter.x, rMiddle)\n        };\n      }\n\n      // a thin bar path should just be a single line\n      if (width < 1.0) {\n        return [\n          'M', cv.ui.structure.pure.Roundbar.coord(startOuter),\n          arc(startOuter, centerOuter, rO, startEndFlag, clockwise),\n          arc(centerOuter, endOuter, rO, startEndFlag, clockwise)\n        ].join('');\n      }\n\n      return ['M', cv.ui.structure.pure.Roundbar.coord(startInner),\n        startArrowPointAngle === startAngle\n          ? 'L' + cv.ui.structure.pure.Roundbar.coord(startOuter)\n          : arc(startInner, startMiddle, rIM, startMiddleFlag, 1-startMiddleDir) +\n            arc(startMiddle, startOuter, rMO, startMiddleFlag, startMiddleDir),\n        arc(startOuter, centerOuter, rO, startEndFlag, clockwise),\n        arc(centerOuter, endOuter, rO, startEndFlag, clockwise),\n        endArrowPointAngle === endAngle\n          ? 'L' + cv.ui.structure.pure.Roundbar.coord(endInner)\n          : arc(endOuter, endMiddle, rMO, endMiddleFlag, 1-endMiddleDir) +\n            arc(endMiddle, endInner, rIM, endMiddleFlag, endMiddleDir),\n        arc(startInner, centerInner, rI, startEndFlag, 1-clockwise),\n        arc(centerInner, startInner, rI, startEndFlag, 1-clockwise),\n        'Z'\n      ].join('');\n    },\n    /**\n     * Create the SVG path for an pointer.\n     * @param angle {Float}\n     * @param p {Object} Indicator object\n     */\n    createPointerPath: function(angle, p) {\n      const s = Math.sin(angle);\n      const c = Math.cos(angle);\n      const wx = c * p.width;\n      const wy = s * p.width;\n\n      if (p.thickness > 0) {\n        const tx = -s * p.thickness / 2;\n        const ty = c * p.thickness / 2;\n        return [\n          'M', this.coord({x:c*p.radius+wx-tx, y: -(s*p.radius+wy-ty)}),\n          'L', this.coord({x:c*p.radius, y: -(s*p.radius)}),\n          'L', this.coord({x:c*p.radius+wx+tx, y: -(s*p.radius+wy+ty)})\n        ].join('');\n      } \n        return [\n          'M', this.coord({x:c*p.radius, y: -(s*p.radius)}),\n          'L', this.coord({x:c*p.radius+wx, y: -(s*p.radius+wy)})\n        ].join('');\n    }\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    type: { check: 'Array' },\n    indicators: { check: 'Array' },\n\n    min: { check: 'Number' },\n    max: { check: 'Number' },\n    axisradius: { check: 'Number' },\n    axiswidth: { check: 'Number' },\n    axiscolor: { check: 'String' },\n    ranges: { check: 'Array' },\n    minorradius: { check: 'Number' },\n    minorwidth: { check: 'Number' },\n    minorspacing: { check: 'String' },\n    minorcolor: { check: 'String' },\n    majorradius: { check: 'Number' },\n    majorwidth: { check: 'Number' },\n    majorposition: { check: 'String' },\n    majorcolor: { check: 'String' },\n    labels: { check: 'Array' },\n    labelstyle: { check: 'String' },\n    start: { check: 'Number' },\n    end: { check: 'Number' },\n    arrowtype: { check: 'Number' },\n    spacing: { check: 'Number' },\n    overflowarrow: { check: 'Boolean' },\n    fontsize: { check: 'Number' },\n    textx: { check: 'Number' },\n    texty: { check: 'Number' },\n    textlength: { check: 'Number' },\n    textanchor: { check: 'String' },\n    linespace: { check: 'Number' },\n    bboxgrow: { check: 'Object' },\n    debug: { check: 'Boolean' },\n    currentRatioValue: { check: 'Array', init: [] },\n    targetRatioValue: { check: 'Array', init: [] }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __animator: undefined,\n    __indicatorDOMElement: null,\n\n    // overridden\n    _getInnerDomString: function () {\n      /**\n       * Grow the bounding box to also contain the parameters x and y\n       * @param bbox {Object} The initial bounding box\n       * @param x {Float}\n       * @param y {Float}\n       * @returns {Object} The enlarged bounding box\n       */\n      function bboxAdd(bbox, x, y) {\n        if (bbox.u > y) {\n bbox.u = y; \n}\n        if (bbox.d < y) {\n bbox.d = y; \n}\n        if (bbox.l > x) {\n bbox.l = x; \n}\n        if (bbox.r < x) {\n bbox.r = x; \n}\n        return bbox;\n      }\n\n      this.setCurrentRatioValue(Array(this.getIndicators().length).fill(0));\n      this.setTargetRatioValue(Array(this.getIndicators().length).fill([0, false, false]));\n\n      const self = this;\n      const s = this.getStart();\n      const e = this.getEnd();\n      const min = this.getMin();\n      const max = this.getMax();\n      let cntValues = 0;\n      let svgMajor = '';\n      let svgMinor = '';\n      let svgLabels = '';\n      let svgRanges = '';\n      let svgIndicators = '';\n      let svgText = '';\n      const createBarPath = cv.ui.structure.pure.Roundbar.createBarPath;\n\n      // Determine the bounding box, first get the biggest radius that must fit\n      let rMax = this.getAxisradius() + this.getAxiswidth();\n      let sMax = 0;\n      let eMax = 0;\n      this.getIndicators().forEach(function (indicator) {\n        rMax = Math.max(rMax, indicator.radius, indicator.radius+indicator.width);\n        sMax = Math.max(sMax, indicator.startarrow);\n        eMax = Math.max(eMax, indicator.endarrow);\n      });\n      let BBox = createBarPath(s, sMax, e, eMax, rMax, 0, true);\n\n      if (this.getMinorwidth() > 0) {\n        let\n          spacing = parseFloat(this.getMinorspacing());\n          let rIn = this.getMinorradius();\n          let rOut = this.getMinorwidth() + rIn;\n\n        if (/^[0-9]+%/.test(this.getMinorspacing())) { // special case: percentage\n          spacing = (max-min) * spacing / 100;\n        }\n\n        svgMinor += '<path class=\"minor\" d=\"';\n        for (var angle=s, delta = (e-s)*spacing/(max-min), cnt=(max-min)/spacing; cnt >= 0; angle+=delta, cnt--) {\n          var\n            sin = Math.sin(angle);\n            var cos = Math.cos(angle);\n          svgMinor += [\n            'M', cv.ui.structure.pure.Roundbar.coord({x:cos*rIn, y:-sin*rIn }),\n            'L', cv.ui.structure.pure.Roundbar.coord({x:cos*rOut, y:-sin*rOut})\n          ].join('');\n\n          BBox = bboxAdd(BBox, cos*rIn, -sin*rIn);\n          BBox = bboxAdd(BBox, cos*rOut, -sin*rOut);\n        }\n        if (this.getMinorcolor() !== '') {\n svgMinor += '\" style=\"stroke:' + this.getMinorcolor(); \n}\n        svgMinor += '\" />';\n      }\n\n      if (this.getMajorwidth() > 0) {\n        let\n          rIn = this.getMajorradius();\n          let rOut = this.getMajorwidth() + rIn;\n\n        svgMajor += '<path class=\"major\" d=\"';\n\n        this.getMajorposition().split(';').forEach(function (position) {\n          switch (position) {\n            case 'min':\n              position = min;\n              break;\n\n            case 'max':\n              position = max;\n              break;\n          }\n          const angle = s + (e - s) * (position - min) / (max - min);\n          const sin = Math.sin(angle);\n          const cos = Math.cos(angle);\n          svgMajor += [\n            'M', cv.ui.structure.pure.Roundbar.coord({x:cos*rIn, y:-sin*rIn }),\n            'L', cv.ui.structure.pure.Roundbar.coord({x:cos*rOut, y:-sin*rOut})\n          ].join('');\n\n          BBox = bboxAdd(BBox, cos*rIn, -sin*rIn);\n          BBox = bboxAdd(BBox, cos*rOut, -sin*rOut);\n        });\n        if (this.getMajorcolor() !== '') {\n svgMajor += '\" style=\"stroke:' + this.getMajorcolor(); \n}\n        svgMajor += '\" />';\n      }\n\n      const labelstyle = this.getLabelstyle();\n      this.getLabels().forEach(function (label, labelnumber) {\n        const angle = s + (e - s) * (label.value - min) / (max - min);\n        const x = label.radius * Math.cos(angle);\n        const y = label.radius * -Math.sin(angle);\n        let alignmentBaseline = '';\n        let textAnchor = '';\n        let textAngle = 0;\n\n        if (label.orientation < 3) {\n          svgLabels += '<text class=\"axislabel\" x=\"' + x + '\" y=\"' + y + '\"';\n          switch (label.orientation) {\n            default:\n            case 0: // horizontal\n              if (x < 0) {\n                textAnchor = (['end', 'middle', 'start'])[label.position];\n              } else {\n                textAnchor = (['start', 'middle', 'end'])[label.position];\n              }\n              if (Math.abs(x) < 1) {\n                textAnchor = 'middle';\n              }\n              if (y < 0) {\n                alignmentBaseline = (['baseline', 'middle', 'hanging'])[label.position];\n              } else {\n                alignmentBaseline = (['hanging', 'middle', 'baseline'])[label.position];\n              }\n              if (Math.abs(y) < 1) {\n                alignmentBaseline = 'middle';\n              }\n              break;\n\n            case 1: { // parallel\n              let textAngle = -angle * 180 / Math.PI + 90;\n              if (y < 0) {\n                alignmentBaseline = (['baseline', 'middle', 'hanging'])[label.position];\n              } else {\n                alignmentBaseline = (['hanging', 'middle', 'baseline'])[label.position];\n                textAngle += 180;\n              }\n              textAnchor = 'middle';\n              svgLabels += ' transform=\"rotate(' + textAngle + ',' + x + ',' + y + ')\"';\n              break;\n            }\n\n            case 2: // perpendicular\n              textAngle = -angle * 180 / Math.PI;\n              if (x < 0) {\n                textAnchor = (['end', 'middle', 'start'])[label.position];\n                textAngle += 180;\n              } else {\n                textAnchor = (['start', 'middle', 'end'])[label.position];\n              }\n              alignmentBaseline = 'middle';\n              svgLabels += ' transform=\"rotate(' + textAngle + ',' + x + ',' + y + ')\"';\n              break;\n          }\n          svgLabels += ' dominant-baseline=\"' + alignmentBaseline + '\"';\n          svgLabels += ' text-anchor=\"' + textAnchor + '\"';\n\n          if (labelstyle !== '') {\n            svgLabels += ' style=\"' + labelstyle + '\"';\n          }\n\n          svgLabels += '>' + label.name + '</text>';\n        } else { // label.orientation >= 3 -> round\n          const labelid = self.$$user_path + '_label' + labelnumber;\n          const cw = s < e ? 0 : 1;\n          let path = '';\n          let align = '';\n\n          switch (label.orientation) {\n            case 3: // roundstart\n              path = ['M', x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y].join(' ');\n              break;\n\n            case 4: // roundmiddle\n              path = ['M', -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y].join(' ');\n              align = ' startOffset=\"50%\" text-anchor=\"middle\"';\n              break;\n\n            case 5: // roundend\n              path = ['M', x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y].join(' ');\n              align = ' startOffset=\"100%\" text-anchor=\"end\"';\n              break;\n          }\n          svgLabels += '<path style=\"stroke:none; fill:none; stroke-width:0\" id=\"' + labelid + '\" d=\"' + path + '\"/>';\n          svgLabels += '<text class=\"axislabel\"';\n\n          if (labelstyle !== '') {\n            svgLabels += ' style=\"' + labelstyle + '\"';\n          }\n\n          svgLabels += '><textPath href=\"#'+labelid+'\"' + align + '>' + label.name + '</textPath></text>';\n        }\n      });\n\n      this.getRanges().forEach(function (range) {\n        const sRange = (e - s) * (range.start - min) / (max - min) + s;\n        const eRange = (e - s) * (range.end - min) / (max - min) + s;\n        const rRange = range.radius || self.getAxisradius();\n        const wRange = range.width || self.getAxiswidth();\n        const thisBBox = createBarPath(sRange, 0, eRange, 0, rRange, wRange, true);\n        svgRanges += '<path class=\"range\" d=\"';\n        svgRanges += createBarPath(sRange, 0, eRange, 0, rRange, wRange);\n        if (range.style) {\n          svgRanges += '\" style=\"' + range.style;\n        }\n        svgRanges += '\" />';\n\n        BBox = bboxAdd(BBox, thisBBox.l, thisBBox.u);\n        BBox = bboxAdd(BBox, thisBBox.r, thisBBox.d);\n      });\n\n      this.__animator = [];\n      this.getIndicators().forEach(function (indicator, number) {\n        self.__animator.push(new cv.util.LimitedRateUpdateAnimator(self.__updateIndicatorPosition, self, number));\n        svgIndicators += '<path class=\"indicator\" style=\"' + indicator.style + '\" />';\n\n        if (indicator.showValue) {\n cntValues++; \n}\n      });\n\n      if (cntValues>0) {\n        svgText += '<text class=\"value\" y=\"'+this.getTexty()+'\"' +\n          ' text-anchor=\"' + this.getTextanchor() +'\"' +\n          ' font-size=\"' + this.getFontsize() + '\">' +\n          '<tspan x=\"'+this.getTextx()+'\" dy=\"0\">-</tspan>' +\n          ('<tspan x=\"'+this.getTextx()+'\" dy=\"' + this.getLinespace() + '\">-</tspan>').repeat(cntValues-1) +\n          '</text>';\n\n        const textDistribution = ({start: [0, 1], middle: [0.5, 0.5], end: [1, 0]})[this.getTextanchor()] || [0, 1];\n        const textU = Math.min(0, -this.getFontsize(), this.getLinespace() * (cntValues - 1) - (this.getLinespace() < 0 ? this.getFontsize() : 0));\n        const textD = Math.max(0, -this.getFontsize(), this.getLinespace() * (cntValues - 1) - (this.getLinespace() < 0 ? this.getFontsize() : 0));\n        BBox = bboxAdd(BBox, this.getTextx()-textDistribution[0]*this.getTextlength(), this.getTexty()+textU);\n        BBox = bboxAdd(BBox, this.getTextx()+textDistribution[1]*this.getTextlength(), this.getTexty()+textD);\n      }\n\n      let html = '<div class=\"actor\">' +\n        '<svg width=\"100%\" height=\"100%\" viewBox=\"' + [\n          BBox.l - this.getBboxgrow().l,\n          BBox.u - this.getBboxgrow().u,\n          BBox.r - BBox.l + this.getBboxgrow().l + this.getBboxgrow().r,\n          BBox.d - BBox.u + this.getBboxgrow().u + this.getBboxgrow().d\n        ].join(' ') + '\">';\n      if (this.getDebug()) {\n        html += '<rect width=\"'+(BBox.r-BBox.l)+'\" height=\"'+(BBox.d-BBox.u)+'\" x=\"'+(BBox.l)+'\" y=\"'+(BBox.u)+'\" stroke=\"blue\" fill=\"none\" />' +\n          '<rect width=\"'+(BBox.r-BBox.l + this.getBboxgrow().l + this.getBboxgrow().r)+'\" height=\"'+(BBox.d-BBox.u + this.getBboxgrow().u + this.getBboxgrow().d)+'\" x=\"'+(BBox.l - this.getBboxgrow().l)+'\" y=\"'+(BBox.u - this.getBboxgrow().u)+'\" stroke=\"green\" fill=\"none\" />' +\n          '<circle cx=\"0\" cy=\"0\" r=\"3\" fill=\"red\" />';\n      }\n\n      if (this.getAxisradius() > 0) {\n        const sectorPath = createBarPath(s, 0, e, 0, this.getAxisradius(), 0);\n        const axisPath = createBarPath(s, 0, e, 0, this.getAxisradius(), this.getAxiswidth());\n        const stroke = this.getAxiscolor() === '' ? undefined : this.getAxiscolor();\n        const fill = this.getAxiswidth() < 1 ? 'none' : stroke;\n        html +=\n          '<path class=\"sector\" d=\"'+sectorPath+' L0 0Z\"/>' +\n          '<path class=\"axis\" d=\"'+axisPath+'\" style=\"' +\n          (stroke ? 'stroke:'+stroke : '') +\n          (fill ? ';fill:' +fill : '') +\n          '\"/>';\n      }\n\n      html += svgMinor + svgMajor + svgRanges + svgLabels + svgIndicators + svgText;\n      html += '</svg></div>';\n\n      return html;\n    },\n\n    /**\n     * Updates the roundbar widget\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data\n     */\n    _update: function(address, data) {\n      if (data === undefined || address === undefined) {\n return; \n}\n      const self = this;\n      const value = cv.Transform.decode(this.getAddress()[address], data);\n      const target = this.getTargetRatioValue();\n      const tspan = Array.from(this.getDomElement().getElementsByTagName('tspan'));\n      const valueFormat = this.applyFormat(address, value);\n\n      this.getIndicators().forEach(function(indicator, i) {\n        if (address === indicator.address) {\n          target[i] = [\n            (Math.min(Math.max(value, indicator.min), indicator.max)-indicator.min)/(indicator.max-indicator.min),\n            value < indicator.min,\n            value > indicator.max\n          ];\n          if (tspan[i] !== undefined) {\n            tspan[i].textContent = valueFormat;\n          }\n          self.__animator[i].setTo(target[i][0], !self.isVisible());\n        }\n      });\n\n      this.setTargetRatioValue(target);\n    },\n\n    /**\n     * Callback to update the display of the indicators.\n     *\n     * Note: It is a design decision not to pool multiple updates in one requestAnimationFrame which might be beneficial\n     * performance wise. But as it's assumed that a typical visu config is only containing one roundbar per address\n     * a pooling wouldn't make a difference on the one hand but complicate the code on the other hand.\n     * Even with a few roundbars using the same address the performance impact is negligible.\n     * @param ratio\n     * @param indicatorNumber\n     */\n    __updateIndicatorPosition: function (ratio, indicatorNumber) {\n      if (this.__indicatorDOMElement.length === 0) {\n        // cache\n        this.__indicatorDOMElement = Array.from(this.getDomElement().getElementsByClassName('indicator'));\n      }\n\n      const indicator = this.getIndicators()[indicatorNumber];\n      const target = this.getTargetRatioValue()[indicatorNumber];\n      const startAngle = this.getStart();\n      const endAngle = this.getEnd();\n      let targetAngle = startAngle + ratio * (endAngle - startAngle);\n      const overflowarrow = this.getOverflowarrow();\n\n      if (!overflowarrow) {\n        targetAngle = (endAngle > startAngle)\n          ? Math.max(startAngle, targetAngle - indicator.endarrow)\n          : Math.min(startAngle, targetAngle - indicator.endarrow);\n      }\n      if (indicator.isBar) {\n        this.__indicatorDOMElement[indicatorNumber].setAttribute('d',\n          cv.ui.structure.pure.Roundbar.createBarPath(\n            startAngle,\n            (overflowarrow&&!(target[1]&&ratio<0.01)) ? 0 : indicator.startarrow,\n            targetAngle,\n            (overflowarrow&&!(target[2]&&ratio>0.99)) ? 0 : indicator.endarrow,\n            indicator.radius,\n            indicator.width\n          )\n        );\n      } else {\n        this.__indicatorDOMElement[indicatorNumber].setAttribute('d',\n          cv.ui.structure.pure.Roundbar.createPointerPath(targetAngle, indicator)\n        );\n      }\n    }\n  }\n});\n\n","/* Slide.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a horizontal slider to the visu. This can be used, for example, to dim a light or change temperature values.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Slide', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.base(arguments, props);\n    this.__animator = new cv.util.LimitedRateUpdateAnimator(this.__updateHandlePosition, this);\n    this.__pageSizeListener = cv.ui.layout.ResizeHandler.states.addListener('changePageSizeInvalid', () => {\n      // Quick fix for issue https://github.com/CometVisu/CometVisu/issues/1369\n      // make sure that the `__invalidateScreensize` is delayed so that\n      // reading the available spaces is valid.\n      // Just to be sure, wait for two frames\n      window.requestAnimationFrame(() => {\n        window.requestAnimationFrame(this.__invalidateScreensize.bind(this));\n      });\n    });\n    this.__lastBusValue = {};\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    cv.ui.layout.ResizeHandler.states.removeListenerById(this.__pageSizeListener);\n    this.__pageSizeListener = null;\n    this.__button = null;\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    min: {\n      check: 'Number',\n      init: 0\n    },\n    max: {\n      check: 'Number',\n      init: 100\n    },\n    step: {\n      check: 'Number',\n      init: 0.5\n    },\n    showInvalidValues: {\n      check: 'Boolean',\n      init: false\n    },\n    sendOnFinish: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __lastBusValue: null,\n    __animator: null,\n    __button: undefined, // cache for DOM element\n    __range: undefined, // cache for DOM element\n    __actorWidth: undefined,\n    __buttonWidth: undefined,\n    __pageSizeListener: undefined,\n    __inDrag: false, // is the handle currently dragged?\n    __coordMin: undefined, // minimal screen coordinate of slider\n\n    // overridden\n    _getInnerDomString: function () {\n      const placeholder = this.getFormat() === '' ? '' : '-';\n      return `\n        <div class=\"actor ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all\" style=\"touch-action: pan-y;\">\n          <button class=\"ui-slider-handle ui-state-default ui-corner-all\" draggable=\"false\" unselectable=\"true\" style=\"transform: translate3d(0px, 0px, 0px);\">`+placeholder+`</button>\n          <div class=\"ui-slider-range value\" style=\"margin-left: 0px; width: 0px;\"></div>\n        </div>\n      `;\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n\n      this.__throttled = cv.util.Function.throttle(this.__onChangeValue, 250, {trailing: true}, this);\n\n      this.getActor().addEventListener('pointerdown', this);\n    },\n\n    _update: function (address, data) {\n      let transform = this.getAddress()[address].transform;\n      if (this.__inDrag || this.__lastBusValue[transform] === data) {\n        // slider in use -> ignore value from bus\n        // internal state unchanged -> also do nothing\n        return;\n      }\n      this.__lastBusValue = {}; // forget all other transforms as they might not be valid anymore\n      this.__lastBusValue[transform] = data;\n\n      let value = cv.Transform.decode(this.getAddress()[address], data);\n\n      // animate when visible, otherwise jump to the target value\n      this.__setSliderTo(value, !this.isVisible());\n    },\n\n    /**\n     * The the internal slider state and its handle and displayed value\n     * @param value {Number} The new value\n     * @param instant {Boolean} Animate or instant change\n     * @param relaxDisplay {Boolean} Let the handle move to an unstable position\n     *   to give visual feedback that something does happen during interaction\n     * @returns realValue - the real value that is respecting the configured restraints\n     * @private\n     */\n    __setSliderTo: function(value, instant, relaxDisplay = false) {\n      let min = this.getMin();\n      let max = this.getMax();\n      let step = this.getStep();\n      if (step === 0 || Math.abs((max-min)/step) > 10000) {\n        // limit too small step size - it's not necessary to have more than\n        // 10000 steps for the range as even the biggest screen doesn't have\n        // that many pixels\n        step = (max-min)/10000;\n      }\n      let realValue = Math.min(Math.max(value, min), max);\n\n      if (!this.getShowInvalidValues()) {\n        // map to closest allowed value\n        let stepValue = Math.round((realValue - min) / step) * step + min;\n        // use max when the value is greater than the middle point between the\n        // biggest allowed step and the maximum\n        let maxSwitchValue = (Math.floor((max - min) / step) * step + min + max) / 2;\n        realValue = realValue < maxSwitchValue ? stepValue : max;\n      }\n\n      let ratio = max===min ? 0 : (realValue-min)/(max-min);\n\n      if (relaxDisplay) {\n        let valueRatio = max===min ? 0 : (Math.min(Math.max(value, min), max)-min)/(max-min);\n        let delta = ratio - valueRatio;\n        let stepCount = (max - min) / step;\n        let factor = (2*stepCount) ** 3;\n        ratio -= Math.min(factor * delta**4, Math.abs(delta)) * Math.sign(delta);\n      }\n\n      // store it to be able to suppress sending of unchanged data\n      this.setBasicValue(realValue);\n\n      if (this.getFormat() !== '') {\n        // #2: map it to a value the user wants to see\n        let displayValue = this.applyMapping(realValue);\n\n        // #3: format it in a way the user understands the value\n        displayValue = this.applyFormat(undefined, displayValue);\n        this.setValue(displayValue);\n\n        this.applyStyling(realValue);\n\n        let button = this.getDomElement().querySelector('button');\n        button.replaceChildren(); // delete anything inside\n        this.defaultValue2DOM(displayValue, button);\n      }\n\n      this.__animator.setTo(ratio, instant);\n      return realValue;\n    },\n\n    __updateHandlePosition: function (ratio) {\n      if (this.__button === undefined) {\n        let element = this.getDomElement();\n        this.__button = element.querySelector('button');\n        this.__range = element.querySelector('.ui-slider-range');\n      }\n      if (this.__button === null) {\n        // most likely reason: the widget / DOM tree was deleted (e.g. due to\n        // browsing to a new page or during unit tests)\n        this._disposeObjects('__animator');\n        return;\n      }\n      const actorWidth = this.__getActorWidth();\n      let length = actorWidth >= 1e10 ? 0 : ratio * actorWidth;\n      this.__button.style.transform = 'translate3d(' + (length - this.__buttonWidth / 2) + 'px, 0px, 0px)';\n      this.__range.style.width = length + 'px';\n    },\n\n    __invalidateScreensize: function () {\n      let min = this.getMin();\n      let max = this.getMax();\n      this.__actorWidth = undefined; // invalidate cached values\n      this.__animator.setTo(max===min ? 0 : (this.getBasicValue()-min)/(max-min), true);\n    },\n\n    handleEvent: function (event) {\n      let newRatio = 0;\n\n      switch (event.type) {\n        case 'pointerdown': {\n          this.__inDrag = true;\n          document.addEventListener('pointermove', this);\n          document.addEventListener('pointerup', this);\n          let boundingRect = event.currentTarget.getBoundingClientRect();\n          let computedStyle = window.getComputedStyle(event.currentTarget);\n          this.__coordMin = boundingRect.left + parseFloat(computedStyle.paddingLeft);\n          newRatio = (event.clientX - this.__coordMin) / this.__getActorWidth();\n          break;\n        }\n\n        case 'pointermove':\n          if (!this.__inDrag) {\n            return;\n          }\n          newRatio = (event.clientX - this.__coordMin) / this.__getActorWidth();\n          break;\n\n        case 'pointerup':\n          this.__inDrag = false;\n          document.removeEventListener('pointermove', this);\n          document.removeEventListener('pointerup', this);\n          newRatio = (event.clientX - this.__coordMin) / this.__getActorWidth();\n          break;\n      }\n\n      newRatio = Math.min(Math.max(newRatio, 0.0), 1.0); // limit to 0..1\n      let newValue = this.getMin() + newRatio * (this.getMax() - this.getMin());\n      const realValue = this.__setSliderTo(newValue, this.__inDrag, this.__inDrag);\n      if (!this.getSendOnFinish() || event.type === 'pointerup') {\n        this.__throttled.call(realValue);\n      }\n    },\n\n    __onChangeValue: function(value) {\n      this.__lastBusValue = this.sendToBackend(value, false, this.__lastBusValue);\n    },\n\n    __getActorWidth() {\n      if (this.__actorWidth === undefined || this.__buttonWidth === undefined) {\n        if (cv.ui.layout.ResizeHandler.states.isPageSizeInvalid()) {\n          return 1e10; // a no valid value that doesn't break other calculations\n        }\n        let actor = this.getDomElement().querySelector('.actor');\n        let actorStyles = window.getComputedStyle(actor);\n        this.__actorWidth = parseFloat(actorStyles.getPropertyValue('width'));\n        this.__buttonWidth = parseFloat(window.getComputedStyle(this.__button).getPropertyValue('width'));\n\n        this.__range.style.marginLeft = '-' + actorStyles.getPropertyValue('padding-left');\n        this.__range.style.borderRadius = actorStyles.getPropertyValue('border-radius');\n      }\n      return this.__actorWidth;\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('slide', statics);\n  }\n});\n","/* Switch.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The switch widget shows two states (e.g. ON and OFF) and can toggle between them.\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a switch widget using mapping and styling</caption>\n *   <screenshot name=\"switch_example_on\">\n *    <caption>Switch turned on</caption>\n *    <data address=\"0/0/0\">1</data>\n *   </screenshot>\n *   <screenshot name=\"switch_example_off\">\n *    <caption>Switch turned off</caption>\n *    <data address=\"0/0/0\">0</data>\n *   </screenshot>\n * </settings>\n * <meta>\n *  <mappings>\n *    <mapping name=\"OnOff\">\n *      <entry value=\"0\">O</entry>\n *      <entry value=\"1\">I</entry>\n *    </mapping>\n *  </mappings>\n *  <stylings>\n *    <styling name=\"GreyGreen\">\n *      <entry value=\"0\">grey</entry>\n *      <entry value=\"1\">green</entry>\n *    </styling>\n *  </stylings>\n * </meta>\n * <switch mapping=\"OnOff\" styling=\"GreyGreen\">\n *   <layout colspan=\"3\" />\n *   <label>Switch</label>\n *   <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n * </switch>\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Switch', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    onValue: {\n      check: 'String',\n      init: '1'\n    },\n    offValue: {\n      check: 'String',\n      init: '0'\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param value {any} incoming data (already transformed + mapped)\n     */\n    handleUpdate: function(value) {\n      const actor = this.getActor();\n      // compare against the unmapped value\n      value = this.getBasicValue();\n      const off = this.getOffValue();\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      actor.classList.remove(value == off ? 'switchPressed' : 'switchUnpressed'); // jshint ignore:line\n      actor.classList.add(value == off ? 'switchUnpressed' : 'switchPressed'); // jshint ignore:line\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @return {var}\n     */\n    getActionValue: function () {\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      return (this.getBasicValue() == this.getOffValue() ? this.getOnValue() : this.getOffValue()); // jshint ignore:line\n    }\n  }\n});\n","/* Text.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The text-tag defines static (non-changing) text to be displayed on a page. The content of a &lt;label&gt; with free text.\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a centered text widget</caption>\n *   <screenshot name=\"text_example\" />\n * </settings>\n * <text align=\"center\"><label>Example text</label></text>\n *\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Text', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '';\n    }\n  }\n});\n","/* Toggle.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The toggle widget is similar to the switch, but it can take more than two states.\n * Can be used to change the operating modes of the heating system.\n * Each time the toggle is pressed, the toggle takes the next possible state.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Toggle', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update, cv.ui.common.HasAnimatedButton],\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @return {var}\n     */\n    getActionValue: function () {\n      return this.getNextMappedValue(this.getBasicValue(), this.getMapping());\n    }\n  }\n});\n","/* Trigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to the visu with which exactly a defined value for a short,\n * as well as a defined value for a long key pressure, can be sent to the BUS,\n * e.g. for recalling and storing scenes or driving roller blinds. (Short = stop, long = drive).\n * The address for short and long term may vary.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Trigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.BasicUpdate,\n    cv.ui.common.HandleLongpress\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: 'String', init: '0' },\n    shortValue: { check: 'String', init: '0' }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue(), this.getDomElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Handle a short tap event and send the value for short pressing the trigger to the backend.\n     * If there is no short threshold set, this send the value for long presses to the backend.\n     */\n    _action: function() {\n      const value = (this.getShortThreshold() > 0 || this.isShortDefault()) ? this.getShortValue() : this.getSendValue();\n      this.sendToBackend(value, function(address) {\n        return !!(address.variantInfo & 1);\n      });\n    },\n\n    /**\n     * Handle a long tap event and send the value for long pressing the trigger to the backend.\n     */\n    _onLongTap: function() {\n      this.sendToBackend(this.getSendValue(), function(address) {\n        return !!(address.variantInfo & 2);\n      });\n    }\n  }\n});\n","/* Unknown.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Fallback widget shown when an unknown widget is defined in the configuration.\n * You must not use this one directly.\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Unknown', {\n  extend: qx.core.Object,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.set(props);\n  },\n\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    path: {\n      check: 'String',\n      init: ''\n    },\n    $$type: {\n      check: 'String',\n      init: 'Unknown'\n    },\n    unknownType: {\n      check: 'String',\n      init: ''\n    },\n    pageType: {\n      check: ['text', '2d', '3d'],\n      init: 'text'\n    },\n    parentWidget: {\n      check: 'cv.ui.structure.AbstractBasicWidget',\n      init: null\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    /**\n     * Returns the DOM-Element of this widget\n     * @return {Element} the DOM element\n     */\n    getDomElement: function () {\n      return document.querySelector('#' + this.getPath());\n    },\n\n    /**\n     * Return the HTML string for this widget\n     * @return {String} HTML code\n     */\n    getDomString: function () {\n      return '<div class=\"widget clearfix\"><pre>'+qx.locale.Manager.tr('unknown: %1', this.getUnknownType()) + '</pre></div>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('unknown', statics);\n  }\n});\n\n","/* UrlTrigger.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The UrlTrigger widget adds a button to the visualization that queries data from a URL in the background.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.UrlTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.BasicUpdate\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: 'String', init: '0' },\n    params: { check: 'String', init: '' },\n    url: { check: 'String', nullable: true, apply: '_applyUrl' }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __xhr: null,\n\n    getXhr: function () {\n      return this.__xhr;\n    },\n\n    // property apply\n    _applyUrl: function(value) {\n      if (value) {\n        if (!this.__xhr) {\n          const xhr = new qx.io.request.Xhr(qx.util.ResourceManager.getInstance().toUri(value));\n          xhr.set({\n            method: 'GET',\n            accept: 'application/html',\n            requestData: this.getParams()\n          });\n          this.__xhr = xhr;\n        } else {\n          this.__xhr.setUrl(qx.util.ResourceManager.getInstance().toUri(value));\n        }\n      }\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue(), this.getDomElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      let actor = '<div class=\"actor switchUnpressed ';\n      if (this.getAlign()) {\n        actor += this.getAlign();\n      }\n      actor += '\"><div class=\"value\"></div></div>';\n      return actor;\n    },\n\n    // overridden\n    _action: function() {\n      if (this.__xhr) {\n        this.__xhr.send();\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this._disposeObjects('__xhr');\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('urltrigger', statics);\n  }\n});\n","/* Video.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a video or live stream to the visu. Currently, most sources do not support this yet.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Video', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    width   : { check: 'String', nullable: true },\n    height  : { check: 'String', nullable: true },\n    src     : { check: 'String', init: '' },\n    autoplay: { check: 'Boolean', init: false }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      let style = '';\n      if (this.getWidth()) {\n        style += 'width:' + this.getWidth() + ';';\n      }\n      if (this.getHeight()) {\n        style += 'height:' + this.getHeight() + ';';\n      }\n      if (style !== '') {\n style = 'style=\"' + style + '\"'; \n}\n      const autoplay = this.isAutoplay() ? ' autoplay=\"autoplay\"' : '';\n      return '<div class=\"actor\"><video src=\"' + this.getSrc() + '\" ' + style + autoplay + '  controls=\"controls\" /></div>';\n    },\n\n    // overridden\n    getValueElement: function() {\n      return this.getDomElement().querySelector('video');\n    },\n\n    // overridden\n    _applyVisible: function(value) {\n      const video = this.getValueElement();\n      if (video) {\n        if (value === true && this.isAutoplay()) {\n          video.play();\n        } else {\n          video.pause();\n        }\n      }\n    }\n  }\n});\n","/* Web.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an area to the visu, where external websites can be displayed.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Web', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Update,\n    cv.ui.common.Refresh\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n\n    width: {\n      check: 'String',\n      nullable: true\n    },\n    height: {\n      check: 'String',\n      nullable: true\n    },\n    frameborder: {\n      check: 'Boolean',\n      init: false\n    },\n    background: {\n      check: 'String',\n      nullable: true\n    },\n    scrolling: {\n      check: ['auto', 'yes', 'no'],\n      nullable: true\n    },\n    src: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      let webStyle = this.getStyle();\n      if (webStyle !== '' && webStyle.startsWith('style=\"')) {\n        webStyle = webStyle.substring(7, webStyle.length-1);\n      }\n      if (this.getWidth()) {\n        webStyle += 'width:' + this.getWidth() + ';';\n      } else { // default width is 100% of widget space (fix bug #3175343 part 1)\n        webStyle += 'width: 100%;';\n      }\n      if (this.getHeight()) {\n        webStyle += 'height:' + this.getHeight() + ';';\n      }\n      if (this.getFrameborder() === false) {\n        webStyle += 'border: 0px;';\n      }\n      if (this.getBackground()) {\n        webStyle += 'background-color:' + this.getBackground() + ';';\n      }\n      if (webStyle !== '') {\n        webStyle = 'style=\"' + webStyle + '\"';\n      }\n\n      let scrolling = '';\n      if (this.getScrolling()) {\n        scrolling = 'scrolling=\"' + this.getScrolling() + '\"';\n      } // add scrolling parameter to iframe\n      return '<div class=\"actor\"><iframe src=\"' + this.getSrc() + '\" ' + webStyle + scrolling + '></iframe></div>';\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data (already transformed + mapped)\n     */\n    _update: function(address, data) {\n      let addr = this.getAddress()[address];\n      if (!addr) {\n        return;\n      }\n      if (data === 1) {\n        const iframe = this.getDomElement().querySelector('iframe');\n        this.refreshAction(iframe, iframe.getAttribute('src'));\n        // reset the value\n        cv.TemplateEngine.getInstance().visu.write(address, cv.Transform.encode(addr, 0));\n      }\n    }\n  }\n});\n\n","/* WgPluginInfo.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an dynamic field to the visu that shows live information from a WireGate plugin.\n * \n * Note: The service helper from\n * https://raw.githubusercontent.com/OpenAutomationProject/Wiregate/master/tools/wg-plugindb/wg-plugindb.php\n * must be \"installed\" in the directory /var/www/ (i.e. the web root)\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.WgPluginInfo', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    variable   : { check: 'String', nullable: true, apply: '_applyVariable' }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __request: null,\n\n    // property apply\n    _applyVariable: function(value) {\n      if (value) {\n        if (!this.__request) {\n          // create the request\n          this.__request = new qx.io.request.Xhr('/wg-plugindb.php?name=' + value);\n          this.__request.set({\n            accept: 'application/json'\n          });\n          this.__request.addListener('success', this._onSuccess, this);\n        } else {\n          this.__request.setUrl('/wg-plugindb.php?name=' + value);\n        }\n        cv.TemplateEngine.getInstance().executeWhenDomFinished(this.__request.send, this.__request);\n      }\n    },\n\n    getRequest: function () {\n      return this.__request;\n    },\n\n    /**\n     * Handle successful requests from {@link qx.io.request.Xhr}\n     * @param ev {Event}\n     */\n    _onSuccess: function(ev) {\n      const req = ev.getTarget();\n      const data = req.getResponse();\n      this.defaultUpdate(undefined, data[this.getVariable()], this.getValueElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Triggers an {@link qx.io.request.Xhr} request to query the plugin value\n     */\n    handleUpdate: function() {\n      if (this.__request) {\n        this.__request.send();\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this._disposeObjects('__request');\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('wgplugin_info', statics);\n  }\n});\n","/* WidgetInfoAction.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This is a helper class for the InfoAction widget it cannot be used directly\n *\n * @author Tobias Brutigam\n * @since 0.10.0 (as widget), 0.9.2 (as plugin)\n */\nqx.Class.define('cv.ui.structure.pure.WidgetInfoAction', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    childObjects: {check: 'Array', init: []}\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    getDomString: function () {\n      return this.getChildrenDomString();\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass('widgetinfo', statics);\n    cv.ui.structure.WidgetFactory.registerClass('widgetaction', statics);\n  }\n});\n"]}