{"version":3,"sources":["../../../source/class/cv/ui/structure/pure/Audio.js","../../../source/class/cv/ui/structure/pure/Break.js","../../../source/class/cv/ui/structure/pure/DesignToggle.js","../../../source/class/cv/ui/structure/pure/Group.js","../../../source/class/cv/ui/structure/pure/Image.js","../../../source/class/cv/ui/structure/pure/ImageTrigger.js","../../../source/class/cv/ui/structure/pure/Info.js","../../../source/class/cv/ui/structure/pure/InfoAction.js","../../../source/class/cv/ui/structure/pure/InfoTrigger.js","../../../source/class/cv/ui/structure/pure/Line.js","../../../source/class/cv/ui/structure/pure/MultiTrigger.js","../../../source/class/cv/ui/structure/pure/NavBar.js","../../../source/class/cv/ui/structure/pure/NotificationCenterBadge.js","../../../source/class/cv/ui/structure/pure/Page.js","../../../source/class/cv/ui/structure/pure/PageJump.js","../../../source/class/cv/ui/structure/pure/PageLink.js","../../../source/class/cv/ui/structure/pure/PushButton.js","../../../source/class/cv/ui/structure/pure/Refresh.js","../../../source/class/cv/ui/structure/pure/Reload.js","../../../source/class/cv/ui/structure/pure/Rgb.js","../../../source/class/cv/ui/structure/pure/Roundbar.js","../../../source/class/cv/ui/structure/pure/Slide.js","../../../source/class/cv/ui/structure/pure/Switch.js","../../../source/class/cv/ui/structure/pure/Text.js","../../../source/class/cv/ui/structure/pure/Toggle.js","../../../source/class/cv/ui/structure/pure/Trigger.js","../../../source/class/cv/ui/structure/pure/Unknown.js","../../../source/class/cv/ui/structure/pure/UrlTrigger.js","../../../source/class/cv/ui/structure/pure/Video.js","../../../source/class/cv/ui/structure/pure/Web.js","../../../source/class/cv/ui/structure/pure/WgPluginInfo.js","../../../source/class/cv/ui/structure/pure/WidgetInfoAction.js"],"names":["qx","Bootstrap","executePendingDefers","$$dbClassInfo","Class","define","extend","cv","ui","structure","AbstractWidget","include","common","Update","properties","src","check","nullable","id","width","height","autoplay","init","loop","thresholdValue","members","_getInnerDomString","style","this","getWidth","getHeight","isAutoplay","isLoop","getId","getSrc","getActor","getDomElement","querySelector","_update","address","value","applyMapping","getThresholdValue","audioWidget","paused","play","defer","statics","WidgetFactory","registerClass","pure","Audio","AbstractBasicWidget","getDomString","Break","Operate","HasAnimatedButton","construct","props","constructor","call","data","store","Json","util","ResourceManager","getInstance","toUri","addListener","ev","setAvailableDesigns","getData","availableDesigns","Config","getDesign","_action","path","actor","isCanceled","designs","getAvailableDesigns","oldDesign","textContent","newDesign","getItem","indexOf","length","URL","Location","getHref","regexp","RegExp","search","setHref","replace","parts","split","req","Uri","appendParamsToUrl","design","DesignToggle","HasChildren","noWidget","name","target","action","event","getTarget","TemplateEngine","scrollToPage","getBubbles","stopPropagation","_onDomReady","Group","prototype","base","hstyle","getAlign","container","getName","getChildrenDomString","getClasses","getStyle","Refresh","widthFit","__src","imgStyle","getWidthFit","__getSrc","parseUri","protocol","startsWith","getValueElement","_applyVisible","valueElem","getRefresh","setAttribute","Image","updateType","suffix","sendValue","Object","keys","getLayout","parser","WidgetParser","extractLayout","getPageType","getUpdateType","__getUrl","getSuffix","trim","imageChild","display","url","getSendValue","sendToBackend","ImageTrigger","Info","anonymous","refine","InfoAction","HandleLongpress","downValue","shortDownValue","downLabel","upValue","shortUpValue","upLabel","isAbsolute","min","max","infoPosition","ret_val","actordown","getDownLabel","actorup","getUpLabel","actorinfo","getInfoPosition","getActors","querySelectorAll","initListeners","forEach","Registration","_onPointerDown","__findActor","element","classList","contains","parentNode","_onLongTap","__action","getCurrentTarget","isShort","isDown","getShortDownValue","getShortUpValue","getDownValue","getUpValue","bitMask","getIsAbsolute","bvalue","parseFloat","getBasicValue","isNaN","Math","getMin","getMax","getDownActor","getUpActor","getInfoActor","InfoTrigger","Line","showstatus","elementsPerLine","buttonConfiguration","mapping","getMapping","getElementsPerLine","config","getButtonConfiguration","sort","i","buttonConfig","label","mappedValue","defaultValueHandling","undefined","defaultValue2DOM","e","_processIncomingValue","applyTransform","handleUpdate","children","index","Array","hasOwnProperty","isPressed","DeferredCall","remove","add","schedule","getActionValue","isAnonymous","MultiTrigger","scope","position","dynamic","visible","_navbarTop","_navbarLeft","_navbarRight","_navbarBottom","_touchX","_touchY","initializeNavbars","pos","elem","document","innerHTML","self","addEventListener","evt","touches","pPH","pagePartsHandler","navbars","left","mobileDevice","fadeVisible","clientX","clientY","x","y","enoughDistance","abs","toRight","fadeNavbar","getGlobalPath","getPath","pop","join","getPosition","NavBar","message","Bus","subscribe","classes","i_right","setContainerClass","splice","counter","apply","hideWhenEmpty","__badgeElement","NotificationCenterBadge","center","NotificationCenter","getMessages","_onChangeCounter","_onChangeGlobalSeverity","disableBadge","_skipNextEvent","getType","toggleVisibility","__getBadgeElement","getSeverities","messages","isHideWhenEmpty","getCounter","destruct","removeListener","implement","IPage","__waitForProperties","_onChangeVisible","parentPage","getParentPage","debug","tuple","property","defaultValue","charAt","toUpperCase","substr","bind","setInitialized","getAddress","_initOnCreate","allPages","createFinal","unsubscribe","initialized","showTopNavigation","showFooter","showNavbarTop","showNavbarBottom","showNavbarLeft","showNavbarRight","backdropAlign","backdropType","linkVisible","size","backdrop","__colspanClass","__normalizedDomId","_applyNavbarVisibility","old","i_name","layout","Manager","COLSPAN_CLASS","applyColumnWidths","getBackdrop","ResizeHandler","invalidateBackdrop","pageType","subpage","getFlavour","getSize","getBackdropAlign","getBackdropType","Page","ga","parseInt","list","Model","isWriteAddress","visu","write","Transform","encode","bindClickToWidget","activeScope","targetPath","_onScrollToPage","page_id","page","getInstanceById","model","getWidgetDataByElement","Tree","getParentWidget","pageJumps","markPageJumps","parentName","match","getTargetPath","getPageIdByPath","PageJump","wstyle","_typeof","getWstyle","PageLink","addElementListener","_onPointerUp","off","type","PushButton","BasicUpdate","defaultUpdate","restart","reload","Reload","valElem","decode","bg","window","getComputedStyle","bgs","Rgb","coord","toFixed","createBarPath","startAngle","startArrowPoint","endAngle","endArrowPoint","radius","getBBox","startArrowPointAngle","endArrowPointAngle","clockwise","rI","rIM","rM","rMO","rO","startInner","cos","sin","startMiddle","startOuter","centerInner","centerOuter","endInner","endMiddle","endOuter","startMiddleFlag","PI","startEndFlag","endMiddleFlag","startMiddleDir","endMiddleDir","arc","start","end","r","flag","cw","Roundbar","rMax","isInside","a","rMiddle","uMiddle","lMiddle","dMiddle","u","d","l","createPointerPath","angle","p","s","c","wx","wy","thickness","tx","ty","indicators","axisradius","axiswidth","axiscolor","ranges","minorradius","minorwidth","minorspacing","minorcolor","majorradius","majorwidth","majorposition","majorcolor","labels","labelstyle","arrowtype","spacing","overflowarrow","fontsize","textx","texty","textlength","textanchor","linespace","bboxgrow","currentRatioValue","targetRatioValue","bboxAdd","bbox","setCurrentRatioValue","getIndicators","fill","setTargetRatioValue","getStart","getEnd","cntValues","svgMajor","svgMinor","svgLabels","svgRanges","svgIndicators","svgText","getAxisradius","getAxiswidth","sMax","eMax","indicator","startarrow","endarrow","BBox","getMinorwidth","getMinorspacing","rIn","getMinorradius","rOut","test","delta","cnt","getMinorcolor","getMajorwidth","getMajorradius","getMajorposition","getMajorcolor","getLabelstyle","getLabels","labelnumber","alignmentBaseline","textAnchor","orientation","textAngle","labelid","$$user_path","align","getRanges","range","sRange","eRange","rRange","wRange","thisBBox","showValue","getTexty","getTextanchor","getFontsize","getTextx","getLinespace","repeat","textDistribution","middle","textU","textD","getTextlength","html","getBboxgrow","getDebug","sectorPath","axisPath","stroke","getAxiscolor","getTargetRatioValue","tspan","from","getElementsByTagName","valueFormat","applyFormat","animationFrame","getElementsByClassName","animateIndicators","indicatorElements","jumpToTarget","current","getCurrentRatioValue","every","this_i","getOverflowarrow","expSmoothedValue","targetAngle","isBar","requestAnimationFrame","readonly","addrIdx","__readonly","setValue","step","sendOnFinish","__main","__timerId","__slider","__initialized","__skipUpdatesFromSlider","Slide","slider","website","Slider","setFormat","getFormat","setConfig","getStep","setEnabled","getValue","throttled","Function","throttle","_onChangeValue","trailing","on","val","abort","isSendOnFinish","addClasses","find","__updateSlider","isVisible","Timer","once","updatePositions","isInPointerMove","error","finished","_lastBusValue","onValue","offValue","getOffValue","getOnValue","Switch","Text","getNextMappedValue","Toggle","shortValue","Trigger","getShortThreshold","isShortDefault","getShortValue","core","set","$$type","unknownType","parentWidget","locale","tr","getUnknownType","Unknown","params","__xhr","_applyUrl","setUrl","xhr","io","request","Xhr","method","accept","requestData","getParams","UrlTrigger","send","_disposeObjects","video","pause","Video","frameborder","background","scrolling","webStyle","getFrameborder","getBackground","getScrolling","addr","iframe","refreshAction","getAttribute","Web","variable","__request","_applyVariable","_onSuccess","executeWhenDomFinished","getResponse","getVariable","WgPluginInfo","childObjects","WidgetInfoAction"],"mappings":"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","sourcesContent":["/* Audio.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The audio widget embeds an audio file, which can be automatically played by incoming data\n *\n * @widgetexample <settings>\n *   <screenshot name=\"audio_example\">\n *    <caption>Default example for defining an audio widget in the configuration</caption>\n *    <data address=\"0/0/0\">1</data>\n *   </screenshot>\n * </settings>\n * <audio id=\"audio_widget\" src=\"path/to/audio_file.mp3\">\n *   <layout colspan=\"4\" />\n *   <label>Audio</label>\n *   <address transform=\"DPT:1.001\" mode=\"read\">0/0/0</address>\n * </audio>\n *\n *\n * @author Markus Damman\n * @since 0.8.4 (2014)\n */\n  qx.Class.define('cv.ui.structure.pure.Audio', {\n    extend: cv.ui.structure.AbstractWidget,\n\n    include: cv.ui.common.Update,\n\n    /*\n    ******************************************************\n      PROPERTIES\n    ******************************************************\n    */\n    properties: {\n      src: { check: \"String\", nullable: true },\n      id: { check: \"String\", nullable: true },\n      width: { check: \"String\", nullable: true },\n      height: { check: \"String\", nullable: true },\n      autoplay: { check: \"Boolean\", init: false },\n      loop: { check: \"Boolean\", init: false },\n      thresholdValue: { check: \"Number\", init: 1 }\n    },\n\n    /*\n    ******************************************************\n      MEMBERS\n    ******************************************************\n    */\n    members: {\n\n      // overridden\n      _getInnerDomString: function () {\n        // create the main structure\n        // create the actor\n        var style = '';\n        if (this.getWidth()) { style += 'width:' + this.getWidth() + ';'; }\n        if (this.getHeight()) { style += 'height:' + this.getHeight() + ';'; }\n        if (style !== '') { style = 'style=\"' + style + '\"'; }\n        var autoplay = (this.isAutoplay()) ? ' autoplay ' : '';\n        var loop = (this.isLoop()) ? ' loop ' : '';\n        return '<div class=\"actor\"><audio id=\"' + this.getId() + '\" ' + autoplay + loop + style + ' controls> <source src=\"' + this.getSrc()+ '\" > </audio> </div>';\n      },\n\n      // overridden\n      getActor: function() {\n        return this.getDomElement().querySelector(\".actor audio\");\n      },\n\n      /**\n       * Handles updates of incoming data for this widget\n       *\n       * @param address {String} Source address of the incoming data\n       * @param value {String} Incoming data\n       */\n      _update: function (address, value) {\n        var on = this.applyMapping(this.getThresholdValue());\n        if (value >= on) {\n          var audioWidget = this.getActor();\n          if (audioWidget.paused === true) {\n            audioWidget.play();\n          }\n        }\n      }\n    },\n\n    defer: function(statics) {\n      cv.ui.structure.WidgetFactory.registerClass(\"audio\", statics);\n    }\n  });\n","/* Break.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A break tag is used to start in new line for a grouped and thereby tidy display of\n * elements on one page.\n *\n * <pre class=\"sunlight-highlight-xml\">\n * &lt;break/&gt;\n * </pre>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Break', {\n  extend: cv.ui.structure.AbstractBasicWidget,\n\n  /*\n   ******************************************************\n     MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    getDomString: function () {\n      return '<br/>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"break\", statics);\n  }\n});","/* DesignToggle.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to toggle through the available designs\n * @widgetexample\n * <designtoggle>\n *   <layout colspan=\"6\"/>\n *   <label>Change Design</label>\n * </designtoggle>\n *\n *\n *\n * @author Christian Mayer\n * @since 0.5.3 (2010)\n */\nqx.Class.define('cv.ui.structure.pure.DesignToggle', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.HasAnimatedButton],\n\n  /*\n   ******************************************************\n   CONSTRUCTOR\n   ******************************************************\n   */\n  construct: function(props) {\n    this.base(arguments, props);\n    var store = new qx.data.store.Json(qx.util.ResourceManager.getInstance().toUri(\"designs/get_designs.php\"));\n    store.addListener(\"loaded\", function (ev) {\n      this.setAvailableDesigns(ev.getData());\n    }, this);\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    availableDesigns: { check: \"Array\", init: [] }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">' + cv.Config.getDesign() + '</div></div>';\n    },\n    /**\n     * Action performed when the widget got clicked\n     *\n     *\n     * @param path {String} - Internal path of the widget\n     * @param actor {Element} - DOMElement\n     * @param isCanceled {Boolean} - If true the action does nothing\n     */\n    _action: function( path, actor, isCanceled ) {\n      if( isCanceled ) { return; }\n\n      var designs = this.getAvailableDesigns();\n\n      var oldDesign = this.getDomElement().querySelector('.value').textContent;\n      var newDesign = designs.getItem((designs.indexOf(oldDesign) + 1) % designs.length);\n\n      var URL = cv.util.Location.getHref();\n      var regexp = new RegExp(\"design=\"+oldDesign);\n      if (URL.search(regexp) !== -1) { // has URL-parameter design\n        cv.util.Location.setHref(URL.replace(regexp, \"design=\"+newDesign));\n      }\n      else {\n        var parts = cv.util.Location.getHref().split(\"#\");\n        var req = qx.util.Uri.appendParamsToUrl(parts[0], {design: newDesign});\n        if (parts.length > 1) {\n          req += \"#\"+parts[1];\n        }\n        cv.util.Location.setHref(req);\n      }\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"designtoggle\", statics);\n  }\n});\n","/* Group.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A group can be used to group a couple of widgets and optionally surround them with a border or name the group.\n *\n * @widgetexample <settings selector=\".widget_container[data-type=group]\">\n *  <screenshot name=\"group_with_border\">\n *    <caption>Group with border and name</caption>\n *    <data address=\"0/0/0\">1</data>\n *    <data address=\"0/0/1\">21</data>\n *  </screenshot>\n *  </settings>\n *  <group name=\"Example Group\">\n *    <layout colspan=\"6\" />\n *    <text><label>Some Text</label></text>\n *    <switch>\n *      <layout colspan=\"3\" />\n *      <label>Switch</label>\n *      <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *    </switch>\n *    <info format=\"%.1f C\">\n *      <layout colspan=\"3\" />\n *      <label>Temperature</label>\n *      <address transform=\"DPT:9.001\">0/0/1</address>\n *    </info>\n *  </group>\n *\n * @widgetexample <settings selector=\".widget_container[data-type=group]\">\n *  <screenshot name=\"group_without_border\">\n *    <caption>Hidden Group: no border no name</caption>\n *    <data address=\"0/0/0\">1</data>\n *    <data address=\"0/0/1\">21</data>\n *  </screenshot>\n *  </settings>\n *  <group nowidget=\"true\">\n *    <layout colspan=\"6\" />\n *    <text><label>Some Text</label></text>\n *    <switch>\n *      <layout colspan=\"3\" />\n *      <label>Switch</label>\n *      <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *    </switch>\n *    <info format=\"%.1f C\">\n *      <layout colspan=\"3\" />\n *      <label>Temperature</label>\n *      <address transform=\"DPT:9.001\">0/0/1</address>\n *    </info>\n *  </group>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Group', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    noWidget: {\n      check: \"Boolean\",\n      init: false\n    },\n    name: {\n      check: \"String\",\n      init: \"\"\n    },\n    target: {\n      check: \"String\",\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n\n    /**\n     * Action performed when the group got clicked. If a target is specified in the group attributes\n     * the action will switch to the page defined by the target.\n     *\n     *\n     * @param  event {Event}\n     */\n    action: function (event) {\n      if (this.getTarget()) {\n        cv.TemplateEngine.getInstance().scrollToPage(this.getTarget());\n        if (event.getBubbles()) {\n          event.stopPropagation();\n        }\n      }\n    },\n\n    // overridden, group has no actor\n    getActor: function() {\n      return this.getDomElement();\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.getDomElement().style[\"z-index\"] = 1;\n    },\n\n    // overridden\n    getDomString: function () {\n      // heading style\n      var hstyle = '';\n      if (this.getAlign()) {\n        hstyle += 'style=\"text-align:' + this.getAlign() + '\"';\n      }\n\n      var container = '<div class=\"clearfix\">';\n      if (this.getName()) {\n        container += '<h2 ' + hstyle + '>' + this.getName() + '</h2>';\n      }\n\n      container += this.getChildrenDomString();\n      container += '</div>';\n\n      return '<div class=\"' + this.getClasses() + '\" ' + this.getStyle() + '>' + container + '</div>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"group\", statics);\n  }\n});","/* Image.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an image to your visualization. Using the auto-refresh setting this widget can be used e.g. to show\n * a camera picture.\n *\n * @widgetexample\n * <image src=\"resource/icon/CometVisu_orange.png\" width=\"45px\" height=\"32px\">\n *   <layout colspan=\"2\" />\n * </image>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Image', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  include: cv.ui.common.Refresh,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    width   : { check: \"String\", init: \"100%\" },\n    height  : { check: \"String\", nullable: true },\n    src     : { check: \"String\", init: \"\" },\n    widthFit: { check: \"Boolean\", init: false }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __src: null,\n\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      var imgStyle = '';\n      if (this.getWidth()) {\n        imgStyle += 'width:' + this.getWidth() + ';';\n      }\n      if (this.getWidthFit() === true) {\n        imgStyle += 'max-width:100%;';\n      }\n      if (this.getHeight()) {\n        imgStyle += 'height:' + this.getHeight() + ';';\n      }\n      return '<div class=\"actor\"><img src=\"' + this.__getSrc() + '\" style=\"' + imgStyle + '\" /></div>';\n    },\n\n    /**\n     * Return the real src value\n     */\n    __getSrc: function() {\n      if (!this.__src) {\n        var src = this.getSrc();\n        var parsedUri = qx.util.Uri.parseUri(this.getSrc());\n        if (!parsedUri.protocol && !this.getSrc().startsWith(\"/\")) {\n          // is relative URI, use the ResourceManager\n          src = qx.util.ResourceManager.getInstance().toUri(this.getSrc());\n        }\n        this.__src = src;\n      }\n      return this.__src;\n    },\n\n    // overridden\n    getValueElement: function() {\n      return this.getDomElement().querySelector(\"img\");\n    },\n\n    // overridden\n    _applyVisible: function(value) {\n      var valueElem = this.getValueElement();\n      if (!valueElem || this.getRefresh() > 0) {\n        return;\n      }\n      if (value === true) {\n        valueElem.setAttribute(\"src\", this.__getSrc());\n      } else {\n        valueElem.setAttribute(\"src\", \"\");\n      }\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"image\", statics);\n  }\n});\n","/* ImageTrigger.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an image like the {@link cv.ui.structure.pure.Image} widget, but additionally the image can be changed by incoming\n * data and can send data to the backend by clicking on it.\n * There are two modes to react on incoming data:\n *\n * <ul>\n *  <li><code>type=\"show\"</code>: Hides the image when incoming data === 0</li>\n *  <li><code>type=\"select\"</code>: Changes the image by appending the incoming data to the initial configured image source, or hide it when incoming data === 0</li>\n * </ul>\n * Example:\n * <pre class=\"sunlight-highlight-xml\">\n * &lt;imagetrigger src=\"resource/icon/comet\" suffix=\"svg\" sendValue=\"clicked\" type=\"select\"&gt;\n *    &lt;address transform=\"DPT:16.001\" mode=\"readwrite\"&gt;0/0/0&lt;/address&gt;\n * &lt;/imagetrigger&gt;\n * </pre>\n *\n * initially shows nothing. When the CometVisu receives the string <code>_icon</code> in address <code>0/0/0</code>,\n * the image <code>icon/comet_opt_icon.svg</code> is shown. When the CometVisu receives '0' on address <code>0/0/0</code>,\n * this image is hidden.\n *\n * @widgetexample <settings>\n *   <screenshot name=\"image_trigger\">\n *     <caption>Image changed by incoming data 'blue'</caption>\n *     <data address=\"0/0/0\">blue</data>\n *   </screenshot>\n *   <screenshot name=\"image_trigger_changes\">\n *     <caption>Image changed by incoming data 'grey'</caption>\n *     <data address=\"0/0/0\">grey</data>\n *   </screenshot>\n *  </settings>\n *  <imagetrigger src=\"resource/icon/CometVisu_\" suffix=\"png\" sendValue=\"clicked\" type=\"select\" width=\"45px\" height=\"32px\">\n *    <layout colspan=\"1\" />\n *    <address transform=\"DPT:16.001\" mode=\"readwrite\">0/0/0</address>\n *  </imagetrigger>\n *\n * @widgetexample <settings>\n *   <caption>Disable layout width by settings it to '0', to have widget with === image width</caption>\n *   <screenshot name=\"image_trigger_colspan0\">\n *     <data address=\"0/0/0\">1</data>\n *   </screenshot>\n *  </settings>\n *  <imagetrigger src=\"resource/icon/CometVisu_orange\" suffix=\"png\" sendValue=\"clicked\" type=\"show\" width=\"45px\" height=\"32px\">\n *    <layout colspan=\"0\" />\n *    <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n *  </imagetrigger>\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.ImageTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.Refresh,\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    height: { check: \"String\", nullable: true },\n    updateType: {check: \"String\", init: ''},\n    width: {check: \"String\", init: '100%'},\n    src: { check: \"String\", nullable: true },\n    suffix: { check: \"String\", nullable: true },\n    sendValue: { check: \"String\", init: ''}\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n\n      var style = \"\";\n      if (Object.keys(this.getLayout()).length === 0) {\n        style += cv.parser.WidgetParser.extractLayout(this.getLayout(), this.getPageType());\n      }\n      if (this.getHeight()) {\n        style += 'height:' + this.getHeight() + ';';\n      }\n      if (style.length > 0) {\n        style = ' style=\"'+style+'\"';\n      }\n\n      var actor = '<div class=\"actor\">';\n      if ( this.getUpdateType() === 'show' ) {\n        actor += '<img src=\"' + this.__getUrl(this.getSrc() + '.' + this.getSuffix()) + '\"' + style.trim() + ' />';\n      }\n      else {\n        actor += '<img src=\"\"' + style + ' />';\n      }\n\n      actor += '</div>';\n      return actor;\n    },\n\n    _update: function(address, value) {\n      var imageChild = this.getDomElement().querySelector(\"img\");\n      if (this.getUpdateType() === \"show\") {\n        if (value === 0) {\n          imageChild.style.display = \"none\";\n        }\n        else {\n          imageChild.setAttribute(\"src\", this.__getUrl(this.getSrc() + '.' + this.getSuffix()));\n          imageChild.style.display = \"block\";\n        }\n      }\n      else if (this.getUpdateType() === \"select\") {\n        if (value === 0) {\n          imageChild.style.display = \"none\";\n        }\n        else {\n          imageChild.setAttribute(\"src\", this.__getUrl(this.getSrc() + value + '.' + this.getSuffix()));\n          imageChild.style.display = \"block\";\n        }\n      }\n\n      //TODO: add value if mapping exists\n      //TODO: get image name from mapping\n      //TODO: add bitmask for multiple images\n      //TODO: add SVG-magics\n    },\n\n    __getUrl: function(url) {\n      var parsedUri = qx.util.Uri.parseUri(url);\n      if (!parsedUri.protocol && !url.startsWith(\"/\")) {\n        // is relative URI, use the ResourceManager\n        url = qx.util.ResourceManager.getInstance().toUri(url);\n      }\n      return url;\n    },\n\n    _action: function() {\n      if (this.getSendValue() === \"\") { return; }\n      this.sendToBackend(this.getSendValue());\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"imagetrigger\", statics);\n  }\n});","/* Info.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a dynamic field to the visu that can represent values from the BUS\n * (e.g. 14-byte text or temperature measurements).\n *\n * @widgetexample <settings>\n *   <caption>Show temperature in degree celsius</caption>\n *   <screenshot name=\"info_temp\">\n *     <data address=\"0/0/0\">19</data>\n *   </screenshot>\n * </settings>\n * <info format=\"%.1f C\">\n *   <label>outside temperature</label>\n *   <address transform=\"DPT:9.001\">0/0/0</address>\n * </info>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Info', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\">-</div></div>';\n    }\n  }\n});\n\n","/* InfoAction.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The infoaction widget is a combination of an info/text widget and an \"action\"-widget, e.g. switch or trigger.\n *\n * Use case: if you have a group of lights, you can show the number of lights currently switched on\n * and control the whole group in one widget.\n *\n * @widgetexample <settings>\n *   <caption>Example combines an info widget to show the number of lights currently switched on, and an Switch to control them</caption>\n *   <screenshot name=\"infoaction_lights\">\n *     <data address=\"0/0/0\">4</data>\n *     <data address=\"0/0/1\">1</data>\n *   </screenshot>\n * </settings>\n * <meta>\n *  <mappings>\n *    <mapping name=\"OnOff\">\n *      <entry value=\"0\">Off</entry>\n *      <entry value=\"1\">On</entry>\n *    </mapping>\n *  </mappings>\n *  <stylings>\n *    <styling name=\"GreyGreen\">\n *      <entry value=\"0\">grey</entry>\n *      <entry value=\"1\">green</entry>\n *    </styling>\n *  </stylings>\n * </meta>\n * <infoaction>\n *  <layout colspan=\"4\"/>\n *  <label>Lights</label>\n *  <widgetinfo>\n *    <info>\n *     <address transform=\"DPT:9.001\">0/0/0</address>\n *    </info>\n *  </widgetinfo>\n *  <widgetaction>\n *   <switch mapping=\"OnOff\" styling=\"GreyGreen\">\n *    <layout colspan=\"3\" />\n *    <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/1</address>\n *   </switch>\n *  </widgetaction>\n * </infoaction>\n *\n *\n *\n * @author Tobias Brutigam\n * @since 0.10.0 (as widget), 0.9.2 (as plugin)\n */\nqx.Class.define('cv.ui.structure.pure.InfoAction', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    }\n  },\n\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return this.getChildrenDomString();\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"infoaction\", statics);\n  }\n});\n","/* InfoTrigger.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an element to the visu that contains two buttons and a value indication for feedback\n * from the BUS. (E.g. for multimedia control\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.InfoTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.Update,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.HandleLongpress\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    'downValue': {\n      check: \"Number\",\n      init: 0\n    },\n    'shortDownValue': {\n      check: \"Number\",\n      nullable: true\n    },\n    'downLabel': {\n      check: \"String\",\n      nullable: true\n    },\n    'upValue': {\n      check: \"Number\",\n      init: 0\n    },\n    'shortUpValue': {\n      check: \"Number\",\n      nullable: true\n    },\n    'upLabel': {\n      check: \"String\",\n      nullable: true\n    },\n    'isAbsolute': {\n      check: \"Boolean\",\n      init: false\n    },\n    'min': {\n      check: \"Number\",\n      init: 0\n    },\n    'max': {\n      check: \"Number\",\n      init: 255\n    },\n    'infoPosition': {\n      check: [\"left\", \"middle\", \"right\"],\n      init: 'middle'\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create buttons + info\n      var ret_val = '<div style=\"float:left;\">';\n\n      var actordown = '<div class=\"actor switchUnpressed downlabel\" ';\n      if (this.getAlign()) {\n        actordown += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actordown += '>';\n      actordown += '<div class=\"label\">' + (this.getDownLabel() || '-') + '</div>';\n      actordown += '</div>';\n\n      var actorup = '<div class=\"actor switchUnpressed uplabel\" ';\n      if (this.getAlign()) {\n        actorup += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actorup += '>';\n      actorup += '<div class=\"label\">' + (this.getUpLabel() || '+') + '</div>';\n      actorup += '</div>';\n\n      var actorinfo = '<div class=\"actor switchInvisible\" ';\n      if (this.getAlign()) {\n        actorinfo += 'style=\"text-align: ' + this.getAlign() + '\" ';\n      }\n      actorinfo += '><div class=\"value\">-</div></div>';\n\n      switch (this.getInfoPosition()) {\n        case 'middle':\n          ret_val += actordown;\n          ret_val += actorinfo;\n          ret_val += actorup;\n          break;\n        case 'right':\n          ret_val += actordown;\n          ret_val += actorup;\n          ret_val += actorinfo;\n          break;\n        default:\n          ret_val += actorinfo;\n          ret_val += actordown;\n          ret_val += actorup;\n          break;\n      }\n\n      return ret_val + '</div>';\n    },\n\n    getActors: function(){\n      return this.getDomElement().querySelectorAll(\".actor.uplabel, .actor.downlabel\");\n    },\n\n    // overridden\n    initListeners: function() {\n      this.getActors().forEach(function(actor) {\n        qx.event.Registration.addListener(actor, \"pointerdown\", this._onPointerDown, this);\n      }, this);\n\n    },\n\n    __findActor: function (element) {\n      while (!element.classList.contains('actor')) {\n        element = element.parentNode;\n        if (element.classList.contains('widget')) {\n          // thats too far\n          return null;\n        }\n      }\n      return element;\n    },\n\n    _onLongTap: function(event) {\n      this.__action(false, this.__findActor(event.getCurrentTarget()).classList.contains('downlabel'));\n    },\n\n    _action: function(event) {\n      this.__action(true, this.__findActor(event.getCurrentTarget()).classList.contains('downlabel'));\n    },\n\n    __action: function (isShort, isDown) {\n      var value;\n      if (isShort && this.getShortDownValue() !== null && this.getShortUpValue() !== null) {\n        value = isDown ? this.getShortDownValue() : this.getShortUpValue();\n      } else {\n        value = isDown ? this.getDownValue() : this.getUpValue();\n      }\n\n      var bitMask = (isShort ? 1 : 2);\n\n      if (this.getIsAbsolute()) {\n        var bvalue = parseFloat(this.getBasicValue());\n        if (isNaN(bvalue)) {\n          bvalue = 0; // anything is better than NaN...\n        }\n        value = bvalue + value;\n        value = Math.max(value, this.getMin());\n        value = Math.min(value, this.getMax());\n      }\n      this.sendToBackend(value, function(address) {\n        return !!(address[2] & bitMask);\n      });\n    },\n\n    getDownActor: function() {\n      return this.getDomElement().querySelector(\".actor.downlabel\");\n    },\n\n    getUpActor: function() {\n      return this.getDomElement().querySelector(\".actor.uplabel\");\n    },\n\n    getInfoActor: function() {\n      return this.getDomElement().querySelector(\".actor.switchInvisible\");\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"infotrigger\", statics);\n  }\n});","/* Line.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A line tag is used to display a horizontal line in the browser to allow for a grouped and thereby tidy display of\n * elements on one page. To specify the width of the line an optional &lt;layout/&gt;-child can be added.\n *\n * @widgetexample <settings selector=\"hr\">\n *   <caption>A line tag which uses 50% of the screen size (6 of 12 available columns)</caption>\n * </settings>\n * <line><layout colspan=\"6\"/></line>\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Line', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    getDomString: function () {\n      return '<hr ' + (this.getClasses() ? 'class=\"'+this.getClasses()+'\"' : '') + '/>';\n    }\n  }\n});","/* MultiTrigger.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a widget with multiple buttons to the visu.\n * Thus, e.g. change the operating mode of the heating system\n * (Comfort -> Night -> Absent -> Frost protection) or create scene functions.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.MultiTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update, cv.ui.common.HasAnimatedButton],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    showstatus: {\n      check: \"Boolean\",\n      init: false\n    },\n    elementsPerLine: {\n      check: \"Number\",\n      init: 2\n    },\n    buttonConfiguration: {\n      check: 'Object',\n      nullable: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      var ret_val = '<div class=\"actor_container\" style=\"float:left\">';\n      var mapping = this.getMapping();\n      var elementsPerLine = this.getElementsPerLine();\n\n      var config = this.getButtonConfiguration();\n      var indices = Object.keys(config).sort();\n\n      indices.forEach(function (i) {\n        var buttonConfig = config[i];\n        var label = buttonConfig.label;\n        if (mapping) {\n          var mappedValue = this.defaultValueHandling(undefined, buttonConfig.value);\n          if (mappedValue !== buttonConfig.value || !label) {\n            label = '';\n            this.defaultValue2DOM(mappedValue, function (e) {\n              label += e;\n            });\n          }\n        }\n\n        if (label) {\n          ret_val += '<div class=\"actor switchUnpressed\"><div class=\"value\">' + label + '</div></div>';\n        }\n        if (elementsPerLine > 0 && i % elementsPerLine === 0) {\n          ret_val+= '<br/>';\n        }\n      }, this);\n      return ret_val + '</div>';\n    },\n\n    getActors: function(){\n      return this.getDomElement().querySelectorAll('.actor_container .actor');\n    },\n\n    // overridden, only transform the value, do not apply it to DOM\n    _processIncomingValue: function (address, data) {\n      return this.applyTransform(address, data);\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     */\n    handleUpdate: function () {\n      var children = this.getActors();\n      var buttonConfiguration = this.getButtonConfiguration();\n      children.forEach(function(actor) {\n        var index = Array.prototype.indexOf.call( children, actor )+1;\n        if (buttonConfiguration.hasOwnProperty(index)) {\n          var isPressed = ('' + this.getBasicValue()) === ('' + buttonConfiguration[index].value); // compare as string\n\n          // delay this a little bit to give the HasAnimatedButton stuff time to finish\n          // otherwise it might override the settings here\n          new qx.util.DeferredCall(function () {\n            actor.classList.remove(isPressed ? 'switchUnpressed' : 'switchPressed');\n            actor.classList.add(isPressed ? 'switchPressed' : 'switchUnpressed');\n          }, this).schedule();\n        }\n      }, this);\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     *\n     */\n    getActionValue: function (event) {\n      var index = Array.prototype.indexOf.call( this.getDomElement().querySelectorAll('.actor_container .actor'), event.getCurrentTarget() )+1;\n      return this.getButtonConfiguration()[index].value;\n    },\n\n    // overridden\n    initListeners: function() {\n      if (this.isAnonymous()) { return; }\n\n      this.getActors().forEach(function(actor) {\n        qx.event.Registration.addListener(actor, \"tap\", this.action, this);\n        qx.event.Registration.addListener(actor, \"pointerdown\", this._onPointerDown, this);\n      }, this);\n\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"multitrigger\", statics);\n  }\n});\n","/* NavBar.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the widget navbar, you can add a navigation menu to the entire visu.\n * The menu can be displayed on a page (top, bottom, left, right).\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.NavBar', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    name: {\n      check: \"String\",\n      nullable: true\n    },\n    scope: {\n      check: \"Number\",\n      init: -1\n    },\n    width: {\n      check: \"String\",\n      init: \"300\"\n    },\n    position: {\n      check: [\"top\", \"left\", \"right\", \"bottom\"], \n      init: 'left'\n    },\n    dynamic: {\n      check: \"Boolean\",\n      nullable : true,\n      init: null\n    },\n    visible: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    _navbarTop: '',\n    _navbarLeft: '',\n    _navbarRight: '',\n    _navbarBottom: '',\n    _touchX: null,\n    _touchY: null,\n\n    /**\n     * Called on setup.dom.finished event with high priority. Adds the navbar dom string\n     * to the DOM-Tree\n     */\n    initializeNavbars: function() {\n      ['Top', 'Left', 'Right', 'Bottom'].forEach(function(pos) {\n        if (this['_navbar'+pos]) {\n          var elem = document.querySelector('#navbar'+pos);\n          if (elem) {\n            elem.innerHTML += this['_navbar' + pos];\n          }\n        }\n      }, this);\n\n      var self = this;\n      // Event handlers to allow navbar fade in and fade out.\n      // Currently only implemented for the major use case of a left navbar.\n      // TODO add logic for other navbars as well\n      // Logic:\n      //   To fade in the touch must start on the left screen side and then\n      //   swipe right.\n      //   To fade out all places on the screen are fine.\n      //   There is a minimum swipe distance and the direction must be mostly\n      //   horizontal (up to +/-45 tolerance is allowed)\n      //   When during a valid swipe the direction is reversed the fading\n      //   action is also reverted.\n      document.addEventListener('touchstart', function (evt) {\n        var\n          touches = evt.touches[0],\n          pPH = cv.TemplateEngine.getInstance().pagePartsHandler;\n\n        if (pPH.navbars.left.dynamic === false ||\n          (!cv.Config.mobileDevice && pPH.navbars.left.dynamic !== true) ||\n          (!pPH.navbars.left.fadeVisible && touches.clientX > 20)) { // left navbar is not visible but the finger isn't on the left end -> not relevant\n          return;\n        }\n\n        self._touchX = touches.clientX;\n        self._touchY = touches.clientY;\n      }, false);\n      document.addEventListener('touchend', function () {\n        self._touchX = null;\n        self._touchY = null;\n      }, false);\n      document.addEventListener('touchmove', function (evt) {\n        if (self._touchX === null) {\n          return; // early exit as this touch isn't relevant for us\n        }\n\n        var\n          touches = evt.touches[0],\n          x = touches.clientX - self._touchX,\n          y = touches.clientY - self._touchY,\n          necessaryDistance = 10,\n          enoughDistance = Math.abs(x) > necessaryDistance,\n          horizontal = Math.abs(x) > Math.abs(y),\n          toRight = x > 0;\n        if (horizontal && enoughDistance) {\n          var pPH = cv.TemplateEngine.getInstance().pagePartsHandler;\n          if (toRight) {\n            self._touchX = touches.clientX - necessaryDistance;\n            self._touchY = touches.clientY;\n            if (!pPH.navbars.left.fadeVisible) {\n              pPH.fadeNavbar('Left', 'in', 250);\n            }\n          } else { // !toRight\n            self._touchX = touches.clientX + necessaryDistance;\n            self._touchY = touches.clientY;\n            if (pPH.navbars.left.fadeVisible) {\n              pPH.fadeNavbar('Left','out',250);\n            }\n          }\n        }\n      }, false);\n    }\n  },\n  \n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n    },\n    \n    getGlobalPath: function () {\n      var id = this.getPath().split(\"_\");\n      id.pop();\n      return id.join('_') + '_' + this.getPosition() + '_navbar';\n    },\n\n    // overridden\n    getDomString: function () {\n\n      var container = '<div class=\"' + this.getClasses() + '\" id=\"' + this.getGlobalPath() + '\">';\n      if (this.getName()) {\n        container += '<h2>' + this.getName() + '</h2>';\n      }\n      container += this.getChildrenDomString();\n\n      container += '</div>';\n\n      // add this to the navbars in DOM not inside the page\n      switch (this.getPosition()) {\n        case 'top':\n          this.self(arguments)._navbarTop += container;\n          break;\n\n        case 'left':\n          this.self(arguments)._navbarLeft += container;\n          break;\n\n        case 'right':\n          this.self(arguments)._navbarRight += container;\n          break;\n\n        case 'bottom':\n          this.self(arguments)._navbarBottom += container;\n          break;\n      }\n\n      return '';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"navbar\", statics);\n    qx.event.message.Bus.subscribe(\"setup.dom.finished.before\", statics.initializeNavbars, statics);\n  }\n});","/* NotificationCenterBadge.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Shows the current number of messages in {@link cv.ui.NotificationCenter} and opens it on click.\n *\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a centered text widget</caption>\n *   <screenshot name=\"text_example\" />\n * </settings>\n * <notificationcenterbadge>\n *  <layout colspan=\"0\" />\n * </notificationcenterbadge>\n *\n * @author Tobias Brutigam\n * @since 0.11.0\n */\nqx.Class.define('cv.ui.structure.pure.NotificationCenterBadge', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    var classes = props.classes.trim().split(\" \"),\n        i_right = classes.indexOf(\"right\");\n\n    if (i_right !== -1) {\n      // do not align, but float the container instead\n      this.setContainerClass(\"float-right\");\n      classes.splice(i_right, 1);\n      props.classes = classes.join(\" \");\n    }\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    counter: {\n      check: \"Number\",\n      init: 0,\n      apply: \"_applyCounter\"\n    },\n    hideWhenEmpty: {\n      check: \"Boolean\",\n      init: false\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __badgeElement: null,\n\n    _onDomReady: function() {\n      this.base(arguments);\n      var center = cv.ui.NotificationCenter.getInstance();\n      center.getMessages().addListener(\"changeLength\", this._onChangeCounter, this);\n      this._onChangeCounter();\n      center.addListener(\"changedGlobalSeverity\", this._onChangeGlobalSeverity, this);\n    },\n\n    // property apply\n    _applyVisible: function(value) {\n      // hide NotificationCenters own badge while we are visible\n      cv.ui.NotificationCenter.getInstance().disableBadge(value);\n    },\n\n    action: function(ev) {\n      if (this._skipNextEvent === ev.getType()) {\n        this._skipNextEvent = null;\n        return;\n      }\n      cv.ui.NotificationCenter.getInstance().toggleVisibility();\n    },\n\n    __getBadgeElement: function() {\n      if (!this.__badgeElement) {\n        this.__badgeElement = this.getDomElement().querySelector(\".badge\");\n      }\n      return this.__badgeElement;\n    },\n\n    _onChangeGlobalSeverity: function(ev) {\n      var classList = this.__getBadgeElement().classList;\n      classList.remove.apply( classList, cv.ui.NotificationCenter.getInstance().getSeverities() );\n      if (ev.getData()) {\n        classList.add(ev.getData());\n      }\n    },\n\n    _onChangeCounter: function() {\n      var messages = cv.ui.NotificationCenter.getInstance().getMessages().length;\n      this.__getBadgeElement().innerHTML = \"\"+messages;\n      if (this.isHideWhenEmpty()) {\n        this.__getBadgeElement().style.display = messages === 0 ? \"none\" : \"block\";\n      }\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      var style = \"\";\n      if (this.isHideWhenEmpty() && this.getCounter() === 0) {\n        style = ' style=\"display: none;\"';\n      }\n      return '<div class=\"actor badge\"'+style+'>'+this.getCounter()+'</div>';\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    var center = cv.ui.NotificationCenter.getInstance();\n    center.getMessages().removeListener(\"changeLength\", this._onChangeCounter, this);\n    center.removeListener(\"changedGlobalSeverity\", this._onChangeGlobalSeverity, this);\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"notificationcenterbadge\", statics);\n  }\n});","/* Page.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Creates a new sub page and adds a corresponding link to the current page.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Page', {\n  extend: cv.ui.structure.AbstractWidget,\n  implement: cv.ui.structure.IPage,\n\n  include: [\n    cv.ui.common.HasChildren,\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.__waitForProperties = ['showNavbarTop', 'showNavbarBottom', 'showNavbarLeft', 'showNavbarRight'];\n    this.base(arguments, props);\n\n    this.addListener(\"changeVisible\", this._onChangeVisible, this);\n\n    // break out of the constructor\n    new qx.util.DeferredCall(function() {\n      var parentPage = this.getParentPage();\n      if (!parentPage) {\n        this.__waitForProperties = [];\n      } else {\n        this.debug(\"binding navbar visibility from \" + parentPage.getPath() + \" to \" + this.getPath());\n      }\n      [\n        ['showTopNavigation', true],\n        ['showFooter', true],\n        ['showNavbarTop', false],\n        ['showNavbarBottom', false],\n        ['showNavbarLeft', false],\n        ['showNavbarRight', false]\n      ].forEach(function (tuple) {\n        var property = tuple[0];\n        var defaultValue = tuple[1];\n        if (this['get' + property.charAt(0).toUpperCase() + property.substr(1)]() === null) {\n          // inherit from parent\n          if (parentPage) {\n            parentPage.bind(property, this, property);\n          } else {\n            // we have not parent page, because we are the root page, use the default value\n            this['set' + property.charAt(0).toUpperCase() + property.substr(1)](defaultValue);\n          }\n        }\n        if (!parentPage) {\n          this.setInitialized(true);\n        }\n      }, this);\n    }, this).schedule();\n\n    if (this.getAddress()) {\n      this._initOnCreate = true;\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    allPages : '',\n\n    /**\n     * Append the complete generated HTML code to the DOM tree at the end of the generation process\n     */\n    createFinal: function() { // special function - only for pages!\n      document.querySelector(\"#pages\").innerHTML = this.allPages;\n      qx.event.message.Bus.unsubscribe(\"setup.dom.append\", this.createFinal, this);\n    }\n\n  },\n\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    initialized: {\n      check: \"Boolean\",\n      init: false,\n      event: \"changeInitialized\"\n    },\n\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    name              : {\n      check: \"String\",\n      init: \"\", nullable: true\n    },\n    showTopNavigation : {\n      check: \"Boolean\",\n      nullable: true,\n      event: \"changeShowTopNavigation\"\n    },\n    showFooter        : {\n      check: \"Boolean\",\n      nullable: true,\n      event: \"changeShowFooter\"\n    },\n    showNavbarTop : {\n      check: \"Boolean\",\n      nullable: true,\n      event: \"changeShowNavbarTop\",\n      apply: \"_applyNavbarVisibility\"\n    },\n    showNavbarBottom : {\n      check: \"Boolean\",\n      nullable: true,\n      event: \"changeShowNavbarBottom\",\n      apply: \"_applyNavbarVisibility\"\n    },\n    showNavbarLeft : {\n      check: \"Boolean\",\n      nullable: true,\n      event: \"changeShowNavbarLeft\",\n      apply: \"_applyNavbarVisibility\"\n    },\n    showNavbarRight : {\n      check: \"Boolean\",\n      nullable: true,\n      event: \"changeShowNavbarRight\",\n      apply: \"_applyNavbarVisibility\"\n    },\n    backdropAlign     : {\n      init: '50% 50%',\n      nullable: true\n    },\n    backdropType      : { check: \"String\", nullable: true },\n    linkVisible       : { check: \"Boolean\", init: true, nullable: true },\n    size              : { check: \"String\", nullable: true },\n    backdrop          : { check: \"String\", nullable: true }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    __waitForProperties: null,\n    __colspanClass: null,\n    __normalizedDomId: null,\n\n    _applyNavbarVisibility: function(value, old, name) {\n      if (value !== null) {\n        var i_name = this.__waitForProperties.indexOf(name);\n        if( i_name !== -1 ) {\n          this.__waitForProperties.splice(i_name,1);\n        }\n        if (this.__waitForProperties.length === 0) {\n          this.setInitialized(true);\n        }\n      }\n    },\n\n    /**\n     * If the page gets visible the colspan sized must be checked\n     * @param ev {Event}\n     */\n    _onChangeVisible: function(ev) {\n      if (ev.getData()) {\n        if (this.__colspanClass !== cv.ui.layout.Manager.COLSPAN_CLASS) {\n          this.applyColumnWidths();\n        }\n        if (this.getBackdrop()) {\n          cv.ui.layout.ResizeHandler.invalidateBackdrop();\n        }\n      }\n    },\n\n    /**\n     * Set childrens column widths\n     */\n    applyColumnWidths: function() {\n      cv.ui.layout.Manager.applyColumnWidths('#'+this.getPath(), false);\n      this.__colspanClass = cv.ui.layout.Manager.COLSPAN_CLASS;\n    },\n\n    // overridden\n    getDomString: function() {\n      var pageType = this.getPageType();\n\n      var subpageClass = this.getFlavour() ? (' flavour_' + this.getFlavour()) : '';\n      var subpage = '<div class=\"page type_' + pageType + subpageClass + '\" id=\"' + this.getPath() + '\">';\n      var container = '<div class=\"clearfix\"><h1>' + this.getName() + '</h1>';\n\n      if( '2d' === pageType )\n      {\n        var size = 'width:100%;height:100%;';\n        switch( this.getSize() )\n        {\n          case 'fixed':\n            size = '';\n            break;\n\n          case 'contained':\n            size += 'object-fit:contain;';\n            if(this.getBackdropAlign()) {\n              size += 'object-position:' + this.getBackdropAlign() + ';';\n            }\n            break;\n\n          default: // default: assume scaled\n        }\n\n        var backdrop = this.getBackdrop();\n        if (backdrop) {\n          container += '<' + this.getBackdropType() + ' src=\"' + qx.util.ResourceManager.getInstance().toUri(backdrop) + '\" style=\"position: absolute; top: 0px; left: 0px;z-index:-1;' + size + '\"/>';\n        }\n      } else if( '3d' === pageType && false ) //---Disable 3D for 0.8---\n      {\n        /*\n         var floorplan = JSFloorPlan3D( container, backdrop );\n         floorplan.moveToRoom( 'Underground', false, true, false );\n         container.data( 'JSFloorPlan3D', floorplan );\n         container.find('canvas').css({position: 'absolute', top: '0px', left: '0px', 'z-index':'-1', width:'100%',height:'100%'});\n         subpage.click( {JSFloorPlan3D:floorplan,callback:function(event){\n         var j = this.JSFloorPlan3D;\n         j.moveToRoom( j.getState('showFloor'), event.room.room, true, true, function(){\n         container.trigger( 'update3d', j );\n         });\n         }}, floorplan.translateMouseEvent );\n         $(window).bind( 'resize', function(){ floorplan.resize($('.page').width(), $('.page').height(), true);} );\n         if (page.getAttribute('azimut')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('azimut'), path + '_' );\n         address[ page.getAttribute('azimut') ] = [ 'DPT:9.001', 0, 'azimut' ];\n         }\n         if (page.getAttribute('elevation')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('elevation'), path + '_' );\n         address[ page.getAttribute('elevation') ] = [ 'DPT:9.001', 0, 'elevation' ];\n         };\n         if (page.getAttribute('floor')) {\n         cv.TemplateEngine.getInstance().addAddress( page.getAttribute('floor'), path + '_' );\n         address[ page.getAttribute('floor') ] = [ 'DPT:5.004', 0, 'floor' ];\n         };\n\n         $( childs ).each( function(i,a){\n         if( this.tagName === 'filter' )\n         {\n         var floorFilter = $(this).attr('floor');\n         var roomFilter  = $(this).attr('room');\n         childs.splice( i, 1 );                 // remove filter element\n         $(this).children().each( function(j){  // and add it's children\n         $(this).find('layout').attr({floorFilter:floorFilter,roomFilter:roomFilter});\n         childs.splice( i+j, 0, this );\n         });\n         }\n         });\n         */\n      }\n      container += this.getChildrenDomString();\n      subpage += container + '</div></div>';\n      cv.ui.structure.pure.Page.allPages = subpage + cv.ui.structure.pure.Page.allPages;\n      return undefined;\n    },\n\n    _update: function( ga, data ) {\n      // widgetData  = cv.data.Model.getInstance().getWidgetDataByElement( element );\n      // var value = this.defaultValueHandling( ga, data, widgetData );\n      // var type = widgetData.address[ ga ][2];\n      // switch( type )\n      // {\n      //   case 'azimut':\n      //     widgetData.JSFloorPlan3D.setState('currentAzimut', value, true);\n      //     element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     break;\n      //\n      //   case 'elevation':\n      //     widgetData.JSFloorPlan3D.setState('currentElevation', value, true);\n      //     element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     break;\n      //\n      //   case 'floor':\n      //     widgetData.JSFloorPlan3D.moveToRoom( value, false, true, true, function(){\n      //       element.trigger( 'update3d', widgetData.JSFloorPlan3D );\n      //     });\n      //     break;\n      //\n      //   default:\n      // TODO: data comparision has to be refactored to use DPT and a value\n      if (parseInt(data) === 1) {\n        cv.TemplateEngine.getInstance().scrollToPage(this.getPath());\n        this.sendToBackend(\"0\");\n      }\n      // }\n    },\n\n    sendToBackend: function (value) {\n      if (this.getAddress) {\n        var list = this.getAddress();\n        for (var id in list) {\n          if (list.hasOwnProperty(id)) {\n            var address = list[id];\n            if (cv.data.Model.isWriteAddress(address)) {\n              cv.TemplateEngine.getInstance().visu.write(id, cv.Transform.encode(address[0], value));\n            }\n          }\n        }\n      }\n    }\n  },\n\n  defer: function(statics) {\n    qx.event.message.Bus.subscribe(\"setup.dom.append\", statics.createFinal, statics);\n  }\n});","/* PageJump.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The pagejump widget can be used to link the visu pages.\n * The function is similar to hyperlinks.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.PageJump', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.HasChildren,\n    cv.ui.common.HasAnimatedButton\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (props) {\n    if (!props.name) {\n      // when there is no name the widget has no actor as clickable subelement, so we need\n      // to bind the click events to the whole widget\n      props.bindClickToWidget = true;\n    }\n    this.base(arguments, props);\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    target : {\n      check: \"String\",\n      init: \"0\"\n    },\n    activeScope : {\n      check: ['target', 'path'],\n      init: 'target'\n    },\n    name : {\n      check: \"String\",\n      nullable: true\n    },\n    targetPath : {\n      check: \"String\",\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Handle page change events and update the active state of this PageJump\n     *\n     * @param ev {Event}\n     * @protected\n     */\n    _onScrollToPage: function(ev) {\n      var page_id = ev.getData();\n      var page = cv.ui.structure.WidgetFactory.getInstanceById(page_id);\n      var model = cv.data.Model.getInstance();\n      var name = page.getName();\n\n      // remove old active classes\n      document.querySelectorAll('.pagejump.active').forEach(function(elem) {\n        elem.classList.remove('active');\n      }, this);\n      document.querySelectorAll('.pagejump.active_ancestor').forEach(function(elem) {\n        elem.classList.remove('active_ancestor');\n      }, this);\n\n      // and set the new active ones\n      document.querySelectorAll('.pagejump').forEach(function(elem) {\n        var data = model.getWidgetDataByElement(elem);\n        if (name === data.target) {\n          elem.classList.add('active');\n        }\n      }, this);\n\n      // now set the active ancestors\n      var parentPage = cv.util.Tree.getParentWidget(page, \"page\");\n      // set for all parent pages apart from the root page\n\n      var pageJumps = document.querySelectorAll('.pagejump');\n      var markPageJumps = function(parentName, elem) {\n        var data = model.getWidgetDataByElement(elem);\n        if (parentName === data.target || (data.activeScope === \"path\" && (\n            (typeof data.path === 'string') && data.path.match(parentName + \"$\") ||\n            (typeof data.targetPath === 'string') && data.targetPath.match(parentName + \"$\"))\n        )) {\n          elem.classList.add('active_ancestor');\n        }\n      };\n\n      while (parentPage && cv.util.Tree.getParentWidget(parentPage, \"page\")) {\n        pageJumps.forEach(function(elem){markPageJumps(parentPage.getName(), elem);});\n        // recursively find pagejumps for parent pages\n        parentPage = cv.util.Tree.getParentWidget(parentPage, \"page\");\n      }\n    }\n  },\n\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n\n    // overridden\n    _getInnerDomString: function() {\n      var actor = '<div class=\"actor switchUnpressed';\n      if (this.getAlign()) {\n        actor += this.getAlign();\n      }\n      actor += '\">';\n      if (this.getName()) {\n        actor += '<div class=\"value\">' + this.getName() + '</div>';\n      }\n      actor += '</div>';\n      return actor + this.getChildrenDomString();\n    },\n\n    // overridden\n    action: function() {\n      var target = this.getTarget();\n      if (this.getTargetPath() !== null) {\n        target = cv.TemplateEngine.getInstance().getPageIdByPath(target,this.getTargetPath());\n      }\n      cv.TemplateEngine.getInstance().scrollToPage( target );\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"pagejump\", statics);\n    qx.event.message.Bus.subscribe(\"path.pageChanged\", statics._onScrollToPage, statics);\n  }\n});\n","/* PageLink.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * PageLink Widget for visible pages. Do not use this directly because the pagelink widget\n * is automatically added when you use a page widget with parameter <code>visible=true</code>.\n *\n * @author Tobias Brutigam\n * @since 0.10.0 (2017)\n */\nqx.Class.define('cv.ui.structure.pure.PageLink', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    name : {\n      check: \"String\",\n      init: \"\",\n      nullable: true\n    },\n    wstyle : {\n      check: \"String\",\n      init: ''\n    },\n    address : {\n      check: \"Object\",\n      init: {}\n    },\n    bindClickToWidget: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    getDomString: function() {\n      var layout = this.getLayout();\n\n      var style = typeof layout === 'object' ? '' : 'style=\"' + cv.parser.WidgetParser.extractLayout(layout, this.getPageType()) + '\"';\n\n      var ret_val = '<div class=\"widget clearfix link pagelink ' + this.getClasses() + '\" ' + style + '>';\n      ret_val += '<div class=\"actor\" ' + this.getWstyle() + '><a href=\"javascript:void(0)\">' + this.getName() + '</a></div>';\n      ret_val += '</div>';\n      return ret_val;\n    },\n\n    // overridden\n    action: function() {\n      cv.TemplateEngine.getInstance().scrollToPage( this.getPath() + '_' );\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"pagelink\", statics);\n  }\n});\n","/* PushButton.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to the visu that sends a defined value to the BUS when you press and release.\n * E.g. pushing a 1 and releasing a 0. This makes it possible, for example,\n * to simulate a push button to open and close a garage door, blinds or blinds.\n *\n * @since 2013\n */\nqx.Class.define('cv.ui.structure.pure.PushButton', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    'downValue': {check: \"String\", init: \"1\"},\n    'upValue': {check: \"String\", init: \"0\"}\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    // overridden\n    initListeners: function() {\n      this.addElementListener(\"pointerdown\", this._onPointerDown, this);\n      this.addElementListener(\"pointerup\", this._onPointerUp, this);\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     *\n     * @param value {any} incoming data (already transformed + mapped)\n     */\n    handleUpdate: function (value) {\n      var actor = this.getActor();\n      // compare against the unmapped value\n      value = \"\" + this.getBasicValue();\n      var off = this.getUpValue();\n      actor.classList.remove(value === off ? 'switchPressed' : 'switchUnpressed');\n      actor.classList.add(value === off ? 'switchUnpressed' : 'switchPressed');\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     *\n     *\n     */\n    getActionValue: function (event) {\n      if (event.type === \"pointerup\") {\n        return this.getUpValue();\n      } else {\n        return this.getDownValue();\n      }\n    },\n\n    _onPointerUp: function () {\n      var sendValue = this.getUpValue();\n      this.sendToBackend(sendValue, function (address) {\n        return (!address[2] || address[2] === \"up\");\n      });\n    },\n\n    _onPointerDown: function () {\n      var sendValue = this.getDownValue();\n      this.sendToBackend(sendValue, function (address) {\n        return (!address[2] || address[2] === \"down\");\n      });\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"pushbutton\", statics);\n  }\n});","/* Refresh.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the widget refresh, the visu is added a switch, which allows the visu to reload the displayed data.\n *\n * @author Christian Mayer\n * @since 2014\n */\nqx.Class.define('cv.ui.structure.pure.Refresh', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.HasAnimatedButton, cv.ui.common.BasicUpdate],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: \"String\", nullable: true }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    _action: function() {\n      cv.TemplateEngine.getInstance().visu.restart(true);\n    }\n  }\n});","/* Reload.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the reload widget, the visu is added a switch, which allows to reload the full visu in the browser.\n *\n * @author Christian Mayer\n * @since 2014\n */\nqx.Class.define('cv.ui.structure.pure.Reload', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Update\n  ],\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden, return undefined to prevent widget from being renderered into DOM\n    getDomString: function() {\n      return;\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return;\n    },\n\n    _update: function (address, data) {\n      var value = this.defaultValueHandling(address, data);\n      if (value > 0) {\n        cv.util.Location.reload(true);\n      }\n    }\n  }\n});\n","/* Rgb.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * With the RGB widget you can display a colour in the visu.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Rgb', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Update],\n\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\"></div></div>';\n    },\n\n    /**\n     * Updates the RGB widget by setting the background color\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data\n     */\n    _update: function(address, data) {\n      if (data === undefined || address === undefined) { return; }\n      var valElem = this.getValueElement();\n\n      var value = cv.Transform.decode( this.getAddress()[ address ][0], data );\n\n      var bg = window.getComputedStyle(valElem)['background-color'].replace(/[a-zA-Z()\\s]/g, '').split(/,/);\n      if( 3 !== bg.length ) {\n        bg = [0, 0, 0];\n      }\n      switch (this.getAddress()[ address ][2]) {\n        case 'r' :  bg[0] = value; break;\n        case 'g' :  bg[1] = value; break;\n        case 'b' :  bg[2] = value; break;\n      }\n      var bgs = \"rgb(\" + bg[0] + \", \" + bg[1] + \", \" + bg[2] + \")\";\n      valElem.style['background-color'] = bgs;\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"rgb\", statics);\n  }\n});","/* Roundbar.js\n * \n * copyright (c) 2010-2020, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a display to the visu that can represent values from the BUS\n * and shows them with a round bar.\n *\n * @widgetexample <settings>\n *    <caption>Example roundbar widget</caption>\n *    <screenshot name=\"roundbar_simple\">\n *      <data address=\"3/3/1\">63.3</data>\n *    </screenshot>\n *  </settings>\n *  <roundbar>\n *      <address transform=\"DPT:9.001\" mode=\"read\">3/3/1</address>\n *  </roundbar>\n *\n * @author Christian Mayer\n * @since 0.12.0 (2020)\n */\nqx.Class.define('cv.ui.structure.pure.Roundbar', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    coord: function(position) {\n      return position.x.toFixed(1) + ' ' + position.y.toFixed(1);\n    },\n    /**\n     * Create the SVG path for the round bar.\n     * Angle = 0 === horizontal on the right\n     *\n     * @param startAngle {Float}\n     * @param startArrowPoint {Float}\n     * @param endAngle {Float}\n     * @param endArrowPoint {Float}\n     * @param radius {Float}\n     * @param width {Float}\n     * @param getBBox {Boolean} return the bounding box instead of the path itself\n     */\n    createBarPath: function(startAngle, startArrowPoint, endAngle, endArrowPoint, radius, width, getBBox) {\n      var\n        startArrowPointAngle = startAngle + startArrowPoint,\n        endArrowPointAngle   = endAngle + endArrowPoint;\n\n      // The path to generate is using those positions:\n      // rO             -- outer --\n      // rMO        /// outermiddle \\\\\\\n      // rM      //       middle        \\\\\n      // rIM   /        innermiddle        \\\n      // rI   /         -- inner --         \\\n      //     |        /             \\        |\n      //     |_______|               |_______|\n      //       start      center        end\n      var\n        clockwise   = startAngle > endAngle ? 1 : 0,\n        rI  = radius,\n        rIM = radius + width*1/4,\n        rM  = radius + width*2/4,\n        rMO = radius + width*3/4,\n        rO  = radius + width,\n        startInner  = {x: Math.cos(startAngle             )*rI, y: -Math.sin(startAngle             )*rI},\n        startMiddle = {x: Math.cos(startArrowPointAngle   )*rM, y: -Math.sin(startArrowPointAngle   )*rM},\n        startOuter  = {x: Math.cos(startAngle             )*rO, y: -Math.sin(startAngle             )*rO},\n        centerInner = {x: Math.cos((startAngle+endAngle)/2)*rI, y: -Math.sin((startAngle+endAngle)/2)*rI},\n        centerOuter = {x: Math.cos((startAngle+endAngle)/2)*rO, y: -Math.sin((startAngle+endAngle)/2)*rO},\n        endInner    = {x: Math.cos(endAngle               )*rI, y: -Math.sin(endAngle               )*rI},\n        endMiddle   = {x: Math.cos(endArrowPointAngle     )*rM, y: -Math.sin(endArrowPointAngle     )*rM},\n        endOuter    = {x: Math.cos(endAngle               )*rO, y: -Math.sin(endAngle               )*rO},\n        startMiddleFlag = Math.abs(startAngle - startArrowPointAngle)   > Math.PI ? 1 : 0,\n        startEndFlag    = Math.abs(startAngle - endAngle            )/2 > Math.PI ? 1 : 0,\n        endMiddleFlag   = Math.abs(endAngle   - endArrowPointAngle  )   > Math.PI ? 1 : 0,\n        startMiddleDir  = startAngle < startArrowPointAngle ? 1 : 0,\n        endMiddleDir    = endAngle   < endArrowPointAngle   ? 1 : 0;\n\n      function arc(start, end, r, flag, cw) {\n        return (start.x===end.x) && (start.y===end.y)\n          ? ''\n          : (Math.abs(start.x-end.x)+Math.abs(start.y-end.y) < 2)\n            ? 'L' + cv.ui.structure.pure.Roundbar.coord(end)\n            : ['A', r, r, 0, flag, cw, cv.ui.structure.pure.Roundbar.coord(end)].join(' ');\n      }\n\n      if (getBBox) {\n        var\n          rMax = Math.max(rI, rO),\n          isInside = function(a) {return  (startAngle < a && a < endAngle) || (startAngle > a && a > endAngle);},\n          rMiddle = isInside(-Math.PI*4/2) || isInside(Math.PI*0/2) ?  rMax : startInner.x,\n          uMiddle = isInside(-Math.PI*3/2) || isInside(Math.PI*1/2) ? -rMax : startInner.y,\n          lMiddle = isInside(-Math.PI*2/2) || isInside(Math.PI*2/2) ? -rMax : startInner.x,\n          dMiddle = isInside(-Math.PI*1/2) || isInside(Math.PI*3/2) ?  rMax : startInner.y;\n        return {\n          u: Math.min(startInner.y, startMiddle.y, startOuter.y, endInner.y, endMiddle.y, endOuter.y, uMiddle),\n          d: Math.max(startInner.y, startMiddle.y, startOuter.y, endInner.y, endMiddle.y, endOuter.y, dMiddle),\n          l: Math.min(startInner.x, startMiddle.x, startOuter.x, endInner.x, endMiddle.x, endOuter.x, lMiddle),\n          r: Math.max(startInner.x, startMiddle.x, startOuter.x, endInner.x, endMiddle.x, endOuter.x, rMiddle)\n        };\n      }\n\n      // a thin bar path should just be a single line\n      if( width < 1.0 ) {\n        return [\n          'M', cv.ui.structure.pure.Roundbar.coord(startOuter),\n          arc(startOuter, centerOuter, rO, startEndFlag, clockwise),\n          arc(centerOuter, endOuter, rO, startEndFlag, clockwise)\n        ].join('');\n      }\n\n      return ['M', cv.ui.structure.pure.Roundbar.coord(startInner),\n        startArrowPointAngle === startAngle\n          ? 'L' + cv.ui.structure.pure.Roundbar.coord(startOuter)\n          : arc(startInner, startMiddle, rIM, startMiddleFlag, 1-startMiddleDir) +\n            arc(startMiddle, startOuter, rMO, startMiddleFlag, startMiddleDir),\n        arc(startOuter , centerOuter, rO, startEndFlag, clockwise),\n        arc(centerOuter, endOuter   , rO, startEndFlag, clockwise),\n        endArrowPointAngle === endAngle\n          ? 'L' + cv.ui.structure.pure.Roundbar.coord(endInner)\n          : arc(endOuter, endMiddle, rMO, endMiddleFlag, 1-endMiddleDir) +\n            arc(endMiddle, endInner, rIM, endMiddleFlag, endMiddleDir),\n        arc(startInner , centerInner, rI, startEndFlag, 1-clockwise),\n        arc(centerInner, startInner , rI, startEndFlag, 1-clockwise),\n        'Z'\n      ].join('');\n    },\n    /**\n     * Create the SVG path for an pointer.\n     * @param angle {Float}\n     * @param p {Object} Indicator object\n     */\n    createPointerPath: function(angle, p) {\n      var\n        s = Math.sin(angle),\n        c = Math.cos(angle),\n        wx = c * p.width,\n        wy = s * p.width;\n\n      if(p.thickness > 0) {\n        var\n          tx = -s * p.thickness/2,\n          ty =  c * p.thickness/2;\n        return [\n          'M', this.coord({x:c*p.radius+wx-tx,y: -(s*p.radius+wy-ty)}),\n          'L', this.coord({x:c*p.radius      ,y: -(s*p.radius      )}),\n          'L', this.coord({x:c*p.radius+wx+tx,y: -(s*p.radius+wy+ty)})\n        ].join('');\n      } else {\n        return [\n          'M', this.coord({x:c*p.radius   ,y: -(s*p.radius   )}),\n          'L', this.coord({x:c*p.radius+wx,y: -(s*p.radius+wy)})\n        ].join('');\n      }\n    }\n  },\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    type: { check: \"Array\" },\n    indicators: { check: \"Array\" },\n\n    min: { check: \"Number\" },\n    max: { check: \"Number\" },\n    axisradius: { check: \"Number\" },\n    axiswidth: { check: \"Number\" },\n    axiscolor: { check: \"String\" },\n    ranges: { check: \"Array\" },\n    minorradius: { check: \"Number\" },\n    minorwidth: { check: \"Number\" },\n    minorspacing: { check: \"String\" },\n    minorcolor: { check: \"String\" },\n    majorradius: { check: \"Number\" },\n    majorwidth: { check: \"Number\" },\n    majorposition: { check: \"String\" },\n    majorcolor: { check: \"String\" },\n    labels: { check: \"Array\" },\n    labelstyle: { check: \"String\" },\n    start: { check: \"Number\" },\n    end: { check: \"Number\" },\n    arrowtype: { check: \"Number\" },\n    spacing: { check: \"Number\" },\n    overflowarrow: { check: \"Boolean\" },\n    fontsize: { check: \"Number\" },\n    textx: { check: \"Number\" },\n    texty: { check: \"Number\" },\n    textlength: { check: \"Number\" },\n    textanchor: { check: \"String\" },\n    linespace: { check: \"Number\" },\n    bboxgrow: { check: \"Object\" },\n    debug: { check: \"Boolean\" },\n    currentRatioValue: { check: \"Array\", init: [] },\n    targetRatioValue: { check: \"Array\", init: [] }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      /**\n       * Grow the bounding box to also contain the parameters x and y\n       * @param bbox {Object} The initial bounding box\n       * @param x {Float}\n       * @param y {Float}\n       * @returns {Object} The enlarged bounding box\n       */\n      function bboxAdd(bbox, x, y) {\n        if (bbox.u > y) { bbox.u = y; }\n        if (bbox.d < y) { bbox.d = y; }\n        if (bbox.l > x) { bbox.l = x; }\n        if (bbox.r < x) { bbox.r = x; }\n        return bbox;\n      }\n\n      this.setCurrentRatioValue(Array(this.getIndicators().length).fill(0));\n      this.setTargetRatioValue(Array(this.getIndicators().length).fill([0,false,false]));\n\n      var\n        self = this,\n        s = this.getStart(),\n        e = this.getEnd(),\n        min = this.getMin(),\n        max = this.getMax(),\n        cntValues = 0,\n        svgMajor = '',\n        svgMinor = '',\n        svgLabels = '',\n        svgRanges = '',\n        svgIndicators = '',\n        svgText = '',\n        createBarPath = cv.ui.structure.pure.Roundbar.createBarPath;\n\n      // Determine the bounding box, first get the biggest radius that must fit\n      var\n        rMax = this.getAxisradius()+this.getAxiswidth(),\n        sMax = 0,\n        eMax = 0;\n      this.getIndicators().forEach(function (indicator) {\n        rMax = Math.max(rMax, indicator.radius, indicator.radius+indicator.width);\n        sMax = Math.max(sMax, indicator.startarrow);\n        eMax = Math.max(eMax, indicator.endarrow);\n      });\n      var BBox = createBarPath( s, sMax, e, eMax, rMax, 0, true );\n\n      if (this.getMinorwidth() > 0) {\n        var\n          spacing = parseFloat(this.getMinorspacing()),\n          rIn = this.getMinorradius(),\n          rOut = this.getMinorwidth() + rIn;\n\n        if (/^[0-9]+%/.test(this.getMinorspacing())) { // special case: percentage\n          spacing = (max-min) * spacing / 100;\n        }\n\n        svgMinor += '<path class=\"minor\" d=\"';\n        for (var angle=s, delta = (e-s)*spacing/(max-min), cnt=(max-min)/spacing; cnt >= 0; angle+=delta,cnt--) {\n          var\n            sin = Math.sin(angle),\n            cos = Math.cos(angle);\n          svgMinor += [\n            'M', cv.ui.structure.pure.Roundbar.coord({x:cos*rIn , y:-sin*rIn }),\n            'L', cv.ui.structure.pure.Roundbar.coord({x:cos*rOut, y:-sin*rOut})\n          ].join('');\n\n          BBox = bboxAdd(BBox, cos*rIn , -sin*rIn );\n          BBox = bboxAdd(BBox, cos*rOut, -sin*rOut);\n        }\n        if (this.getMinorcolor() !== '') svgMinor += '\" style=\"stroke:' + this.getMinorcolor();\n        svgMinor += '\" />';\n      }\n\n      if (this.getMajorwidth() > 0) {\n        var\n          rIn = this.getMajorradius(),\n          rOut = this.getMajorwidth() + rIn;\n\n        svgMajor += '<path class=\"major\" d=\"';\n\n        this.getMajorposition().split(';').forEach(function (position) {\n          switch (position) {\n            case 'min':\n              position = min;\n              break;\n\n            case 'max':\n              position = max;\n              break;\n          }\n          var\n            angle = s+(e-s)*(position-min)/(max-min),\n            sin = Math.sin(angle),\n            cos = Math.cos(angle);\n          svgMajor += [\n            'M', cv.ui.structure.pure.Roundbar.coord({x:cos*rIn , y:-sin*rIn }),\n            'L', cv.ui.structure.pure.Roundbar.coord({x:cos*rOut, y:-sin*rOut})\n          ].join('');\n\n          BBox = bboxAdd(BBox, cos*rIn , -sin*rIn );\n          BBox = bboxAdd(BBox, cos*rOut, -sin*rOut);\n        });\n        if (this.getMajorcolor() !== '') { svgMajor += '\" style=\"stroke:' + this.getMajorcolor(); }\n        svgMajor += '\" />';\n      }\n\n      var labelstyle = this.getLabelstyle();\n      this.getLabels().forEach(function (label, labelnumber) {\n        var\n          angle = s+(e-s)*(label.value-min)/(max-min),\n          x = label.radius * Math.cos(angle),\n          y = label.radius * -Math.sin(angle),\n          alignmentBaseline = '',\n          textAnchor = '';\n\n        if (label.orientation < 3) {\n          svgLabels += '<text class=\"axislabel\" x=\"' + x + '\" y=\"' + y + '\"';\n          switch (label.orientation) {\n            default:\n            case 0: // horizontal\n              if (x < 0) {\n                textAnchor = (['end', 'middle', 'start'])[label.position];\n              } else {\n                textAnchor = (['start', 'middle', 'end'])[label.position];\n              }\n              if (Math.abs(x) < 1) {\n                textAnchor = 'middle';\n              }\n              if (y < 0) {\n                alignmentBaseline = (['baseline', 'middle', 'hanging'])[label.position];\n              } else {\n                alignmentBaseline = (['hanging', 'middle', 'baseline'])[label.position];\n              }\n              if (Math.abs(y) < 1) {\n                alignmentBaseline = 'middle';\n              }\n              break;\n\n            case 1: // parallel\n              var textAngle = -angle * 180 / Math.PI + 90;\n              if (y < 0) {\n                alignmentBaseline = (['baseline', 'middle', 'hanging'])[label.position];\n              } else {\n                alignmentBaseline = (['hanging', 'middle', 'baseline'])[label.position];\n                textAngle += 180;\n              }\n              textAnchor = 'middle';\n              svgLabels += ' transform=\"rotate(' + textAngle + ',' + x + ',' + y + ')\"';\n              break;\n\n            case 2: // perpendicular\n              textAngle = -angle * 180 / Math.PI;\n              if (x < 0) {\n                textAnchor = (['end', 'middle', 'start'])[label.position];\n                textAngle += 180;\n              } else {\n                textAnchor = (['start', 'middle', 'end'])[label.position];\n              }\n              alignmentBaseline = 'middle';\n              svgLabels += ' transform=\"rotate(' + textAngle + ',' + x + ',' + y + ')\"';\n              break;\n          }\n          svgLabels += ' dominant-baseline=\"' + alignmentBaseline + '\"';\n          svgLabels += ' text-anchor=\"' + textAnchor + '\"';\n\n          if (labelstyle !== '') {\n            svgLabels += ' style=\"' + labelstyle + '\"';\n          }\n\n          svgLabels += '>' + label.name + '</text>';\n        } else { // label.orientation >= 3 -> round\n          var\n            labelid = self.$$user_path + '_label' + labelnumber,\n            cw = s < e ? 0 : 1,\n            path = '',\n            align = '';\n\n          switch (label.orientation) {\n            case 3: // roundstart\n              path = ['M', x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y].join(' ');\n              break;\n\n            case 4: // roundmiddle\n              path = ['M', -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y, 'A', label.radius, label.radius, 0, 0, cw, -x,-y].join(' ');\n              align = ' startOffset=\"50%\" text-anchor=\"middle\"';\n              break;\n\n            case 5: // roundend\n              path = ['M', x, y, 'A', label.radius, label.radius, 0, 0, cw, -x, -y, 'A', label.radius, label.radius, 0, 0, cw, x, y].join(' ');\n              align = ' startOffset=\"100%\" text-anchor=\"end\"';\n              break;\n          }\n          svgLabels += '<path style=\"stroke:none; fill:none; stroke-width:0\" id=\"' + labelid + '\" d=\"' + path + '\"/>';\n          svgLabels += '<text class=\"axislabel\"';\n\n          if (labelstyle !== '') {\n            svgLabels += ' style=\"' + labelstyle + '\"';\n          }\n\n          svgLabels += '><textPath href=\"#'+labelid+'\"' + align + '>' + label.name + '</textPath></text>';\n        }\n      });\n\n      this.getRanges().forEach(function (range) {\n        var\n          sRange = (e-s)*(range.start-min)/(max-min)+s,\n          eRange = (e-s)*(range.end  -min)/(max-min)+s,\n          rRange = range.radius || self.getAxisradius(),\n          wRange = range.width  || self.getAxiswidth(),\n          thisBBox = createBarPath(sRange,0,eRange,0,rRange,wRange, true);\n        svgRanges += '<path class=\"range\" d=\"';\n        svgRanges += createBarPath(sRange,0,eRange,0,rRange,wRange);\n        if (range.style) {\n          svgRanges += '\" style=\"' + range.style;\n        }\n        svgRanges += '\" />';\n\n        BBox = bboxAdd(BBox, thisBBox.l, thisBBox.u);\n        BBox = bboxAdd(BBox, thisBBox.r, thisBBox.d);\n      });\n\n      this.getIndicators().forEach(function (indicator) {\n        svgIndicators += '<path class=\"indicator\" style=\"' + indicator.style + '\" />';\n\n        if (indicator.showValue) { cntValues++; }\n      });\n\n      if (cntValues>0) {\n        svgText += '<text class=\"value\" y=\"'+this.getTexty()+'\"'\n          + ' text-anchor=\"' + this.getTextanchor() +'\"'\n          + ' font-size=\"' + this.getFontsize() + '\">'\n          + '<tspan x=\"'+this.getTextx()+'\" dy=\"0\">-</tspan>'\n          + ('<tspan x=\"'+this.getTextx()+'\" dy=\"' + this.getLinespace() + '\">-</tspan>').repeat(cntValues-1)\n          + '</text>';\n\n        var\n          textDistribution = ({start:[0,1],middle:[0.5,0.5],end:[1,0]})[this.getTextanchor()] || [0,1],\n          textU = Math.min(0, -this.getFontsize(), this.getLinespace()*(cntValues-1)-(this.getLinespace()<0?this.getFontsize():0)),\n          textD = Math.max(0, -this.getFontsize(), this.getLinespace()*(cntValues-1)-(this.getLinespace()<0?this.getFontsize():0));\n        BBox = bboxAdd(BBox, this.getTextx()-textDistribution[0]*this.getTextlength(), this.getTexty()+textU);\n        BBox = bboxAdd(BBox, this.getTextx()+textDistribution[1]*this.getTextlength(), this.getTexty()+textD);\n      }\n\n      var html = '<div class=\"actor\">'\n        + '<svg width=\"100%\" height=\"100%\" viewBox=\"' + [\n          BBox.l - this.getBboxgrow().l,\n          BBox.u - this.getBboxgrow().u,\n          BBox.r - BBox.l + this.getBboxgrow().l + this.getBboxgrow().r,\n          BBox.d - BBox.u + this.getBboxgrow().u + this.getBboxgrow().d\n        ].join(' ') + '\">';\n      if(this.getDebug()) {\n        html += '<rect width=\"'+(BBox.r-BBox.l)+'\" height=\"'+(BBox.d-BBox.u)+'\" x=\"'+(BBox.l)+'\" y=\"'+(BBox.u)+'\" stroke=\"blue\" fill=\"none\" />'\n          + '<rect width=\"'+(BBox.r-BBox.l + this.getBboxgrow().l + this.getBboxgrow().r)+'\" height=\"'+(BBox.d-BBox.u + this.getBboxgrow().u + this.getBboxgrow().d)+'\" x=\"'+(BBox.l - this.getBboxgrow().l)+'\" y=\"'+(BBox.u - this.getBboxgrow().u)+'\" stroke=\"green\" fill=\"none\" />'\n          + '<circle cx=\"0\" cy=\"0\" r=\"3\" fill=\"red\" />';\n      }\n\n      if (this.getAxisradius() > 0) {\n        var\n          sectorPath = createBarPath(s,0,e,0,this.getAxisradius(),0),\n          axisPath = createBarPath(s,0,e,0,this.getAxisradius(),this.getAxiswidth()),\n          stroke = this.getAxiscolor() === '' ? undefined : this.getAxiscolor(),\n          fill   = this.getAxiswidth() < 1 ? 'none' : stroke;\n        html +=\n          '<path class=\"sector\" d=\"'+sectorPath+' L0 0Z\"/>' +\n          '<path class=\"axis\" d=\"'+axisPath+'\" style=\"' +\n          (stroke ? 'stroke:'+stroke : '') +\n          (fill   ? ';fill:' +fill   : '') +\n          '\"/>';\n      }\n\n      html += svgMinor + svgMajor + svgRanges + svgLabels + svgIndicators + svgText;\n      html += '</svg></div>';\n\n      return html;\n    },\n\n    /**\n     * Updates the roundbar widget\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data\n     */\n    _update: function(address, data) {\n      if (data === undefined || address === undefined) { return; }\n      var\n        value = cv.Transform.decode( this.getAddress()[ address ][0], data ),\n        target = this.getTargetRatioValue(),\n        tspan = Array.from(this.getDomElement().getElementsByTagName('tspan')),\n        valueFormat = this.applyFormat(address, value);\n\n      this.getIndicators().forEach(function(indicator,i){\n        if(address === indicator.address) {\n          target[i] = [\n            (Math.min(Math.max(value,indicator.min),indicator.max)-indicator.min)/(indicator.max-indicator.min),\n            value < indicator.min,\n            value > indicator.max\n          ];\n          if (tspan[i] !== undefined) {\n            tspan[i].textContent = valueFormat;\n          }\n        }\n      });\n\n      this.setTargetRatioValue(target);\n\n      if(!this.animationFrame) {\n        // TODO: only animate when widget is visible\n        var\n          indicators = Array.from(this.getDomElement().getElementsByClassName('indicator'));\n        this.animateIndicators(indicators,false);\n      }\n    },\n\n    /**\n     * Update the display of the indicators.\n     *\n     * Note: It is a design decision not to pool multiple updates in one requestAnimationFrame which might be beneficial\n     * performace wise. But as it's assumed that a typical visu config is only containing one roundbar per address\n     * a pooling wouldn't make a difference on the one hand but complicate the code on the other hand.\n     * Even with a few roundbars using the same address the performance impact is negligible.\n     *\n     * @param indicatorElements Array with the bars to modify\n     * @param jumpToTarget skip animation\n     */\n    animateIndicators: function (indicatorElements, jumpToTarget) {\n      var\n        current = this.getCurrentRatioValue(),\n        target = this.getTargetRatioValue(),\n        indicators = this.getIndicators();\n\n      // current is already at target\n      if (current.every(function(this_i,i){return this_i === target[i][0];})) {\n        this.animationFrame = 0;\n        return; // then nothing to do\n      }\n      var\n        finished = true,\n        startAngle = this.getStart(),\n        endAngle = this.getEnd(),\n        overflowarrow = this.getOverflowarrow();\n\n      // calculate new values to show by applying two types of rate limiting:\n      // first do an exponential smoothing and then limit that to stay in range\n      // Note: for simplicity we don't care about the elapsed time, which would be the perfect way to do it\n      var expSmoothing = 0.2;\n      var rateLimit = 0.05;\n      indicatorElements.forEach(function(indicator,i){\n        if( jumpToTarget===true || Math.abs(current[i] - target[i][0]) < 0.01 ) {\n          current[i] = target[i][0];\n        } else {\n          finished = false;\n          var expSmoothedValue = current[i] * (1-expSmoothing) + target[i][0] * expSmoothing;\n          if( current[i] > expSmoothedValue ) {\n            current[i] = current[i]-expSmoothedValue > rateLimit ? current[i]-rateLimit : expSmoothedValue;\n          } else {\n            current[i] = current[i]-expSmoothedValue < -rateLimit ? current[i]+rateLimit : expSmoothedValue;\n          }\n        }\n\n        var targetAngle = startAngle + current[i]*(endAngle-startAngle);\n        if (!overflowarrow) {\n          targetAngle = (endAngle > startAngle)\n            ? Math.max(startAngle,targetAngle - indicators[i].endarrow)\n            : Math.min(startAngle,targetAngle - indicators[i].endarrow);\n        }\n\n        if (indicators[i].isBar) {\n          indicator.setAttribute('d',\n            cv.ui.structure.pure.Roundbar.createBarPath(\n              startAngle,\n              (overflowarrow&&!(target[i][1]&&current[i]<0.01)) ? 0 : indicators[i].startarrow,\n              targetAngle,\n              (overflowarrow&&!(target[i][2]&&current[i]>0.99)) ? 0 : indicators[i].endarrow,\n              indicators[i].radius,\n              indicators[i].width\n            )\n          );\n        } else {\n          indicator.setAttribute('d',\n            cv.ui.structure.pure.Roundbar.createPointerPath( targetAngle, indicators[i] )\n          );\n        }\n      });\n      this.setCurrentRatioValue(current);\n\n      this.animationFrame = window.requestAnimationFrame(this.animateIndicators.bind(this,indicatorElements,false));\n    }\n  }\n});\n\n","/* Slide.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a horizontal slider to the visu. This can be used, for example, to dim a light or change temperature values.\n *\n * @require(qx.module.Attribute)\n * @require(qx.module.Css)\n * @require(qx.module.Traversing)\n * @require(qx.module.Manipulating)\n * @require(qx.module.event.Keyboard)\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Slide', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.base(arguments, props);\n    // check provided address-items for at least one address which has write-access\n    var readonly = true;\n    for (var addrIdx in this.getAddress()) {\n      //noinspection JSBitwiseOperatorUsage\n      if (cv.data.Model.isWriteAddress(this.getAddress()[addrIdx])) {\n        // write-access detected --> no read-only mode\n        readonly = false;\n        break;\n      }\n    }\n    this.__readonly = readonly;\n\n    // initialize value with min value\n    if (this.getMin() <= 0 && 0 <= this.getMax()) {\n      this.setValue(this.applyMapping(0));\n    } else {\n      this.setValue(this.applyMapping(this.getMin()));\n    }\n  },\n\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    min: {\n      check: \"Number\",\n      init: 0\n    },\n    max: {\n      check: \"Number\",\n      init: 100\n    },\n    step: {\n      check: \"Number\",\n      init: 0.5\n    },\n    sendOnFinish: {\n      check: \"Boolean\",\n      init: false\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __main: null,\n    __timerId: null,\n    __slider : null,\n    __readonly: null,\n    __initialized: null,\n    __skipUpdatesFromSlider: null,\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      if (!this.__initialized) {\n        this.__skipUpdatesFromSlider = true;\n        var actor = this.getActor();\n        var slider = this.__slider = new cv.ui.website.Slider(actor, this.getPath());\n        slider.setFormat(this.getFormat());\n        slider.setConfig(\"step\", this.getStep());\n        slider.setConfig(\"minimum\", this.getMin());\n        slider.setConfig(\"maximum\", this.getMax());\n\n        if (this.__readonly) {\n          slider.setEnabled(false);\n        }\n        slider.init();\n        // set initial value\n        slider.setValue(parseFloat(this.getValue()));\n        var throttled = cv.util.Function.throttle(this._onChangeValue, 250, {trailing: true}, this);\n\n        slider.on(\"changeValue\", function (val) {\n          if (!this.__skipUpdatesFromSlider) {\n            throttled.call(val);\n          }\n        }, this);\n        slider.on('done', function () {\n          throttled.abort();\n          if (this.isSendOnFinish()) {\n            this._onChangeValue(slider.getValue(), true);\n          }\n        }, this);\n\n        this.addListener(\"changeValue\", function (ev) {\n          this.__skipUpdatesFromSlider = true;\n          slider.setValue(parseFloat(ev.getData()));\n          this.__skipUpdatesFromSlider = false;\n        }, this);\n\n        // add CSS classes for compability with old sliders\n        slider.addClasses([\"ui-slider\", \"ui-slider-horizontal\", \"ui-widget\", \"ui-widget-content\", \"ui-corner-all\"]);\n        var knob = slider.find(\".qx-slider-knob\");\n        knob.addClasses([\"ui-slider-handle\", \"ui-state-default\", \"ui-corner-all\"]);\n\n\n        this.addListener(\"changeVisible\", function (ev) {\n          if (ev.getData() === true) {\n            new qx.util.DeferredCall(this.__updateSlider, this).schedule();\n          }\n        }, this);\n        if (this.isVisible()) {\n          // delay the update, as the page width is not correct at this moment\n          qx.event.Timer.once(this.__updateSlider, this, 5);\n        }\n        this.__skipUpdatesFromSlider = false;\n        this.__initialized = true;\n\n      }\n    },\n\n    /**\n     * Refresh the slider position\n     */\n    __updateSlider: function() {\n      if (this.__slider) {\n        this.__skipUpdatesFromSlider = true;\n        this.__slider.updatePositions();\n        this.__skipUpdatesFromSlider = false;\n      }\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"></div>';\n    },\n\n    _update: function (ga, d) {\n      if ((this.__slider && this.__slider.isInPointerMove()) || d === undefined) {\n        return;\n      }\n      var value = this.applyTransform(ga, d);\n\n      try {\n        if (this.getValue() !== value) {\n          this.setValue(value);\n          if (this.__slider) {\n            this.__skipUpdatesFromSlider = true;\n            this.__slider.setValue(value);\n            this.__skipUpdatesFromSlider = false;\n          }\n        }\n      } catch(e) {\n        this.error(e);\n      }\n    },\n\n    // override Operate Mixins on click action, we handle that ourselfs with _onChangeValue\n    _action: function() {},\n\n    /**\n     * Handle incoming value changes send by the slider widget (e.g. triggered by user interaction)\n     * @param value {Number} the current value to send\n     * @param finished {Boolean} if sendOnFinish is true settings this parameter to true triggers the value to be send\n     */\n    _onChangeValue: function(value, finished) {\n      if (!this.__initialized || this.__skipUpdatesFromSlider === true) { return; }\n      if ((this.isSendOnFinish() === true && finished) ||\n        (this.isSendOnFinish() === false && this.__slider.isInPointerMove())\n      ) {\n        this._lastBusValue = this.sendToBackend(value, false, this._lastBusValue );\n      }\n      this.setValue(value);\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     */\n    getActionValue: function () {\n      return \"\";\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"slide\", statics);\n  }\n});\n","/* Switch.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The switch widget shows two states (e.g. ON and OFF) and can toggle between them.\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a switch widget using mapping and styling</caption>\n *   <screenshot name=\"switch_example_on\">\n *    <caption>Switch turned on</caption>\n *    <data address=\"0/0/0\">1</data>\n *   </screenshot>\n *   <screenshot name=\"switch_example_off\">\n *    <caption>Switch turned off</caption>\n *    <data address=\"0/0/0\">0</data>\n *   </screenshot>\n * </settings>\n * <meta>\n *  <mappings>\n *    <mapping name=\"OnOff\">\n *      <entry value=\"0\">O</entry>\n *      <entry value=\"1\">I</entry>\n *    </mapping>\n *  </mappings>\n *  <stylings>\n *    <styling name=\"GreyGreen\">\n *      <entry value=\"0\">grey</entry>\n *      <entry value=\"1\">green</entry>\n *    </styling>\n *  </stylings>\n * </meta>\n * <switch mapping=\"OnOff\" styling=\"GreyGreen\">\n *   <layout colspan=\"3\" />\n *   <label>Switch</label>\n *   <address transform=\"DPT:1.001\" mode=\"readwrite\">0/0/0</address>\n * </switch>\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Switch', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update],\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    onValue: {\n      check: \"String\",\n      init: \"1\"\n    },\n    offValue: {\n      check: \"String\",\n      init: \"0\"\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param value {any} incoming data (already transformed + mapped)\n     */\n    handleUpdate: function(value) {\n      var actor = this.getActor();\n      // compare against the unmapped value\n      value = this.getBasicValue();\n      var off = this.getOffValue();\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      actor.classList.remove(value == off ? 'switchPressed' : 'switchUnpressed'); // jshint ignore:line\n      actor.classList.add(value == off ? 'switchUnpressed' : 'switchPressed'); // jshint ignore:line\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @return {var}\n     */\n    getActionValue: function () {\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      return (this.getBasicValue() == this.getOffValue() ? this.getOnValue() : this.getOffValue()); // jshint ignore:line\n    }\n  }\n});","/* Text.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The text-tag defines static (non-changing) text to be displayed on a page. The content of a &lt;label&gt; with free text.\n *\n * @widgetexample <settings>\n *   <caption>Configuration example of a centered text widget</caption>\n *   <screenshot name=\"text_example\" />\n * </settings>\n * <text align=\"center\"><label>Example text</label></text>\n *\n *\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Text', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '';\n    }\n  }\n});","/* Toggle.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The toggle widget is similar to the switch, but it can take more than two states.\n * Can be used to change the operating modes of the heating system.\n * Each time the toggle is pressed, the toggle takes the next possible state.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Toggle', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [cv.ui.common.Operate, cv.ui.common.Update, cv.ui.common.HasAnimatedButton],\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Get the value that should be send to backend after the action has been triggered\n     * @return {var}\n     */\n    getActionValue: function () {\n      return this.getNextMappedValue(this.getBasicValue(), this.getMapping());\n    }\n  }\n});","/* Trigger.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a button to the visu with which exactly a defined value for a short,\n * as well as a defined value for a long key pressure, can be sent to the BUS,\n * e.g. for recalling and storing scenes or driving roller blinds. (Short = stop, long = drive).\n * The address for short and long term may vary.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Trigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.BasicUpdate,\n    cv.ui.common.HandleLongpress\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: \"String\", init: \"0\" },\n    shortValue: { check: \"String\", init: \"0\" }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue(), this.getDomElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor switchUnpressed\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Handle a short tap event and send the value for short pressing the trigger to the backend.\n     * If there is no short threshold set, this send the value for long presses to the backend.\n     */\n    _action: function() {\n      var value = (this.getShortThreshold() > 0 || this.isShortDefault()) ? this.getShortValue() : this.getSendValue();\n      this.sendToBackend(value, function(address) {\n        return !!(address[2] & 1);\n      });\n    },\n\n    /**\n     * Handle a long tap event and send the value for long pressing the trigger to the backend.\n     */\n    _onLongTap: function() {\n      this.sendToBackend(this.getSendValue(), function(address) {\n        return !!(address[2] & 2);\n      });\n    }\n  }\n});","/* Unknown.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Fallback widget shown when an unknown widget is defined in the configuration.\n * You must not use this one directly.\n *\n * @author Christian Mayer\n * @since 0.8.0 (2012)\n */\nqx.Class.define('cv.ui.structure.pure.Unknown', {\n  extend: qx.core.Object,\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct: function(props) {\n    this.set(props);\n  },\n\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    path: {\n      check: \"String\",\n      init: \"\"\n    },\n    $$type: {\n      check: \"String\",\n      init: \"Unknown\"\n    },\n    unknownType: {\n      check: \"String\",\n      init: \"\"\n    },\n    pageType: {\n      check: [\"text\", \"2d\", \"3d\"],\n      init: \"text\"\n    },\n    parentWidget: {\n      check: \"cv.ui.structure.AbstractBasicWidget\",\n      init: null\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    /**\n     * Returns the DOM-Element of this widget\n     * @return {Element} the DOM element\n     */\n    getDomElement: function () {\n      return document.querySelector('#' + this.getPath());\n    },\n\n    /**\n     * Return the HTML string for this widget\n     * @return {String} HTML code\n     */\n    getDomString: function () {\n      return '<div class=\"widget clearfix\"><pre>'+qx.locale.Manager.tr(\"unknown: %1\", this.getUnknownType()) + '</pre></div>';\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"unknown\", statics);\n  }\n});\n\n","/* UrlTrigger.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The UrlTrigger widget adds a button to the visualization that queries data from a URL in the background.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.UrlTrigger', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Operate,\n    cv.ui.common.HasAnimatedButton,\n    cv.ui.common.BasicUpdate\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    sendValue: { check: \"String\", init: \"0\" },\n    params: { check: \"String\", init: '' },\n    url: { check: \"String\", nullable: true, apply: \"_applyUrl\" }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __xhr: null,\n\n    // property apply\n    _applyUrl: function(value) {\n      if (value) {\n        if (!this.__xhr) {\n          var xhr = new qx.io.request.Xhr(qx.util.ResourceManager.getInstance().toUri(value));\n          xhr.set({\n            method: \"GET\",\n            accept: \"application/html\",\n            requestData: this.getParams()\n          });\n          this.__xhr = xhr;\n        } else {\n          this.__xhr.setUrl(qx.util.ResourceManager.getInstance().toUri(value));\n        }\n      }\n    },\n\n    // overridden\n    _onDomReady: function() {\n      this.base(arguments);\n      this.defaultUpdate(undefined, this.getSendValue(), this.getDomElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      var actor = '<div class=\"actor switchUnpressed ';\n      if ( this.getAlign() ) {\n        actor += this.getAlign();\n      }\n      actor += '\"><div class=\"value\"></div></div>';\n      return actor;\n    },\n\n    // overridden\n    _action: function() {\n      if (this.__xhr) {\n        this.__xhr.send();\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this._disposeObjects(\"__xhr\");\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"urltrigger\", statics);\n  }\n});\n","/* Video.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds a video or live stream to the visu. Currently, most sources do not support this yet.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Video', {\n  extend: cv.ui.structure.AbstractWidget,\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    width   : { check: \"String\", nullable: true },\n    height  : { check: \"String\", nullable: true },\n    src     : { check: \"String\", init: \"\" },\n    autoplay: { check: \"Boolean\", init: false }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      // create the actor\n      var style = '';\n      if (this.getWidth()) {\n        style += 'width:' + this.getWidth() + ';';\n      }\n      if (this.getHeight()) {\n        style += 'height:' + this.getHeight() + ';';\n      }\n      if (style !== '') { style = 'style=\"' + style + '\"'; }\n      var autoplay = this.isAutoplay() ? ' autoplay=\"autoplay\"' : '';\n      return '<div class=\"actor\"><video src=\"' + this.getSrc() + '\" ' + style + autoplay + '  controls=\"controls\" /></div>';\n    },\n\n    // overridden\n    getValueElement: function() {\n      return this.getDomElement().querySelector(\"video\");\n    },\n\n    // overridden\n    _applyVisible: function(value) {\n      var video = this.getValueElement();\n      if (video) {\n        if (value === true && this.isAutoplay()) {\n          video.play();\n        } else {\n          video.pause();\n        }\n      }\n    }\n  }\n});","/* Web.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an area to the visu, where external websites can be displayed.\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.Web', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: [\n    cv.ui.common.Update,\n    cv.ui.common.Refresh\n  ],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n\n    width: {\n      check: \"String\",\n      nullable: true\n    },\n    height: {\n      check: \"String\",\n      nullable: true\n    },\n    frameborder: {\n      check: \"Boolean\",\n      init: false\n    },\n    background: {\n      check: \"String\",\n      nullable: true\n    },\n    scrolling: {\n      check: [\"auto\", \"yes\", \"no\"],\n      nullable: true\n    },\n    src: {\n      check: \"String\",\n      nullable: true\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    // overridden\n    _getInnerDomString: function () {\n      var webStyle = '';\n      if (this.getWidth()) {\n        webStyle += 'width:' + this.getWidth() + ';';\n      } else {  // default width is 100% of widget space (fix bug #3175343 part 1)\n        webStyle += 'width: 100%;';\n      }\n      var style = this.getStyle();\n      if (this.getHeight()) { webStyle += 'height:' + this.getHeight() + ';'; }\n      if (this.getFrameborder() === false) { style += 'border: 0px ;'; }\n      if (this.getBackground()) { webStyle += 'background-color:' + this.getBackground() + ';'; }\n      if (webStyle !== '') { webStyle = 'style=\"' + webStyle + '\"'; }\n\n      var scrolling = '';\n      if (this.getScrolling()) { scrolling = 'scrolling=\"' + this.getScrolling() + '\"'; } // add scrolling parameter to iframe\n      return '<div class=\"actor\"><iframe src=\"' + this.getSrc() + '\" ' + webStyle + scrolling + '></iframe></div>';\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param address {String} KNX-GA or openHAB item name\n     * @param data {var} incoming data (already transformed + mapped)\n     */\n    _update: function(address, data) {\n      var addr = this.getAddress()[ address ];\n      if (!addr) { return; }\n      if (data === 1) {\n        var iframe = this.getDomElement().querySelector('iframe');\n        this.refreshAction(iframe, iframe.getAttribute('src'));\n        // reset the value\n        cv.TemplateEngine.getInstance().visu.write( address, cv.Transform.encode(addr[0], 0));\n      }\n    }\n  }\n});\n\n","/* WgPluginInfo.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Adds an dynamic field to the visu that shows live information from a WireGate plugin.\n * \n * Note: The service helper from\n * https://raw.githubusercontent.com/OpenAutomationProject/Wiregate/master/tools/wg-plugindb/wg-plugindb.php\n * must be \"installed\" in the directory /var/www/ (i.e. the web root)\n *\n * @author Christian Mayer\n * @since 2012\n */\nqx.Class.define('cv.ui.structure.pure.WgPluginInfo', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.Update,\n\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    variable   : { check: \"String\", nullable: true, apply: \"_applyVariable\" }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __request: null,\n\n    // property apply\n    _applyVariable: function(value) {\n      if (value) {\n        if (!this.__request) {\n          // create the request\n          this.__request = new qx.io.request.Xhr('/wg-plugindb.php?name=' + value);\n          this.__request.set({\n            accept: \"application/json\"\n          });\n          this.__request.addListener(\"success\", this._onSuccess, this);\n        } else {\n          this.__request.setUrl('/wg-plugindb.php?name=' + value);\n        }\n        cv.TemplateEngine.getInstance().executeWhenDomFinished(this.__request.send, this.__request);\n      }\n    },\n\n    /**\n     * Handle successful requests from {@link qx.io.request.Xhr}\n     * @param ev {Event}\n     */\n    _onSuccess: function(ev) {\n      var req = ev.getTarget();\n      var data = req.getResponse();\n      this.defaultUpdate(undefined, data[this.getVariable()], this.getValueElement());\n    },\n\n    // overridden\n    _getInnerDomString: function () {\n      return '<div class=\"actor\"><div class=\"value\">-</div></div>';\n    },\n\n    /**\n     * Triggers an {@link qx.io.request.Xhr} request to query the plugin value\n     */\n    handleUpdate: function() {\n      if (this.__request) {\n        this.__request.send();\n      }\n    }\n  },\n\n  /*\n  ******************************************************\n    DESTRUCTOR\n  ******************************************************\n  */\n  destruct: function() {\n    this._disposeObjects(\"__request\");\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"wgplugin_info\", statics);\n  }\n});","/* WidgetInfoAction.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This is a helper class for the InfoAction widget it cannot be used directly\n *\n * @author Tobias Brutigam\n * @since 0.10.0 (as widget), 0.9.2 (as plugin)\n */\nqx.Class.define('cv.ui.structure.pure.WidgetInfoAction', {\n  extend: cv.ui.structure.AbstractWidget,\n  include: cv.ui.common.HasChildren,\n\n  /*\n   ******************************************************\n   PROPERTIES\n   ******************************************************\n   */\n  properties: {\n    anonymous : {\n      refine: true,\n      init: true\n    },\n    childObjects: {check: \"Array\", init: []}\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    // overridden\n    getDomString: function () {\n      return this.getChildrenDomString();\n    }\n  },\n\n  defer: function(statics) {\n    cv.ui.structure.WidgetFactory.registerClass(\"widgetinfo\", statics);\n    cv.ui.structure.WidgetFactory.registerClass(\"widgetaction\", statics);\n  }\n});\n"]}