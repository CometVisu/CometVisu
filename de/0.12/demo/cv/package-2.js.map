{"version":3,"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/IActionHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/MFileEventHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/IFileEventHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/Main.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/FileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/BackupFolder.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/ActionDispatcher.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/snackbar/Controller.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Preferences.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileHandlerRegistry.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/IEditor.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/AbstractEditor.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/core/GlobalState.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/OpenFile.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/CompareFiles.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileController.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/Prompt.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/MenuBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/upload/UploadMgr.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/upload/MDragUpload.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/FileSystem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/ToolBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/FileTabItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/BigAlert.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Message.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/snackbar/Message.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/AbstractViewer.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Folder.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Icons.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/Start.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Source.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Diff.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Worker.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/FileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/GlobalFileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/VirtualFsItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/FileListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/core/IconAtom.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/completion/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Schema.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/completion/CometVisu.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/ElementChange.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/VirtualElementItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/ConfigElement.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ElementForm.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Base.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/MAnnotation.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Element.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/XmlElement.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/data/Provider.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/ValidationError.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/config/Section.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SectionListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/SvgIcon.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/basic/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SourceCodeField.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/Option.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/VirtualSelectBox.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/CheckBox.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ElementFormRenderer.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/DocumentationMapping.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/SimpleType.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Choice.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Sequence.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Group.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Any.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Attribute.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/config/Option.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/OptionListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/basic/Icon.js"],"names":["qx","Interface","define","members","canHandleAction","actionName","handleAction","data","configureButton","actionId","button","unConfigureButton","cv","ui","manager","IActionHandler","$$dbClassInfo","Bootstrap","executePendingDefers","Mixin","construct","this","_disableFileEvents","event","message","Bus","subscribe","_handleFileEvent","destruct","unsubscribe","control","MFileEventHandler","ev","IFileEventHandler","Class","extend","core","Object","type","include","implement","constructor","call","iconfont","material","Load","model","BackupFolder","getInstance","_checkEnvironment","initOpenFiles","Array","__P_24_0","ActionDispatcher","setMain","__P_24_1","_draw","_onManagerEvent","tooltip","Manager","statics","ROOT","properties","openFiles","check","deferredInit","writeableFolder","init","currentFolder","nullable","apply","currentSelection","deleteableSelection","renameableSelection","visible","__P_24_2","__P_24_3","_pane","_tree","_stack","_oldCommandGroup","_managerCommands","_mainContent","_openFilesController","_hiddenConfigFakeFile","_applyVisible","value","Init","getApplication","getCommandManager","setActive","bom","element","Style","set","__P_24_4","io","rest","Client","getFsClient","checkEnvironmentSync","err","res","snackbar","Controller","error","forEach","env","refreshActions","entity","state","locale","tr","FileItem","setReadable","setWriteable","widget","getFocusedWidget","resetFocusedWidget","setFocusedWidget","getCurrentSelection","isWriteable","actions","getCurrentFolder","push","includes","closeFile","closeCurrentFile","setVisible","_onCreate","readSync","path","file","getFullPath","isConfigFile","_onDelete","_showAbout","warn","getData","action","getOpenFiles","copy","some","openFile","getFile","isRelated","resetCurrentFolder","__P_24_5","name","demoFolder","getChildren","child","getName","handler","handlerOptions","_onChangeTreeSelection","Preferences","isQuickPreview","mode","__P_24_6","node","getType","setCurrentFolder","getParent","setCurrentSelection","resetCurrentSelection","setEditing","_applyCurrentFolder","old","removeRelatedBindings","bind","resetWriteableFolder","_applyCurrentSelection","converter","resetDeleteableSelection","_onChangeFileSelection","sel","getSelection","length","editorConfig","getItem","handlerId","getHandlerId","FileHandlerRegistry","getFileHandlerById","getFileHandler","instance","Clazz","isReady","setFile","addListenerOnce","indexOf","add","editor","AbstractEditor","setHandlerOptions","getHandlerOptions","setSelection","GlobalState","setOpenedFocusedFile","resetOpenedFocusedFile","preview","handlerType","handlerConf","isExternal","info","classname","isOpen","of","OpenFile","resetHandlerOptions","isPermanent","setItem","setPermanent","getTarget","setModelSelection","force","f","isCloseable","isModified","resetPermanent","selectionIndex","remove","currentHandler","hasInterface","IEditor","resetFile","resetSelection","replace","CompareFiles","fileHandlerConf","clear","filter","destroy","window","monaco","oldModel","getModel","getUri","dispose","isTemporary","qxl","dialog","Dialog","confirm","confirmed","resetModified","dispatchByName","selected","_onCloseFile","dom","Element","create","id","style","insertEnd","document","body","theme","Meta","setTheme","Dark","group","command","Group","Command","renameCommand","getActive","item","FileController","_onChangeStackSelection","page","toArray","find","__P_24_7","callback","context","caption","prompt","Prompt","show","content","folder","existsMessage","handlePrompt","filename","match","exec","readable","writeable","loaded","modified","temporary","parentFolder","createSync","getBusTopic","source","addChild","sortElements","refresh","__P_24_8","elem","nodeType","getAttribute","parentNode","domRoot","root","Inline","getContentElement","getDomElement","addEventListener","target","preventDefault","setRoot","setLayout","layout","Canvas","bottom","left","resize","bounds","getBounds","setLayoutProperties","Math","round","width","setMaxHeight","height","addListener","innerHeight","main","container","Composite","Dock","edge","menuBar","MenuBar","uploadButton","getButton","uploadManager","upload","UploadMgr","splitpane","Pane","rootFolder","fakeIconFile","getIconFile","overrideIcon","open","fakeChildren","icon","dark","Images","getIcon","tree","FileSystem","leftContainer","VBox","leftBar","ToolBar","reload","buttonConfig","getButtonConfiguration","args","flex","list","form","List","setAppearance","controller","setDelegate","createItem","FileTabItem","bindItem","index","bindDefaultProperties","bindProperty","Stack","startOpenFile","setCloseable","dialogConf","modal","minWidth","min","Viewport","getWidth","maxHeight","getHeight","concat","Version","VERSION","DATE","REV","LIBRARY_VERSION","BigAlert","_disposeObjects","application","util","DeferredCall","resetRoot","schedule","removeChild","Main","$$instance","marshal","MEventBubbling","parent","initChildren","setFakeChildren","endsWith","__P_42_0","setName","setParent","_onChangeLocale","_fakeIconFile","_acceptedFiles",".","media","test","getConfigName","hasChildren","fake","getHiddenConfigFile","displayName","getAcceptedFiles","loading","children","hash","editing","special","valid","hasWarnings","transform","mounted","trash","inTrash","__P_42_1","__P_42_2","_toLowerCase","toLowerCase","isFake","startsWith","_applyName","getDisplayName","setDisplayName","getPath","getParentFolder","_onOpen","isLoaded","load","_maintainIcon","isOverrideIcon","setIcon","isTrash","isMounted","_applyHasChildren","unload","setLoaded","setLoading","removeAll","oldParent","_onGet","prototype","hasOwnProperty","nodeChildren","getFakeChildren","append","_onError","isLoading","getServerPath","LibraryManager","get","sort","a","b","localeCompare","openPath","parts","lang","Type","isArray","split","relPath","shift","setOpen","translate","_onFilesSystemMessage","getBackupFiles","files","pathparts","pop","join","suffix","fileRegex","RegExp","backupFile","date","Date","parseInt","substring","_onAction","focusedWidget","updateBarButtons","actionHandler","config","keys","setEnabled","general","hasHandler","_applyFocusedWidget","_getHandler","getMain","Widget","_setLayout","initMessages","_onMessage","_listController","getMessages","getChildControl","_initDelegate","msg","Message","title","_typeof","statusText","sticky","appearance","refine","messages","_onCloseMessage","exclude","_createChildControlImpl","_add","base","_restorePreferences","defaultConfigEditor","quickPreview","expertMode","startViewMode","_skipSaving","_savePreferences","store","Storage","getLocal","Serializer","toNativeObject","report","Record","record","STORAGE","setPreferences","preferences","noSave","__P_31_0","__P_31_1","registerFileHandler","viewer","Image","SUPPORTED_FILES","Config","Icons","Folder","Start","Source","Tree","Diff","_onChangesDefaultConfigEditor","selector","clazz","options","assign","isClass","instanceOf","selectorId","priority","isRegExp","regex","toString","isFunction","isString","fullPath","fileName","handlers","defaultHandler","key","noTemporaryFiles","noReadOnlyFiles","__P_31_2","hasFileHandler","setDefault","getDefaultConfigEditor","DEFAULT_FOR","getAllFileHandlers","map","removeListener","external","ready","TITLE","save","getCurrentContent","_initClient","_nativePasteSupported","queryCommandSupported","CLIPBOARD","_handledActions","_client","_applyHandlerOptions","_loadFile","_onChange","getContent","setContent","_loadFromFs","resetContent","XMLDocument","XMLSerializer","serializeToString","_applyContent","_handleSaveResponse","_onSaved","overrideHash","getHash","Function","curry","updateSync","resetTemporary","showErrors","errorList","showDecorations","decorators","openedFocusedFile","_applyFile","setHandlerId","permanent","closeable","__P_43_0","_maintainPermanent","handlerClass","getByName","ICON","removeBinding","resetIcon","original","setOriginalFile","setModifiedFile","originalFile","modifiedFile","getOriginalFile","getModifiedFile","_applyModifiedFile","isInTrash","__P_30_0","rename","newName","newPath","moveSync","src","resetEditing","move","restore","__P_30_1","targetFileName","targetFile","delete","__P_30_2","deleteSync","download","createElement","setAttribute","getBaseUrl","display","appendChild","click","validate","__P_30_3","d","alert","Worker","validateConfig","then","close","setValid","jumpToError","trn","_createWidgetContent","_textField","setLiveUpdate","menubar","_commandGroup","__P_25_0","__P_25_1","__P_25_2","_createChildControl","Spacer","editorGroup","RadioGroup","new-file","menu","enabled","new-folder","separator","new-config-file","com","zenesis","UploadMenuButton","save-as","hidden","quit","undo","redo","cut","paste","source-editor","RadioButton","xml-editor","quick-preview","CheckBox","expert-mode","help","about","maintainButtons","prefs","getModelSelection","setDefaultConfigEditor","__P_25_3","buttonName","preferenceName","merge","buttonConf","label","ButtonClass","Button","setValue","Error","Separator","onAfterCreate","basic","Label","Menu","uploadUrl","_init","LAST_ID","multiple","_updateUploadUrl","getFolder","url","setUploadUrl","evt","getFilename","setParam","isForce","progressListenerId","uploadedSize","debug","getSize","stateListenerId","getStatus","forceUpload","getResponse","Json","parse","e","removeListenerById","_getUniqueFileId","setForce","newFile","File","getBrowserObject","getId","size","uploadWidget","getUploadWidget","getUploadHandler","_addFile","getAutoUpload","beginUploads","uploadFile","bomFile","fileSize","setSize","setUploadWidget","UploadButton","replaceFile","replacedFile","setFolder","setDroppable","_applyStartDragListeners","_getLayout","Grow","__P_53_0","uploadMode","uploadHint","onHtml5Drop","getFiles","isAccepted","hasDroppableFile","i","l","dataTransfer","items","kind","getAsFile","__P_53_2","_boundOnStop","setUserBounds","top","_createMDragUploadChildControlImpl","setZIndex","setBackgroundColor","dropBox","Atom","getUploadHint","iconPosition","rich","center","setWrap","setAnonymous","_onStopDragging","setUploadMode","removeEventListener","_isDroppable","MDragUpload","_applyDragListeners","uploadable","_onDrop","lid","__P_53_1","hasChildControl","isVisible","setRootFolder","_onEnableTree","MIMETYPES","text/xml","application/xml","text/javascript","application/x-httpd-php","text/css","image/png","image/svg+xml","text/plain","getMimetypeFromSuffix","mime","mimetype","events","changeSelection","selectedNode","__P_50_0","__P_50_1","__P_50_2","_replacementManager","openPaths","getOpenNodes","_applyRootFolder","setModel","setHideRoot","_applySelectedNode","contextMenu","contextmenu","GlobalFileItem","configure","setContextMenu","_onDblTapTreeSelection","getSelectedNode","stop","fireDataEvent","setSelectedNode","Timer","once","resetContextMenu","resetSelectedNode","_onFsItemRightClick","VirtualFsItem","VirtualTree","selectionMode","showTopLevelOpenCloseIcons","bindPropertyReverse","toolbar","showOnly","__P_27_0","_menuBar","_menuButtonConfig","_uploadManager","__P_27_1","newButton","fileController","createPart","Part","marginLeft","MenuButton","_createButton","addWidget","deleteSelection","setToolTipText","checkConfig","fireEvent","doNotUseCommand","_applyFolder","resetFolder","__P_27_2","IModel","HBox","_onPointerOver","_onPointerOut","dereference","_forwardStates","focused","hovered","dragover","addState","_transformFilename","removeState","_applyPermanent","setFont","_applyCloseable","setVisibility","_applyModel","_applyIcon","setSource","_applyLabel","getLabel","labelValue","resetToolTipText","_onClose","_addAt","Alert","_hbox","_applyImage","_image","scale","addAt","_createDialogContainer","hbox","scroll","Scroll","Document","getRoot","image","getImage","_message","setRich","setWidth","setAllowStretchX","buttonPane","_createButtonPane","okButton","_createOkButton","_onAppear","timeout","_timer","_applyType","setDecorator","getAppearance","_applyTimeout","getTimeout","_scaleImage","AbstractViewer","getImageData","ResourceManager","aspectRatio","ImageLoader","setLabel","resetLabel","availableHeight","paddingY","paddingX","connectToWindow","_windowRef","_source","_reloading","_applyConnectToWindow","setExternal","configName","Uri","getAbsolute","hint","ref","isConnectToWindow","onbeforeunload","iframe","resetSource","_this","getDocument","location","href","openPage","contentWindow","otherEngine","TemplateEngine","pageId","getPageIdByPath","scrollToPage","setHighlightWidget","widgetId","setHighlightedWidget","_this2","embed","Iframe","font","focus","backgroundColor","IMultiSelection","IModelSelection","MMultiSelectionHandling","MRemoteChildrenHandling","MModelSelection","noToolbar","_isImageRegex","initModel","_newItem","_debouncedOnFilter","debounce","_onFilter","addItem","removeItem","permanentFilter","showTextFilter","labelConverter","disableScrolling","viewMode","_controller","SELECTION_MANAGER","selection","ScrollArea","_defaultLabelConverter","getViewMode","_getDelegate","getLabelConverter","FileListItem","configureItem","_onDblTap","setShowFileActions","getCurrentTarget","getSpecial","openAtPointer","getBubbles","stopPropagation","resetModel","getValue","getPermanentFilter","resetParent","_applyShowTextFilter","filterString","filterFunction","filtered","getChildrenContainer","_onAddChild","_onRemoveChild","_onFileEvent","_applyDisableScrolling","scrollContainer","TextField","placeholder","liveUpdate","margin","isShowTextFilter","Flow","isDisableScrolling","IconAtom","IconConfig","DB","entry","_configRegex","selectedItem","_ignoreSelectionChanges","_previewButton","_listButton","_radioGroup","_loadRoot","found","_onChangeSelection","setSelectedItem","_applySelectedItem","_onToggleExpand","getUserData","getVisibility","_onChangeViewMode","getStartViewMode","part","listButton","setUserData","toolTipText","previewButton","setStartViewMode","__P_26_0","folderWidget","specialFiles","unshift","fakeFolder","_basePath","origin","pathname","droppable","focusable","effectAllowed","dropEffect","FocusHandler","setUseTabNavigation","_initWorker","_currentDecorations","COUNTER","MONACO_EXTENSION_REGEX","languages","extensions","getLanguages","ext","sourcePath","loader","DynamicScriptLoader","require","paths","vs","vs/nls","availableLanguages","*","getLanguage","noCacheSuffix","random","schema","qxLib","__P_33_0","typescript","javascriptDefaults","addExtraLib","completionProvider","completion","Schema","cvCompletionProvider","CometVisu","registerCompletionItemProvider","getProvider","log","Logger","start","_editor","_workerWrapper","_configClient","_onDidChangeContentGuard","setEditor","_getDefaultModelOptions","tabSize","indentSize","insertSpaces","domElement","suggestOnTriggerCharacters","folding","autoIndent","automaticLayout","dragAndDrop","formatOnPaste","formatOnType","renderValidationDecorations","minimap","baseVersion","xhr","request","Xhr","toUri","method","accept","json","jsonDefaults","setDiagnosticsOptions","allowComments","schemas","uri","fileMatch","send","onDidChangeModelContent","_onContentChanged","trigger","getValueInRange","_paste","op","identifier","major","minor","range","text","forceMoveMarkers","executeEdits","isSupported","getConfigClient","JSON","stringify","section","isValid","getHasWarnings","__P_33_1","saveSync","status","newModel","xml","isXmlDocument","documentElement","outerHTML","createModel","_getLanguage","onDidChangeDecorations","errors","warnings","getModelMarkers","owner","getModeId","resource","marker","severity","MarkerSeverity","Warning","setHasWarnings","updateOptions","readOnly","_processHandlerOptions","upgradeVersion","_this$_upgradeConfig","_upgradeConfig","_this$_upgradeConfig2","_slicedToArray","_convertToString","ConfigUpgrader","upgrade","contentChanged","fileType","typeExt","markers","firstErrorLine","line","startLineNumber","endLineNumber","startColumn","endColumn","setModelMarkers","getScrollTop","revealLineInCenter","deltaDecorations","_schema","onLoaded","setReady","__P_34_0","__P_34_1","setPreviewState","structureChanges","hasChildrenModified","initUnDos","initReDos","__P_34_2","_onElementKeyUp","_maintainPreviewVisibility","Allowed","NONE","BEFORE","AFTER","INSIDE","FIRST_CHILD","expert","clipboard","unDos","reDos","autoRefreshPreview","previewState","showPreview","dragging","__P_34_3","__P_34_4","__P_34_5","isPreviewSynced","getPreviewState","setShowPreview","noPreview","_applyShowPreview","clearLayoutProperties","updateLayoutProperties","noStretch","previewConfig","_updatePreview","_onCut","_onCopy","_onPaste","_showHelp","getUnDos","getTitle","getReDos","isDeletable","addUndo","elementChange","ElementChange","clearUnDosReDos","clearReDos","_applyClipboard","navigator","writeText","getNode","resetPreviewState","_this3","isShowPreview","ok","noSync","notOk","_onEdit","toggleExpert","right","_onSearch","getKeyIdentifier","_showNextResult","_showPreviousResult","openMode","itemHeight","Environment","_initDragDrop","VirtualElementItem","_onContextMenuAction","_onContextMenu","setDraggable","setMarginLeft","getSelected","decoration","Decorator","widthTop","styleTop","colorTop","setHeight","setOpacity","ConfigElement","setSelected","setElement","added","resetSelected","openByQuerySelector","edit","_this4","Promise","resolve","reject","result","querySelector","__P_34_6","rootNode","from","querySelectorAll","el","tagName","hasAttribute","firstMatch","$$widget","openNodeAndParents","current","ancestors","parentElement","p","draggedXmlElement","dragTarget","getDragTarget","setDragging","isEditable","addAction","addType","addData","addButton","accepted","_this5","getCurrentAction","supportsType","addNew","indicator","isAncestor","layerContent","getPane","getLayers","getContentLocation","getDocumentTop","lastElem","elementFromPoint","getWidgetByElement","isAnonymous","getLayoutParent","parentSchemaElement","getSchemaElement","allowedElements","getAllowedElements","addable","getAddableChildren","areChildrenSortable","acc","allowedSorting","getAllowedElementsSorting","elementName","__P_34_7","isChildElementAllowed","_allowedSorting","getFirstLevelElementSorting","targetPosition","undefined","firstChildPosition","expandTimer","lastTreeItem","treeContainer","onDrag","position","cursor","getManager","getCursor","DragDropCursor","_native","pointerType","hasState","origElem","getDocumentLeft","orig","skipDetection","origCoords","leftPos","_getChildren","getPaddingLeft","lastCoords","setDomPosition","openNode","getAction","resetAction","console","assert","setAction","onDrop","clone","moveAfter","insertAfter","moveBefore","insertBefore","moveInside","insertChild","onDragEnd","resetUserData","resetDragging","_this6","sorting","minPosition","maxPosition","targetIndex","sibling","_targetIndex","_found","_i","_sibling","firstChild","ElementForm","allowCancel","formData","validation","required","promise","_document","ownerDocument","isElement","createComment","createTextNode","createCDATASection","schemaElement","getSchemaElementForElementName","requiredChildren","getRequiredElements","sortChildNodes","childName","isTextContentRequired","xmlElement","XmlElement","getEditor","isShowEditButton","targetName","depth","currentPosition","_depth","__P_34_8","_this7","provider","Provider","getLive","userInputAllowed","__P_34_9","attribute","docs","getDocumentation","def","getDefaultValue","isOptional","validator","ListItem","isValueValid","ValidationError","getTypeString","enums","getEnumeration","isNew","_this8","getShowEditButton","typeElement","Node","ELEMENT_NODE","allowed","getAllowedAttributes","getExpert","getAppinfo","parser","DOMParser","attrName","nodeName","lines","autoSize","innerHTML","parseFromString","getElementsByTagName","TEXT_NODE","COMMENT_NODE","CDATA_SECTION_NODE","getTextContent","isTextNode","convertTextNodeType","newNodeName","formDialog","maxWidth","setAttributes","execCommand","setClipboard","clipboardElement","getClipboard","resetClipboard","updateModified","previewIndex","$$removed","splice","setModified","addSeparator","addSpacer","_applySelected","_updateHighlightWidget","getWidgetPath","_this9","initialValidation","validateXmlConfig","__P_34_10","_file","hide","_this10","_document2","fromString","getElementNode","setEditable","getWriteable","setContentPaddingBottom","substr","isAutoRefreshPreview","reset","_this11","previewFile","fast","_prettify","level","singleton","tabs","fill","textContent","trim","String","escape","output","attributes","childNodes","onlyOneTextChild","_i2","onSaved","_disposeArray","originalContent","modifiedContent","editable","_applyEditable","createDiffEditor","getEditable","getOriginalContent","getModifiedContent","originalModel","modifiedModel","getModifiedEditor","setOriginalContent","_err","upgradedContent","changes","setModifiedContent","changesText","yesButtonLabel","noButtonLabel","resetEditable","resetOriginalContent","resetModifiedContent","_model","__P_32_0","_onModelValueChange","sectionName","Section","optionKey","addOption","__P_32_1","_onDeleteSection","sectionListItem","optionKeys","getOptions","option","getKey","setEnableInlineFind","SectionListItem","_files","_worker","FileWorker","code","features","postMessage","topic","setHash","currentHash","terminate","noCompare","_noCompare","_dateFormat","format","DateFormat","getDateFormat","_timeFormat","getTimeFormat","active","_selectedNode","_renameDialog","isFolder","isBackup","visibility","compareMenu","backups","getTime","backupEntry","groupButton","_onCompareWith","openWithMenu","availableHandlers","_onOpenWith","setFilename","controlName","_noNew","sep","isActive","compareWith","_onRename","_onDownload","_onRestore","_onValidate","_onClone","VirtualTreeItem","_applyEditing","field","_applyTemporary","_applyStatus","getRelatedTarget","__P_52_0","_onKeypress","setDesktop","_maintainFileActions","setUploadHint","showFileActions","themeable","gap","inheritable","acceptUpload","_applyViewMode","handled","firstUp","__P_38_0","isShowFileActions","editorConf","viewerConf","openButton","editButton","sizeHint","getSizeHint","padding","setPadding","_maintainFileTypePosition","iconBounds","prop","zIndex","anonymous","textAlign","textColor","Tap","getNativeEvent","capture","releaseCapture","_handleIcon","getShow","_showChildControl","_excludeChildControl","SvgIcon","__P_35_0","_dataProvider","__P_35_1","getLastOpenedTag","tags","closingTags","tagPosition","lastIndexOf","tag","openedTag","contentSearch","currentAttribute","attrMatch","filteredElementSearch","isAttributeSearch","isContentSearch","findElements","maxDepth","currentDepth","inMeta","cache","isItemAvailable","itemName","maxOccurs","count","getElementString","indent","prefix","insertText","allowedAttributes","getOwnPropertyNames","attr","requiredElements","allowedContent","getAllowedContent","_text","_grouping","elemName","getAvailableElements","usedItems","availableItems","childElem","max","CompletionItemKind","Field","detail","documentation","getAvailableAttributes","usedChildTags","attrs","Property","triggerCharacters","provideCompletionItems","vmap","textUntilPosition","lineNumber","column","completeText","metaEndPos","textMeta","mappingNames","stylingNames","templates","templatesStart","rawTemplate","nameMatch","variables","vregex","lastOpenedTag","openedTags","openedAttributes","cleanedText","lastChild","lastElementChild","lastFound","searchedElement","getDesigns","sugg","suggestions","getTransforms","getPlugins","getIcons","getInfluxDBs","getInfluxDBFields","EnumMember","variableName","Variable","mappingName","stylingName","getNamedItem","getInfluxDBTags","getInfluxDBValues","getAddresses","getRrds","typeFilter","getMediaFiles","currentItem","Value","__filename","__P_44_0","__P_44_1","__P_44_2","_cacheXSD","__P_44_3","schemaFile","__P_44_4","__P_44_5","__P_44_6","_widgetNames","ajaxRequest","_parseXSD","getReferencedNode","refName","getTypeNode","typeNode","getTextNodeSchemaElement","tmpXML","getCommentNodeSchemaElement","getSchemaDOM","getWidgetNames","_disposeMap","TEMPLATES","getTemplates","filterText","insertTextRules","CompletionItemInsertTextRule","InsertAsSnippet","KeepWhitespace","Struct","Method","setTitle","setChanges","setChangeType","changeType","change","getElement","success","isDisposed","getChangeType","getChanges","moveTo","oldIndex","sortable","touch","__P_51_0","_applyDragging","menuButton","getMenu","_applySortable","_addWidgets","addClass","alignY","setShow","addLabel","_remove","buttons","_applyEditor","_maintainClipboardButtons","_applyElement","isChildAllowedAtPosition","Number","POSITIVE_INFINITY","__P_29_0","Form","labelColumnWidth","useBlocker","blockerOpacity","blockerColor","__P_37_0","__P_37_1","_rootListenerId","_applyFormData","firstWidget","inverse","_formController","removeAllBindings","_form","getValidationManager","_formContainer","modelData","_iterator","_createForOfIteratorHelper","_step","s","n","done","mappedKey","replaceAll","p1","toUpperCase","setQxObjectId","addOwnedQxObject","_onFormReady","atom","_iterator2","_step2","_loop","fieldData","formElement","addGroupHeader","TextArea","setMinimalLineHeight","setAutoSize","setMinHeight","maxLength","setMaxLength","SourceCodeField","language","DateField","dateFormat","setDateFormat","PasswordField","ComboBox","parseComboOptions","listItem","groupName","groupItem","setPlaceholder","VirtualComboBox","iconPath","labelPath","Option","getHints","parseVComboOptions","hints","groupModel","setType","SelectBox","VirtualSelectBox","iconOptions","orientation","radioButton","setTriState","Spinner","setMinimum","setMaximum","step","setSingleStep","fractionsDigits","fd","nf","NumberFormat","setMinimumFractionDigits","setMaximumFractionDigits","setNumberFormat","addTarget","selectables","getSelectables","selectable","setRequired","Validate","charAt","regExp","errorMessage","AsyncValidator","proxy","eval","invalidMessage","validationFunc","validatorObj","__P_37_2","isObject","func","view","ElementFormRenderer","getLayout","setColumnFlex","setColumnMaxWidth","getLabelColumnWidth","spacingX","setAllowGrowX","_handleOk","getCallback","getContext","resetCallback","setNode","setSchema","_bounds","_allowedElements","_sortedContent","_subGroupings","elementsHaveOrder","subGroupings","_regexCache","isElementAllowed","_Object$entries","entries","_Object$entries$_i","grouping","subRequiredElements","myAllowedElements","_i3","_Object$entries2","_Object$entries2$_i","sortNumber","getRegex","nocapture","hasMultiLevelBounds","getBoundsForElementName","regexFromString","input","modifiers","Base","__P_48_0","__P_48_1","__P_48_2","__P_48_3","__P_48_4","xpath","texts","doc","nsResolver","createNSResolver","iterator","evaluate","XPathResult","UNORDERED_NODE_ITERATOR_TYPE","thisNode","iterateNext","appInfo","_toConsumableArray","_type","getSchema","_documentation","_documentation2","createDocumentationWebLinks","contents","reference","DocumentationMapping","MAP","_base","MAnnotation","getElementName","aSortvalue","bSortvalue","aSortvaluesList","bSortvaluesList","defaultValue","mixed","__P_47_0","__P_47_1","__P_47_2","__P_47_3","setDefaultValue","setMixed","SimpleType","tmpDOMGrouping","Choice","Sequence","Any","sub","subElement","aGroup","attributeGroup","Attribute","getElementsHaveOrder","excludeComment","textOnly","isMixed","getChildBounds","isTextContentAllowed","regexString","boundsMin","boundsMax","getChildrenRegex","_node","initName","setSchemaElement","_maintainStatus","_initialAttributes","Map","deletable","showEditButton","_schemaElement","_initialChildNames","_initialTextContent","__P_45_0","__P_45_1","setStatus","_applyValid","resetInvalidMessage","newType","getText","oldNode","newTextNode","replaceChild","IconHandler","getIconSource","_updateShowEditButton","updateDeletable","setShowEditButton","existing","setDeletable","_existing","skipUndo","_move","targetParent","targetChildren","newParent","newIndex","stillAllowed","countExisting","childBounds","textNodes","otherNodes","previousSibling","findPositionForChild","newChild","internalOperation","previousChild","before","$$added","_validateTextContent","recursive","nodeValue","setInvalidMessage","_applyTextContent","_updateDisplayName","setText","changed","newValue","oldValue","setTextContent","removeAttribute","_oldValue","_changed","isRequired","parentChanges","newNode","_oldValue2","parentChange","_applySchemaElement","_applyModified","hasChildNodes","childNode","_syncChildNodes","childSchemaElement","_child","setSortable","_child2","_child3","getInvalidMessage","appendInvalidMessage","_updateChildrenDeletableFlags","errorMsg","initial","currentChildNames","_currentChildNames","_step$value","names","widgets","ids","c","cloneNode","__P_36_0","getDataProviderClient","address","#text","grouped","rrd","influx","measurement","live","plugin","pages","design","ga","_id$split","_id$split2","conf","_len","arguments","_key","_getFromCache","cacheId","__P_36_1","_addToCache","__P_36_2","designName","rpc","rpcContext","converterContext","cached","handleResponse","__P_36_3","getClient","authorize","client","hasProvider","getProviderUrl","getProviderConvertFunction","_parseDpResponseForEditor","_parseDpResponseForMonaco","__P_36_4","withMeasurement","auth","__P_36_5","x","__P_36_6","fsClient","useCache","transforms","Transform","registry","suggestion","lname","plugins","qxParts","PartLoader","getParts","partName","pluginName","icons","iconHandler","iconName","_content","_errors","highlight","colorizeElement","vbox","prologue","labelOptions","allowGrowX","errorBox","errorScroll","decorator","errorLabels","errorId","has","codeSnippet","startIndex","endIndex","minIndent","search","trimRight","headline","closeButton","proceedButton","openSourceButton","initOptions","grid","Grid","setColumnAlign","_originalName","_originalOptions","nameField","__P_40_0","__P_40_1","emptyOption","_onDeleteOption","resetKey","resetValue","removed","_onAddOption","row","setNullValueTitle","setAllowNull","OptionListItem","__P_54_0","__P_54_1","setAttributeNS","_createContentElement","svgElem","svg","__P_28_0","forceRatio","allowScaleUp","allowShrinkX","allowShrinkY","allowGrowY","loadingFailed","aborted","PLACEHOLDER_IMAGE","__P_28_1","__P_28_2","__P_28_3","__P_28_4","__P_28_5","__P_28_6","_onChangeTheme","_styleSource","__P_28_7","_getContentHint","_applyDecorator","getSource","AliasManager","getChild","__P_28_8","_applyTextColor","__P_28_9","setStyle","Color","removeStyle","_applyPadding","setStyles","getPaddingTop","renderLayout","getPaddingRight","getPaddingBottom","_applyEnabled","_applySource","abort","_applyScale","__P_28_10","isPng","getScale","__P_28_11","html","connectWidget","overflowX","overflowY","boxSizing","setScale","wrapper","$$disposed","__P_28_13","repeat","tagNameHint","Decoration","getTagName","contentEl","__P_28_14","isFontUri","__P_28_15","color","getTextColor","highResolutionSource","findHighResolutionSource","imageWidth","getImageWidth","imageHeight","getImageHeight","backgroundSize","__P_28_16","__P_28_17","__P_28_18","__P_28_12","AnimationFrame","rId","select","mshtml","alphaImageLoader","isFont","isSvg","__P_28_19","default","elementToAdd","currentContentElement","styles","currentStyles","getAllStyles","backgroundImage","insets","getInsets","getStyle","newEl","setSelectable","getSelectable","isIncluded","removeAt","getNodeName","currentEl","flush","currentDomEl","newDomEl","getListeners","listenerData","self","$$hash","getEnabled","disabled","Font","__P_28_20","_applyDimension","isFailed","__P_28_21","useMarkup","sparts","fontSource","fontStyles","getStyles","fromCharCode","charCode","getDecorator","hasGradient","getStartColor","getEndColor","hasBackground","getBackgroundImage","getAttributes","decoratorStyle","combinedStyles","backgroundPosition","backgroundRepeat","getBackgroundRepeat","imageInfo","failed","_recalc","queue","Layout","originalWidth","originalHeight","getMaxWidth","getMaxHeight","getMinWidth","minHeight","getMinHeight","ratio","getForceRatio","isAllowScaleUp","disconnectWidget","IStringForm","IForm","MForm","changeValue","__P_41_0","__P_41_1","_hasBeenEdited","_autoSize","isAutoSize","contentHeight","getLineCount","_setAreaHeight","_onContentChange","getFocusElement","setHints","setCenter","_onExecute","isTriState","toggleValue","_applyValue","FormRenderer","addItems","_createHeader","_row","colSpan","_createHBoxForRadioGroup","_createWidgetForRadioGroup","_createLabel","audio","break","colorchooser","designtoggle","diagram","flavour","gauge","imagetrigger","infoaction","infotrigger","install-no-pakets","mapping","multitrigger","pagejump","powerspectrum","pushbutton","rgb","slide","speech","strftime","styling","switch","system-voraussetzungen","toggle","urltrigger","video","visu-config-details","web","__P_49_0","__P_49_1","__P_49_2","__P_49_3","optional","baseType","setOptional","__P_49_4","setBaseType","subnode","subNode","_subnode","patternNode","enumerationNode","getBaseType","boolValid","branchIndices","isRootBranch","j","branches","elementRegexes","_Object$values","values","sortnumber","namesWithSorting","mySortnumber","subSortedElements","subObject","elementBounds","sequenceBounds","resultBounds","isNaN","tmpBounds","mySortNumber","getAttributeName","description","__P_46_0","__P_46_1","setKey","_applyChange","keyField","valueField","keyTitleField","valueTitleField","__P_39_0","Icon"],"mappings":"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","sourcesContent":["/**\n * All Widgets that need to handle actions from the managers action event, need to implement this interface.\n */\nqx.Interface.define('cv.ui.manager.IActionHandler', {\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * Checks if the action handle can process the action.\n     * @param actionName {String} action name\n     */\n    canHandleAction: function(actionName) {},\n\n    /**\n     * Executes the action handling.\n     * @param actionName {String} action name\n     * @param data {var} action payload\n     */\n    handleAction: function (actionName, data) {},\n\n    /**\n     * The ActionHandler can configure the menubutton itself, e.g. disable it, when that action is currently not possible\n     * or change the button text / tooltip text etc.\n     * @param actionId {String} ID of the action that button triggers\n     * @param button {Widget} the button that should be configured\n     */\n    configureButton: function (actionId, button) {},\n\n    /**\n     * Undo all changes that have been applied to the button in configureButton\n     * @param actionId {String} ID of the action that button triggers\n     * @param button {Widget}\n     */\n    unConfigureButton: function (actionId, button) {}\n  }\n});\n","/**\n * Mixin for all classes that have to handle event on the 'cv.manager.file' topic.\n * Those classes need to implement the cv.ui.manager.control.IFileEventHandler interface.\n */\nqx.Mixin.define('cv.ui.manager.control.MFileEventHandler', {\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    if (qx.core.Environment.get('qx.debug')) {\n      qx.core.Assert.assertInterface(this, cv.ui.manager.control.IFileEventHandler);\n    }\n    if (!this._disableFileEvents) {\n      qx.event.message.Bus.subscribe('cv.manager.file', this._handleFileEvent, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _disableFileEvents: false\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.file', this._handleFileEvent, this);\n  }\n});\n","/**\n *\n */\nqx.Interface.define('cv.ui.manager.control.IFileEventHandler', {\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _handleFileEvent: function (ev) {}\n  }\n});\n","/**\n * Main class of the CometVisu file manager.\n * @author Tobias Brutigam\n * @since 0.12.0\n *\n * @asset(manager/*)\n */\nqx.Class.define('cv.ui.manager.Main', {\n  extend: qx.core.Object,\n  type: 'singleton',\n  include: [\n    cv.ui.manager.control.MFileEventHandler\n  ],\n  implement: [cv.ui.manager.IActionHandler, cv.ui.manager.control.IFileEventHandler],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    iconfont.material.Load;\n    cv.ui.manager.model.BackupFolder.getInstance();\n    this._checkEnvironment();\n    this.initOpenFiles(new qx.data.Array());\n    this.__actionDispatcher = cv.ui.manager.control.ActionDispatcher.getInstance();\n    this.__actionDispatcher.setMain(this);\n\n    this.__initCommands();\n    this._draw();\n\n    qx.event.message.Bus.subscribe('cv.manager.*', this._onManagerEvent, this);\n\n    // Initialize tooltip manager\n    qx.ui.tooltip.Manager.getInstance();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    ROOT: null\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    openFiles: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    /**\n     * Current selected folder (if a file is selected its parent folder) is writeable.\n     */\n    writeableFolder: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeWriteableFolder'\n    },\n\n    currentFolder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyCurrentFolder',\n      event: 'changeCurrentFolder'\n    },\n\n    currentSelection: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyCurrentSelection',\n      event: 'changeCurrentSelection'\n    },\n\n    deleteableSelection: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDeleteableSelection'\n    },\n\n    renameableSelection: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeRenameableSelection'\n    },\n\n    visible: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeVisible',\n      apply: '_applyVisible'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __previewFileIndex: null,\n    __root: null,\n    _pane: null,\n    _tree: null,\n    _stack: null,\n    _oldCommandGroup: null,\n    _managerCommands: null,\n    _mainContent: null,\n    _openFilesController: null,\n    _hiddenConfigFakeFile: null,\n    __actionDispatcher: null,\n\n    _applyVisible: function (value) {\n      const manager = qx.core.Init.getApplication().getCommandManager();\n      if (value) {\n        manager.setActive(this._managerCommands);\n        qx.bom.element.Style.set(this.__getRoot(), 'display', 'block');\n      } else {\n        manager.setActive(this._oldCommandGroup);\n        qx.bom.element.Style.set(this.__getRoot(), 'display', 'none');\n      }\n    },\n\n    _checkEnvironment: function () {\n      cv.io.rest.Client.getFsClient().checkEnvironmentSync(function (err, res) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else if (res) {\n          res.forEach(function (env) {\n            let refreshActions = false;\n            switch (env.entity) {\n              case '.':\n                // config folder must be writeable\n                if ((env.state & 1) === 0) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder does not exists'));\n                } else if ((env.state & 2) === 0) {\n                  cv.ui.manager.model.FileItem.ROOT.setReadable(false);\n                  refreshActions = true;\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder is not readable'));\n                } else if ((env.state & 4) === 0) {\n                  cv.ui.manager.model.FileItem.ROOT.setWriteable(false);\n                  refreshActions = true;\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder is not writeable'));\n                }\n                if (refreshActions) {\n                  const widget = this.__actionDispatcher.getFocusedWidget();\n                  this.__actionDispatcher.resetFocusedWidget();\n                  this.__actionDispatcher.setFocusedWidget(widget);\n                }\n                break;\n\n              case 'backup':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('backup folder is not writeable'));\n                }\n                break;\n\n              case 'media':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('media folder is not writeable'));\n                }\n                break;\n\n              case 'hidden.php':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Hidden configuration file (hidden.php) not writeable'));\n                }\n                break;\n            }\n          }, this);\n        }\n      }, this);\n    },\n\n    canHandleAction: function (actionName) {\n      if (actionName === 'delete' && this.getCurrentSelection() && !this.getCurrentSelection().isWriteable()) {\n        // needs a writeable file\n        return false;\n      }\n      let actions = ['close', 'quit', 'about'];\n      const currentFolder = this.getCurrentFolder();\n      if (currentFolder.isWriteable()) {\n        actions.push('new-file');\n        actions.push('new-folder');\n        actions.push('delete');\n        actions.push('upload');\n        actions.push('clone');\n      }\n      if (cv.ui.manager.model.FileItem.ROOT.isWriteable()) {\n        actions.push('new-config-file');\n      }\n      return actions.includes(actionName);\n    },\n\n    handleAction: function (actionName, data) {\n      switch (actionName) {\n        case 'close':\n          if (!data) {\n            this.closeCurrentFile();\n          } else {\n            this.closeFile(data);\n          }\n          break;\n\n        case 'quit':\n          this.setVisible(false);\n          break;\n\n        case 'new-file':\n          this._onCreate('file', null, data);\n          break;\n\n        case 'new-config-file':\n          cv.io.rest.Client.getFsClient().readSync({path: '.templates/visu_config.xml'}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Cannot load config template'));\n            } else {\n              this._onCreate('config', res, cv.ui.manager.model.FileItem.ROOT);\n            }\n          }, this);\n          break;\n\n        case 'clone':\n          cv.io.rest.Client.getFsClient().readSync({path: data.file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Cannot load file content'));\n            } else if (data.file.isConfigFile()) {\n                // config files need to be cloned in the root folder\n                this._onCreate('config', res, cv.ui.manager.model.FileItem.ROOT);\n              } else {\n                this._onCreate('file', res);\n              }\n          }, this);\n          break;\n\n        case 'new-folder':\n          this._onCreate('dir', null, data);\n          break;\n\n        case 'delete':\n          this._onDelete(data);\n          break;\n\n        case 'upload':\n          // nothing to to, this is handled in another way\n          break;\n\n        case 'about':\n          this._showAbout();\n          break;\n\n        default:\n          this.warn(actionName + ' handling is not implemented yet!');\n          break;\n      }\n    },\n\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _handleFileEvent: function (ev) {\n      const data = ev.getData();\n      if (data.action === 'deleted') {\n        // check if file is currently opened and close it\n        const openFiles = this.getOpenFiles().copy();\n        openFiles.some(function (openFile) {\n          if (openFile.getFile().isRelated(data.path)) {\n            this.closeFile(openFile);\n          }\n          return false;\n        }, this);\n        if (this.getCurrentFolder() && this.getCurrentFolder().getFullPath() === data.path) {\n          this.resetCurrentFolder();\n        }\n      } else {\n        this.warn('unhandled file event', data.action);\n      }\n    },\n\n    __findConfigFile: function (name) {\n      let file = null;\n      let demoFolder = null;\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(child => {\n        if (child.getName() === 'demo') {\n          demoFolder = child;\n        } else if (child.getName() === name) {\n          file = child;\n          return true;\n        }\n        return false;\n      });\n      if (!file && demoFolder) {\n        // check demo configs\n        demoFolder.getChildren().some(child => {\n          if (child.getName() === name) {\n            file = child;\n            return true;\n          }\n          return false;\n        });\n      }\n      return file;\n    },\n\n    _onManagerEvent: function (ev) {\n      let data = ev.getData();\n      switch (ev.getName()) {\n        case 'cv.manager.compareFiles':\n          this.openFile(data, false);\n          break;\n\n        case 'cv.manager.openWith':\n          if (typeof data.file === 'string') {\n            // this can only by a file in the root dir (a config)\n            data.file = this.__findConfigFile(data.file);\n          }\n          this.openFile(data.file || this.getCurrentSelection(), false, data.handler, null, data.handlerOptions);\n          break;\n\n        case 'cv.manager.open':\n          if (typeof data === 'string') {\n            // this can only by a file in the root dir (a config)\n            data = this.__findConfigFile(data);\n          }\n          this.openFile(data || this.getCurrentSelection(), false);\n          break;\n      }\n    },\n\n    /**\n     * open selected file in preview mode\n     * @param ev\n     * @private\n     */\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if ((cv.ui.manager.model.Preferences.getInstance().isQuickPreview() && data.mode === 'tap') || data.mode === 'dbltap') {\n        this.__openSelectedFile(data.node, data.mode);\n      }\n      const node = data.node;\n      if (node) {\n        if (data.node.getType() === 'file') {\n          this.setCurrentFolder(data.node.getParent());\n        } else {\n          this.setCurrentFolder(node);\n        }\n        this.setCurrentSelection(node);\n      } else {\n        this.resetCurrentFolder();\n        this.resetCurrentSelection();\n      }\n    },\n\n    __openSelectedFile: function (node, mode) {\n      if (node) {\n        if (node.getType() === 'file') {\n          this.openFile(node, mode === 'tap');\n        } else if (mode === 'dbltap') {\n          // edit folder name on dbltap\n          node.setEditing(true);\n        }\n      }\n    },\n\n    _applyCurrentFolder: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('writeable', this, 'writeableFolder');\n      } else {\n        this.resetWriteableFolder();\n      }\n    },\n\n    _applyCurrentSelection: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('writeable', this, 'deleteableSelection');\n        value.bind('inTrash', this, 'renameableSelection', {\n          converter: function (value) {\n            return !value;\n          }\n        });\n      } else {\n        this.resetDeleteableSelection();\n      }\n    },\n\n    _onChangeFileSelection: function () {\n      const sel = this._openFilesController.getSelection();\n      if (sel.length > 0) {\n        const openFile = sel.getItem(0);\n        const file = openFile.getFile();\n        let editorConfig;\n        const handlerId = openFile.getHandlerId();\n        if (handlerId) {\n          editorConfig = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n        } else {\n          editorConfig = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n        }\n        if (!editorConfig.instance) {\n          editorConfig.instance = new editorConfig.Clazz();\n        }\n        if (!editorConfig.instance.isReady()) {\n          editorConfig.instance.addListenerOnce('changeReady', () => {\n            editorConfig.instance.setFile(file);\n          }, this);\n        } else {\n          editorConfig.instance.setFile(file);\n        }\n        if (this._stack.indexOf(editorConfig.instance) < 0) {\n          this._stack.add(editorConfig.instance);\n        }\n        if (editorConfig.instance instanceof cv.ui.manager.editor.AbstractEditor) {\n          editorConfig.instance.setHandlerOptions(openFile.getHandlerOptions());\n        }\n        this._stack.setSelection([editorConfig.instance]);\n        this.__actionDispatcher.setFocusedWidget(editorConfig.instance);\n\n        cv.ui.manager.core.GlobalState.getInstance().setOpenedFocusedFile(file);\n      } else {\n        cv.ui.manager.core.GlobalState.getInstance().resetOpenedFocusedFile();\n      }\n    },\n\n    /**\n     * @param file {cv.ui.manager.model.FileItem} the file to open\n     * @param preview {Boolean} open the file in preview mode\n     * @param handlerId {String} use this handler to open the file (classname as string)\n     * @param handlerType {String} use a special handler type, e.g. 'edit' if you want to open the file with an editor and not a viewer\n     * @param handlerOptions\n     */\n    openFile: function (file, preview, handlerId, handlerType, handlerOptions) {\n      const openFiles = this.getOpenFiles();\n      let openFile;\n      let handlerConf;\n      if (!handlerId) {\n        handlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, handlerType);\n\n        if (!handlerConf) {\n          // no handler\n          cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('Cannot open file: \"%1\"', file.getName()));\n          return;\n        } \n          handlerId = handlerConf.Clazz.classname;\n      } else {\n        // check if this handler opens the file in a external frame that is not connected to the manager\n        handlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n        if (!handlerConf.instance) {\n          handlerConf.instance = new handlerConf.Clazz();\n        }\n        if (handlerConf.instance.isExternal()) {\n          handlerConf.instance.setFile(file);\n          return;\n        }\n      }\n      const isOpen = openFiles.some(function (of) {\n        if (of.getFile() === file && handlerId === of.getHandlerId()) {\n          openFile = of;\n          return true;\n        }\n        return false;\n      });\n      if (!openFile) {\n        openFile = new cv.ui.manager.model.OpenFile(file, handlerId);\n      }\n      if (handlerOptions) {\n        openFile.setHandlerOptions(handlerOptions);\n      } else {\n        openFile.resetHandlerOptions();\n      }\n      if (preview === true) {\n        if (!openFile.isPermanent()) {\n          if (this.__previewFileIndex !== null && openFiles.getItem(this.__previewFileIndex) && !openFiles.getItem(this.__previewFileIndex).isPermanent()) {\n            openFiles.setItem(this.__previewFileIndex, openFile);\n          } else {\n            this.__previewFileIndex = openFiles.length;\n            openFiles.push(openFile);\n          }\n          // do not 'downgrade' the permanent state\n          openFile.setPermanent(false);\n        }\n      } else {\n        if (!isOpen && (this.__previewFileIndex === null || openFiles.indexOf(openFile) !== this.__previewFileIndex)) {\n          openFiles.push(openFile);\n        }\n        openFile.setPermanent(true);\n        this.__previewFileIndex = null;\n      }\n      this._openFilesController.getTarget().setModelSelection([openFile]);\n    },\n\n    closeFile: function (openFile, force) {\n      if (openFile instanceof cv.ui.manager.model.FileItem) {\n        // find the opened file\n        const found = this.getOpenFiles().some(function (f) {\n          if (f.getFile().getFullPath() === openFile.getFullPath()) {\n            openFile = f;\n            return true;\n          }\n          return false;\n        });\n        if (!found) {\n          return;\n        }\n      }\n      if (!openFile.isCloseable()) {\n        return;\n      }\n      const file = openFile.getFile();\n\n      // check if this file is modified\n      if (file.isModified() && !force) {\n        // check if temporary\n        let message = qx.locale.Manager.tr('This file has unsaved changes that will be lost when you close it. Do you really want to close the file?');\n        if (file.isTemporary()) {\n          message = qx.locale.Manager.tr('This file has not been saved on the backend yet. It will be lost when you close it. Do you really want to close the file?');\n        }\n        qxl.dialog.Dialog.confirm(message, function (confirmed) {\n          if (confirmed) {\n            file.resetModified();\n            this.closeFile(openFile, true);\n            if (file.isTemporary()) {\n              qx.event.message.Bus.dispatchByName('cv.manager.file', {\n                action: 'deleted',\n                path: file.getFullPath()\n              });\n            }\n          }\n        }, this, qx.locale.Manager.tr('Unsaved changes'));\n        return;\n      }\n      if (openFile instanceof cv.ui.manager.model.OpenFile) {\n        openFile.resetPermanent();\n      }\n      const currentSelection = this._openFilesController.getSelection();\n      let selectionIndex = -1;\n      const openFiles = this.getOpenFiles();\n      if (currentSelection.length > 0 && currentSelection.getItem(0) === openFile) {\n        // we need to select another file after this one got closed\n        selectionIndex = openFiles.indexOf(openFile);\n      }\n      openFiles.remove(openFile);\n      const currentHandler = this._stack.getSelection()[0];\n      if (qx.Class.hasInterface(currentHandler.constructor, cv.ui.manager.editor.IEditor)) {\n        // reset the handlers file\n        currentHandler.resetFile();\n      }\n      if (this.getOpenFiles().length === 0) {\n        this._stack.resetSelection();\n        this.__actionDispatcher.resetFocusedWidget();\n        this.__previewFileIndex = null;\n      }\n      if (selectionIndex > 0) {\n        this._openFilesController.getSelection().replace(openFiles.getItem(selectionIndex - 1));\n      } else if (selectionIndex === 0 && openFiles.length > 0) {\n        this._openFilesController.getSelection().replace(openFiles.getItem(0));\n      }\n\n      if (file instanceof cv.ui.manager.model.CompareFiles) {\n        const fileHandlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n        fileHandlerConf.instance.clear();\n        if (openFiles.filter(function (openFile) {\n          return openFile.getFile() instanceof cv.ui.manager.model.CompareFiles;\n        }).length === 0) {\n          fileHandlerConf.instance.destroy();\n          fileHandlerConf.instance = null;\n        }\n      } else if (window.monaco && openFile.getHandlerId() === 'cv.ui.manager.editor.Source') {\n        // close textmodel in monaco editor if exists\n        const oldModel = window.monaco.editor.getModel(file.getUri());\n        if (oldModel) {\n          oldModel.dispose();\n        }\n      }\n    },\n\n    closeCurrentFile: function () {\n      const selected = this._openFilesController.getSelection().length > 0 ? this._openFilesController.getSelection().getItem(0) : null;\n      if (selected) {\n        this.closeFile(selected);\n      }\n    },\n\n    _onCloseFile: function (ev) {\n      this.closeFile(ev.getData());\n    },\n\n    __getRoot: function () {\n      if (!this.__root) {\n        this.__root = qx.dom.Element.create('div', {\n          id: 'manager',\n          style: 'position: absolute; top: 0; left: 0; right: 0; bottom: 0;'\n        });\n        qx.dom.Element.insertEnd(this.__root, document.body);\n        qx.theme.manager.Meta.getInstance().setTheme(cv.theme.Dark);\n      }\n      return this.__root;\n    },\n\n    __initCommands: function () {\n      const group = this._managerCommands = new qx.ui.command.Group();\n      group.add('save', new qx.ui.command.Command('Ctrl+S'));\n      group.add('save-as', new qx.ui.command.Command('Ctrl+Shift+S'));\n      // this command will close the browser window, thats not what we want\n      // group.add('close', new qx.ui.command.Command('Ctrl+W'));\n      group.add('new-file', new qx.ui.command.Command('Ctrl+N'));\n      group.add('new-folder', new qx.ui.command.Command('Ctrl+Shift+N'));\n      group.add('quit', new qx.ui.command.Command('Ctrl+Q'));\n      // group.add('delete', new qx.ui.command.Command('Ctrl+Del'));\n\n      const renameCommand = new qx.ui.command.Command('F2');\n      group.add('rename', renameCommand);\n      this.bind('renameableSelection', renameCommand, 'enabled');\n\n      group.add('undo', new qx.ui.command.Command('Ctrl+Z'));\n      group.add('redo', new qx.ui.command.Command('Ctrl+Y'));\n\n      // edit commands (adding cut/copy/paste command will deactivate the native browser functions)\n      // and as we cannot simulate pasting from clipboard, we do not use them here\n      group.add('cut', new qx.ui.command.Command('Ctrl+X'));\n      group.add('copy', new qx.ui.command.Command('Ctrl+C'));\n      group.add('paste', new qx.ui.command.Command('Ctrl+V'));\n\n      group.add('help', new qx.ui.command.Command('F1'));\n\n      const manager = qx.core.Init.getApplication().getCommandManager();\n      this._oldCommandGroup = manager.getActive();\n      manager.add(group);\n      manager.setActive(group);\n    },\n\n    _onDelete: function (file) {\n      const item = file || this.getCurrentSelection();\n      if (item) {\n        cv.ui.manager.control.FileController.getInstance().delete(item);\n      }\n    },\n\n    _onChangeStackSelection: function (ev) {\n      const selection = ev.getData();\n      const openFiles = [];\n      // sync tab selection with currently visible page\n      selection.forEach(function(page) {\n        const openFile = this.getOpenFiles().toArray().find(function (openFile) {\n          return openFile.getFile() === page.getFile() && openFile.getHandlerId() === page.classname;\n        });\n        if (openFile) {\n          openFiles.push(openFile);\n        }\n      }, this);\n\n      this._openFilesController.getSelection().replace(openFiles);\n    },\n\n    __getFileNamePrompt: function (message, callback, context, value, caption) {\n      const prompt = new cv.ui.manager.dialog.Prompt({\n        message: message,\n        callback: callback || null,\n        context: context || null,\n        value: value || null,\n        caption: caption || '',\n        filter: /[\\w\\d_\\-\\.\\s]/\n      });\n      prompt.show();\n      return prompt;\n    },\n\n    _onCreate: function (type, content, folder) {\n      const currentFolder = folder || this.getCurrentFolder();\n      if (!currentFolder) {\n        return;\n      }\n      let message;\n      let existsMessage;\n      if (type === 'config') {\n        message = qx.locale.Manager.tr('Please enter the name of the new configuration (without \"visu_config_\" at the beginning and \".xml\" at the end)');\n        existsMessage = qx.locale.Manager.tr('A configuration with this name already exists.');\n      } else if (type === 'file') {\n        message = qx.locale.Manager.tr('Please enter the file name.');\n        existsMessage = qx.locale.Manager.tr('A file with this name already exists.');\n      } else {\n        message = qx.locale.Manager.tr('Please enter the folder name.');\n        existsMessage = qx.locale.Manager.tr('A folder with this name already exists.');\n      }\n      const handlePrompt = function (name) {\n        if (!name) {\n          // canceled\n          return;\n        }\n        let filename = name;\n        // add visu_config_..-xml\n        if (type === 'config') {\n          const match = /visu[_-]config[_-]([\\w\\d_-]+)(\\.xml)?/.exec(name);\n          if (match) {\n            name = match[1];\n          }\n          filename = 'visu_config_' + name + '.xml';\n        }\n        // check if name does not exist\n        const exists = currentFolder.getChildren().some(function (child) {\n          return (child.getName() === filename && child.getType() === type);\n        }, this);\n\n        if (exists) {\n          cv.ui.manager.snackbar.Controller.error(existsMessage);\n          this.__getFileNamePrompt(message, handlePrompt, this, name);\n        } else {\n          const item = new cv.ui.manager.model.FileItem(filename, currentFolder.getFullPath(), currentFolder);\n          item.set({\n            type: type === 'config' ? 'file' : type,\n            readable: true,\n            writeable: true,\n            loaded: true,\n            modified: true,\n            temporary: true,\n            parentFolder: currentFolder.getFullPath(),\n            content: content || ''\n          });\n          if (type === 'dir') {\n            // create directory directly\n            cv.io.rest.Client.getFsClient().createSync({\n              path: item.getFullPath(),\n              type: type\n            }, null, function (err) {\n              if (err) {\n                cv.ui.manager.snackbar.Controller.error(err);\n              } else {\n                cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('Folder has been created'));\n                item.set({\n                  modified: false,\n                  temporary: false\n                });\n                qx.event.message.Bus.dispatchByName(item.getBusTopic(), {\n                  type: 'created',\n                  file: item,\n                  data: '',\n                  source: this\n                });\n              }\n            }, this);\n          }\n          currentFolder.addChild(item);\n          currentFolder.sortElements();\n          this._tree.refresh();\n          this._tree.setSelection(item);\n          // do not open new folders\n          if (type !== 'dir') {\n            // open the file in an editor\n            this.openFile(item, false, null, 'edit');\n          }\n        }\n      };\n\n      this.__getFileNamePrompt(message, handlePrompt, this);\n    },\n\n    /**\n     * Finds next droppable parent of the given element. Maybe the element itself as well.\n     *\n     * Looks for the attribute <code>qxDroppable</code> with the value <code>on</code>.\n     *\n     * @param elem {Element} The element to query\n     * @return {Element} The next parent element which is droppable. May also be <code>null</code>\n     */\n    __findDroppable : function (elem) {\n      while (elem && elem.nodeType === 1) {\n        if (elem.getAttribute('qxDroppable') === 'on') {\n          return elem;\n        }\n\n        elem = elem.parentNode;\n      }\n\n      return null;\n    },\n\n    // overridden\n    _draw: function () {\n      const domRoot = this.__getRoot();\n      const root = new qx.ui.root.Inline(domRoot, true, true);\n      this.bind('visible', root, 'visibility', {\n        converter: function (visible) {\n          return visible ? 'visible' : 'excluded';\n        }\n      });\n      root.addListenerOnce('appear', function () {\n        // disable file drop\n        const element = root.getContentElement().getDomElement();\n        element.addEventListener('drop', function (ev) {\n          const target = this.__findDroppable(ev.target);\n          if (!target) {\n            ev.preventDefault();\n          }\n        }.bind(this));\n        element.addEventListener('dragover', function (ev) {\n          const target = this.__findDroppable(ev.target);\n          if (!target) {\n            ev.preventDefault();\n          }\n        }.bind(this));\n      }, this);\n      qx.core.Init.getApplication().setRoot(root);\n      root.setLayout(new qx.ui.layout.Canvas());\n\n      const snackbar = cv.ui.manager.snackbar.Controller.getInstance();\n      root.add(snackbar, {\n        bottom: 10,\n        left: 200\n      });\n\n      /**\n       *\n       */\n      function resize() {\n        const bounds = root.getBounds();\n        snackbar.setLayoutProperties({\n          bottom: 10,\n          left: Math.round(bounds.width / 2) - 150\n        });\n        snackbar.setMaxHeight(bounds.height - 40);\n      }\n      root.addListener('resize', resize, this);\n      root.addListener('appear', resize, this);\n      window.addEventListener('resize', function () {\n        // sync window height with manager height\n        domRoot.style.height = window.innerHeight + 'px';\n      });\n\n      const main = new qx.ui.container.Composite(new qx.ui.layout.Dock());\n      root.add(main, {edge: 0});\n      // menu on top\n      const menuBar = cv.ui.manager.MenuBar.getInstance();\n      main.add(menuBar, {edge: 'north'});\n\n      const uploadButton = menuBar.getButton('upload');\n      const uploadManager = new cv.ui.manager.upload.UploadMgr(uploadButton);\n      this.bind('currentFolder', uploadManager, 'folder');\n\n      this._pane = new qx.ui.splitpane.Pane();\n      main.add(this._pane, {edge: 'center'});\n\n      const rootFolder = cv.ui.manager.model.FileItem.ROOT = new cv.ui.manager.model.FileItem('.');\n      const fakeIconFile = cv.ui.manager.model.FileItem.getIconFile();\n      // TODO: needs to be verified by the backend\n      rootFolder.set({\n        overrideIcon: true,\n        writeable: true,\n        readable: true,\n        open: true,\n        fakeChildren: [fakeIconFile],\n        icon: cv.theme.dark.Images.getIcon('home', 18)\n      });\n      this.setCurrentFolder(rootFolder);\n      this._tree = new cv.ui.manager.tree.FileSystem(rootFolder);\n      this._tree.addListener('changeSelection', this._onChangeTreeSelection, this);\n\n      // left container\n      const leftContainer = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n\n      // left toolbar\n      const leftBar = new cv.ui.manager.ToolBar(uploadManager);\n      this.bind('currentFolder', leftBar, 'folder');\n      this.bind('currentSelection', leftBar, 'file');\n      leftBar.addListener('reload', this._tree.reload, this._tree);\n\n      // globally bind writeable folder to command for new files\n      const buttonConfig = menuBar.getButtonConfiguration();\n      this.bind('writeableFolder', buttonConfig['new-file'].args[2], 'enabled');\n      this.bind('writeableFolder', buttonConfig['new-folder'].args[2], 'enabled');\n      // this.bind('deleteableSelection', buttonConfig['delete'].args[2], 'enabled');\n\n      leftContainer.add(leftBar);\n      leftContainer.add(this._tree, {flex: 1});\n      this._pane.add(leftContainer, 0);\n      cv.ui.manager.model.Preferences.getInstance().bind('expertMode', leftContainer, 'visibility', {\n        converter: function (value) {\n          return value ? 'visible' : 'excluded';\n        }\n      });\n\n      this._mainContent = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n\n      // tab list\n      const list = new qx.ui.form.List(true);\n      list.setAppearance('open-files-tabs');\n      this._openFilesController = new qx.data.controller.List(this.getOpenFiles(), list, 'file.name');\n      this._openFilesController.setDelegate({\n        createItem: function () {\n          const item = new cv.ui.manager.form.FileTabItem();\n          item.addListener('close', this._onCloseFile, this);\n          return item;\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindDefaultProperties(item, index);\n          controller.bindProperty('file.permanent', 'permanent', null, item, index);\n          controller.bindProperty('file.modified', 'modified', null, item, index);\n          controller.bindProperty('icon', 'icon', null, item, index);\n          controller.bindProperty('closeable', 'closeable', null, item, index);\n        }\n      });\n      list.addListener('changeSelection', this._onChangeFileSelection, this);\n      this._mainContent.add(list);\n\n      this._stack = new qx.ui.container.Stack();\n      this._stack.addListener('changeSelection', this._onChangeStackSelection, this);\n      this._mainContent.add(this._stack, {flex: 1});\n      this._pane.add(this._mainContent, 1);\n\n      const startOpenFile = new cv.ui.manager.model.OpenFile(rootFolder, 'cv.ui.manager.Start');\n      startOpenFile.setCloseable(false);\n      this.getOpenFiles().push(startOpenFile);\n      list.setModelSelection([startOpenFile]);\n    },\n\n    _showAbout: function () {\n      const dialogConf = {\n        caption: qx.locale.Manager.tr('About'),\n        modal: true,\n        minWidth: Math.min(500, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: `\n<div class=\"about-cv\">\n <img src=\"resource/icons/comet_icon_128x128_ff8000.png\" width=\"128\" height=\"128\"/>\n <h2>CometVisu ${cv.Version.VERSION}</h2>\n <div class=\"info\">\n   <label for=\"date\">${qx.locale.Manager.tr('Build date')}: </label><span id=\"date\">${cv.Version.DATE}</span><br/>\n   <label for=\"build\">${qx.locale.Manager.tr('Build revision')}: </label><span id=\"build\">${cv.Version.REV}</span><br/>\n   <label for=\"lib-version\">${qx.locale.Manager.tr('Library version')}: </label><span id=\"lib-version\">${cv.Version.LIBRARY_VERSION}</span>\n </div>\n</div>`};\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects(\n      '_pane', '_tree', '_stack', '_mainContent', '_openFilesController'\n    );\n    // restore former command group\n    const application = qx.core.Init.getApplication();\n    const manager = application.getCommandManager();\n    manager.setActive(this._oldCommandGroup);\n    this._oldCommandGroup = null;\n\n    // defer the reset to let the dispose queue to be emptied before removing the root\n    new qx.util.DeferredCall(function () {\n      application.resetRoot();\n    }).schedule();\n\n    document.body.removeChild(this.__root);\n    this.__root = null;\n    this.__actionDispatcher = null;\n\n    qx.event.message.Bus.unsubscribe('cv.manager.*', this._onManagerEvent, this);\n\n    // destroy the singleton instance\n    delete cv.ui.manager.Main.$$instance;\n  }\n});\n","/**\n * Represents an entry in the filesystem (file or folder).\n */\nqx.Class.define('cv.ui.manager.model.FileItem', {\n  extend: qx.core.Object,\n  include: [\n    qx.data.marshal.MEventBubbling,\n    cv.ui.manager.control.MFileEventHandler\n  ],\n  implement: [cv.ui.manager.control.IFileEventHandler],\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name, path, parent, fakeChildren) {\n    this.base(arguments);\n    this.initChildren(new qx.data.Array());\n    if (fakeChildren) {\n      this.setFakeChildren(fakeChildren);\n    }\n    if (path) {\n      if (!path.endsWith('/')) {\n        path += '/';\n      }\n      this.__path = path;\n    }\n    if (name) {\n      this.setName(name);\n    }\n    if (parent) {\n      this.setParent(parent);\n    }\n    if (qx.core.Environment.get('qx.dynlocale')) {\n      qx.locale.Manager.getInstance().addListener('changeLocale', this._onChangeLocale, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    ROOT: null,\n    _fakeIconFile: null,\n    _hiddenConfigFakeFile: null,\n    _acceptedFiles: {\n      '.': '*.xml',\n      'media': '*.js,*.jpg,*.gif,*.png,*.conf,*.svg,*.md,*.rst,*,css,*.txt'\n    },\n\n    isConfigFile: function (path) {\n      return /visu_config.*\\.xml/.test(path);\n    },\n\n    getConfigName: function (filename) {\n      const match = /visu_config_?([^.]+)\\.xml/.exec(filename);\n      if (match) {\n        return match[1];\n      }\n      return null;\n    },\n\n    getIconFile: function () {\n      if (!this._fakeIconFile) {\n        this._fakeIconFile = new cv.ui.manager.model.FileItem('CometVisu-Icons', '', cv.ui.manager.model.FileItem.ROOT).set({\n          type: 'file',\n          overrideIcon: true,\n          writeable: false,\n          readable: true,\n          open: true,\n          loaded: true,\n          hasChildren: false,\n          fake: true,\n          icon: cv.theme.dark.Images.getIcon('icons', 18)\n        });\n      }\n      return this._fakeIconFile;\n    },\n\n    getHiddenConfigFile: function () {\n      if (!this._hiddenConfigFakeFile) {\n        this._hiddenConfigFakeFile = new cv.ui.manager.model.FileItem('hidden.php', '', cv.ui.manager.model.FileItem.ROOT).set({\n          hasChildren: false,\n          loaded: true,\n          readable: true,\n          writeable: true,\n          overrideIcon: true,\n          icon: cv.theme.dark.Images.getIcon('hidden-config', 15),\n          type: 'file',\n          fake: true,\n          displayName: qx.locale.Manager.tr('Hidden configuration')\n        });\n      }\n      return this._hiddenConfigFakeFile;\n    },\n\n    getAcceptedFiles: function (folder) {\n      return this._acceptedFiles[folder.getFullPath()];\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    open : {\n      check : 'Boolean',\n      event : 'changeOpen',\n      apply : '_onOpen',\n      init : false\n    },\n\n    loaded : {\n      check : 'Boolean',\n      event : 'changeLoaded',\n      init : false\n    },\n\n    loading : {\n      check : 'Boolean',\n      event : 'changeLoading',\n      init : false\n    },\n\n    parent : {\n      event : 'changeParent',\n      init : null\n    },\n\n    children : {\n      check : 'qx.data.Array',\n      event : 'changeChildren',\n      apply: '_applyEventPropagation',\n      deferredInit : true\n    },\n\n    fakeChildren: {\n      check: 'Array',\n      nullable: true\n    },\n\n    displayName: {\n      check: 'String',\n      init: '',\n      event: 'changeDisplayName'\n    },\n\n    /**\n     * Fake items only exist in the client not in the backend\n     */\n    fake: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeFake'\n    },\n\n    overrideIcon: {\n      check: 'Boolean',\n      init: false\n    },\n\n    icon: {\n      check: 'String',\n      nullable: true,\n      event: 'changeIcon'\n    },\n\n    hash: {\n      check: 'Number',\n      nullable: true\n    },\n\n    editing: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeEditing'\n    },\n\n    /**\n     * A special configuration option for mulitple purposes, e.g. creating a fake FileItem with a special\n     * behaviour like an \"Add new File\" used in writeable Folders.\n     */\n    special: {\n      check: 'String',\n      nullable: true,\n      event: 'changeSpecial'\n    },\n\n    /**\n     * Temporary file are not save in the backend yet\n     */\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTemporary'\n    },\n\n    /**\n     * Validation result for this files content (e.g. config file validation)\n     */\n    valid: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeValid'\n    },\n\n    /**\n     * The validation of this files content found some warnings\n     */\n    hasWarnings: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeHasWarnings'\n    },\n\n    /**\n     * Temporary content to show, e.g. for new files, when there is no 'real' file with content yet to request from the backend\n     * this content should be shown\n     */\n    content: {\n      check: 'String',\n      nullable: true\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    },\n\n    // Backend properties\n\n    hasChildren : {\n      check : 'Boolean',\n      event : 'changeHasChildren',\n      apply : '_applyHasChildren',\n      init : false\n    },\n\n    name : {\n      check : 'String',\n      event : 'changeName',\n      init : '',\n      apply: '_applyName'\n    },\n\n    type: {\n      check: ['dir', 'file'],\n      transform: '_toLowerCase',\n      nullable: true,\n      apply: '_maintainIcon'\n    },\n\n    parentFolder: {\n      check: 'String',\n      nullable: true\n    },\n\n    readable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadable'\n    },\n\n    writeable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeWriteable'\n    },\n\n    mounted: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeMounted'\n    },\n\n    trash: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTrash'\n    },\n\n    inTrash: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeInTrash'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __path: null,\n    __fullPath: null,\n    __onLoadCallback: null,\n\n    _toLowerCase: function (name) {\n      return name.toLowerCase();\n    },\n\n    isRelated: function (path) {\n      return this.getFullPath() === path;\n    },\n\n    _handleFileEvent: function (ev) {\n      if (this.isFake()) {\n        return;\n      }\n      const data = ev.getData();\n      switch (data.action) {\n        case 'moved':\n          this.reload();\n          break;\n\n        case 'added':\n          if (this.getType() === 'dir' && data.path.startsWith(this.getFullPath())) {\n            this.reload();\n          }\n          break;\n\n        case 'deleted':\n          if (data.path === this.getFullPath()) {\n            // this item has been deleted\n            this.dispose();\n          } else if (this.getType() === 'dir' && data.path.startsWith(this.getFullPath())) {\n            // delete child\n            const children = this.getChildren();\n            children.some(function (child) {\n              if (child.getFullPath() === data.path) {\n                children.remove(child);\n                this.removeRelatedBindings(child);\n                return true;\n              }\n              return false;\n            }, this);\n          }\n          break;\n      }\n    },\n\n    _applyName: function (value, old) {\n      this.__fullPath = null;\n      if (value && (this.getDisplayName() === null || this.getDisplayName() === old)) {\n        // use name as default display name\n        this.setDisplayName(value);\n      }\n    },\n\n    getPath: function () {\n      if (!this.__path) {\n        let parentFolder = this.getParentFolder();\n        if (!parentFolder) {\n          parentFolder = '';\n        } else if (!parentFolder.endsWith('/')) {\n          parentFolder += '/';\n        }\n        this.__path = parentFolder;\n      }\n      return this.__path;\n    },\n\n    _onOpen : function(value) {\n      if (!this.isLoaded() && value) {\n        this.load();\n      }\n      this._maintainIcon();\n    },\n\n    _maintainIcon: function () {\n      if (!this.isOverrideIcon()) {\n        if (this.getType() === 'file') {\n          this.setIcon(cv.theme.dark.Images.getIcon('file', 18));\n        } else if (this.isTrash()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('trash', 18));\n        } else if (this.isOpen()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('folder-open', 18));\n        } else if (this.isMounted()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('mounted-folder', 18));\n        } else {\n          this.setIcon(cv.theme.dark.Images.getIcon('folder', 18));\n        }\n      }\n    },\n\n    isConfigFile: function () {\n      return cv.ui.manager.model.FileItem.isConfigFile(this.getName());\n    },\n\n    _applyHasChildren: function (value) {\n      if (value === true && this.getChildren().length === 0) {\n        // add dummy child\n        this.getChildren().push(new cv.ui.manager.model.FileItem(''));\n      }\n    },\n\n    unload: function() {\n      this.setLoaded(false);\n      this.setLoading(false);\n      this.getChildren().removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n    },\n\n    reload : function(callback, context) {\n      this.unload();\n      return this.load(callback, context);\n    },\n\n    addChild: function (child) {\n      const oldParent = child.getParent();\n      if (oldParent !== this) {\n        oldParent.getChildren().remove(child);\n        oldParent.removeRelatedBindings(child);\n      }\n      child.setParent(this);\n      if (child.getType() !== 'dir' || !child.isMounted()) {\n        // inherit the mounted state from the parent folder\n        this.bind('mounted', child, 'mounted');\n      }\n      this.getChildren().push(child);\n    },\n\n    _onGet: function (data) {\n      const children = this.getChildren();\n      children.removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n      if (data) {\n        data.forEach(function (node) {\n          const child = new cv.ui.manager.model.FileItem(null, null, this);\n          if (Object.prototype.hasOwnProperty.call(node, 'children')) {\n            const nodeChildren = node.children;\n            delete node.children;\n            if (nodeChildren.length > 0) {\n              child.getChildren().replace(nodeChildren);\n              child.setLoaded(true);\n            }\n          }\n          child.set(node);\n          children.push(child);\n        }, this);\n      }\n      if (this.getFakeChildren()) {\n        children.append(this.getFakeChildren());\n      }\n      this.sortElements();\n\n      this.setLoaded(true);\n      if (this.__onLoadCallback) {\n        this.__onLoadCallback();\n      }\n      this.setLoading(false);\n    },\n\n    _onError: function (err) {\n      this.error(err);\n      cv.ui.manager.snackbar.Controller.error(err);\n      this.getChildren().removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n      this.setLoaded(true);\n      if (this.__onLoadCallback) {\n        this.__onLoadCallback();\n      }\n      this.setLoading(false);\n    },\n\n    load: function(callback, context) {\n      // If currently loading, delay ready\n      if (this.getType() === 'file') {\n        // nothing to load\n        this.setLoaded(true);\n        return;\n      } else if (this.isFake()) {\n        this.setLoaded(true);\n        if (this.getFakeChildren()) {\n          this.getChildren().append(this.getFakeChildren());\n        }\n        return;\n      }\n      if (this.isLoading()) {\n        if (callback) {\n          this.addListenerOnce('changeLoading', callback, context);\n        }\n      } else if (this.isLoaded()) {\n        // If not done yet, resolve the child elements of this container\n        if (callback) {\n          callback.apply(context);\n        }\n      } else {\n        this.setLoading(true);\n        if (callback) {\n          this.__onLoadCallback = callback.bind(context || this);\n        }\n        cv.io.rest.Client.getFsClient().readSync({path: this.getFullPath()}, function (err, res) {\n          if (err) {\n            this._onError(err);\n          } else {\n            this._onGet(res);\n          }\n        }, this);\n      }\n    },\n\n    /**\n     * Returns the complete path needed for the REST API  to identify this file\n     * @returns {null}\n     */\n    getFullPath: function () {\n      if (!this.__fullPath) {\n        this.__fullPath = this.getPath() + this.getName();\n      }\n      return this.__fullPath;\n    },\n\n    getBusTopic: function () {\n      return 'cv.manager.fs.' + this.getFullPath().replace(/\\//g, '.');\n    },\n\n    /**\n     * Returns a fake URI that can be used to identify the file.\n     * Used by monaco editor as model URI.\n     * @returns {Uri}\n     */\n    getUri: function () {\n      return 'cv://' + this.getFullPath();\n    },\n\n    /**\n     * Returns the path to this file for requests over HTTP (not the REST API)\n     *\n     * Note: Please be aware that this path does not work if the file is in a mounted folder\n     * like the demo configs. The backend handles those mounts transparently to the client. But\n     * because of that the client does not know the real path to the file.\n     *\n     * @returns {string}\n     */\n    getServerPath: function () {\n      if (!this.isMounted()) {\n        return qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/config/' + this.getFullPath();\n      }\n      return qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/' + this.getFullPath();\n    },\n\n    /**\n     *  Sort entries: folders first, files then\n     */\n    sortElements: function () {\n      const sortF = function (a, b) {\n        if (a.getType() === 'dir') {\n          if (b.getType() === 'dir') {\n            if (a.isTrash()) {\n              return 1;\n            } else if (b.isTrash()) {\n              return -1;\n            }\n            return a.getName().localeCompare(b.getName());\n          }\n          return -1;\n        } else if (b.getType() === 'dir') {\n          return 1;\n        }\n        return a.getName().localeCompare(b.getName());\n      };\n      this.getChildren().sort(sortF);\n    },\n\n    openPath: function (path) {\n      const parts = qx.lang.Type.isArray(path) ? path : path.split('/');\n      const relPath = parts.shift();\n      this.getChildren().some(function (child) {\n        if (child.getName() === relPath) {\n          child.load(function () {\n            child.setOpen(true);\n            if (parts.length > 0) {\n              child.openPath(parts);\n            }\n          }, this);\n          return true;\n        }\n        return false;\n      }, this);\n    },\n\n    _onChangeLocale : qx.core.Environment.select('qx.dynlocale', {\n      'true': function () {\n        const content = this.getDisplayName();\n        if (content && content.translate) {\n          this.setDisplayName(content.translate());\n        }\n      },\n\n      'false' : null\n    })\n  },\n  \n  /*\n  ***********************************************\n    DESTRUCTOR  \n  ***********************************************\n  */\n  destruct: function () {\n    this.__fullPath = null;\n  } \n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.BackupFolder', {\n  extend: cv.ui.manager.model.FileItem,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments, 'backup');\n    this.load();\n    qx.event.message.Bus.subscribe('cv.manager.fs.*', this._onFilesSystemMessage, this);\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _onFilesSystemMessage: function (ev) {\n      if (/^cv\\.manager\\.fs\\.visu_config.*\\.xml$/.test(ev.getName())) {\n        // Fs event on config file\n        const data = ev.getData();\n        if (['contentChanged', 'fsContentChanged'].includes(data.type)) {\n          // config file has been changed or restored, refresh the backups\n          this.reload();\n        }\n      }\n    },\n\n    /**\n     * Returns the list of existing backup files for the given file.\n     * @param file {cv.ui.manager.model.FileItem}\n     */\n    getBackupFiles: function (file) {\n      const files = [];\n      if (file.getType() === 'file') {\n        const pathparts = file.getFullPath().split('/');\n        pathparts.pop();\n        const path = pathparts.join('\\/');\n        const parts = file.getName().split('.');\n        const suffix = parts.pop();\n        const filename = parts.join('.');\n        const fileRegex = new RegExp(path + filename + '-([\\\\d]{14})\\\\.' + suffix);\n        this.getChildren().forEach(function (backupFile) {\n          const match = fileRegex.exec(backupFile.getFullPath().replace('backup/', ''));\n          if (match) {\n            files.push({\n              date: new Date(\n                parseInt(match[1].substring(0, 4)),\n                parseInt(match[1].substring(4, 6))-1,\n                parseInt(match[1].substring(6, 8)),\n                parseInt(match[1].substring(8, 10)),\n                parseInt(match[1].substring(10, 12)),\n                parseInt(match[1].substring(12, 14))\n              ),\n              file: backupFile\n            });\n          }\n        }, this);\n      }\n      return files;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.fs.*', this._onFilesSystemMessage, this);\n  }\n});\n","/**\n * The ActionDispatcher listens to the events in the 'cv.manager.action' topic and\n * dispatched those events to the currently relevant handler (e.g. the save event to the opened editor).\n */\nqx.Class.define('cv.ui.manager.control.ActionDispatcher', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    qx.event.message.Bus.subscribe('cv.manager.action.*', this._onAction, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    focusedWidget: {\n      check: 'cv.ui.manager.IActionHandler',\n      nullable: true,\n      apply: '_applyFocusedWidget'\n    },\n\n    main: {\n      check: 'cv.ui.manager.Main',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    updateBarButtons: function () {\n      const actionHandler = this.getFocusedWidget();\n      const menuBar = cv.ui.manager.MenuBar.getInstance();\n      const config = menuBar.getButtonConfiguration();\n      let button;\n      Object.keys(config).forEach(function (actionId) {\n        button = menuBar.getButton(actionId);\n        if (button) {\n          button.setEnabled(config[actionId].general || this.hasHandler(actionId));\n          if (actionHandler) {\n            actionHandler.configureButton(actionId, button);\n          }\n        }\n      }, this);\n    },\n\n    _applyFocusedWidget: function (value, old) {\n      if (old) {\n        const menuBar = cv.ui.manager.MenuBar.getInstance();\n        const config = menuBar.getButtonConfiguration();\n        let button;\n        Object.keys(config).forEach(function (actionId) {\n          button = menuBar.getButton(actionId);\n          if (button) {\n            old.unConfigureButton(actionId, button);\n          }\n        }, this);\n      }\n      this.updateBarButtons();\n    },\n\n    /**\n     * Check if there is an existing handler for the given actionName.\n     * @param actionName\n     * @return {Boolean}\n     */\n    hasHandler: function (actionName) {\n      return !!this._getHandler(actionName);\n    },\n\n    _getHandler: function (actionName) {\n      const handler = this.getFocusedWidget();\n      const main = this.getMain();\n      if (handler && handler.canHandleAction(actionName)) {\n        return handler;\n      } else if (main && main.canHandleAction(actionName)) {\n        return main;\n      }\n      return null;\n    },\n\n    _onAction: function (ev) {\n      const topic = ev.getName();\n      const actionName = topic.split('.').pop();\n      const handler = this._getHandler(actionName);\n      if (handler) {\n        handler.handleAction(actionName, ev.getData());\n      } else {\n        this.warn('no action handler found for action: ' + actionName);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.subscribe('cv.manager.action.*', this._onAction, this);\n  }\n});\n","/**\n * Main view component responsible for showing a list of snackbar messages.\n */\nqx.Class.define('cv.ui.manager.snackbar.Controller', {\n  extend: qx.ui.core.Widget,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.VBox(8));\n    this.initMessages(new qx.data.Array());\n    qx.event.message.Bus.subscribe('cv.manager.msg.snackbar', this._onMessage, this);\n    this._listController = new qx.data.controller.List(this.getMessages(), this.getChildControl('list'));\n    this._initDelegate();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    info: function (message) {\n      const msg = new cv.ui.manager.model.Message();\n      msg.set({\n        title: message\n      });\n      qx.event.message.Bus.dispatchByName('cv.manager.msg.snackbar', msg);\n    },\n\n    error: function (message) {\n      const msg = new cv.ui.manager.model.Message();\n      if (typeof message === 'object' && Object.prototype.hasOwnProperty.call(message, 'statusText')) {\n        message = message.statusText;\n      }\n      msg.set({\n        title: message,\n        type: 'error',\n        sticky: true\n      });\n      qx.event.message.Bus.dispatchByName('cv.manager.msg.snackbar', msg);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-snackbar'\n    },\n\n    messages: {\n      check: 'qx.data.Array',\n      deferredInit: true,\n      event: 'changeMessages'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n\n    _onMessage: function (ev) {\n      const msg = ev.getData();\n      if (msg instanceof cv.ui.manager.model.Message) {\n        this.getMessages().push(msg);\n        this.show();\n      }\n    },\n\n    _onCloseMessage: function (ev) {\n      const msg = ev.getData();\n      this.getMessages().remove(msg);\n      if (this.getMessages().length === 0) {\n        this.exclude();\n      }\n    },\n\n    _initDelegate: function () {\n      this._listController.setDelegate({\n        createItem: function () {\n          const item = new cv.ui.manager.snackbar.Message();\n          item.addListener('close', this._onCloseMessage, this);\n          return item;\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n        }\n      });\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'list':\n           control = new qx.ui.form.List();\n           this._add(control, {flex: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.msg.snackbar', this._onMessage, this);\n    this._disposeObjects('_listController');\n  }\n});\n","/**\n * User preferences.\n */\nqx.Class.define('cv.ui.manager.model.Preferences', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._restorePreferences();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    defaultConfigEditor: {\n      check: ['source', 'xml'],\n      init: 'source',\n      event: 'changeDefaultConfigEditor',\n      apply: '_savePreferences'\n    },\n\n    quickPreview: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeQuickPreview',\n      apply: '_savePreferences'\n    },\n\n    /**\n     * In export mode the manager looks and behaves like a file explorer.\n     */\n    expertMode: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeExpertMode',\n      apply: '_savePreferences'\n    },\n\n    /**\n     * View mode of the start page\n     */\n    startViewMode: {\n      check: ['list', 'preview'],\n      init: 'preview',\n      event: 'changeStartViewMode',\n      apply: '_savePreferences'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _skipSaving: false,\n\n    _savePreferences: function () {\n      if (!this._skipSaving) {\n        const store = qx.bom.Storage.getLocal();\n        const data = qx.util.Serializer.toNativeObject(this);\n        store.setItem('preferences', data);\n        cv.report.Record.record(cv.report.Record.STORAGE, 'preferences', data);\n      }\n    },\n\n    _restorePreferences: function () {\n      const store = qx.bom.Storage.getLocal();\n      this.set(store.getItem('preferences'));\n    },\n\n    setPreferences: function (preferences, noSave) {\n      if (noSave) {\n        this._skipSaving = true;\n      }\n      this.set(preferences);\n      this._skipSaving = false;\n    }\n  }\n});\n","/**\n * Central registry for all available file editors/viewers.\n */\nqx.Class.define('cv.ui.manager.control.FileHandlerRegistry', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__registry = {};\n    this.__defaults = [];\n\n    // register viewers\n    this.registerFileHandler(new RegExp('\\\\.(' + cv.ui.manager.viewer.Image.SUPPORTED_FILES.join('|') + ')$', 'i'), cv.ui.manager.viewer.Image, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Config.SUPPORTED_FILES, cv.ui.manager.viewer.Config, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Icons.SUPPORTED_FILES, cv.ui.manager.viewer.Icons, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Folder.SUPPORTED_FILES, cv.ui.manager.viewer.Folder, {type: 'view'});\n    this.registerFileHandler(null, cv.ui.manager.Start, {type: 'view'});\n\n    // register the basic editors\n    this.registerFileHandler(cv.ui.manager.editor.Source.SUPPORTED_FILES, cv.ui.manager.editor.Source, {type: 'edit'});\n    this.registerFileHandler(cv.ui.manager.editor.Tree.SUPPORTED_FILES, cv.ui.manager.editor.Tree, {\n      preview: false,\n      type: 'edit'\n    });\n    this.registerFileHandler(cv.ui.manager.model.CompareFiles, cv.ui.manager.editor.Diff, {type: 'view'});\n\n    this.registerFileHandler('hidden.php', cv.ui.manager.editor.Config, {type: 'edit'});\n\n    cv.ui.manager.model.Preferences.getInstance().addListener('changeDefaultConfigEditor', this._onChangesDefaultConfigEditor, this);\n    this._onChangesDefaultConfigEditor();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __registry: null,\n    __defaults: null,\n\n    /**\n     * Registers an editor for a specific file, that is identified by the given selector.\n     * @param selector {String|RegExp|Class|Function|null} filename-/path or regular expression. If null this is a special handler that must be loaded manually (like cv.ui.manager.Start)\n     * @param clazz {qx.ui.core.Widget} widget class that handles those type of files\n     * @param options {Map?} additional options to store in the registry\n     */\n    registerFileHandler: function (selector, clazz, options) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertTrue(qx.Interface.classImplements(clazz, cv.ui.manager.editor.IEditor));\n      }\n      const config = Object.assign({\n        Clazz: clazz,\n        instance: null\n      }, options || {});\n      if (qx.Class.isClass(selector)) {\n        config.instanceOf = selector;\n        config.selectorId = 'instanceOf:' + selector.classname;\n        // highest priority\n        config.priority = 0;\n      } else if (qx.lang.Type.isRegExp(selector)) {\n        config.regex = selector;\n        config.selectorId = 'regex:' + selector.toString();\n        config.priority = 4;\n      } else if (qx.lang.Type.isFunction(selector)) {\n        config.selectorId = 'function:' + selector.name;\n        config.priority = 3;\n        config.function = selector;\n      } else if (qx.lang.Type.isString(selector)) {\n        // simple file matcher\n        if (selector.includes('/')) {\n          config.fullPath = selector;\n          config.selectorId = 'fullPath:' + selector;\n          config.priority = 1;\n        } else {\n          config.fileName = selector;\n          config.selectorId = 'fileName:' + selector;\n          config.priority = 2;\n        }\n      } else {\n        config.selectorId = 'none';\n        config.priority = 10;\n      }\n      this.__registry[clazz.classname] = config;\n    },\n\n    getFileHandler: function (file, type) {\n      const handlers = [];\n      if (!(file instanceof cv.ui.manager.model.CompareFiles)) {\n        // check if there is a default first\n        let defaultHandler;\n        Object.keys(this.__defaults).some(function (key) {\n          if (this.__defaults[key].regex.test(file.getFullPath()) &&\n            (!file.isTemporary() || !this.__defaults[key].noTemporaryFiles) &&\n            (file.isWriteable() || !this.__defaults[key].noReadOnlyFiles)\n          ) {\n            if (type) {\n              const config = this.getFileHandlerById(this.__defaults[key].clazz.classname);\n              if (config.type === type) {\n                defaultHandler = config;\n              }\n            } else {\n              defaultHandler = this.getFileHandlerById(this.__defaults[key].clazz.classname);\n            }\n          }\n          return !!defaultHandler;\n        }, this);\n        if (defaultHandler) {\n          return defaultHandler;\n        }\n      }\n\n      Object.keys(this.__registry).forEach(function (classname) {\n        const config = this.__registry[classname];\n        if (this.__canHandle(config, file) && (!type || config.type === type)) {\n          handlers.push(config);\n        }\n      }, this);\n      if (handlers.length === 0) {\n        if (!file.isFake() && file.getDisplayName().split('.').length === 1) {\n          // file without file ending => use the source code editor\n          return this.getFileHandlerById('cv.ui.manager.editor.Source');\n        }\n        // no editors found\n        return null;\n      } else if (handlers.length === 1) {\n        return handlers[0];\n      } \n        // sort by selector priority (instance, fullpath, filename, regex)\n        handlers.sort(function (a, b) {\n          return a.priority - b.priority;\n        });\n        // no default handler, just take the first one\n        return handlers[0];\n    },\n\n    getFileHandlerById: function (handlerId) {\n      return this.__registry[handlerId];\n    },\n\n    hasFileHandler: function (file, type) {\n      return Object.keys(this.__registry).some(function (classname) {\n        const config = this.__registry[classname];\n        return this.__canHandle(config, file) && (!type || config.type === type);\n      }, this);\n    },\n\n    /**\n     * Mark the handler with the given classname as default for the selector-id and all others with the same selector id not,\n     * @param selector {RegExp}\n     * @param clazz {qx.Class}\n     * @param noTemporaryFiles {Boolean} flag to prevent this default editor from being used to open temporary files.\n     * @param noReadOnlyFiles {Boolean} fleag to prevent this default editor from being used to open file that are not writeable\n     */\n    setDefault: function (selector, clazz, noTemporaryFiles, noReadOnlyFiles) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertRegExp(selector);\n        qx.core.Assert.assertTrue(qx.Class.isClass(clazz));\n      }\n      this.__defaults[selector.toString()] = {\n        regex: selector,\n        clazz: clazz,\n        noTemporaryFiles: noTemporaryFiles,\n        noReadOnlyFiles: noReadOnlyFiles\n      };\n    },\n\n    _onChangesDefaultConfigEditor: function () {\n      switch (cv.ui.manager.model.Preferences.getInstance().getDefaultConfigEditor()) {\n        case 'source':\n          this.setDefault(cv.ui.manager.editor.Source.DEFAULT_FOR, cv.ui.manager.editor.Source);\n          break;\n\n        case 'xml':\n          this.setDefault(cv.ui.manager.editor.Tree.SUPPORTED_FILES, cv.ui.manager.editor.Tree);\n          break;\n      }\n    },\n\n    __canHandle: function(config, file) {\n      if (config.noTemporaryFiles === true && file.isTemporary()) {\n        return false;\n      } else if (config.noReadOnlyFiles === true && !file.isWriteable()) {\n          return false;\n      } else if (config.fileName && file.getName() === config.fileName) {\n        return true;\n      } else if (config.fullPath && file.getFullPath() === config.fullPath) {\n        return true;\n      } else if (config.regex && config.regex.test(file.getFullPath().toLowerCase())) {\n        return true;\n      } else if (config.instanceOf && file instanceof config.instanceOf) {\n        return true;\n      } else if (config.function && config.function(file)) {\n        return true;\n      }\n      return false;\n    },\n\n    getAllFileHandlers: function (file, type) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertTrue(file instanceof cv.ui.manager.model.FileItem || file instanceof cv.ui.manager.model.CompareFiles);\n      }\n      return Object.keys(this.__registry).filter(function (key) {\n        return this.__canHandle(this.__registry[key], file) && (!type || this.__registry[key].type === type);\n      }, this).map(function (key) {\n        return this.__registry[key];\n      }, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    // cleanup handler instances\n    Object.keys(this.__registry).forEach(function (regex) {\n      if (this.__registry[regex].instance) {\n        this.__registry[regex].instance.dispose();\n        this.__registry[regex].instance = null;\n      }\n    }, this);\n\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeDefaultConfigEditor', this._onChangesDefaultConfigEditor, this);\n  }\n});\n","/**\n * Interface all file editors must implement.\n */\nqx.Interface.define('cv.ui.manager.editor.IEditor', {\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_loadFile'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * If the handler needs some time to initialize before it can accept a file, this should be set false until the handler is ready\n     */\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: ''\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    save: function () {},\n\n    getCurrentContent: function () {}\n  }\n});\n","/**\n * Abstract base class for all editors.\n */\nqx.Class.define('cv.ui.manager.editor.AbstractEditor', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._initClient();\n    this._nativePasteSupported = document.queryCommandSupported('paste');\n  },\n\n  /*\n ***********************************************\n   PROPERTIES\n ***********************************************\n */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      apply: '_loadFile',\n      event: 'changeFile'\n    },\n\n    content: {\n      nullable: true,\n      event: 'changeContent',\n      apply: '_applyContent'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true,\n      apply: '_applyHandlerOptions'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    // fake clipboard data when native clipboard is not supported\n    CLIPBOARD: null\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _handledActions: null,\n    _nativePasteSupported: false,\n\n    canHandleAction: function (actionName) {\n      if (actionName === 'save' && this.getFile() && !this.getFile().isWriteable()) {\n        return false;\n      }\n      return this._handledActions && this._handledActions.includes(actionName);\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'save':\n            this.save();\n            break;\n        }\n      }\n    },\n\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getFsClient();\n    },\n\n    _applyHandlerOptions: function () {},\n\n    _loadFile: function (file, old) {\n      if (old) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (file && file.getType() === 'file') {\n        if (file.getContent() !== null) {\n          this.setContent(file.getContent());\n        } else {\n          this._loadFromFs();\n        }\n        qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n      } else {\n        this.resetContent();\n      }\n    },\n\n    _loadFromFs: function () {\n      this._client.readSync({path: this.getFile().getFullPath()}, function (err, res) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          if (res instanceof XMLDocument) {\n            res = new XMLSerializer().serializeToString(res);\n          }\n          this.setContent(res);\n        }\n      }, this);\n    },\n\n    _onChange: function (ev) {\n      const data = ev.getData();\n      if (data.type === 'fsContentChanged' && data.source !== this) {\n        this.setContent(data.data);\n      }\n    },\n\n    // must be overridden by inheriting classes\n    _applyContent: function() {},\n\n    // must be overridden by inheriting classes\n    getCurrentContent: function () {},\n\n    _handleSaveResponse: function (type, err) {\n      if (err) {\n        cv.ui.manager.snackbar.Controller.error(err);\n      } else {\n        const file = this.getFile();\n        const message = type === 'created' ? this.tr('File has been created') : this.tr('File has been saved');\n        cv.ui.manager.snackbar.Controller.info(message);\n        this._onSaved();\n        qx.event.message.Bus.dispatchByName(file.getBusTopic(), {\n          type: type,\n          file: file,\n          data: this.getCurrentContent(),\n          source: this\n        });\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      const file = this.getFile();\n      if (file.isModified()) {\n        if (file.isTemporary()) {\n          this._client.createSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash(),\n            type: 'file'\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'created'), this);\n        } else {\n          this._client.updateSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash()\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'contentChanged'), this);\n        }\n      }\n    },\n\n    _onSaved: function () {\n      const file = this.getFile();\n      file.resetModified();\n      file.resetTemporary();\n    },\n\n    showErrors: function (path, errorList) {},\n    showDecorations: function (path, decorators) {}\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    if (this._client) {\n      this._client = null;\n    }\n  }\n});\n","/**\n * Global singleton that hold some states that are relevant for many parts of the manager.\n */\nqx.Class.define('cv.ui.manager.core.GlobalState', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    openedFocusedFile: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      event: 'changeOpenedFocusedFile',\n      apply: '_applyFile'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyFile: function () {\n      cv.ui.manager.control.ActionDispatcher.getInstance().updateBarButtons();\n    }\n  }\n});\n","/**\n * Data model for currently opened files, a combination of cv.ui.manager.model.FileItem and a certain FileHandler.\n */\nqx.Class.define('cv.ui.manager.model.OpenFile', {\n  extend: qx.core.Object,\n\n\n    /*\n    ***********************************************\n      CONSTRUCTOR\n    ***********************************************\n    */\n    construct: function (file, handlerId) {\n      this.base(arguments);\n      if (file) {\n        this.setFile(file);\n      }\n      if (handlerId) {\n        this.setHandlerId(handlerId);\n      }\n    },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      event: 'changeFile',\n      apply: '_applyFile'\n    },\n\n    handlerId: {\n      check: '!!qx.Class.getByName(value)',\n      nullable: true,\n      apply: '_maintainIcon'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true\n    },\n\n    /**\n     * The opening state: permanent false behaves like a quick preview, where\n     * the current file content is replaces by the next selected file on single click.\n     * In permanent mode a new tab will be created, which content will not be replaced.\n     */\n    permanent: {\n      check: 'Boolean',\n      init: false,\n      event: 'changePermanent'\n    },\n\n    /**\n     * Icon to show in e.g. the File-Tab\n     */\n    icon: {\n      check: 'String',\n      init: '',\n      event: 'changeIcon'\n    },\n\n    closeable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeCloseable'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __ibid: null,\n\n    _applyFile: function (value, old) {\n      if (old) {\n        old.removeListener('changeModified', this._maintainPermanent, this);\n        old.removeRelatedBindings(this);\n        this.__ibid = null;\n      }\n      if (value) {\n        value.addListener('changeModified', this._maintainPermanent, this);\n      }\n      this._maintainIcon();\n    },\n\n    _maintainIcon: function () {\n      // use the handlers icon is there is one, otherwise the file items icon\n      const file = this.getFile();\n      if (this.getHandlerId() && file) {\n        const handlerClass = qx.Class.getByName(this.getHandlerId());\n        if (handlerClass && handlerClass.ICON) {\n          this.setIcon(handlerClass.ICON);\n          if (this.__ibid) {\n            file.removeBinding(this.__ibid);\n            this.__ibid = null;\n          }\n        } else {\n          this.__ibid = file.bind('icon', this, 'icon');\n        }\n      } else {\n        this.resetIcon();\n      }\n    },\n\n    _maintainPermanent: function () {\n      if (this.getFile().isModified() && !this.isPermanent()) {\n        // change to permanent once we have a modification\n        this.setPermanent(true);\n      }\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.CompareFiles', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (original, modified) {\n    this.base(arguments);\n    this.setOriginalFile(original);\n    this.setModifiedFile(modified);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    originalFile: {\n      check: 'cv.ui.manager.model.FileItem',\n      event: 'changeOriginal'\n    },\n    modifiedFile: {\n      check: 'cv.ui.manager.model.FileItem',\n      event: 'changeModifiedFile',\n      apply: '_applyModifiedFile'\n    },\n\n    permanent: {\n      check: 'Boolean',\n      init: true\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName'\n    },\n\n    type: {\n      check: 'String',\n      init: 'file'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    isRelated: function (path) {\n      return this.getOriginalFile().getFullPath() === path || this.getModifiedFile().getFullPath() === path;\n    },\n\n    isConfigFile: function () {\n      return this.getModifiedFile().isConfigFile();\n    },\n\n    getFullPath: function () {\n      return this.getOriginalFile().getFullPath();\n    },\n\n    _applyModifiedFile: function () {\n      this.setName(qx.locale.Manager.tr('Diff: %1', this.getModifiedFile().getName()));\n    },\n\n    getParent: function () {\n      return this.getModifiedFile().getParent();\n    },\n\n    isWriteable: function () {\n      return this.getModifiedFile().isWriteable();\n    },\n\n    isTrash: function () {\n      return this.getModifiedFile().isTrash();\n    },\n\n    isInTrash: function () {\n      return this.getModifiedFile().isInTrash();\n    },\n\n    isFake: function () {\n      return this.getModifiedFile().isFake();\n    },\n\n    isTemporary: function () {\n      return this.getModifiedFile().isTemporary() || this.getOriginalFile().isTemporary();\n    },\n\n    isMounted: function () {\n      return this.getModifiedFile().isMounted() || this.getOriginalFile().isMounted();\n    },\n\n    /**\n     * Returns a fake URI that can be used to identify the file.\n     * Used by monaco editor as model URI.\n     * @returns {Uri}\n     */\n    getUri: function () {\n      return 'cv://' + this.getOriginalFile().getFullPath() + '+' + this.getModifiedFile().getFullPath();\n    }\n  }\n});\n","/**\n * The FileController is responsible for all file operations, like config check, move, replace, delete etc.\n */\nqx.Class.define('cv.ui.manager.control.FileController', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__fsClient = cv.io.rest.Client.getFsClient();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __fsClient: null,\n\n    rename: function (file, newName) {\n      let newPath = file.getPath() || '';\n      if (newPath.length > 0 && !newPath.endsWith('/')) {\n        newPath += '/';\n      }\n      newPath += newName;\n      if (file.isTemporary()) {\n        // create new item\n        this.__fsClient.createSync({path: newPath, type: file.getType()}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been created', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been created', file.getDisplayName())\n            );\n            file.resetTemporary();\n            file.resetModified();\n            file.setName(newName);\n            file.reload();\n          }\n        }, this);\n      } else if (file.getFullPath() !== newPath) {\n        this.__fsClient.moveSync({src: file.getFullPath(), target: newPath}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been renamed', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been renamed', file.getDisplayName())\n            );\n            file.setName(newName);\n            file.resetModified();\n            file.reload();\n          }\n          file.resetEditing();\n        }, this);\n      }\n    },\n\n    /**\n     * Move file to another path\n     * @param file {cv.ui.manager.model.FileItem} file to move\n     * @param target {String} new path of the file\n     */\n    move: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been moved', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been moved', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'moved',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    /**\n     * Restore file from trash by moving it out of the trash to the old path\n     * @param file {cv.ui.manager.model.FileItem} file to restore\n     */\n    restore: function (file) {\n      if (file.isInTrash()) {\n        const target = file.getFullPath().replace('.trash/', '');\n        this.__moveFile(file, target);\n      } else if (file.getType() === 'file' && !file.isTemporary()) {\n        const match = /^\\/?backup\\/visu_config(.*)-[0-9]{14}\\.xml$/.exec(file.getFullPath());\n        if (match) {\n          // find the existing target config to restore\n          const targetFileName = 'visu_config' + match[1] + '.xml';\n\n          // find the target file\n          const parentFolder = file.getParent().getParent();\n          let targetFile = null;\n          parentFolder.getChildren().some(function(child) {\n            if (child.getFullPath() === targetFileName) {\n              targetFile = child;\n              return true;\n            }\n            return false;\n          });\n\n          // load the backup content\n          this.__fsClient.readSync({path: file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else if (targetFile) {\n                this.__fsClient.updateSync({\n                  path: targetFile.getFullPath(),\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                    targetFile.resetModified();\n                    targetFile.resetTemporary();\n                    qx.event.message.Bus.dispatchByName(targetFile.getBusTopic(), {\n                      type: 'fsContentChanged',\n                      data: res,\n                      source: this\n                    });\n                  }\n                }, this);\n              } else {\n                // target file does not exist copy to a new file\n                this.__fsClient.createSync({\n                  path: targetFileName,\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                  }\n                }, this);\n              }\n          }, this);\n        }\n      }\n    },\n\n    __moveFile: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been restored', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been restored', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'restored',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    'delete': function(file, callback, context) {\n      if (file.isTemporary()) {\n        // new file, no need to call the backend\n        if (callback) {\n          callback.apply(context, true);\n        }\n      } else if (file) {\n        let message;\n        if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Do you really want to clear the trash?');\n          } else if (file.isInTrash()) {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\" from the trash?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\" from the trash?', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\"?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\"?', file.getDisplayName());\n          }\n          qxl.dialog.Dialog.confirm(message, function (confirmed) {\n            if (confirmed) {\n              this.__doDelete(file, callback, context);\n            } else if (callback) {\n              callback.apply(context, false);\n            }\n          }, this, qx.locale.Manager.tr('Confirm deletion'));\n        }\n    },\n\n    __doDelete: function (file, callback, context) {\n      this.__fsClient.deleteSync({path: file.getFullPath(), force: file.isTrash()}, null, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n          if (callback) {\n            callback.apply(context, false);\n          }\n        } else {\n          let message;\n          if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Trash has been cleared');\n          } else if (file.isInTrash()) {\n            message = this.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been removed from trash', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been removed from trash', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been deleted', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been deleted', file.getDisplayName());\n          }\n          cv.ui.manager.snackbar.Controller.info(message);\n          if (callback) {\n            callback.apply(context, true);\n          }\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'deleted',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    download: function (file) {\n      if (file.getType() === 'file') {\n        const element = document.createElement('a');\n        element.setAttribute('href', cv.io.rest.Client.getBaseUrl() + '/fs?download=true&path=' + file.getFullPath());\n        element.style.display = 'none';\n        document.body.appendChild(element);\n        element.click();\n        document.body.removeChild(element);\n      }\n    },\n\n    validate: function (file) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertInstance(file, cv.ui.manager.model.FileItem);\n      }\n      if (file.isConfigFile()) {\n        this.__validateConfig(file);\n      } else {\n        this.info('no validation available for file: ' + file.getFullPath());\n      }\n    },\n\n    __validateConfig: function (file) {\n      const d = qxl.dialog.Dialog.alert(qx.locale.Manager.tr('Validating %1', file.getFullPath()));\n      cv.ui.manager.editor.Worker.getInstance().validateConfig(file).then(function (res) {\n        d.close();\n        if (res === true) {\n          file.setValid(true);\n          cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has no errors!', file.getFullPath()));\n        } else {\n          file.setValid(false);\n          qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n            file: file,\n            handler: 'cv.ui.manager.editor.Source',\n            handlerOptions: {\n              jumpToError: true\n            }\n          });\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.trn(\n            '%1 error found in %2!',\n            '%1 errors found in %2!',\n            res.length,\n            res.length,\n            file.getFullPath())\n          );\n        }\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__fsClient = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.dialog.Prompt', {\n  extend: qxl.dialog.Prompt,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _createWidgetContent: function() {\n      this.base(arguments);\n      this._textField.setLiveUpdate(true);\n    }\n  }\n});\n","/**\n * Main toolbar on top.\n */\nqx.Class.define('cv.ui.manager.MenuBar', {\n  extend: qx.ui.menubar.MenuBar,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this.__buttons = {};\n\n    this._draw();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _commandGroup: null,\n    __buttons: null,\n    __defaultButtonConfiguration: null,\n    __buttonConfiguration: null,\n\n    _draw: function () {\n      this._createChildControl('file');\n      this._createChildControl('edit');\n      this._createChildControl('preferences');\n      this.add(new qx.ui.core.Spacer(), {flex: 1});\n\n      this._createChildControl('title');\n      this.add(new qx.ui.core.Spacer(), {flex: 1});\n      this._createChildControl('help');\n\n      const editorGroup = new qx.ui.form.RadioGroup();\n\n      this.__defaultButtonConfiguration = {\n        'new-file': {\n          menu: 'new-menu',\n          args: [this.tr('New file'), cv.theme.dark.Images.getIcon('new-file', 18), this._commandGroup.get('new-file')],\n          enabled: true\n        },\n        'new-folder': {\n          menu: 'new-menu',\n          args: [this.tr('New folder'), cv.theme.dark.Images.getIcon('new-folder', 18), this._commandGroup.get('new-folder')],\n          enabled: true,\n          separator: 'after'\n        },\n        'new-config-file': {\n          menu: 'new-menu',\n          args: [this.tr('New config file')],\n          enabled: true\n        },\n        'upload': {\n          menu: 'file-menu',\n          clazz: com.zenesis.qx.upload.UploadMenuButton,\n          args: [this.tr('Upload file'), cv.theme.dark.Images.getIcon('upload', 18)],\n          enabled: true,\n          separator: 'before'\n        },\n        'save': {\n          menu: 'file-menu',\n          args: [this.tr('Save'), cv.theme.dark.Images.getIcon('save', 18), this._commandGroup.get('save')],\n          enabled: false,\n          separator: 'before'\n        },\n        'save-as': {\n          menu: 'file-menu',\n          args: [this.tr('Save as...'), null, this._commandGroup.get('save-as')],\n          enabled: false\n        },\n        'delete': {\n          args: [this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18), this._commandGroup.get('delete')],\n          enabled: false,\n          hidden: true\n        },\n        'quit': {\n          menu: 'file-menu',\n          args: [this.tr('Quit'), cv.theme.dark.Images.getIcon('quit', 18), this._commandGroup.get('quit')],\n          enabled: true,\n          separator: 'before'\n        },\n        // edit menu basics\n        'undo': {\n          menu: 'edit-menu',\n          args: [this.tr('Undo'), cv.theme.dark.Images.getIcon('undo', 18), this._commandGroup.get('undo')],\n          enabled: true\n        },\n        'redo': {\n          menu: 'edit-menu',\n          args: [this.tr('Redo'), cv.theme.dark.Images.getIcon('redo', 18), this._commandGroup.get('redo')],\n          enabled: true\n        },\n        'cut': {\n          menu: 'edit-menu',\n          args: [this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18), this._commandGroup.get('cut')],\n          enabled: false,\n          separator: 'before'\n        },\n        'copy': {\n          menu: 'edit-menu',\n          args: [this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18), this._commandGroup.get('copy')],\n          enabled: false\n        },\n        'paste': {\n          menu: 'edit-menu',\n          args: [this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18), this._commandGroup.get('paste')],\n          enabled: false\n        },\n        // preferences\n        'source-editor': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.RadioButton,\n          args: [this.tr('Use text editor')],\n          general: true,\n          enabled: true,\n          properties: {\n            model: 'source',\n            group: editorGroup\n          }\n        },\n        'xml-editor': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.RadioButton,\n          args: [this.tr('Use xml editor')],\n          general: true,\n          enabled: true,\n          properties: {\n            model: 'xml',\n            group: editorGroup\n          }\n        },\n        'quick-preview': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.CheckBox,\n          args: [this.tr('Enable quick preview')],\n          general: true,\n          enabled: true,\n          separator: 'before'\n        },\n        'expert-mode': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.CheckBox,\n          args: [this.tr('Expert mode')],\n          general: true,\n          enabled: true\n        },\n        'help': {\n          menu: 'help-menu',\n          args: [this.tr('Help'), cv.theme.dark.Images.getIcon('help', 18), this._commandGroup.get('help')],\n          enabled: false\n        },\n        'about': {\n          menu: 'help-menu',\n          args: [this.tr('About')],\n          enabled: false\n        }\n      };\n      this.maintainButtons();\n\n      const prefs = cv.ui.manager.model.Preferences.getInstance();\n\n      prefs.bind('defaultConfigEditor', editorGroup, 'modelSelection', {\n        converter: function (value) {\n          return [value];\n        }\n      });\n      editorGroup.getModelSelection().addListener('change', function () {\n        prefs.setDefaultConfigEditor(editorGroup.getModelSelection().getItem(0));\n      }, this);\n\n      this.__bindToPreference('quick-preview', 'quickPreview');\n      this.__bindToPreference('expert-mode', 'expertMode');\n    },\n\n    __bindToPreference: function (buttonName, preferenceName) {\n      const button = this.getButton(buttonName);\n      const prefs = cv.ui.manager.model.Preferences.getInstance();\n      prefs.bind(preferenceName, button, 'value');\n      button.bind('value', prefs, preferenceName);\n    },\n\n    maintainButtons: function (config) {\n      if (!config) {\n        config = this.__defaultButtonConfiguration;\n      } else {\n        config = Object.merge(this.__defaultButtonConfiguration, config);\n        this.__buttonConfiguration = config;\n      }\n      Object.keys(config).forEach(function (id) {\n        let button;\n        const buttonConf = config[id];\n        if (!Object.prototype.hasOwnProperty.call(this.__buttons, id)) {\n          // create button\n          const label = buttonConf.args[0];\n          const icon = buttonConf.args[1];\n          const command = buttonConf.args[2];\n          const ButtonClass = buttonConf.clazz || qx.ui.menu.Button;\n          if (qx.lang.Type.isString(command) || !command) {\n            // no command connected\n            button = new ButtonClass(label, icon);\n            if (command) {\n              // just add the string as shortcut hint\n              button.getChildControl('shortcut').setValue(command);\n            }\n          } else {\n            button = new ButtonClass(label, icon, command);\n            if (qx.core.Environment.get('qx.command.bindEnabled')) {\n              button.bind('enabled', command, 'enabled');\n            }\n          }\n          button.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.' + id);\n          }, this);\n          if (!buttonConf.hidden) {\n            const menu = this.getChildControl(buttonConf.menu);\n            if (!menu) {\n              throw new Error('no menu named ' + buttonConf.menu + ' found!');\n            }\n            if (buttonConf.separator === 'before') {\n              menu.add(new qx.ui.menu.Separator());\n            }\n            menu.add(button);\n            if (buttonConf.separator === 'after') {\n              menu.add(new qx.ui.menu.Separator());\n            }\n          }\n          this.__buttons[id] = button;\n\n          if (Object.prototype.hasOwnProperty.call(buttonConf, 'onAfterCreate')) {\n            buttonConf.onAfterCreate(button);\n          }\n        } else {\n          button = this.__buttons[id];\n        }\n        button.setEnabled(buttonConf.enabled);\n        if (buttonConf.properties) {\n          button.set(buttonConf.properties);\n        }\n      }, this);\n    },\n\n    getButton: function (id) {\n      return this.__buttons[id];\n    },\n\n    getButtonConfiguration: function () {\n      return this.__buttonConfiguration || this.__defaultButtonConfiguration;\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'title':\n           control = new qx.ui.basic.Label(this.tr('CometVisu Manager'));\n           this.add(control);\n           break;\n\n         case 'file':\n           control = new qx.ui.menubar.Button(this.tr('File'), null, this.getChildControl('file-menu'));\n           this.add(control);\n           break;\n\n         case 'edit':\n           control = new qx.ui.menubar.Button(this.tr('Edit'), null, this.getChildControl('edit-menu'));\n           this.add(control);\n           break;\n\n         case 'help':\n           control = new qx.ui.menubar.Button(this.tr('Help'), null, this.getChildControl('help-menu'));\n           this.add(control);\n           break;\n\n         case 'about':\n           control = new qx.ui.menubar.Button(this.tr('About'), null, this.getChildControl('help-menu'));\n           this.add(control);\n           break;\n\n         case 'new':\n           control = new qx.ui.menu.Button(this.tr('New'), null, null, this.getChildControl('new-menu'));\n           break;\n\n         case 'preferences':\n           control = new qx.ui.menubar.Button(this.tr('Preferences'), null, this.getChildControl('preferences-menu'));\n           this.add(control);\n           break;\n\n         case 'new-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'file-menu':\n           control = new qx.ui.menu.Menu();\n           control.add(this.getChildControl('new'));\n           break;\n\n         case 'edit-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'preferences-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'help-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n  }\n});\n","/**\n * Extend {com.zenesis.qx.upload.UploadMgr} to allow files to e uploaded via HTML5 drop\n */\nqx.Class.define('cv.ui.manager.upload.UploadMgr', {\n  extend : com.zenesis.qx.upload.UploadMgr,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (widget, uploadUrl) {\n    this.base(arguments, widget, uploadUrl);\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    LAST_ID: 0\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    multiple: {\n      refine: true,\n      init: false\n    },\n\n    folder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_updateUploadUrl'\n    },\n\n    filename: {\n      check: 'String',\n      nullable: true\n    },\n\n    force: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  members : {\n\n    _updateUploadUrl: function () {\n      const folder = this.getFolder();\n      const path = folder ? folder.getFullPath() : '.';\n      const url = cv.io.rest.Client.getBaseUrl() + '/fs?type=file&path=' + path;\n      this.setUploadUrl(url);\n    },\n\n    _init: function () {\n      this.addListener('addFile', function(evt) {\n        const file = evt.getData();\n        const filename = this.getFilename();\n        if (filename) {\n          file.setParam('filename', filename);\n        }\n        if (this.isForce()) {\n          file.setParam('force', true);\n        }\n        const progressListenerId = file.addListener('changeProgress', function (evt) {\n          const file = evt.getTarget();\n          const uploadedSize = evt.getData();\n\n          this.debug('Upload ' + file.getFilename() + ': ' +\n            uploadedSize + ' / ' + file.getSize() + ' - ' +\n            Math.round(uploadedSize / file.getSize() * 100) + '%');\n        }, this);\n\n        const stateListenerId = file.addListener('changeState', function (evt) {\n          const state = evt.getData();\n          const file = evt.getTarget();\n\n          if (state === 'uploading') {\n            this.debug(file.getFilename() + ' (Uploading...)');\n          } else if (state === 'uploaded') {\n            this.debug(file.getFilename() + ' (Complete)');\n            if (file.getStatus() !== 200) {\n              // something went wrong\n              switch (file.getStatus()) {\n                case 406:\n                  if (this.isForce()) {\n                    cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Replacing the file failed.'));\n                  } else {\n                    qxl.dialog.Dialog.confirm(qx.locale.Manager.tr('This file already exists, do you want to replace it?'), function (confirmed) {\n                      if (confirmed) {\n                        this.forceUpload(file);\n                      }\n                    }, this, qx.locale.Manager.tr('File already exists'));\n                  }\n                  break;\n\n                case 403:\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Uploading this file is not allowed here.'));\n                  break;\n\n                default: {\n                  let err = file.getResponse();\n                  try {\n                    err = qx.lang.Json.parse(err).message;\n                  } catch (e) {\n                  }\n                  this.error(err);\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('File upload stopped with an error: %1', err));\n                  break;\n                }\n              }\n            } else {\n              cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('File has been uploaded'));\n              qx.event.message.Bus.dispatchByName('cv.manager.file', {\n                action: 'uploaded',\n                path: this.getFolder().getFullPath() + '/' + file.getFilename()\n              });\n            }\n          } else if (state === 'cancelled') {\n            this.debug(file.getFilename() + ' (Cancelled)');\n          }\n          // Remove the listeners\n          if (state === 'uploaded' || state === 'cancelled') {\n            file.removeListenerById(progressListenerId);\n            file.removeListenerById(stateListenerId);\n          }\n        }, this);\n      }, this);\n    },\n\n    /**\n     * Allocates a unique ID\n     *\n     * @return {Number}\n     */\n    _getUniqueFileId: function() {\n      return ++cv.ui.manager.upload.UploadMgr.LAST_ID;\n    },\n\n    /**\n     * Re-upload a file in forced mode\n     * @param file {com.zenesis.qx.upload.File}\n     */\n    forceUpload: function (file) {\n      this.setForce(true);\n      const newFile = new com.zenesis.qx.upload.File(file.getBrowserObject(), file.getFilename(), file.getId());\n      newFile.set({\n        size: file.getSize(),\n        uploadWidget: file.getUploadWidget()\n      });\n      newFile.setParam('force', true);\n      this.getUploadHandler()._addFile(newFile);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    },\n\n    /**\n     * Upload file directly to the backend\n     *\n     * @param bomFile {File}\n     */\n    uploadFile: function(bomFile) {\n      const id = 'upload-' + this._getUniqueFileId();\n      const filename = typeof bomFile.name !== 'undefined' ? bomFile.name : bomFile.fileName;\n      const file = new com.zenesis.qx.upload.File(bomFile, filename, id);\n      const fileSize = typeof bomFile.size !== 'undefined' ? bomFile.size : bomFile.fileSize;\n      file.setSize(fileSize);\n      if (this.isForce()) {\n        file.setParam('force', true);\n      }\n      file.setUploadWidget(new com.zenesis.qx.upload.UploadButton());\n\n      this.getUploadHandler()._addFile(file);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    },\n\n    /**\n     * Replace content of existing file with the upload\n     * @param bomFile {File}\n     * @param replacedFile {cv.ui.manager.model.FileItem}\n     */\n    replaceFile: function(bomFile, replacedFile) {\n      this.setFolder(replacedFile.getParent());\n      const id = 'upload-' + this._getUniqueFileId();\n      const filename = replacedFile.getName();\n      const file = new com.zenesis.qx.upload.File(bomFile, filename, id);\n      file.setParam('force', true);\n      file.setParam('filename', filename);\n      const fileSize = typeof bomFile.size !== 'undefined' ? bomFile.size : bomFile.fileSize;\n      file.setSize(fileSize);\n      file.setUploadWidget(new com.zenesis.qx.upload.UploadButton());\n\n      this.getUploadHandler()._addFile(file);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    }\n  }\n});\n","/**\n * Add upload via drag&drop feature to this widget. The including widget must have a\n * \"upload-dropbox\" childcontrol or add\n *  <pre class=\"javascript\">\n *   if (!control) {\n        control = this._createMDragUploadChildControlImpl(id);\n      }\n *   </pre>\n *   to their own _createChildControlImpl method\n */\nqx.Mixin.define('cv.ui.manager.upload.MDragUpload', {\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n  construct : function() {\n    this.setDroppable(true);\n    if (this.getBounds()) {\n      this._applyStartDragListeners();\n    } else {\n      this.addListenerOnce('appear', function() {\n        this._applyStartDragListeners();\n      }, this);\n    }\n    const layout = this._getLayout();\n    if (!(layout instanceof qx.ui.layout.Grow) && !(layout instanceof qx.ui.layout.Canvas)) {\n      this.addListener('resize', this.__syncBounds, this);\n    }\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n  properties : {\n    uploadMode: {\n      check: 'Boolean',\n      init: false,\n      apply: '__applyUploadMode'\n    },\n\n    uploadHint: {\n      check: 'String',\n      init: ''\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Handles HTML5 drop events (dropping external files on dom element)\n     * @param ev {Event}\n     */\n    onHtml5Drop : function (ev) {\n      ev.preventDefault();\n      this.getFiles(ev).forEach(this.uploadFile, this);\n    },\n\n    /**\n     * Uploads the dropped file to the correct folder:\n     * - config files to the resources/config folder\n     * - accepted media files to the resources/config/media folder\n     * @param file {File}\n     * @param replaceFile {cv.ui.manager.model.FileItem?} optional, if set this files content gets replaced with the uploaded ones\n     */\n    uploadFile: function (file, replaceFile) {\n      const isConfig = cv.ui.manager.model.FileItem.isConfigFile(file.name);\n\n      let folder;\n      if (isConfig) {\n        // upload to root folder\n        folder = new cv.ui.manager.model.FileItem('.');\n      } else if (cv.ui.manager.tree.FileSystem.isAccepted(file.type)) {\n        // upload to media folder\n        folder = new cv.ui.manager.model.FileItem('media');\n      }\n      if (folder) {\n        folder.set({\n          type: 'dir'\n        });\n        const manager = new cv.ui.manager.upload.UploadMgr();\n        if (replaceFile) {\n          manager.replaceFile(file, replaceFile);\n        } else {\n          manager.setFolder(folder);\n          manager.uploadFile(file);\n        }\n      }\n    },\n\n    hasDroppableFile: function (ev) {\n      return this.getFiles(ev).length > 0;\n    },\n\n    /**\n     * Extracts acceptable files from event\n     * @param ev {Event}\n     * @private\n     */\n    getFiles: function (ev) {\n      const files = [];\n      let i;\n      let l;\n      let file;\n\n      if (ev.dataTransfer.items) {\n        // Use DataTransferItemList interface to access the file(s)\n        for (i = 0, l = ev.dataTransfer.items.length; i < l; i++) {\n          // If dropped items aren't files, reject them\n          const item = ev.dataTransfer.items[i];\n          if (item.kind === 'file' && cv.ui.manager.tree.FileSystem.isAccepted(item.type)) {\n            file = item.getAsFile();\n            files.push(file);\n          }\n        }\n      } else {\n        for (i = 0, l = ev.dataTransfer.files.length; i < l; i++) {\n          file = ev.dataTransfer.files[i];\n          if (cv.ui.manager.tree.FileSystem.isAccepted(file.type)) {\n            files.push(file);\n          }\n        }\n      }\n      return files;\n    }\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n  members : {\n    __hasEmptyInfo: null,\n    _boundOnStop: null,\n\n    __syncBounds: function () {\n      const bounds = this.getBounds();\n      this.getChildControl('upload-overlay').setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n      this.getChildControl('upload-dropbox').setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n    },\n\n    // overridden\n    _createMDragUploadChildControlImpl: function(id) {\n      let control;\n      const bounds = this.getBounds();\n      const layout = this._getLayout();\n\n      switch (id) {\n        case 'upload-overlay':\n          control = new qx.ui.container.Composite();\n          control.setZIndex(1000000);\n          control.exclude();\n          if (layout instanceof qx.ui.layout.Canvas) {\n            this._add(control, {edge: 0});\n          } else if (!(this._getLayout() instanceof qx.ui.layout.Grow) && bounds) {\n            control.setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n          }\n          this._add(control);\n          this.getChildControl('upload-dropbox').bind('visibility', control, 'visibility');\n          break;\n\n        case 'upload-dropbox': {\n          control = new qx.ui.container.Composite(new qx.ui.layout.Grow());\n          control.setBackgroundColor('rgba(32, 32, 32, 0.9)');\n          control.setZIndex(1000);\n          const dropBox = new qx.ui.basic.Atom(this.getUploadHint(), cv.theme.dark.Images.getIcon('upload', 32));\n          dropBox.set({\n            iconPosition: 'top',\n            rich: true,\n            center: true\n          });\n          // control.bind('width', dropBox, 'maxWidth');\n          dropBox.getChildControl('label').setWrap(true);\n          control.setAnonymous(true);\n          control.add(dropBox);\n          control.exclude();\n          if (layout instanceof qx.ui.layout.Canvas) {\n            this._add(control, {edge: 0});\n          } else if (!(this._getLayout() instanceof qx.ui.layout.Grow) && bounds) {\n            control.setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n          }\n          this._add(control);\n          break;\n        }\n      }\n      return control;\n    },\n\n    _onStopDragging: function(ev) {\n      ev.preventDefault();\n      this.setUploadMode(false);\n      document.removeEventListener('dragend', this._boundOnStop, false);\n    },\n\n    /**\n     * Apply dragover/-leave listeners to the dashboard to recognize File uploads via Drag&Drop\n     */\n    _applyStartDragListeners: function() {\n      // add the start listener to this widget\n      this.getContentElement().getDomElement().addEventListener('dragenter', function(ev) {\n        // ev.preventDefault();\n        if (this._isDroppable) {\n          if (this._isDroppable(ev.dataTransfer.items)) {\n            // we have something to drop\n            this.setUploadMode(true);\n          }\n        } else if (cv.ui.manager.upload.MDragUpload.hasDroppableFile(ev)) {\n          // we have something to drop\n          this.setUploadMode(true);\n        }\n      }.bind(this), false);\n      if (this.getChildControl('upload-overlay').getBounds()) {\n        this._applyDragListeners();\n      } else {\n        this.getChildControl('upload-overlay').addListenerOnce('appear', function() {\n          this._applyDragListeners();\n        }, this);\n      }\n    },\n\n    /**\n     * Apply dragover/-leave listeners to the dashboard to recognize File uploads via Drag&Drop\n     */\n    _applyDragListeners: function() {\n      const element = this.getChildControl('upload-overlay').getContentElement().getDomElement();\n      if (!element) {\n        const lid = this.getChildControl('upload-overlay').addListener('visibility', function (ev) {\n          if (ev.getData() === 'visible') {\n            this._applyDragListeners();\n            this.getChildControl('upload-overlay').removeListenerById(lid);\n          }\n        }, this);\n        return;\n      }\n      element.addEventListener('dragexit', function() {\n        this.setUploadMode(false);\n      }.bind(this), false);\n\n      element.addEventListener('dragover', function (ev) {\n        ev.preventDefault();\n        let uploadable = false;\n        if (this._isDroppable) {\n          uploadable = this._isDroppable(ev.dataTransfer.items);\n        } else if (cv.ui.manager.upload.MDragUpload.hasDroppableFile(ev)) {\n          uploadable = true;\n        }\n        this.setUploadMode(uploadable);\n      }.bind(this), false);\n\n      this._boundOnStop = this._onStopDragging.bind(this);\n\n      element.addEventListener('dragleave', this._boundOnStop, false);\n      element.addEventListener('dragend', function() {\n        this.setUploadMode(false);\n      }.bind(this), false);\n\n      document.addEventListener('dragend', this._boundOnStop, false);\n\n      if (this._onDrop) {\n        element.addEventListener('drop', this._onDrop.bind(this), false);\n      } else {\n        element.addEventListener('drop', function (ev) {\n          cv.ui.manager.upload.MDragUpload.onHtml5Drop(ev);\n          this._onStopDragging(ev);\n        }.bind(this), false);\n      }\n    },\n\n    // property apply\n    __applyUploadMode: function(value) {\n      if (value === true) {\n        this.getChildControl('upload-dropbox').show();\n        if (this.hasChildControl('empty-info') && this.getChildControl('empty-info').isVisible()) {\n          this.getChildControl('empty-info').exclude();\n          this.__hasEmptyInfo = true;\n        } else {\n          this.__hasEmptyInfo = false;\n        }\n      } else {\n        this.getChildControl('upload-dropbox').exclude();\n        if (this.__hasEmptyInfo === true) {\n          this.getChildControl('empty-info').show();\n        }\n      }\n    }\n  }\n});\n","/**\n * Shows filesystem content in a tree.\n */\nqx.Class.define('cv.ui.manager.tree.FileSystem', {\n  extend: qx.ui.core.Widget,\n  include: [\n    cv.ui.manager.upload.MDragUpload\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (rootFolder) {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this.setRootFolder(rootFolder);\n\n    qx.event.message.Bus.subscribe('cv.manager.tree.enable', this._onEnableTree, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    MIMETYPES: {\n      'text/xml': 'xml',\n      'application/xml': 'xml',\n      'text/javascript': 'js',\n      'application/x-httpd-php': 'php',\n      'text/css': 'css',\n      'image/png': 'png',\n      'image/svg+xml': 'svg',\n      'text/plain': ''\n    },\n\n    getMimetypeFromSuffix: function (suffix) {\n      return Object.keys(this.MIMETYPES).find(function (mime) {\n        return this.MIMETYPES[mime] === suffix;\n      }, this);\n    },\n\n    isAccepted: function (mimetype) {\n      return Object.prototype.hasOwnProperty.call(this.MIMETYPES, mimetype);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'changeSelection': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    // appearance: {\n    //   refine: true,\n    //   init: 'cv-filesystem'\n    // },\n\n    rootFolder: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_applyRootFolder'\n    },\n\n    selectedNode: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_applySelectedNode',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __selectionTimer: null,\n    __doubleTapWaitingTime: 500,\n    __ignoreSelectionChange: false,\n    _replacementManager: null,\n\n    reload: function () {\n      const tree = this.getChildControl('tree');\n      const openPaths = tree.getOpenNodes().map(function (node) {\n        return node.getFullPath();\n      });\n      const root = tree.getModel();\n      root.reload(function () {\n        this.getChildControl('tree').refresh();\n        root.setOpen(true);\n        openPaths.forEach(this.openPath, this);\n      }, this);\n    },\n\n    openPath: function (path) {\n      const root = this.getChildControl('tree').getModel();\n      if (path === '.') {\n        root.setOpen(true);\n      } else {\n        root.setOpen(true);\n        root.openPath(path);\n      }\n    },\n\n    refresh: function () {\n      this.getChildControl('tree').refresh();\n    },\n\n    _applyRootFolder: function (value) {\n      if (value) {\n        const tree = this.getChildControl('tree');\n        tree.setModel(value);\n        value.load(function () {\n          tree.setHideRoot(true);\n        }, this);\n      }\n    },\n\n    _applySelectedNode: function (value) {\n      const tree = this.getChildControl('tree');\n      const contextMenu = cv.ui.manager.contextmenu.GlobalFileItem.getInstance();\n      contextMenu.configure(value);\n      if (value) {\n        tree.setContextMenu(contextMenu);\n      }\n    },\n\n    setSelection : function (node) {\n      this.getChildControl('tree').getSelection().replace([node]);\n    },\n\n    _onDblTapTreeSelection: function () {\n      const sel = this.getSelectedNode();\n      if (sel) {\n        if (this.__selectionTimer) {\n          this.__selectionTimer.stop();\n        }\n        // only files show a different behaviour when double-clicked (permanent vs. preview mode)\n        if (sel.getType() === 'file') {\n          this.fireDataEvent('changeSelection', {\n            'node': sel,\n            'mode': 'dbltap'\n          });\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function () {\n      if (this.__selectionTimer) {\n        this.__selectionTimer.stop();\n      }\n      if (this.__ignoreSelectionChange === true) {\n        return;\n      }\n      const tree = this.getChildControl('tree');\n      const sel = tree.getSelection();\n      if (sel.length > 0) {\n        const node = sel.getItem(0);\n        this.setSelectedNode(node);\n        // wait for double tap\n        if (node.getType() === 'file') {\n          this.__selectionTimer = qx.event.Timer.once(function () {\n            this.fireDataEvent('changeSelection', {\n              'node': this.getSelectedNode(),\n              'mode': 'tap'\n            });\n            this.__selectionTimer = null;\n          }, this, this.__doubleTapWaitingTime);\n        } else {\n          this.fireDataEvent('changeSelection', {\n            'node': node,\n            'mode': 'tap'\n          });\n        }\n      } else {\n        tree.resetContextMenu();\n        this.resetSelectedNode();\n      }\n    },\n\n    _onFsItemRightClick: function (ev) {\n      const tree = this.getChildControl('tree');\n      const widget = ev.getTarget();\n      if (widget instanceof cv.ui.manager.tree.VirtualFsItem) {\n        const node = widget.getModel();\n        if (node) {\n          this.__ignoreSelectionChange = true;\n          tree.getSelection().replace([node]);\n          this.setSelectedNode(node);\n          this.fireDataEvent('changeSelection', {\n            'node': node,\n            'mode': 'contextmenu'\n          });\n          this.__ignoreSelectionChange = false;\n        }\n      }\n    },\n\n    /**\n     * Handle message on 'cv.manager.tree.enable' topic.\n     * @param ev {Event}\n     * @protected\n     */\n    _onEnableTree: function (ev) {\n      this.getChildControl('tree').setEnabled(ev.getData());\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'name', 'children');\n           control.set({\n             selectionMode: 'single',\n             minWidth: 250,\n             showTopLevelOpenCloseIcons: true\n           });\n           cv.ui.manager.model.Preferences.getInstance().bind('quickPreview', control, 'openMode', {\n             converter: function (value) {\n               return value ? 'tap' : 'dbltap';\n             }\n           });\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualFsItem();\n               item.addListener('dbltap', this._onDblTapTreeSelection, this);\n               item.addListener('contextmenu', this._onFsItemRightClick, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem : function(controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('readable', 'enabled', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('editing', 'editing', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this._add(control);\n           break;\n       }\n\n       if (!control) {\n         control = this._createMDragUploadChildControlImpl(id);\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.tree.enable', this._onEnableTree, this);\n\n    this._disposeObjects('_dateFormat', '_timeFormat', '_replacementManager');\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.ToolBar', {\n  extend: qx.ui.toolbar.ToolBar,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (uploadManager, showOnly) {\n    this.base(arguments);\n\n    if (showOnly) {\n      this.__showOnly = showOnly;\n    }\n\n    this._menuBar = cv.ui.manager.MenuBar.getInstance();\n    this._menuButtonConfig = this._menuBar.getButtonConfiguration();\n    this._uploadManager = uploadManager;\n\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'reload': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-toolbar'\n    },\n\n    folder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFolder',\n      event: 'changeFolder'\n    },\n\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFile',\n      event: 'changeFile'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _menuButtonConfig: null,\n    _uploadManager: null,\n    _menuBar: null,\n    __showOnly: null,\n\n    __show: function (name) {\n      return this.__showOnly === null || this.__showOnly.includes(name);\n    },\n\n    _init: function () {\n      if (!this._uploadManager) {\n        this._uploadManager = new cv.ui.manager.upload.UploadMgr();\n      }\n\n      const fileController = cv.ui.manager.control.FileController.getInstance();\n\n      const createPart = new qx.ui.toolbar.Part();\n      createPart.set({\n        marginLeft: 0\n      });\n      this.add(createPart);\n      let newButton;\n\n      if (this.__show('new-menu')) {\n        newButton = new qx.ui.toolbar.MenuButton(null,\n          cv.theme.dark.Images.getIcon('new-file', 15),\n          this._menuBar.getChildControl('new-menu')\n        );\n        this.bind('folder.writeable', newButton, 'enabled');\n        createPart.add(newButton);\n      } else {\n        if (this.__show('new-config-file')) {\n          newButton = this._createButton('new-config-file', cv.theme.dark.Images.getIcon('new-file', 15));\n          this.bind('folder.writeable', newButton, 'enabled');\n          this.bind('folder', newButton, 'visibility', {\n            converter: function (folder) {\n              return folder === cv.ui.manager.model.FileItem.ROOT ? 'visible' : 'excluded';\n            }\n          });\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-config-file', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        } else if (this.__show('new-file')) {\n          newButton = this._createButton('new-file', null, true);\n          this.bind('folder.writeable', newButton, 'enabled');\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-file', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        }\n        if (this.__show('new-folder')) {\n          newButton = this._createButton('new-folder', cv.theme.dark.Images.getIcon('new-folder', 15), true);\n          this.bind('folder.writeable', newButton, 'enabled');\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-folder', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        }\n      }\n\n      if (this.__show('upload')) {\n        const upload = this._createButton('upload');\n        this._uploadManager.addWidget(upload);\n        this.bind('folder.writeable', upload, 'enabled');\n        createPart.add(upload);\n      }\n\n      if (this.__show('delete')) {\n        const deleteSelection = this._createButton('delete');\n        deleteSelection.addListener('execute', function () {\n          fileController.delete(this.getFile());\n        }, this);\n        this.bind('file', deleteSelection, 'enabled', {\n          converter: function (file) {\n            return !!file && file.isWriteable() && !file.isFake();\n          }\n        });\n        this.add(deleteSelection);\n      }\n\n      if (this.__show('download')) {\n        const download = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('download', 15));\n        download.setAppearance('cv-toolbar-button');\n        download.setToolTipText(qx.locale.Manager.tr('Download'));\n        download.addListener('execute', function () {\n          fileController.download(this.getFile());\n        }, this);\n        // download button is only enabled when a file is selected\n        this.bind('file', download, 'enabled', {\n          converter: function (file) {\n            return !!file && file.getType() === 'file' && !file.isFake();\n          }\n        });\n        createPart.add(download);\n      }\n\n      if (this.__show('validate')) {\n        // config check\n        const checkConfig = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('validate', 15));\n        checkConfig.setAppearance('cv-toolbar-button');\n        checkConfig.setToolTipText(qx.locale.Manager.tr('Validate'));\n        checkConfig.addListener('execute', function () {\n          fileController.validate(this.getFile());\n        }, this);\n\n        // validate button is only enabled when a file is selected\n        this.bind('file', checkConfig, 'enabled', {\n          converter: function (file) {\n            return !!file && file.isConfigFile();\n          }\n        });\n        this.add(checkConfig);\n      }\n\n      if (this.__show('reload')) {\n        const reload = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 15));\n        reload.setAppearance('cv-toolbar-button');\n        reload.setToolTipText(qx.locale.Manager.tr('Reload'));\n        reload.addListener('execute', function () {\n          this.fireEvent('reload');\n        }, this);\n        this.add(new qx.ui.core.Spacer(), {flex: 1});\n        this.add(reload);\n      }\n    },\n\n    _createButton: function (name, icon, doNotUseCommand) {\n      const args = this._menuButtonConfig[name].args;\n      const button = new qx.ui.toolbar.Button(null, icon || args[1].replace(/\\/[0-9]+$/, '/15'), !doNotUseCommand ? args[2] : null);\n      button.setAppearance('cv-toolbar-button');\n      button.setToolTipText(args[0]);\n      return button;\n    },\n\n    _applyFile: function () {\n\n    },\n\n    _applyFolder: function (value) {\n      if (this._uploadManager) {\n        if (value) {\n          this._uploadManager.setFolder(value);\n        } else {\n          this._uploadManager.resetFolder();\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._menuButtonConfig = null;\n    this._uploadManager = null;\n    this.__menuBar = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.FileTabItem', {\n  extend: qx.ui.core.Widget,\n  implement : [qx.ui.form.IModel],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox());\n    this._createChildControl('icon');\n    this._createChildControl('label');\n    this._createChildControl('close');\n\n    this.addListener('pointerover', this._onPointerOver, this);\n    this.addListener('pointerout', this._onPointerOut, this);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'close': 'qx.event.type.Data',\n\n    /** (Fired by {@link qx.ui.form.List}) */\n    'action' : 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'open-file-item'\n    },\n\n    model: {\n      nullable: true,\n      event: 'changeModel',\n      apply: '_applyModel',\n      dereference: true\n    },\n\n    label: {\n      check: 'String',\n      nullable: true,\n      transform: '_transformFilename',\n      event: 'changeLabel',\n      apply: '_applyLabel'\n    },\n\n    icon: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyIcon'\n    },\n\n    permanent: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyPermanent'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyLabel'\n    },\n\n    closeable: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyCloseable'\n    },\n\n    writeable:{\n      check: 'Boolean',\n      init: true,\n      apply: '_applyLabel'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates :\n      {\n        focused : true,\n        hovered : true,\n        selected : true,\n        dragover : true\n      },\n\n\n    /**\n     * Event handler for the pointer over event.\n     */\n    _onPointerOver : function() {\n      this.addState('hovered');\n    },\n\n    _transformFilename: function(name) {\n      if (name === '.') {\n        return '';\n      }\n      return name;\n    },\n\n    /**\n     * Event handler for the pointer out event.\n     */\n    _onPointerOut : function() {\n      this.removeState('hovered');\n    },\n\n    _applyPermanent: function (value) {\n      this.setFont(value ? 'default' : 'italic');\n    },\n\n    _applyCloseable: function (value) {\n      this.getChildControl('close').setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    _applyModel: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('file.writeable', this, 'writeable');\n      }\n    },\n\n    _applyIcon: function (value) {\n      const control = this.getChildControl('icon');\n      control.setSource(value);\n      if (value) {\n        control.show();\n      } else {\n        control.exclude();\n      }\n    },\n\n    _applyLabel: function () {\n      const label = this.getChildControl('label');\n      const value = this.getLabel();\n      if (value) {\n        let labelValue = this.getLabel();\n        if (!this.isWriteable() && !this.getModel().getFile().isFake()) {\n          labelValue += ' !';\n          this.setToolTipText(this.tr('This file is not writeable'));\n        } else {\n          this.resetToolTipText();\n        }\n        if (this.isModified()) {\n          labelValue += ' *';\n        }\n        label.setValue(labelValue);\n        label.show();\n      } else {\n        label.exclude();\n        this.resetToolTipText();\n      }\n    },\n\n    _onClose: function () {\n      if (this.isCloseable()) {\n        this.fireDataEvent('close', this.getModel());\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new qx.ui.basic.Image();\n           control.setAppearance('open-file-item/icon');\n           control.setAnonymous(true);\n           control.exclude();\n           this._addAt(control, 0);\n           break;\n\n         case 'label':\n           control = new qx.ui.basic.Label();\n           control.setAppearance('open-file-item/label');\n           control.setAnonymous(true);\n           this._addAt(control, 1);\n           break;\n\n         case 'close':\n           control = new qx.ui.basic.Image('decoration/tabview/close.gif');\n           control.setAppearance('open-file-item/close');\n           if (this.isCloseable()) {\n             control.addListener('tap', this._onClose, this);\n           } else {\n             control.exclude();\n           }\n           this._addAt(control, 2);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.removeListener('pointerover', this._onPointerOver, this);\n    this.removeListener('pointerout', this._onPointerOut, this);\n  }\n});\n","/**\n * A dialog that alerts the user to something.\n *\n */\nqx.Class.define('cv.ui.manager.dialog.BigAlert', {\n  extend: qxl.dialog.Alert,\n  members: {\n    _hbox: null,\n\n    _applyImage: function(value, old) {\n      if (!this._image) {\n        this._image = new qx.ui.basic.Image().set({\n          scale: true,\n          height: 32,\n          width: 32\n        });\n        this._hbox.addAt(this._image, 0);\n      }\n      this._image.setSource(value);\n      this._image.setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    /**\n     * Create the main content of the widget\n     */\n    _createWidgetContent: function() {\n      let container = this._createDialogContainer();\n      this.add(container);\n      let hbox = this._hbox = new qx.ui.container.Composite(new qx.ui.layout.HBox(10));\n      let scroll = new qx.ui.container.Scroll(hbox);\n      scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      }, this);\n      container.add(scroll);\n      hbox.bind('width', scroll, 'width');\n      hbox.bind('height', scroll, 'height');\n      const image = this.getImage();\n      if (image) {\n        this._image = new qx.ui.basic.Image(image).set({\n          scale: true,\n          height: 32,\n          width: 32\n        });\n        hbox.add(this._image);\n      }\n      this._message = new qx.ui.basic.Label();\n      this._message.setRich(true);\n      this._message.setWidth(200);\n      this._message.setAllowStretchX(true);\n      hbox.addAt(this._message, 1, {\n        flex: 1\n      });\n      let buttonPane = this._createButtonPane();\n      let okButton = this._createOkButton();\n      buttonPane.add(okButton);\n      container.add(buttonPane);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_hbox');\n  }\n});\n","/**\n * Model for Messages shown in Snackbar/Dialog (usually error, warnings or info messages).\n */\nqx.Class.define('cv.ui.manager.model.Message', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    title: {\n      check: 'String',\n      init: '',\n      event: 'changeTitle'\n    },\n\n    content: {\n      check: 'String',\n      init: '',\n      event: 'changeContent'\n    },\n\n    type: {\n      check: ['alert', 'hint', 'warning', 'error'],\n      nullable: true,\n      event: 'changeType'\n    },\n\n    sticky: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeSticky'\n    }\n  }\n});\n","/**\n * View component that shows a snackbar message.\n */\nqx.Class.define('cv.ui.manager.snackbar.Message', {\n  extend: qx.ui.core.Widget,\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox(8));\n    this.addListener('appear', this._onAppear, this);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'close': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-snackbar-msg'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.Message',\n      nullable: true,\n      apply: '_applyModel'\n    },\n\n    timeout: {\n      check: 'Number',\n      init: 5000,\n      apply: '_applyTimeout'\n    },\n\n    type: {\n      check: ['alert', 'hint', 'warning', 'error'],\n      nullable: true,\n      apply: '_applyType'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _timer: null,\n\n    _applyModel: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n        old.removeRelatedBindings(this.getChildControl('content'));\n      }\n      if (value) {\n        value.bind('title', this.getChildControl('content'), 'value');\n        value.bind('type', this, 'type');\n        value.bind('sticky', this, 'timeout', {\n          converter: function (value) {\n            return value ? 0 : 5000;\n          }\n        });\n        this.getChildControl('close');\n      }\n    },\n\n    _applyType: function (value) {\n      if (value) {\n        this.setDecorator(this.getAppearance() + '-' + value);\n      } else {\n        this.setDecorator(this.getAppearance());\n      }\n    },\n\n    _applyTimeout: function (value) {\n      if (this._timer) {\n        this._timer.stop();\n        if (value === 0) {\n          this._timer = null;\n        }\n      }\n    },\n\n    _onAppear: function () {\n      const timeout = this.getTimeout();\n      if (this._timer) {\n        this._timer.stop();\n      }\n      if (timeout > 0) {\n        this._timer = qx.event.Timer.once(this.close, this, timeout);\n      }\n    },\n\n    close: function () {\n      this.fireDataEvent('close', this.getModel());\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new qx.ui.basic.Image();\n           this._addAt(control, 0);\n           break;\n\n         case 'content':\n           control = new qx.ui.basic.Label();\n           this._addAt(control, 1, {flex: 1});\n           break;\n\n         case 'close':\n           control = new qx.ui.basic.Image(cv.theme.dark.Images.getIcon('close', 15));\n           control.addListener('tap', this.close, this);\n           this._addAt(control, 2);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_timer');\n  }\n});\n","/**\n * Abstract base class for all widgets that can display file items.\n */\nqx.Class.define('cv.ui.manager.viewer.AbstractViewer', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFile',\n      event: 'changeFile'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    canHandleAction: function () {\n      return false;\n    },\n    handleAction: function () {},\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n    save: function () {},\n    getCurrentContent: function () {},\n\n    _applyFile: function (file, old) {\n      // show icon for file type\n    },\n\n    // overridden\n    _createChildControlImpl : function (id) {\n      let control;\n\n      switch (id) {\n        case 'scroll':\n          control = new qx.ui.container.Scroll();\n          this._add(control);\n          break;\n\n        case 'image':\n          control = new qx.ui.basic.Atom();\n          this.getChildControl('scroll').add(control);\n          control.getChildControl('icon').addListener('resize', this._scaleImage, this);\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  }\n});\n","// noinspection JSClosureCompilerSyntax\n/**\n * Show images.\n */\nqx.Class.define('cv.ui.manager.viewer.Image', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n\n  /*\n    ***********************************************\n      PROPERTIES\n    ***********************************************\n    */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'image-viewer'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: ['jpg', 'jpeg', 'png', 'gif', 'svg'],\n    TITLE: qx.locale.Manager.tr('Show image'),\n    ICON: cv.theme.dark.Images.getIcon('image', 18),\n\n    /**\n     * Returns size information for images\n     * @param source {String} path to image\n     * @returns {{width: *, aspectRatio: number, height: *}}\n     */\n    getImageData: function (source) {\n      let data = qx.util.ResourceManager.getInstance().getData(source);\n      if (data) {\n        return {\n          width: data[0],\n          height: data[1],\n          aspectRatio: data[0] / data[1]\n        };\n      } \n        data = qx.io.ImageLoader.getSize(source);\n        if (data && data.width && data.height) {\n          return Object.assign({\n            aspectRatio: data.width / data.height\n          }, data);\n        }\n      \n      return null;\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyFile: function (file) {\n      const control = this.getChildControl('image');\n      if (file) {\n        control.setIcon(file.getServerPath());\n        control.setLabel(file.getFullPath());\n        if (!cv.ui.manager.viewer.Image.getImageData(file.getServerPath())) {\n          control.getChildControl('icon').addListenerOnce('loaded', this._scaleImage, this);\n        } else {\n          this._scaleImage();\n        }\n        this.addListener('resize', this._scaleImage, this);\n      } else {\n        control.resetIcon();\n        control.resetLabel();\n        this.removeListener('resize', this._scaleImage, this);\n      }\n    },\n\n    _scaleImage: function () {\n      const bounds = this.getBounds();\n      if (!bounds) {\n        this.addListenerOnce('appear', this._scaleImage, this);\n        return;\n      }\n      const file = this.getFile();\n      if (!file) {\n        return;\n      }\n      const icon = this.getChildControl('image').getChildControl('icon');\n      const data = cv.ui.manager.viewer.Image.getImageData(file.getServerPath());\n      const paddingX = 10;\n      const paddingY = 20;\n      const availableHeight = bounds.height - paddingY * 2;\n      let width = bounds.width - paddingX * 2;\n      let height = Math.round(1 / data.aspectRatio * width);\n      if (height > availableHeight) {\n        height = availableHeight;\n        width = Math.round(data.aspectRatio * availableHeight);\n      }\n      icon.set({\n        width: width,\n        height: height,\n        scale: true\n      });\n    }\n  }\n});\n","/**\n * Show rendered configs.\n */\nqx.Class.define('cv.ui.manager.viewer.Config', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n  },\n\n  /*\n    ***********************************************\n      PROPERTIES\n    ***********************************************\n    */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'config-viewer'\n    },\n\n    target: {\n      check: ['iframe', 'window'],\n      init: 'window'\n    },\n\n    external: {\n      refine: true,\n      init: true\n    },\n\n    connectToWindow: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyConnectToWindow'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Config viewer'),\n    ICON: cv.theme.dark.Images.getIcon('preview', 18)\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _windowRef: null,\n    _source: null,\n    _reloading: false,\n\n    _applyConnectToWindow: function (value) {\n      this.setExternal(!value);\n    },\n\n    _applyFile: function (file, old) {\n      if (old && old.isConfigFile()) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (file) {\n        if (file.isConfigFile()) {\n          const configName = cv.ui.manager.model.FileItem.getConfigName(file.getFullPath());\n          let url = qx.util.Uri.getAbsolute(qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/..') + '?config=' + (configName || '');\n          if (this.getTarget() === 'iframe') {\n            url += '&preview=1&libraryCheck=false';\n            const control = this.getChildControl('iframe');\n            this._source = url;\n            this.getChildControl('loading').show();\n            control.setSource(url);\n            control.show();\n            const hint = this.getChildControl('hint', true);\n            if (hint && hint.isVisible()) {\n              hint.exclude();\n            }\n          } else {\n            this._source = url;\n            let ref = window.open(url, configName);\n            if (this.isConnectToWindow()) {\n              this._windowRef = ref;\n              this._windowRef.onbeforeunload = this._onClose.bind(this);\n              const hint = this.getChildControl('hint');\n              hint.show();\n              const iframe = this.getChildControl('iframe', true);\n              if (iframe && iframe.isVisible()) {\n                iframe.exclude();\n              }\n            } else {\n              // no connection close this immediately\n              this._onClose();\n              return;\n            }\n          }\n          qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n        } else {\n          cv.ui.manager.snackbar.Controller.error(this.tr('%1 is no configuration file', file.getFullPath()));\n          this._source = null;\n        }\n      } else {\n        if (this.hasChildControl('iframe')) {\n          this.getChildControl('iframe').resetSource();\n          this.getChildControl('iframe').exclude();\n        }\n        if (this.hasChildControl('hint')) {\n          this.getChildControl('hint').exclude();\n        }\n        if (this._windowRef) {\n          this._windowRef.close();\n        }\n      }\n    },\n\n    _onChange: function (ev) {\n      const data = ev.getData();\n      if (data.type === 'contentChanged') {\n        if (this.hasChildControl('iframe')) {\n          const iframe = this.getChildControl('iframe');\n          const href = iframe.getDocument().location.href;\n          // use href to get the anchor to keep the currently opened page on reload\n          const url = href.startsWith(this._source) ? iframe.getDocument().location.href : this._source;\n          if (url && url !== 'about:blank') {\n            this._reloading = true;\n            this.getChildControl('loading').show();\n            iframe.addListenerOnce('load', () => {\n              this._reloading = false;\n              iframe.setSource(url);\n            }, this);\n          }\n          iframe.setSource('about:blank');\n        } else if (this._windowRef) {\n          this._windowRef.reload();\n        }\n      }\n    },\n\n    _onClose: function () {\n      if (this._windowRef) {\n        qx.event.message.Bus.dispatchByName('cv.manager.action.close', this.getFile());\n        this._windowRef = null;\n      }\n      this.resetFile();\n    },\n\n    openPage: function (page, path) {\n      if (this.hasChildControl('iframe')) {\n        const element = this.getChildControl('iframe').getContentElement().getDomElement();\n        if (element && element.contentWindow.cv) {\n          const otherEngine = element.contentWindow.cv.TemplateEngine.getInstance();\n          const pageId = path ? otherEngine.getPageIdByPath(page, path) : page;\n          otherEngine.scrollToPage(pageId, 0);\n        }\n      }\n    },\n\n    setHighlightWidget: function (widgetId) {\n      if (this.hasChildControl('iframe')) {\n        const element = this.getChildControl('iframe').getContentElement().getDomElement();\n        if (element && element.contentWindow.cv) {\n          const otherEngine = element.contentWindow.cv.TemplateEngine.getInstance();\n          otherEngine.setHighlightedWidget(widgetId);\n        }\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'iframe':\n           control = new qx.ui.embed.Iframe();\n           control.exclude();\n           control.addListener('load', () => {\n             if (this.hasChildControl('loading') && !this._reloading) {\n               this.getChildControl('loading').exclude();\n             }\n           }, this);\n           this.getChildControl('scroll').add(control);\n           break;\n\n         case 'hint':\n           control = new qx.ui.basic.Atom(this.tr('This configuration has been opened in another window. When you close this file, the window will also be closed. Click here top jump the the window.'));\n           control.set({\n             center: true,\n             font: 'title'\n           });\n           control.addListener('tap', function () {\n             if (this._windowRef) {\n               this._windowRef.focus();\n             }\n           }, this);\n           this.getChildControl('scroll').add(control);\n           break;\n\n         case 'loading':\n           control = new qx.ui.basic.Atom(this.tr('Loading...'), cv.theme.dark.Images.getIcon('reload', 64));\n           control.set({\n             center: true,\n             font: 'title',\n             iconPosition: 'top',\n             backgroundColor: 'rgba(0,0,0,0.2)'\n           });\n           control.addListener('appear', () => {\n             qx.event.Timer.once(() => {\n               control.exclude();\n             }, this, 5000);\n           });\n           control.exclude();\n           this._add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._windowRef = null;\n  }\n});\n","/**\n * Displays folder content in an explorer like view.\n */\nqx.Class.define('cv.ui.manager.viewer.Folder', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n  implement: [\n    qx.ui.core.IMultiSelection,\n    qx.ui.form.IModelSelection\n  ],\n  include: [\n    qx.ui.core.MMultiSelectionHandling,\n    qx.ui.core.MRemoteChildrenHandling,\n    qx.ui.form.MModelSelection,\n    cv.ui.manager.control.MFileEventHandler\n  ],\n\n  /*\n ***********************************************\n   CONSTRUCTOR\n ***********************************************\n */\n  construct: function (noToolbar) {\n    this.base(arguments);\n    cv.ui.manager.model.Preferences.getInstance().bind('startViewMode', this, 'viewMode');\n    this._isImageRegex = new RegExp('\\\\.(' + cv.ui.manager.viewer.Image.SUPPORTED_FILES.join('|') + ')$', 'i');\n    this.initModel(new qx.data.Array());\n    this._setLayout(new qx.ui.layout.VBox(8));\n\n    this._newItem = new cv.ui.manager.model.FileItem('new', 'new', null).set({\n      fake: true,\n      type: 'file',\n      loaded: true,\n      icon: cv.theme.dark.Images.getIcon('upload'),\n      displayName: this.tr('Upload file'),\n      special: 'add-file'\n    });\n\n    this._debouncedOnFilter = qx.util.Function.debounce(this._onFilter, 500, false);\n    if (!noToolbar) {\n      this._createChildControl('toolbar');\n    }\n    this._createChildControl('filter');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: function isDir(item) {\n      // noinspection JSConstructorReturnsPrimitive\n      return item.getType() === 'dir';\n    },\n    TITLE: qx.locale.Manager.tr('Show folder'),\n    ICON: cv.theme.dark.Images.getIcon('folder', 18)\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /**\n     * This event is fired after a list item was added to the list. The\n     * {@link qx.event.type.Data#getData} method of the event returns the\n     * added item.\n     */\n    addItem : 'qx.event.type.Data',\n\n    /**\n     * This event is fired after a list item has been removed from the list.\n     * The {@link qx.event.type.Data#getData} method of the event returns the\n     * removed item.\n     */\n    removeItem : 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    model: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    permanentFilter: {\n      check: 'Function',\n      nullable: true,\n      apply: '_onFilter'\n    },\n\n    showTextFilter: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowTextFilter'\n    },\n\n    labelConverter: {\n      check: 'Function',\n      nullable: true\n    },\n\n    disableScrolling: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDisableScrolling'\n    },\n\n    viewMode: {\n      check: ['list', 'preview'],\n      init: 'list',\n      event: 'changeViewMode'\n    }\n  },\n\n  /*\n ***********************************************\n   MEMBERS\n ***********************************************\n */\n  members: {\n    _controller: null,\n    _isImageRegex: null,\n    _newItem: null,\n\n    /** @type {Class} Pointer to the selection manager to use */\n    SELECTION_MANAGER : qx.ui.core.selection.ScrollArea,\n\n    _defaultLabelConverter: function (name) {\n      if (this.getViewMode() === 'list') {\n        // do not remove file type in list mode\n        return name;\n      }\n      const parts = name.split('.');\n      if (parts.length > 1) {\n        parts.pop();\n      }\n      return parts.join('.');\n    },\n\n    _getDelegate: function () {\n      const labelConverter = this.getLabelConverter();\n      const converter = {\n        converter: labelConverter ? labelConverter : this._defaultLabelConverter.bind(this)\n      };\n      return {\n        createItem: function () {\n          return new cv.ui.manager.form.FileListItem();\n        },\n\n        configureItem: function (item) {\n          item.addListener('dbltap', this._onDblTap, this);\n          item.addListener('contextmenu', this._onFsItemRightClick, this);\n          item.addListener('action', this._onFsItemRightClick, this);\n          item.setShowFileActions(true);\n          this.bind('viewMode', item, 'viewMode');\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n          controller.bindProperty('displayName', 'label', converter, item, index);\n          controller.bindProperty('icon', 'icon', {\n            converter: function (source, file) {\n              if (file.getType() === 'file' && this._isImageRegex.test(file.getName())) {\n                // use the image as icon\n                return file.getServerPath();\n              } \n                if (!source) {\n                  return null;\n                }\n                // remove size from icon source\n              const parts = source.split('/');\n              if (parts.length === 3) {\n                  parts.pop();\n                }\n                return parts.join('/');\n            }.bind(this)\n          }, item, index);\n        }.bind(this)\n      };\n    },\n\n    _onFsItemRightClick: function (ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        ev.preventDefault();\n        if (ev.getBubbles()) {\n          ev.stopPropagation();\n        }\n        return;\n      }\n      const menu = cv.ui.manager.contextmenu.GlobalFileItem.getInstance();\n      menu.configure(file);\n      ev.getCurrentTarget().setContextMenu(menu);\n      menu.openAtPointer(ev);\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onDblTap: function (ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        // Select file for upload\n\n      } else {\n        qx.event.message.Bus.dispatchByName('cv.manager.open', file);\n      }\n    },\n\n    _applyFile: function (file, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n        this.resetModel();\n      }\n      if (file) {\n        const container = this.getChildControl('list');\n        if (!this._controller) {\n          this._controller = new qx.data.controller.List(null, container);\n          this._controller.setDelegate(this._getDelegate());\n        }\n        file.bind('children', this, 'model');\n        const model = this.getModel();\n        this._newItem.setParent(file);\n        model.addListener('change', function () {\n          if (this.getChildControl('filter').getValue() || this.getPermanentFilter()) {\n            this._onFilter();\n          } else {\n            this._controller.setModel(model);\n          }\n        }, this);\n        this._controller.setModel(model);\n        file.load();\n      } else {\n        if (this._controller) {\n          this._controller.resetModel();\n        }\n        this._newItem.resetParent();\n      }\n    },\n\n    _handleFileEvent: function (ev) {\n      const folder = this.getFile();\n      const data = ev.getData();\n      switch (data.action) {\n        case 'moved':\n          folder.reload();\n          break;\n\n        case 'added':\n        case 'uploaded':\n        case 'created':\n          if (data.path.startsWith(folder.getFullPath())) {\n            folder.reload();\n          }\n          break;\n\n        case 'deleted': {\n          let children;\n          if (folder) {\n            if (data.path === folder.getFullPath()) {\n              // this item has been deleted\n              this.dispose();\n            } else if (data.path.startsWith(folder.getFullPath())) {\n              // delete child\n              children = folder.getChildren();\n              children.some(function (child) {\n                if (child.getFullPath() === data.path) {\n                  children.remove(child);\n                  this.removeRelatedBindings(child);\n                  return true;\n                }\n                return false;\n              }, this);\n            }\n          }\n          children = this.getModel();\n          children.some(function (child) {\n            if (child.getFullPath() === data.path) {\n              children.remove(child);\n              this.removeRelatedBindings(child);\n              return true;\n            }\n            return false;\n          }, this);\n          break;\n        }\n      }\n    },\n\n    _applyShowTextFilter: function (value) {\n      this.getChildControl('filter').setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    _onFilter: function () {\n      if (this._controller) {\n        const filterString = this.getChildControl('filter').getValue();\n        const filterFunction = this.getPermanentFilter();\n        const filtered = this.getModel().filter(function (file) {\n          return (!filterFunction || filterFunction(file)) && (!filterString || file.getName().includes(filterString));\n        });\n        this._controller.setModel(filtered);\n      }\n    },\n\n    getChildrenContainer: function () {\n      return this.getChildControl('list');\n    },\n\n    /**\n     * Handle child widget adds on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onAddChild : function(e) {\n      this.fireDataEvent('addItem', e.getData());\n    },\n\n    /**\n     * Handle child widget removes on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onRemoveChild : function(e) {\n      this.fireDataEvent('removeItem', e.getData());\n    },\n\n    _onFileEvent: function (ev) {\n      const data = ev.getData();\n      switch (data.action) {\n        case 'deleted':\n          break;\n      }\n    },\n\n    _applyDisableScrolling: function (value) {\n      if (value) {\n        this.getChildControl('scroll').exclude();\n        this._addAt(this.getChildControl('list'), 1, {flex: 1});\n      } else {\n        const scrollContainer = this.getChildControl('scroll');\n        scrollContainer.show();\n        scrollContainer.add(this.getChildControl('list'));\n        this._addAt(scrollContainer, 1, {flex: 1});\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n        case 'toolbar':\n          control = new cv.ui.manager.ToolBar(null, ['new-file', 'new-folder', 'upload', 'reload']);\n          this.bind('file', control, 'folder');\n          control.addListener('reload', function () {\n            this.getFile().reload();\n          }, this);\n          this._addAt(control, 0);\n          break;\n\n        case 'filter':\n          control = new qx.ui.form.TextField();\n          control.set({\n            placeholder: this.tr('Filter by name...'),\n            liveUpdate: true,\n            margin: 8\n          });\n          if (!this.isShowTextFilter()) {\n            control.exclude();\n          }\n          control.addListener('changeValue', this._debouncedOnFilter, this);\n          this._addAt(control, 1);\n          break;\n\n        case 'scroll':\n          control = new qx.ui.container.Scroll();\n          this._addAt(control, 2, {flex: 1});\n          break;\n\n        case 'list':\n          control = new qx.ui.container.Composite(new qx.ui.layout.Flow(8, 8));\n\n          // Used to fire item add/remove events\n          control.addListener('addChildWidget', this._onAddChild, this);\n          control.addListener('removeChildWidget', this._onRemoveChild, this);\n          if (this.isDisableScrolling()) {\n            this._addAt(control, 1, {flex: 1});\n          } else {\n            this.getChildControl('scroll').add(control);\n          }\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_controller');\n    this._isImageRegex = null;\n    cv.ui.manager.model.Preferences.getInstance().removeRelatedBindings(this);\n  }\n});\n","/**\n * Shows the available icons.\n */\nqx.Class.define('cv.ui.manager.viewer.Icons', {\n  extend: cv.ui.manager.viewer.Folder,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this._disableFileEvents = true;\n    this.base(arguments, true);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^CometVisu-Icons$/i,\n    TITLE: qx.locale.Manager.tr('Show icons'),\n    ICON: cv.theme.dark.Images.getIcon('icons', 18)\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _getDelegate: function () {\n      return {\n        createItem: function () {\n          return new cv.ui.manager.core.IconAtom();\n        },\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'label', null, item, index);\n        }\n      };\n    },\n\n    _onFilter: function () {\n      const filterString = this.getChildControl('filter').getValue();\n      const filtered = this.getModel().filter(function (name) {\n        return name.includes(filterString);\n      });\n      this._controller.setModel(filtered);\n    },\n\n    _applyFile: function(file, old) {\n      if (file) {\n        const container = this.getChildControl('list');\n        if (!this._controller) {\n          this._controller = new qx.data.controller.List(null, container);\n          this._controller.setDelegate(this._getDelegate());\n        }\n        const model = this.getModel();\n        // as the file is just a fake file, we do not really care about it\n        Object.keys(cv.IconConfig.DB).filter(function (name) {\n          const entry = cv.IconConfig.DB[name];\n          return entry['*'] && entry['*']['*'] && qx.lang.Type.isFunction(entry['*']['*']['*']);\n        }).forEach(function (name) {\n          model.push(name);\n        }, this);\n        if (this.getChildControl('filter').getValue() || this.getPermanentFilter()) {\n          this._onFilter();\n        } else {\n          this._controller.setModel(model);\n        }\n      } else if (this._controller) {\n          this._controller.resetModel();\n        }\n    }\n  }\n});\n","/**\n * Simple view that provides all of the file-related features of the old editor in an easy to use way.\n */\nqx.Class.define('cv.ui.manager.Start', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.VBox());\n    this._configRegex = /^visu_config_?([^.]+)?\\.xml$/;\n    [ 'toolbar', 'configs-title', 'configs-toolbar', 'configs',\n      'demo-configs-title', 'demo-configs',\n      'media-title', 'media-toolbar', 'media',\n      'misc-title', 'misc'\n    ].forEach(this._createChildControl, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_loadRoot',\n      event: 'changeFile'\n    },\n    appearance: {\n      refine: true,\n      init: 'cv-start'\n    },\n\n    selectedItem: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applySelectedItem'\n    },\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _configRegex: null,\n    _ignoreSelectionChanges: false,\n    _previewButton: null,\n    _listButton: null,\n    _radioGroup: null,\n\n    save: function () {},\n    getCurrentContent: function () {},\n    canHandleAction: function () {\n      return false;\n    },\n    handleAction: function () {},\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _loadRoot: function (value) {\n      this.getChildControl('configs').setFile(value);\n      let found = 0;\n\n      value.load(function () {\n        value.getChildren().some(function (file) {\n          if (file.getName() === 'media') {\n            this.getChildControl('media').setFile(file);\n            this.getChildControl('media-toolbar').setFolder(file);\n            found++;\n          } else if (file.getName() === 'demo') {\n            this.getChildControl('demo-configs').setFile(file);\n            found++;\n          }\n          return found === 2;\n        }, this);\n      }, this);\n    },\n\n    _onChangeSelection: function (ev) {\n      if (this._ignoreSelectionChanges === false) {\n        const list = ev.getTarget();\n        const selection = ev.getData();\n        this._ignoreSelectionChanges = true;\n\n        // unselect the other lists\n        ['configs', 'demo-configs', 'media'].forEach(function (name) {\n          const control = this.getChildControl(name);\n          if (control !== list) {\n            control.resetSelection();\n          }\n        }, this);\n        this._ignoreSelectionChanges = false;\n        if (selection.length > 0) {\n          this.setSelectedItem(selection[0].getModel());\n        }\n      }\n    },\n\n    _applySelectedItem: function () {\n    },\n\n    _onToggleExpand: function (ev) {\n      const control = this.getChildControl(ev.getTarget().getUserData('control'));\n      if (control.getVisibility() === 'visible') {\n        control.exclude();\n        ev.getTarget().setIcon(cv.theme.dark.Images.getIcon('drop-down', 18));\n      } else {\n        control.show();\n        ev.getTarget().setIcon(cv.theme.dark.Images.getIcon('drop-up', 18));\n      }\n    },\n\n    _onChangeViewMode: function () {\n      switch (cv.ui.manager.model.Preferences.getInstance().getStartViewMode()) {\n        case 'list':\n          this._radioGroup.setSelection([this._listButton]);\n          break;\n\n        case 'preview':\n          this._radioGroup.setSelection([this._previewButton]);\n          break;\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'scroll-container':\n           control = new qx.ui.container.Scroll();\n           this._add(control, {flex: 1});\n           break;\n\n         case 'content':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox(8));\n           this.getChildControl('scroll-container').add(control);\n           break;\n\n         case 'toolbar': {\n           control = new qx.ui.toolbar.ToolBar();\n           const part = new qx.ui.toolbar.Part();\n           const listButton = this._listButton = new qx.ui.toolbar.RadioButton('', cv.theme.dark.Images.getIcon('listViewMode', 22));\n           listButton.setUserData('mode', 'list');\n           listButton.set({\n             show: 'icon',\n             toolTipText: this.tr('List mode')\n           });\n           const previewButton = this._previewButton = new qx.ui.toolbar.RadioButton('', cv.theme.dark.Images.getIcon('previewMode', 22));\n           previewButton.setUserData('mode', 'preview');\n           previewButton.set({\n             show: 'icon',\n             toolTipText: this.tr('Preview mode')\n           });\n           part.add(listButton);\n           part.add(previewButton);\n           control.add(part);\n           this._radioGroup = new qx.ui.form.RadioGroup(listButton, previewButton);\n           this._onChangeViewMode();\n           this._radioGroup.addListener('changeSelection', function (ev) {\n             const selection = ev.getData()[0];\n             cv.ui.manager.model.Preferences.getInstance().setStartViewMode(selection.getUserData('mode'));\n           }, this);\n           cv.ui.manager.model.Preferences.getInstance().addListener('changeStartViewMode', this._onChangeViewMode, this);\n\n           this._add(control);\n           break;\n         }\n\n         case 'configs-title':\n           control = new qx.ui.basic.Atom(this.tr('Configurations'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'configs');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('configs-header').add(control);\n           break;\n\n         case 'configs-header':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           control.getContentElement().setAttribute('data-section', 'configs');\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'configs-toolbar':\n           control = new cv.ui.manager.ToolBar(null, ['new-config-file', 'upload', 'reload']);\n           control.setFolder(cv.ui.manager.model.FileItem.ROOT);\n           control.addListener('reload', function () {\n             cv.ui.manager.model.FileItem.ROOT.reload();\n           }, this);\n           this.getChildControl('configs-header').add(control);\n           break;\n\n         case 'configs':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             permanentFilter: function (file) {\n               const match = this._configRegex.exec(file.getName());\n               return !!match && (!match[1] || !match[1].endsWith('temp'));\n             }.bind(this),\n             labelConverter: function (name, file) {\n               if (file.isFake()) {\n                 return name;\n               }\n               const configName = cv.ui.manager.model.FileItem.getConfigName(name);\n               return configName ? configName : '<Default>';\n             },\n             file: cv.ui.manager.model.FileItem.ROOT,\n             disableScrolling: true\n           });\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'demo-configs-title':\n           control = new qx.ui.basic.Atom(this.tr('Demo configurations'), cv.theme.dark.Images.getIcon('drop-down', 18));\n           control.setUserData('control', 'demo-configs');\n           control.getContentElement().setAttribute('data-section', 'demo');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'demo-configs':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             permanentFilter: function (file) {\n               return this._configRegex.test(file.getName());\n             }.bind(this),\n             labelConverter: function (name) {\n               const configName = cv.ui.manager.model.FileItem.getConfigName(name);\n               return configName ? configName : '<Default>';\n             },\n             disableScrolling: true\n           });\n           control.exclude();\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'media-title':\n           control = new qx.ui.basic.Atom(this.tr('Media files'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'media');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('media-header').add(control);\n           break;\n\n         case 'media-header':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           control.getContentElement().setAttribute('data-section', 'media');\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'media-toolbar':\n           control = new cv.ui.manager.ToolBar(null, ['new-file', 'upload', 'reload']);\n           control.addListener('reload', function () {\n             control.getFolder().reload();\n           }, this);\n           this.getChildControl('media-header').add(control);\n           break;\n\n         case 'media':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             disableScrolling: true\n           });\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'misc-title':\n           control = new qx.ui.basic.Atom(this.tr('Miscellaneous'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'misc');\n           control.getContentElement().setAttribute('data-section', 'misc');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'misc':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             disableScrolling: true\n           });\n           this.__initMiscFolder(control);\n           this.getChildControl('content').add(control, {flex: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    __initMiscFolder: function (folderWidget) {\n      if (!cv.ui.manager.model.FileItem.ROOT.isLoaded()) {\n        cv.ui.manager.model.FileItem.ROOT.addListenerOnce('changeLoaded', function () {\n          this.__initMiscFolder(folderWidget);\n        }, this);\n        return;\n      }\n      // find the real 'hidden.php' in the root folder\n      const specialFiles = [cv.ui.manager.model.FileItem.getIconFile()];\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(function (file) {\n        if (file.getFullPath() === 'hidden.php') {\n          // set some special flags needed to configure the special hidden configuration file\n          file.set({\n            overrideIcon: true,\n            icon: cv.theme.dark.Images.getIcon('hidden-config', 15),\n            displayName: qx.locale.Manager.tr('Hidden configuration'),\n            fake: true\n          });\n          specialFiles.unshift(file);\n          return true;\n        }\n        return false;\n      });\n      const fakeFolder = new cv.ui.manager.model.FileItem('fake', 'fake', cv.ui.manager.model.FileItem.ROOT, specialFiles).set({\n        fake: true,\n        type: 'dir',\n        loaded: true\n      });\n      folderWidget.setFile(fakeFolder);\n      folderWidget.addListener('changeSelection', this._onChangeSelection, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._configRegex = null;\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeStartViewMode', this._onChangeViewMode, this);\n    this._disposeObjects('_previewButton', '_listButton', '_radioGroup');\n  }\n});\n","/**\n * Monaco Texteditor integration\n */\nqx.Class.define('cv.ui.manager.editor.Source', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo'];\n    this._basePath = window.location.origin + window.location.pathname + qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/config/';\n    this.getContentElement().setAttribute('contentEditable', 'true');\n    this.set({\n      droppable: false,\n      focusable: true\n    });\n    this.addListener('dragover', function (ev) {\n      ev.preventDefault();\n      ev.dataTransfer.effectAllowed = 'none';\n      ev.dataTransfer.dropEffect = 'none';\n    });\n    this.addListener('drop', function (ev) {\n      ev.preventDefault();\n    });\n    this.addListener('appear', function () {\n      qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(false);\n    });\n    this.addListener('disappear', function () {\n      qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(true);\n    });\n    this._draw();\n    this._initWorker();\n    this._currentDecorations = [];\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: qx.locale.Manager.tr('Texteditor'),\n    COUNTER: 0,\n    MONACO_EXTENSION_REGEX: null,\n    SUPPORTED_FILES: function (file) {\n      let filename = typeof file === 'string' ? file : file.getFullPath().toLowerCase();\n      if (window.monaco && window.monaco.languages) {\n        if (!cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX) {\n          // monaco has already been loaded, we can use its languages configuration to check if this file is supported\n          const extensions = [];\n          monaco.languages.getLanguages().forEach(function (lang) {\n            lang.extensions.forEach(function (ext) {\n              ext = ext.replace(/\\./g, '\\\\.');\n              if (extensions.indexOf(ext) ===-1) {\n                extensions.push(ext);\n              }\n            });\n          });\n          cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX = new RegExp('(' + extensions.join('|') + ')$');\n        }\n        return cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX.test(filename);\n      } \n        return /\\.(xml|html|php|css|js|svg|json|md|yaml|conf|ts|rst|py|txt)$/i.test(filename);\n    },\n    DEFAULT_FOR: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    ICON: cv.theme.dark.Images.getIcon('text', 18),\n\n    load: function (callback, context) {\n      const version = qx.core.Environment.get('qx.debug') ? 'dev' : 'min';\n      const sourcePath = qx.util.Uri.getAbsolute(qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/..');\n      const loader = new qx.util.DynamicScriptLoader([\n        sourcePath + 'node_modules/monaco-editor/' + version + '/vs/loader.js',\n        'manager/xml.js'\n      ]);\n      loader.addListener('ready', function () {\n        window.require.config({\n          paths: {\n            'vs': sourcePath + 'node_modules/monaco-editor/' + version + '/vs'\n          }\n        });\n        window.require.config({\n          'vs/nls' : {\n            availableLanguages: {\n              '*': qx.locale.Manager.getInstance().getLanguage() !== 'en' ? qx.locale.Manager.getInstance().getLanguage() : ''\n            }\n          }\n        });\n        const noCacheSuffix = '?' + Math.random();\n        window.require([\n          'xml!./resource/visu_config.xsd' + noCacheSuffix,\n          'xml!*./resource/manager/completion-libs/qooxdoo.d.ts', // the xml loader can load any file by adding * before the path,\n          'vs/editor/editor.main'\n        ], function (schema, qxLib) {\n          this.__schema = schema;\n          callback.apply(context);\n          window.monaco.languages.typescript.javascriptDefaults.addExtraLib(qxLib, 'qooxdoo.d.ts');\n          const completionProvider = new cv.ui.manager.editor.completion.Config(cv.ui.manager.model.Schema.getInstance('visu_config.xsd'));\n          const cvCompletionProvider = new cv.ui.manager.editor.completion.CometVisu();\n          window.monaco.languages.registerCompletionItemProvider('xml', completionProvider.getProvider());\n          window.monaco.languages.registerCompletionItemProvider('javascript', cvCompletionProvider.getProvider());\n        }.bind(this));\n      }, this);\n      loader.addListener('failed', function (ev) {\n        qx.log.Logger.error(this, ev.getData());\n      }, this);\n      loader.start();\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __schema: null,\n    _editor: null,\n    _basePath: null,\n    _workerWrapper: null,\n    _currentDecorations: null,\n    _configClient: null,\n    _onDidChangeContentGuard: 0,\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n      this._workerWrapper.setEditor(this);\n    },\n\n    _getDefaultModelOptions: function () {\n      return {\n        tabSize: 2,\n        indentSize: 2,\n        insertSpaces: true\n      };\n    },\n\n    _draw: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._draw, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', this._draw, this);\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: true\n            },\n            theme: 'vs-dark'\n          });\n          const baseVersion = cv.Version.VERSION.split('-')[0];\n          const xhr = new qx.io.request.Xhr(qx.util.ResourceManager.getInstance().toUri('hidden-schema.json'));\n          xhr.set({\n            method: 'GET',\n            accept: 'application/json'\n          });\n          xhr.addListenerOnce('success', function (e) {\n            const req = e.getTarget();\n            const schema = req.getResponse();\n            window.monaco.languages.json.jsonDefaults.setDiagnosticsOptions({\n              validate: true,\n              allowComments: true,\n              schemas: [{\n                uri: 'https://www.cometvisu.org/CometVisu/schemas/' + baseVersion + '/hidden-schema.json',\n                fileMatch: ['hidden.php'],\n                schema: schema\n              }]\n            });\n          }, this);\n          xhr.send();\n\n          if (this.getFile()) {\n            this._loadFile(this.getFile());\n          }\n          this._editor.onDidChangeModelContent(this._onContentChanged.bind(this));\n        }\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'cut':\n            this._editor.trigger('external', 'editor.action.clipboardCutAction');\n            if (!this._nativePasteSupported) {\n              // we have no access to the native clipboard for pasting, so we need to save the value to copy somewhere else\n              // and implement the pasting manually\n              cv.ui.manager.editor.AbstractEditor.CLIPBOARD = this._editor.getModel().getValueInRange(this._editor.getSelection());\n            }\n            break;\n          case 'copy':\n            this._editor.trigger('external', 'editor.action.clipboardCopyAction');\n            if (!this._nativePasteSupported) {\n              // we have no access to the native clipboard for pasting, so we need to save the value to copy somewhere else\n              // and implement the pasting manually\n              cv.ui.manager.editor.AbstractEditor.CLIPBOARD = this._editor.getModel().getValueInRange(this._editor.getSelection());\n            }\n            break;\n          case 'paste':\n            if (this._nativePasteSupported) {\n              this._editor.trigger('external', 'editor.action.clipboardPasteAction');\n            } else {\n              this._paste();\n            }\n            break;\n          case 'undo':\n          case 'redo':\n            this._editor.trigger('external', actionName);\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    /**\n     * Manual paste into source editor is used when the native paste is not supported by the browser.\n     * This is the case when the cometvisu is not running is a safe environment (no https / localhost)\n     * @private\n     */\n    _paste: function () {\n      if (cv.ui.manager.editor.AbstractEditor.CLIPBOARD) {\n        const selection = this._editor.getSelection();\n        const id = {major: 1, minor: 1};\n        const op = {\n          identifier: id,\n          range: selection,\n          text: cv.ui.manager.editor.AbstractEditor.CLIPBOARD,\n          forceMoveMarkers: true\n        };\n        this._editor.executeEdits('clipboard', [op]);\n      }\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (this._editor) {\n        if (file && file.getType() === 'file' && this.isSupported(file)) {\n          this.base(arguments, file, old);\n        } else {\n          this.base(arguments, null, old);\n        }\n      }\n    },\n\n    _loadFromFs: function () {\n      if (this.getFile().getName() === 'hidden.php') {\n        if (!this._configClient) {\n          this._configClient = cv.io.rest.Client.getConfigClient();\n          this._configClient.addListener('getSuccess', function (ev) {\n            this.setContent(JSON.stringify(ev.getData(), null, 2));\n          }, this);\n          this._configClient.addListener('updateSuccess', this._onSaved, this);\n        }\n        this._configClient.get({section: '*', key: '*'});\n      } else {\n        this.base(arguments);\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      if (this.getFile().getName() === 'hidden.php') {\n        if (!this.getFile().isValid()) {\n          cv.ui.manager.snackbar.Controller.error(this.tr('Hidden config is invalid, please correct the errors'));\n        } else if (this.getFile().getHasWarnings()) {\n          // ask user if he really want to save a file with warnings\n          qxl.dialog.Dialog.confirm(this.tr('Hidden config content has some warnings! It is recommended to fix the warnings before saving. Save anyways?'), function (confirmed) {\n            if (confirmed) {\n              this.__saveHiddenConfig();\n            }\n          }, this, qx.locale.Manager.tr('Confirm saving with warnings'));\n        } else {\n          this.__saveHiddenConfig();\n        }\n      } else {\n        this.base(arguments, callback, overrideHash);\n      }\n    },\n\n    __saveHiddenConfig: function () {\n      this._configClient.saveSync(null, JSON.parse(this.getCurrentContent()), function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(this.tr('Saving hidden config failed with error %1 (%2)', err.status, err.statusText));\n        } else {\n          cv.ui.manager.snackbar.Controller.info(this.tr('Hidden config has been saved'));\n          this._onSaved();\n        }\n      }, this);\n    },\n\n    _applyContent: function(value) {\n      const file = this.getFile();\n      if (!file) {\n        return;\n      }\n      const model = this._editor.getModel();\n      if (this._workerWrapper) {\n        this._workerWrapper.open(file, value);\n      }\n      const id = monaco.Uri.parse(file.getUri());\n      let newModel = window.monaco.editor.getModel(id);\n      if (!newModel) {\n        // create new model\n        if (qx.xml.Document.isXmlDocument(value)) {\n          value = value.documentElement.outerHTML;\n        }\n        newModel = window.monaco.editor.createModel(value, this._getLanguage(file), id);\n        newModel.onDidChangeDecorations(function (ev) {\n          let errors = false;\n          let warnings = false;\n          monaco.editor.getModelMarkers({\n            owner: newModel.getModeId(),\n            resource: id\n          }).some(function (marker) {\n            if (marker.severity === monaco.MarkerSeverity.Warning) {\n              warnings = true;\n            } else if (marker.severity === monaco.MarkerSeverity.Error) {\n              errors = true;\n            }\n            return warnings && errors;\n          }, this);\n          file.setValid(!errors);\n          file.setHasWarnings(warnings);\n        });\n      }\n\n      if (model !== newModel) {\n        newModel.updateOptions(this._getDefaultModelOptions());\n        this._editor.setModel(newModel);\n      } else {\n        this._editor.setValue(value);\n      }\n      this._editor.updateOptions({ readOnly: !file.isWriteable() });\n      this._processHandlerOptions(value);\n    },\n\n    _processHandlerOptions: function (content) {\n      const handlerOptions = this.getHandlerOptions() || {};\n      if (Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true && content) {\n        const [err, res] = this._upgradeConfig(content);\n        if (err) {\n          this.error(err);\n        } else {\n          this._editor.setValue(this._convertToString(res));\n        }\n      }\n    },\n\n    _convertToString: function (xml) {\n      return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n' + xml.documentElement.outerHTML;\n    },\n\n    _upgradeConfig: function (content) {\n      const upgrader = new cv.util.ConfigUpgrader();\n      return upgrader.upgrade(content);\n    },\n\n    getCurrentContent: function () {\n      return this._editor.getValue();\n    },\n\n    _onContentChanged: function () {\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), this._editor.getValue());\n      }\n    },\n\n    isSupported: function (file) {\n      const parts = file.getName().split('.');\n      const fileType = parts.length > 1 ? parts.pop() : 'txt';\n      const typeExt = '.' + fileType;\n      return monaco.languages.getLanguages().some(function (lang) {\n        return lang.id === fileType || lang.extensions.indexOf(typeExt) >= 0;\n      });\n    },\n\n    showErrors: function (path, errorList) {\n      const markers = [];\n      const model = this._editor.getModel();\n      if (!model) {\n        return;\n      }\n      let firstErrorLine = -1;\n      /**\n       * @param line\n       */\n      function check(line) {\n        if (firstErrorLine < 0 || firstErrorLine > line) {\n          firstErrorLine = line;\n        }\n      }\n      if (errorList) {\n        errorList.forEach(function (error) {\n          check(error.line);\n          markers.push({\n            severity: window.monaco.MarkerSeverity.Error,\n            startLineNumber: error.line,\n            endLineNumber: error.line,\n            message: error.message,\n            startColumn: error.startColumn,\n            endColumn: error.endColumn\n          });\n        });\n      }\n      if (this.getFile().getFullPath() === path) {\n        window.monaco.editor.setModelMarkers(model, model.getModeId(), markers);\n        const options = this.getHandlerOptions();\n        if (options && options.jumpToError) {\n          // jump too first error (only when we are at the beginning\n          if (this._editor.getScrollTop() === 0) {\n            this._editor.revealLineInCenter(firstErrorLine);\n          }\n        }\n      } else {\n        // TODO: save errors for later\n      }\n    },\n\n    showDecorations: function (path, decorators) {\n      if (this.getFile().getFullPath() === path) {\n        this._editor.deltaDecorations(this._currentDecorations[path], decorators);\n      }\n      this._currentDecorations[path] = decorators;\n    },\n\n    _getLanguage: function (file) {\n      if (file.getName() === 'hidden.php') {\n        // override this setting as we are loading the hidden config from its REST endpoint as JSON\n        return 'json';\n      }\n      let type = file.getName().split('.').pop();\n      switch (type) {\n        case 'svg':\n          return 'xml';\n        case 'js':\n          return 'javascript';\n        case 'md':\n          return 'markdown';\n        default: {\n          if (!type) {\n            return 'txt';\n          }\n          // check if monaco knows this ending, otherwise fallback to plaintext\n          const typeExt = '.' + type;\n          const found = monaco.languages.getLanguages().some(function (lang) {\n            return lang.id === type || lang.extensions.indexOf(typeExt) >= 0;\n          });\n          if (!found) {\n            type = 'txt';\n          }\n          return type;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._workerWrapper = null;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n    this._configClient = null;\n    qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(true);\n  }\n});\n","/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n    this._initWorker();\n\n    // init schema\n    this._schema = cv.ui.manager.model.Schema.getInstance('visu_config.xsd');\n    this._schema.onLoaded(function () {\n      this.setReady(true);\n      this._draw();\n    }, this);\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', ev => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    }, this);\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener('keyup', this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schema: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n\n    isPreviewSynced: function () {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions: function () {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility: function () {\n      const handlerOptions = this.getHandlerOptions();\n      this.setShowPreview(qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview));\n    },\n\n    _applyShowPreview: function (value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({flex: 1});\n        }\n      }\n      const file = this.getFile();\n      if (value && file) {\n        const preview = this.getChildControl('preview');\n        if (file.isWriteable()) {\n          if (!preview.getFile()) {\n            const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', this.getFile().getParent());\n            preview.setFile(previewConfig);\n          }\n        } else {\n          // this file is not writable, we can use the real one for preview\n          preview.setFile(file);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'undo':\n            if (!this.__editing) {\n              this.undo();\n            }\n            break;\n\n          case 'redo':\n            if (!this.__editing) {\n              this.redo();\n            }\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            if (!this.__editing) {\n              this._showHelp();\n            }\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getUnDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getReDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return value ? !value.isDeletable() : false;\n            }\n          });\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n      }\n    },\n    unConfigureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo: function (elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo: function () {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error('could not undo ' + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo: function () {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error('could not redo ' + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos: function () {\n      this.getUnDos().removeAll().forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos: function () {\n      this.getReDos().removeAll().forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard: function (value) {\n      try {\n        if (value) {\n          navigator.clipboard.writeText(value.getNode().outerHTML);\n        } else {\n          navigator.clipboard.writeText('');\n        }\n      } catch (e) {\n        // clipboard api is only available in secure environment, otherwise we have to do it ourself\n        cv.ui.manager.editor.AbstractEditor.CLIPBOARD = value ? value.getNode().outerHTML : '';\n      }\n    },\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors: function (path, errorList) {\n    },\n    showDecorations: function (path, decorators) {\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        this.base(arguments, file, old);\n      } else {\n        this.base(arguments, null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'splitpane':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this._add(control);\n           break;\n\n         case 'left':\n           control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n           this.getChildControl('splitpane').addAt(control, 0);\n           break;\n\n         case 'right':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n           if (!this.isShowPreview()) {\n             control.exclude();\n           }\n           this.getChildControl('splitpane').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview':\n           control = new cv.ui.manager.viewer.Config();\n           control.set({\n             target: 'iframe',\n             minWidth: 600\n           });\n           this.getChildControl('right').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview-sync-hint': {\n           const ok = this.tr('Preview shows the current state of the edited configuration.');\n           const noSync = this.tr('Preview is out of sync. Click here to refresh.');\n           const notOk = this.tr('Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.');\n           control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n           control.setRich(true);\n           control.getChildControl('label').setWrap(true);\n           control.addListener('tap', () => {\n             if (!this.isPreviewSynced() && this.isShowPreview()) {\n               this._updatePreview();\n             }\n           }, this);\n           this.getChildControl('right').addAt(control, 0);\n           this.addListener('previewStateChanged', ev => {\n             switch (ev.getData()) {\n               case 'synced':\n                 control.set({\n                   label: ok,\n                   icon: cv.theme.dark.Images.getIcon('valid', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n\n               case 'changed':\n                 control.set({\n                   label: noSync,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').addState('warning');\n                 break;\n\n               case 'structureChanged':\n                 control.set({\n                   label: notOk,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').addState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n             }\n           }, this);\n           break;\n         }\n\n         case 'edit-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n           control.setEnabled(false);\n           control.addListener('execute', this._onEdit, this);\n           this.bind('file.writeable', control, 'icon', {\n             converter: function (value) {\n               return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16);\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n           control.setEnabled(false);\n           control.addListener('execute', this._onDelete, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toggle-expert':\n           control = new qx.ui.toolbar.CheckBox(this.tr('Expertview'),\n             cv.theme.dark.Images.getIcon('expert', 16));\n           control.addListener('execute', function () {\n             this.toggleExpert();\n           }, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'refresh-preview':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n           control.setToolTipText(this.tr('Reload preview'));\n           control.addListener('execute', this._updatePreview, this);\n           this.bind('showPreview', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'hidden';\n             }\n           });\n           this.bind('previewState', control, 'enabled', {\n             converter: function (value) {\n               return value !== 'synced';\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toolbar':\n           control = new qx.ui.toolbar.ToolBar();\n           this.getChildControl('left').add(control, {\n             top: 0,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar-container':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this.getChildControl('left').add(control, {\n             top: 36,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             placeholder: this.tr('Search...'),\n             margin: 8\n           });\n           control.addListener('changeValue', qx.util.Function.debounce(this._onSearch, 250), this);\n           control.addListener('keyup', function (ev) {\n             switch (ev.getKeyIdentifier()) {\n               case 'Enter':\n               case 'Down':\n                 this._showNextResult();\n                 break;\n               case 'Up':\n                 this._showPreviousResult();\n                 break;\n             }\n             ev.stopPropagation();\n           }, this);\n           this.getChildControl('searchbar-container').add(control, {flex: 1});\n           break;\n\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n           control.set({\n             selectionMode: 'single',\n             width: 350,\n             openMode: 'none',\n             itemHeight: qx.core.Environment.get('device.touch') ? 40 : 20\n           });\n           this.bind('file.writeable', control, 'droppable');\n           this.bind('file.writeable', control, 'draggable');\n           this._initDragDrop(control);\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualElementItem();\n               if (!qx.core.Environment.get('device.touch')) {\n                 item.addListener('contextmenu', this._onContextMenu, this);\n               } else {\n                 item.addListener('action', this._onContextMenuAction, this);\n               }\n               item.addListener('dbltap', this._onEdit, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindProperty('displayName', 'label', null, item, index);\n               controller.bindProperty('name', 'name', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('showEditButton', 'editable', null, item, index);\n               controller.bindProperty('sortable', 'sortable', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('status', 'status', null, item, index);\n               controller.bindProperty('invalidMessage', 'toolTipText', null, item, index);\n               controller.bindProperty('dragging', 'dragging', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this.getChildControl('left').add(control, {\n             top: 72,\n             left: 0,\n             right: 0,\n             bottom: 0\n           });\n           break;\n\n         case 'add-button':\n           control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n           control.setDraggable(true);\n           control.setMarginLeft(-16);\n           control.setZIndex(20);\n           this.addListener('changeDragging', ev => {\n             control.setLayoutProperties({\n               bottom: 16,\n               left: ev.getData() ? -1000 : '50%'\n             });\n           }, this);\n           control.setAppearance('round-button');\n           control.addListener('pointerover', () => control.addState('hovered'));\n           control.addListener('pointerout', () => control.removeState('hovered'));\n           control.addListener('tap', () => {\n             if (this.getSelected()) {\n               this._onCreate(this.getSelected(), 'inside');\n             } else {\n               qxl.dialog.Dialog.alert(this.tr('Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.'));\n             }\n           }, this);\n           this.getChildControl('left').add(control, {\n             bottom: 16,\n             left: '50%'\n           });\n           break;\n\n         case 'drag-indicator':\n           // Create drag indicator\n           control = new qx.ui.core.Widget();\n           control.setDecorator(new qx.ui.decoration.Decorator().set({\n             widthTop: 1,\n             styleTop: 'solid',\n             colorTop: 'white'\n           }));\n           control.setHeight(0);\n           control.setOpacity(0.5);\n           control.setZIndex(100);\n           control.setDroppable(true);\n           control.setLayoutProperties({left: -1000, top: -1000});\n           qx.core.Init.getApplication().getRoot().add(control);\n           break;\n\n         case 'context-menu':\n           control = new cv.ui.manager.contextmenu.ConfigElement(this);\n           control.addListener('action', this._onContextMenuAction, this);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    _onContextMenu: function (ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction: function (ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, 'inside');\n            break;\n\n          default:\n            this.error('unhandled context menu action', data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n\n    openByQuerySelector: function (selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch: function (ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || el.hasAttribute('name') && el.getAttribute('name').startsWith(value);\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult: function () {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult: function () {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult: function () {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length-1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop: function (control) {\n      let draggedXmlElement;\n      control.addListener('dragstart', function (ev) {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction('copy');\n          if (element.isDeletable()) {\n            ev.addAction('move');\n          }\n          ev.addType('cv/tree-element');\n          ev.addData('cv/tree-element', element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      }, this);\n\n      const addButton = this.getChildControl('add-button');\n      addButton.addListener('dragstart', function (ev) {\n        ev.addAction('copy');\n        ev.addType('cv/new-tree-element');\n        this.setDragging(true);\n      }, this);\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      };\n\n      control.addListener('dragover', function (ev) {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType('cv/tree-element')) {\n          element = ev.getData('cv/tree-element');\n        }\n        const addNew = action === 'copy' && !element && ev.supportsType('cv/new-tree-element');\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug('dragging over indicator');\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug('dropping on same element forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug('moving inside own subtree forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && (ev.getDocumentTop() - layerContent.bottom <= 20)) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(Math.round((layerContent.left + layerContent.right) / 2), layerContent.bottom - 20);\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug('drop target not found');\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug('drop not allowed here, no drag element');\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n                    if ((acc & Allowed.BEFORE) && (acc & Allowed.AFTER)) {\n                      // we cannot find more\n                      return true;\n                    }\n                    return false;\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug('no children allowed here');\n            }\n          } else if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n              // not allowed on this level\n              accepted.mode = Allowed.NONE;\n              this.debug('not allowed as child element of', parent.getName());\n            } else if (parentSchemaElement.areChildrenSortable()) {\n              // children can be put anywhere\n              // so this is allowed anywhere\n              accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n            } else {\n              // check position\n              accepted.mode = this.__getAllowedPositions(parentSchemaElement.getAllowedElementsSorting(), element.getName(), model.getName());\n            }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug('dropping not accepted here');\n        }\n      }, this);\n\n      const indicator = this.getChildControl('drag-indicator');\n\n      let expandTimer;\n\n      control.addListener('dragleave', function (ev) {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      }, this);\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = '';\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = 'after';\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if ((ev.getDocumentTop() - origCoords.top) <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = 'before';\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = 'inside';\n              }\n            } else if ((origCoords.bottom - ev.getDocumentTop()) <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = 'after';\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = 'inside';\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                // eslint-disable-next-line no-lonely-if\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                } else {\n                  this.debug('not allowed as first child');\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              // eslint-disable-next-line no-lonely-if\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData('position') !== 'first-child') {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = 'inside';\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(function () {\n                    if (accepted.target) {\n                      control.openNode(accepted.target);\n                    }\n                  }, this, 1000);\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData('position', position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData('action', ev.getCurrentAction());\n          cursor.resetAction();\n          // eslint-disable-next-line no-console\n          console.assert(left < 0);\n          // eslint-disable-next-line no-console\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData('action')) {\n          cursor.setAction(indicator.getUserData('action'));\n          indicator.setUserData('action', null);\n        }\n      };\n      control.addListener('drag', onDrag, this);\n      addButton.addListener('drag', onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction();\n        let element = ev.supportsType('cv/tree-element') ? ev.getData('cv/tree-element') : null;\n        if (action === 'copy') {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = 'add';\n          }\n        }\n        const elementName = element ? element.getDisplayName() : 'new';\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData('position')) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, 'after', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, 'before', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as first child');\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName() + ' as first child');\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as child');\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName(), 'as child');\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener('drop', onDrop, this);\n      indicator.addListener('drop', onDrop, this);\n\n      const onDragEnd = function(ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener('dragend', onDragEnd, this);\n      addButton.addListener('dragend', onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate: function (target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex-1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(name => Object.prototype.hasOwnProperty.call(sorting, name) && sorting[name] <= maxPosition && sorting[name] >= minPosition);\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm;\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr('<p style=\\'font-weight:bold\\'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>'),\n            formData: {\n              type: {\n                type: 'SelectBox',\n                label: this.tr('Choose element'),\n                help: this.tr('Please choose the element you want to add here.'),\n                options: addable.sort((a, b) => {\n                  if (a.startsWith('#') && !b.startsWith('#')) {\n                    return 1;\n                  } else if (!a.startsWith('#') && b.startsWith('#')) {\n                    return -1;\n                  }\n                  return a.localeCompare(b);\n                }).map(name => ({label: name, value: name})),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          }).show().promise();\n        } else {\n          typeChooserForm = Promise.resolve({type: addable[0]});\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment('');\n                break;\n\n              case '#text':\n                element = document.createTextNode('');\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection('');\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode('-');\n                element.appendChild(child);\n              }\n            };\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement, true);\n            }\n            res.then(data => {\n              if (data) {\n                // finally insert the new node\n                switch (position) {\n                  case 'before':\n                    xmlElement.insertBefore(target);\n                    break;\n\n                  case 'after':\n                    xmlElement.insertAfter(target);\n                    break;\n\n                  case 'inside':\n                    target.insertChild(xmlElement, -1, false, 'added');\n                    break;\n\n                  case 'first-child':\n                    target.insertChild(xmlElement, 0, false, 'added');\n                    break;\n                }\n                this.getChildControl('tree').openNodeAndParents(xmlElement);\n                this.getChildControl('tree').setSelection([xmlElement]);\n              }\n            }, this).catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions: function (allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === 'string') {\n          currentPosition = currentPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === 'string') {\n          targetPosition = targetPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length);\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n      }\n      return cv.ui.manager.editor.Tree.Allowed.NONE;\n    },\n\n    __checkProvider: function (id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error('misconfigured provider found for ' + id);\n        }\n        formData.type = provider.userInputAllowed ? 'VirtualComboBox' : 'VirtualSelectBox';\n      } else if (['mapping', 'styling'].includes(id.split('@').pop())) {\n        const type = id.split('@').pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = 'SelectBox';\n        formData.options = [];\n        rootNode.querySelectorAll('meta > ' + type + 's > ' + type).forEach(element => {\n          const name = element.getAttribute('name');\n          formData.options.push({label: name, value: name});\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options.then(res => {\n              if (Array.isArray(res)) {\n                res.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n              }\n            }).catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition: function (element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: 'TextField',\n        label: attribute.getName(),\n        placeholder: ' - ' + this.tr('not set') + ' - ',\n        help: docs.join('<br/>'),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator: function (value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n            }\n          }\n        }\n      };\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = 'CheckBox';\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string': {\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = 'SelectBox';\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({label: name, value: name});\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + '@' + attribute.getName(), def, element.getNode());\n          }\n          break;\n        }\n      }\n      return def;\n    },\n\n    _onEdit: function (ev, element, isNew) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return null;\n      }\n      let title;\n      let caption;\n      if (!element) {\n        if (this.getSelected()) {\n          element = this.getSelected();\n        } else {\n          return null;\n        }\n      }\n      if (!element.getShowEditButton()) {\n        return null;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (isNew) {\n        title = this.tr('Create new %1 element', element.getName());\n        caption = this.tr('Please edit the attributes of the new %1 element, that will be added to the chosen position.', element.getName());\n      } else {\n        title = this.tr('Edit element attributes');\n        caption = element.isEditable() ? this.tr('Edit %1', element.getName()) : this.tr('Show %1', element.getName());\n      }\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n        if (typeElement.isChildElementAllowed('*')) {\n          const parser = new DOMParser();\n          const attrName = element.getNode().nodeName === 'custom' ? '#innerHTML' : '#outerHTML';\n          if (isNew) {\n            title = this.tr('Create new %1 element', element.getName());\n            caption = this.tr('Please edit the content of the new %1 element, that will be added to the chosen position.', element.getName());\n          } else {\n            title = attrName === '#outerHTML' ? this.tr('Edit element and content') : this.tr('Edit element content');\n          }\n          formData[attrName] = {\n            type: 'TextArea',\n            label: '',\n            lines: 5,\n            autoSize: true,\n            width: Math.min(qx.bom.Viewport.getWidth(), 500),\n            enabled: element.isEditable(),\n            value: attrName === '#outerHTML' ? element.getNode().outerHTML : element.getNode().innerHTML,\n            validation: {\n              validator: function (value) {\n                if (value) {\n                  const dom = parser.parseFromString(value, 'text/xml');\n                  if (dom.getElementsByTagName('parsererror').length > 0) {\n                    throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n                  }\n                }\n              }\n            }\n          };\n        }\n      } else if (element.getNode().nodeType === Node.TEXT_NODE || element.getNode().nodeType === Node.COMMENT_NODE || element.getNode().nodeType === Node.CDATA_SECTION_NODE) {\n        title = this.tr('Edit text content', element.getName());\n        caption = '';\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: 'TextArea',\n          label: '',\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr('not set'),\n          help: docs.join('<br/>'),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator: function (value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n              }\n            }\n          }\n        };\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute('type');\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(element.getParent().getName() + '@' + element.getName(), formData[nodeName], element.getNode());\n      }\n      this.__editing = true;\n\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption:  title,\n        message: caption,\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          if (!Object.prototype.hasOwnProperty.call(data, '#outerHTML') && !Object.prototype.hasOwnProperty.call(data, '#innerHTML')) {\n            element.validate();\n          }\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete: function (ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n      return null;\n    },\n\n    _onCut: function () {\n      if (this.__editing) {\n        document.execCommand('cut');\n      } else {\n        const element = this._onDelete();\n        if (element) {\n          this.setClipboard(element);\n        }\n      }\n    },\n\n    _onCopy: function () {\n      if (this.__editing) {\n        document.execCommand('copy');\n      } else {\n        const element = this.getSelected();\n        if (element) {\n          const copy = element.clone();\n          this.setClipboard(copy);\n        }\n      }\n    },\n\n    _onPaste: function () {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified: function (element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else if (element.isModified()) {\n          if (index === -1) {\n            this.__modifiedElements.push(element);\n          }\n          if (previewIndex === -1) {\n            this.__modifiedPreviewElements.push(element);\n          }\n        } else {\n          if (index >= 0) {\n            this.__modifiedElements.splice(index, 1);\n          }\n          if (previewIndex >= 0) {\n            this.__modifiedPreviewElements.splice(index, 1);\n          }\n        }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw: function () {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget: function () {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          while (node && node.nodeName !== 'pages') {\n            if (node.nodeName === 'page') {\n              path.unshift(node.getAttribute('name'));\n            }\n            node = node.parentNode;\n          }\n          if (path.length > 0) {\n            preview.openPage(path.pop(), path.join('/'));\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp: function(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === 'Enter') {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent: function(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + ' is a valid config file');\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n              dialog.addListener('action', ev => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source': {\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: 'cv.ui.manager.editor.Source',\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n                    break;\n                  }\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n                dialog.hide();\n                dialog.destroy();\n              }, this);\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __loadContent: function (value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const document = qx.xml.Document.fromString(value);\n        const schemaElement = this._schema.getElementNode(document.documentElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(document.documentElement, schemaElement, this);\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n          // extra space fr add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (file.isWriteable()) {\n            if (!preview.getFile()) {\n              const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', file.getParent());\n              preview.setFile(previewConfig);\n            }\n          } else {\n            preview.setFile(file);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split('/');\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error('Error loading ' + current.getName() + ': ' + e.toString());\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error('patch segment format error: ' + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      }\n    },\n\n    _onContentChanged: function () {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview: function (ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        this._client.updateSync({\n          path: previewFile.getFullPath(),\n          hash: 'ignore'\n        }, content, () => {\n          qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n            type: 'contentChanged',\n            file: previewFile,\n            data: content,\n            source: this\n          });\n          this.__modifiedPreviewElements.removeAll();\n          this.resetPreviewState();\n        }, this);\n      }\n    },\n\n    getCurrentContent: function (fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        } \n          // prettify content\n          return '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n' + this._prettify(rootNode, 0);\n      } \n        return null;\n    },\n\n    _prettify: function (node, level, singleton) {\n      let tabs = Array(level + 1).fill('').join('\\t');\n      let newLine = '\\n';\n      if (node.nodeType === Node.TEXT_NODE) {\n        if (node.textContent.trim()) {\n          return (singleton ? '' : tabs) + qx.xml.String.escape(node.textContent.trim()) + (singleton ? '' : newLine);\n        } \n          return '';\n      }\n      if (node.nodeType === Node.COMMENT_NODE) {\n        return (singleton ? '' : tabs) + `<!--${node.textContent}--> ${(singleton ? '' : newLine)}`;\n      } else if (node.nodeType === Node.CDATA_SECTION_NODE) {\n        return (singleton ? '' : tabs) + `<![CDATA[${node.textContent}]]> ${(singleton ? '' : newLine)}`;\n      }\n      if (!node.tagName) {\n        return this._prettify(node.firstChild, level);\n      }\n      let output = tabs + `<${node.tagName}`; // >\\n\n      for (let i = 0; i < node.attributes.length; i++) {\n        output += ` ${node.attributes[i].name}=\"${node.attributes[i].value}\"`;\n      }\n      if (node.childNodes.length === 0) {\n        return output + ' />' + newLine;\n      } \n        output += '>';\n      \n      let onlyOneTextChild = ((node.childNodes.length === 1) && (node.childNodes[0].nodeType === 3));\n      if (!onlyOneTextChild) {\n        output += newLine;\n      }\n      for (let i = 0; i < node.childNodes.length; i++) {\n        output += this._prettify(node.childNodes[i], level + 1, onlyOneTextChild);\n      }\n      return output + (onlyOneTextChild ? '' : tabs) + `</${node.tagName}>` + newLine;\n    },\n\n    _onSaved: function () {\n      this.base(arguments);\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported: function (file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp: function () {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr('Help'),\n        modal: true,\n        image: 'qxl.dialog.icon.info',\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: ''\n      };\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr('<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with \\'Enter\\' or the \\'Down\\' key. Accordingly you can jump the the previous found element \\\nwith the \\'Up\\' key.</p>');\n      } else {\n        // show general help\n        dialogConf.message = this.tr('<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the \\'edit\\'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the \\'edit\\'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the \\'add child\\'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the \\'Expertview\\'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>');\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._schema = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener('keyup', this._onElementKeyUp, this);\n  }\n});\n","/**\n * Monaco Texteditor for file content comparison\n */\nqx.Class.define('cv.ui.manager.editor.Diff', {\n  extend: cv.ui.manager.editor.Source,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    // this._handledActions = [];\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    COUNTER: 0,\n    TITLE: qx.locale.Manager.tr('File compare'),\n    ICON: cv.theme.dark.Images.getIcon('compare', 18)\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    originalContent: {\n      check: 'String',\n      init: '',\n      apply: '_applyContent'\n    },\n\n    modifiedContent: {\n      check: 'String',\n      init: '',\n      apply: '_applyContent'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyEditable'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyEditable: function(value) {\n      if (this._editor) {\n        this._editor.updateOptions({readOnly: !value});\n      }\n    },\n\n    // overridden, worker is a singleton and not usable for the diff editor\n    _initWorker: function () {},\n\n    _draw: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._draw, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', this._draw, this);\n        } else {\n          this._editor = window.monaco.editor.createDiffEditor(domElement, {\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            theme: 'vs-dark',\n            readOnly: !this.getEditable()\n          });\n          if (this.getFile()) {\n            this._loadFile(this.getFile());\n          }\n        }\n      }\n    },\n\n    _applyContent: function () {\n      const original = this.getOriginalContent();\n      const modified = this.getModifiedContent();\n      if (original && modified) {\n        const file = this.getFile();\n        const originalFile = file instanceof cv.ui.manager.model.CompareFiles ? file.getOriginalFile() : file;\n        const modifiedFile = file instanceof cv.ui.manager.model.CompareFiles ? file.getModifiedFile() : file;\n        const originalModel = window.monaco.editor.createModel(original, this._getLanguage(originalFile));\n        originalModel.updateOptions(this._getDefaultModelOptions());\n        const modifiedModel = window.monaco.editor.createModel(modified, this._getLanguage(modifiedFile));\n        modifiedModel.updateOptions(this._getDefaultModelOptions());\n        this._editor.setModel({\n          original: originalModel,\n          modified: modifiedModel\n        });\n      }\n    },\n\n    getCurrentContent: function () {\n      return this._editor.getModifiedEditor().getValue();\n    },\n\n    clear: function () {\n      this._editor.getModel().original.dispose();\n      this._editor.getModel().modified.dispose();\n    },\n\n    save: function (callback) {\n      const handlerOptions = this.getHandlerOptions();\n      if (this.getFile() instanceof cv.ui.manager.model.FileItem && Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true) {\n        this.base(arguments, callback, 'ignore');\n      }\n    },\n\n    _loadFile: function (file, old) {\n      if (old && old instanceof cv.ui.manager.model.FileItem) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (this._editor) {\n        const handlerOptions = this.getHandlerOptions();\n        if (file && file instanceof cv.ui.manager.model.FileItem && Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true) {\n          qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n          this.setEditable(file.isWriteable());\n          this._client.readSync({path: file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setOriginalContent(res);\n              const [err, upgradedContent, changes] = this._upgradeConfig(res);\n              if (err) {\n                qxl.dialog.Dialog.error(err);\n                qx.event.message.Bus.dispatchByName('cv.manager.action.close');\n              } else {\n                this.setModifiedContent(this._convertToString(upgradedContent));\n                let changesText = changes.length > 0\n                  ? '<div>' + qx.locale.Manager.tr('The following changes have been made') + '</div>' +\n                  '<ul><li>'+changes.join('</li><li>')+ '</li></ul>' +\n                  '<div>' + qx.locale.Manager.tr('You can check the changes in the editor. The left side shows the content before the upgrade and the right side shows the content after the upgrade.') + '</div>'\n                  : '<div><strong>' + qx.locale.Manager.tr('No changes have been made') + '</strong></div>';\n\n                let msg = '<h3>' + qx.locale.Manager.tr('Config file has been upgraded to the current library version.').translate().toString() + '</h3>' + changesText +\n                  '<div>' + qx.locale.Manager.tr('Click \"Apply\" if you want to save the changes and reload the browser.') + '</div>' +\n                  '<div>' + qx.locale.Manager.tr('Click \"Check\" if you want to check the changes. You have to save the changes and reload your browser yourself in this case.') + '</div>';\n                const d = qxl.dialog.Dialog.confirm(msg, function (ok) {\n                  if (ok) {\n                    this.save(function () {\n                      window.location.reload();\n                    });\n                  }\n                }, this, qx.locale.Manager.tr('Upgrade successful'));\n                d.set({\n                  width: Math.min(qx.bom.Viewport.getWidth(), 600),\n                  yesButtonLabel: qx.locale.Manager.tr('Apply'),\n                  noButtonLabel: qx.locale.Manager.tr('Check')\n                });\n                file.setModified(true);\n              }\n            }\n          }, this);\n        } else if (file && file instanceof cv.ui.manager.model.CompareFiles && this.isSupported(file.getModifiedFile())) {\n          this.resetEditable();\n          this._client.readSync({path: file.getModifiedFile().getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setModifiedContent(res);\n            }\n          }, this);\n\n          this._client.readSync({path: file.getOriginalFile().getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setOriginalContent(res);\n            }\n          }, this);\n        } else {\n          this.resetOriginalContent();\n          this.resetModifiedContent();\n        }\n      }\n    }\n  }\n});\n","/**\n * Editor for the (hidden) configuration.\n */\nqx.Class.define('cv.ui.manager.editor.Config', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._handledActions = ['save'];\n    this._setLayout(new qx.ui.layout.VBox(8));\n    this._createChildControl('list');\n    this._createChildControl('add-section');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: qx.locale.Manager.tr('Hidden configuration')\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _model: null,\n    _listController: null,\n    __initialSectionCount: 0,\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getConfigClient();\n      this._client.addListener('getSuccess', this._onModelValueChange, this);\n      this._client.addListener('updateSuccess', this._onSaved, this);\n    },\n\n    _loadFile: function (file) {\n      if (file) {\n        this._client.get({section: '*', key: '*'});\n      }\n    },\n\n    _onModelValueChange: function (ev) {\n      if (this.getFile()) {\n        this.setContent(ev.getData());\n      }\n    },\n\n    // overridden\n    _applyContent: function(value) {\n      const model = this._listController.getModel();\n      model.removeAll();\n\n      this.__initialSectionCount = Object.keys(value).length;\n\n      Object.keys(value).forEach(function (sectionName) {\n        const section = new cv.ui.manager.model.config.Section(sectionName);\n        Object.keys(value[sectionName]).forEach(function (optionKey) {\n          section.addOption(optionKey, value[sectionName][optionKey]);\n        }, this);\n        model.push(section);\n      }, this);\n\n      this.__checkForModification();\n    },\n\n    // overridden\n    getCurrentContent: function () {\n      return this.getContent();\n    },\n\n    _onDeleteSection: function (ev) {\n      const section = ev.getData();\n      const model = this._listController.getModel();\n      model.remove(section);\n      this.__checkForModification();\n    },\n\n    // compare current controller model with the loaded config content\n    __checkForModification: function () {\n      const file = this.getFile();\n      if (this.__initialSectionCount !== this._listController.getModel().length) {\n        file.setModified(true);\n        return;\n      }\n      const modified = this.getChildControl('list').getChildren().some(function (sectionListItem) {\n        return sectionListItem.isModified();\n      }, this);\n      file.setModified(modified);\n    },\n\n    save: function () {\n      // check for duplicate section names of keys\n      const model = this._listController.getModel();\n      const keys = [];\n      let valid = true;\n      model.forEach(function (section) {\n        const key = section.getName();\n        if (!keys.includes(key)) {\n          keys.push(key);\n        } else {\n          valid = false;\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section name duplicate: \"%1\".', key));\n        }\n        // check for key duplicates in this sections options\n        const optionKeys = [];\n        section.getOptions().forEach(function (option) {\n          const optionKey = option.getKey();\n          if (!optionKeys.includes(optionKey)) {\n            optionKeys.push(optionKey);\n          } else {\n            valid = false;\n            cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Option key duplicate: \"%1\" in section \"%2\".', optionKey, key));\n          }\n        }, this);\n      }, this);\n\n      if (valid) {\n        const data = {};\n        this._listController.getModel().forEach(function (section) {\n          const options = {};\n          section.getOptions().forEach(function (option) {\n            options[option.getKey()] = option.getValue();\n          });\n          data[section.getName()] = options;\n        }, this);\n        this._client.saveSync(null, data, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(this.tr('Saving hidden config failed with error %1 (%2)', err.status, err.statusText));\n          } else {\n            cv.ui.manager.snackbar.Controller.info(this.tr('Hidden config has been saved'));\n            this._onSaved();\n          }\n        }, this);\n      } else {\n        cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section is invalid and has not been saved.'));\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(new qx.data.Array(), control);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.SectionListItem();\n             },\n\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteSection, this);\n               item.addListener('changeModified', this.__checkForModification, this);\n             }.bind(this),\n\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n             }\n           });\n           this._add(control, {flex: 1});\n           break;\n\n         case 'buttons':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox(8));\n           this._add(control);\n           break;\n\n         case 'add-section':\n           control = new qx.ui.form.Button(this.tr('Add section'));\n           control.addListener('execute', function () {\n             this._listController.getModel().push(new cv.ui.manager.model.config.Section(''));\n             this.__checkForModification();\n           }, this);\n           this.getChildControl('buttons').add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_model', '_listController');\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.editor.Worker', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._files = {};\n    // create WebWorker\n    this._worker = cv.data.FileWorker.getInstance();\n    this._worker.addListener('message', this._onMessage, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    editor: {\n      check: 'cv.ui.manager.editor.AbstractEditor',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _worker: null,\n    _files: null,\n\n    open: function (file, code, schema, features) {\n      this._worker.postMessage(['openFile', {\n        path: file.getFullPath(),\n        code: qx.xml.Document.isXmlDocument(code) ? code.documentElement.outerHTML : code,\n        schema: schema\n      }, features]);\n      this._files[file.getFullPath()] = file;\n    },\n\n    close: function (file) {\n      this._worker.postMessage(['closeFile', {\n        path: file.getFullPath()\n      }]);\n      delete this._files[file.getFullPath()];\n    },\n\n    contentChanged: function (file, content) {\n      this._worker.postMessage(['contentChange', {\n        path: file.getFullPath(),\n        code: content\n      }]);\n    },\n\n    validateConfig: function (file) {\n      if (file.isConfigFile()) {\n        return this._worker.validateConfig(file.getServerPath());\n      }\n      qx.log.Logger.error(this, file.getFullPath() + ' is no configuration file');\n      return true;\n    },\n\n    validateXmlConfig: function (content) {\n      return this._worker.validateXmlConfig(content);\n    },\n\n    _onMessage: function (e) {\n      let topic = e.getData().topic;\n      let data = e.getData().data;\n      let path = e.getData().path;\n      let file = this._files[path];\n      if (!file && topic !== 'validationResult') {\n        qx.log.Logger.error(this, 'no file found for path ' + path + ' ignoring worker message for topic ' + topic);\n        return;\n      }\n      let editor = this.getEditor();\n      switch (topic) {\n        case 'modified':\n          // new files are always modified, to not override that state\n          if (!file.isTemporary()) {\n            file.setModified(data.modified);\n          }\n          file.setHash(data.currentHash);\n          break;\n\n        case 'hash':\n          file.setHash(data);\n          break;\n\n        case 'errors':\n          file.setValid(!data || data.length === 0);\n          if (editor) {\n            editor.showErrors(path, data);\n          }\n          break;\n\n        case 'decorations':\n          if (editor) {\n            editor.showDecorations(path, data);\n          }\n          break;\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._worker.terminate();\n    this._worker = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.contextmenu.FileItem', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (file, noCompare) {\n    this.base(arguments);\n    this._noCompare = noCompare === true;\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n    this._dateFormat = new qx.util.format.DateFormat(qx.locale.Date.getDateFormat('medium'));\n    this._timeFormat = new qx.util.format.DateFormat(qx.locale.Date.getTimeFormat('medium'));\n\n    if (file) {\n      this.configure(file);\n    }\n\n    // only react to events when this menu is visible\n    this.addListener('appear', function () {\n      this.setActive(true);\n    });\n    this.addListener('disappear', function () {\n      this.setActive(false);\n    });\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-file-contextmenu'\n    },\n    \n    /* This flag enables the event handling for this menu */\n    active: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _commandGroup: null,\n    _selectedNode: null,\n    _dateFormat: null,\n    _timeFormat: null,\n    _renameDialog: null,\n    _noCompare: false,\n\n    configure: function (file) {\n      this._selectedNode = file;\n      if (file) {\n        const isFolder = file.getType() === 'dir';\n        const folder = isFolder ? file : file.getParent();\n        let isBackup = false;\n        if (folder && folder.getFullPath().startsWith('backup') || file.getFullPath().startsWith('backup')) {\n          isBackup = true;\n        }\n        if (!isFolder) {\n          this.getChildControl('new-file-button').exclude();\n          this.getChildControl('new-folder-button').exclude();\n        } else {\n          this.getChildControl('new-file-button').set({\n            enabled: folder && !isBackup ? folder.isWriteable() : false,\n            visibility: 'visible'\n          });\n          this.getChildControl('new-folder-button').set({\n            enabled: folder && !isBackup ? folder.isWriteable() : false,\n            visibility: 'visible'\n          });\n        }\n        this.getChildControl('clone-file-button').setVisibility(file.isConfigFile() && !isBackup ? 'visible' : 'excluded');\n        this.getChildControl('delete-button').setLabel(file.isTrash()\n          ? this.tr('Clear')\n          : this.tr('Delete'));\n\n        // create compare menu\n        if (!this._noCompare) {\n          const compareMenu = this.getChildControl('compare-menu');\n          compareMenu.removeAll();\n          if (!isBackup) {\n            this.getChildControl('compare-with-button').show();\n            const backups = cv.ui.manager.model.BackupFolder.getInstance().getBackupFiles(file);\n            this.getChildControl('compare-with-button').setEnabled(backups.length > 0);\n            backups.sort(function (a, b) {\n              return b.date.getTime() - a.date.getTime();\n            });\n            let group = null;\n            backups.forEach(function (backupEntry) {\n              const date = this._dateFormat.format(backupEntry.date);\n              if (group !== date) {\n                if (group !== null) {\n                  compareMenu.add(new qx.ui.menu.Separator());\n                }\n                const groupButton = new qx.ui.menu.Button(date);\n                groupButton.setEnabled(false);\n                compareMenu.add(groupButton);\n                group = date;\n              }\n              const button = new qx.ui.menu.Button(this.tr('Backup from %1', this._timeFormat.format(backupEntry.date)));\n              button.setUserData('file', backupEntry.file);\n              button.addListener('execute', this._onCompareWith, this);\n              compareMenu.add(button);\n            }, this);\n          } else {\n            this.getChildControl('compare-with-button').exclude();\n          }\n        }\n\n        const defaultHandler = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n\n        // open with menu\n        const openWithMenu = this.getChildControl('open-with-menu');\n        openWithMenu.removeAll();\n        if (!isBackup) {\n          this.getChildControl('open-with-button').show();\n          const availableHandlers = cv.ui.manager.control.FileHandlerRegistry.getInstance().getAllFileHandlers(file);\n\n          // this menu only makes sense when there is more than one option to select from\n          this.getChildControl('open-with-button').setEnabled(availableHandlers.length > 1);\n          availableHandlers.sort(function (a, b) {\n            return a.Clazz.constructor.TITLE.toString().localeCompare(b.Clazz.constructor.TITLE.toString());\n          });\n          availableHandlers.forEach(function (handlerConf) {\n            const button = new qx.ui.menu.Button(handlerConf.Clazz.constructor.TITLE, handlerConf.Clazz.constructor.ICON);\n            button.setAppearance('open-with-button');\n            if (defaultHandler.Clazz.classname === handlerConf.Clazz.classname) {\n              button.addState('default');\n            }\n            button.setUserData('handlerId', handlerConf.Clazz.classname);\n            button.addListener('execute', this._onOpenWith, this);\n            openWithMenu.add(button);\n          }, this);\n        } else {\n          this.getChildControl('open-with-button').exclude();\n        }\n\n        // validate button\n        this.getChildControl('validate-config-button').setVisibility(file.isConfigFile() && !file.isMounted() && !isBackup ? 'visible' : 'excluded');\n\n        // replacement button\n        if (!isFolder && !isBackup) {\n          this.getChildControl('replace-button').show();\n          this._replacementManager.setFilename(file.getName());\n          this._replacementManager.setFolder(file.getParent());\n        } else {\n          this.getChildControl('replace-button').exclude();\n        }\n        // buttons that need write access\n        ['delete-button', 'replace-button', 'rename-button'].forEach(function (controlName) {\n          this.getChildControl(controlName).setEnabled(!file.isFake() && file.isWriteable() && (!isBackup || controlName === 'delete-button'));\n        }, this);\n        this.getChildControl('download-button').setEnabled(!file.isFake() && file.getType() === 'file');\n        this.getChildControl('restore-button').setVisibility(file.isInTrash() || isBackup ? 'visible' : 'excluded');\n      } else {\n        this.getChildControl('delete-button').set({\n          label: this.tr('Delete'),\n          enabled: false\n        });\n        this.getChildControl('replace-button').exclude();\n        this.getChildControl('download-button').setEnabled(false);\n        this.getChildControl('restore-button').exclude();\n      }\n    },\n\n    _init: function () {\n      if (!this._noNew) {\n        this.add(this.getChildControl('new-file-button'));\n      }\n      this.add(this.getChildControl('clone-file-button'));\n      if (!this._noNew) {\n        this.add(this.getChildControl('new-folder-button'));\n      }\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('open-button'));\n      this.add(this.getChildControl('open-with-button'));\n      if (!this._noCompare) {\n        this.add(this.getChildControl('compare-with-button'));\n      }\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('rename-button'));\n      this.add(this.getChildControl('delete-button'));\n      this.add(this.getChildControl('restore-button'));\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('download-button'));\n      let sep = new qx.ui.menu.Separator();\n      let button = this.getChildControl('replace-button');\n      this.add(sep);\n      this.add(button);\n      button.bind('visibility', sep, 'visibility');\n      sep = new qx.ui.menu.Separator();\n      button = this.getChildControl('validate-config-button');\n      button.bind('visibility', sep, 'visibility');\n      this.add(sep);\n      this.add(button);\n    },\n\n    _onCompareWith: function (ev) {\n      if (this.isActive()) {\n        const compareWith = ev.getTarget().getUserData('file');\n        qx.event.message.Bus.dispatchByName('cv.manager.compareFiles',\n          new cv.ui.manager.model.CompareFiles(compareWith, this._selectedNode)\n        );\n      }\n    },\n\n    _onOpenWith: function (ev) {\n      if (this.isActive()) {\n        const handlerId = ev.getTarget().getUserData('handlerId');\n        qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n          file: this._selectedNode,\n          handler: handlerId\n        });\n      }\n    },\n\n    _onRename: function () {\n      if (this._selectedNode && !this._renameDialog && this.isActive()) {\n        this._renameDialog = new cv.ui.manager.dialog.Prompt({\n          message: this.tr('New name'),\n          callback: function (name) {\n            if (name && name !== this._selectedNode.getName()) {\n              cv.ui.manager.control.FileController.getInstance().rename(this._selectedNode, name);\n            }\n          },\n          context: this,\n          value: this._selectedNode.getName(),\n          caption: this.tr('Rename file'),\n          filter: /[\\w\\d_\\-\\.\\s]/\n        });\n        this._renameDialog.show();\n      }\n    },\n\n    _onDownload: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().download(this._selectedNode);\n      }\n    },\n\n    _onRestore: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().restore(this._selectedNode);\n      }\n    },\n\n    _onValidate: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().validate(this._selectedNode);\n      }\n    },\n\n    _onClone: function () {\n      if (this._selectedNode && this.isActive()) {\n        qx.event.message.Bus.dispatchByName('cv.manager.action.clone', {\n          file: this._selectedNode\n        });\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'new-file-button':\n           control = new qx.ui.menu.Button(this.tr('New file'), cv.theme.dark.Images.getIcon('new-file', 18));\n           control.addListener('execute', function () {\n             if (this._selectedNode.isConfigFile()) {\n               qx.event.message.Bus.dispatchByName('cv.manager.action.new-config-file', this._selectedNode.getParent());\n             } else {\n               qx.event.message.Bus.dispatchByName('cv.manager.action.new-file', this._selectedNode.getType() === 'dir' ? this._selectedNode : this._selectedNode.getParent());\n             }\n           }, this);\n           break;\n\n         case 'clone-file-button':\n           control = new qx.ui.menu.Button(this.tr('Clone file'), cv.theme.dark.Images.getIcon('clone-file', 18));\n           control.exclude();\n           control.addListener('execute', this._onClone, this);\n           break;\n\n         case 'new-folder-button':\n           control = new qx.ui.menu.Button(this.tr('New folder'), cv.theme.dark.Images.getIcon('new-folder', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.action.new-folder', this._selectedNode.getType() === 'dir' ? this._selectedNode : this._selectedNode.getParent());\n           }, this);\n           break;\n\n         case 'rename-button':\n           control = new qx.ui.menu.Button(this.tr('Rename'), cv.theme.dark.Images.getIcon('rename', 18));\n           control.addListener('execute', this._onRename, this);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.menu.Button(this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.action.delete', this._selectedNode);\n           }, this);\n           break;\n\n         case 'download-button':\n           control = new qx.ui.menu.Button(this.tr('Download'), cv.theme.dark.Images.getIcon('download', 18));\n           control.addListener('execute', this._onDownload, this);\n           break;\n\n         case 'open-button':\n           control = new qx.ui.menu.Button(this.tr('Open'), cv.theme.dark.Images.getIcon('open', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.open', this._selectedNode);\n           }, this);\n           break;\n\n         case 'restore-button':\n           control = new qx.ui.menu.Button(this.tr('Restore'), cv.theme.dark.Images.getIcon('trash', 18));\n           control.exclude();\n           control.addListener('execute', this._onRestore, this);\n           break;\n\n         case 'validate-config-button':\n           control = new qx.ui.menu.Button(this.tr('Validate'), cv.theme.dark.Images.getIcon('validate', 18));\n           control.exclude();\n           control.addListener('execute', this._onValidate, this);\n           break;\n\n         case 'replace-button':\n           control = new com.zenesis.qx.upload.UploadMenuButton(this.tr('Replace'), cv.theme.dark.Images.getIcon('upload', 18));\n           control.exclude();\n           this._replacementManager = new cv.ui.manager.upload.UploadMgr();\n           this._replacementManager.setForce(true);\n           this._replacementManager.addWidget(control);\n           break;\n\n         case 'compare-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'compare-with-button':\n           control = new qx.ui.menu.Button(this.tr('Compare with...'), cv.theme.dark.Images.getIcon('compare', 18), null, this.getChildControl('compare-menu'));\n           break;\n\n         case 'open-with-button':\n           control = new qx.ui.menu.Button(this.tr('Open with...'), cv.theme.dark.Images.getIcon('open-with', 18), null, this.getChildControl('open-with-menu'));\n           break;\n\n         case 'open-with-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n    this._renameDialog = null;\n    this._disposeObjects('_dateFormat', '_timeFormat');\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.contextmenu.GlobalFileItem', {\n  extend: cv.ui.manager.contextmenu.FileItem,\n  type: 'singleton'\n});\n","/**\n * Widget for filesystem items in a virtual tree.\n */\nqx.Class.define('cv.ui.manager.tree.VirtualFsItem', {\n  extend: qx.ui.tree.VirtualTreeItem,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'fs-tree-item'\n    },\n\n    editing: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyEditing'\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName'\n    },\n\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyTemporary'\n    },\n\n    status: {\n      check: ['valid', 'error'],\n      nullable: true,\n      apply: '_applyStatus'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _applyEditing: function (value, old) {\n      if (value !== old) {\n        const field = this.getChildControl('edit');\n        if (value) {\n          field.setValue(this.getLabel());\n          field.show();\n          qx.event.message.Bus.dispatchByName('cv.manager.tree.enable', false);\n        } else {\n          qx.event.message.Bus.dispatchByName('cv.manager.tree.enable', true);\n          field.exclude();\n          // save new name\n          if (field.getValue() !== this.getName()) {\n            cv.ui.manager.control.FileController.getInstance().rename(this.getModel(), field.getValue());\n          }\n        }\n      }\n    },\n    _applyTemporary: function (value) {\n      if (value) {\n        this.addState('temporary');\n      } else {\n        this.removeState('temporary');\n      }\n    },\n\n    // overridden\n    _applyModel : function(value, old) {\n      this.base(arguments, value, old);\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        if (value.isTrash()) {\n          this.setLabel(this.tr('Trash'));\n        } else {\n          value.bind('name', this, 'label');\n          value.bind('valid', this, 'status', {\n            converter: function (value) {\n              return value === true ? 'valid' : 'error';\n            }\n          });\n        }\n        value.bind('temporary', this, 'temporary');\n        if (value.getType() === 'dir') {\n          this.setDroppable(true);\n          this.addListener('drop', this._onDrop, this);\n        } else {\n          this.setDroppable(false);\n          this.removeListener('drop', this._onDrop, this);\n        }\n      }\n    },\n\n    _applyStatus: function (value) {\n      const control = this.getChildControl('icon');\n      if (value) {\n        switch (value) {\n          case 'valid':\n            control.removeState('error');\n            break;\n\n          case 'error':\n            control.addState('error');\n            break;\n        }\n      }\n    },\n\n    /**\n     * Handle drop events\n     * @param ev {Event}\n     * @private\n     */\n    _onDrop: function (ev) {\n      this.info(ev.getRelatedTarget());\n    },\n\n    __cancelEditing: function () {\n      this.getChildControl('edit').setValue(this.getName());\n      this.setEditing(false);\n    },\n\n    _onKeypress: function (ev) {\n      if (ev.getKeyIdentifier() === 'Enter') {\n        this.setEditing(false);\n      } else if (ev.getKeyIdentifier() === 'Esc') {\n        this.__cancelEditing();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'edit':\n           control = new qx.ui.form.TextField();\n           control.addListener('keypress', this._onKeypress, this);\n           control.exclude();\n           control.addListener('changeVisibility', function (ev) {\n              if (ev.getData() === 'visible') {\n                this.getChildControl('label').exclude();\n              } else {\n                this.getChildControl('label').show();\n              }\n           }, this);\n           control.addListener('blur', function () {\n             this.setEditing(false);\n           }, this);\n           this._add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  }\n});\n","/**\n * A qx.ui.form.ListItem with an additional label overlay over the icon to show the file type\n */\nqx.Class.define('cv.ui.manager.form.FileListItem', {\n  extend: qx.ui.core.Widget,\n  implement : [qx.ui.form.IModel],\n  include: [cv.ui.manager.upload.MDragUpload],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label, icon, model) {\n    this.base(arguments, label, icon);\n    const layout = new qx.ui.layout.Canvas();\n    layout.setDesktop(true);\n    this._setLayout(layout);\n\n    if (model) {\n      this.setModel(model);\n    }\n    this.addListener('pointerover', this._onPointerOver, this);\n    this.addListener('pointerout', this._onPointerOut, this);\n\n    cv.ui.manager.model.Preferences.getInstance().addListener('changeDefaultConfigEditor', this._maintainFileActions, this);\n\n    this.setUploadHint(this.tr('Drop the file here to replace the content.'));\n  },\n\n  /*\n  *****************************************************************************\n     EVENTS\n  *****************************************************************************\n  */\n  events: {\n    /** (Fired by {@link qx.ui.form.List}) */\n    'action' : 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-file-item'\n    },\n\n    model: {\n      nullable: true,\n      event: 'changeModel',\n      apply: '_applyModel',\n      dereference: true,\n      check: 'cv.ui.manager.model.FileItem'\n    },\n\n    /**\n     * Show the action buttons.\n     */\n    showFileActions: {\n      check: 'Boolean',\n      init: false,\n      apply: '_maintainFileActions'\n    },\n\n    /** The label/caption/text of the qx.ui.basic.Atom instance */\n    label: {\n      nullable: true,\n      check: 'String',\n      event: 'changeLabel'\n    },\n\n    /** Any URI String supported by qx.ui.basic.Image to display an icon */\n    icon: {\n      check: 'String',\n      nullable: true,\n      themeable: true,\n      event: 'changeIcon'\n    },\n\n    /**\n     * The space between the icon and the label\n     */\n    gap: {\n      check : 'Integer',\n      nullable : false,\n      event : 'changeGap',\n      themeable : true,\n      init : 4\n    },\n\n\n    /**\n     * Configure the visibility of the sub elements/widgets.\n     * Possible values: both, label, icon\n     */\n    show: {\n      init : 'both',\n      check : [ 'both', 'label', 'icon' ],\n      themeable : true,\n      inheritable : true,\n      event : 'changeShow'\n    },\n\n\n    /**\n     * The position of the icon in relation to the text.\n     * Only useful/needed if text and icon is configured and 'show' is configured as 'both' (default)\n     */\n    iconPosition: {\n      init   : 'left',\n      check : ['top', 'right', 'bottom', 'left', 'top-left', 'bottom-left', 'top-right', 'bottom-right'],\n      themeable : true,\n      event: 'changeIconPosition'\n    },\n\n\n    /**\n     * Whether the content should be rendered centrally when to much space\n     * is available. Enabling this property centers in both axis. The behavior\n     * when disabled of the centering depends on the {@link #iconPosition} property.\n     * If the icon position is <code>left</code> or <code>right</code>, the X axis\n     * is not centered, only the Y axis. If the icon position is <code>top</code>\n     * or <code>bottom</code>, the Y axis is not centered. In case of e.g. an\n     * icon position of <code>top-left</code> no axis is centered.\n     */\n    center : {\n      init : false,\n      check : 'Boolean',\n      themeable : true,\n      event: 'changeCenter'\n    },\n\n    /**\n     * Restrict possible file uploads (not supported by every browxer)\n     */\n    acceptUpload: {\n      init: null,\n      nullable: true,\n      check: 'String'\n    },\n\n    viewMode: {\n      check: ['list', 'preview'],\n      init: 'preview',\n      apply: '_applyViewMode'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    _uploadManager: null,\n\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates: {\n      focused : true,\n      selected : true,\n      dragover : true,\n      hovered: true\n    },\n\n    _applyViewMode: function () {\n      switch (this.getViewMode()) {\n        case 'list':\n          this.addState('list');\n          this.getChildControl('atom').setLayoutProperties({left: 10, top: 0, bottom: 0, right: null});\n          this.getChildControl('bottom-bar').setLayoutProperties({top: 0, bottom: 0, right: 0, left: null});\n          break;\n\n        case 'preview':\n          this.removeState('list');\n          this.getChildControl('atom').setLayoutProperties({left: 0, top: 0, bottom: 34, right: 0});\n          this.getChildControl('bottom-bar').setLayoutProperties({left: 0, bottom: 0, right: 0, top: null});\n          break;\n      }\n    },\n\n    /**\n     * Event handler for the pointer over event.\n     */\n    _onPointerOver : function() {\n      this.addState('hovered');\n    },\n\n\n    /**\n     * Event handler for the pointer out event.\n     */\n    _onPointerOut : function() {\n      this.removeState('hovered');\n    },\n\n    _isDroppable: function (files) {\n      if (files.length === 1) {\n        if (this.getModel().getSpecial() === 'add-file') {\n          return true;\n        }\n        const myMime = cv.ui.manager.tree.FileSystem.getMimetypeFromSuffix(this.getModel().getName().split('.').pop());\n        return myMime === files[0].type;\n      }\n      return false;\n    },\n\n    _onDrop: function (ev) {\n      ev.preventDefault();\n      if (this.getModel().getSpecial() === 'add-file') {\n        cv.ui.manager.upload.MDragUpload.uploadFile(cv.ui.manager.upload.MDragUpload.getFiles(ev)[0]);\n      } else {\n        qxl.dialog.Dialog.confirm(this.tr('Do you really want to replace the \\'%1\\' with the uploaded files content?', this.getModel().getName()), function (confirmed) {\n          if (confirmed) {\n            const newFile = cv.ui.manager.upload.MDragUpload.getFiles(ev)[0];\n            cv.ui.manager.upload.MDragUpload.uploadFile(newFile, this.getModel());\n          }\n        }, this);\n      }\n      this._onStopDragging(ev);\n    },\n\n    _applyModel: function (value) {\n      if (value && value.getType() === 'file') {\n        const control = this.getChildControl('file-type');\n        if (!value.isFake()) {\n          const name = value.getName();\n          this.getChildControl('atom').setToolTipText(this.tr('Double click to open \"%1\"', name));\n          let type = name.split('.').pop();\n\n          // do not use file types that are longer than 4 chars (not enough space)\n          if (type.length <= 4) {\n            let handled = false;\n            switch (type) {\n              case 'xml':\n                control.setValue('</>');\n                handled = true;\n                break;\n\n              case 'js':\n                type = qx.lang.String.firstUp(type); // jshint ignore:line\n              // eslint-disable-next-line no-fallthrough\n              case 'css':\n              case 'conf':\n                control.setValue(type);\n                handled = true;\n                break;\n            }\n            if (handled && this.getViewMode() === 'preview') {\n              control.show();\n            } else {\n              control.exclude();\n            }\n          } else {\n            control.exclude();\n          }\n        }\n      } else {\n        this.getChildControl('file-type').exclude();\n        this.getChildControl('atom').resetToolTipText();\n      }\n      // this.getChildControl('bottom-bar').show();\n      // this.setUploadHint(this.tr('Drop the file here to replace the content.'));\n      // this.getChildControl('atom').setToolTipText(this.tr('Double click to open'));\n      this._maintainFileActions();\n      // if (this._uploadManager) {\n      //   try {\n      //     this._uploadManager.removeWidget(this);\n      //   } catch (e) {}\n      // }\n    },\n\n    _onOpenWith: function (ev) {\n      const handlerId = ev.getTarget().getUserData('handlerId');\n      qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n        file: this.getModel(),\n        handler: handlerId\n      });\n    },\n\n    _applyIcon: function (value, old) {\n      this.base(arguments, value, old);\n      if (value && !value.startsWith('@')) {\n        const control = this.getChildControl('atom').getChildControl('icon');\n        if (!cv.ui.manager.viewer.Image.getImageData(value)) {\n          // wait for image to be loaded\n          control.addListenerOnce('loaded', this.__scaleWithAspect, this);\n        } else {\n          this.__scaleWithAspect();\n        }\n      }\n    },\n\n    _maintainFileActions: function () {\n      const file = this.getModel();\n      if (this.isShowFileActions() && file) {\n        this.getChildControl('download-button').setVisibility(file.getType() === 'dir' || file.isFake() ? 'excluded' : 'visible');\n        this.getChildControl('action-button').setVisibility(file.isFake() ? 'excluded' : 'visible');\n        const editorConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, 'edit');\n        const viewerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, 'view');\n        const openButton = this.getChildControl('open-button');\n        const editButton = this.getChildControl('edit-button');\n        if (file.isWriteable() && editorConf) {\n          editButton.setUserData('handlerId', editorConf.Clazz.classname);\n          editButton.set({\n            icon: editorConf.Clazz.ICON || cv.theme.dark.Images.getIcon('edit', 18),\n            enabled: true,\n            toolTipText: editorConf.Clazz.TITLE ? editorConf.Clazz.TITLE.translate().toString() : ''\n          });\n          editButton.show();\n        } else {\n          editButton.exclude();\n        }\n        if (viewerConf) {\n          openButton.setUserData('handlerId', viewerConf.Clazz.classname);\n          openButton.set({\n            icon: viewerConf.Clazz.ICON || cv.theme.dark.Images.getIcon('preview', 18),\n            enabled: true,\n            toolTipText: viewerConf.Clazz.TITLE ? viewerConf.Clazz.TITLE.translate().toString() : ''\n          });\n          openButton.show();\n        } else {\n          openButton.exclude();\n        }\n        this.getChildControl('action-button');\n        this.getChildControl('bottom-bar').show();\n      } else {\n        this.getChildControl('bottom-bar').exclude();\n      }\n    },\n\n    __scaleWithAspect: function () {\n      const data = cv.ui.manager.viewer.Image.getImageData(this.getIcon());\n      const control = this.getChildControl('atom').getChildControl('icon');\n      const sizeHint = control.getSizeHint();\n      let width = sizeHint.width;\n      let height = Math.round(1 / data.aspectRatio * width);\n      const padding = [0, 0, 0, 0];\n      if (height > sizeHint.height) {\n        height = sizeHint.height;\n        width = Math.round(data.aspectRatio * height);\n        padding[1] = Math.round((sizeHint.width - width) / 2);\n        padding[3] = padding[1];\n      } else {\n        padding[0] = Math.round((sizeHint.height - height) / 2);\n        padding[2] = padding[0];\n      }\n      control.setPadding(padding);\n    },\n\n    _maintainFileTypePosition: function () {\n      const iconBounds = this.getChildControl('atom').getChildControl('icon').getBounds();\n      const top = Math.round(iconBounds.top + iconBounds.height / 2);\n      this.getChildControl('file-type').setLayoutProperties({\n        left: iconBounds.left,\n        top: top,\n        right: iconBounds.left + iconBounds.width,\n        bottom: top + 18\n      });\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n        case 'atom':\n          control = new qx.ui.basic.Atom();\n          ['label', 'icon', 'gap', 'iconPosition', 'show', 'center'].forEach(function (prop) {\n            this.bind(prop, control, prop);\n          }, this);\n          control.setAnonymous(true);\n          this._add(control, {top: 0, left: 0, right: 0, bottom: 34});\n          break;\n\n        case 'file-type': {\n          control = new qx.ui.basic.Label();\n          control.set({\n            zIndex: 100,\n            anonymous: true,\n            font: 'title',\n            textAlign: 'center',\n            textColor: 'background-main',\n            minWidth: 70\n          });\n          const icon = this.getChildControl('atom').getChildControl('icon');\n          icon.bind('visibility', control, 'visibility');\n          icon.addListener('resize', this._maintainFileTypePosition, this);\n          this._add(control, {width: '100%'});\n          break;\n        }\n\n        case 'bottom-bar':\n          control = new qx.ui.container.Composite(new qx.ui.layout.HBox(4, 'center'));\n          control.setAnonymous(true);\n          this._add(control, {left: 0, bottom: 0, right: 0});\n          break;\n\n        case 'download-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('download', 18));\n          control.setToolTipText(this.tr('Download file'));\n          control.addListener('execute', function () {\n            cv.ui.manager.control.FileController.getInstance().download(this.getModel());\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n\n        case 'action-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('menu', 18));\n          control.setToolTipText(this.tr('Other file actions'));\n          this.getChildControl('bottom-bar').add(control);\n          control.addListener('tap', function (ev) {\n            this.fireEvent('action', qx.event.type.Tap, [ev.getNativeEvent(), this, ev.getTarget(), false, true]);\n          }, this);\n          break;\n\n        case 'open-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('preview', 18));\n          control.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n              file: this.getModel(),\n              handler: control.getUserData('handlerId')\n            });\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n\n        case 'edit-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('preview', 18));\n          control.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n              file: this.getModel(),\n              handler: control.getUserData('handlerId')\n            });\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n      }\n      if (!control) {\n        control = this._createMDragUploadChildControlImpl(id);\n      }\n\n      return control || this.base(arguments, id);\n    },\n\n    // overridden\n    capture: function () {\n      // do not fire capture method for upload-items (see: com.zenesis.qx.upload.MUploadButton)\n      if (!this.getFile() || this.getFile().getSpecial() !== 'add-file') {\n        this.base(arguments);\n      }\n    },\n\n    // overridden\n    releaseCapture: function() {\n      // do not fire capture method for upload-items (see: com.zenesis.qx.upload.MUploadButton)\n      if (!this.getFile() || this.getFile().getSpecial() !== 'add-file') {\n        this.base(arguments);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.removeListener('pointerover', this._onPointerOver, this);\n    this.removeListener('pointerout', this._onPointerOut, this);\n\n    this._disposeObjects('_uploadManager');\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeDefaultConfigEditor', this._maintainFileActions, this);\n  }\n});\n","/**\n * Atom with cv.ui.manager.viewer.SvgIcon instead ob an qx.ui.basic.Image\n */\nqx.Class.define('cv.ui.manager.core.IconAtom', {\n  extend: qx.ui.basic.Atom,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-icon'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyLabel: function (value) {\n      this.base(arguments, value);\n      this.getChildControl('icon').setName(value);\n    },\n\n    /**\n     * Updates the visibility of the icon\n     */\n    _handleIcon : function() {\n      if (!this.getChildControl('icon').getName() || this.getShow() === 'label') {\n        this._excludeChildControl('icon');\n      } else {\n        this._showChildControl('icon');\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new cv.ui.manager.viewer.SvgIcon();\n           control.setAnonymous(true);\n           this._addAt(control, 0);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  }\n});\n","/**\n * XSD-based code completion provider for the monaco text editor.\n *\n * @since 0.11.0\n * @author Tobias Brutigam\n */\nqx.Class.define('cv.ui.manager.editor.completion.Config', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   *\n   * @param schema {cv.ui.manager.model.Schema}\n   */\n  construct: function (schema) {\n    this.base(arguments);\n    this.__elementCache = {};\n    this._schema = schema;\n    this._dataProvider = cv.ui.manager.editor.data.Provider.getInstance();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __elementCache: null,\n    __metaElementCache: null,\n    _dataProvider: null,\n\n    getLastOpenedTag: function (text) {\n      // get all tags inside of the content\n      const tags = text.match(/<\\/*(?=\\S*)([a-zA-Z-]+)/g);\n      if (!tags) {\n        return null;\n      }\n      // we need to know which tags are closed\n      const closingTags = [];\n      for (let i = tags.length - 1; i >= 0; i--) {\n        if (tags[i].indexOf('</') === 0) {\n          closingTags.push(tags[i].substring('</'.length));\n        } else {\n          // get the last position of the tag\n          const tagPosition = text.lastIndexOf(tags[i]);\n          const tag = tags[i].substring('<'.length);\n          const closingBracketIdx = text.indexOf('/>', tagPosition);\n          // if the tag wasn't closed\n          if (closingBracketIdx === -1) {\n            // if there are no closing tags or the current tag wasn't closed\n            if (!closingTags.length || closingTags[closingTags.length - 1] !== tag) {\n              // we found our tag, but let's get the information if we are looking for\n              // a child element or an attribute\n              text = text.substring(tagPosition);\n\n              const openedTag = text.indexOf('<') > text.indexOf('>');\n              let contentSearch = false;\n              let currentAttribute = null;\n              if (openedTag) {\n                const attrMatch = /([\\w\\-_\\.\\d]+)=\"[^\"]*$/.exec(text);\n                contentSearch = !!attrMatch;\n                currentAttribute = attrMatch ? attrMatch[1] : null;\n              }\n              const filteredElementSearch = /<[\\w-_\\d]+$/.test(text);\n              return {\n                tagName: tag,\n                currentAttribute: currentAttribute,\n                filteredElementSearch: filteredElementSearch,\n                isAttributeSearch: !filteredElementSearch && openedTag && !contentSearch,\n                isContentSearch: contentSearch,\n                text: text\n              };\n            }\n            // remove the last closed tag\n            closingTags.splice(closingTags.length - 1, 1);\n          }\n          // remove the last checked tag and continue processing the rest of the content\n          text = text.substring(0, tagPosition);\n        }\n      }\n      return null;\n    },\n\n    findElements: function (parent, elementName, maxDepth, currentDepth, inMeta) {\n      const cache = inMeta === true ? this.__metaElementCache : this.__elementCache;\n      if (elementName in cache) {\n        return cache[elementName];\n      }\n      if (maxDepth < currentDepth) {\n        return null;\n      }\n      if (!parent) {\n        parent = this._schema.getElementNode('pages');\n      }\n      if (currentDepth === undefined) {\n        currentDepth = 1;\n      }\n      const allowedElements = parent.getAllowedElements();\n      // console.log(parent.name+\" looking for \"+elementName+\" in tree level \"+currentDepth+ \"(<\"+maxDepth+\") (\"+Object.getOwnPropertyNames(allowedElements).join(\", \")+\")\");\n      if (elementName in allowedElements) {\n        // console.log(\"found \"+elementName+\" in tree level \"+currentDepth);\n        this.__elementCache[elementName] = allowedElements[elementName];\n        return allowedElements[elementName];\n      }\n      for (let element in allowedElements) {\n        if (inMeta !== true && element === 'meta') {\n          continue;\n        }\n        if (maxDepth > currentDepth) {\n          const result = this.findElements(allowedElements[element], elementName, maxDepth, currentDepth + 1);\n          if (result) {\n            cache[elementName] = result;\n            // console.log(\"found \" + elementName + \" in tree level \" + currentDepth);\n            return result;\n          }\n        }\n      }\n      return null;\n    },\n\n    isItemAvailable: function (itemName, maxOccurs, items) {\n      // the default for 'maxOccurs' is 1\n      maxOccurs = maxOccurs || '1';\n      // the element can appere infinite times, so it is available\n      if (maxOccurs && maxOccurs === 'unbounded') {\n        return true;\n      }\n      // count how many times the element appeared\n      let count = 0;\n      for (let i = 0; i < items.length; i++) {\n        if (items[i] === itemName) {\n          count++;\n        }\n      }\n      // if it didn't appear yet, or it can appear again, then it\n      // is available, otherwise it't not\n      return count === 0 || parseInt(maxOccurs) > count;\n    },\n\n    getElementString: function (element, indent, prefix) {\n      let insertText = indent + prefix + element.getName() + ' ';\n      // add all required attributes with default values\n      const allowedAttributes = element.getAllowedAttributes();\n      Object.getOwnPropertyNames(allowedAttributes).forEach(function(attr) {\n        const attribute = allowedAttributes[attr];\n        if (!attribute.isOptional) {\n          insertText += attr+'=\"'+(attribute.getDefaultValue() ? attribute.getDefaultValue() : '')+'\" ';\n        }\n      });\n      // add mandatory children\n      const requiredElements = element.getRequiredElements();\n      const allowedContent = element.getAllowedContent();\n      const isContentAllowed = allowedContent._text || requiredElements.length > 0 || !!allowedContent._grouping;\n      if (!isContentAllowed) {\n        // close tag\n        insertText = insertText.trim()+'/';\n      } else {\n        // close open tag\n        insertText = insertText.trim()+'>';\n\n        // insert required elements\n        let children = 0;\n        requiredElements.forEach(function(elemName) {\n          const elem = this.findElements(element, elemName, 1, 0);\n          if (elem) {\n            insertText += '\\n    ' + this.getElementString(elem, indent + '    ', '<') + '>';\n            children++;\n          }\n        }, this);\n        // add closing tag\n        if (children > 0) {\n          insertText += '\\n'+indent;\n        }\n        insertText += '</'+element.getName();\n      }\n      return insertText;\n    },\n\n    getAvailableElements: function (element, usedItems) {\n      const availableItems = [];\n      const children = element.getAllowedElements();\n\n      // if there are no such elements, then there are no suggestions\n      if (!children) {\n        return [];\n      }\n      Object.getOwnPropertyNames(children).filter(name => !name.startsWith('#')).forEach(function(name) {\n        // get all element attributes\n        const childElem = children[name];\n        // the element is a suggestion if it's available\n        if (this.isItemAvailable(childElem.getName(), childElem.getBounds().max, usedItems)) {\n          // mark it as a 'field', and get the documentation\n          availableItems.push({\n            label: childElem.getName(),\n            insertText: this.getElementString(childElem, '', ''),\n            kind: window.monaco.languages.CompletionItemKind.Field,\n            detail: childElem.getType(),\n            documentation: childElem.getDocumentation().join('\\n')\n          });\n        }\n      }, this);\n      // return the suggestions we found\n      return availableItems;\n    },\n\n    getAvailableAttributes: function (element, usedChildTags) {\n      const availableItems = [];\n      // get all attributes for the element\n      const attrs = element.getAllowedAttributes();\n      Object.getOwnPropertyNames(attrs).forEach(function(name) { // jshint ignore:line\n        const attr = attrs[name];\n        // accept it in a suggestion list only the attribute is not used yet\n        if (usedChildTags.indexOf(attr.name) === -1) {\n          // mark it as a 'property', and get it's documentation\n          availableItems.push({\n            label: attr.getName(),\n            insertText: attr.getName()+'=\"\"',\n            kind: window.monaco.languages.CompletionItemKind.Property,\n            detail: attr.getTypeString(),\n            documentation: attr.getDocumentation().join('\\n')\n          });\n        }\n      }, this);\n\n      // return the elements we found\n      return availableItems;\n    },\n\n    getProvider: function () {\n      return {\n        triggerCharacters: ['<', '\"'],\n        provideCompletionItems: function (model, position) {\n          // get editor content before the pointer\n          const textUntilPosition = model.getValueInRange({\n            startLineNumber: 1,\n            startColumn: 1,\n            endLineNumber: position.lineNumber,\n            endColumn: position.column\n          });\n          // parse mappings\n          const completeText = model.getValue();\n          const metaEndPos = completeText.indexOf('</meta>');\n          const textMeta = metaEndPos > 0 ? completeText.substring(0, metaEndPos) : completeText;\n          const mappingNames = [];\n          const stylingNames = [];\n          const templates = {};\n          let map;\n          let vmap;\n          let regex = /<mapping name=\"([^\"]+)\"/gm;\n          while ((map = regex.exec(textMeta)) !== null) {\n            mappingNames.push(map[1]);\n          }\n          regex = /<styling name=\"([^\"]+)\"/gm;\n          while ((map = regex.exec(textMeta)) !== null) {\n            stylingNames.push(map[1]);\n          }\n          const templatesStart = textMeta.indexOf('<templates>');\n          if (templatesStart >= 0) {\n            const templatesString = textMeta.substring(templatesStart + 11, textMeta.indexOf('</templates>') - 12).replace(/(?:\\r\\n|\\r|\\n)/g, '');\n            templatesString.split('</template>').forEach(function (rawTemplate) {\n              const nameMatch = /<template name=\"([^\"]+)\"/.exec(rawTemplate);\n              // search for variables\n              const variables = [];\n              const vregex = /{{{?\\s*([\\w\\d]+)\\s*}?}}/gm;\n              while ((vmap = vregex.exec(rawTemplate)) !== null) {\n                variables.push(vmap[1]);\n              }\n              templates[nameMatch[1]] = variables;\n            }, this);\n          }\n\n          // if we want suggestions, inside of which tag are we?\n          const lastOpenedTag = this.getLastOpenedTag(textUntilPosition);\n          // console.log(lastOpenedTag);\n          // get opened tags to see what tag we should look for in the XSD schema\n          const openedTags = [];\n          // attrobutes of the ancestors\n          const openedAttributes = [];\n          // get the elements/attributes that are already mentioned in the element we're in\n          const usedItems = [];\n          const isAttributeSearch = lastOpenedTag && lastOpenedTag.isAttributeSearch;\n          const isContentSearch = lastOpenedTag && lastOpenedTag.isContentSearch;\n          const filteredElementSearch = lastOpenedTag && lastOpenedTag.filteredElementSearch;\n          // no need to calculate the position in the XSD schema if we are in the root element\n          let parts;\n          if (lastOpenedTag) {\n            // try to create a valid XML document\n            parts = lastOpenedTag.text.split(' ');\n            parts.shift();\n            let cleanedText = textUntilPosition;\n            if (parts.length) {\n              cleanedText = cleanedText.substring(0, cleanedText.length-parts.join(' ').length)+'>';\n            }\n            // parse the content (not cleared text) into an xml document\n            const xmlDoc = qx.xml.Document.fromString(cleanedText);\n            let lastChild = xmlDoc.lastElementChild;\n            let i;\n            let lastFound = false;\n            while (lastChild) {\n              openedTags.push(lastChild.tagName);\n              openedAttributes.push(lastChild.attributes);\n              // if we found our last opened tag\n              if (lastChild.tagName === lastOpenedTag.tagName) {\n                lastFound = true;\n                // if we are looking for attributes, then used items should\n                // be the attributes we already used\n                if (lastOpenedTag.isAttributeSearch && lastChild.outerHTML === lastOpenedTag.text) {\n                  const attrs = lastChild.attributes;\n                  for (i = 0; i < attrs.length; i++) {\n                    usedItems.push(attrs[i].nodeName);\n                  }\n                } else {\n                  // if we are looking for child elements, then used items\n                  // should be the elements that were already used\n                  const children = lastChild.children;\n                  for (i = 0; i < children.length; i++) {\n                    if (children[i].tagName.toLowerCase() !== 'parsererror') {\n                      usedItems.push(children[i].tagName);\n                    }\n                  }\n                }\n                break;\n              }\n              // we haven't found the last opened tag yet, so we move to\n              // the next element\n              lastChild = lastChild.lastElementChild;\n            }\n            if (!lastFound) {\n              // fallback -> parse string\n              if (isAttributeSearch || isContentSearch) {\n                parts = lastOpenedTag.text.split(' ');\n                // skip tag name\n                parts.shift();\n                parts.forEach(function(entry) {\n                  usedItems.push(entry.split('=').shift());\n                });\n              }\n            }\n          }\n          let res = [];\n          let match;\n          // find the last opened tag in the schema to see what elements/attributes it can have\n          let searchedElement = openedTags[openedTags.length - 1];\n          if (isContentSearch) {\n            // handle data providers if the is one relevant\n            if (lastOpenedTag.tagName === 'pages' && lastOpenedTag.currentAttribute === 'design') {\n              return this._dataProvider.getDesigns().then(function (sugg) {\n                return {suggestions: sugg};\n              });\n            } else if (lastOpenedTag.tagName === 'address' && lastOpenedTag.currentAttribute === 'transform') {\n              return {suggestions: this._dataProvider.getTransforms()};\n            } else if (lastOpenedTag.tagName === 'plugin' && lastOpenedTag.currentAttribute === 'name') {\n              return {suggestions: this._dataProvider.getPlugins()};\n            } else if (lastOpenedTag.tagName === 'icon' && lastOpenedTag.currentAttribute === 'name') {\n              return {suggestions: this._dataProvider.getIcons()};\n            } else if (lastOpenedTag.tagName === 'influx') {\n              if (lastOpenedTag.currentAttribute === 'measurement') {\n                return this._dataProvider.getInfluxDBs().then(function (suggestions) {\n                  return {suggestions: suggestions};\n                });\n              } else if (lastOpenedTag.currentAttribute === 'field') {\n                match = /measurement=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n                if (match) {\n                  return this._dataProvider.getInfluxDBFields(match[1]).then(function (suggestions) {\n                    return {suggestions: suggestions};\n                  });\n                }\n              }\n            } else if (lastOpenedTag.tagName === 'tag' && (lastOpenedTag.currentAttribute === 'key' || lastOpenedTag.currentAttribute === 'value') && openedTags.includes('influx')) {\n              const influxAttributes = openedAttributes[openedTags.indexOf('influx')];\n              const attr = influxAttributes.getNamedItem('measurement');\n              if (attr) {\n                if (lastOpenedTag.currentAttribute === 'key') {\n                  return this._dataProvider.getInfluxDBTags(attr.value).then(function (suggestions) {\n                    return {suggestions: suggestions};\n                  });\n                } else if (lastOpenedTag.currentAttribute === 'value') {\n                  match = /key=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n                  if (match) {\n                    return this._dataProvider.getInfluxDBValues(attr.value, match[1]).then(function (suggestions) {\n                      return {suggestions: suggestions};\n                    });\n                  }\n                }\n              }\n            } else if (lastOpenedTag.tagName === 'template' && lastOpenedTag.currentAttribute === 'name' && openedTags.includes('meta')) {\n              res = Object.keys(templates).map(function (name) {\n                return {\n                  label: name,\n                  insertText: name,\n                  kind: window.monaco.languages.CompletionItemKind.EnumMember\n                };\n              }, this);\n              return {suggestions: res};\n            } else if (lastOpenedTag.tagName === 'value' &&\n              lastOpenedTag.currentAttribute === 'name' &&\n              !openedTags.includes('meta') &&\n              openedTags.includes('template')) {\n              // TODO: find out template name\n              const templateNames = Object.keys(templates);\n              templateNames.forEach(function (name) {\n                templates[name].forEach(function (variableName) {\n                  res.push({\n                    label: variableName,\n                    insertText: variableName,\n                    detail: qx.locale.Manager.tr('Variable from template %1', name),\n                    kind: window.monaco.languages.CompletionItemKind.Variable\n                  });\n                }, this);\n              }, this);\n              return {suggestions: res};\n            } else if (lastOpenedTag.currentAttribute === 'mapping') {\n              res = mappingNames.map(function (mappingName) {\n                return {\n                  label: mappingName,\n                  insertText: mappingName,\n                  kind: window.monaco.languages.CompletionItemKind.EnumMember\n                };\n              }, this);\n              return {suggestions: res};\n            } else if (lastOpenedTag.currentAttribute === 'styling') {\n              res = stylingNames.map(function (stylingName) {\n                return {\n                  label: stylingName,\n                  insertText: stylingName,\n                  kind: window.monaco.languages.CompletionItemKind.EnumMember\n                };\n              }, this);\n              return {suggestions: res};\n            }\n\n            // TODO: completions that have to be retrieved from the backend\n            // * rrds\n            // * Influx: dbs, tags fields\n            // * media files\n\n            searchedElement = lastOpenedTag.tagName;\n          } else if (!isAttributeSearch && filteredElementSearch) {\n            searchedElement = openedTags[openedTags.length-2];\n          } else if (lastOpenedTag.tagName === 'address' && lastOpenedTag.currentAttribute === null) {\n            return this._dataProvider.getAddresses('monaco').then(res => ({suggestions: res}));\n          }\n          if (searchedElement === 'rrd') {\n            return this._dataProvider.getRrds('monaco').then(res => ({suggestions: res}));\n          } else if (searchedElement === 'file' && !isAttributeSearch && !isContentSearch && openedTags.includes('files')) {\n            match = /type=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n            const typeFilter = match ? match[1] : null;\n            return this._dataProvider.getMediaFiles(typeFilter).then(function (suggestions) {\n              return {suggestions: suggestions};\n            });\n          }\n          const currentItem = this.findElements(this._schema.getElementNode('pages'), searchedElement, openedTags.length, openedTags.includes('meta'));\n\n          // return available elements/attributes if the tag exists in the schema, or an empty\n          // array if it doesn't\n          if (isContentSearch) {\n            const currentAttribute = usedItems[usedItems.length - 1];\n\n            if (currentItem && currentAttribute in currentItem.getAllowedAttributes()) {\n              const attribute = currentItem.getAllowedAttributes()[currentAttribute];\n              const type = attribute.getTypeString();\n              attribute.getEnumeration().forEach(function(entry) {\n                res.push({\n                  label: entry,\n                  kind: window.monaco.languages.CompletionItemKind.Value,\n                  detail: type,\n                  documentation: attribute.getDocumentation().join('\\n')\n                });\n              });\n            }\n          } else if (isAttributeSearch) {\n            // get attributes completions\n            res = currentItem ? this.getAvailableAttributes(currentItem, usedItems) : [];\n          } else {\n            // get elements completions\n            // eslint-disable-next-line no-lonely-if\n            if (lastOpenedTag && lastOpenedTag.text.endsWith('</')) {\n              res.push({\n                label: lastOpenedTag.tagName,\n                kind: window.monaco.languages.CompletionItemKind.Field\n              });\n            } else {\n              res = currentItem ? this.getAvailableElements(currentItem, usedItems) : [];\n            }\n          }\n          return {suggestions: res};\n        }.bind(this)\n      };\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__elementCache = null;\n    this._schema = null;\n    this._dataProvider = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.Schema', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (filename) {\n    this.base(arguments);\n    if (!filename || !filename.match(/\\.xsd$/)) {\n      throw new Error('no, empty or invalid filename given, can not instantiate without one');\n    }\n    this.__filename = filename;\n    this.__allowedRootElements = {};\n    this.__referencedNodeCache = {};\n    this.__typeNodeCache = {};\n    this._cacheXSD();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    __CACHE: {},\n\n    getInstance: function (schemaFile) {\n      if (!Object.prototype.hasOwnProperty.call(this.__CACHE, schemaFile)) {\n        this.__CACHE[schemaFile] = new cv.ui.manager.model.Schema(qx.util.ResourceManager.getInstance().toUri(schemaFile));\n      }\n      return this.__CACHE[schemaFile];\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    loaded: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeLoaded'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __filename: null,\n    /**\n     * object of the schema/xsd\n     * @var object\n     */\n    __xsd: null,\n\n    /**\n     * object of allowed root-level elements\n     * @var object\n     */\n    __allowedRootElements: null,\n\n    /**\n     * cache for referenced nods\n     * @var object\n     */\n    __referencedNodeCache: null,\n\n    /**\n     * cache for getTypeNode\n     * @var object\n     */\n    __typeNodeCache: null,\n\n    /**\n     * cache for #text-SchemaElement\n     * @var object\n     */\n    __textNodeSchemaElement: null,\n\n    /**\n     * cache for #comment-SchemaElement\n     * @var object\n     */\n    __commentNodeSchemaElement: null,\n\n    /**\n     * @var {Array<String>}\n     */\n    _widgetNames: null,\n\n    onLoaded: function (callback, context) {\n      if (this.isLoaded()) {\n        callback.call(context);\n      } else {\n        this.addListenerOnce('changeLoaded', callback, context);\n      }\n    },\n\n    /**\n     * load and cache the xsd from the server\n     */\n    _cacheXSD: function () {\n      const ajaxRequest = new qx.io.request.Xhr(this.__filename);\n      ajaxRequest.set({\n        accept: 'application/xml'\n      });\n      ajaxRequest.addListenerOnce('success', function (e) {\n        const req = e.getTarget();\n        // Response parsed according to the server's response content type\n        let xml = req.getResponse();\n        if (xml && (typeof xml === 'string')) {\n          xml = qx.xml.Document.fromString(xml);\n        }\n        this.__xsd = xml;\n\n        // parse the data, to have at least a list of root-level-elements\n        this._parseXSD();\n      }, this);\n      ajaxRequest.send();\n    },\n\n    /**\n     * parse the schema once\n     */\n    _parseXSD: function () {\n      // make a list of root-level elements\n      this.__xsd.querySelectorAll('schema > element').forEach(element => {\n        const name = element.getAttribute('name');\n        this.__allowedRootElements[name] = new cv.ui.manager.model.schema.Element(element, this);\n      });\n      this.setLoaded(true);\n    },\n\n    getElementNode: function (name) {\n      if (Object.prototype.hasOwnProperty.call(this.__allowedRootElements, name)) {\n        return this.__allowedRootElements[name];\n      }\n      throw new Error('schema/xsd appears to be invalid, element ' + name + ' not allowed on root level');\n    },\n\n    /**\n     * dive into the schema and find the element that is being pulled in by a ref.\n     * Do so recursively.\n     * referenced nodes can be top-level-nodes only!\n     *\n     * @param   type    string  Type of the node (e.g. element, attributeGroup, ...)\n     * @param   refName string  Name as per the ref-attribute\n     * @return  object          jQuery-object of the ref'ed element\n     */\n    getReferencedNode: function (type, refName) {\n      if (Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type) && Object.prototype.hasOwnProperty.call(this.__referencedNodeCache[type], refName)) {\n        return this.__referencedNodeCache[type][refName];\n      }\n\n      const selector = 'schema > ' + type + '[name=\"' + refName + '\"]';\n      let ref = this.__xsd.querySelector(selector);\n      if (!ref) {\n        throw new Error('schema/xsd appears to be invalid, reference ' + type + '\"' + refName + '\" can not be found');\n      }\n\n      if (ref.hasAttribute('ref')) {\n        // do it recursively, if necessary\n        ref = this.getReferencedNode(type, ref.getAttribute('ref'));\n      }\n\n      if (!Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type)) {\n        this.__referencedNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__referencedNodeCache[type][refName] = ref;\n\n      return ref;\n    },\n\n\n    /**\n     * get the definition of a type, be it complex or simple\n     *\n     * @param   type    string  Type of type to find (either simple or complex)\n     * @param   name    string  Name of the type to find\n     */\n    getTypeNode: function (type, name) {\n      if (Object.prototype.hasOwnProperty.call(this.__typeNodeCache, type) && Object.prototype.hasOwnProperty.call(this.__typeNodeCache[type], name)) {\n        return this.__typeNodeCache[type][name];\n      }\n      let typeNode = this.__xsd.querySelector(type + 'Type[name=\"' + name + '\"]');\n\n      if (!typeNode) {\n        throw new Error('schema/xsd appears to be invalid, ' + type + 'Type \"' + name + '\" can not be found');\n      }\n\n      if (typeof this.__typeNodeCache[type] == 'undefined') {\n        this.__typeNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__typeNodeCache[type][name] = typeNode;\n\n      return typeNode;\n    },\n\n    /**\n     * get a SchemaElement for a #text-node\n     *\n     * @return  object  SchemaElement for #text-node\n     */\n    getTextNodeSchemaElement: function () {\n      if (this.__textNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#text');\n        tmpXML.setAttribute('type', 'xsd:string');\n        this.__textNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__textNodeSchemaElement;\n    },\n\n    /**\n     * get a SchemaElement for a #comment-node\n     *\n     * @return  object  SchemaElement for #comment-node\n     */\n    getCommentNodeSchemaElement: function () {\n      if (this.__commentNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#comment');\n        tmpXML.setAttribute('type', 'xsd:string');\n        tmpXML.setAttribute('minOccurs', '0');\n        tmpXML.setAttribute('maxOccurs', 'unbounded');\n        this.__commentNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__commentNodeSchemaElement;\n    },\n\n    /**\n     * get the DOM for this Schema\n     *\n     * @return  object  DOM\n     */\n    getSchemaDOM: function () {\n      return this.__xsd;\n    },\n\n    /**\n     * A CometVisu-Schema specific helper function that returns an array of all widget names.\n     * @returns {Array<String>}\n     */\n    getWidgetNames: function () {\n      if (!this._widgetNames) {\n        const pages = this.getElementNode('pages');\n        const page = pages.getSchemaElementForElementName('page');\n        this._widgetNames = Object.keys(page.getAllowedElements()).filter(name => !name.startsWith('#') && name !== 'layout');\n      }\n      return this._widgetNames;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__xsd = null;\n    this._disposeObjects('__commentNodeSchemaElement', '__textNodeSchemaElement');\n    this._disposeMap('__allowedRootElements');\n    this.__referencedNodeCache = null;\n    this.__typeNodeCache = null;\n    this._widgetNames = null;\n  }\n});\n\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.editor.completion.CometVisu', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    TEMPLATES: null,\n\n    getTemplates: function () {\n      if (!this.TEMPLATES) {\n        this.TEMPLATES = [{\n          filterText: 'cvclass',\n          label: 'CometVisu-Class',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A generic CometVisu class.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Class.define(\"cv.$0\", {\\n  extend: qx.core.Object,\\n\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvwidget',\n          label: 'CometVisu-Widget',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A CometVisu class for a widget.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Class.define(\"cv.ui.structure.pure.$0\", {\\n  extend: cv.ui.structure.AbstractWidget,\\n\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvinterface',\n          label: 'CometVisu-Interface',\n          kind: window.monaco.languages.CompletionItemKind.Interface,\n          detail: 'A generic CometVisu Interface.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Interface.define(\"cv.$0\", {\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvmixin',\n          label: 'CometVisu-Mixin',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A generic CometVisu Mixin.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Mixin.define(\"cv.$0\", {\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvmembers',\n          label: 'CometVisu-Class members',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'A CometVisu classes members section.',\n          insertText: '  /*\\n  ***********************************************\\n    MEMBERS\\n  ***********************************************\\n  */\\n  members: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvproperties',\n          label: 'CometVisu-Class properties',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'A CometVisu classes properties section.',\n          insertText: '  /*\\n  ***********************************************\\n    PROPERTIES\\n  ***********************************************\\n  */\\n  properties: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvstatics',\n          label: 'CometVisu-Class statics',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'statics section.',\n          insertText: '  /*\\n  ***********************************************\\n    STATICS\\n  ***********************************************\\n  */\\n  statics: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvevents',\n          label: 'CometVisu-Class events',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'events section.',\n          insertText: '  /*\\n  ***********************************************\\n    EVENTS\\n  ***********************************************\\n  */\\n  events: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvconstructor',\n          label: 'Constructor',\n          kind: window.monaco.languages.CompletionItemKind.Method,\n          detail: 'constructor.',\n          insertText: '  /*\\n  ***********************************************\\n    CONSTRUCTOR\\n  ***********************************************\\n  */\\n  construct: function () {\\n    this.base(arguments);\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvdestructor',\n          label: 'Destructor',\n          kind: window.monaco.languages.CompletionItemKind.Method,\n          detail: 'destructor.',\n          insertText: '  /*\\n  ***********************************************\\n    DESTRUCTOR\\n  ***********************************************\\n  */\\n  destruct: function () {\\n    this.base(arguments);\\n    $0\\n  }\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }];\n\n        // load plugin template from backend\n        return new Promise(function (resolve, reject) {\n          cv.io.rest.Client.getFsClient().readSync({path: '.templates/Plugin.js'}, function (err, res) {\n            if (err) {\n              reject(err);\n            } else {\n              this.TEMPLATES.push({\n                filterText: 'cvplugin',\n                label: 'CometVisu-Plugin',\n                kind: window.monaco.languages.CompletionItemKind.Class,\n                detail: 'A CometVisu class for a plugin.',\n                insertText: res.replace('###SINCE###', cv.Version.VERSION.replace('-dev', '')+ ' ($CURRENT_YEAR)'),\n                insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n              });\n              resolve(this.TEMPLATES);\n            }\n          }, this);\n        }.bind(this));\n      }\n      return Promise.resolve(this.TEMPLATES);\n    },\n\n    getProvider: function () {\n      return {\n        triggerCharacters: ['cv'],\n        provideCompletionItems: function () {\n          // get editor content before the pointer\n          return this.getTemplates().then(function (sugg) {\n            return {suggestions: sugg};\n          });\n        }.bind(this)\n      };\n    }\n  }\n});\n","/**\n * An atomic change on an cv.ui.manager.model.XmlElement that can be undone / redone.\n */\nqx.Class.define('cv.ui.manager.model.ElementChange', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (title, element, changes, type) {\n    this.base(arguments);\n    this.setTitle(title);\n    this.setElement(element);\n    this.setChanges(changes);\n    this.setChangeType(type || 'content');\n  },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement'\n    },\n    title: {\n      check: 'String'\n    },\n    changes: {\n      check: 'Array'\n    },\n    changeType: {\n      check: ['content', 'created', 'deleted', 'moved'],\n      init: ['content']\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * Undo all changes\n     * @return {Boolean} true if all changes are undone\n     */\n    undo: function() {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.undo();\n              } else {\n                element.setAttribute(change.attribute, change.old);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.child) {\n              change.child.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.oldParent, change.oldIndex, true);\n            break;\n        }\n      }\n      return success;\n    },\n\n    /**\n     * Redo all change\n     *  @return {Boolean} true if all changes are redone\n     */\n    redo: function () {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.redo();\n              } else {\n                element.setAttribute(change.attribute, change.value);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            if (element) {\n              element.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.parent, change.index, true);\n            break;\n        }\n      }\n      return success;\n    }\n  }\n});\n","/**\n * Widget for node items in XML-File\n */\nqx.Class.define('cv.ui.manager.tree.VirtualElementItem', {\n  extend: qx.ui.tree.VirtualTreeItem,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label) {\n    this.base(arguments, label);\n    if (qx.core.Environment.get('device.touch')) {\n      this.addState('touch');\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'element-tree-item'\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName',\n      apply: '_applyName'\n    },\n\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyTemporary'\n    },\n\n    status: {\n      check: ['valid', 'error', 'comment'],\n      nullable: true,\n      apply: '_applyStatus'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: false\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applySortable'\n    },\n\n    droppable: {\n      refine: true,\n      init: true\n    },\n\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    edit: 'qx.event.type.Data',\n    action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates : {\n      selected : true,\n      touch: true\n    },\n    __labelAdded: false,\n\n    _applyName: function(value) {\n      this.getContentElement().setAttribute('data-nodename', value);\n    },\n\n    // this has to be set by model binding, because the qx way by adding a state does not survive a widget re-binding\n    _applyDragging: function (value) {\n      if (value) {\n        this.addState('drag');\n      } else {\n        this.removeState('drag');\n      }\n    },\n\n    _applyModel: function (value) {\n      if (qx.core.Environment.get('device.touch')) {\n        if (value) {\n          const menuButton = this.getChildControl('menu-button');\n          menuButton.show();\n          let menu = menuButton.getMenu();\n          menu.setEditor(value.getEditor());\n          menu.setElement(value);\n        } else {\n          this.getChildControl('menu-button').hide();\n        }\n      } else if (this.hasChildControl('menu-button')) {\n        this.getChildControl('menu-button').exclude();\n      }\n    },\n\n    _applyTemporary: function (value) {\n      if (value) {\n        this.addState('temporary');\n      } else {\n        this.removeState('temporary');\n      }\n    },\n\n    _applySortable: function (value) {\n      if (value) {\n        this.getChildControl('move-button').show();\n      } else {\n        this.getChildControl('move-button').hide();\n      }\n    },\n\n    _applyStatus: function (value, old) {\n      const icon = this.getChildControl('icon');\n      const label = this.getChildControl('label');\n      if (old) {\n        icon.removeState(old);\n        label.removeState(old);\n      }\n      if (value) {\n        icon.addState(value);\n        label.addState(value);\n      }\n    },\n\n    _addWidgets: function() {\n      this.base(arguments);\n      const open = this.getChildControl('open', true);\n      if (open && qx.core.Environment.get('device.touch')) {\n        open.getContentElement().addClass('touch-tree-open-icon');\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new cv.ui.manager.basic.Image().set({\n             alignY: 'middle',\n             anonymous: true,\n             source: this.getIcon(),\n             maxWidth: 22,\n             maxHeight: 22\n           });\n           break;\n\n         case 'buttons':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox(8));\n           control.setAnonymous(true);\n           break;\n\n         case 'move-button':\n           control = new qx.ui.basic.Atom('', cv.theme.dark.Images.getIcon('drag-handle', qx.core.Environment.get('device.touch') ? 36 : 18));\n           control.setToolTipText(this.tr('Drag to move'));\n           control.setAnonymous(true);\n           control.setShow('icon');\n           this.getChildControl('buttons').addAt(control, 0);\n           break;\n\n         case 'menu-button':\n           control = new qx.ui.form.MenuButton('', cv.theme.dark.Images.getIcon('menu', qx.core.Environment.get('device.touch') ? 24 : 14), new cv.ui.manager.contextmenu.ConfigElement());\n           control.getMenu().addListener('action', ev => {\n             this.fireDataEvent('action', ev.getData());\n           });\n           this.getChildControl('buttons').addAt(control, 1);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    // overridden\n    addLabel : function(text) {\n      const label = this.getChildControl('label');\n\n      if (this.__labelAdded) {\n        this._remove(label);\n      }\n\n      if (text) {\n        this.setLabel(text);\n      } else {\n        label.setValue(this.getLabel());\n      }\n\n      this._add(label);\n      this._add(new qx.ui.core.Spacer(), {flex: 1});\n      const buttons = this.getChildControl('buttons');\n      this._add(buttons);\n      this.__labelAdded = true;\n    }\n  }\n});\n","/**\n * Contextmenu for an XML-Element in a CometVisu config file.\n */\nqx.Class.define('cv.ui.manager.contextmenu.ConfigElement', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (editor) {\n    this.base(arguments);\n    if (editor) {\n      this.setEditor(editor);\n    }\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'action': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      apply: '_applyElement'\n    },\n\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      apply: '_applyEditor'\n    }\n\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {qx.ui.command.GroupManager}\n     */\n    _commandGroup: null,\n\n    _applyEditor: function (value, old) {\n      if (old) {\n        old.removeListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n      if (value) {\n        value.addListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n    },\n\n    _applyElement: function(value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n        old.removeRelatedBindings(this.getChildControl('cut-button'));\n      }\n      if (value) {\n        const editable = value.isEditable();\n        this.getChildControl('copy-button').setEnabled(true);\n        if (editable) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n          value.bind('deletable', this.getChildControl('cut-button'), 'enabled');\n          this.getChildControl('view-button').exclude();\n          this.getChildControl('edit-button').show();\n          this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n          let addable = value.getAddableChildren(true);\n          this.getChildControl('create-button').setEnabled(addable.length > 0);\n        } else {\n          this.getChildControl('delete-button').setEnabled(false);\n          this.getChildControl('cut-button').setEnabled(false);\n          this.getChildControl('create-button').setEnabled(false);\n          this.getChildControl('view-button').show();\n          // enable view button when there are attributes to show\n          this.getChildControl('view-button').setEnabled(value.getShowEditButton());\n          this.getChildControl('edit-button').exclude();\n        }\n      } else {\n        ['edit', 'delete', 'cut', 'copy', 'paste', 'create'].forEach(name => this.getChildControl(name + '-button').setEnabled(false));\n      }\n      this._maintainClipboardButtons();\n    },\n\n    _init: function () {\n      ['view', 'edit', 'delete'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      ['cut', 'copy', 'paste'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      this.add(this.getChildControl('create-button'));\n    },\n\n    _maintainClipboardButtons: function () {\n      const content = this.getEditor().getClipboard();\n      const element = this.getElement();\n      let enabled = (element ? element.isEditable() : false) && content instanceof cv.ui.manager.model.XmlElement;\n      if (enabled) {\n        // check if content is allowed as child here\n        let addable = element.getAddableChildren(true);\n        enabled = addable.includes(content.getName()) && element.isChildAllowedAtPosition(content, Number.POSITIVE_INFINITY);\n      }\n      this.getChildControl('paste-button').setEnabled(enabled);\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n       let control;\n\n       switch (id) {\n         case 'view-button':\n           control = this.__createButton('view', this.tr('View'), cv.theme.dark.Images.getIcon('view', 18));\n           control.exclude();\n           break;\n\n         case 'edit-button':\n           control = this.__createButton('edit', this.tr('Edit'), cv.theme.dark.Images.getIcon('edit', 18));\n           break;\n\n         case 'delete-button':\n           control = this.__createButton('delete', this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n           break;\n\n         case 'cut-button':\n           control = this.__createButton('cut', this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18));\n           break;\n\n         case 'copy-button':\n           control = this.__createButton('copy', this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18));\n           break;\n\n         case 'paste-button':\n           control = this.__createButton('paste', this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18));\n           break;\n\n         case 'create-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'create-button':\n           control = this.__createButton('create', this.tr('Add child'), cv.theme.dark.Images.getIcon('add', 18));\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    __createButton: function (action, title, icon, command, menu) {\n      const button = new qx.ui.menu.Button(title, icon, command, menu);\n      button.addListener('execute', function () {\n        this.fireDataEvent('action', {\n          action: action,\n          element: this.getElement()\n        });\n      }, this);\n      return button;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.ElementForm', {\n  extend: qxl.dialog.Form,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    labelColumnWidth: {\n      refine: true,\n      init: 300\n    },\n\n    useBlocker: {\n      refine: true,\n      init: true\n    },\n\n    blockerOpacity: {\n      refine: true,\n      init: 0.9\n    },\n\n    blockerColor: {\n      refine: true,\n      init: '#585858'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __mappedKeys: null,\n    __hints: null,\n    _rootListenerId: null,\n\n    _applyFormData: function (formData, old) {\n      this.__mappedKeys = {\n        map: {},\n        inverse: {}\n      };\n      let firstWidget;\n      if (this._formController) {\n        try {\n          this.getModel().removeAllBindings();\n          this._formController.dispose();\n        } catch (e) {\n        }\n      }\n      if (this._form) {\n        try {\n          this._form.getValidationManager().removeAllBindings();\n          this._form.dispose();\n        } catch (e) {\n        }\n      }\n      this._formContainer.removeAll();\n      if (!formData) {\n        return;\n      }\n      if (this.getModel()) {\n        this.getModel().removeAllBindings();\n        this.getModel().dispose();\n      }\n      let modelData = {};\n      for (let key of Object.getOwnPropertyNames(formData)) {\n        let i = 0;\n        let mappedKey = key.replaceAll(/[-_\\.#]+([a-z])/g, (match, p1) => p1.toUpperCase()) + i++;\n        while (Object.prototype.hasOwnProperty.call(modelData, mappedKey)) {\n          mappedKey = mappedKey.substr(0, mappedKey.length - 1) + i++;\n        }\n        if (mappedKey !== key) {\n          this.__mappedKeys.map[mappedKey] = key;\n          this.__mappedKeys.inverse[key] = mappedKey;\n        }\n        modelData[mappedKey] = formData[key].value !== undefined\n          ? formData[key].value\n          : null;\n      }\n      let model = qx.data.marshal.Json.createModel(modelData);\n      this.setModel(model);\n      // form\n      this._form = new qx.ui.form.Form();\n      if (qx.core.Environment.get('module.objectid') === true) {\n        this._form.setQxObjectId('form');\n        this.addOwnedQxObject(this._form);\n      }\n      this._formController = new qx.data.controller.Object(this.getModel());\n      this._onFormReady(this._form);\n      let i = 0;\n      let atom;\n      for (let key of Object.getOwnPropertyNames(formData)) {\n        const mappedKey = this.__mappedKeys.inverse[key];\n        let fieldData = formData[key];\n        let formElement = null;\n        switch (fieldData.type.toLowerCase()) {\n          case 'groupheader':\n            this._form.addGroupHeader(fieldData.value);\n            break;\n          case 'textarea':\n            formElement = new qx.ui.form.TextArea();\n            formElement.setMinimalLineHeight(fieldData.lines);\n            if (fieldData.autoSize === true) {\n              formElement.setAutoSize(true);\n              formElement.setMinHeight(fieldData.lines * 16);\n            } else {\n              formElement.setHeight(fieldData.lines * 16);\n            }\n            formElement.setLiveUpdate(true);\n            break;\n          case 'textfield':\n            formElement = new qx.ui.form.TextField();\n            if (fieldData.maxLength) {\n formElement.setMaxLength(fieldData.maxLength); \n}\n            formElement.setLiveUpdate(true);\n            break;\n          case 'sourceeditor':\n            formElement = new cv.ui.manager.form.SourceCodeField('', fieldData.language);\n            if (fieldData.autoSize === true) {\n              formElement.setAutoSize(true);\n              formElement.setMinHeight(fieldData.lines * 16);\n            } else {\n              formElement.setHeight(fieldData.lines * 16);\n            }\n            break;\n          case 'datefield':\n          case 'date':\n            formElement = new qx.ui.form.DateField();\n            if (fieldData.dateFormat) {\n              formElement.setDateFormat(fieldData.dateFormat);\n            }\n            break;\n          case 'passwordfield':\n          case 'password':\n            formElement = new qx.ui.form.PasswordField();\n            formElement.getContentElement().setAttribute('autocomplete', 'password');\n            break;\n          case 'combobox': {\n            formElement = new qx.ui.form.ComboBox();\n            const parseComboOptions = function (options) {\n              if (Array.isArray(options)) {\n                options.forEach(function (item) {\n                  let listItem = new qx.ui.form.ListItem(item.label, item.icon);\n                  formElement.add(listItem);\n                });\n              } else if (typeof options === 'object') {\n                // grouped options\n                Object.keys(options).forEach(groupName => {\n                  let groupItem = new qx.ui.form.ListItem(groupName);\n                  groupItem.set({\n                    anonymous: true,\n                    appearance: 'optiongroup'\n                  });\n                  formElement.add(groupItem);\n                  options[groupName].forEach(function (item) {\n                    let listItem = new qx.ui.form.ListItem(item.label, item.icon, item.value);\n                    formElement.add(listItem);\n                  });\n                });\n              }\n            };\n            if (fieldData.options instanceof Promise) {\n              formElement.setPlaceholder(this.tr('Loading...'));\n              fieldData.options.then(options => {\n                formElement.setPlaceholder(fieldData.placeholder);\n                parseComboOptions(options);\n              }, this).catch(err => {\n                this.error(err);\n                formElement.setPlaceholder(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n              }, this);\n            } else {\n              parseComboOptions(fieldData.options);\n            }\n            break;\n          }\n          case 'virtualcombobox': {\n            formElement = new qx.ui.form.VirtualComboBox();\n            formElement.set({\n              iconPath: 'icon',\n              labelPath: 'value'\n            });\n            if (fieldData.validation) {\n              formElement.getChildControl('textfield').setLiveUpdate(true);\n            }\n            const selection = formElement.getChildControl('dropdown').getSelection();\n            selection.addListener('change', function (ev) {\n              const selected = selection.getItem(0);\n              if (selected && selected instanceof cv.ui.manager.form.Option) {\n                this.__hints = selected.getHints();\n              } else {\n                this.__hints = null;\n              }\n            }, this);\n            model = new qx.data.Array();\n            const parseVComboOptions = function (options) {\n              if (Array.isArray(options)) {\n                options.forEach(item => {\n                  model.push(new cv.ui.manager.form.Option(item.label + (item.value ? ` (${item.value})` : ''), item.icon, item.value, item.hints));\n                });\n              } else if (typeof options === 'object') {\n                Object.keys(options).forEach(groupName => {\n                  const groupModel = new cv.ui.manager.form.Option(groupName);\n                  groupModel.setType('group');\n                  model.push(groupModel);\n                  options[groupName].forEach(function (item) {\n                    model.push(new cv.ui.manager.form.Option(item.label + (item.value ? ` (${item.value})` : ''), item.icon, item.value, item.hints));\n                  });\n                });\n              }\n            };\n            if (fieldData.options instanceof Promise) {\n              formElement.setPlaceholder(this.tr('Loading...'));\n              fieldData.options.then(options => {\n                formElement.setPlaceholder(fieldData.placeholder);\n                parseVComboOptions(options);\n              }, this).catch(err => {\n                this.error(err);\n                formElement.setPlaceholder(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n              }, this);\n            } else {\n              parseVComboOptions(fieldData.options);\n            }\n\n            formElement.setDelegate({\n              createItem: function () {\n                return new cv.ui.manager.form.ListItem();\n              },\n              bindItem: function (controller, item, index) {\n                controller.bindProperty('icon', 'icon', null, item, index);\n                controller.bindProperty('label', 'label', null, item, index);\n                controller.bindProperty('type', 'appearance', {\n                  converter: function (value) {\n                    switch (value) {\n                      case 'state':\n                        return 'state-option';\n                      case 'error':\n                        return 'error-option';\n                      case 'group':\n                        return 'optiongroup';\n                      default:\n                        return 'listitem';\n                    }\n                  }\n                }, item, index);\n                controller.bindProperty('type', 'anonymous', {\n                  converter: function (value) {\n                    return value === 'group';\n                  }\n                }, item, index);\n              }\n            });\n            formElement.setModel(model);\n            break;\n          }\n\n          case 'selectbox': {\n            formElement = new qx.ui.form.SelectBox();\n            if (fieldData.options instanceof Promise) {\n              atom = formElement.getChildControl('atom');\n              atom.setLabel(this.tr('Loading...'));\n              atom.addState('loading');\n              fieldData.options.then(options => {\n                const atom = formElement.getChildControl('atom');\n                atom.resetLabel();\n                atom.removeState('loading');\n                model = qx.data.marshal.Json.createModel(options);\n                // eslint-disable-next-line no-new\n                new qx.data.controller.List(model, formElement, 'label');\n              }, this).catch(err => {\n                this.error(err);\n                const atom = formElement.getChildControl('atom');\n                atom.setLabel(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n                atom.removeState('loading');\n                atom.addState('error');\n              }, this);\n            } else {\n              model = qx.data.marshal.Json.createModel(fieldData.options);\n              // eslint-disable-next-line no-new\n              new qx.data.controller.List(model, formElement, 'label');\n            }\n            break;\n          }\n\n          case 'virtualselectbox':\n            formElement = new cv.ui.manager.form.VirtualSelectBox();\n            model = new qx.data.Array();\n            if (fieldData.options) {\n              if (fieldData.options instanceof Promise) {\n                atom = formElement.getChildControl('atom');\n                atom.setLabel(this.tr('Loading...'));\n                atom.addState('loading');\n                fieldData.options.then(options => {\n                  const atom = formElement.getChildControl('atom');\n                  atom.resetLabel();\n                  atom.removeState('loading');\n                  options.forEach(item => {\n                    model.push(new cv.ui.manager.form.Option(item.label, item.icon, item.value));\n                  });\n                }).catch(err => {\n                  this.error(err);\n                  const atom = formElement.getChildControl('atom');\n                  atom.setLabel(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n                  atom.removeState('loading');\n                  atom.addState('error');\n                }, this);\n              } else {\n                fieldData.options.forEach(item => {\n                  model.push(new cv.ui.manager.form.Option(item.label, item.icon, item.value));\n                });\n              }\n            }\n            formElement.setDelegate({\n              createItem: function() {\n                return new cv.ui.manager.form.ListItem();\n              },\n              bindItem:  function (controller, item, index) {\n                controller.bindDefaultProperties(item, index);\n                controller.bindProperty('value', 'model', null, item, index);\n              }\n            });\n            formElement.set({\n              labelPath: 'label',\n              iconPath: 'icon',\n              iconOptions: {\n                converter: function (value) {\n                  if (typeof value === 'function') {\n                    return value().trim();\n                  }\n                  return value;\n                }\n              },\n              model: model\n            });\n            break;\n          case 'radiogroup':\n            formElement = new qx.ui.form.RadioGroup();\n            if (fieldData.orientation) {\n              formElement.setUserData('orientation', fieldData.orientation);\n            }\n            fieldData.options.forEach(function (item) {\n              let radioButton = new qx.ui.form.RadioButton(item.label);\n              radioButton.setUserData(\n                'value',\n                item.value !== undefined ? item.value : item.label\n              );\n              formElement.add(radioButton);\n            }, this);\n            break;\n          case 'label':\n            formElement = new qx.ui.form.TextField(); // dummy\n            formElement.setUserData('excluded', true);\n            break;\n          case 'checkbox':\n            formElement = new cv.ui.manager.form.CheckBox();\n            formElement.setTriState(true);\n            break;\n          case 'spinner':\n            formElement = new qx.ui.form.Spinner();\n            if (fieldData.min) {\n              formElement.setMinimum(fieldData.min);\n            }\n            if (fieldData.max) {\n              formElement.setMaximum(fieldData.max);\n            }\n            if (fieldData.step) {\n              formElement.setSingleStep(fieldData.step);\n            }\n            if (fieldData.fractionsDigits) {\n              let fd = fieldData.fractionsDigits;\n              let nf = new qx.util.format.NumberFormat();\n              if (fd.min) {\n                nf.setMinimumFractionDigits(fd.min);\n              }\n              if (fd.max) {\n                nf.setMaximumFractionDigits(fd.max);\n              }\n              formElement.setNumberFormat(nf);\n            }\n            break;\n          default:\n            this.error('Invalid form field type:' + fieldData.type);\n        }\n        formElement.setUserData('key', key);\n        formElement.setUserData('mappedKey', mappedKey);\n        if (i === 0) {\n          firstWidget = formElement;\n        }\n        i++;\n        if (typeof fieldData.type == 'string') {\n          switch (fieldData.type.toLowerCase()) {\n            case 'textarea':\n            case 'textfield':\n            case 'passwordfield':\n            case 'combobox':\n            case 'virtualcombobox':\n            case 'datefield':\n            case 'spinner':\n            case 'sourceeditor':\n              this._formController.addTarget(formElement, 'value', mappedKey, true, null, {\n                converter: function (value) {\n                  this.getValidationManager().validate();\n                  return value;\n                }.bind(this._form)\n              });\n              break;\n            case 'virtualselectbox':\n              this._formController.addTarget(formElement, 'value', mappedKey, true, {\n                converter: function (value) {\n                  if (typeof value === 'string') {\n                    let option;\n                    this.getModel().some(item => {\n                      if (item.getValue() === value) {\n                        option = item;\n                        return true;\n                      }\n                      return false;\n                    });\n                    return option;\n                  }\n                  return value;\n                }.bind(formElement)\n              }, {\n                converter: function (option) {\n                  this.getValidationManager().validate();\n                  return option ? option.getValue() : null;\n                }.bind(this._form)\n              });\n              break;\n            case 'checkbox':\n              this._formController.addTarget(formElement, 'value', mappedKey, true, null);\n              break;\n            case 'selectbox':\n              this._formController.addTarget(formElement, 'selection', mappedKey, true, {\n                converter: qx.lang.Function.bind(function (value) {\n                  let selected = null;\n                  let selectables = this.getSelectables();\n                  selectables.forEach(function (selectable) {\n                    if (selectable.getModel().getValue() === value) {\n                      selected = selectable;\n                    }\n                  }, this);\n                  if (!selected) {\n                    return [selectables[0]];\n                  }\n                  return [selected];\n                }, formElement)\n              }, {\n                converter: qx.lang.Function.bind(function (selection) {\n                  return selection[0].getModel().getValue();\n                }, formElement)\n              });\n              break;\n            case 'radiogroup':\n              this._formController.addTarget(formElement, 'selection', mappedKey, true, {\n                converter: qx.lang.Function.bind(function (value) {\n                  let selectables = this.getSelectables();\n                  let selection = [];\n                  if (value) {\n                    selectables.forEach(function (selectable) {\n                      let sValue = selectable.getUserData('value');\n                      if (sValue === value) {\n                        selection = [selectable];\n                      }\n                    }, this);\n                  }\n                  return selection;\n                }, formElement)\n              }, {\n                converter: function (selection) {\n                  return selection[0].getUserData('value');\n                }\n              });\n              break;\n          }\n        }\n        /**\n         * Validation\n         */\n        let validator = null;\n        if (formElement && fieldData.validation) {\n          // required field\n          if (fieldData.validation.required) {\n            formElement.setRequired(true);\n          }\n          // sync validation\n          if (fieldData.validation.validator) {\n            validator = fieldData.validation.validator;\n            if (typeof validator == 'string') {\n              if (qx.util.Validate[validator]) {\n                validator = qx.util.Validate[validator]();\n              } else if (validator.charAt(0) === '/') {\n                validator = qx.util.Validate.regExp(\n                  new RegExp(validator.substr(1, validator.length - 2)),\n                  fieldData.validation.errorMessage\n                );\n              } else {\n                this.error('Invalid string validator.');\n              }\n            } else if (!(validator instanceof qx.ui.form.validation.AsyncValidator) && typeof validator !== 'function') {\n              this.error('Invalid validator.');\n            }\n          }\n          // async validation\n          if (qx.lang.Type.isString(fieldData.validation.proxy) &&\n            qx.lang.Type.isString(fieldData.validation.method)\n          ) {\n            /**\n             * fieldData.validation.proxy\n             * the name of a global variable (or path) to a function that acts as the proxy of\n             * the 'send' or 'execute' function of a preconfigured JsonRpc client. The function\n             * receives the following parameters: service method (string), parameters (array)\n             * and callback (function). It proxies the parameters to the given JsonRpc method and\n             * calls the callback with the result (true if valid, false if not) received from the\n             * server. The JsonRpc service name is preconfigured by the server and cannot be\n             * changed by the client.\n             */\n              // clean\n            let proxy = fieldData.validation.proxy.replace(/;\\n/g, '');\n            try {\n              // eslint-disable-next-line no-eval\n              eval('proxy = ' + proxy + ';');\n            } catch (e) {\n              this.warn('Invalid proxy name');\n            }\n            if (typeof proxy == 'function') {\n              let method = fieldData.validation.method;\n              let message = fieldData.validation.invalidMessage;\n              let validationFunc = function (validatorObj, value) {\n                if (!validatorObj.__asyncInProgress) {\n                  validatorObj.__asyncInProgress = true;\n                  proxy(method, [value], function (valid) {\n                    validatorObj.setValid(valid, message || qx.locale.Manager.tr('Value is invalid'));\n                    validatorObj.__asyncInProgress = false;\n                  });\n                }\n              };\n              validator = new qx.ui.form.validation.AsyncValidator(validationFunc);\n            }\n          }\n        }\n\n        /**\n         * other widget properties @todo: allow to set all properties\n         */\n        if (fieldData.width !== undefined) {\n          formElement.setWidth(fieldData.width);\n        }\n        if (fieldData.placeholder !== undefined) {\n          formElement.setPlaceholder(fieldData.placeholder);\n        }\n        if (fieldData.enabled !== undefined) {\n          formElement.setEnabled(fieldData.enabled);\n        }\n        if (fieldData.help !== undefined) {\n          formElement.setUserData('help', fieldData.help);\n        }\n\n        /**\n         * Events\n         */\n        if (qx.lang.Type.isObject(fieldData.events)) {\n          for (let type in fieldData.events) {\n            try {\n              // eslint-disable-next-line no-eval\n              let func = eval('(' + fieldData.events[type] + ')'); // eval is evil, I know.\n              if (!qx.lang.Type.isFunction(func)) {\n                throw new Error();\n              }\n              formElement.addListener(type, func, formElement);\n            } catch (e) {\n              this.warn('Invalid \\'' + type + '\\' event handler for form element \\'' + key + '\\'.');\n            }\n          }\n        }\n\n        // Putting it all together\n        let label = fieldData.label;\n        this._form.add(formElement, label, validator);\n        // Add the form elements as objects owned by the form widget\n        if (qx.core.Environment.get('module.objectid') === true) {\n          formElement.setQxObjectId(key);\n          this._form.addOwnedQxObject(formElement);\n        }\n      }\n\n\n      let view = new cv.ui.manager.form.ElementFormRenderer(this._form);\n      view.getLayout().setColumnFlex(0, 0);\n      view.getLayout().setColumnMaxWidth(0, this.getLabelColumnWidth());\n      view.getLayout().setColumnFlex(1, 1);\n      view.getLayout().set({\n        spacingX: 8\n      });\n      view.setAllowGrowX(true);\n      const scroll = new qx.ui.container.Scroll(view);\n      scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      this._rootListenerId = qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      });\n\n      view.bind('width', scroll, 'width');\n      view.bind('height', scroll, 'height');\n      this._formContainer.add(scroll);\n      this._form.getValidationManager().validate();\n      if (firstWidget) {\n        qx.event.Timer.once(() => {\n          firstWidget.focus();\n        }, this, 200);\n      }\n    },\n\n    _handleOk: function () {\n      this.hide();\n      if (this.getCallback()) {\n        const data = qx.util.Serializer.toNativeObject(this.getModel());\n        const mappedNames = Object.keys(this.__mappedKeys.map);\n        mappedNames.forEach(mappedKey => {\n          if (Object.prototype.hasOwnProperty.call(data, mappedKey)) {\n            data[this.__mappedKeys.map[mappedKey]] = data[mappedKey];\n            delete data[mappedKey];\n          }\n        });\n        if (this.__hints) {\n          Object.keys(this.__hints).forEach(name => data[name] = this.__hints[name]);\n        }\n        this.getCallback().call(\n          this.getContext(),\n          data\n        );\n      }\n      this.resetCallback();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    if (this._rootListenerId) {\n      qx.core.Init.getApplication().getRoot().removeListenerById(this._rootListenerId);\n      this._rootListenerId = null;\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.schema.Base', {\n  extend: qx.core.Object,\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   * @param   node    {Node} the group-node\n   * @param   schema  {cv.ui.manager.model.Schema}  the corresponding schema\n   */\n  construct: function (node, schema) {\n    this.base(arguments);\n    this.setNode(node);\n    this.setSchema(schema);\n    this._bounds = {\n      min: undefined,\n      max: undefined\n    };\n    this._allowedElements = {};\n    this._sortedContent = [];\n    this._subGroupings = [];\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    /**\n     * type of this object\n     * @var string\n     */\n    type: {\n      check: 'String',\n      init: 'unknown'\n    },\n    elementsHaveOrder: {\n      check: 'Boolean',\n      init: false\n    },\n    schema: {\n      check: 'cv.ui.manager.model.Schema',\n      nullable: false\n    },\n    node: {\n      check: 'Node',\n      nullable: false\n    },\n    /**\n     * array of sub-choices, -sequences, -groups that are defined\n     * @var array\n     */\n    subGroupings: {\n      check: 'Array'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * bounds for this element\n     * @var object\n     */\n    _bounds: null,\n\n    /**\n     * cache for getRegex\n     * @var string\n     */\n    _regexCache: null,\n\n    /**\n     * list of elements that are allowed as per our own definition\n     * @var object\n     */\n    _allowedElements: null,\n\n    /**\n     * the sorted listed of allowed elements and sub-groupings\n     * @var array\n     */\n    _sortedContent: null,\n\n    /**\n     * array of sub-choices, -sequences, -groups that are defined\n     * @var array\n     */\n    _subGroupings: null,\n\n    /// needs to be implemented by the inheriting classes\n    parse: function () {\n      const n = this.getNode();\n      let min = n.hasAttribute('minOccurs') ? n.getAttribute('minOccurs') : 1; // default is 1\n      let max = n.hasAttribute('maxOccurs') ? n.getAttribute('maxOccurs') : 1; // default is 1\n      this._bounds = {\n        min: parseInt(min),\n        max: max === 'unbounded' ? Number.POSITIVE_INFINITY : parseInt(max)\n      };\n    },\n\n    /**\n     * is an element (specified by its name) allowed in this group?\n     * Goes recursive.\n     * Does NOT check bounds! Does NOT check dependencies!\n     *\n     * @param   element string  the element we check for\n     * @return  boolean         is it allowed?\n     */\n    isElementAllowed: function (element) {\n      if (typeof this._allowedElements[element] !== 'undefined') {\n        // this element is immediately allowed\n        return true;\n      }\n\n      // go over the list of subGroupings and check, if the element is allowed with any of them\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        if (this._subGroupings[i].isElementAllowed(element) === true) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    /**\n     * get the SchemaElement-object for a certain element-name.\n     * May return undefined if no element is found, so you might be interested in checking isElementAllowed beforehand.\n     *\n     * @param   elementName string  name of the element to find the SchemaElement for\n     * @return  object              SchemaElement-object, or undefined if none is found\n     */\n    getSchemaElementForElementName: function (elementName) {\n      if (typeof this._allowedElements[elementName] != 'undefined') {\n        // this element is immediately allowed\n        return this._allowedElements[elementName];\n      }\n\n      // go over the list of sub-choices and check, if the element is allowed with them\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        if (this._subGroupings[i].isElementAllowed(elementName) === true) {\n          // this element is allowed\n          return this._subGroupings[i].getSchemaElementForElementName(elementName);\n        }\n      }\n\n      // can not find any reason why elementName is allowed with us...\n      return undefined;\n    },\n\n\n    /**\n     * get a list of required elements.\n     * if an element is required multiple times, it is listed multiple times\n     * Attention: elements are NOT sorted.\n     *\n     * @return  array   list of required elements\n     */\n    getRequiredElements: function () {\n      // we do know what we require. might not be too easy to find out, but ok\n\n      // if we have no lower bounds, then nothing is required\n      if (this._bounds.min === 0) {\n        return [];\n      }\n\n      const requiredElements = [];\n\n      // my own elements\n      for (const [name, item] of Object.entries(this._allowedElements)) {\n        if (item.getBounds().min > 0) {\n          for (let i = 0; i < item.getBounds().min; ++i) {\n            requiredElements.push(name);\n          }\n        }\n      }\n\n      // elements of our sub-groupings, if any\n      this._subGroupings.forEach(grouping => {\n        const subRequiredElements = grouping.getRequiredElements();\n\n        if (subRequiredElements.length > 0) {\n          for (let i = 0; i < subRequiredElements.length; ++i) {\n            requiredElements.push(subRequiredElements[i]);\n          }\n        }\n      });\n\n      return requiredElements;\n    },\n\n    /**\n     * get the elements allowed for this group\n     *\n     * @return  object      list of allowed elements, key is the name\n     */\n    getAllowedElements: function () {\n      const myAllowedElements = {};\n\n      for (const [name, item] of Object.entries(this._allowedElements)) {\n        myAllowedElements[name] = item;\n      }\n\n      // also the elements allowed by our sub-choices etc.\n      this._subGroupings.forEach(grouping => {\n        Object.assign(myAllowedElements, grouping.getAllowedElements());\n      });\n\n      return myAllowedElements;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * @param   sortNumber  integer the sort number of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      return {};\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      return '';\n    },\n\n\n    /**\n     * find out if this Grouping has multi-level-bounds, i.e. sub-groupings with bounds.\n     * This makes it more or less impossible to know in advance which elements might be needed\n     *\n     * @return  boolean does it?\n     */\n    hasMultiLevelBounds: function () {\n      return this._subGroupings.length > 0;\n    },\n\n\n    /**\n     * get the bounds of this very grouping\n     *\n     * @return  object  like {min: x, max: y}\n     */\n    getBounds: function () {\n      return this._bounds;\n    },\n\n\n    /**\n     * get bounds for a specific element.\n     * Take into account the bounds of the element and/or our own bounds\n     *\n     * @param   childName   string  name of the child-to-be\n     * @return  object              {max: x, min: y}, or undefined if none found\n     */\n    getBoundsForElementName: function (childName) {\n      return this._bounds;\n    },\n\n    /**\n     * create a regex-object from a pattern\n     *\n     * For some obscure reason, this may not be inside a classes method, or else that class is not instantiateable\n     *\n     * @param   input       string  the pattern to match (without //)\n     * @param   modifiers   string  modifiers, if any\n     * @return  object              RegExp-object\n     */\n    regexFromString: function (input, modifiers) {\n      if (modifiers === undefined) {\n        modifiers = '';\n      }\n\n      return new RegExp(input, modifiers);\n    }\n  }\n});\n","/**\n * Code the extract data from annotations (e.g. appinfo, documentation) in Element/Attribute\n */\nqx.Mixin.define('cv.ui.manager.model.schema.MAnnotation', {\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.__linkRegex = new RegExp(':ref:[`\\'](.+?)[`\\']', 'g');\n    this.__language = qx.locale.Manager.getInstance().getLanguage() === 'de' ? 'de' : 'en';\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * cache for getAppinfo\n     * @var array\n     */\n    __appInfoCache: null,\n    __linkRegex: null,\n    __language: null,\n\n    /**\n     * cache for getDocumentation\n     * @var array\n     */\n    __documentationCache: null,\n\n    __getTextNodesByXPath: function (node, xpath) {\n      const texts = [];\n      const doc = node.ownerDocument;\n      const nsResolver = doc.createNSResolver(doc.documentElement);\n      let iterator = doc.evaluate(xpath, node, nsResolver, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);\n      try {\n        let thisNode = iterator.iterateNext();\n\n        while (thisNode) {\n          texts.push(thisNode.textContent);\n          thisNode = iterator.iterateNext();\n        }\n      } catch (e) {\n        this.error('Error: Document tree modified during iteration ' + e);\n      }\n      return texts;\n    },\n\n    /**\n     * get the appinfo information from the element, if any\n     *\n     * @return  array   list of texts, or empty list if none\n     */\n    getAppinfo: function () {\n      if (this.__appInfoCache !== null) {\n        return this.__appInfoCache;\n      }\n      const node = this.getNode();\n      const appInfo = this.__getTextNodesByXPath(node, 'xsd:annotation/xsd:appinfo');\n      const type = this.getType();\n      if (type === 'element') {\n        // only aggregate types appinfo if it is not an immediate child of the element-node, but referenced/typed\n        if (node.querySelectorAll(':scope > complexType').length === 0) {\n          appInfo.push(...this.__getTextNodesByXPath(this._type, 'xsd:annotation/xsd:appinfo'));\n        }\n      } else if (type === 'attribute') {\n        if (node.hasAttribute('ref')) {\n          // the attribute is a reference, so take appinfo from there, too\n\n          const refName = node.getAttribute('ref');\n          const ref = this.getSchema().getReferencedNode('attribute', refName);\n\n          appInfo.push(...this.__getTextNodesByXPath(ref, 'xsd:annotation/xsd:appinfo'));\n        }\n      }\n\n      // fill the cache\n      this.__appInfoCache = appInfo;\n\n      return appInfo;\n    },\n\n    /**\n     * get the documentation information from the element, if any\n     *\n     * @return  array   list of texts, or empty list if none\n     */\n    getDocumentation: function () {\n      if (this.__documentationCache !== null) {\n        return this.__documentationCache;\n      }\n      const node = this.getNode();\n\n      const lang = qx.locale.Manager.getInstance().getLanguage();\n      const selector = 'xsd:annotation/xsd:documentation[@xml:lang=\\'' + lang + '\\']';\n\n      // any appinfo this element itself might carry\n      let documentation = this.__getTextNodesByXPath(node, selector);\n\n      const type = this.getType();\n      if (type === 'element') {\n        // only aggregate types appinfo if it is not an immediate child of the element-node, but referenced/typed\n        if (node.querySelectorAll(':scope > complexType').length === 0) {\n          documentation.push(...this.__getTextNodesByXPath(this._type, selector));\n        }\n      } else if (type === 'attribute') {\n        if (node.hasAttribute('ref')) {\n          // the attribute is a reference, so take appinfo from there, too\n\n          const refName = node.getAttribute('ref');\n          const ref = this.getSchema().getReferencedNode('attribute', refName);\n\n          documentation.push(...this.__getTextNodesByXPath(ref, selector));\n\n          documentation = documentation.map(entry => this.createDocumentationWebLinks(entry));\n        }\n      }\n      this.__documentationCache = documentation;\n\n      return documentation;\n    },\n\n\n    /**\n     * Transform documentation text to link to the online documentation when it\n     * contains a reference.\n     * @param text\n     * @return string The transformed input string.\n     */\n    createDocumentationWebLinks: function (text) {\n      const language = this.__language;\n      return text.replace(this.__linkRegex, function(match, contents) {\n        const\n          reference = contents.match(/^(.*?) *<([^<]*)>$/);\n          const label = reference ? reference[1] : contents;\n          const key = reference ? reference[2] : contents;\n\n        return '<a class=\"doclink\" target=\"_blank\" href=\"' + cv.ui.manager.model.schema.DocumentationMapping.MAP._base + language + cv.ui.manager.model.schema.DocumentationMapping.MAP[key] + '\">' + label + '</a>';\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__appInfoCache = null;\n    this.__documentationCache = null;\n    this.__linkRegex = null;\n  }\n});\n","/**\n * a single element from the schema\n */\nqx.Class.define('cv.ui.manager.model.schema.Element', {\n  extend: cv.ui.manager.model.schema.Base,\n  include: cv.ui.manager.model.schema.MAnnotation,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Get the name of a schema-element\n     * @param e object  element to find the name of\n     * @param schema\n     * @return  string          name of the element\n     * @throws  if the name can not be found\n     */\n    getElementName: function(e, schema) {\n      if (e.hasAttribute('name')) {\n        return e.getAttribute('name');\n      }\n\n      if (e.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = e.getAttribute('ref');\n        const ref = schema.getReferencedNode('element', refName);\n\n        if (ref.length !== 1) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n\n        return ref.getAttribute('name');\n      }\n\n      return 'unknown';\n    },\n\n    /**\n     * find the type-node for this element\n     * @param node\n     * @param schema\n     * @return  object  object of the type-Node\n     */\n    getTypeNode: function (node, schema) {\n      let type;\n\n      if (node.hasAttribute('type')) {\n        if (node.getAttribute('type').match(/^xsd:/)) {\n          // if it starts with xsd:, it's actually a simple type\n          // does not start with\n          type = node;\n        } else {\n          // otherwise, the element is linked to a complexType\n          type = schema.getTypeNode('complex', node.getAttribute('type'));\n        }\n      } else if (node.hasAttribute('ref')) {\n        // the link is a reference to another element, which means it does not even have it's own name.\n        // this one is most certainly deprecated, as we do not have many root-level-elements, and only those can\n        // be ref'ed\n      } else {\n        // the element is it's own type\n        type = node.querySelector(':scope > complexType');\n      }\n\n      return type;\n    },\n\n    sortChildNodes: function (sorting) {\n      /**\n       * the comparison-function that helps the sorting\n       *\n       * @param   a   mixed   whatever sort gives us\n       * @param   b   mixed   whatever sort gives us\n       * @return  integer     -1, 0, 1 - depending on sort-order\n       */\n      return function (a, b) {\n        let aSortvalue = sorting[a.name];\n        let bSortvalue = sorting[b.name];\n\n        if (aSortvalue === undefined || bSortvalue === undefined) {\n          // undefined means: no sorting available\n          return 0;\n        }\n\n        if (aSortvalue === bSortvalue) {\n          // identical means 'no sorting necessary'\n          return 0;\n        }\n\n        // we need to go through the complete list of values the sorting is composed of,\n        // to find the first one that distinguishes a from b\n\n        // first, typecast to string!\n        if (typeof aSortvalue !== 'string') {\n          aSortvalue = aSortvalue.toString();\n        }\n        if (typeof bSortvalue !== 'string') {\n          bSortvalue = bSortvalue.toString();\n        }\n\n        let aSortvaluesList = aSortvalue.split('.');\n        let bSortvaluesList = bSortvalue.split('.');\n\n        for (let i = 0; i < aSortvaluesList.length; ++i) {\n          if (aSortvaluesList[i] < bSortvaluesList[i]) {\n            return -1;\n          } else if (aSortvaluesList[i] > bSortvaluesList[i]) {\n            return 1;\n          }\n        }\n\n        // if nothing else matched, then they are treated equal\n        return 0;\n      };\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'element'\n    },\n\n    name: {\n      check: 'String',\n      init: ''\n    },\n\n    defaultValue: {\n      check: 'String',\n      nullable: true\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeSortable'\n    },\n\n    mixed: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __allowedContentLoaded: false,\n    __allowedContent: null,\n    __allowedAttributes: null,\n    __textNodeSchemaElement: null,\n\n    /**\n     * get and set the type-node for the element\n     * @var object  Type-Node (most certainly a complexType)\n     */\n    _type: null,\n\n    parse: function () {\n      this.base(arguments);\n      const node = this.getNode();\n      const schema = this.getSchema();\n\n      this._type = cv.ui.manager.model.schema.Element.getTypeNode(node, schema);\n      this.setName(cv.ui.manager.model.schema.Element.getElementName(node, schema));\n      if (node.hasAttribute('default')) {\n        this.setDefaultValue(node.getAttribute('default'));\n      }\n      this.setMixed(this._type.hasAttribute('mixed') && this._type.getAttribute('mixed') === 'true');\n    },\n\n    /**\n     * get a list of allowed elements for this element\n     *\n     * @return  object  object of SchemaElement-elements, key is the name\n     */\n    getAllowedContent: function () {\n      if (this.__allowedContent !== null) {\n        // if we have parsed this already, we can simply return the 'cache'\n        return this.__allowedContent;\n      }\n      const schema = this.getSchema();\n\n      const allowedContent = {\n        _grouping: undefined,\n        _text: false\n      };\n\n      // allowed sub-elements\n      // can be either simpleContent, or (choice|sequence|group|all)?\n      // 'all' is not supported yet.\n\n      if (this._type.querySelectorAll(':scope > simpleContent').length > 0) {\n        // it's simpleContent? Then it's either extension or restriction\n        // anyways, we will handle it, as if it were a simpleType\n        allowedContent._text = new cv.ui.manager.model.schema.SimpleType(this._type.querySelector(':scope > simpleContent'), schema);\n      } else if (this._type.querySelectorAll('complexType > choice, complexType> sequence, complexType > group').length > 0) {\n        // we have a choice, group or sequence. great\n        // as per the W3C, only one of these may appear per element/type\n\n        let tmpDOMGrouping = this._type.querySelector('complexType > choice, complexType > sequence, complexType > group');\n\n        // create the appropriate Schema*-object and append it to this very element\n        switch (tmpDOMGrouping.nodeName) {\n          case 'xsd:choice':\n          case 'choice':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Choice(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:sequence':\n          case 'sequence':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Sequence(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:group':\n          case 'group':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Group(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:any':\n          case 'any':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Any(tmpDOMGrouping, schema);\n            break;\n        }\n      } else if (this._type.hasAttribute('type') && this._type.getAttribute('type').match(/^xsd:/)) {\n        // this is a really simple node that defines its own baseType\n        allowedContent._text = new cv.ui.manager.model.schema.SimpleType(this._type, schema);\n      } else {\n        // no type, no children, no choice - this is an element with NO allowed content/children\n        this.__allowedContent = allowedContent;\n        return allowedContent;\n      }\n\n\n      const children = Array.from(this._type.querySelectorAll(':scope > element'));\n      children.forEach(sub => {\n        const subElement = new cv.ui.manager.model.schema.Element(sub, schema);\n        allowedContent[subElement.getName()] = subElement;\n      });\n\n      // fill the cache\n      this.__allowedContent = allowedContent;\n\n      return allowedContent;\n    },\n\n    /**\n     * get and set the list of allowed attributes\n     * @var array   List of SchemaAttribute-objects\n     */\n    getAllowedAttributes: function () {\n      if (this.__allowedAttributes === null) {\n        const allowedAttributes = {};\n\n        // allowed attributes\n        const attributes = Array.from(this._type.querySelectorAll(':scope > attribute, :scope > simpleContent > extension > attribute'));\n\n        // now add any attribute that comes from an attribute-group\n        const attributeGroups = Array.from(this._type.querySelectorAll(':scope > attributeGroup, :scope > simpleContent > extension > attributeGroup'));\n\n        attributeGroups.forEach(aGroup => {\n          // get get group itself, by reference if necessary\n          // then extract all attributes, and add them to the list of already know attributes\n\n          let attributeGroup = {};\n          if (aGroup.hasAttribute('ref')) {\n            // we do have a reffed group\n            attributeGroup = this.getSchema().getReferencedNode('attributeGroup', aGroup.getAttribute('ref'));\n          } else {\n            attributeGroup = aGroup;\n          }\n\n          Array.from(attributeGroup.querySelectorAll(':scope > attribute')).forEach(child => {\n            attributes.push(child);\n          });\n        });\n\n        // convert all allowed attributes to a more object-oriented approach\n        attributes.forEach(attr => {\n          const attribute = new cv.ui.manager.model.schema.Attribute(attr, this.getSchema());\n          allowedAttributes[attribute.getName()] = attribute;\n        });\n\n        this.__allowedAttributes = allowedAttributes;\n      }\n      return this.__allowedAttributes;\n    },\n\n    /**\n     * are this elements children sortable? this is not the case if a sequence is used, e.g.\n     *\n     * @return  boolean     are children sortable?\n     */\n    areChildrenSortable: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        return true;\n      }\n\n      // the inverse of \"do the elements have a given order?\"\n      return !allowedContent._grouping.getElementsHaveOrder();\n    },\n\n    /**\n     * get a list of required elements.\n     * if an element is required multiple times, it is listed multiple times\n     *\n     * @return  array   list of required elements\n     */\n    getRequiredElements: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping !== undefined) {\n        // we do have a grouping as a child\n        return allowedContent._grouping.getRequiredElements();\n      }\n\n      // there is no grouping, hence no elements defined as children\n      return [];\n    },\n\n    /**\n     * get a list of all allowed elements for this element\n     * @param excludeComment\n     * @return  object  list of SchemaElement-elements, key is the name\n     */\n    getAllowedElements: function (excludeComment) {\n      const allowedContent = this.getAllowedContent();\n\n      const allowedElements = {};\n      if (allowedContent._grouping !== undefined) {\n        Object.assign(allowedElements, allowedContent._grouping.getAllowedElements());\n      }\n\n      let textOnly = false;\n      if (this.isMixed()) {\n        // mixed elements are allowed to have #text-nodes\n        allowedElements['#text'] = this.getSchema().getTextNodeSchemaElement();\n      } else if (allowedContent._text && allowedContent._grouping === undefined) {\n        // text only\n        allowedElements['#text'] = allowedContent._text;\n        textOnly = true;\n      }\n\n      if (!textOnly && !excludeComment) {\n        // although its basically allowed to add comments in a text-only content, we do not allow it\n        allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n      }\n\n      return allowedElements;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     *\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping !== undefined) {\n        return allowedContent._grouping.getAllowedElementsSorting();\n      }\n\n      return undefined;\n    },\n\n    getFirstLevelElementSorting: function () {\n      const allowedSorting = this.getAllowedElementsSorting();\n      if (allowedSorting) {\n        // we only care about the first level here\n        Object.keys(allowedSorting).forEach(name => {\n          let sort = allowedSorting[name];\n          if (typeof sort === 'string') {\n            sort = parseInt(sort.split('.')[0]);\n          }\n          allowedSorting[name] = sort;\n        });\n      }\n      return allowedSorting;\n    },\n\n    /**\n     * get the bounds for this elements children (as defined by a choice)\n     *\n     * @return  object  bounds ({min: x, max: y})\n     */\n    getChildBounds: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // no choice = no idea about bounds\n        return undefined;\n      }\n\n      if (allowedContent._grouping.hasMultiLevelBounds() === true) {\n        // if our choice has sub-choices, then we have not fucking clue about bounds (or we can not process them)\n        return undefined;\n      }\n\n      return allowedContent._grouping.getBounds();\n    },\n\n    /**\n     * get the bounds for a specific element-name\n     * will go through all of the groupings-tree to find out, just how many elements of this may appear\n     *\n     * @param   childName   string  name of the child-to-be\n     * @return  object              {min: x, max: y}\n     */\n    getBoundsForElementName: function (childName) {\n      const allowedContent = this.getAllowedContent();\n\n      return allowedContent._grouping.getBoundsForElementName(childName);\n    },\n\n    /**\n     * check if a text-only-node is allowed ...\n     *\n     * @return  boolean\n     */\n    isTextContentAllowed: function () {\n      if (this.isMixed()) {\n        // mixed means that we allow for text-content\n        return true;\n      }\n\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._text !== undefined && allowedContent._text !== false) {\n        // if _text is defined and there, we assume that text-content is allowed\n        return true;\n      }\n\n      // had no reason to allow text-content, so gtfoml!\n      return false;\n    },\n\n    isTextContentRequired: function () {\n      if (this.isTextContentAllowed()) {\n        return !this.isMixed() && !this.getAllowedContent()._text.isValueValid('');\n      }\n      return false;\n    },\n\n    /**\n     * check if an element (specified by its name) is allowed as one of our immediate children\n     * Goes recursive if we have choices.\n     *\n     * @param   child   string  name of the element we want to check\n     * @return  boolean         is this element allowed?\n     */\n    isChildElementAllowed: function (child) {\n      if (child === '#text' || child === '#cdata-section') {\n        // text-nodes are somewhat special :)\n        return this.isTextContentAllowed();\n      } else if (child === '#comment') {\n        return true;\n      }\n\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // when there is no choice, then there is no allowed element\n        return false;\n      } \n        // see, if this child is allowed with our choice\n        return allowedContent._grouping.isElementAllowed(child);\n    },\n\n\n    /**\n     * get the SchemaElement-object for a certain element-name.\n     * May return undefined if no element is found, so you might be interested in checking isElementAllowed beforehand.\n     *\n     * @param   elementName string  name of the element to find the SchemaElement for\n     * @return  object              SchemaElement-object, or undefined if none is found\n     */\n    getSchemaElementForElementName: function (elementName) {\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (elementName === '#text' || elementName === '#cdata-section') {\n        // no special handling for mixed nodes, they do have a #text-SchemaElement already!\n        // text-nodes may be allowed. we will see ...\n        if (this.isTextContentAllowed() === false) {\n          return undefined;\n        }\n\n        if (!this.__textNodeSchemaElement) {\n          const tmpXML = this.getSchema().getSchemaDOM().createElement('element');\n          tmpXML.setAttribute('name', '#text');\n          tmpXML.setAttribute('type', 'xsd:string');\n          this.__textNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this.getSchema());\n          if (allowedContent._text) {\n            this.__textNodeSchemaElement.getAllowedContent()._text = allowedContent._text;\n          } else if (this.isMixed()) {\n            this.__textNodeSchemaElement.getAllowedContent._text = this.getSchema().getTextNodeSchemaElement();\n          }\n        }\n        return this.__textNodeSchemaElement;\n      } else if (elementName === '#comment') {\n        // comments are always allowed\n        return this.getSchema().getCommentNodeSchemaElement();\n      }\n\n      if (allowedContent._grouping === undefined) {\n        // when there is no choice, then there is no allowed element\n        return undefined;\n      }\n\n      // go over our choice, if the element is allowed with it\n      if (allowedContent._grouping.isElementAllowed(elementName)) {\n        // only look in this tree, if the element is allowed there.\n        return allowedContent._grouping.getSchemaElementForElementName(elementName);\n      }\n\n      return undefined;\n    },\n\n    /**\n     * return the DOM this Schema is based on\n     *\n     * @return  object  DOM of $xsd\n     */\n    getSchemaDOM: function () {\n      return this.getSchema().getSchemaDOM();\n    },\n\n    /**\n     * check if a given value is valid for this element\n     *\n     * @param   value   string  value to check\n     * @return  boolean         is it valid?\n     */\n    isValueValid: function (value) {\n      if (this.isTextContentAllowed() === false) {\n        // if no text-content is allowed, then it can not be valid\n        return false;\n      }\n\n      if (this.isMixed()) {\n        // mixed is always good!\n        return true;\n      }\n\n      const allowedContent = this.getAllowedContent();\n\n      return allowedContent._text.isValueValid(value);\n    },\n\n    /**\n     * create and retrieve the part of a regular expression which describes this very element\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string\n     */\n    getRegex: function (separator, nocapture) {\n      if (typeof separator === 'undefined' || separator === undefined) {\n        // default to an empty string\n        separator = '';\n      }\n\n      let regexString = '(';\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      // start with the name of the element\n      regexString += this.getName() + separator + ')';\n\n      // append bounds\n      let boundsMin = '';\n      let boundsMax = '';\n      const bounds = this.getBounds();\n      if (bounds.min !== undefined) {\n        boundsMin = bounds.min;\n      }\n\n      if (bounds.max !== undefined) {\n        if (bounds.max !== Number.POSITIVE_INFINITY) {\n          boundsMax = bounds.max;\n        }\n      }\n\n      if (boundsMin !== '' || boundsMax !== '') {\n        // append bounds to the regex-string\n        regexString += '{' + boundsMin + ',' + boundsMax + '}';\n      }\n\n      // and thats all\n      return regexString;\n    },\n\n    /**\n     * create a full-blown regular expression that describes this elements immediate children\n     * @param separator   string  the string used to separate different elements, e.g. ';'\n     * @param nocapture\n     * @return  string              the regular expression\n     */\n    getChildrenRegex: function(separator, nocapture) {\n      if (typeof separator == 'undefined' || separator === undefined) {\n        // default to an empty string\n        separator = '';\n      }\n\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // not really something to match\n        return '^';\n      }\n\n      return allowedContent._grouping.getRegex(separator, nocapture);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeMap('__allowedAttributes');\n    this._disposeMap('__allowedContent');\n    this._disposeObjects('__textNodeSchemaElement');\n  }\n});\n","/**\n * Represents an Element or TextNode in an XML document\n */\nqx.Class.define('cv.ui.manager.model.XmlElement', {\n  extend: qx.core.Object,\n  include: [\n    qx.data.marshal.MEventBubbling\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schemaElement, editor, parent) {\n    this.base(arguments);\n    this._node = node;\n    const children = new qx.data.Array();\n    if (node) {\n      this._node.$$widget = this;\n      this.initName(node.nodeName);\n      this.setSchemaElement(schemaElement);\n      if (this.hasChildren()) {\n        // we have to add a fake node to the children to show the tree that this node has children\n        // it will be removed when the real children are loaded\n        children.push(new cv.ui.manager.model.XmlElement());\n      }\n      if (editor) {\n        this.setEditor(editor);\n      }\n      if (parent) {\n        this.setParent(parent);\n      }\n      this._maintainIcon();\n      this._maintainStatus();\n    } else {\n      // this is a fake node needed for children simulation\n      this.initName('#temp');\n    }\n    this.initChildren(children);\n    this._initialAttributes = new Map();\n    this.bind('editor.file.writeable', this, 'editable');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    // the current editor this element os shown in\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      event: 'changeEditor'\n    },\n    schemaElement: {\n      check: 'cv.ui.manager.model.schema.Element',\n      apply: '_applySchemaElement'\n    },\n    name: {\n      check: 'String',\n      deferredInit: true,\n      event: 'changeName',\n      apply: '_updateDisplayName'\n    },\n    displayName: {\n      check: 'String',\n      init: '',\n      event: 'changeDisplayName'\n    },\n    open : {\n      check : 'Boolean',\n      event : 'changeOpen',\n      init : false,\n      apply : '_onOpen'\n    },\n    loaded : {\n      check : 'Boolean',\n      event : 'changeLoaded',\n      init : false\n    },\n    children : {\n      check : 'qx.data.Array',\n      event : 'changeChildren',\n      apply: '_applyEventPropagation',\n      deferredInit : true\n    },\n\n    textContent: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyTextContent',\n      event: 'changeTextContent',\n      validate: '_validateTextContent'\n    },\n    /**\n     * Temporary nodes are not save in the backend yet\n     */\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTemporary'\n    },\n\n    /**\n     * Validation result for this nodes content\n     */\n    valid: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeValid',\n      apply: '_applyValid'\n    },\n\n    invalidMessage: {\n      check: 'String',\n      init: '',\n      event: 'changeInvalidMessage'\n    },\n\n    status: {\n      check: ['error', 'valid', 'comment'],\n      init: 'valid',\n      event: 'changeStatus'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeEditable',\n      apply: '_applyEditable'\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeSortable'\n    },\n\n    /**\n     * true if this element can be deleted (either no bounds.min or more existing elements)\n     */\n    deletable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeDeletable'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyModified'\n    },\n\n    showEditButton: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeShowEditButton'\n    },\n    parent: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true\n    },\n\n    // icon to show in the tree\n    icon: {\n      check: 'String',\n      nullable: true,\n      event: 'changeIcon'\n    },\n\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _node: null,\n    _schema: null,\n    _schemaElement: null,\n    _initialAttributes: null,\n    _initialChildNames: null,\n    _initialTextContent: null,\n    __initializing: false,\n    __addableChildren: null,\n\n    _maintainStatus: function () {\n      if (this._node.nodeType === Node.COMMENT_NODE) {\n        this.setStatus('comment');\n      } else if (!this.isValid()) {\n        this.setStatus('error');\n      } else {\n        this.setStatus('valid');\n      }\n    },\n\n    _applyValid: function (value) {\n      this._maintainStatus();\n      if (value) {\n        this.resetInvalidMessage();\n      }\n    },\n\n    convertTextNodeType: function (newType) {\n      if (this.isTextNode() && this._node.nodeType !== newType && (newType === Node.TEXT_NODE || newType === Node.CDATA_SECTION_NODE)) {\n        const content = this.getText();\n        const oldNode = this._node;\n        const newTextNode = newType === Node.CDATA_SECTION_NODE ? this._node.ownerDocument.createCDATASection(content) : this._node.ownerDocument.createTextNode(content);\n        if (oldNode.parentNode) {\n          oldNode.parentNode.replaceChild(newTextNode, oldNode);\n        }\n        this._node = newTextNode;\n        this.setName(this._node.nodeName);\n        this.load(true);\n      }\n    },\n\n    _maintainIcon: function () {\n      if (this._node) {\n        if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n          this.setIcon(cv.theme.dark.Images.getIcon('text-fields', 18));\n          return;\n        } else if (this._node.nodeType === Node.COMMENT_NODE) {\n          this.setIcon(cv.theme.dark.Images.getIcon('comment-fields', 18));\n          return;\n        } else if (this.getName() === 'icon' && this.getAttribute('name') && this.getAttribute('name').indexOf('{{') === -1) {\n          // try to use the configured icon (if its not set by a template variable)\n          const source = cv.IconHandler.getInstance().getIconSource(this.getAttribute('name'), 'tree-icon');\n          if (source) {\n            this.setIcon(source);\n            return;\n          }\n        }\n      }\n      if (this.isOpen()) {\n        this.setIcon(cv.theme.dark.Images.getIcon('folder-open', 18));\n      } else {\n        this.setIcon(cv.theme.dark.Images.getIcon('folder', 18));\n      }\n    },\n\n    _applyEditable: function () {\n      this._updateShowEditButton();\n      this.updateDeletable();\n    },\n\n    _updateShowEditButton: function () {\n      const schemaElement = this.getSchemaElement();\n      this.setShowEditButton(\n        schemaElement.isTextContentAllowed() && this.getName().startsWith('#') ||\n        Object.keys(schemaElement.getAllowedAttributes()).length > 0 ||\n        schemaElement.isChildElementAllowed('*') // any element allowed, this is edited as text (outerHTML)\n      );\n    },\n\n    updateDeletable: function () {\n      if (!this.isEditable()) {\n        this.setDeletable(false);\n      } else {\n        const parent = this.getParent();\n        if (this.isTextNode()) {\n          if (this.getSchemaElement().isTextContentRequired()) {\n            const existing = parent.getChildren().filter(child => child.isTextNode()).length;\n            this.setDeletable(existing > 1);\n          } else {\n            this.setDeletable(true);\n          }\n        } else {\n          let deletable = false;\n          if (parent) {\n            const schemaElement = parent.getSchemaElement();\n            const requiredFromParent = schemaElement.getRequiredElements();\n            if (requiredFromParent.includes(this.getName())) {\n              const bounds = schemaElement.getBoundsForElementName(this.getName());\n              if (bounds) {\n                const existing = parent.getChildren().filter(child => child.getName() === this.getName()).length;\n                // check if we can afford to delete one\n                deletable = (bounds.min <= existing - 1);\n              } else {\n                deletable = true;\n              }\n            } else {\n              deletable = true;\n            }\n          } else {\n            deletable = true;\n          }\n          this.setDeletable(deletable);\n        }\n      }\n    },\n\n    getNode: function () {\n      return this._node;\n    },\n\n    remove: function (skipUndo) {\n      const parent = this.getParent();\n      if (parent) {\n        const changes = [{\n          index: parent.getChildren().indexOf(this),\n          parent: parent,\n          child: this\n        }];\n        this._node.remove();\n        parent.getChildren().remove(this);\n        const editor = this.getEditor();\n        this.$$removed = true;\n        if (editor) {\n          // editor should not consider the modification state of removed elements\n          editor.updateModified(this);\n        }\n        parent.updateModified();\n        if (!skipUndo) {\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Remove %1', this.getDisplayName()), this, changes, 'deleted');\n            editor.addUndo(change);\n          }\n        }\n      }\n    },\n\n    /**\n     * Check is this element is an ancestor of the given element\n     * @param element {cv.ui.manager.model.XmlElement} element to check\n     * @returns {boolean}\n     */\n    isAncestor: function (element) {\n      let parent = element.getParent();\n      while (parent) {\n        if (parent === this) {\n          return true;\n        }\n        parent = parent.getParent();\n      }\n      return false;\n    },\n\n    /**\n     * Move this node to a new position in relation to the target\n     * @param target {cv.ui.manager.model.XmlElement} new direct sibling\n     * @param position {String} more 'before', 'after' or 'inside' target\n     * @param skipUndo {Boolean} no not add an undo operation for this\n     * @private\n     */\n    _move: function (target, position, skipUndo) {\n      if (this.isAncestor(target)) {\n        // we cannot move into ourselves descendants\n        return false;\n      }\n      if (target === this) {\n        // do not move ourselves before, after or inside ourselves\n        return false;\n      }\n      const parent = this.getParent();\n      const children = parent.getChildren();\n      const targetParent = position === 'inside' ? target : target.getParent();\n      const targetChildren = targetParent.getChildren();\n      const changes = [{\n        oldIndex: children.indexOf(this),\n        oldParent: parent,\n        parent: targetParent,\n        child: this,\n        index: targetChildren.indexOf(target) + (position === 'after' ? 1 : 0)\n      }];\n      if ((position === 'inside' && targetParent.getSchemaElement().isChildElementAllowed(this.getName())) || targetParent.isChildAllowedAtPosition(this, changes[0].index)) {\n        children.remove(this);\n        this.getNode().remove();\n        if (targetParent === parent) {\n          // target index might have changed by removing\n          changes[0].index = targetChildren.indexOf(target) + (position === 'after' ? 1 : 0);\n        }\n        targetParent.insertChild(this, changes[0].index, true, 'moved');\n        if (!skipUndo) {\n          const editor = this.getEditor();\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Move %1', this.getDisplayName()), this, changes, 'moved');\n            editor.addUndo(change);\n          }\n        }\n        return true;\n      }\n      return false;\n    },\n\n    moveTo: function (newParent, index, skipUndo) {\n      if (this.isAncestor(newParent)) {\n        // we cannot move into ourselves descendants\n        return false;\n      }\n      const parent = this.getParent();\n      const children = parent.getChildren();\n      const changes = [{\n        oldIndex: children.indexOf(this),\n        oldParent: parent,\n        parent: newParent,\n        child: this,\n        index: index\n      }];\n      // save old target index because we are moving inside the same parent, and the target index might change after removing\n      const target = newParent === parent && index < children.length ? children.getItem(index) : null;\n      if (newParent.isChildAllowedAtPosition(this, index)) {\n        children.remove(this);\n        this.getNode().remove();\n\n        if (target) {\n          index = children.indexOf(target);\n          changes[0].index = index;\n        }\n        newParent.insertChild(this, index, true, 'moved');\n        if (!skipUndo) {\n          const editor = this.getEditor();\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Move %1', this.getDisplayName()), this, changes, 'moved');\n            editor.addUndo(change);\n          }\n        }\n        return true;\n      }\n      return false;\n    },\n\n    moveAfter: function (target, skipUndo) {\n      return this._move(target, 'after', skipUndo);\n    },\n\n    moveBefore: function (target, skipUndo) {\n      return this._move(target, 'before', skipUndo);\n    },\n\n    moveInside: function (target, skipUndo) {\n      return this._move(target, 'inside', skipUndo);\n    },\n\n    insertAfter: function (target, skipUndo) {\n      const targetParent = target.getParent();\n      const newIndex = targetParent.getChildren().indexOf(target) + 1;\n      return targetParent.insertChild(this, newIndex, skipUndo, 'added');\n    },\n\n    insertBefore: function (target, skipUndo) {\n      const targetParent = target.getParent();\n      const newIndex = targetParent.getChildren().indexOf(target);\n      return targetParent.insertChild(this, newIndex, skipUndo, 'added');\n    },\n\n    /**\n     * Returns a list of element names that can be added to this element.\n     * Checks the allowed elements and their bounds and the existing children\n     * to find out if we can add more of them.\n     * @param excludeComment {Boolean} exclude #comment child when set to true\n     */\n    getAddableChildren: function(excludeComment) {\n      if (!this.__addableChildren) {\n        if (this.getName().startsWith('#')) {\n          this.__addableChildren = [];\n        } else {\n          const schemaElement = this.getSchemaElement();\n          const allowed = schemaElement.getAllowedElements();\n          const stillAllowed = [];\n          const countExisting = {};\n          if (!this.isLoaded()) {\n            this.load();\n          }\n          this.getChildren().forEach(child => {\n            if (!Object.prototype.hasOwnProperty.call(countExisting, child.getName())) {\n              countExisting[child.getName()] = 0;\n            }\n            countExisting[child.getName()]++;\n          });\n\n          Object.keys(allowed).forEach(elementName => {\n            if (excludeComment === true && elementName === '#comment') {\n              return;\n            }\n            if ((elementName === '#text' || elementName === '#cdata-section')) {\n              if (schemaElement.isTextContentAllowed()) {\n                if (schemaElement.isMixed()) {\n                  // is a mixed content has only one text child and no other childs, we do not allow another text child -> avoid direct text siblings\n                  let textNodes = 0;\n                  let otherNodes = 0;\n                  Object.keys(countExisting).forEach(key => {\n                    if (key === '#text' || key === '#cdata-section') {\n                      textNodes+=countExisting[key];\n                    } else {\n                      otherNodes+=countExisting[key];\n                    }\n                  });\n                  if (textNodes<=otherNodes) {\n                    // we do not allow more text nodes than other nodes (e.g. a sequence of #text, elem would allow another #text node after elem)\n                    stillAllowed.push(elementName);\n                  }\n                } else if (!Object.prototype.hasOwnProperty.call(countExisting, '#text') && !Object.prototype.hasOwnProperty.call(countExisting, '#cdata-section')) {\n                  stillAllowed.push(elementName);\n                }\n              }\n              return;\n            }\n            const childBounds = schemaElement.getBoundsForElementName(elementName);\n            const existing = Object.prototype.hasOwnProperty.call(countExisting, elementName) ? countExisting[elementName] : 0;\n            if (childBounds && childBounds.max > existing) {\n              stillAllowed.push(elementName);\n            }\n          });\n          this.__addableChildren = stillAllowed;\n        }\n      }\n      return this.__addableChildren;\n    },\n\n    /**\n     * Checks if a new child is allowed at the given position\n     * @param xmlElement {cv.ui.manager.model.XmlElement|String} the element or an element name as string\n     * @param index {Number} position to check, use Number.POSITIVE_INFINITY to check if the child is allowed to be appended\n     * @returns {boolean}\n     */\n    isChildAllowedAtPosition: function (xmlElement, index) {\n      const schemaElement = this.getSchemaElement();\n      const nodeName = xmlElement instanceof cv.ui.manager.model.XmlElement ? xmlElement.getName() : xmlElement;\n      if (!schemaElement.isChildElementAllowed(nodeName)) {\n        this.debug(nodeName, 'is not allowed as child of', this.getName());\n        return false;\n      }\n      if (schemaElement.areChildrenSortable()) {\n        // allowed at any position\n        return true;\n      }\n      // check position\n      const allowedSorting = schemaElement.getFirstLevelElementSorting();\n      if (!this.isLoaded()) {\n        this.load();\n      }\n      const children = this.getChildren();\n      if (children.length === 0) {\n        // no children yet, no position problem\n        return true;\n      }\n      let currentPosition = index;\n      if (children.length > index) {\n        currentPosition = allowedSorting[children.getItem(index).getName()];\n      } else {\n        currentPosition = children.length;\n      }\n      let targetPosition = allowedSorting[nodeName];\n      if (currentPosition === targetPosition || targetPosition >= children.length) {\n        // no special position\n        return true;\n      } \n        // find the first previous sibling of a different type\n        let previousSibling;\n        if (index > 0) {\n          for (let i = Math.min(index, children.length) - 1; i >= 0; i--) {\n            if (children.getItem(i).getName() !== nodeName) {\n              previousSibling = children.getItem(i).getName();\n              break;\n            }\n          }\n        }\n        if (previousSibling) {\n          currentPosition = allowedSorting[previousSibling];\n        }\n        // only allow if it can be inserted before\n        const allowed = currentPosition + 1 >= targetPosition;\n        if (!allowed) {\n          this.debug(nodeName, 'is not allowed as child of', this.getName());\n          return false;\n        }\n      \n      return true;\n    },\n\n    findPositionForChild: function(newChild) {\n      const schemaElement = this.getSchemaElement();\n      if (schemaElement.isChildElementAllowed(newChild.getName())) {\n        if (!this.isLoaded()) {\n          this.load();\n        }\n        if (schemaElement.areChildrenSortable()) {\n          // any position is fine, just append it to the end\n          return this.getChildren().length;\n        } \n          const allowedSorting = schemaElement.getFirstLevelElementSorting();\n          if (allowedSorting && Object.prototype.hasOwnProperty.call(allowedSorting, newChild.getName())) {\n            const position = allowedSorting[newChild.getName()];\n            // search for the first sibling with a position > than the newChilds and insert it there\n            let targetIndex = position;\n            const found = this.getChildren().some((child, index) => {\n              const childPos = allowedSorting[child.getName()];\n              if (childPos > position) {\n                targetIndex = index;\n                return true;\n              }\n              return false;\n            });\n            if (!found) {\n              // append to the end\n              targetIndex = this.getChildren().length;\n            }\n            return targetIndex;\n          }\n      }\n      return -1;\n    },\n\n    /**\n     * insert child at given index\n     * @param xmlElement {cv.ui.manager.model.XmlElement} new child\n     * @param index {Number} index to insert the child, if set to -1 insert it at any allowed position\n     * @param skipUndo {Boolean} do not add an undo operation for this change\n     * @param internalOperation\n     * @return {Boolean} true if the child has been added\n     */\n    insertChild: function (xmlElement, index, skipUndo, internalOperation) {\n      if (!this.isLoaded()) {\n        this.load();\n      }\n      const children = this.getChildren();\n      let success = false;\n      if (index === -1) {\n        index = this.findPositionForChild(xmlElement);\n        if (index === -1) {\n          // no valid position found\n          return false;\n        }\n      }\n      if (this.isChildAllowedAtPosition(xmlElement, index)) {\n        if (index >= children.length) {\n          // append\n          this._node.appendChild(xmlElement.getNode());\n          children.push(xmlElement);\n          success = true;\n        } else if (index === 0) {\n          // add before first child\n          this._node.insertBefore(xmlElement.getNode(), this._node.children[0]);\n          children.unshift(xmlElement);\n          success = true;\n        } else {\n          const previousChild = children.getItem(index);\n          if (previousChild) {\n            previousChild.getNode().before(xmlElement.getNode());\n            children.insertBefore(previousChild, xmlElement);\n            success = true;\n          }\n        }\n      }\n      if (success) {\n        const editor = this.getEditor();\n        xmlElement.setParent(this);\n        if (xmlElement.$$removed) {\n          delete xmlElement.$$removed;\n          if (editor) {\n            editor.updateModified(xmlElement);\n          }\n          xmlElement.updateModified();\n        } else if (!internalOperation || internalOperation === 'added') {\n            xmlElement.$$added = true;\n            xmlElement.updateModified();\n          }\n        this.updateModified();\n        if (children.length === 1) {\n          // first child added -> open it\n          this.setOpen(true);\n        }\n        if (!skipUndo) {\n          if (editor) {\n            const changes = [{\n              index: index,\n              parent: this,\n              child: xmlElement\n            }];\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Add %1', this.getDisplayName()), this, changes, 'created');\n            editor.addUndo(change);\n          }\n        }\n      }\n      return success;\n    },\n\n    _validateTextContent: function (value) {\n      // do not validate content that is loaded from the actual node\n      if (!this.__initializing) {\n        if (this._node) {\n          if (!this.getSchemaElement().isValueValid(value)) {\n            throw new qx.core.ValidationError(qx.locale.Manager.tr('Invalid text content: \\'%1\\'', value));\n          }\n        } else {\n          throw new qx.core.ValidationError(qx.locale.Manager.tr('Text content not allowed here'));\n        }\n      }\n    },\n\n    /**\n     * Validate this element (and its parent when this is a text node)\n     * @param recursive {Boolean} validate children too\n     */\n    validate: function (recursive) {\n      const schemaElement = this.getSchemaElement();\n      if (this.isTextNode()) {\n        this.getParent().validate(false);\n        this.setValid(schemaElement.isValueValid(this.getText()));\n      } else if (this.isElement()) {\n        const allowedAttributes = schemaElement.getAllowedAttributes();\n        const errors = [];\n        // check attribute values\n        for (let i = 0; i < this._node.attributes.length; i++) {\n          const attr = this._node.attributes.item(i);\n          if (Object.prototype.hasOwnProperty.call(allowedAttributes, attr.name)) {\n            if (!allowedAttributes[attr.name].isValueValid(attr.value)) {\n              errors.push({\n                attribute: attr.name,\n                error: qx.locale.Manager.tr('Invalid value')\n              });\n            }\n          } else {\n            errors.push({\n              attribute: attr.name,\n              error: qx.locale.Manager.tr('Attribute \\'%1\\' not allowed', attr.name)\n            });\n          }\n        }\n        // check for missing required attributes\n        Object.keys(allowedAttributes).filter(name => !allowedAttributes[name].isOptional()).forEach(name => {\n          if (!this._node.hasAttribute(name)) {\n            errors.push({\n              attribute: name,\n              error: qx.locale.Manager.tr('Attribute \\'%1\\' is required but missing', name)\n            });\n          }\n        });\n        if (schemaElement.isTextContentRequired()) {\n          // check if we have at least one non empty #text child\n          const found = this.getChildren().some(child => child.isTextNode() && child.getNode().nodeValue.trim() !== '');\n          if (!found) {\n            errors.push({\n              attribute: '#text',\n              error: qx.locale.Manager.tr('Text content is missing')\n            });\n          }\n        }\n        if (schemaElement.isTextContentAllowed()) {\n          this.getChildren().forEach(child => {\n            if (child.isTextNode()) {\n              child.load();\n              child.setValid(schemaElement.isValueValid(child.getText()));\n              if (!child.isValid()) {\n                child.setInvalidMessage(qx.locale.Manager.tr('Text content is invalid'));\n              }\n            }\n          });\n        }\n        this.setInvalidMessage(errors.map(err => err.error).join('<br/>'));\n        this.setValid(errors.length === 0);\n      }\n    },\n\n    isTextNode: function () {\n      return this.getName() === '#text' || this.getName() === '#cdata-section';\n    },\n\n    _applyTextContent: function (value) {\n      if (!this.__initializing) {\n        if (this._node) {\n          if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n            this._node.nodeValue = value;\n            this._updateDisplayName();\n          } else if (this._node.nodeType === Node.ELEMENT_NODE) {\n            this._node.textContent = value;\n          }\n        }\n      }\n    },\n\n    getText: function () {\n      return this.getTextContent();\n    },\n\n    setText: function (text, nodeName) {\n      let changed = false;\n      let newValue = text;\n      let oldValue = '';\n      if (this.getSchemaElement().isTextContentAllowed()) {\n        oldValue = this.getTextContent();\n        if (this.getSchemaElement().isValueValid(text)) {\n          if (oldValue !== text) {\n            this.setTextContent(text);\n            changed = true;\n          }\n        } else {\n          this.error('\\''+text+'\\' is no valid text content for a \\''+this.getName() + '\\' element');\n        }\n      } else {\n        this.error('text content is not allowed for a \\''+this.getName() + '\\' element');\n      }\n      return {\n        changed: changed,\n        attribute: nodeName || '#text',\n        value: newValue,\n        old: oldValue\n      };\n    },\n\n    getAttribute: function (name) {\n      return this._node.getAttribute(name);\n    },\n\n    setAttribute: function (name, value) {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        const attribute = this.getSchemaElement().getAllowedAttributes()[name];\n        let changed = false;\n        let newValue = value;\n        let oldValue = this._node.hasAttribute(name) ? this._node.getAttribute(name) : '';\n        if (attribute) {\n          if (value === null || value === undefined) {\n            value = '';\n          } else {\n            value = '' + value;\n          }\n          newValue = value;\n          if (attribute.isValueValid(value)) {\n            if (oldValue !== value) {\n              if (!value || value === attribute.getDefaultValue()) {\n                this._node.removeAttribute(name);\n                newValue = '';\n              } else {\n                this._node.setAttribute(name, value);\n              }\n              if (name === 'name') {\n                this._updateDisplayName();\n                if (this.getName() === 'icon') {\n                  this._maintainIcon();\n                }\n              }\n              changed = true;\n            }\n          } else {\n            this.error('\\'' + value + '\\' is not allowed for attribute \\'' + name + '\\'');\n          }\n        } else {\n          this.error('\\'' + name + '\\' is no allowed attribute for a \\'' + this.getName() + '\\' element');\n        }\n        return {\n          changed: changed,\n          attribute: name,\n          value: newValue,\n          old: oldValue\n        };\n      } else if (this._node.nodeType === Node.TEXT_NODE && name === '#text' || (this._node.nodeType === Node.CDATA_SECTION_NODE && name === '#cdata-section')) {\n        return this.setText(value, name);\n      } else if ((this._node.nodeType === Node.COMMENT_NODE && name === '#comment')) {\n        const oldValue = this.getTextContent();\n        const changed = value !== oldValue;\n        this.setTextContent(value);\n        return {\n          changed: changed,\n          attribute: name,\n          value: value,\n          old: oldValue\n        };\n      }\n      return null;\n    },\n\n    /**\n     * @return {Boolean} true if this element is a required child from its parent\n     */\n    isRequired: function () {\n      const parent = this.getParent();\n      if (parent) {\n        const requiredFromParent = parent.getSchemaElement().getRequiredElements();\n        return requiredFromParent.includes(this.getName());\n      }\n      // only root element has nor parent, and a root element is always required\n      return true;\n    },\n\n    setAttributes: function (data) {\n      const changes = [];\n      let change;\n      const parentChanges = [];\n      const isTextNode = (this.getName() === '#text' || this.getName() === '#cdata-section');\n      const parent = this.getParent();\n      Object.keys(data).forEach(attrName => {\n        if (isTextNode && !attrName.startsWith('#')) {\n          // special mode for editing text content from a data provider with hints, those hints must be applied to the parent\n          change = parent.setAttribute(attrName, data[attrName]);\n          if (change.changed) {\n            parentChanges.push(change);\n          }\n        } else if (attrName === '#outerHTML' || attrName === '#innerHTML') {\n          if (this.getSchemaElement().isChildElementAllowed('*')) {\n            const dom = new DOMParser().parseFromString(data[attrName], 'text/xml');\n            if (dom.getElementsByTagName('parsererror').length === 0) {\n              const oldValue = attrName === '#outerHTML' ? this._node.outerHTML : this._node.innerHTML;\n              const newNode = dom.documentElement;\n              if (attrName === '#outerHTML') {\n                const oldNode = this._node;\n                oldNode.parentNode.replaceChild(newNode, oldNode);\n                this._node = newNode;\n                this.setName(this._node.nodeName);\n              } else {\n                this._node.innerHTML = data[attrName];\n              }\n              changes.push({\n                changed: true,\n                attribute: attrName,\n                value: data[attrName],\n                old: oldValue\n              });\n              this.load(true);\n            }\n          } else if (attrName === '#innerHTML' && !data[attrName]) {\n            // allow empty values\n            const oldValue = this._node.innerHTML;\n            this._node.innerHTML = data[attrName];\n            changes.push({\n              changed: true,\n              attribute: attrName,\n              value: data[attrName],\n              old: oldValue\n            });\n            this.load(true);\n          }\n        } else {\n          change = this.setAttribute(attrName, data[attrName]);\n          if (change.changed) {\n            changes.push(change);\n          }\n        }\n      });\n      const editor = this.getEditor();\n      if (editor && changes.length > 0) {\n        if (parentChanges.length > 0) {\n          const parentChange = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Change %1', parent.getDisplayName()), parent, parentChanges);\n          changes.push(parentChange);\n          parent.updateModified();\n        }\n        editor.addUndo(new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Change %1', this.getDisplayName()), this, changes));\n      }\n      this.updateModified();\n    },\n\n    _applySchemaElement: function (schemaElement) {\n      schemaElement.bind('sortable', this, 'sortable', {\n        converter: function (value) {\n          return this.isEditable() && value;\n        }.bind(this)\n      });\n      this._updateShowEditButton();\n    },\n\n    _onOpen: function (value) {\n      if (value && !this.isLoaded()) {\n        this.load();\n      }\n      this._maintainIcon();\n    },\n\n    _applyModified: function () {\n      this._updateDisplayName();\n    },\n\n    _updateDisplayName: function () {\n      let displayName = this.getName();\n      if (this._node) {\n        if (this._node.nodeType === Node.ELEMENT_NODE) {\n          if (this._node.hasAttribute('name')) {\n            const nameAttr = this._node.getAttribute('name');\n            displayName += ' \"' + nameAttr + '\"';\n          } else if (this.getName() === 'pages' && this._node.hasAttribute('design')) {\n            const designAttr = this._node.getAttribute('design');\n            displayName += ' \"' + designAttr + '\"';\n          }\n        } else if ((this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE || this._node.nodeType === Node.COMMENT_NODE) && this._node.nodeValue.trim()) {\n          let textContent = this._node.nodeValue.trim();\n          if (textContent.length > 26) {\n            textContent = textContent.substring(0, 26) + '...';\n          }\n          displayName = textContent;\n        }\n      }\n      if (this.isModified()) {\n        displayName += ' *';\n      }\n      this.setDisplayName(displayName);\n    },\n    hasChildren: function() {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        if (this._node && this._node.hasChildNodes()) {\n          for (let i = 0; i < this._node.childNodes.length; i++) {\n            const childNode = this._node.childNodes.item(i);\n            if (childNode.nodeType === Node.ELEMENT_NODE ||\n              ((childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.CDATA_SECTION_NODE) && childNode.nodeValue.trim() !== '')) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    },\n\n    load: function (force) {\n      if (!this.isLoaded() || force) {\n        this.__initializing = true;\n        const children = this.getChildren();\n        children.removeListener('change', this._syncChildNodes, this);\n        children.removeAll();\n        if (this._node) {\n          if (this._node.nodeType === Node.ELEMENT_NODE) {\n            // read children\n            const schemaElement = this.getSchemaElement();\n            this._initialChildNames = [];\n            for (let i = 0; i < this._node.childNodes.length; i++) {\n              const childNode = this._node.childNodes.item(i);\n              const childSchemaElement = schemaElement.getSchemaElementForElementName(childNode.nodeName);\n              if (childSchemaElement) {\n                if (childNode.nodeType === Node.ELEMENT_NODE) {\n                  const child = new cv.ui.manager.model.XmlElement(childNode, childSchemaElement, this.getEditor(), this);\n                  children.push(child);\n                  this._initialChildNames.push(childNode.nodeName);\n                } else if (childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.CDATA_SECTION_NODE) {\n                  if (childNode.nodeValue.trim()) {\n                    // do not use childSchemaElement here, because our schemeElement already knows how to validate text\n                    const child = new cv.ui.manager.model.XmlElement(childNode, schemaElement, this.getEditor(), this);\n                    if (schemaElement.isMixed()) {\n                      // text nodes can be re-ordered in mixed content\n                      child.setSortable(true);\n                    }\n                    children.push(child);\n                    if (childNode.nodeValue.trim()) {\n                      this._initialChildNames.push(childNode.nodeName);\n                    }\n                  }\n                } else if (childNode.nodeType === Node.COMMENT_NODE) {\n                  if (childNode.nodeValue) {\n                    const child = new cv.ui.manager.model.XmlElement(childNode, childSchemaElement, this.getEditor(), this);\n                    // comment nodes are allowed everywhere. but we do not allow them to be moved via drag&drop now\n                    // because comments might contains template conditions, which will get invalid when moved and we cannot validate that\n                    child.setSortable(false);\n                    children.push(child);\n                    if (childNode.nodeValue.trim()) {\n                      this._initialChildNames.push(childNode.nodeName);\n                    }\n                  }\n                }\n              } else if (childNode.nodeType === Node.ELEMENT_NODE) {\n                if (schemaElement.isChildElementAllowed(childNode.nodeName)) {\n                  // allowed but no schema element\n                  const child = new cv.ui.manager.model.XmlElement(childNode, schemaElement, this.getEditor(), this);\n                  if (schemaElement.isMixed()) {\n                    // text nodes can be re-ordered in mixed content\n                    child.setSortable(true);\n                  }\n                  children.push(child);\n                  this._initialChildNames.push(childNode.nodeName);\n                } else {\n                  // only complain for real childs (no comments, textNodes)\n                  this.setValid(false);\n                  let msg = this.getInvalidMessage();\n                  msg = (msg ? msg + '<br/>' : '') + qx.locale.Manager.tr('Child element \\'%1\\' not allowed.', childNode.nodeName);\n                  this.setInvalidMessage(msg);\n                  this.setValid(false);\n                }\n              }\n            }\n\n            // read attributes\n            this._initialAttributes.clear();\n            for (let i = 0; i < this._node.attributes.length; i++) {\n              const attr = this._node.attributes.item(i);\n              this._initialAttributes.set(attr.name, attr.value);\n            }\n          } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n            this._initialTextContent = this._node.nodeValue;\n            try {\n              this.setTextContent(this._node.nodeValue);\n            } catch (e) {\n              this.appendInvalidMessage(e.toString());\n            }\n          }\n        }\n        this.setLoaded(true);\n        children.addListener('change', this._syncChildNodes, this);\n        this._updateChildrenDeletableFlags();\n        this.__initializing = false;\n      }\n    },\n\n    appendInvalidMessage: function (errorMsg) {\n      if (errorMsg) {\n        const existing = this.getInvalidMessage();\n        this.setInvalidMessage(existing ? existing + '<br/>' + errorMsg : errorMsg);\n      }\n    },\n\n    updateModified: function () {\n      if (this.$$added) {\n        this.setModified(true);\n      } else if (this._node.nodeType === Node.ELEMENT_NODE) {\n        const initial = this._initialAttributes;\n        const currentChildNames = this._currentChildNames();\n        if (this._node.attributes.length !== initial.size) {\n          this.setModified(true);\n        } else if (currentChildNames.length !== this._initialChildNames.length || currentChildNames.join('') !== this._initialChildNames.join('')) {\n          this.setModified(true);\n        } else {\n          for (const [key, value] of initial) {\n            if (!this._node.hasAttribute(key) || this._node.getAttribute(key) !== value) {\n              this.setModified(true);\n              return;\n            }\n          }\n          this.setModified(false);\n        }\n      } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n        this.setModified(this._initialTextContent !== this.getTextContent());\n      }\n      const editor = this.getEditor();\n      if (editor) {\n        editor.updateModified(this);\n      }\n    },\n\n    /**\n     * Special check if this element has modified children (position, of length)\n     * This is used to determine if the preview highlighting needs to be disabled because the xml structure has changed\n     * @returns {*|boolean}\n     */\n    hasChildrenModified: function () {\n      if (this._node.nodeType === Node.ELEMENT_NODE && this.isLoaded()) {\n        const currentChildNames = this._currentChildNames();\n        return this.isModified() && (currentChildNames.length !== this._initialChildNames.length || currentChildNames.join('') !== this._initialChildNames.join(''));\n      }\n      return false;\n    },\n\n    onSaved: function () {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        // read attributes\n        this._initialAttributes.clear();\n        for (let i = 0; i < this._node.attributes.length; i++) {\n          const attr = this._node.attributes.item(i);\n          this._initialAttributes.set(attr.name, attr.value);\n        }\n        this._initialChildNames = this._currentChildNames();\n      } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n        this._initialTextContent = this._node.nodeValue;\n      }\n      if (this.$$added) {\n        delete this.$$added;\n      }\n      this.setModified(false);\n    },\n\n    isElement: function () {\n      return this._node.nodeType === Node.ELEMENT_NODE;\n    },\n\n    _currentChildNames: function () {\n      const names = [];\n      for (let i = 0; i < this._node.childNodes.length; i++) {\n        const childNode = this._node.childNodes.item(i);\n        if (childNode.nodeType === Node.ELEMENT_NODE) {\n          names.push(childNode.nodeName);\n        } else if ((childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) && childNode.nodeValue.trim()) {\n          names.push(childNode.nodeName);\n        }\n      }\n      return names;\n    },\n\n    _syncChildNodes: function (ev) {\n      // children have changed clear cache\n      this.__addableChildren = null;\n      // we have to update all deletable flags for this elements children, when their siblings changed\n      this._updateChildrenDeletableFlags();\n    },\n\n    _updateChildrenDeletableFlags: function () {\n      if (this.isEditable()) {\n        this.getChildren().forEach(child => {\n          if (child.isElement() || child.isTextNode()) {\n            child.updateDeletable();\n          }\n        });\n      }\n    },\n\n    getWidgetPath: function () {\n      if (this.getName() === '#comment') {\n        return '';\n      }\n      const widgets = this.getSchemaElement().getSchema().getWidgetNames();\n      let current = this;\n      while (current && !widgets.includes(current.getName())) {\n        current = current.getParent();\n      }\n      if (!current) {\n        return '';\n      }\n      if (current.getName() === 'navbar') {\n        return 'navbar' + qx.lang.String.firstUp(current.getAttribute('position'));\n      }\n\n      const ids = [];\n      let c = current;\n      while (c) {\n        const parent = c.getParent();\n        if (parent.getName() === 'pages') {\n          ids.unshift('id');\n          break;\n        }\n        let id = parent.getChildren().filter(child => child.getNode().nodeType === Node.ELEMENT_NODE && child.getName() !== 'layout').indexOf(c);\n        ids.unshift(id);\n        c = parent;\n      }\n      if (current.getName() === 'page') {\n        // make sure that the join ends with '_'\n        ids.push('');\n      }\n      return ids.join('_');\n    },\n\n    // overridden\n    clone: function() {\n      return new cv.ui.manager.model.XmlElement(this._node.cloneNode(true), this.getSchemaElement(), this.getEditor());\n    }\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._node = null;\n    this._schema = null;\n    this._initialAttributes = null;\n    this.__addableChildren = null;\n    this._disposeObjects('_schemaElement');\n  }\n});\n","/**\n * Wrapper class for all data providers.\n */\nqx.Class.define('cv.ui.manager.editor.data.Provider', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__cache = {};\n    this._client = cv.io.rest.Client.getDataProviderClient();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    Config: {\n      'address': {\n        '#text': {\n          cache: true,\n          userInputAllowed: true,\n          grouped: true,\n          method: 'getAddresses'\n        }\n      },\n      'rrd': {\n        '#text': {\n          cache: true,\n          userInputAllowed: true,\n          method: 'getRrds'\n        }\n      },\n      'influx': {\n        'measurement': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBs'\n        },\n        'field': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBFields'\n        }\n      },\n      'tag': {\n        'key': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBTags'\n        },\n        'value': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBValues'\n        }\n      },\n      'icon': {\n        'name': {\n          cache: true,\n          userInputAllowed: false,\n          method: 'getIcons'\n        }\n      },\n      'plugin': {\n        'name': {\n          cache: true,\n          userInputAllowed: false,\n          method: 'getPlugins'\n        }\n      },\n      'pages': {\n        'design': {\n          method: 'getDesigns',\n          cache: true,\n          userInputAllowed: false\n        }\n      },\n      // wildcard: will match ANY elements attribute (lower prio than an exact element-attribute-match)\n      '*': {\n        'rrd': {\n          method: 'getRrds',\n          cache: true,\n          userInputAllowed: true\n        },\n        'ga': {\n          method: 'getAddresses',\n          cache: true,\n          userInputAllowed: true,\n          grouped: true\n        },\n        'transform': {\n          method: 'getTransforms',\n          cache: true,\n          userInputAllowed: false\n        }\n      }\n    },\n\n    get: function (id, ...args) {\n      const instance = cv.ui.manager.editor.data.Provider.getInstance();\n      const format = 'dp';\n      const [element, attribute] = id.split('@');\n      let config = null;\n      if (this.Config[element] && this.Config[element][attribute]) {\n        config = this.Config[element][attribute];\n      } else if (this.Config['*'][attribute]) {\n        config = this.Config['*'][attribute];\n      }\n      if (config) {\n        const conf = {};\n        if (config.live) {\n          conf.getLive = qx.lang.Function.curry(instance[config.method], format, config).bind(instance);\n        } else {\n          args.unshift(config);\n          args.unshift(format);\n          conf.data = instance[config.method].apply(instance, args);\n        }\n        return Object.assign(conf, config);\n      }\n      return null;\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __cache: null,\n\n    _getFromCache: function (cacheId) {\n      return this.__cache[cacheId];\n    },\n\n    __clearFromCache: function (cacheId) {\n      if (!cacheId) {\n        this.__cache = {};\n      } else {\n        delete this.__cache[cacheId];\n      }\n    },\n\n    _addToCache: function (cacheId, data) {\n      this.__cache[cacheId] = data;\n    },\n\n    /**\n     * Returns the available design names as array of suggestions.\n     * @param format\n     * @param config\n     * @returns {Promise<Array>} suggestions\n     */\n    getDesigns: function (format, config) {\n      if (!config) {\n        config = {cache: true};\n      }\n      return this.__getData('designs', 'designsSync', null, [], format === 'dp' ? function (res) {\n        return res.map(function (designName) {\n          return {\n            label: designName,\n            value: designName\n          };\n        });\n      } : function (res) {\n        return res.map(function (designName) {\n          return {\n            label: designName,\n            insertText: designName,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          };\n        });\n      }, this, config.cache);\n    },\n\n    /**\n     * @param cacheId {String}\n     * @param rpc {String|Function} rpcname to use with this._client or function to call\n     * @param rpcContext {Object} rpc context\n     * @param args {Array} rpc arguments\n     * @param converter {Function} converter that converts the response to suggestions for the text editor\n     * @param converterContext {Object} context fot the converter function\n     * @param cache\n     * @returns {Promise<any>}\n     * @private\n     */\n    __getData: function (cacheId, rpc, rpcContext, args, converter, converterContext, cache) {\n      const cached = cache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return Promise.resolve(converter.call(converterContext || this, cached));\n      } \n        return new Promise(function (resolve, reject) {\n          const handleResponse = function (err, res) {\n            if (err) {\n              reject(err);\n            } else if (typeof res === 'string' && res.startsWith('Error:')) {\n              qx.log.Logger.error(this, res);\n              resolve(converter.call(converterContext || this, []));\n            } else {\n              if (cache) {\n                // cache the raw values not the converted ones\n                this._addToCache(cacheId, res);\n              }\n              resolve(converter.call(converterContext || this, res));\n            }\n          };\n          if (!args) {\n            args = [handleResponse, this];\n          } else {\n            args.push(handleResponse);\n            args.push(this);\n          }\n          if (qx.lang.Type.isString(rpc)) {\n            this._client[rpc].apply(rpcContext || this._client, args);\n          } else if (qx.lang.Type.isFunction(rpc)) {\n            rpc.apply(rpcContext, args);\n          }\n        }.bind(this));\n    },\n\n    __getFromUrl: function (url, converter, converterContext, cache) {\n      let cached = cache ? this._getFromCache(url) : null;\n      if (cached) {\n        if (converter) {\n          cached = converter.call(converterContext || this, cached);\n        }\n        return Promise.resolve(cached);\n      } \n        return new Promise(function (resolve, reject) {\n          const xhr = new qx.io.request.Xhr(url);\n          cv.TemplateEngine.getClient().authorize(xhr);\n          xhr.set({\n            accept: 'application/json'\n          });\n          xhr.addListener('success', ev => {\n            let data = ev.getTarget().getResponse();\n            if (cache) {\n              this._addToCache(url, data);\n            }\n            if (converter) {\n              data = converter.call(converterContext || this, data);\n            }\n            resolve(data);\n            }, this);\n          xhr.addListener('statusError', reject, this);\n          xhr.send();\n        }.bind(this));\n    },\n\n    getAddresses: function (format, config) {\n      const client = cv.TemplateEngine.getClient();\n      if (!config) {\n        config = {cache: true};\n      }\n      if (client.hasProvider('addresses')) {\n        return this.__getFromUrl(client.getProviderUrl('addresses'), client.getProviderConvertFunction('addresses', format), client, config.cache);\n      } \n        return this.__getData('addresses', 'addressesSync', null, [], format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    getRrds: function (format, config) {\n      const client = cv.TemplateEngine.getClient();\n      if (!config) {\n        config = {cache: true};\n      }\n      if (client.hasProvider('rrd')) {\n        return this.__getFromUrl(client.getProviderUrl('rrd'), client.getProviderConvertFunction('rrd', format), client, config.cache);\n      } \n        return this.__getData('rrds', 'rrdsSync', null, [], format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    getInfluxDBs: function (format, config, element) {\n      const args = this.__getInfluxArgs(element, false);\n      return this.__getData('influxdbs', 'influxdbsSync', null, args, format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    __getInfluxArgs: function (element, withMeasurement) {\n      const args = [];\n      if (element.hasAttribute('authentication')) {\n        args.push({auth: element.getAttribute('authentication')});\n      }\n      if (withMeasurement) {\n        let influx = element;\n        // walk the tree to get the selected data source in the influx element\n        while (influx.nodeName !== 'influx') {\n          influx = influx.parentElement;\n          if (undefined === influx) {\n            // this safety measure can not happen without a bug somewhere!\n            throw new Error();\n          }\n        }\n        args.push({measurement: element.getAttribute('measurement')});\n      }\n      return args;\n    },\n\n    getInfluxDBFields: function (format, config, element) {\n     try {\n       const args = this.__getInfluxArgs(element, true);\n       return this.__getData('influxdbfields|' + args.measurement + '|' + args.auth, 'influxdbfieldsSync', null, args, format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n     } catch (e) {\n       return [];\n     }\n    },\n\n    __getInfluxDBTags: function (format, config, element, converter) {\n      try {\n        const args = this.__getInfluxArgs(element, true);\n        return this.__getData('influxdbtags|' + args.measurement + '|' + args.auth, 'influxdbtagsSync', null, args, converter, this, config.cache);\n      } catch (e) {\n        return [];\n      }\n    },\n\n    getInfluxDBTags: function (format, config, element) {\n      return this.__getInfluxDBTags(format, config, element, function (res) {\n        if (format === 'monaco') {\n          return Object.keys(res).map(function (x) {\n            return {\n              label: x,\n              insertText: x,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } \n          return Object.keys(res).map(function (x) {\n            return {value: x, label: x};\n          });\n      });\n    },\n\n    getInfluxDBValues: function (format, config, element, tag) {\n      return this.__getInfluxDBTags(format, config, element, function (res) {\n        if (res === null || !(element.attributes.key in res)) {\n          return [];\n        }\n        if (format === 'monaco') {\n          return res[tag].map(function (x) {\n            return {\n              label: x,\n              insertText: x,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } \n          return res[tag].map(function (x) {\n            return {\n              label: x,\n              value: x\n            };\n          });\n      });\n    },\n\n    _parseDpResponseForMonaco: function (data) {\n      return this.__parseDpResponse(data, 'monaco');\n    },\n\n    _parseDpResponseForEditor: function (data) {\n      return this.__parseDpResponse(data, 'dp');\n    },\n\n    __parseDpResponse: function (data, format) {\n      const target = [];\n      if (!format || format === 'monaco') {\n        data.forEach(function (entry) {\n          target.push({\n            label: entry.label,\n            insertText: entry.value,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          });\n        }, this);\n      } else if (format === 'dp') {\n        return data || [];\n      }\n      return target;\n    },\n\n    getMediaFiles: function (format, config, typeFilter) {\n      const fsClient = cv.io.rest.Client.getFsClient();\n      return this.__getData('media', fsClient.readSync, fsClient, [{path: 'media', recursive: true}], function (res) {\n        return res.filter(function (file) {\n          return !typeFilter || file.name.endsWith('.' + typeFilter);\n        }).map(function (file) {\n          const path = file.parentFolder + file.name;\n          return {\n            label: path,\n            insertText: path,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          };\n        });\n      }, this, config.cache);\n    },\n\n    /**\n     * Returns the list of available transformations as suggestion entry array.\n     * @param format\n     * @param config\n     * @returns {Array}\n     */\n    getTransforms: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const cacheId = 'transforms|' + format;\n      const useCache = !config || config.cache === true;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      }\n      const transforms = [];\n      Object.keys(cv.Transform.registry).forEach(function (key) {\n          const entry = cv.Transform.registry[key];\n          let suggestion;\n          if (format === 'dp') {\n            suggestion = {\n              label: entry.name + ' [' + key + ']',\n              value: key\n            };\n          } else {\n            suggestion = {\n              label: key,\n              insertText: key,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n            if (entry.lname && Object.prototype.hasOwnProperty.call(entry.lname, qx.locale.Manager.getInstance().getLanguage())) {\n              suggestion.detail = entry.lname[qx.locale.Manager.getInstance().getLanguage()];\n            }\n          }\n          transforms.push(suggestion);\n        }, this);\n        if (useCache) {\n          this._addToCache(cacheId, transforms);\n        }\n        return transforms;\n    },\n\n    /**\n     * Returns the plugin names (all defined parts staring with 'plugin-')\n     * @param format\n     * @param config\n     * @returns {Array}\n     */\n    getPlugins: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const useCache = !config || config.cache === true;\n      const cacheId = 'plugins|' + format;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      }\n      const plugins = [];\n      const qxParts = qx.io.PartLoader.getInstance().getParts();\n      Object.keys(qxParts).forEach(function (partName) {\n          if (partName.startsWith('plugin-')) {\n            const pluginName = partName.substring(7);\n            if (format === 'dp') {\n              plugins.push({\n                label: pluginName,\n                value: pluginName\n              });\n            } else {\n              plugins.push({\n                label: pluginName,\n                insertText: pluginName,\n                kind: window.monaco.languages.CompletionItemKind.EnumMember\n              });\n            }\n          }\n        }, this);\n        if (useCache) {\n          this._addToCache(cacheId, plugins);\n        }\n        return plugins;\n    },\n\n    getIcons: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const useCache = !config || config.cache === true;\n      const cacheId = 'icons|' + format;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      } \n        let icons;\n        const iconHandler = cv.IconHandler.getInstance();\n        if (format === 'monaco') {\n          icons = Object.keys(cv.IconConfig.DB).map(function (iconName) {\n            return {\n              label: iconName,\n              insertText: iconName,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } else if (format === 'dp') {\n          // dataprovider format\n          icons = Object.keys(cv.IconConfig.DB).map(function (iconName) {\n            return {\n              label: iconName,\n              value: iconName,\n              icon: iconHandler.getIconSource(iconName)\n            };\n          });\n        }\n        if (useCache) {\n          this._addToCache(cacheId, icons);\n        }\n        return icons;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__cache = null;\n  }\n});\n","/**\n * Show validation errors for a config file.\n */\nqx.Class.define('cv.ui.manager.dialog.ValidationError', {\n  extend: qxl.dialog.Dialog,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   *\n   * @param file {cv.ui.manager.model.FileItem}\n   * @param content {String}\n   * @param errors {Array<Map>}\n   * @param properties {Map?}\n   */\n  construct: function (file, content, errors, properties) {\n    this._file = file;\n    this._content = content.split('\\n');\n    this._errors = errors;\n    this.base(arguments, Object.assign(properties || {}, {\n      useBlocker: true\n    }));\n\n    this.addListener('appear', () => {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this.highlight, this);\n      } else {\n        this.highlight();\n      }\n    });\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n   action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _content: null,\n    _errors: null,\n    _rootListenerId: null,\n\n    /**\n     * @var {cv.ui.manager.model.FileItem}\n     */\n    _file: null,\n\n    highlight: function () {\n      Array.from(document.querySelectorAll('pre.highlight')).forEach(elem => {\n        monaco.editor.colorizeElement(elem, {\n          theme: 'vs-dark'\n        });\n      });\n    },\n\n    /**\n     * Create the main content of the widget\n     */\n    _createWidgetContent: function() {\n      let container = this._createDialogContainer();\n      let vbox = new qx.ui.container.Composite(new qx.ui.layout.VBox(10));\n      container.add(vbox);\n\n      let prologue = this.tr('<h3>Config Errors</h3>\\\n<p>The validation of \"%1\" showed some errors. It is NOT recommended to edit this file in the XML-Tree editor, because \\\nit can break the file completely. Please open this file in the text editor and fix the errors there. \\\nOnly proceed to edit the file in the XML-Tree editor if you know what you are doing.</p>', this._file.getFullPath());\n\n      let options = this.tr('<p>You can choose between the following options:\\\n<ul>\\\n    <li><b>Cancel</b> - Close this editor</li>\\\n    <li><b>Proceed</b> - Open the defective file in this editor</li>\\\n    <li><b>Open in text editor</b> - Close this editor and open the defective file in the text editor</li>\\\n</ul>\\\n</p>');\n      const labelOptions = {\n        rich: true,\n        width: Math.min(qx.bom.Viewport.getWidth() - 32, 750),\n        allowGrowX: true\n      };\n      const message = new qx.ui.basic.Label(prologue);\n      message.set(labelOptions);\n      vbox.add(message);\n\n      // errors\n      const errorBox = new qx.ui.container.Composite(new qx.ui.layout.VBox(0));\n      const errorScroll = new qx.ui.container.Scroll(errorBox);\n      errorScroll.set({\n        padding: [0, 0, 8, 8],\n        decorator: 'cv-editor-config-section'\n      });\n      errorScroll.setMinHeight(100);\n      errorScroll.setHeight(Math.min(300, qx.bom.Document.getHeight() - 340));\n      this._rootListenerId = qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        errorScroll.setHeight(Math.min(300, qx.bom.Document.getHeight() - 340));\n      });\n      vbox.add(errorScroll, {flex: 1});\n      const errorLabels = new Map();\n      this._errors.forEach(error => {\n        const errorId = error.line + error.element + error.attribute;\n        let label;\n        if (!errorLabels.has(errorId)) {\n          let codeSnippet = [];\n          const startIndex = Math.max(0, error.line-3);\n          const endIndex = Math.min(this._content.length - 1, error.line+2);\n          let minIndent = Number.POSITIVE_INFINITY;\n          for (let i = startIndex; i < endIndex; i++) {\n            const line = this._content[i];\n            const indent = line.search(/\\S|$/);\n            if (indent < minIndent && indent >= 0) {\n              minIndent = indent;\n            }\n            codeSnippet.push([i+1, line.trimRight()]);\n          }\n          if (minIndent === Number.POSITIVE_INFINITY) {\n            minIndent = 0;\n          }\n          codeSnippet = codeSnippet.map(line => line[0] + ': ' + qx.xml.String.escape(line[1].substr(minIndent)));\n          const headline = this.tr('Line %1', error.line);\n          label = new qx.ui.basic.Label(`<h4>${headline}</h4><pre class=\"highlight\" style=\"background-color: black; padding: 8px;\" data-lang=\"text/xml\">${codeSnippet.join('\\n')}</pre>`);\n          label.set(labelOptions);\n          errorLabels.set(errorId, label);\n          errorBox.add(label);\n        } else {\n          label = errorLabels.get(errorId);\n        }\n        if (!error.message.startsWith('[facet')) {\n          label.setValue(label.getValue() + `<p>${error.message}</p>`);\n        }\n      }, this);\n\n      const option = new qx.ui.basic.Label(options);\n      option.set(labelOptions);\n      vbox.add(option);\n\n      // buttons\n      let buttonPane = this._createButtonPane();\n\n      // close button\n      let closeButton = new qx.ui.form.Button(this.tr('Cancel'));\n      closeButton.addListener('execute', () => this.fireDataEvent('action', 'cancel'), this);\n\n      let proceedButton = new qx.ui.form.Button(this.tr('Proceed'));\n      proceedButton.addListener('execute', () => this.fireDataEvent('action', 'proceed'), this);\n\n      let openSourceButton = new qx.ui.form.Button(this.tr('Open in text editor'));\n      openSourceButton.addListener('execute', () => this.fireDataEvent('action', 'open-source'), this);\n\n      buttonPane.add(closeButton);\n      buttonPane.add(proceedButton);\n      buttonPane.add(openSourceButton);\n\n      container.add(buttonPane);\n      this.add(container);\n    }\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._content = null;\n    this._errors = null;\n    this._file = null;\n    if (this._rootListenerId) {\n      qx.core.Init.getApplication().getRoot().removeListenerById(this._rootListenerId);\n      this._rootListenerId = null;\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.config.Section', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name) {\n    this.base(arguments);\n    this.setName(name);\n    this.initOptions(new qx.data.Array());\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    name: {\n      check: 'String',\n      event: 'changeName',\n      init: ''\n    },\n\n    options: {\n      check: 'qx.data.Array',\n      deferredInit: true,\n      event: 'changeOptions'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    addOption: function(key, value) {\n      const options = this.getOptions();\n      const found = options.some(function (option) {\n        if (option.getKey() === key) {\n          option.setValue(value);\n          return true;\n        }\n        return false;\n      }, this);\n      if (!found) {\n        options.push(new cv.ui.manager.model.config.Option(key, value));\n      }\n    }\n  }\n});\n","/**\n * This widgets shows and editable config section in a list.\n */\nqx.Class.define('cv.ui.manager.form.SectionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    const grid = new qx.ui.layout.Grid(8, 8);\n    grid.setColumnFlex(1, 1);\n    grid.setColumnAlign(0, 'left', 'top');\n    this._setLayout(grid);\n    this._createChildControl('section-title');\n    this._createChildControl('list');\n    this._createChildControl('delete');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-section'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.config.Section',\n      nullable: false,\n      apply: '_applyModel'\n    },\n\n    modified:{\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'delete': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n    _originalName: null,\n    _originalOptions: null,\n\n    _applyModel: function (value, old) {\n      const nameField = this.getChildControl('name');\n      this.__unbindModel(old);\n      if (value) {\n        value.bind('name', nameField, 'value');\n        this._originalName = value.getName();\n        this._originalOptions = {};\n        value.getOptions().forEach(function (option) {\n          option.addListener('change', this.__checkForModification, this);\n          this._originalOptions[option.getKey()] = option.getValue();\n        }, this);\n        nameField.bind('value', value, 'name');\n        value.addListener('changeName', this.__checkForModification, this);\n        value.bind('options', this._listController, 'model');\n        // add at least one empty entry, when there are no options\n        if (value.getOptions().length === 0) {\n          const emptyOption = new cv.ui.manager.model.config.Option('', '');\n          value.getOptions().push(emptyOption);\n        }\n      } else {\n        this._originalName = null;\n        this._originalOptions = null;\n      }\n    },\n\n    __unbindModel: function (model) {\n      if (model) {\n        const nameField = this.getChildControl('name');\n        if (this._listController) {\n          model.removeRelatedBindings(this._listController);\n        }\n        model.removeListener('changeName', this.__checkForModification, this);\n        model.removeRelatedBindings(nameField);\n        nameField.removeRelatedBindings(model);\n        model.getOptions().forEach(function (option) {\n          option.removeListener('change', this.__checkForModification, this);\n        }, this);\n      }\n    },\n\n    __checkForModification: function () {\n      if (this._originalName !== this.getModel().getName()) {\n        this.setModified(true);\n        return;\n      }\n      // check if the still have the same the same amount of options\n      if (Object.keys(this._originalOptions).length !== this.getModel().getOptions().length) {\n        this.setModified(true);\n        return;\n      }\n      // compare options one by one\n      const modified = this.getModel().getOptions().some(function (option) {\n        return (!Object.prototype.hasOwnProperty.call(this._originalOptions, option.getKey()) ||\n          this._originalOptions[option.getKey()] !== option.getValue()\n        );\n      }, this);\n      this.setModified(modified);\n    },\n\n    _onDeleteOption: function (ev) {\n      const option = ev.getData();\n      const options = this.getModel().getOptions();\n      if (options.length === 1) {\n        // do not delete the last option, just reset its values\n        option.resetKey();\n        option.resetValue();\n      } else {\n        const removed = this.getModel().getOptions().remove(option);\n        if (removed) {\n          removed.removeListener('change', this.__checkForModification, this);\n        }\n      }\n      this.__checkForModification();\n    },\n\n    _onAddOption: function () {\n      const option = new cv.ui.manager.model.config.Option('', '');\n      option.addListener('change', this.__checkForModification, this);\n      this.getModel().getOptions().push(option);\n      this.__checkForModification();\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'section-title':\n           control = new qx.ui.basic.Label(this.tr('Section'));\n           this._add(control, {row: 0, column: 0});\n           break;\n\n         case 'name':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             required: true\n           });\n           this._add(control, {row: 0, column: 1});\n           break;\n\n         case 'delete':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n           control.setToolTipText(this.tr('Delete section'));\n           control.addListener('execute', function() {\n             this.fireDataEvent('delete', this.getModel());\n           }, this);\n           this._add(control, {row: 0, column: 2});\n           break;\n\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(null, control);\n           this._listController.setNullValueTitle('header');\n           this._listController.setAllowNull(true);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.OptionListItem();\n             },\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteOption, this);\n               item.addListener('add', this._onAddOption, this);\n             }.bind(this),\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n             }\n           });\n           this._add(control, {row: 1, column: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_listController');\n  }\n});\n","/**\n * QX version of the svg use icon way of displaying the KNF-UF icons.\n */\nqx.Class.define('cv.ui.manager.viewer.SvgIcon', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name) {\n    this.base(arguments);\n    if (name) {\n      this.setName(name);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    name: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyName'\n    },\n\n    appearance: {\n      refine: true,\n      init: 'cv-svg-icon'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __spriteUrl: null,\n    __useElement: null,\n\n    _applyName: function (value) {\n      if (value) {\n        if (!this.__spriteUrl) {\n          this.__spriteUrl = qx.util.ResourceManager.getInstance().toUri('icons/knx-uf-iconset.svg');\n        }\n        if (!this.__useElement.getDomElement()) {\n          this.__useElement.addListenerOnce('appear', function () {\n            this._applyName(value);\n          }, this);\n          return;\n        }\n        // qx.xml.Element.setAttributeNS(document, this.__useElement.getDomElement(), 'http://www.w3.org/1999/xlink', 'xlink:href', this.__spriteUrl + '#kuf-' + value);\n        this.__useElement.getDomElement().setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', this.__spriteUrl + '#kuf-' + value);\n      } else {\n        this.__useElement.removeAttribute('xlink:href');\n      }\n    },\n\n    // overridden\n    _createContentElement : function() {\n      const svgElem = new cv.svg.Element('svg');\n      this.__useElement = new cv.svg.Element('use');\n      svgElem.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n      svgElem.add(this.__useElement);\n      return svgElem;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__useElement = null;\n  }\n});\n","/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Fabian Jakobs (fjakobs)\n     * Sebastian Werner (wpbasti)\n\n************************************************************************ */\n\n/**\n * The image class displays an image file\n *\n * This class supports image clipping, which means that multiple images can be combined\n * into one large image and only the relevant part is shown.\n *\n * *Example*\n *\n * Here is a little example of how to use the widget.\n *\n * <pre class='javascript'>\n *   var image = new qx.ui.basic.Image(\"icon/32/actions/format-justify-left.png\");\n *\n *   this.getRoot().add(image);\n * </pre>\n *\n * This example create a widget to display the image\n * <code>icon/32/actions/format-justify-left.png</code>.\n *\n * *External Documentation*\n *\n * <a href='http://qooxdoo.org/docs/#desktop/widget/image.md' target='_blank'>\n * Documentation of this widget in the qooxdoo manual.</a>\n *\n * NOTE: Instances of this class must be disposed of after use\n *\n */\nqx.Class.define('cv.ui.manager.basic.Image',\n  {\n    extend : qx.ui.core.Widget,\n\n\n\n    /*\n    *****************************************************************************\n       CONSTRUCTOR\n    *****************************************************************************\n    */\n\n    /**\n     * @param source {String?null} The URL of the image to display.\n     */\n    construct : function(source) {\n      this.__contentElements = {};\n\n      this.base(arguments);\n\n      if (source) {\n        this.setSource(source);\n      }\n    },\n\n\n\n\n    /*\n    *****************************************************************************\n       PROPERTIES\n    *****************************************************************************\n    */\n\n    properties :\n      {\n        /** The URL of the image. Setting it will possibly abort loading of current image. */\n        source :\n          {\n            check : 'String',\n            init : null,\n            nullable : true,\n            event : 'changeSource',\n            apply : '_applySource',\n            themeable : true\n          },\n\n\n        /**\n         * Whether the image should be scaled to the given dimensions\n         *\n         * This is disabled by default because it prevents the usage\n         * of image clipping when enabled.\n         */\n        scale :\n          {\n            check : 'Boolean',\n            init : false,\n            event : 'changeScale',\n            themeable : true,\n            apply : '_applyScale'\n          },\n\n        /**\n         * Whether to preserve the image ratio (ie prevent distortion), and which dimension\n         * to prioritise\n         */\n        forceRatio : {\n          init : 'auto',\n          check : [ 'disabled', 'height', 'width', 'auto' ],\n          apply : '_applyDimension'\n        },\n\n        /**\n         * Whether to allow scaling the image up\n         */\n        allowScaleUp : {\n          init : false,\n          check : 'Boolean',\n          apply : '_applyDimension'\n        },\n\n        // overridden\n        appearance :\n          {\n            refine : true,\n            init : 'image'\n          },\n\n\n        // overridden\n        allowShrinkX :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowShrinkY :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowGrowX :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowGrowY :\n          {\n            refine : true,\n            init : false\n          }\n      },\n\n\n    /*\n    *****************************************************************************\n       EVENTS\n    *****************************************************************************\n    */\n\n    events :\n      {\n        /**\n         * Fired if the image source can not be loaded. This event can only be\n         * fired for the first loading of an unmanaged resource (external image).\n         */\n        loadingFailed : 'qx.event.type.Event',\n\n\n        /**\n         * Fired if the image has been loaded. This is even true for managed\n         * resources (images known by generator).\n         */\n        loaded : 'qx.event.type.Event',\n\n\n        /** Fired when the pending request has been aborted. */\n        aborted : 'qx.event.type.Event'\n      },\n\n\n    statics:\n      {\n        PLACEHOLDER_IMAGE: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'\n      },\n\n    /*\n    *****************************************************************************\n       MEMBERS\n    *****************************************************************************\n    */\n\n    members :\n      {\n        __width : null,\n        __height : null,\n        __mode : null,\n        __contentElements : null,\n        __currentContentElement : null,\n        __wrapper : null,\n        __requestId : 0,\n\n\n        // overridden\n        _onChangeTheme : function() {\n          this.base(arguments);\n          // restyle source (theme change might have changed the resolved url)\n          this._styleSource();\n        },\n\n        /*\n        ---------------------------------------------------------------------------\n          WIDGET API\n        ---------------------------------------------------------------------------\n        */\n\n        // overridden\n        getContentElement : function() {\n          return this.__getSuitableContentElement();\n        },\n\n\n        // overridden\n        _createContentElement : function() {\n          return this.__getSuitableContentElement();\n        },\n\n\n        // overridden\n        _getContentHint : function() {\n          return {\n            width : this.__width || 0,\n            height : this.__height || 0\n          };\n        },\n\n        // overridden\n        _applyDecorator : function(value, old) {\n          this.base(arguments, value, old);\n\n          let source = this.getSource();\n          source = qx.util.AliasManager.getInstance().resolve(source);\n          let el = this.getContentElement();\n          if (this.__wrapper) {\n            el = el.getChild(0);\n          }\n          this.__setSource(el, source);\n        },\n\n        // overridden\n        _applyTextColor : function(value) {\n          if (this.__getMode() === 'font') {\n            let el = this.getContentElement();\n            if (this.__wrapper) {\n              el = el.getChild(0);\n            }\n\n            if (value) {\n              el.setStyle('color', qx.theme.manager.Color.getInstance().resolve(value));\n            } else {\n              el.removeStyle('color');\n            }\n          }\n        },\n\n        // overridden\n        _applyPadding : function(value, old, name) {\n          this.base(arguments, value, old, name);\n\n          const element = this.getContentElement();\n          if (this.__wrapper) {\n            element.getChild(0).setStyles({\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          } else if (this.__getMode() === 'font') {\n            element.setStyles({\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          } else {\n            element.setPadding(\n              this.getPaddingLeft() || 0, this.getPaddingTop() || 0\n            );\n          }\n        },\n\n        renderLayout : function(left, top, width, height) {\n          this.base(arguments, left, top, width, height);\n\n          const element = this.getContentElement();\n          if (this.__wrapper) {\n            element.getChild(0).setStyles({\n              width: width - (this.getPaddingLeft() || 0) - (this.getPaddingRight() || 0),\n              height: height - (this.getPaddingTop() || 0) - (this.getPaddingBottom() || 0),\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          }\n        },\n\n\n\n\n        /*\n        ---------------------------------------------------------------------------\n          IMAGE API\n        ---------------------------------------------------------------------------\n        */\n\n        // property apply, overridden\n        _applyEnabled : function(value, old) {\n          this.base(arguments, value, old);\n\n          if (this.getSource()) {\n            this._styleSource();\n          }\n        },\n\n\n        // property apply\n        _applySource : function(value, old) {\n          // abort loading current image\n          if (old) {\n            if (qx.io.ImageLoader.isLoading(old)) {\n              qx.io.ImageLoader.abort(old);\n            }\n          }\n\n          this._styleSource();\n        },\n\n\n        // property apply\n        _applyScale : function(value) {\n          this._styleSource();\n        },\n\n\n        /**\n         * Remembers the mode to keep track which contentElement is currently in use.\n         * @param mode {String} internal mode (alphaScaled|scaled|nonScaled)\n         */\n        __setMode : function(mode) {\n          this.__mode = mode;\n        },\n\n\n        /**\n         * Returns the current mode if set. Otherwise checks the current source and\n         * the current scaling to determine the current mode.\n         *\n         * @return {String} current internal mode\n         */\n        __getMode : function() {\n          if (this.__mode === null) {\n            const source = this.getSource();\n\n            if (source && qx.lang.String.startsWith(source, '@')) {\n              this.__mode = 'font';\n            } else if (source && qx.lang.String.startsWith(source, '<svg')) {\n              this.__mode = 'svg';\n            } else {\n              let isPng = false;\n              if (source !== null) {\n                isPng = source.endsWith('.png');\n              }\n\n              if (this.getScale() && isPng && qx.core.Environment.get('css.alphaimageloaderneeded')) {\n                this.__mode = 'alphaScaled';\n              } else if (this.getScale()) {\n                this.__mode = 'scaled';\n              } else {\n                this.__mode = 'nonScaled';\n              }\n            }\n          }\n\n          return this.__mode;\n        },\n\n\n        /**\n         * Creates a contentElement suitable for the current mode\n         *\n         * @param mode {String} internal mode\n         * @return {qx.html.Image} suitable image content element\n         */\n        __createSuitableContentElement : function(mode) {\n          let scale;\n          let tagName;\n          let Clazz = qx.html.Image;\n\n          switch (mode) {\n            case 'svg':\n              Clazz = qx.html.Element;\n              tagName = 'div';\n              break;\n            case 'font':\n              Clazz = qx.html.Label;\n              scale = true;\n              tagName = 'div';\n              break;\n            case 'alphaScaled':\n              scale = true;\n              tagName = 'div';\n              break;\n            case 'nonScaled':\n              scale = false;\n              tagName = 'div';\n              break;\n            default:\n              scale = true;\n              tagName = 'img';\n              break;\n          }\n\n          const element = new (Clazz)(tagName);\n          element.connectWidget(this);\n          element.setStyles({\n            'overflowX': 'hidden',\n            'overflowY': 'hidden',\n            'boxSizing': 'border-box'\n          });\n\n          if (mode === 'font') {\n            element.setRich(true);\n          } else if (mode !== 'svg') {\n            element.setScale(scale);\n\n            if (qx.core.Environment.get('css.alphaimageloaderneeded')) {\n              const wrapper = this.__wrapper = new qx.html.Element('div');\n              element.connectWidget(this);\n              wrapper.setStyle('position', 'absolute');\n              wrapper.add(element);\n              return wrapper;\n            }\n          }\n\n          return element;\n        },\n\n\n        /**\n         * Returns a contentElement suitable for the current mode\n         *\n         * @return {qx.html.Image} suitable image contentElement\n         */\n        __getSuitableContentElement : function() {\n          if (this.$$disposed) {\n            return null;\n          }\n\n          const mode = this.__getMode();\n\n          if (!this.__contentElements[mode]) {\n            this.__contentElements[mode] = this.__createSuitableContentElement(mode);\n          }\n\n          const element = this.__contentElements[mode];\n\n          if (!this.__currentContentElement) {\n            this.__currentContentElement = element;\n          }\n\n          return element;\n        },\n\n\n        /**\n         * Applies the source to the clipped image instance or preload\n         * an image to detect sizes and apply it afterwards.\n         *\n         */\n        _styleSource : function() {\n          const AliasManager = qx.util.AliasManager.getInstance();\n          const ResourceManager = qx.util.ResourceManager.getInstance();\n\n          let source = AliasManager.resolve(this.getSource());\n\n          let element = this.getContentElement();\n          if (this.__wrapper) {\n            element = element.getChild(0);\n          }\n\n          if (!source) {\n            this.__resetSource(element);\n            return;\n          }\n\n          this.__checkForContentElementSwitch(source);\n\n          if ((qx.core.Environment.get('engine.name') == 'mshtml') &&\n            (parseInt(qx.core.Environment.get('engine.version'), 10) < 9 ||\n              qx.core.Environment.get('browser.documentmode') < 9)) {\n            const repeat = this.getScale() ? 'scale' : 'no-repeat';\n            element.tagNameHint = qx.bom.element.Decoration.getTagName(repeat, source);\n          }\n\n          const contentEl = this.__getContentElement();\n\n          // Detect if the image registry knows this image\n          if (ResourceManager.isFontUri(source)) {\n            this.__setManagedImage(contentEl, source);\n            const color = this.getTextColor();\n            if (qx.lang.Type.isString(color)) {\n              this._applyTextColor(color, null);\n            }\n          } else if (source && source.startsWith('<svg')) {\n            this.__setManagedImage(contentEl, source);\n          } else if (ResourceManager.has(source)) {\n            const highResolutionSource = ResourceManager.findHighResolutionSource(source);\n            if (highResolutionSource) {\n              const imageWidth = ResourceManager.getImageWidth(source);\n              const imageHeight = ResourceManager.getImageHeight(source);\n              this.setWidth(imageWidth);\n              this.setHeight(imageHeight);\n\n              // set background size on current element (div or img)\n              const backgroundSize = imageWidth + 'px, ' + imageHeight + 'px';\n              this.__currentContentElement.setStyle('background-size', backgroundSize);\n\n              this.setSource(highResolutionSource);\n              source = highResolutionSource;\n            }\n            this.__setManagedImage(contentEl, source);\n            this.__fireLoadEvent();\n          } else if (qx.io.ImageLoader.isLoaded(source)) {\n            this.__setUnmanagedImage(contentEl, source);\n            this.__fireLoadEvent();\n          } else {\n            this.__loadUnmanagedImage(contentEl, source);\n          }\n        },\n\n\n        /**\n         * Helper function, which fires <code>loaded</code> event asynchronously.\n         * It emulates native <code>loaded</code> event of an image object. This\n         * helper will be called, if you try to load a managed image or an\n         * previously loaded unmanaged image.\n         */\n        __fireLoadEvent : function() {\n          this.__requestId++;\n          qx.bom.AnimationFrame.request(function(rId) {\n            // prevent firing of the event if source changed in the meantime\n            if (rId === this.__requestId) {\n              this.fireEvent('loaded');\n            } else {\n              this.fireEvent('aborted');\n            }\n          }.bind(this, this.__requestId));\n        },\n\n\n        /**\n         * Returns the content element.\n         * @return {qx.html.Image} content element\n         */\n        __getContentElement : function() {\n          let contentEl = this.__currentContentElement;\n          if (this.__wrapper) {\n            contentEl = contentEl.getChild(0);\n          }\n\n          return contentEl;\n        },\n\n\n        /**\n         * Checks if the current content element is capable to display the image\n         * with the current settings (scaling, alpha PNG)\n         *\n         * @param source {String} source of the image\n         */\n        __checkForContentElementSwitch : qx.core.Environment.select('engine.name',\n          {\n            'mshtml' : function(source) {\n              const alphaImageLoader = qx.core.Environment.get('css.alphaimageloaderneeded');\n              const isPng = source.endsWith('.png');\n              const isFont = source.startsWith('@');\n              const isSvg = source.startsWith('<svg');\n\n              if (isFont) {\n                this.__setMode('font');\n              } else if (isSvg) {\n                this.__setMode('svg');\n              } else if (alphaImageLoader && isPng) {\n                if (this.getScale() && this.__getMode() != 'alphaScaled') {\n                  this.__setMode('alphaScaled');\n                } else if (!this.getScale() && this.__getMode() != 'nonScaled') {\n                  this.__setMode('nonScaled');\n                }\n              } else if (this.getScale() && this.__getMode() != 'scaled') {\n                  this.__setMode('scaled');\n                } else if (!this.getScale() && this.__getMode() != 'nonScaled') {\n                  this.__setMode('nonScaled');\n                }\n\n              this.__checkForContentElementReplacement(this.__getSuitableContentElement());\n            },\n\n            'default' : function(source) {\n              const isFont = source && qx.lang.String.startsWith(source, '@');\n              const isSvg = source.startsWith('<svg');\n\n              if (isFont) {\n                this.__setMode('font');\n              } else if (isSvg) {\n                this.__setMode('svg');\n              } else if (this.getScale() && this.__getMode() != 'scaled') {\n                this.__setMode('scaled');\n              } else if (!this.getScale() && this.__getMode() != 'nonScaled') {\n                this.__setMode('nonScaled');\n              }\n\n              this.__checkForContentElementReplacement(this.__getSuitableContentElement());\n            }\n          }),\n\n\n        /**\n         * Checks the current child and replaces it if necessary\n         *\n         * @param elementToAdd {qx.html.Image} content element to add\n         */\n        __checkForContentElementReplacement : function(elementToAdd) {\n          const currentContentElement = this.__currentContentElement;\n\n          if (currentContentElement !== elementToAdd) {\n            if (currentContentElement !== null) {\n              const pixel = 'px';\n              const styles = {};\n\n              //inherit styles from current element\n              const currentStyles = currentContentElement.getAllStyles();\n              if (currentStyles) {\n                for (let prop in currentStyles) {\n                  styles[prop] = currentStyles[prop];\n                }\n              }\n\n              // Don't transfer background image when switching from image to icon font\n              if (this.__getMode() === 'font' || this.__getMode() === 'svg') {\n                delete styles.backgroundImage;\n              }\n\n              // Copy dimension and location of the current content element\n              const bounds = this.getBounds();\n              if (bounds !== null) {\n                styles.width = bounds.width + pixel;\n                styles.height = bounds.height + pixel;\n              }\n\n              const insets = this.getInsets();\n              styles.left = parseInt(currentContentElement.getStyle('left') || insets.left) + pixel;\n              styles.top = parseInt(currentContentElement.getStyle('top') || insets.top) + pixel;\n\n              styles.zIndex = 10;\n\n              const newEl = this.__wrapper ? elementToAdd.getChild(0) : elementToAdd;\n              newEl.setStyles(styles, true);\n              newEl.setSelectable(this.getSelectable());\n\n              if (!currentContentElement.isVisible()) {\n                elementToAdd.hide();\n              } else if (!elementToAdd.isVisible()) {\n                elementToAdd.show();\n              }\n\n              if (!currentContentElement.isIncluded()) {\n                elementToAdd.exclude();\n              } else if (!elementToAdd.isIncluded()) {\n                elementToAdd.include();\n              }\n\n              const container = currentContentElement.getParent();\n\n              if (container) {\n                const index = container.getChildren().indexOf(currentContentElement);\n                container.removeAt(index);\n                container.addAt(elementToAdd, index);\n              }\n              // force re-application of source so __setSource is called again\n              const hint = newEl.getNodeName();\n              if (newEl.setSource) {\n                newEl.setSource(null);\n              } else if (newEl.setValue) {\n                newEl.setValue('');\n              } else {\n                newEl.removeAll();\n              }\n              const currentEl = this.__getContentElement();\n              newEl.tagNameHint = hint;\n              newEl.setAttribute('class', currentEl.getAttribute('class'));\n\n              // Flush elements to make sure the DOM elements are created.\n              qx.html.Element.flush();\n              const currentDomEl = currentEl.getDomElement();\n              const newDomEl = elementToAdd.getDomElement();\n\n              // copy event listeners\n              const listeners = currentContentElement.getListeners() || [];\n              listeners.forEach(function(listenerData) {\n                elementToAdd.addListener(listenerData.type, listenerData.handler, listenerData.self, listenerData.capture);\n              });\n\n              if (currentDomEl && newDomEl) {\n                // Switch the DOM elements' hash codes. This is required for the event\n                // layer to work [BUG #7447]\n                const currentHash = currentDomEl.$$hash;\n                currentDomEl.$$hash = newDomEl.$$hash;\n                newDomEl.$$hash = currentHash;\n              }\n\n              this.__currentContentElement = elementToAdd;\n            }\n          }\n        },\n\n\n        /**\n         * Use the ResourceManager to set a managed image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setManagedImage : function(el, source) {\n          const ResourceManager = qx.util.ResourceManager.getInstance();\n          const isFont = ResourceManager.isFontUri(source);\n          const isSvg = source.startsWith('<svg');\n\n          // Try to find a disabled image in registry\n          if (!this.getEnabled()) {\n            const disabled = source.replace(/\\.([a-z]+)$/, '-disabled.$1');\n            if (!isFont && ResourceManager.has(disabled)) {\n              source = disabled;\n              this.addState('replacement');\n            } else {\n              this.removeState('replacement');\n            }\n          }\n\n          // Optimize case for enabled changes when no disabled image was found\n          if (!isFont && !isSvg && el.getSource() === source) {\n            return;\n          }\n\n          // Special case for non resource manager handled font icons\n          if (isFont) {\n            // Don't use scale if size is set via postfix\n            if (this.getScale() && parseInt(source.split('/')[2], 10)) {\n              this.setScale(false);\n            }\n\n            // Adjust size if scaling is applied\n            let width;\n            let height;\n            if (this.getScale()) {\n              const hint = this.getSizeHint();\n              width = this.getWidth() || hint.width;\n              height = this.getHeight() || hint.height;\n            } else {\n              const font = qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]);\n              if (qx.core.Environment.get('qx.debug')) {\n                this.assertObject(font, 'Virtual image source contains unkown font descriptor');\n              }\n              const size = parseInt(source.split('/')[2] || font.getSize(), 10);\n              width = ResourceManager.getImageWidth(source) || size;\n              height = ResourceManager.getImageHeight(source) || size;\n            }\n\n            this.__updateContentHint(width, height);\n            this.__setSource(el, source);\n          } else if (isSvg) {\n            // Apply source\n            this.__setSource(el, source);\n\n            // Adjust size\n            this.__updateContentHint(40, 40);\n          } else {\n            // Apply source\n            this.__setSource(el, source);\n\n            // Compare with old sizes and relayout if necessary\n            this.__updateContentHint(\n              ResourceManager.getImageWidth(source),\n              ResourceManager.getImageHeight(source)\n            );\n          }\n        },\n\n        _applyDimension : function() {\n          this.base(arguments);\n\n          const isFont = this.getSource() && qx.lang.String.startsWith(this.getSource(), '@');\n          if (isFont) {\n            const el = this.getContentElement();\n            if (el) {\n              if (this.getScale()) {\n                const hint = this.getSizeHint();\n                const width = this.getWidth() || hint.width || 40;\n                const height = this.getHeight() || hint.height || 40;\n                el.setStyle('fontSize', (width > height ? height : width) + 'px');\n              } else {\n                const font = qx.theme.manager.Font.getInstance().resolve(this.getSource().match(/@([^/]+)/)[1]);\n                el.setStyle('fontSize', font.getSize() + 'px');\n              }\n            }\n          } else {\n            this.__updateContentHint();\n          }\n        },\n\n        /**\n         * Use the infos of the ImageLoader to set an unmanaged image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setUnmanagedImage : function(el, source) {\n          const ImageLoader = qx.io.ImageLoader;\n\n          // Apply source\n          this.__setSource(el, source);\n\n          // Compare with old sizes and relayout if necessary\n          const width = ImageLoader.getWidth(source);\n          const height = ImageLoader.getHeight(source);\n          this.__updateContentHint(width, height);\n        },\n\n\n        /**\n         * Use the ImageLoader to load an unmanaged image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __loadUnmanagedImage : function(el, source) {\n          const ImageLoader = qx.io.ImageLoader;\n\n          if (qx.core.Environment.get('qx.debug')) {\n            // loading external images via HTTP/HTTPS is a common usecase, as is\n            // using data URLs.\n            const sourceLC = source.toLowerCase();\n            if (!sourceLC.startsWith('http') &&\n              !sourceLC.startsWith('data:image/')) {\n              const self = this.self(arguments);\n\n              if (!self.__warned) {\n                self.__warned = {};\n              }\n\n              if (!self.__warned[source]) {\n                this.debug('try to load an unmanaged relative image: ' + source);\n                self.__warned[source] = true;\n              }\n            }\n          }\n\n          // only try to load the image if it not already failed\n          if (!ImageLoader.isFailed(source)) {\n            ImageLoader.load(source, this.__loaderCallback, this);\n          } else {\n            this.__resetSource(el);\n          }\n        },\n\n        /**\n         * Reset source displayed by the DOM element.\n         *\n         * @param el {Element} image DOM element\n         */\n        __resetSource : function(el) {\n          if (el !== null) {\n            if (el instanceof qx.html.Image) {\n              el.resetSource();\n            } else if (el instanceof qx.html.Label) {\n              el.resetValue();\n            } else {\n              el.removeAll();\n            }\n          }\n        },\n\n        /**\n         * Combines the decorator's image styles with our own image to make sure\n         * gradient and backgroundImage decorators work on Images.\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setSource: function (el, source) {\n          const isFont = source && qx.lang.String.startsWith(source, '@');\n          const isSvg = source && qx.lang.String.startsWith(source, '<svg');\n\n          if (isSvg) {\n            const child = new qx.html.Element('svg');\n            child.useMarkup(source);\n            el.removeAll();\n            el.add(child);\n          } else if (isFont) {\n            const sparts = source.split('/');\n            let fontSource = source;\n            if (sparts.length > 2) {\n              fontSource = sparts[0] + '/' + sparts[1];\n            }\n\n\n            const ResourceManager = qx.util.ResourceManager.getInstance();\n            const font = qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]);\n            const fontStyles = qx.lang.Object.clone(font.getStyles());\n            delete fontStyles.color;\n            el.setStyles(fontStyles);\n            el.setStyle('font');\n            el.setStyle('display', 'table-cell');\n            el.setStyle('verticalAlign', 'middle');\n            el.setStyle('textAlign', 'center');\n\n            if (this.getScale()) {\n              el.setStyle('fontSize', (this.__width > this.__height ? this.__height : this.__width) + 'px');\n            } else {\n              const size = parseInt(sparts[2] || qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]).getSize());\n              el.setStyle('fontSize', size + 'px');\n            }\n\n            const resource = ResourceManager.getData(fontSource);\n            if (resource) {\n              el.setValue(String.fromCharCode(resource[2]));\n            } else {\n              const charCode = parseInt(qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)\\/(.*)$/)[2]), 16);\n              if (qx.core.Environment.get('qx.debug')) {\n                this.assertNumber(charCode, 'Font source needs either a glyph name or the unicode number in hex');\n              }\n              el.setValue(String.fromCharCode(charCode));\n            }\n\n            return;\n          } else if (el.getNodeName() == 'div') {\n            // checks if a decorator already set.\n            // In this case we have to merge background styles\n            const decorator = qx.theme.manager.Decoration.getInstance().resolve(this.getDecorator());\n            if (decorator) {\n              const hasGradient = (decorator.getStartColor() && decorator.getEndColor());\n              const hasBackground = decorator.getBackgroundImage();\n              if (hasGradient || hasBackground) {\n                const repeat = this.getScale() ? 'scale' : 'no-repeat';\n\n                // get the style attributes for the given source\n                const attr = qx.bom.element.Decoration.getAttributes(source, repeat);\n                // get the background image(s) defined by the decorator\n                const decoratorStyle = decorator.getStyles(true);\n\n                const combinedStyles = {\n                  'backgroundImage': attr.style.backgroundImage,\n                  'backgroundPosition': (attr.style.backgroundPosition || '0 0'),\n                  'backgroundRepeat': (attr.style.backgroundRepeat || 'no-repeat')\n                };\n\n                if (hasBackground) {\n                  combinedStyles['backgroundPosition'] += ',' + decoratorStyle['background-position'] || '0 0';\n                  combinedStyles['backgroundRepeat'] += ', ' + decorator.getBackgroundRepeat();\n                }\n\n                if (hasGradient) {\n                  combinedStyles['backgroundPosition'] += ', 0 0';\n                  combinedStyles['backgroundRepeat'] += ', no-repeat';\n                }\n\n                combinedStyles['backgroundImage'] += ',' + (decoratorStyle['background-image'] || decoratorStyle['background']);\n\n                // apply combined background images\n                el.setStyles(combinedStyles);\n\n                return;\n              }\n            } else if (el.setSource) {\n              // force re-apply to remove old decorator styles\n              el.setSource(null);\n            }\n          }\n          if (el.setSource) {\n            el.setSource(source);\n          }\n        },\n\n        /**\n         * Event handler fired after the preloader has finished loading the icon\n         *\n         * @param source {String} Image source which was loaded\n         * @param imageInfo {Map} Dimensions of the loaded image\n         */\n        __loaderCallback : function(source, imageInfo) {\n          // Ignore the callback on already disposed images\n          if (this.$$disposed === true) {\n            return;\n          }\n\n          // Ignore when the source has already been modified\n          if (source !== qx.util.AliasManager.getInstance().resolve(this.getSource())) {\n            this.fireEvent('aborted');\n            return;\n          }\n\n          /// Output a warning if the image could not loaded and quit\n          if (imageInfo.failed) {\n            this.warn('Image could not be loaded: ' + source);\n            this.fireEvent('loadingFailed');\n          } else if (imageInfo.aborted) {\n            this.fireEvent('aborted');\n            return;\n          } else {\n            this.fireEvent('loaded');\n          }\n\n          // Update image\n          this.__setUnmanagedImage(this.__getContentElement(), source);\n        },\n\n\n        /**\n         * Updates the content hint when the image size has been changed\n         *\n         * @param width {Integer} width of the image\n         * @param height {Integer} height of the image\n         */\n        __updateContentHint : function(width, height) {\n          if (width === undefined) {\n            width = this.__width;\n          }\n          if (height === undefined) {\n            height = this.__height;\n          }\n          if (this._recalc(width, height)) {\n            qx.ui.core.queue.Layout.add(this);\n          }\n        },\n\n\n        /**\n         * Recalculates the size of the image, according to scaling parameters\n         * @param originalWidth\n         * @param originalHeight\n         */\n        _recalc: function(originalWidth, originalHeight) {\n          const maxWidth = this.getMaxWidth();\n          const maxHeight = this.getMaxHeight();\n          const minWidth = this.getMinWidth();\n          const minHeight = this.getMinHeight();\n\n          let width = originalWidth;\n          let height = originalHeight;\n\n          const ratio = originalHeight / originalWidth;\n\n          switch (this.getForceRatio()) {\n            case 'height':\n              if (maxHeight !== null && height > maxHeight) {\n                height = maxHeight;\n                width = height / ratio;\n              } else if (height < minHeight) {\n                height = minHeight;\n                width = height / ratio;\n              }\n              if (height < maxHeight && this.isAllowScaleUp()) {\n                height = maxHeight;\n                width = height / ratio;\n              }\n              break;\n\n            case 'width':\n              if (maxWidth !== null && width > maxWidth) {\n                width = maxWidth;\n                height = width * ratio;\n              } else if (width < minWidth) {\n                width = minWidth;\n                height = width * ratio;\n              }\n              if (width < maxWidth && this.isAllowScaleUp()) {\n                width = maxWidth;\n                height = width * ratio;\n              }\n              break;\n\n            case 'auto':\n            case 'bestfit':\n              if (maxWidth !== null && width > maxWidth) {\n                width = maxWidth;\n                height = width * ratio;\n              } else if (width < minWidth) {\n                width = minWidth;\n                height = width * ratio;\n              }\n              if (width < maxWidth && this.isAllowScaleUp()) {\n                width = maxWidth;\n                height = width * ratio;\n              }\n              if (maxHeight !== null && height > maxHeight) {\n                height = maxHeight;\n                width = height / ratio;\n              }\n              break;\n          }\n\n          width = Math.round(width);\n          height = Math.round(height);\n          if (width != this.__width || height != this.__height) {\n            this.__width = width;\n            this.__height = height;\n            return true;\n          }\n          return false;\n        }\n      },\n\n\n    /*\n    *****************************************************************************\n       DESTRUCTOR\n    *****************************************************************************\n    */\n\n    destruct : function() {\n      for (let mode in this.__contentElements) {\n        if (Object.prototype.hasOwnProperty.call(this.__contentElements, mode)) {\n          this.__contentElements[mode].disconnectWidget(this);\n        }\n      }\n\n      delete this.__currentContentElement;\n      if (this.__wrapper) {\n        delete this.__wrapper;\n      }\n\n      this._disposeMap('__contentElements');\n    }\n  });\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.SourceCodeField', {\n  extend : qx.ui.core.Widget,\n  implement : [\n    qx.ui.form.IStringForm,\n    qx.ui.form.IForm\n  ],\n  include : [\n    qx.ui.form.MForm\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (value, type) {\n    this.base(arguments);\n    this._init();\n\n    if (type) {\n      this.setType(type);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /** Fired when the value was modified */\n    'changeValue' : 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: 'String',\n      init: 'xml',\n      apply: '_applyType'\n    },\n    // overridden\n    focusable: {\n      refine : true,\n      init : true\n    },\n    autoSize: {\n      check: 'Boolean',\n      init: false,\n      apply: '_autoSize'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _editor: null,\n    __delayedValue: null,\n    __areaHeight: null,\n    _hasBeenEdited: false,\n\n    _applyType: function (value) {\n      if (value && this.__delayedValue) {\n        this.setValue(this.__delayedValue);\n        this.__delayedValue = null;\n      }\n    },\n\n    _autoSize: function () {\n      if (this._editor && this.isAutoSize()) {\n        const contentHeight = (this._editor.getModel().getLineCount() + 1) * 19;\n        this._setAreaHeight(contentHeight);\n      }\n    },\n\n    /**\n     * Sets the element's value.\n     *\n     * @param value {String|null} The new value of the element.\n     */\n    setValue: function(value) {\n      if (!this._hasBeenEdited) {\n        if (this._editor && this.getType()) {\n          this._editor.setValue(value);\n        } else {\n          this.__delayedValue = value;\n        }\n      }\n      this._autoSize();\n    },\n\n\n    /**\n     * Resets the element's value to its initial value.\n     */\n    resetValue : function() {\n      if (this._editor) {\n        this._editor.setValue('');\n      }\n    },\n\n\n    /**\n     * The element's user set value.\n     *\n     * @return {String|null} The value.\n     */\n    getValue : function() {\n      if (this._editor) {\n        return this._editor.getValue();\n      } else if (this.__delayedValue) {\n        return this.__delayedValue;\n      } \n        return '';\n    },\n\n    _init: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._init, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', () => {\n            this._init();\n          }, this);\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: false\n            },\n            theme: 'vs-dark'\n          });\n          if (this.getType()) {\n            const model = this._editor.getModel();\n            const uri = monaco.Uri.parse('cv://SourceCode.' + this.getType());\n            let newModel = window.monaco.editor.getModel(uri);\n            if (!newModel) {\n              newModel = window.monaco.editor.createModel(this.__delayedValue, this.getType(), uri);\n            } else {\n              newModel.setValue(this.__delayedValue);\n            }\n            if (model !== newModel) {\n              newModel.updateOptions({\n                tabSize: 2,\n                indentSize: 2,\n                insertSpaces: true\n              });\n              this._editor.setModel(newModel);\n            }\n          }\n          if (this.__delayedValue) {\n            this.__delayedValue = null;\n          }\n          this._editor.onDidChangeModelContent(this._onContentChange.bind(this));\n        }\n      }\n    },\n\n    _onContentChange: function () {\n      this._hasBeenEdited = true;\n      this.fireDataEvent('changeValue', this._editor.getValue());\n      this._autoSize();\n    },\n\n    // overridden\n    getFocusElement : function() {\n      const el = this.getContentElement();\n      if (el) {\n        return el;\n      }\n      return null;\n    },\n\n    _setAreaHeight: function(height) {\n      if (this.__areaHeight !== height) {\n        this.__areaHeight = height;\n        qx.ui.core.queue.Layout.add(this);\n        qx.ui.core.queue.Manager.flush();\n        if (this._editor) {\n          this._editor.layout();\n        }\n      }\n    },\n\n    // overridden\n    _getContentHint: function() {\n      const hint = this.base(arguments);\n\n      if (this.isAutoSize()) {\n        hint.height = this.__areaHeight || hint.height;\n      }\n\n      return hint;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._hasBeenEdited = false;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n  }\n});\n","/**\n * Option model for a VirtualComboBox / -SelectBox\n */\nqx.Class.define('cv.ui.manager.form.Option', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label, icon, value, hints) {\n    this.base(arguments);\n    if (label) {\n      this.setLabel(label);\n    }\n    if (icon) {\n      this.setIcon(icon);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n    if (hints) {\n      this.setHints(hints);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: ['default', 'group', 'state', 'error'],\n      init: 'default',\n      event: 'changeType'\n    },\n    label: {\n      check: 'String',\n      event: 'changeLabel'\n    },\n    icon: {\n      event: 'changeIcon',\n      nullable: true\n    },\n    value: {\n      check: 'String',\n      event: 'changeValue',\n      nullable: true\n    },\n    hints: {\n      check: 'Object',\n      nullable: true\n    }\n  }\n});\n","/**\n * ListItem that uses cv.ui.manager.basic.Image\n */\nqx.Class.define('cv.ui.manager.form.ListItem', {\n  extend: qx.ui.form.ListItem,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'icon':\n          control = new cv.ui.manager.basic.Image(this.getIcon());\n          control.setAnonymous(true);\n          this._addAt(control, 0);\n          if (this.getIcon() === null || this.getShow() === 'label') {\n            control.exclude();\n          }\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  }\n});\n","/**\n * qx.ui.form.VirtualSelectBox that uses cv.ui.manager.form.ListItem as 'atom' childcontrol.\n */\nqx.Class.define('cv.ui.manager.form.VirtualSelectBox', {\n  extend: qx.ui.form.VirtualSelectBox,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'atom':\n          control = new cv.ui.manager.form.ListItem('');\n          control.setCenter(false);\n          control.setAnonymous(true);\n\n          this._add(control, {flex:1});\n          break;\n      }\n\n      return control || this.base(arguments, id, hash);\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.CheckBox', {\n  extend: qx.ui.form.CheckBox,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _onExecute : function(e) {\n      if (this.isTriState()) {\n        // toggle between three states\n        if (this.getValue() === true) {\n          this.setValue(false);\n        } else if (this.getValue() === false) {\n          this.setValue(null);\n        } else {\n          this.setValue(true);\n        }\n      } else {\n        this.toggleValue();\n      }\n    },\n\n    _applyValue : function(value, old) {\n      this.base(arguments, value, old);\n      if (value === null) {\n        this.setLabel(' - ' + this.tr('not set') + ' - ');\n      } else {\n        this.setLabel('');\n      }\n    }\n  }\n});\n","/**\n * Special form renderer for editing XML-Config elements (allows special help texts for items)\n */\nqx.Class.define('cv.ui.manager.form.ElementFormRenderer', {\n  extend: qxl.dialog.FormRenderer,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    addItems: function(items, names, title) {\n      if (title !== null) {\n        this._add(\n          this._createHeader(title), {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          }\n        );\n        this._row++;\n      }\n      for (let i = 0; i < items.length; i++) {\n        let item = items[i];\n        let widget;\n        let label;\n        if (item instanceof qx.ui.form.RadioGroup) {\n          if (item.getUserData('orientation') === 'horizontal') {\n            widget = this._createHBoxForRadioGroup(item);\n          } else {\n            widget = this._createWidgetForRadioGroup(item);\n          }\n        } else {\n          widget = item;\n        }\n        if (names[i] && item.getUserData('excluded')) {\n          label = new qx.ui.basic.Label(names[i]);\n          label.setRich(true);\n          this._add(label, {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          });\n        } else if (!names[i]) {\n          this._add(widget, {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          });\n        } else {\n          label = this._createLabel(names[i], item);\n          label.setRich(true);\n          this._add(label, {\n            row: this._row,\n            column: 0\n          });\n          this._add(widget, {\n            row: this._row,\n            column: 1\n          });\n        }\n        this._row++;\n        if (item.getUserData('help')) {\n          label = new qx.ui.basic.Label(item.getUserData('help'));\n          label.setRich(true);\n          label.setAppearance('helptext');\n          this._add(label, {\n            row: this._row,\n            column: 1\n          });\n          this._row++;\n        }\n        this._add(new qx.ui.menu.Separator(), {\n          row: this._row,\n          column: 0,\n          colSpan: 2\n        });\n        this._row++;\n        if (i === 0) {\n          widget.focus();\n        }\n      }\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.schema.DocumentationMapping', {\n  type: 'static',\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    MAP: {\n      '_base': 'https://www.cometvisu.org/CometVisu/',\n      'audio': '/latest/manual/config/widgets/audio/index.html#audio',\n      'break': '/latest/manual/config/widgets/break/index.html#break',\n      'colorchooser': '/latest/manual/config/widgets/plugins/colorchooser/index.html#colorchooser',\n      'designtoggle': '/latest/manual/config/widgets/designtoggle/index.html#designtoggle',\n      'diagram': '/latest/manual/config/widgets/plugins/diagram/index.html#diagram',\n      'flavour': '/latest/manual/config/flavour.html#flavour',\n      'gauge': '/latest/manual/config/widgets/plugins/gauge/index.html#gauge',\n      'image': '/latest/manual/config/widgets/image/index.html#image',\n      'imagetrigger': '/latest/manual/config/widgets/imagetrigger/index.html#imagetrigger',\n      'include': '/latest/manual/config/widgets/include/index.html#include',\n      'info': '/latest/manual/config/widgets/info/index.html#info',\n      'infoaction': '/latest/manual/config/widgets/infoaction/index.html#infoaction',\n      'infotrigger': '/latest/manual/config/widgets/infotrigger/index.html#infotrigger',\n      'install-no-pakets': '/latest/manual/install/install-dev.html#install-no-pakets',\n      'line': '/latest/manual/config/widgets/line/index.html#line',\n      'mapping': '/latest/manual/config/mapping.html#mapping',\n      'multitrigger': '/latest/manual/config/widgets/multitrigger/index.html#multitrigger',\n      'page': '/latest/manual/config/widgets/page/index.html#page',\n      'pagejump': '/latest/manual/config/widgets/pagejump/index.html#pagejump',\n      'powerspectrum': '/latest/manual/config/widgets/plugins/powerspectrum/index.html#powerspectrum',\n      'pushbutton': '/latest/manual/config/widgets/pushbutton/index.html#pushbutton',\n      'refresh': '/latest/manual/config/widgets/refresh/index.html#refresh',\n      'reload': '/latest/manual/config/widgets/reload/index.html#reload',\n      'rgb': '/latest/manual/config/widgets/rgb/index.html#rgb',\n      'slide': '/latest/manual/config/widgets/slide/index.html#slide',\n      'speech': '/latest/manual/config/widgets/plugins/speech/index.html#speech',\n      'strftime': '/latest/manual/config/widgets/plugins/strftime/index.html#strftime',\n      'styling': '/latest/manual/config/styling.html#styling',\n      'switch': '/latest/manual/config/widgets/switch/index.html#switch',\n      'system-voraussetzungen': '/latest/manual/#system-voraussetzungen',\n      'text': '/latest/manual/config/widgets/text/index.html#text',\n      'toggle': '/latest/manual/config/widgets/toggle/index.html#toggle',\n      'trigger': '/latest/manual/config/widgets/trigger/index.html#trigger',\n      'urltrigger': '/latest/manual/config/widgets/urltrigger/index.html#urltrigger',\n      'video': '/latest/manual/config/widgets/video/index.html#video',\n      'visu-config-details': '/latest/manual/config/index.html#visu-config-details',\n      'web': '/latest/manual/config/widgets/web/index.html#web',\n      'widgets': '/latest/manual/config/widgets/index.html#widgets'\n    }\n  }\n});\n","/**\n * a single SimpleType from the schema.\n * Should be useable for SimpleContent, too.\n * Is usable for attributes, too.\n */\nqx.Class.define('cv.ui.manager.model.schema.SimpleType', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.__enumerations = [];\n    this.__pattern = [];\n    this.__regexCache = {};\n    this.__bases = [];\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'simpleType'\n    },\n    optional: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * the baseType of this element, which is one of the xsd-namespaced types (like 'string')\n     * @var string\n     */\n    baseType: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __pattern: null,\n    __enumerations: null,\n    __bases: null,\n    __regexCache: null,\n\n    parse: function () {\n      const node = this.getNode();\n      this.setOptional(node.getAttribute('use') === 'required');\n      this.__fillNodeData(node);\n    },\n\n    /**\n     * parse a node, find it's data (restrictions, extensions, bases ... whatever)\n     *\n     * @param   node    DOMNode the node to parse\n     */\n    __fillNodeData: function (node) {\n      const schema = this.getSchema();\n\n      if (node.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = node.getAttribute('ref');\n        node = schema.getReferencedNode('attribute', refName);\n\n        if (!node) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n      }\n\n      if (node.hasAttribute('type')) {\n        // hacked: allow this to be used for attributes\n        const baseType = node.getAttribute('type');\n\n        if (!baseType.match(/^xsd:/)) {\n          // if it's not an xsd-default-basetype, we need to find out what it is\n          const subnode = schema.getReferencedNode('simpleType', baseType);\n          this.__fillNodeData(subnode);\n        } else {\n          this.setBaseType(baseType);\n        }\n        // is this attribute optional?\n        this.setOptional(node.getAttribute('use') !== 'required');\n\n        return;\n      }\n\n      const subNodes = Array.from(node.querySelectorAll(':scope > restriction, :scope > extension, :scope > simpleType > restriction, :scope > simpleType > extension'));\n\n      subNodes.forEach(subNode => {\n        const baseType = subNode.getAttribute('base');\n\n        if (!baseType.match(/^xsd:/)) {\n          // don't dive in for default-types, they simply can not be found\n          const subnode = schema.getReferencedNode('simpleType', baseType);\n          this.__fillNodeData(subnode);\n        } else {\n          this.setBaseType(baseType);\n        }\n        Array.from(subNode.querySelectorAll(':scope > pattern')).forEach(patternNode => {\n          this.__pattern.push(patternNode.getAttribute('value'));\n        });\n\n        Array.from(subNode.querySelectorAll(':scope > enumeration')).forEach(enumerationNode => {\n          this.__enumerations.push(enumerationNode.getAttribute('value'));\n        });\n      });\n\n      if (!this.getBaseType()) {\n        this.setBaseType('xsd:anyType');\n      }\n      this.__bases.push(this.getBaseType());\n    },\n\n    /**\n     * check if a given value is valid for this type\n     *\n     * @param   value   mixed   the value to check\n     * @return  boolean         if the value is valid\n     */\n    isValueValid: function (value) {\n      const baseType = this.getBaseType();\n      const schema = this.getSchema();\n      if (!baseType) {\n        throw new Error('something is wrong, do not have a baseType for type');\n      }\n\n      if (value === '') {\n        // empty values are valid if this node is optional!\n        return this.isOptional();\n      }\n\n      if (baseType.search(/^xsd:/) === -1) {\n        // created our own type, will need to find and use it.\n        const typeNode = schema.getTypeNode('simple', baseType);\n        const subType = new cv.ui.manager.model.schema.SimpleType(typeNode, schema);\n        return subType.isValueValid(value);\n      } \n        // xsd:-namespaces types, those are the originals\n        switch (baseType) {\n          case 'xsd:string':\n          case 'xsd:anyURI':\n          case 'xsd:anyType':\n            if (!(typeof (value) == 'string')) {\n              // it's not a string, but it should be.\n              // pretty much any input a user gives us is string, so this is pretty much moot.\n              return false;\n            }\n            break;\n          case 'xsd:decimal':\n            if (!value.match(/^[-+]?[0-9]*(\\.[0-9]+)?$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:unsignedByte':\n          case 'xsd:nonNegativeInteger':\n            if (!value.match(/^[+]?[0-9]+$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:integer':\n            if (!value.match(/^[-+]?[0-9]+$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:float':\n            if (!value.match(/^[-+]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:boolean':\n            if (!value.match(/^(true|false|0|1)$/)) {\n              return false;\n            }\n            break;\n          default:\n            throw new Error('not implemented baseType ' + baseType);\n        }\n      \n\n      // check if the value is in our list of valid values, if there is such a list\n      if (this.__enumerations.length > 0) {\n        if (!this.__enumerations.includes(value)) {\n          return false;\n        }\n      }\n\n      // check if the value matches any given pattern\n      if (this.__pattern.length > 0) {\n        // start with assuming it's valid\n        let boolValid = true;\n\n        this.__pattern.forEach(item => {\n          if (!Object.prototype.hasOwnProperty.call(this.__regexCache, item)) {\n            // create a regex from the pattern; mind ^ an $ - XSD has them implicitly (XSD Datatypes, Appendix G)\n            // so for our purpose, we need to add them for every branch (that is not inside [])\n            const branchIndices = [];\n            let start = 0;\n            let i = item.indexOf('|', start);\n            while (i < item.length) {\n              if (i < 0) {\n                break;\n              }\n              // go backwards and look for an [ stop looking on ]\n              let isRootBranch = true;\n              for (let j = i; j >= start; j--) {\n                if (item[j] === ']') {\n                  break;\n                } else if (item[j] === '[') {\n                  isRootBranch = false;\n                }\n              }\n              if (isRootBranch) {\n                branchIndices.push([start, i - start]);\n              }\n              start = i + 1;\n              i = item.indexOf('|', start);\n              if (branchIndices.length > 100) {\n                this.error('too many branchIndices');\n                break;\n              }\n            }\n            if (item.length > start) {\n              // append the rest\n              branchIndices.push([start, item.length - start]);\n            }\n            const branches = branchIndices.map(entry => `^${item.substr(entry[0], entry[1]).replace(/\\\\([\\s\\S])|(\\$)/g, '\\\\$1$2')}$`);\n            this.__regexCache[item] = this.regexFromString(branches.join('|'));\n          }\n\n          if (this.__regexCache[item].test(value) === false) {\n            // regular expression did not match\n            // bad bad value!\n            boolValid = false;\n          }\n        }, this);\n\n        // if the value has been marked invalid by a regex, return invalid.\n        if (boolValid === false) {\n          return false;\n        }\n      }\n\n      // if no check said the value is invalid, then it is not invalid\n      return true;\n    },\n\n    /**\n     * get this elements enumeration (if there is any)\n     *\n     * @return  array   list of allowed values (if there are any)\n     */\n    getEnumeration: function () {\n      if (this.getBaseType() === 'xsd:boolean') {\n        // special handling for boolean, as we KNOW it to be an enumeration\n        return ['true', 'false'];\n      }\n\n      return this.__enumerations;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__regexCache = null;\n  }\n});\n","/**\n * a single choice.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Choice', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'choice'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const node = this.getNode();\n      const schema = this.getSchema();\n      const subElements = Array.from(node.querySelectorAll(':scope > element'));\n      subElements.forEach(elem => {\n        const subElement = new cv.ui.manager.model.schema.Element(elem, schema);\n        subElement.setSortable(true);\n        this._allowedElements[subElement.getName()] = subElement;\n      });\n      this._allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n\n      // choices\n      Array.from(node.querySelectorAll(':scope > choice')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      });\n\n      // sequences\n      Array.from(node.querySelectorAll(':scope > sequence')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n      });\n\n      // groups\n      Array.from(node.querySelectorAll(':scope > group')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Group(grouping, schema));\n      });\n    },\n\n    // overridden\n    getRequiredElements: function () {\n      // a choice has no defined required elements\n      // if you want required elements, use sequence or all\n      return [];\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // create list of allowed elements\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      const elementRegexes = [];\n      for (const element of Object.values(this._allowedElements)) {\n        elementRegexes.push(element.getRegex(separator, nocapture));\n      }\n\n      // also collect the regex for each and every grouping we might have\n      this._subGroupings.forEach(grouping => {\n        elementRegexes.push(grouping.getRegex(separator, nocapture));\n      });\n\n      regexString += elementRegexes.join('|');\n\n      regexString += ')';\n\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // as we are a choice, we can define the number of occurences for children of ANY level\n      if (this.isElementAllowed(childName) === true) {\n        return this.getBounds();\n      }\n\n      return undefined;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * For a choice, all elements have the same sorting, so they will all have the\n     * same sortnumber\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     *\n     * @param   sortnumber  integer the sortnumber of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortnumber) {\n      const namesWithSorting = {};\n\n      // all elements allowed directly\n      Object.keys(this._allowedElements).forEach(function (name) {\n        const item = this._allowedElements[name];\n        let mySortnumber = 'x'; // for a choice, sortnumber is always the same\n        if (sortnumber !== undefined) {\n          mySortnumber = sortnumber + '.' + mySortnumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortnumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortnumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n\n      // all elements allowed by subGroupings\n      this._subGroupings.forEach(function (item, i) {\n        let mySortnumber = 'x'; // for a choice, sortnumber is always the same\n        if (sortnumber !== undefined) {\n          mySortnumber = sortnumber + '.' + mySortnumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortnumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortnumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n      return namesWithSorting;\n    }\n  }\n});\n","/**\n * a single sequence.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Sequence', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'sequence'\n    },\n    elementsHaveOrder: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      // for a sequence, we need to keep the order of the elements\n      // so we have to use a 'mixed' approach in reading them\n      const subNodes = Array.from(this.getNode().children);\n\n      subNodes.forEach(subNode => {\n        let subObject;\n\n        switch (subNode.nodeName) {\n          case 'xsd:element':\n          case 'element':\n            subObject = new cv.ui.manager.model.schema.Element(subNode, schema);\n            // sequences' children are non-sortable\n            subObject.setSortable(false);\n            this._allowedElements[subObject.getName()] = subObject;\n            break;\n          case 'xsd:choice':\n          case 'choice':\n            subObject = new cv.ui.manager.model.schema.Choice(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:sequence':\n          case 'sequence':\n            subObject = new cv.ui.manager.model.schema.Sequence(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:group':\n          case 'group':\n            subObject = new cv.ui.manager.model.schema.Group(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:any':\n          case 'any':\n            subObject = new cv.ui.manager.model.schema.Any(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n        }\n\n        this._sortedContent.push(subObject);\n      });\n      this._allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // create list of allowed elements\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      const elementRegexes = [];\n\n      // this goes over ALL elements AND sub-groupings\n      this._sortedContent.forEach(element => {\n        elementRegexes.push(element.getRegex(separator, nocapture));\n      });\n\n      regexString += elementRegexes.join('');\n\n      regexString += ')';\n\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // we are a sequence-element; there is actually a lot of sayings ...\n      if (typeof this._allowedElements[childName] !== 'undefined') {\n        const elementBounds = this._allowedElements[childName].getBounds();\n        const sequenceBounds = this.getBounds();\n\n        const resultBounds = {\n          min: 1,\n          max: 1\n        };\n\n        // if it is bounded, we must duplicate element and sequence bounds\n        // (an element may appear as often as the number of sequences times the number of elements\n        // in each sequence - roughly)\n        if (Object.prototype.hasOwnProperty.call(elementBounds, 'min')) {\n          resultBounds.min = elementBounds.min;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'min') && !isNaN(sequenceBounds.min)) {\n          resultBounds.min *= sequenceBounds.min;\n        }\n\n        if (elementBounds.max === Number.POSITIVE_INFINITY || sequenceBounds.max === Number.POSITIVE_INFINITY) {\n          resultBounds.max = Number.POSITIVE_INFINITY;\n        } else {\n          if (Object.prototype.hasOwnProperty.call(elementBounds, 'max')) {\n            resultBounds.max = elementBounds.max;\n          }\n\n          if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'max') && !isNaN(sequenceBounds.max)) {\n            resultBounds.max *= sequenceBounds.max;\n          }\n        }\n\n        return resultBounds;\n      }\n\n      let childBounds;\n\n      let tmpBounds;\n\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        tmpBounds = this._subGroupings[i].getBoundsForElementName(childName);\n\n        if (undefined !== tmpBounds) {\n          // once we find the first set of bounds, we return that\n          childBounds = tmpBounds;\n          break;\n        }\n      }\n\n      return childBounds;\n    },\n\n    /**\n     * get the sorting of the allowed elements\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     * @param sortNumber  integer the sortNumber of a parent (only used when recursive)\n     * @return object     list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      const namesWithSorting = {};\n\n      this._sortedContent.forEach((item, i) => {\n        let mySortNumber = i;\n        if (sortNumber !== undefined) {\n          mySortNumber = sortNumber + '.' + i;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortNumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortNumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      });\n\n      return namesWithSorting;\n    }\n  }\n});\n","/**\n * a single group.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Group', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'group'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      let group = this.getNode();\n      if (group.hasAttribute('ref')) {\n        // if this is a reference, unravel it.\n        group = schema.getReferencedNode('group', group.getAttribute('ref'));\n      }\n\n      // we are allowed choice and sequence, but only ONE AT ALL is allowed\n      let grouping = group.querySelector(':scope > choice');\n      if (grouping) {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      } else {\n        grouping = group.querySelector(':scope > sequence');\n        if (grouping) {\n          this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n        }\n      }\n    },\n\n    /**\n     * get the elements allowed for this group\n     *\n     * @return  object      list of allowed elements, key is the name\n     */\n    getAllowedElements: function () {\n      // we have non of ourselves, so we return what the child says\n      return this._subGroupings[0].getAllowedElements();\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * For a group, all elements have the same sorting, so they will all have the\n     * same sort number\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     *\n     * @param   sortNumber  integer the sort number of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      const namesWithSorting = {};\n      const allowedElements = this.getAllowedElements();\n      Object.keys(allowedElements).forEach(name => {\n        const item = allowedElements[name];\n        let mySortNumber = 'x'; // for a group, sortNumber is always the same\n        if (sortNumber !== undefined) {\n          mySortNumber = sortNumber + '.' + mySortNumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortNumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortNumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n      return namesWithSorting;\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // collect the regex for each and every grouping we might have;\n      // 'each and every' means 'the only ONE'\n      this._subGroupings.forEach(grouping => {\n        regexString = '(';\n        if (nocapture) {\n regexString += '?:'; \n}\n        regexString += grouping.getRegex(separator, nocapture) + ')';\n      });\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // we are a group. we have no saying of ourselves\n      // (@FIXME: by definition we do, but we do not take that into account)\n      return this._subGroupings[0].getBoundsForElementName(childName);\n    }\n  }\n});\n","/**\n * any content.\n */\nqx.Class.define('cv.ui.manager.model.schema.Any', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'any'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      let group = this.getNode();\n      if (group.hasAttribute('ref')) {\n        // if this is a reference, unravel it.\n        group = schema.getReferencedNode('group', group.getAttribute('ref'));\n      }\n      // we are allowed choice and sequence, but only ONE AT ALL is allowed\n      group.querySelectorAll(':scope > choice').forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      });\n\n      // sequences\n      group.querySelectorAll(':scope > sequence').forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n      });\n\n      // there may be only one, so we simply us the first we found\n      if (this._subGroupings.length > 0) {\n        this._subGroupings = [this._subGroupings[0]];\n      }\n    },\n\n    // overridden\n    isElementAllowed: function (element) {\n      return true;\n    },\n\n    // overridden\n    getSchemaElementForElementName: function (elementName) {\n      // can not find any reason why elementName is allowed with us...\n      return undefined;\n    },\n\n    // overridden\n    getRequiredElements: function () {\n      return [];\n    },\n\n    // overridden\n    getAllowedElements: function() {\n      return {};\n    },\n\n    getRegex: function (separator, nocapture) {\n      return '.*';\n    },\n\n    hasMultiLevelBounds: function () {\n      return true;\n    },\n\n    getBoundsForElementName: function (childName) {\n      return this._bounds;\n    }\n  }\n});\n","/**\n * a single attribute from the schema.\n */\nqx.Class.define('cv.ui.manager.model.schema.Attribute', {\n  extend: cv.ui.manager.model.schema.Base,\n  include: cv.ui.manager.model.schema.MAnnotation,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Get the name of a schema-node\n     * @param e object  element to find the name of\n     * @param schema\n     * @return  string          name of the element\n     * @throws  if the name can not be found\n     */\n    getAttributeName: function(e, schema) {\n      if (e.hasAttribute('name')) {\n        return e.getAttribute('name');\n      }\n\n      if (e.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = e.getAttribute('ref');\n        const ref = schema.getReferencedNode('attribute', refName);\n\n        if (!ref) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n\n        return ref.getAttribute('name');\n      }\n\n      return 'unknown';\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'attribute'\n    },\n    name: {\n      check: 'String',\n      init: ''\n    },\n    optional: {\n      check: 'Boolean',\n      init: false\n    },\n    defaultValue: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _type: null,\n\n    parse: function () {\n      const node = this.getNode();\n      const schema = this.getSchema();\n      /**\n       * we have our own type\n       * @var object  SchemaSimpleType of the attribute, for validating purposes\n       */\n      this._type = new cv.ui.manager.model.schema.SimpleType(node, schema);\n      this.setName(cv.ui.manager.model.schema.Attribute.getAttributeName(node, schema));\n      if (node.hasAttribute('default')) {\n        this.setDefaultValue(node.getAttribute('default'));\n      }\n      this.setOptional(node.getAttribute('use') !== 'required');\n    },\n\n    /**\n     * check if a given value is valid for this attribute\n     *\n     * @param   value   mixed   the value to check\n     * @return  boolean         if the value is valid\n     */\n    isValueValid: function (value) {\n      if (value === null || value === undefined) {\n        value = '';\n      } else {\n        value = '' + value;\n      }\n      if (value === '') {\n        // empty values are valid if this node is optional!\n        return this.isOptional();\n      }\n      return this._type.isValueValid(value);\n    },\n\n    /**\n     * get a simple string telling us, what type of content is allowed\n     *\n     * @return  string  description of allowed values, almost user-readable :)\n     */\n    getTypeString: function () {\n      const description = this._type.getBaseType();\n\n      if (description.match(/xsd\\:/)) {\n        return description.replace(/xsd\\:/, '');\n      }\n\n      return this.tr('complex type, please see documentation');\n    },\n\n    /**\n     * get the list of values that are valid for this attribute, if it is an enumeration\n     *\n     * @return  array   list of string of valid values\n     */\n    getEnumeration: function () {\n      return this._type.getEnumeration();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__appInfoCache = null;\n    this.__documentationCache = null;\n  }\n});\n","/**\n * Simple config entry.\n */\nqx.Class.define('cv.ui.manager.model.config.Option', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (key, value) {\n    this.base(arguments);\n    this.setKey(key);\n    this.setValue(value);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    // sent whenever the options key or value has been changed\n    'change': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    key: {\n      check: 'String',\n      init: '',\n      event: 'changeKey',\n      apply: '_applyChange'\n    },\n\n    value: {\n      check: 'String',\n      init: '',\n      event: 'changeValue',\n      apply: '_applyChange'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyChange: function () {\n      this.fireEvent('change');\n    }\n  }\n});\n","/**\n * This widgets shows and editable config option in a list.\n */\nqx.Class.define('cv.ui.manager.form.OptionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox(8));\n    this._createChildControl('key');\n    this._createChildControl('value');\n    this._createChildControl('key-title');\n    this._createChildControl('value-title');\n    this._createChildControl('delete');\n    this._createChildControl('add');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-option'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.config.Option',\n      nullable: true,\n      apply: '_applyModel'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'delete': 'qx.event.type.Data',\n    'add': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // list controller with allowNull calls setLabel\n    setLabel: function (label) {\n\n    },\n\n    // list controller with allowNull calls setIcon\n    setIcon: function () {},\n\n    _applyModel: function (value, old) {\n      const keyField = this.getChildControl('key');\n      const valueField = this.getChildControl('value');\n      const keyTitleField = this.getChildControl('key-title');\n      const valueTitleField = this.getChildControl('value-title');\n      this.__unbindModel(old);\n      if (value) {\n        // bi-directional bind\n        value.bind('key', keyField, 'value');\n        value.bind('value', valueField, 'value');\n        keyField.bind('value', value, 'key');\n        valueField.bind('value', value, 'value');\n        keyField.show();\n        valueField.show();\n        keyTitleField.exclude();\n        valueTitleField.exclude();\n        this.getChildControl('delete').show();\n        this.getChildControl('add').show();\n      } else {\n        keyField.exclude();\n        valueField.exclude();\n        keyTitleField.show();\n        valueTitleField.show();\n        this.getChildControl('delete').hide();\n        this.getChildControl('add').hide();\n      }\n    },\n\n    __unbindModel: function (model) {\n      if (model) {\n        const keyField = this.getChildControl('key');\n        const valueField = this.getChildControl('value');\n        if (model) {\n          model.removeRelatedBindings(keyField);\n          model.removeRelatedBindings(valueField);\n          keyField.removeRelatedBindings(model);\n          valueField.removeRelatedBindings(model);\n        }\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'key':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             required: true\n           });\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'value':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true\n           });\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'delete':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n           control.setToolTipText(this.tr('Delete option'));\n           control.addListener('execute', function() {\n             this.fireDataEvent('delete', this.getModel());\n           }, this);\n           this._add(control);\n           break;\n\n         case 'add':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('add', 18));\n           control.setToolTipText(this.tr('Add option'));\n           control.addListener('execute', function() {\n             this.fireEvent('add');\n           }, this);\n           this._add(control);\n           break;\n\n         case 'key-title':\n           control = new qx.ui.basic.Label(this.tr('Key'));\n           control.exclude();\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'value-title':\n           control = new qx.ui.basic.Label(this.tr('Value'));\n           control.exclude();\n           this._add(control, {width: '40%'});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__unbindModel(this.getModel());\n  }\n});\n","/**\n * Wrapper for cometvisu icons to make the usable as Qx-Widget.\n */\nqx.Class.define('cv.ui.manager.basic.Icon', {\n  extend: qx.ui.core.Widget\n\n});\n"]}