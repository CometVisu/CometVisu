qx.$$packageData['4']={"resources":{"plugins/upnpcontroller/mute.php":"cv","plugins/upnpcontroller/next.php":"cv","plugins/upnpcontroller/pause.php":"cv","plugins/upnpcontroller/play.php":"cv","plugins/upnpcontroller/playlists.php":"cv","plugins/upnpcontroller/prev.php":"cv","plugins/upnpcontroller/status.php":"cv","plugins/upnpcontroller/upnpcontroller.css":"cv","plugins/upnpcontroller/upnpctrl_util.php":"cv","plugins/upnpcontroller/volume.php":"cv"}};
qx.Part.$$notifyLoad("4", function() {
(function(){var a="</div>",b="application/json",c="_prev' class='actor switchUnpressed center'><div class='value'>prev</div></div>",d="_volume' class='actor center switchInvisible' style='text-align: center;'><div class='value'>20</div></div>",f='volume',g='_album div.value',h="_getplaylists' class='actor switchUnpressed center'><div class='value'>play lists</div></div></div>",j="traceFlag",k="volume          : ",l='_getplaylists',m="_playlistsresult'><div class='value'></div></div></div>",n='unpressed',o='plugins/upnpcontroller/upnpcontroller.css',p='play',q=':',r="<div id='",s='pause',t="'>",u="playerIp",v='Play',w='true',x='#',y="Number",z="secondsProcessed: ",A="click callvolumedown",B="tap",C="url: ",D="_time' class='upnplabelgroup'><div class='upnplabel'></div><div class='value'>-</div></div>",E="_volumedown' class='actor center switchUnpressed'><div class='value'>-</div></div>",F="_title' class='upnplabelgroup'><div class='upnplabel'>Title</div><div class='value'>-</div></div>",G="_progress'  max='100' value='0'></progress></div>",H='value',I="_muteButton' class='actor switchUnpressed center'><div class='value'>-</div></div></div>",J="title           : ",K="playerPort  : ",L='next',M="currentValue: ",N='_muteButton',O="calculateSongProcessed",P="success",Q="plugins/upnpcontroller/",R="click callgetplaylists",S=' of ',T="&port=",U="<div>",V="_playButton",W="plugins/upnpcontroller/selectplaylist.php?player_ip_addr=",X='_volume div.value',Y="_muteButton",cs="upnpcontroller",ct='_playlistsresult div.value',cu='_playButton div.value',co="click prev",cp='prev',cq="click play",cr="Boolean",cA="</a></br>",cB="<div class=\"actor\"><div class=\"upnpcontroller\" id=\"",cC="debug     : ",cD="click mute",cw="GET",cx='switchUnpressed',cy="name: ",cz='status',cH="upnpcontroller_",di='_progress',dD="secondsTotal    : ",cI="playerPort: ",cE="reltime         : ",cF="click callvolumeup",dz='switchPressed',cG="<div style='float: left;'><div id='",cJ="<div style='float: left;'><progress id='",cK='_artist div.value',cL='cv.plugins.UpnpController',cP="_volumeup' class='actor center switchUnpressed'><div class='value'>+</div></div></div>",cQ="durationResponse: ",cR="&listurl=",cM='string',cN="\">",dy='pressed',cO='_time div.value',cV="_album' class='upnplabelgroup'><div class='upnplabel'>Album</div><div class='value'>-</div></div>",cW="playerPort",cX='playlists',cY="totalMatches: ",cS="_volumedown",cT="_artist' class='upnplabelgroup'><div class='upnplabel'>Artist</div><div class='value'>-</div></div>",dA="true",cU='',dd="_next' class='actor switchUnpressed center'><div class='value'>next</div></div></div>",de="current playValue: ",dC="_next",df="interval",da="playerIp  : ",db="click next",dB="value",dc="data: ",dg='_title div.value',dh="String",dt='_muteButton div.value',ds="_getplaylists",dr="",dx="song_process_rel: ",dw="_prev",dv="current muteValue: ",du=".php",dm='mute',dl='div.value',dk="_volumeup",dj="_playButton' class='actor switchUnpressed center'><div class='value'>-</div></div>",dq='_playButton',dp="<a href='",dn="currentVolume: ";qx.Class.define(cL,{extend:cv.ui.structure.AbstractWidget,include:[cv.ui.common.Refresh],statics:{parse:function(dE,dI,dG,dF){var dH=cv.parser.WidgetParser.parseElement(this,dE,dI,dG,dF,this.getAttributeToPropertyMappings());cv.parser.WidgetParser.parseRefresh(dE,dI);return dH;},getAttributeToPropertyMappings:function(){return {'debug':{target:j,transform:function(dJ){return dJ===dA;}},'label':{},'player_ip_addr':{target:u},'player_port':{target:cW,transform:function(dK){return dK?parseInt(dK):1440;}}};},uniqid:function(){var dL=new Date();return dL.getTime();}},properties:{traceFlag:{check:cr,init:false},playerIp:{check:dh,nullable:true},playerPort:{check:y,init:1440}},members:{upnpcontroller_uid:null,upnpcontroller_song_process_rel:null,_getInnerDomString:function(){var dO=cH+this.self(arguments).uniqid();this.upnpcontroller_uid=dO;var dM=cB+dO+cN;var dN=U;dN+=r+dO+F;dN+=r+dO+cT;dN+=r+dO+cV;dN+=r+dO+D;dN+=cJ+dO+G;dN+=cG+dO+E+r+dO+d+r+dO+cP;dN+=cG+dO+dj+r+dO+I;dN+=cG+dO+c+r+dO+dd;dN+=cG+dO+h;dN+=cG+dO+m;dN+=a;return dM+dN;},_onDomReady:function(){cv.ui.structure.AbstractWidget.prototype._onDomReady.call(this);this.refreshUpnpcontroller();},initListeners:function(){var dP=qx.event.Registration;dP.addListener(document.querySelector(x+this.upnpcontroller_uid+Y),B,this.toggleMute,this);dP.addListener(document.querySelector(x+this.upnpcontroller_uid+V),B,this.togglePlay,this);dP.addListener(document.querySelector(x+this.upnpcontroller_uid+dC),B,this.callNext,this);dP.addListener(document.querySelector(x+this.upnpcontroller_uid+dw),B,this.callPrev,this);dP.addListener(document.querySelector(x+this.upnpcontroller_uid+cS),B,this.callvolumedown,this);dP.addListener(document.querySelector(x+this.upnpcontroller_uid+dk),B,this.callvolumeup,this);dP.addListener(document.querySelector(x+this.upnpcontroller_uid+ds),B,this.callgetplaylists,this);},_setupRefreshAction:function(){if(this.getRefresh()&&this.getRefresh()>0){this._timer=new qx.event.Timer(this.getRefresh());this._timer.addListener(df,function(){this.refreshUpnpcontroller();},this);this._timer.start();};},refreshUpnpcontroller:function(){var dR=this.getPlayerIp();var dQ=this.getPlayerPort();this.traceLog(cC+this.isTraceFlag());this.traceLog(da+dR);this.traceLog(cI+dQ);this.__tP(cz,{},function(dS){var dT=dS.getTarget().getResponse();try{if(typeof dT===cM){dT=JSON.parse(dT);};this.traceLog(k+dT.volume);this.traceLog(cE+dT.reltimeResponse);this.traceLog(cQ+dT.durationResponse);this.traceLog(J+dT.title);this.__tO(dT.volume,dT.muteState,dT.transportState,dT.title,dT.reltimeResponse,dT.durationResponse,dT.artist,dT.album);}catch(e){this.error(e);};});},__tO:function(ea,dX,dV,dW,dY,eb,ec,dU){var ed=this.upnpcontroller_uid;if(dX===0){document.querySelector(x+ed+N).classList.replace(dz,cx);}else {document.querySelector(x+ed+N).classList.replace(cx,dz);};if(dV===v){document.querySelector(x+ed+dq).classList.replace(dz,cx);}else {document.querySelector(x+ed+dq).classList.replace(cx,dz);};document.querySelector(x+ed+dt).innerText=dX;document.querySelector(x+ed+cu).innerText=dV;document.querySelector(x+ed+X).innerText=ea;document.querySelector(x+ed+dg).innerText=dW;document.querySelector(x+ed+cK).innerText=ec;document.querySelector(x+ed+g).innerText=dU;document.querySelector(x+ed+cO).innerText=dY+S+eb;this.upnpcontroller_song_process_rel=this.calculateSongProcessed(dY,eb);this.traceLog(dx+this.upnpcontroller_song_process_rel);document.querySelector(x+ed+di).setAttribute(dB,this.upnpcontroller_song_process_rel);},__tP:function(eg,eh,ee){var ef=new qx.io.request.Xhr(qx.util.ResourceManager.getInstance().toUri(Q+eg+du));if(!eh){eh={};};eh=Object.assign(eh,{player_ip_addr:this.getPlayerIp(),port:this.getPlayerPort()});ef.set({requestData:eh,accept:b,method:cw});ef.addListener(P,ee,this);ef.send();},calculateSongProcessed:function(en,el){if(en===undefined||el===undefined){return;};this.traceLog(O);var ek=el.split(q);var em=Number(ek[2])+Number(ek[1])*60+Number(ek[0])*60*60;var ej=en.split(q);var ei=Number(ej[2])+Number(ej[1])*60+Number(ej[0])*60*60;this.traceLog(dD+em);this.traceLog(z+ei);return Math.floor(ei*100/em);},callgetplaylists:function(){this.traceLog(R);var ep=document.querySelector(x+this.upnpcontroller_uid+l);var er=ep.getAttribute(H);var eq=this.getPlayerIp();var eo=this.getPlayerPort();this.traceLog(M+er);this.traceLog(K+eo);this.__tP(cX,{},function(et){var es=et.getTarget().getResponse();try{if(typeof es===cM){es=JSON.parse(es);};}catch(e){this.error(e);return;};var eu=cU;this.traceLog(cY+es.totalMatches);for(var i=0;i<es.playLists.length;i++ ){eu+=dp+W+eq+cR+es.playLists[i].urlenc+T+eo+t+es.playLists[i].name+cA;if(this.isTraceFlag()===w){this.debug(cy+es.playLists[i].name);this.debug(C+es.playLists[i].url);};};if(er!==dy){document.querySelector(x+this.upnpcontroller_uid+ct).innerHTML=eu;eu.setAttribute(H,dy);eu.classList.replace(cx,dz);}else {document.querySelector(x+this.upnpcontroller_uid+ct).innerText=dr;eu.setAttribute(H,n);eu.classList.replace(cx,dz);};});},callvolumedown:function(){this.traceLog(A);var ew=document.querySelector(x+this.upnpcontroller_uid+X).innerText;this.traceLog(dn+ew);var ex=Number(ew)-5;this.__tP(f,{volume:ex},function(ey){this.traceLog(dc+ey);});},callvolumeup:function(){this.traceLog(cF);var ez=document.querySelector(x+this.upnpcontroller_uid+X).innerText;this.traceLog(dn+ez);var eA=Number(ez)+5;this.__tP(f,{volume:eA},function(eB){this.traceLog(dc+eB);});},callNext:function(){this.traceLog(db);this.__tP(L,{},function(eC){this.traceLog(dc+eC);});},callPrev:function(){this.traceLog(co);this.__tP(cp,{},function(eD){this.traceLog(dc+eD);});},toggleMute:function(){this.traceLog(cD);var eF=document.querySelector(x+this.upnpcontroller_uid+N);var eE=eF.querySelector(dl).innerText;this.traceLog(dv+eE);if(eE===0){eE=1;eF.classList.replace(cx,dz);}else {eE=0;eF.classList.replace(dz,cx);};this.__tP(dm,{mute:eE},function(eG){this.traceLog(dc+eG);});this.refreshUpnpcontroller();},togglePlay:function(){this.traceLog(cq);var eH=document.querySelector(x+this.upnpcontroller_uid+cu).innerText;var eI;this.traceLog(de+eH);var eJ=document.querySelector(x+this.upnpcontroller_uid+dq);if(eH===v){eI=s;eJ.classList.replace(cx,dz);}else {eI=p;eJ.classList.replace(dz,cx);};this.__tP(eI,{},function(eK){this.traceLog(dc+eK.getTarget().getResponse());});this.refreshUpnpcontroller();},traceLog:function(eL){if(this.isTraceFlag()){this.debug(eL);};}},defer:function(eM){var eN=cv.util.ScriptLoader.getInstance();eN.addStyles(o);cv.parser.WidgetParser.addHandler(cs,cv.plugins.UpnpController);cv.ui.structure.WidgetFactory.registerClass(cs,eM);}});})();
});