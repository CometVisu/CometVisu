{
  "version": 3,
  "sources": [
    "/home/travis/build/CometVisu/CometVisu/source/class/cv/TemplateEngine.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "pagePartsHandler",
    "cv",
    "ui",
    "PagePartsHandler",
    "__partQueue",
    "data",
    "Array",
    "_domFinishedQueue",
    "addListener",
    "ev",
    "setPartsLoaded",
    "getData",
    "defaults",
    "widget",
    "plugin",
    "group",
    "command",
    "Group",
    "setCommands",
    "app",
    "Init",
    "getApplication",
    "manager",
    "getCommandManager",
    "add",
    "setActive",
    "properties",
    "partsLoaded",
    "check",
    "init",
    "apply",
    "event",
    "scriptsLoaded",
    "ready",
    "currentPage",
    "nullable",
    "domFinished",
    "commands",
    "members",
    "bindClickToWidget",
    "main_scroll",
    "old_scroll",
    "visu",
    "pluginsToLoadCount",
    "xml",
    "lazyPlugins",
    "loadParts",
    "parts",
    "isArray",
    "loadLazyParts",
    "filter",
    "part",
    "indexOf",
    "length",
    "p",
    "includes",
    "append",
    "io",
    "PartLoader",
    "require",
    "states",
    "forEach",
    "idx",
    "remove",
    "debug",
    "startsWith",
    "setStructureLoaded",
    "error",
    "_applyReady",
    "value",
    "setupPage",
    "_applyLoaded",
    "old",
    "name",
    "isPartsLoaded",
    "isScriptsLoaded",
    "setReady",
    "_applyDomFinished",
    "message",
    "Bus",
    "dispatchByName",
    "entry",
    "callback",
    "shift",
    "context",
    "executeWhenDomFinished",
    "isDomFinished",
    "push",
    "prototype",
    "slice",
    "call",
    "arguments",
    "addAddress",
    "address",
    "id",
    "warn",
    "Model",
    "getInstance",
    "getAddresses",
    "initBackendClient",
    "backendName",
    "Config",
    "configSettings",
    "backend",
    "Application",
    "createClient",
    "backendUrl",
    "model",
    "update",
    "bind",
    "reporting",
    "recordInstance",
    "report",
    "Record",
    "record",
    "d",
    "BACKEND",
    "showError",
    "_handleClientError",
    "user",
    "topic",
    "title",
    "locale",
    "Manager",
    "tr",
    "severity",
    "unique",
    "deletable",
    "condition",
    "lastError",
    "getLastError",
    "Date",
    "now",
    "time",
    "url",
    "code",
    "text",
    "notifications",
    "Router",
    "dispatchMessage",
    "errorCode",
    "varargs",
    "notification",
    "Client",
    "ERROR_CODES",
    "PROTOCOL_MISSING_VERSION",
    "JSON",
    "stringify",
    "PROTOCOL_INVALID_READ_RESPONSE_MISSING_I",
    "resetPageValues",
    "resetCurrentPage",
    "layout",
    "currentPageUnavailableWidth",
    "currentPageUnavailableHeight",
    "currentPageNavbarVisibility",
    "parseXML",
    "loaded_xml",
    "done",
    "settings",
    "pagesNode",
    "querySelector",
    "predefinedDesign",
    "getAttribute",
    "clientDesign",
    "selectDesign",
    "getStructure",
    "scrollSpeed",
    "parseInt",
    "defaultColumns",
    "minColumnWidth",
    "screensave_time",
    "screensave_page",
    "maxMobileScreenWidth",
    "globalClass",
    "document",
    "classList",
    "scriptsToLoad",
    "stylesToLoad",
    "design",
    "getDesign",
    "baseUri",
    "mobileDevice",
    "util",
    "ScriptLoader",
    "addListenerOnce",
    "alternativeStyles",
    "addStyles",
    "addScripts",
    "metaParser",
    "parser",
    "MetaParser",
    "pluginsToLoad",
    "concat",
    "parsePlugins",
    "parse",
    "login",
    "querySelectorAll",
    "elem",
    "cacheUsed",
    "page",
    "createPages",
    "setDomFinished",
    "structure",
    "WidgetFactory",
    "getInstanceById",
    "initialPage",
    "setCurrentPage",
    "adjustColumns",
    "applyColumnWidths",
    "PageHandler",
    "undefined",
    "setSpeed",
    "DeferredCall",
    "scrollToPage",
    "schedule",
    "bom",
    "History",
    "e",
    "lastPage",
    "onload",
    "TrickOMatic",
    "run",
    "startInitialRequest",
    "IconTools",
    "fillRecoloredIcon",
    "startScreensaver",
    "screensave",
    "Timer",
    "start",
    "Registration",
    "window",
    "restart",
    "enableAddressQueue",
    "startPageAddresses",
    "pageWidget",
    "getChildWidgets",
    "child",
    "getAddress",
    "addr",
    "hasOwnProperty",
    "setInitialAddresses",
    "keys",
    "addressesToSubscribe",
    "subscribe",
    "path",
    "flavour",
    "WidgetParser",
    "renderTemplates",
    "parsedData",
    "i",
    "l",
    "createInstance",
    "$$type",
    "getDomString",
    "getPageIdByPath",
    "page_name",
    "match",
    "scope",
    "traversePath",
    "getPageIdByName",
    "root_page_id",
    "path_scope",
    "index",
    "substr",
    "next",
    "path_page_name",
    "page_id",
    "String",
    "decodeHtmlEntities",
    "decodeURI",
    "replace",
    "selector",
    "pages",
    "from",
    "h",
    "textContent",
    "getCurrentPage",
    "currentPageId",
    "getPath",
    "fallback",
    "Tree",
    "getClosest",
    "innerText",
    "pid",
    "target",
    "speed",
    "skipHistory",
    "treePath",
    "rememberLastPage",
    "Environment",
    "get",
    "localStorage",
    "lastpage",
    "headline",
    "pageTitle",
    "addToHistory",
    "seekTo",
    "initializeNavbars",
    "navbars",
    "left",
    "dynamic",
    "fadeNavbar",
    "body",
    "style",
    "display",
    "div",
    "dom",
    "Element",
    "create",
    "entries",
    "background",
    "width",
    "color",
    "margin",
    "padding",
    "key_value",
    "innerHTML",
    "appendChild",
    "store",
    "Json",
    "ResourceManager",
    "toUri",
    "html",
    "getModel",
    "element",
    "myDiv",
    "cursor",
    "borderBottom",
    "position",
    "tDiv",
    "height",
    "zIndex",
    "pos",
    "getBoundingClientRect",
    "top",
    "href",
    "location",
    "hash",
    "split",
    "search",
    "TemplateEngine"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* TemplateEngine.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.TemplateEngine', {\n  extend: qx.core.Object,\n  type: \"singleton\",\n\n  construct: function() {\n    // this.base(arguments);\n    this.pagePartsHandler = new cv.ui.PagePartsHandler();\n\n    this.__partQueue = new qx.data.Array();\n    this._domFinishedQueue = [];\n    this.__partQueue.addListener(\"changeLength\", function(ev) {\n      this.setPartsLoaded(ev.getData() === 0);\n    }, this);\n\n    this.defaults = {widget: {}, plugin: {}};\n    var group = new qx.ui.command.Group();\n    this.setCommands(group);\n    var app = qx.core.Init.getApplication();\n    if (app) {\n      // application is not available in tests\n      var manager = app.getCommandManager();\n      manager.add(group);\n      manager.setActive(group);\n    }\n  },\n\n  properties: {\n\n    /**\n     * Shows the loading state of the parts\n     */\n    partsLoaded: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyLoaded\",\n      event: \"changePartsLoaded\"\n    },\n\n    /**\n     * Shows the loading state of the scripts\n     */\n    scriptsLoaded: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyLoaded\"\n    },\n\n    /**\n     * Shows the initialization state of the TemplateEngine. It gets until when all\n     * external stuff (pars, scripts, etc.) has been loaded.\n     */\n    ready: {\n      check: \"Boolean\",\n      init: false,\n      event: \"changeReady\",\n      apply: \"_applyReady\"\n    },\n\n    currentPage: {\n      check: \"cv.ui.structure.IPage\",\n      nullable: true,\n      event: \"changeCurrentPage\"\n    },\n\n    domFinished: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyDomFinished\",\n      event: \"changeDomFinished\"\n    },\n\n    commands: {\n      check: \"qx.ui.command.Group\",\n      nullable: true\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    pagePartsHandler: null,\n    // if true the whole widget reacts on click events\n    // if false only the actor in the widget reacts on click events\n    bindClickToWidget : false,\n    /**\n     * Structure where a design can set a default value that a widget or plugin\n     * can use.\n     * This is especially important for design relevant information like colors\n     * that can not be set though CSS.\n     *\n     * Usage: this.defaults.plugin.foo = {bar: 'baz'};\n     */\n    defaults : null,\n\n    main_scroll : null,\n    old_scroll : '',\n    visu : null,\n\n    pluginsToLoadCount : 0,\n    xml : null,\n\n    __partQueue: null,\n    _domFinishedQueue: null,\n\n    // plugins that do not need to be loaded to proceed with the initial setup\n    lazyPlugins: [\"plugin-openhab\"],\n\n    /**\n     * Load parts (e.g. plugins, structure)\n     *\n     * @param parts {String[]|String} parts to load\n     */\n    loadParts: function(parts) {\n      if (!Array.isArray(parts)) {\n        parts = [parts];\n      }\n      var loadLazyParts = this.lazyPlugins.filter(function(part) {\n        return parts.indexOf(part) >= 0;\n      });\n      if (loadLazyParts.length) {\n        parts = parts.filter(function(p){return !loadLazyParts.includes(p);});\n      }\n      this.__partQueue.append(parts);\n      qx.io.PartLoader.require(parts, function(states) {\n        parts.forEach(function(part, idx) {\n          if (states[idx] === \"complete\") {\n            this.__partQueue.remove(part);\n            this.debug(\"successfully loaded part \"+part);\n            if (part.startsWith('structure-')) {\n              qx.core.Init.getApplication().setStructureLoaded(true);\n            }\n          } else {\n            this.error(\"error loading part \"+part);\n          }\n        }, this);\n      }, this);\n\n      // load the lazy plugins no one needs to wait for\n      qx.io.PartLoader.require(loadLazyParts, function(states) {\n        loadLazyParts.forEach(function(part, idx) {\n          if (states[idx] === \"complete\") {\n            this.debug(\"successfully loaded part \"+part);\n          } else {\n            this.error(\"error loading part \"+part);\n          }\n        }, this);\n      }, this);\n    },\n\n    // property apply\n    _applyReady: function(value) {\n      if (value === true) {\n        this.setupPage();\n      }\n    },\n\n    // property apply\n    _applyLoaded: function(value, old, name) {\n      this.debug(name+\" is \"+value+\" now\");\n      if (this.isPartsLoaded() && this.isScriptsLoaded()) {\n        this.setReady(true);\n      }\n    },\n\n    // property apply\n    _applyDomFinished: function(value) {\n      if (value) {\n        qx.event.message.Bus.dispatchByName(\"setup.dom.finished\");\n        // flush the queue\n        this._domFinishedQueue.forEach(function(entry) {\n          var callback = entry.shift();\n          var context = entry.shift();\n          callback.apply(context, entry);\n        }, this);\n        this._domFinishedQueue = [];\n      }\n    },\n\n    /**\n     * Adds a callback to a queue which is executed after DOM has been rendered\n     * @param callback {Function}\n     * @param context {Object}\n     */\n    executeWhenDomFinished: function(callback, context) {\n      if (!this.isDomFinished()) {\n        // queue callback\n        this._domFinishedQueue.push(Array.prototype.slice.call(arguments));\n      } else {\n        callback.apply(context, Array.prototype.slice.call(arguments, 2));\n      }\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().addAddress()} instead\n     * @deprecated {0.11.0} Please use {cv.data.Model.getInstance().addAddress()} instead\n     */\n    addAddress: function (address, id) {\n      this.warn(\"addAddress is deprecated! Please use cv.data.Model.getInstance().addAddress() instead\");\n      cv.data.Model.getInstance().addAddress(address, id);\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().getAddresses()} instead\n     * @deprecated {0.11.0} Please use {cv.data.Model.getInstance().getAddresses()} instead\n     */\n    getAddresses: function () {\n      this.warn(\"getAddresses is deprecated! Please use cv.data.Model.getInstance().getAddresses() instead\");\n      return cv.data.Model.getInstance().getAddresses();\n    },\n\n    /**\n     * Initialize the {@link cv.io.Client} for backend communication\n     */\n    initBackendClient: function () {\n      var backendName = cv.Config.configSettings.backend || cv.Config.backend;\n      if (backendName === \"oh\") {\n        this.visu = cv.Application.createClient('openhab', cv.Config.backendUrl);\n      }\n      else if (backendName === \"oh2\") {\n        this.visu = cv.Application.createClient('openhab2', cv.Config.backendUrl);\n      } else {\n        this.visu = cv.Application.createClient(backendName, cv.Config.backendUrl);\n      }\n\n      var model = cv.data.Model.getInstance();\n      this.visu.update = model.update.bind(model); // override clients update function\n      if (cv.Config.reporting) {\n        var recordInstance = cv.report.Record.getInstance();\n        this.visu.record = function(p,d){recordInstance.record.apply(recordInstance,[cv.report.Record.BACKEND,p,d]);};\n      }\n      this.visu.showError = this._handleClientError.bind(this);\n      this.visu.user = 'demo_user'; // example for setting a user\n\n      // show connection state in NotificationCenter\n      this.visu.addListener(\"changeConnected\", function(ev) {\n        var message = {\n          topic: \"cv.client.connection\",\n          title: qx.locale.Manager.tr(\"Connection error\"),\n          severity: \"urgent\",\n          unique: true,\n          deletable: false,\n          condition: !ev.getData()\n        };\n        var lastError = this.visu.getLastError();\n        if (!ev.getData()) {\n          if (lastError && (Date.now() - lastError.time) < 100) {\n            message.message = qx.locale.Manager.tr(\"Error requesting %1: %2 - %3.\", lastError.url, lastError.code, lastError.text);\n          } else {\n            message.message = qx.locale.Manager.tr(\"Connection to backend is lost.\");\n          }\n        }\n        cv.core.notifications.Router.dispatchMessage(message.topic, message);\n      }, this);\n    },\n\n    _handleClientError: function (errorCode, varargs) {\n      varargs = Array.prototype.slice.call(arguments, 1);\n      var notification;\n      var message = '';\n      switch (errorCode) {\n        case cv.io.Client.ERROR_CODES.PROTOCOL_MISSING_VERSION:\n          notification = {\n            topic: \"cv.error\",\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to the %1Login%2 request: missing protocol version.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n            '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + JSON.stringify(varargs[0], null, 2) +'</pre></div>',\n            severity: \"urgent\",\n            unique: true,\n            deletable: false\n          };\n          break;\n\n        case cv.io.Client.ERROR_CODES.PROTOCOL_INVALID_READ_RESPONSE_MISSING_I:\n          notification = {\n            topic: \"cv.error\",\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to a %1read%2 request: Missing \"i\" value.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n              '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + JSON.stringify(varargs[0], null, 2) +'</pre></div>',\n            severity: \"urgent\",\n            unique: true,\n            deletable: false\n          };\n          break;\n      }\n      if (notification) {\n        cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n      }\n    },\n\n    /**\n     * Reset some values related to the current page\n     */\n    resetPageValues: function () {\n      this.resetCurrentPage();\n      cv.ui.layout.Manager.currentPageUnavailableWidth = -1;\n      cv.ui.layout.Manager.currentPageUnavailableHeight = -1;\n      cv.ui.layout.Manager.currentPageNavbarVisibility = null;\n    },\n\n    /**\n     * Read basic settings and meta-section from config document\n     * @param loaded_xml {Document} XML-configuration document\n     * @param done {Function} callback that is called when the parsing has finished\n     */\n    parseXML: function (loaded_xml, done) {\n      /*\n       * First, we try to get a design by url. Secondly, we try to get a predefined\n       */\n      // read predefined design in config\n      var settings = cv.Config.configSettings;\n      var pagesNode = loaded_xml.querySelector(\"pages\");\n\n      var predefinedDesign = pagesNode.getAttribute(\"design\");\n      // design by url\n      // design by config file\n      if (!cv.Config.clientDesign && !settings.clientDesign) {\n        if (predefinedDesign) {\n          settings.clientDesign = predefinedDesign;\n        }\n        // selection dialog\n        else {\n          this.selectDesign();\n        }\n      }\n\n      // load structure-part\n      this.loadParts([cv.Config.getStructure()]);\n\n      if (pagesNode.getAttribute(\"backend\") !== null) {\n        settings.backend = pagesNode.getAttribute(\"backend\");\n      }\n      this.initBackendClient();\n\n      if (pagesNode.getAttribute('scroll_speed') === null) {\n        settings.scrollSpeed = 400;\n      } else {\n        settings.scrollSpeed = parseInt(pagesNode.getAttribute('scroll_speed'));\n      }\n\n      if (pagesNode.getAttribute('bind_click_to_widget') !== null) {\n        settings.bindClickToWidget = pagesNode.getAttribute('bind_click_to_widget') === \"true\";\n      }\n      if (pagesNode.getAttribute('default_columns') !== null) {\n        settings.defaultColumns = pagesNode.getAttribute('default_columns');\n      }\n      if (pagesNode.getAttribute('min_column_width') !== null) {\n        settings.minColumnWidth = pagesNode.getAttribute('min_column_width');\n      }\n      settings.screensave_time = pagesNode.getAttribute('screensave_time');\n      if (settings.screensave_time) {\n        settings.screensave_time = parseInt(settings.screensave_time, 10);\n      }\n      settings.screensave_page = pagesNode.getAttribute('screensave_page');\n\n      if (pagesNode.getAttribute('max_mobile_screen_width') !== null) {\n        settings.maxMobileScreenWidth = pagesNode.getAttribute('max_mobile_screen_width');\n      }\n\n      var globalClass = pagesNode.getAttribute('class');\n      if (globalClass !== null) {\n        document.querySelector('body').classList.add(globalClass);\n      }\n\n      settings.scriptsToLoad = [];\n      settings.stylesToLoad = [];\n      var design = cv.Config.getDesign();\n      if (design) {\n        var baseUri = 'designs/' + design;\n        settings.stylesToLoad.push(baseUri + '/basic.css');\n        this.debug('cv.Config.mobileDevice: ' + cv.Config.mobileDevice);\n        if (cv.Config.mobileDevice) {\n          settings.stylesToLoad.push(baseUri + '/mobile.css');\n          document.querySelector('body').classList.add('mobile');\n        }\n        settings.stylesToLoad.push(baseUri + '/custom.css');\n        settings.scriptsToLoad.push('designs/' + design + '/design_setup.js');\n\n        cv.util.ScriptLoader.getInstance().addListenerOnce(\"designError\", function(ev) {\n          if (ev.getData() === design) {\n            this.error('Failed to load \"'+design+'\" design! Falling back to simplified \"pure\"');\n\n            baseUri = 'designs/pure';\n            var alternativeStyles = [baseUri+'/basic.css'];\n            if (cv.Config.mobileDevice) {\n              alternativeStyles.push(baseUri+'/mobile.css');\n            }\n            alternativeStyles.push(baseUri+'/custom.css');\n            cv.util.ScriptLoader.getInstance().addStyles( alternativeStyles );\n            cv.util.ScriptLoader.getInstance().addScripts(baseUri+\"/design_setup.js\");\n          }\n        }, this);\n      }\n      var metaParser = new cv.parser.MetaParser();\n\n      // start with the plugins\n      settings.pluginsToLoad = settings.pluginsToLoad.concat(metaParser.parsePlugins(loaded_xml));\n      // and then the rest\n      metaParser.parse(loaded_xml, done);\n      this.debug(\"parsed\");\n    },\n\n    /**\n     * Main setup to get everything running and show the initial page.\n     */\n    setupPage: function () {\n      // and now setup the pages\n      this.debug(\"setup\");\n\n      // login to backend as it might change some settings needed for further processing\n      this.visu.login(true, function () {\n        this.debug(\"logged in\");\n\n        // as we are sure that the default CSS were loaded now:\n        document.querySelectorAll('link[href*=\"mobile.css\"]').forEach(function (elem) {\n        });\n        if (!cv.Config.cacheUsed) {\n          this.debug(\"creating pages\");\n          var page = this.xml.querySelector('pages > page'); // only one page element allowed...\n\n          this.createPages(page, 'id');\n          this.debug(\"finalizing\");\n          qx.event.message.Bus.dispatchByName(\"setup.dom.append\");\n          this.debug(\"pages created\");\n        }\n        this.debug(\"setup.dom.finished\");\n        qx.event.message.Bus.dispatchByName(\"setup.dom.finished.before\");\n        this.setDomFinished(true);\n\n        var currentPage = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        if (currentPage) {\n          this.setCurrentPage(currentPage);\n        }\n        cv.ui.layout.Manager.adjustColumns();\n        cv.ui.layout.Manager.applyColumnWidths('#'+cv.Config.initialPage, true);\n\n        this.main_scroll = new cv.ui.PageHandler();\n        if (this.scrollSpeed !== undefined) {\n          this.main_scroll.setSpeed(this.scrollSpeed);\n        }\n\n        new qx.util.DeferredCall(function() {\n          this.scrollToPage(cv.Config.initialPage, 0);\n        }, this).schedule();\n\n        // reaction on browser back button\n        qx.bom.History.getInstance().addListener(\"request\", function(e) {\n          var lastPage = e.getData();\n          if (lastPage) {\n            this.scrollToPage(lastPage, 0, true);\n          }\n        }, this);\n\n        // run the Trick-O-Matic scripts for great SVG backdrops\n        document.querySelectorAll('embed').forEach(function(elem) {\n          elem.onload = cv.ui.TrickOMatic.run;\n        });\n\n        this.startInitialRequest();\n\n        this.xml = null; // not needed anymore - free the space\n\n        document.querySelectorAll('.icon').forEach(cv.util.IconTools.fillRecoloredIcon, cv.util.IconTools);\n        document.querySelectorAll('.loading').forEach(function(elem) {\n          elem.classList.remove('loading');\n        }, this);\n\n        this.startScreensaver();\n        if (qx.core.Environment.get(\"qx.aspects\")) {\n          qx.dev.Profile.stop();\n          qx.dev.Profile.showResults(50);\n        }\n      }, this);\n    },\n\n    /**\n     * Start the screensaver if a screensave time is set\n     */\n    startScreensaver: function() {\n      if (typeof cv.Config.configSettings.screensave_time === 'number') {\n        this.screensave = new qx.event.Timer(cv.Config.configSettings.screensave_time * 1000);\n        this.screensave.addListener(\"interval\", function () {\n          this.scrollToPage();\n        }, this);\n        this.screensave.start();\n        qx.event.Registration.addListener(window, \"useraction\", this.screensave.restart, this.screensave);\n      }\n    },\n\n    /**\n     * Start retrieving data from backend\n     */\n    startInitialRequest: function() {\n      if (qx.core.Environment.get(\"qx.debug\")) {\n        cv.report.Replay.start();\n      }\n      if (cv.Config.enableAddressQueue) {\n        // identify addresses on startpage\n        var startPageAddresses = {};\n        var pageWidget = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        pageWidget.getChildWidgets().forEach(function(child) {\n          var address = child.getAddress ? child.getAddress() : {};\n          for (var addr in address) {\n            if (address.hasOwnProperty(addr)) {\n              startPageAddresses[addr] = 1;\n            }\n          }\n        }, this);\n        this.visu.setInitialAddresses(Object.keys(startPageAddresses));\n      }\n      var addressesToSubscribe = cv.data.Model.getInstance().getAddresses();\n      if (0 !== addressesToSubscribe.length) {\n        this.visu.subscribe(addressesToSubscribe);\n      }\n    },\n\n    /**\n     * Start the parsing process\n     * @param page {Element} XML-configuration element\n     * @param path {String} internal poth\n     * @param flavour {String} inherited flavour\n     * @param type {String} page type (text, 2d, 3d)\n     */\n    createPages: function (page, path, flavour, type) {\n      cv.parser.WidgetParser.renderTemplates(page);\n      var parsedData = cv.parser.WidgetParser.parse(page, path, flavour, type);\n      if (!Array.isArray(parsedData)) {\n        parsedData = [parsedData];\n      }\n      for (var i = 0, l = parsedData.length; i < l; i++) {\n        var data = parsedData[i];\n        var widget = cv.ui.structure.WidgetFactory.createInstance(data.$$type, data);\n\n        // trigger DOM generation\n        if (widget) { widget.getDomString(); }\n      }\n    },\n\n    /**\n     * Returns the id of the page the given path is associated to\n     * @param page_name {String}\n     * @param path {String}\n     * @return {String}\n     */\n    getPageIdByPath: function (page_name, path) {\n      if (page_name === null) { return null; }\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } else {\n        if (path !== undefined) {\n          var scope = this.traversePath(path);\n          if (scope === null) {\n            // path is wrong\n            this.error(\"path '\" + path + \"' could not be traversed, no page found\");\n            return null;\n          }\n          return this.getPageIdByName(page_name, scope);\n        } else {\n          return this.getPageIdByName(page_name);\n        }\n      }\n    },\n\n    traversePath: function (path, root_page_id) {\n      var path_scope = null;\n      var index = path.indexOf(\"/\");\n      if (index >= 1) {\n        // skip escaped slashes like \\/\n        while (path.substr(index - 1, 1) === \"\\\\\") {\n          var next = path.indexOf(\"/\", index + 1);\n          if (next >= 0) {\n            index = next;\n          }\n        }\n      }\n      //    console.log(\"traversePath(\"+path+\",\"+root_page_id+\")\");\n      if (index >= 0) {\n        // traverse path one level down\n        var path_page_name = path.substr(0, index);\n        path_scope = this.getPageIdByName(path_page_name, root_page_id);\n        path = path.substr(path_page_name.length + 1);\n        path_scope = this.traversePath(path, path_scope);\n        //      console.log(path_page_name+\"=>\"+path_scope);\n        return path_scope;\n      } else {\n        // bottom path level reached\n        path_scope = this.getPageIdByName(path, root_page_id);\n        return path_scope;\n      }\n    },\n\n    getPageIdByName: function (page_name, scope) {\n      var page_id = null;\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } else {\n        // find Page-ID by name\n        // decode html code (e.g. like &apos; => ')\n        page_name = cv.util.String.decodeHtmlEntities(page_name);\n        // remove escaped slashes\n        page_name = decodeURI(page_name.replace(\"\\\\\\/\", \"/\"));\n\n        //      console.log(\"Page: \"+page_name+\", Scope: \"+scope);\n        var selector = (scope !== undefined && scope !== null) ? '.page[id^=\"' + scope + '\"] h1' : '.page h1';\n        var pages = document.querySelectorAll(selector);\n        pages = Array.from( pages ).filter(function(h){return h.textContent === page_name;});\n        if (pages.length > 1 && this.getCurrentPage() !== null) {\n          var currentPageId = this.getCurrentPage().getPath();\n          // More than one Page found -> search in the current pages descendants first\n          var fallback = true;\n          pages.forEach(function (page) {\n            var p = cv.util.Tree.getClosest(page, \".page\");\n            if (page.innerText === page_name) {\n              var pid = p.getAttribute('id');\n              if (pid.length < currentPageId.length) {\n                // found pages path is shorter the the current pages -> must be an ancestor\n                if (currentPageId.indexOf(pid) === 0) {\n                  // found page is an ancestor of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return false;\n                }\n              } else {\n                if (pid.indexOf(currentPageId) === 0) {\n                  // found page is an descendant of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return false;\n                }\n              }\n            }\n          }, this);\n          if (fallback) {\n            // take the first page that fits (old behaviour)\n            pages.forEach(function (page) {\n              if (page.innerText  === page_name) {\n                page_id = cv.util.Tree.getClosest(page, \".page\").getAttribute(\"id\");\n                // break loop\n                return false;\n              }\n            });\n          }\n        } else {\n          pages.forEach(function (page) {\n            if (page.innerText === page_name) {\n              page_id = cv.util.Tree.getClosest(page, \".page\").getAttribute(\"id\");\n              // break loop\n              return false;\n            }\n          });\n        }\n      }\n      if (page_id !== null && page_id.match(/^id_[0-9_]*$/) !== null) {\n        return page_id;\n      } else {\n        // not found\n        return null;\n      }\n    },\n\n    scrollToPage: function (target, speed, skipHistory) {\n      if (undefined === target) {\n        target = cv.Config.configSettings.screensave_page;\n      }\n      var page_id = this.getPageIdByPath(target);\n      if (page_id === null) {\n        return;\n      }\n      if (cv.Config.currentPageId === page_id) {\n        return;\n      }\n      cv.Config.currentPageId = page_id;\n      cv.Config.treePath = page_id;\n\n      if (undefined === speed) {\n        speed = cv.Config.configSettings.scrollSpeed;\n      }\n\n      if (cv.Config.rememberLastPage && qx.core.Environment.get(\"html.storage.local\")) {\n        localStorage.lastpage = page_id;\n      }\n\n      // push new state to history\n      if (skipHistory === undefined) {\n        var headline = document.querySelectorAll(\"#\"+page_id+\" h1\");\n        var pageTitle = \"CometVisu\";\n        if (headline.length) {\n          pageTitle = headline[0].textContent+ \" - \"+pageTitle;\n        }\n        qx.bom.History.getInstance().addToHistory(page_id, pageTitle);\n      }\n\n      this.main_scroll.seekTo(page_id, speed); // scroll to it\n\n      this.pagePartsHandler.initializeNavbars(page_id);\n      if (cv.Config.mobileDevice) {\n        switch (this.pagePartsHandler.navbars.left.dynamic) {\n          case null:\n          case true:\n            this.pagePartsHandler.fadeNavbar('Left', 'out', 0);\n            break;\n\n          case false:\n            this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n        }\n      } else {\n        this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n      }\n    },\n\n    selectDesign: function () {\n      var body = document.querySelector(\"body\");\n\n      document.querySelectorAll('body > *').forEach(function(elem) {\n        elem.style.display = 'none';\n      }, this);\n      body.style['background-color'] = \"black\";\n\n\n      var div = qx.dom.Element.create(\"div\", {id: \"designSelector\"});\n      Object.entries({\n        background: \"#808080\",\n        width: \"400px\",\n        color: \"white\",\n        margin: \"auto\",\n        padding: \"0.5em\"\n      }).forEach(function(key_value){body.style[key_value[0]]=key_value[1];});\n      div.innerHTML = \"Loading ...\";\n\n      body.appendChild(div);\n\n      var store = new qx.data.store.Json(qx.util.ResourceManager.getInstance().toUri(\"designs/get_designs.php\"));\n\n      store.addListener(\"loaded\", function () {\n        var html = \"<h1>Please select design</h1>\";\n        html += \"<p>The Location/URL will change after you have chosen your design. Please bookmark the new URL if you do not want to select the design every time.</p>\";\n\n        div.innerHTML = html;\n\n        store.getModel().forEach(function(element) {\n\n          var myDiv = qx.dom.Element.create(\"div\", {\n            cursor: \"pointer\",\n            padding: \"0.5em 1em\",\n            borderBottom: \"1px solid black\",\n            margin: \"auto\",\n            width: \"262px\",\n            position: \"relative\"\n          });\n\n          myDiv.innerHTML = \"<div style=\\\"font-weight: bold; margin: 1em 0 .5em;\\\">Design: \" + element + \"</div>\";\n          myDiv.innerHTML += \"<iframe src=\\\"\"+qx.util.ResourceManager.getInstance().toUri(\"designs/design_preview.html\")+\"?design=\" + element + \"\\\" width=\\\"160\\\" height=\\\"90\\\" border=\\\"0\\\" scrolling=\\\"auto\\\" frameborder=\\\"0\\\" style=\\\"z-index: 1;\\\"></iframe>\";\n          myDiv.innerHTML += \"<img width=\\\"60\\\" height=\\\"30\\\" src=\\\"\"+qx.util.ResourceManager.getInstance().toUri(\"demo/media/arrow.png\")+\"\\\" alt=\\\"select\\\" border=\\\"0\\\" style=\\\"margin: 60px 10px 10px 30px;\\\"/>\";\n\n          div.appendChild(myDiv);\n\n\n          var tDiv = qx.dom.Element.create(\"div\", {\n            background: \"transparent\",\n            position: \"absolute\",\n            height: \"90px\",\n            width: \"160px\",\n            zIndex: 2\n          });\n          var pos = document.querySelector(\"iframe\").getBoundingClientRect();\n          Object.entries({\n            left: pos.left + \"px\",\n            top: pos.top + \"px\"\n          }).forEach(function(key_value){tDiv.style[key_value[0]]=key_value[1];});\n          myDiv.appendChild(tDiv);\n\n          qx.event.Registration.addListener(myDiv, 'pointerover', function() {\n            myDiv.style.background = \"#bbbbbb\";\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'pointerout', function() {\n            myDiv.style.background = \"transparent\";\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'tap', function() {\n            var href = document.location.href;\n            if (document.location.hash) {\n              href = href.split('#')[0];\n            }\n            if (document.location.search === \"\") {\n              document.location.href = href + \"?design=\" + element;\n            } else {\n              document.location.href = href + \"&design=\" + element;\n            }\n          });\n        });\n      });\n    }\n  }\n});"
  ]
}