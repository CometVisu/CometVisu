{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/TemplateEngine.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "type",
    "construct",
    "pagePartsHandler",
    "cv",
    "ui",
    "PagePartsHandler",
    "__partQueue",
    "data",
    "Array",
    "_domFinishedQueue",
    "addListener",
    "ev",
    "setPartsLoaded",
    "getData",
    "defaults",
    "widget",
    "plugin",
    "group",
    "command",
    "Group",
    "setCommands",
    "app",
    "Init",
    "getApplication",
    "manager",
    "getCommandManager",
    "add",
    "setActive",
    "statics",
    "getClient",
    "getInstance",
    "visu",
    "properties",
    "partsLoaded",
    "check",
    "init",
    "apply",
    "event",
    "scriptsLoaded",
    "ready",
    "currentPage",
    "nullable",
    "domFinished",
    "commands",
    "loggedIn",
    "members",
    "bindClickToWidget",
    "main_scroll",
    "old_scroll",
    "pluginsToLoadCount",
    "xml",
    "lazyPlugins",
    "__activeChangedTimer",
    "__hasBeenConnected",
    "loadParts",
    "parts",
    "isArray",
    "loadLazyParts",
    "filter",
    "part",
    "indexOf",
    "length",
    "p",
    "includes",
    "append",
    "io",
    "PartLoader",
    "require",
    "states",
    "forEach",
    "idx",
    "remove",
    "debug",
    "startsWith",
    "setStructureLoaded",
    "error",
    "_applyReady",
    "value",
    "setupPage",
    "_applyLoaded",
    "old",
    "name",
    "isPartsLoaded",
    "isScriptsLoaded",
    "setReady",
    "_applyDomFinished",
    "message",
    "Bus",
    "dispatchByName",
    "entry",
    "callback",
    "shift",
    "context",
    "executeWhenDomFinished",
    "isDomFinished",
    "push",
    "prototype",
    "slice",
    "call",
    "arguments",
    "addAddress",
    "address",
    "id",
    "warn",
    "Model",
    "getAddresses",
    "initBackendClient",
    "backendName",
    "Config",
    "configSettings",
    "backend",
    "backendUrl",
    "mapping",
    "oh",
    "oh2",
    "hasOwnProperty",
    "Application",
    "createClient",
    "model",
    "update",
    "bind",
    "reporting",
    "recordInstance",
    "report",
    "Record",
    "record",
    "d",
    "BACKEND",
    "showError",
    "_handleClientError",
    "user",
    "sentryEnabled",
    "window",
    "Sentry",
    "configureScope",
    "scope",
    "setTag",
    "webServer",
    "getServer",
    "configServer",
    "_updateClientScope",
    "_onActiveChanged",
    "_checkBackendConnection",
    "isActive",
    "isConnected",
    "restart",
    "Timer",
    "stop",
    "connected",
    "topic",
    "title",
    "locale",
    "Manager",
    "tr",
    "severity",
    "unique",
    "deletable",
    "condition",
    "lastError",
    "getLastError",
    "Date",
    "now",
    "time",
    "url",
    "code",
    "text",
    "notifications",
    "Router",
    "dispatchMessage",
    "errorCode",
    "varargs",
    "JSON",
    "stringify",
    "div",
    "document",
    "createElement",
    "innerText",
    "innerHTML",
    "notification",
    "Client",
    "ERROR_CODES",
    "PROTOCOL_MISSING_VERSION",
    "PROTOCOL_INVALID_READ_RESPONSE_MISSING_I",
    "resetPageValues",
    "resetCurrentPage",
    "layout",
    "currentPageUnavailableWidth",
    "currentPageUnavailableHeight",
    "currentPageNavbarVisibility",
    "parseXML",
    "loaded_xml",
    "done",
    "settings",
    "pagesNode",
    "querySelector",
    "predefinedDesign",
    "getAttribute",
    "clientDesign",
    "selectDesign",
    "getStructure",
    "credentials",
    "token",
    "username",
    "password",
    "scrollSpeed",
    "parseInt",
    "defaultColumns",
    "minColumnWidth",
    "screensave_time",
    "screensave_page",
    "maxMobileScreenWidth",
    "globalClass",
    "classList",
    "scriptsToLoad",
    "stylesToLoad",
    "design",
    "getDesign",
    "baseUri",
    "mobileDevice",
    "util",
    "ScriptLoader",
    "addListenerOnce",
    "alternativeStyles",
    "addStyles",
    "addScripts",
    "metaParser",
    "parser",
    "MetaParser",
    "pluginsToLoad",
    "concat",
    "parsePlugins",
    "parse",
    "login",
    "setLoggedIn",
    "querySelectorAll",
    "elem",
    "cacheUsed",
    "page",
    "createPages",
    "setDomFinished",
    "structure",
    "WidgetFactory",
    "getInstanceById",
    "initialPage",
    "setCurrentPage",
    "adjustColumns",
    "applyColumnWidths",
    "PageHandler",
    "undefined",
    "setSpeed",
    "DeferredCall",
    "scrollToPage",
    "schedule",
    "bom",
    "History",
    "e",
    "lastPage",
    "onload",
    "TrickOMatic",
    "run",
    "startInitialRequest",
    "IconTools",
    "fillRecoloredIcon",
    "startScreensaver",
    "screensave",
    "start",
    "Registration",
    "enableAddressQueue",
    "startPageAddresses",
    "pageWidget",
    "getChildWidgets",
    "child",
    "getAddress",
    "addr",
    "setInitialAddresses",
    "keys",
    "addressesToSubscribe",
    "subscribe",
    "path",
    "flavour",
    "WidgetParser",
    "renderTemplates",
    "parsedData",
    "i",
    "l",
    "createInstance",
    "$$type",
    "getDomString",
    "getPageIdByPath",
    "page_name",
    "match",
    "traversePath",
    "getPageIdByName",
    "root_page_id",
    "path_scope",
    "index",
    "substr",
    "next",
    "path_page_name",
    "page_id",
    "String",
    "decodeHtmlEntities",
    "decodeURI",
    "replace",
    "selector",
    "pages",
    "from",
    "h",
    "textContent",
    "getCurrentPage",
    "currentPageId",
    "getPath",
    "fallback",
    "Tree",
    "getClosest",
    "pid",
    "target",
    "speed",
    "skipHistory",
    "treePath",
    "rememberLastPage",
    "Environment",
    "get",
    "localStorage",
    "lastpage",
    "headline",
    "pageTitle",
    "addToHistory",
    "seekTo",
    "initializeNavbars",
    "navbars",
    "left",
    "dynamic",
    "fadeNavbar",
    "body",
    "style",
    "display",
    "dom",
    "Element",
    "create",
    "entries",
    "background",
    "width",
    "color",
    "margin",
    "padding",
    "key_value",
    "appendChild",
    "store",
    "Json",
    "ResourceManager",
    "toUri",
    "html",
    "getModel",
    "element",
    "myDiv",
    "cursor",
    "borderBottom",
    "position",
    "tDiv",
    "height",
    "zIndex",
    "pos",
    "getBoundingClientRect",
    "top",
    "href",
    "location",
    "hash",
    "split",
    "search",
    "destruct",
    "_disposeObjects",
    "TemplateEngine"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* TemplateEngine.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.TemplateEngine', {\n  extend: qx.core.Object,\n  type: \"singleton\",\n\n  construct: function() {\n    // this.base(arguments);\n    this.pagePartsHandler = new cv.ui.PagePartsHandler();\n\n    this.__partQueue = new qx.data.Array();\n    this._domFinishedQueue = [];\n    this.__partQueue.addListener(\"changeLength\", function(ev) {\n      this.setPartsLoaded(ev.getData() === 0);\n    }, this);\n\n    this.defaults = {widget: {}, plugin: {}};\n    var group = new qx.ui.command.Group();\n    this.setCommands(group);\n    var app = qx.core.Init.getApplication();\n    if (app) {\n      // application is not available in tests\n      var manager = app.getCommandManager();\n      manager.add(group);\n      manager.setActive(group);\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Shortcut access to client\n     */\n    getClient: function () {\n      return this.getInstance().visu;\n    }\n  },\n\n  properties: {\n\n    /**\n     * Shows the loading state of the parts\n     */\n    partsLoaded: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyLoaded\",\n      event: \"changePartsLoaded\"\n    },\n\n    /**\n     * Shows the loading state of the scripts\n     */\n    scriptsLoaded: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyLoaded\"\n    },\n\n    /**\n     * Shows the initialization state of the TemplateEngine. It gets until when all\n     * external stuff (pars, scripts, etc.) has been loaded.\n     */\n    ready: {\n      check: \"Boolean\",\n      init: false,\n      event: \"changeReady\",\n      apply: \"_applyReady\"\n    },\n\n    currentPage: {\n      check: \"cv.ui.structure.IPage\",\n      nullable: true,\n      event: \"changeCurrentPage\"\n    },\n\n    domFinished: {\n      check: \"Boolean\",\n      init: false,\n      apply: \"_applyDomFinished\",\n      event: \"changeDomFinished\"\n    },\n\n    commands: {\n      check: \"qx.ui.command.Group\",\n      nullable: true\n    },\n    \n    // sent after the client is logged in to the backend\n    loggedIn: {\n      check: \"Boolean\",\n      init: false,\n      event: \"changeLoggedIn\"\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    pagePartsHandler: null,\n    // if true the whole widget reacts on click events\n    // if false only the actor in the widget reacts on click events\n    bindClickToWidget : false,\n    /**\n     * Structure where a design can set a default value that a widget or plugin\n     * can use.\n     * This is especially important for design relevant information like colors\n     * that can not be set though CSS.\n     *\n     * Usage: this.defaults.plugin.foo = {bar: 'baz'};\n     */\n    defaults : null,\n\n    main_scroll : null,\n    old_scroll : '',\n    visu : null,\n\n    pluginsToLoadCount : 0,\n    xml : null,\n\n    __partQueue: null,\n    _domFinishedQueue: null,\n\n    // plugins that do not need to be loaded to proceed with the initial setup\n    lazyPlugins: [\"plugin-openhab\"],\n    __activeChangedTimer: null,\n    __hasBeenConnected: false,\n\n    /**\n     * Load parts (e.g. plugins, structure)\n     *\n     * @param parts {String[]|String} parts to load\n     */\n    loadParts: function(parts) {\n      if (!Array.isArray(parts)) {\n        parts = [parts];\n      }\n      var loadLazyParts = this.lazyPlugins.filter(function(part) {\n        return parts.indexOf(part) >= 0;\n      });\n      if (loadLazyParts.length) {\n        parts = parts.filter(function(p){return !loadLazyParts.includes(p);});\n      }\n      this.__partQueue.append(parts);\n      qx.io.PartLoader.require(parts, function(states) {\n        parts.forEach(function(part, idx) {\n          if (states[idx] === \"complete\") {\n            this.__partQueue.remove(part);\n            this.debug(\"successfully loaded part \"+part);\n            if (part.startsWith('structure-')) {\n              qx.core.Init.getApplication().setStructureLoaded(true);\n            }\n          } else {\n            this.error(\"error loading part \"+part);\n          }\n        }, this);\n      }, this);\n\n      // load the lazy plugins no one needs to wait for\n      qx.io.PartLoader.require(loadLazyParts, function(states) {\n        loadLazyParts.forEach(function(part, idx) {\n          if (states[idx] === \"complete\") {\n            this.debug(\"successfully loaded part \"+part);\n          } else {\n            this.error(\"error loading part \"+part);\n          }\n        }, this);\n      }, this);\n    },\n\n    // property apply\n    _applyReady: function(value) {\n      if (value === true) {\n        this.setupPage();\n      }\n    },\n\n    // property apply\n    _applyLoaded: function(value, old, name) {\n      this.debug(name+\" is \"+value+\" now\");\n      if (this.isPartsLoaded() && this.isScriptsLoaded()) {\n        this.setReady(true);\n      }\n    },\n\n    // property apply\n    _applyDomFinished: function(value) {\n      if (value) {\n        qx.event.message.Bus.dispatchByName(\"setup.dom.finished\");\n        // flush the queue\n        this._domFinishedQueue.forEach(function(entry) {\n          var callback = entry.shift();\n          var context = entry.shift();\n          callback.apply(context, entry);\n        }, this);\n        this._domFinishedQueue = [];\n      }\n    },\n\n    /**\n     * Adds a callback to a queue which is executed after DOM has been rendered\n     * @param callback {Function}\n     * @param context {Object}\n     */\n    executeWhenDomFinished: function(callback, context) {\n      if (!this.isDomFinished()) {\n        // queue callback\n        this._domFinishedQueue.push(Array.prototype.slice.call(arguments));\n      } else {\n        callback.apply(context, Array.prototype.slice.call(arguments, 2));\n      }\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().addAddress()} instead\n     * @deprecated {0.11.0} Please use {cv.data.Model.getInstance().addAddress()} instead\n     */\n    addAddress: function (address, id) {\n      this.warn(\"addAddress is deprecated! Please use cv.data.Model.getInstance().addAddress() instead\");\n      cv.data.Model.getInstance().addAddress(address, id);\n    },\n\n    /**\n     * Please use {cv.data.Model.getInstance().getAddresses()} instead\n     * @deprecated {0.11.0} Please use {cv.data.Model.getInstance().getAddresses()} instead\n     */\n    getAddresses: function () {\n      this.warn(\"getAddresses is deprecated! Please use cv.data.Model.getInstance().getAddresses() instead\");\n      return cv.data.Model.getInstance().getAddresses();\n    },\n\n    /**\n     * Initialize the {@link cv.io.Client} for backend communication\n     */\n    initBackendClient: function () {\n      let backendName = cv.Config.configSettings.backend || cv.Config.backend;\n      let backendUrl  = cv.Config.configSettings.backendUrl || cv.Config.backendUrl;\n      const mapping = {\n        oh: \"openhab\",\n        oh2: \"openhab2\"\n      };\n      if (mapping.hasOwnProperty(backendName)) {\n        backendName = mapping[backendName];\n      }\n      this.visu = cv.Application.createClient(backendName, backendUrl);\n\n      var model = cv.data.Model.getInstance();\n      this.visu.update = model.update.bind(model); // override clients update function\n      if (cv.Config.reporting) {\n        var recordInstance = cv.report.Record.getInstance();\n        this.visu.record = function(p,d){recordInstance.record.apply(recordInstance,[cv.report.Record.BACKEND,p,d]);};\n      }\n      this.visu.showError = this._handleClientError.bind(this);\n      this.visu.user = 'demo_user'; // example for setting a user\n      var visu = this.visu;\n\n      if (cv.Config.sentryEnabled && window.Sentry) {\n        Sentry.configureScope(function (scope) {\n          scope.setTag('backend', visu.backendName);\n          var webServer = visu.getServer();\n          if (webServer) {\n            scope.setTag('server.backend', webServer);\n          }\n          if (cv.Config.configServer) {\n            scope.setTag('server.web', cv.Config.configServer);\n          }\n        })\n        visu.addListener('changedServer', this._updateClientScope, this);\n      }\n      var app = qx.core.Init.getApplication();\n      app.addListener('changeActive', this._onActiveChanged, this);\n\n      // show connection state in NotificationCenter\n      this.visu.addListener(\"changeConnected\", this._checkBackendConnection, this);\n    },\n\n    _onActiveChanged: function () {\n      var app = qx.core.Init.getApplication();\n      if (app.isActive()) {\n        if (!this.visu.isConnected() && this.__hasBeenConnected) {\n          // reconnect\n          this.visu.restart(true);\n        }\n        // wait for 3 seconds before checking the backend connection\n        if (!this.__activeChangedTimer) {\n          this.__activeChangedTimer = new qx.event.Timer(3000);\n          this.__activeChangedTimer.addListener('interval', function () {\n            if (app.isActive()) {\n              this._checkBackendConnection();\n            }\n            this.__activeChangedTimer.stop();\n          }, this);\n        }\n        this.__activeChangedTimer.restart();\n      } else {\n        this._checkBackendConnection();\n      }\n    },\n\n    _checkBackendConnection: function () {\n      var connected = this.visu.isConnected();\n      var message = {\n        topic: \"cv.client.connection\",\n        title: qx.locale.Manager.tr(\"Connection error\"),\n        severity: \"urgent\",\n        unique: true,\n        deletable: false,\n        condition: !connected && this.__hasBeenConnected && qx.core.Init.getApplication().isActive()\n      };\n      var lastError = this.visu.getLastError();\n      if (!connected) {\n        if (lastError && (Date.now() - lastError.time) < 100) {\n          message.message = qx.locale.Manager.tr(\"Error requesting %1: %2 - %3.\", lastError.url, lastError.code, lastError.text);\n        } else {\n          message.message = qx.locale.Manager.tr(\"Connection to backend is lost.\");\n        }\n      } else {\n        this.__hasBeenConnected = true;\n      }\n      cv.core.notifications.Router.dispatchMessage(message.topic, message);\n    },\n\n    _updateClientScope: function () {\n      var visu = this.visu;\n      Sentry.configureScope(function (scope) {\n        var webServer = visu.getServer();\n        if (webServer) {\n          scope.setTag('server.backend', webServer);\n        }\n      })\n    },\n\n    _handleClientError: function (errorCode, varargs) {\n      varargs = Array.prototype.slice.call(arguments, 1);\n      varargs = JSON.stringify(varargs[0], null, 2);\n      // escape HTML:\n      let div = document.createElement('div');\n      div.innerText = varargs;\n      varargs = div.innerHTML;\n      let notification;\n      switch (errorCode) {\n        case cv.io.Client.ERROR_CODES.PROTOCOL_MISSING_VERSION:\n          notification = {\n            topic: \"cv.error\",\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to the %1Login%2 request: missing protocol version.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n            '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + varargs + '</pre></div>',\n            severity: \"urgent\",\n            unique: true,\n            deletable: false\n          };\n          break;\n\n        case cv.io.Client.ERROR_CODES.PROTOCOL_INVALID_READ_RESPONSE_MISSING_I:\n          notification = {\n            topic: \"cv.error\",\n            title: qx.locale.Manager.tr('CometVisu protocol error'),\n            message:  qx.locale.Manager.tr('The backend did send an invalid response to a %1read%2 request: Missing \"i\" value.',\n              '<a href=\"https://github.com/CometVisu/CometVisu/wiki/Protocol#Login\" target=\"_blank\">',\n              '</a>') + '<br/>' +\n              qx.locale.Manager.tr('Please try to fix the problem in the backend.') +\n              '<br/><br/><strong>' + qx.locale.Manager.tr('Backend-Response:') + '</strong><pre>' + varargs +'</pre></div>',\n            severity: \"urgent\",\n            unique: true,\n            deletable: false\n          };\n          break;\n      }\n      if (notification) {\n        cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n      }\n    },\n\n    /**\n     * Reset some values related to the current page\n     */\n    resetPageValues: function () {\n      this.resetCurrentPage();\n      cv.ui.layout.Manager.currentPageUnavailableWidth = -1;\n      cv.ui.layout.Manager.currentPageUnavailableHeight = -1;\n      cv.ui.layout.Manager.currentPageNavbarVisibility = null;\n    },\n\n    /**\n     * Read basic settings and meta-section from config document\n     * @param loaded_xml {Document} XML-configuration document\n     * @param done {Function} callback that is called when the parsing has finished\n     */\n    parseXML: function (loaded_xml, done) {\n      /*\n       * First, we try to get a design by url. Secondly, we try to get a predefined\n       */\n      // read predefined design in config\n      var settings = cv.Config.configSettings;\n      var pagesNode = loaded_xml.querySelector(\"pages\");\n\n      var predefinedDesign = pagesNode.getAttribute(\"design\");\n      // design by url\n      // design by config file\n      if (!cv.Config.clientDesign && !settings.clientDesign) {\n        if (predefinedDesign) {\n          settings.clientDesign = predefinedDesign;\n        }\n        // selection dialog\n        else {\n          this.selectDesign();\n        }\n      }\n\n      // load structure-part\n      this.loadParts([cv.Config.getStructure()]);\n\n      if (pagesNode.getAttribute(\"backend\") !== null) {\n        settings.backend = pagesNode.getAttribute(\"backend\");\n      }\n      if (pagesNode.getAttribute(\"backend-url\") !== null) {\n        settings.backendUrl = pagesNode.getAttribute(\"backend-url\");\n      }\n\n      if (pagesNode.getAttribute(\"token\") !== null) {\n        settings.credentials.token = pagesNode.getAttribute(\"token\");\n      }\n      if (pagesNode.getAttribute(\"username\") !== null) {\n        settings.credentials.username = pagesNode.getAttribute(\"username\");\n      }\n      if (pagesNode.getAttribute(\"password\") !== null) {\n        settings.credentials.password = pagesNode.getAttribute(\"password\");\n      }\n      this.initBackendClient();\n\n      if (pagesNode.getAttribute('scroll_speed') === null) {\n        settings.scrollSpeed = 400;\n      } else {\n        settings.scrollSpeed = parseInt(pagesNode.getAttribute('scroll_speed'));\n      }\n\n      if (pagesNode.getAttribute('bind_click_to_widget') !== null) {\n        settings.bindClickToWidget = pagesNode.getAttribute('bind_click_to_widget') === \"true\";\n      }\n      if (pagesNode.getAttribute('default_columns') !== null) {\n        settings.defaultColumns = pagesNode.getAttribute('default_columns');\n      }\n      if (pagesNode.getAttribute('min_column_width') !== null) {\n        settings.minColumnWidth = pagesNode.getAttribute('min_column_width');\n      }\n      settings.screensave_time = pagesNode.getAttribute('screensave_time');\n      if (settings.screensave_time) {\n        settings.screensave_time = parseInt(settings.screensave_time, 10);\n      }\n      settings.screensave_page = pagesNode.getAttribute('screensave_page');\n\n      if (pagesNode.getAttribute('max_mobile_screen_width') !== null) {\n        settings.maxMobileScreenWidth = pagesNode.getAttribute('max_mobile_screen_width');\n      }\n\n      var globalClass = pagesNode.getAttribute('class');\n      if (globalClass !== null) {\n        document.querySelector('body').classList.add(globalClass);\n      }\n\n      settings.scriptsToLoad = [];\n      settings.stylesToLoad = [];\n      var design = cv.Config.getDesign();\n      if (design) {\n        var baseUri = 'designs/' + design;\n        settings.stylesToLoad.push(baseUri + '/basic.css');\n        this.debug('cv.Config.mobileDevice: ' + cv.Config.mobileDevice);\n        if (cv.Config.mobileDevice) {\n          settings.stylesToLoad.push(baseUri + '/mobile.css');\n          document.querySelector('body').classList.add('mobile');\n        }\n        settings.stylesToLoad.push(baseUri + '/custom.css');\n        settings.scriptsToLoad.push('designs/' + design + '/design_setup.js');\n\n        cv.util.ScriptLoader.getInstance().addListenerOnce(\"designError\", function(ev) {\n          if (ev.getData() === design) {\n            this.error('Failed to load \"'+design+'\" design! Falling back to simplified \"pure\"');\n\n            baseUri = 'designs/pure';\n            var alternativeStyles = [baseUri+'/basic.css'];\n            if (cv.Config.mobileDevice) {\n              alternativeStyles.push(baseUri+'/mobile.css');\n            }\n            alternativeStyles.push(baseUri+'/custom.css');\n            cv.util.ScriptLoader.getInstance().addStyles( alternativeStyles );\n            cv.util.ScriptLoader.getInstance().addScripts(baseUri+\"/design_setup.js\");\n          }\n        }, this);\n      }\n      var metaParser = new cv.parser.MetaParser();\n\n      // start with the plugins\n      settings.pluginsToLoad = settings.pluginsToLoad.concat(metaParser.parsePlugins(loaded_xml));\n      // and then the rest\n      metaParser.parse(loaded_xml, done);\n      this.debug(\"parsed\");\n    },\n\n    /**\n     * Main setup to get everything running and show the initial page.\n     */\n    setupPage: function () {\n      // and now setup the pages\n      this.debug(\"setup\");\n\n      // login to backend as it might change some settings needed for further processing\n      this.visu.login(true, cv.Config.configSettings.credentials, function () {\n        this.debug(\"logged in\");\n        this.setLoggedIn(true);\n\n        // as we are sure that the default CSS were loaded now:\n        document.querySelectorAll('link[href*=\"mobile.css\"]').forEach(function (elem) {\n        });\n        if (!cv.Config.cacheUsed) {\n          this.debug(\"creating pages\");\n          var page = this.xml.querySelector('pages > page'); // only one page element allowed...\n\n          this.createPages(page, 'id');\n          this.debug(\"finalizing\");\n          qx.event.message.Bus.dispatchByName(\"setup.dom.append\");\n          this.debug(\"pages created\");\n        }\n        this.debug(\"setup.dom.finished\");\n        qx.event.message.Bus.dispatchByName(\"setup.dom.finished.before\");\n        this.setDomFinished(true);\n\n        var currentPage = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        if (currentPage) {\n          this.setCurrentPage(currentPage);\n        }\n        cv.ui.layout.Manager.adjustColumns();\n        cv.ui.layout.Manager.applyColumnWidths('#'+cv.Config.initialPage, true);\n\n        this.main_scroll = new cv.ui.PageHandler();\n        if (this.scrollSpeed !== undefined) {\n          this.main_scroll.setSpeed(this.scrollSpeed);\n        }\n\n        new qx.util.DeferredCall(function() {\n          this.scrollToPage(cv.Config.initialPage, 0);\n        }, this).schedule();\n\n        // reaction on browser back button\n        qx.bom.History.getInstance().addListener(\"request\", function(e) {\n          var lastPage = e.getData();\n          if (lastPage) {\n            this.scrollToPage(lastPage, 0, true);\n          }\n        }, this);\n\n        // run the Trick-O-Matic scripts for great SVG backdrops\n        document.querySelectorAll('embed').forEach(function(elem) {\n          elem.onload = cv.ui.TrickOMatic.run;\n        });\n\n        this.startInitialRequest();\n\n        this.xml = null; // not needed anymore - free the space\n\n        document.querySelectorAll('.icon').forEach(cv.util.IconTools.fillRecoloredIcon, cv.util.IconTools);\n        document.querySelectorAll('.loading').forEach(function(elem) {\n          elem.classList.remove('loading');\n        }, this);\n\n        this.startScreensaver();\n        if (qx.core.Environment.get(\"qx.aspects\")) {\n          qx.dev.Profile.stop();\n          qx.dev.Profile.showResults(50);\n        }\n      }, this);\n    },\n\n    /**\n     * Start the screensaver if a screensave time is set\n     */\n    startScreensaver: function() {\n      if (typeof cv.Config.configSettings.screensave_time === 'number') {\n        this.screensave = new qx.event.Timer(cv.Config.configSettings.screensave_time * 1000);\n        this.screensave.addListener(\"interval\", function () {\n          this.scrollToPage();\n        }, this);\n        this.screensave.start();\n        qx.event.Registration.addListener(window, \"useraction\", this.screensave.restart, this.screensave);\n      }\n    },\n\n    /**\n     * Start retrieving data from backend\n     */\n    startInitialRequest: function() {\n      if (qx.core.Environment.get(\"qx.debug\")) {\n        cv.report.Replay.start();\n      }\n      if (cv.Config.enableAddressQueue) {\n        // identify addresses on startpage\n        var startPageAddresses = {};\n        var pageWidget = cv.ui.structure.WidgetFactory.getInstanceById(cv.Config.initialPage);\n        pageWidget.getChildWidgets().forEach(function(child) {\n          var address = child.getAddress ? child.getAddress() : {};\n          for (var addr in address) {\n            if (address.hasOwnProperty(addr)) {\n              startPageAddresses[addr] = 1;\n            }\n          }\n        }, this);\n        this.visu.setInitialAddresses(Object.keys(startPageAddresses));\n      }\n      var addressesToSubscribe = cv.data.Model.getInstance().getAddresses();\n      if (0 !== addressesToSubscribe.length) {\n        this.visu.subscribe(addressesToSubscribe);\n      }\n    },\n\n    /**\n     * Start the parsing process\n     * @param page {Element} XML-configuration element\n     * @param path {String} internal poth\n     * @param flavour {String} inherited flavour\n     * @param type {String} page type (text, 2d, 3d)\n     */\n    createPages: function (page, path, flavour, type) {\n      cv.parser.WidgetParser.renderTemplates(page);\n      var parsedData = cv.parser.WidgetParser.parse(page, path, flavour, type);\n      if (!Array.isArray(parsedData)) {\n        parsedData = [parsedData];\n      }\n      for (var i = 0, l = parsedData.length; i < l; i++) {\n        var data = parsedData[i];\n        var widget = cv.ui.structure.WidgetFactory.createInstance(data.$$type, data);\n\n        // trigger DOM generation\n        if (widget) { widget.getDomString(); }\n      }\n    },\n\n    /**\n     * Returns the id of the page the given path is associated to\n     * @param page_name {String}\n     * @param path {String}\n     * @return {String}\n     */\n    getPageIdByPath: function (page_name, path) {\n      if (page_name === null) { return null; }\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } else {\n        if (path !== undefined) {\n          var scope = this.traversePath(path);\n          if (scope === null) {\n            // path is wrong\n            this.error(\"path '\" + path + \"' could not be traversed, no page found\");\n            return null;\n          }\n          return this.getPageIdByName(page_name, scope);\n        } else {\n          return this.getPageIdByName(page_name);\n        }\n      }\n    },\n\n    traversePath: function (path, root_page_id) {\n      var path_scope = null;\n      var index = path.indexOf(\"/\");\n      if (index >= 1) {\n        // skip escaped slashes like \\/\n        while (path.substr(index - 1, 1) === \"\\\\\") {\n          var next = path.indexOf(\"/\", index + 1);\n          if (next >= 0) {\n            index = next;\n          }\n        }\n      }\n      //    console.log(\"traversePath(\"+path+\",\"+root_page_id+\")\");\n      if (index >= 0) {\n        // traverse path one level down\n        var path_page_name = path.substr(0, index);\n        path_scope = this.getPageIdByName(path_page_name, root_page_id);\n        path = path.substr(path_page_name.length + 1);\n        path_scope = this.traversePath(path, path_scope);\n        //      console.log(path_page_name+\"=>\"+path_scope);\n        return path_scope;\n      } else {\n        // bottom path level reached\n        path_scope = this.getPageIdByName(path, root_page_id);\n        return path_scope;\n      }\n    },\n\n    getPageIdByName: function (page_name, scope) {\n      var page_id = null;\n      if (page_name.match(/^id_[0-9_]*$/) !== null) {\n        // already a page_id\n        return page_name;\n      } else {\n        // find Page-ID by name\n        // decode html code (e.g. like &apos; => ')\n        page_name = cv.util.String.decodeHtmlEntities(page_name);\n        // remove escaped slashes\n        page_name = decodeURI(page_name.replace(\"\\\\\\/\", \"/\"));\n\n        //      console.log(\"Page: \"+page_name+\", Scope: \"+scope);\n        var selector = (scope !== undefined && scope !== null) ? '.page[id^=\"' + scope + '\"] h1' : '.page h1';\n        var pages = document.querySelectorAll(selector);\n        pages = Array.from( pages ).filter(function(h){return h.textContent === page_name;});\n        if (pages.length > 1 && this.getCurrentPage() !== null) {\n          var currentPageId = this.getCurrentPage().getPath();\n          // More than one Page found -> search in the current pages descendants first\n          var fallback = true;\n          pages.forEach(function (page) {\n            var p = cv.util.Tree.getClosest(page, \".page\");\n            if (page.innerText === page_name) {\n              var pid = p.getAttribute('id');\n              if (pid.length < currentPageId.length) {\n                // found pages path is shorter the the current pages -> must be an ancestor\n                if (currentPageId.indexOf(pid) === 0) {\n                  // found page is an ancestor of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return false;\n                }\n              } else {\n                if (pid.indexOf(currentPageId) === 0) {\n                  // found page is an descendant of the current page -> we take this one\n                  page_id = pid;\n                  fallback = false;\n                  //break loop\n                  return false;\n                }\n              }\n            }\n          }, this);\n          if (fallback) {\n            // take the first page that fits (old behaviour)\n            pages.forEach(function (page) {\n              if (page.innerText  === page_name) {\n                page_id = cv.util.Tree.getClosest(page, \".page\").getAttribute(\"id\");\n                // break loop\n                return false;\n              }\n            });\n          }\n        } else {\n          pages.forEach(function (page) {\n            if (page.innerText === page_name) {\n              page_id = cv.util.Tree.getClosest(page, \".page\").getAttribute(\"id\");\n              // break loop\n              return false;\n            }\n          });\n        }\n      }\n      if (page_id !== null && page_id.match(/^id_[0-9_]*$/) !== null) {\n        return page_id;\n      } else {\n        // not found\n        return null;\n      }\n    },\n\n    scrollToPage: function (target, speed, skipHistory) {\n      if (undefined === target) {\n        target = cv.Config.configSettings.screensave_page;\n      }\n      var page_id = this.getPageIdByPath(target);\n      if (page_id === null) {\n        return;\n      }\n      if (cv.Config.currentPageId === page_id) {\n        return;\n      }\n      cv.Config.currentPageId = page_id;\n      cv.Config.treePath = page_id;\n\n      if (undefined === speed) {\n        speed = cv.Config.configSettings.scrollSpeed;\n      }\n\n      if (cv.Config.rememberLastPage && qx.core.Environment.get(\"html.storage.local\")) {\n        localStorage.lastpage = page_id;\n      }\n\n      // push new state to history\n      if (skipHistory === undefined) {\n        var headline = document.querySelectorAll(\"#\"+page_id+\" h1\");\n        var pageTitle = \"CometVisu\";\n        if (headline.length) {\n          pageTitle = headline[0].textContent+ \" - \"+pageTitle;\n        }\n        qx.bom.History.getInstance().addToHistory(page_id, pageTitle);\n      }\n\n      this.main_scroll.seekTo(page_id, speed); // scroll to it\n\n      this.pagePartsHandler.initializeNavbars(page_id);\n      if (cv.Config.mobileDevice) {\n        switch (this.pagePartsHandler.navbars.left.dynamic) {\n          case null:\n          case true:\n            this.pagePartsHandler.fadeNavbar('Left', 'out', 0);\n            break;\n\n          case false:\n            this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n        }\n      } else {\n        this.pagePartsHandler.fadeNavbar('Left', 'in', 0);\n      }\n    },\n\n    selectDesign: function () {\n      var body = document.querySelector(\"body\");\n\n      document.querySelectorAll('body > *').forEach(function(elem) {\n        elem.style.display = 'none';\n      }, this);\n      body.style['background-color'] = \"black\";\n\n\n      var div = qx.dom.Element.create(\"div\", {id: \"designSelector\"});\n      Object.entries({\n        background: \"#808080\",\n        width: \"400px\",\n        color: \"white\",\n        margin: \"auto\",\n        padding: \"0.5em\"\n      }).forEach(function(key_value){body.style[key_value[0]]=key_value[1];});\n      div.innerHTML = \"Loading ...\";\n\n      body.appendChild(div);\n\n      var store = new qx.data.store.Json(qx.util.ResourceManager.getInstance().toUri(\"designs/get_designs.php\"));\n\n      store.addListener(\"loaded\", function () {\n        var html = \"<h1>Please select design</h1>\";\n        html += \"<p>The Location/URL will change after you have chosen your design. Please bookmark the new URL if you do not want to select the design every time.</p>\";\n\n        div.innerHTML = html;\n\n        store.getModel().forEach(function(element) {\n\n          var myDiv = qx.dom.Element.create(\"div\", {\n            cursor: \"pointer\",\n            padding: \"0.5em 1em\",\n            borderBottom: \"1px solid black\",\n            margin: \"auto\",\n            width: \"262px\",\n            position: \"relative\"\n          });\n\n          myDiv.innerHTML = \"<div style=\\\"font-weight: bold; margin: 1em 0 .5em;\\\">Design: \" + element + \"</div>\";\n          myDiv.innerHTML += \"<iframe src=\\\"\"+qx.util.ResourceManager.getInstance().toUri(\"designs/design_preview.html\")+\"?design=\" + element + \"\\\" width=\\\"160\\\" height=\\\"90\\\" border=\\\"0\\\" scrolling=\\\"auto\\\" frameborder=\\\"0\\\" style=\\\"z-index: 1;\\\"></iframe>\";\n          myDiv.innerHTML += \"<img width=\\\"60\\\" height=\\\"30\\\" src=\\\"\"+qx.util.ResourceManager.getInstance().toUri(\"demo/media/arrow.png\")+\"\\\" alt=\\\"select\\\" border=\\\"0\\\" style=\\\"margin: 60px 10px 10px 30px;\\\"/>\";\n\n          div.appendChild(myDiv);\n\n\n          var tDiv = qx.dom.Element.create(\"div\", {\n            background: \"transparent\",\n            position: \"absolute\",\n            height: \"90px\",\n            width: \"160px\",\n            zIndex: 2\n          });\n          var pos = document.querySelector(\"iframe\").getBoundingClientRect();\n          Object.entries({\n            left: pos.left + \"px\",\n            top: pos.top + \"px\"\n          }).forEach(function(key_value){tDiv.style[key_value[0]]=key_value[1];});\n          myDiv.appendChild(tDiv);\n\n          qx.event.Registration.addListener(myDiv, 'pointerover', function() {\n            myDiv.style.background = \"#bbbbbb\";\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'pointerout', function() {\n            myDiv.style.background = \"transparent\";\n          }, this);\n\n          qx.event.Registration.addListener(myDiv, 'tap', function() {\n            var href = document.location.href;\n            if (document.location.hash) {\n              href = href.split('#')[0];\n            }\n            if (document.location.search === \"\") {\n              document.location.href = href + \"?design=\" + element;\n            } else {\n              document.location.href = href + \"&design=\" + element;\n            }\n          });\n        });\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('__activeChangedTimer');\n  }\n});"
  ]
}