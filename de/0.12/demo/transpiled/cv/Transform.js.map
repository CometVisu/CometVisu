{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/Transform.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "statics",
    "registry",
    "name",
    "encode",
    "i",
    "decode",
    "toString",
    "parseInt",
    "parseFloat",
    "addTransform",
    "prefix",
    "transforms",
    "Object",
    "entries",
    "transName",
    "transform",
    "link",
    "assign",
    "clip",
    "min",
    "value",
    "max",
    "encodeBusAndRaw",
    "transformation",
    "cv",
    "Config",
    "testMode",
    "bus",
    "raw",
    "transformParts",
    "split",
    "length",
    "parameter",
    "basetrans",
    "encoding",
    "Transform",
    "constructor"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* Transform.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This class defines some default transformations like <code>raw</code>, <code>int</code> and <code>float</code>.\n * New transformation can be added and used. For example an openHAB transformation for a switch item is added by\n * {@link cv.transforms.OpenHab} like this:\n *\n * <pre class=\"javascript\">\n *   cv.Transform.addTransform('OH', {\n *    'switch': {\n *      name: 'OH_Switch',\n *       encode: function (phy) {\n *         return phy == 1 ? 'ON' : 'OFF';\n *      },\n *\n *       decode: function (string) {\n *         if (cv.transforms.OpenHab.isUndefined(string)) return 0;\n *         return (string == \"ON\" || parseInt(string) > 0) ? 1 : 0;\n *       }\n *     }\n *   });\n * </pre>\n *\n * @author Christian Mayer\n * @since 2010\n */\nqx.Class.define('cv.Transform', {\n  type: \"static\",\n\n  /*\n   ******************************************************\n   STATICS\n   ******************************************************\n   */\n  statics: {\n    registry: {\n      'raw': {\n        name: 'Only the RAW value',\n        encode: function (i) {\n          return i;\n        },\n        decode: function (i) {\n          return i;\n        }\n      },\n      'int': {\n        name: 'Cast to Int',\n        encode: function (i) {\n          return i.toString();\n        },\n        decode: function (i) {\n          return parseInt(i);\n        }\n      },\n      'float': {\n        name: 'Cast to Float',\n        encode: function (i) {\n          return i.toString();\n        },\n        decode: function (i) {\n          return parseFloat(i);\n        }\n      }\n    },\n\n    /* ***************************************************************************\n     * All functions below are only in this, i.e. the default, file.\n     * All further transforms will only have the above data structure.\n     ************************************************************************** */\n\n    /**\n     * Add transformation rules to the registry\n     * @param prefix {String} Transformation prefix (e.g. DPT for KNX transformations or OH for openHAB transformations)\n     * @param transforms {Object} map of transformations\n     */\n    addTransform: function (prefix, transforms) {\n      for (let [transName, transform] of Object.entries(transforms)) {\n        if (transform.link) {\n          this.registry[prefix + ':' + transName] = Object.assign({}, transforms[transform.link], transform);\n        } else {\n          this.registry[prefix + ':' + transName] = transform;\n        }\n      }\n    },\n\n    /**\n     * Enforce that value stays within range\n     * When value is not a valid number, the min value is returned\n     * @param min {Number} lower threshold\n     * @param value {var} value to clip\n     * @param max {Number} upper threshold\n     * @return {Number} the clipped value\n     */\n    clip: function (min, value, max) {\n      value = +value; // enforce number\n      return value > min ? (value > max ? max : value) : min;\n    },\n\n    /**\n     * transform JavaScript to bus value and raw value\n     *\n     * @param transformation {String} type of the transformation\n     * @param value {var} value to transform\n     * @return {Object} object with both encoded values\n     */\n    encodeBusAndRaw: function (transformation, value) {\n      if (cv.Config.testMode === true) {\n        return {bus: value, raw: value};\n      }\n      let\n        transformParts = transformation.split(':'),\n        transform = transformParts.length > 1 ? transformParts[0] + ':' + transformParts[1] : transformation,\n        parameter = transformParts[2],\n        basetrans = transform.split('.')[0];\n      var encoding = transform in cv.Transform.registry\n        ? cv.Transform.registry[transform].encode(value, parameter)\n        : (basetrans in cv.Transform.registry\n          ? cv.Transform.registry[basetrans].encode(value, parameter)\n          : value);\n\n      return encoding.constructor === Object ? encoding : {bus: encoding, raw: encoding};\n    },\n\n    /**\n     * transform JavaScript to bus value\n     *\n     * @param transformation {String} type of the transformation\n     * @param value {var} value to transform\n     * @return {var} the encoded value\n     */\n    encode: function (transformation, value) {\n      return this.encodeBusAndRaw(transformation, value).bus;\n    },\n\n    /**\n     * transform bus to JavaScript value\n     * @param transformation {String} type of the transformation\n     * @param value {var} value to transform\n     * @return {var} the decoded value\n     */\n    decode: function (transformation, value) {\n      if (cv.Config.testMode === true) {\n        return value;\n      }\n      let\n        transformParts = transformation.split(':'),\n        transform = transformParts.length > 1 ? transformParts[0] + ':' + transformParts[1] : transformation,\n        parameter = transformParts[2],\n        basetrans = transform.split('.')[0];\n      return transform in cv.Transform.registry\n        ? cv.Transform.registry[transform].decode(value, parameter)\n        : (basetrans in cv.Transform.registry\n          ? cv.Transform.registry[basetrans].decode(value, parameter)\n          : value);\n    }\n  }\n});"
  ]
}