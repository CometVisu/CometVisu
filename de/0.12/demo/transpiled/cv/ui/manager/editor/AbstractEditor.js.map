{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/AbstractEditor.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "implement",
    "cv",
    "manager",
    "editor",
    "IEditor",
    "IActionHandler",
    "type",
    "construct",
    "_initClient",
    "properties",
    "file",
    "check",
    "nullable",
    "apply",
    "event",
    "content",
    "handlerOptions",
    "external",
    "init",
    "ready",
    "members",
    "_handledActions",
    "canHandleAction",
    "actionName",
    "getFile",
    "isWriteable",
    "includes",
    "handleAction",
    "save",
    "configureButton",
    "button",
    "unConfigureButton",
    "_client",
    "io",
    "rest",
    "Client",
    "getFsClient",
    "_applyHandlerOptions",
    "_loadFile",
    "old",
    "message",
    "Bus",
    "unsubscribe",
    "getBusTopic",
    "_onChange",
    "getType",
    "getContent",
    "setContent",
    "_loadFromFs",
    "subscribe",
    "resetContent",
    "readSync",
    "path",
    "getFullPath",
    "err",
    "res",
    "snackbar",
    "Controller",
    "error",
    "ev",
    "data",
    "getData",
    "source",
    "_applyContent",
    "getCurrentContent",
    "_handleSaveResponse",
    "tr",
    "info",
    "_onSaved",
    "dispatchByName",
    "callback",
    "overrideHash",
    "isModified",
    "isTemporary",
    "createSync",
    "hash",
    "getHash",
    "lang",
    "Function",
    "curry",
    "updateSync",
    "resetModified",
    "resetTemporary",
    "showErrors",
    "errorList",
    "showDecorations",
    "decorators",
    "destruct",
    "AbstractEditor"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * Abstract base class for all editors.\n */\nqx.Class.define('cv.ui.manager.editor.AbstractEditor', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n  type: \"abstract\",\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._initClient();\n  },\n\n  /*\n ***********************************************\n   PROPERTIES\n ***********************************************\n */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      apply: '_loadFile',\n      event: 'changeFile'\n    },\n\n    content: {\n      nullable: true,\n      event: 'changeContent',\n      apply: '_applyContent'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true,\n      apply: '_applyHandlerOptions'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _handledActions: null,\n\n    canHandleAction: function (actionName) {\n      if (actionName === 'save' && this.getFile() && !this.getFile().isWriteable()) {\n        return false;\n      }\n      return this._handledActions && this._handledActions.includes(actionName);\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'save':\n            this.save();\n            break;\n        }\n      }\n    },\n\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getFsClient();\n    },\n\n    _applyHandlerOptions: function () {},\n\n    _loadFile: function (file, old) {\n      if (old) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (file && file.getType() === 'file') {\n        if (file.getContent() !== null) {\n          this.setContent(file.getContent());\n        } else {\n          this._loadFromFs();\n        }\n        qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n      } else {\n        this.resetContent();\n      }\n    },\n\n    _loadFromFs: function () {\n      this._client.readSync({path: this.getFile().getFullPath()}, function (err, res) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          this.setContent(res);\n        }\n      }, this);\n    },\n\n    _onChange: function (ev) {\n      var data = ev.getData();\n      if (data.type === 'fsContentChanged' && data.source !== this) {\n        this.setContent(data.data);\n      }\n    },\n\n    // must be overridden by inheriting classes\n    _applyContent: function() {},\n\n    // must be overridden by inheriting classes\n    getCurrentContent: function () {},\n\n    _handleSaveResponse: function (type, err) {\n      if (err) {\n        cv.ui.manager.snackbar.Controller.error(err);\n      } else {\n        var file = this.getFile();\n        var message = type === 'created' ? this.tr('File has been created') : this.tr('File has been saved')\n        cv.ui.manager.snackbar.Controller.info(message);\n        this._onSaved();\n        qx.event.message.Bus.dispatchByName(file.getBusTopic(), {\n          type: type,\n          file: file,\n          data: this.getCurrentContent(),\n          source: this\n        });\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      var file = this.getFile();\n      if (file.isModified()) {\n        if (file.isTemporary()) {\n          this._client.createSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash(),\n            type: 'file'\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'created'), this);\n        } else {\n          this._client.updateSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash()\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'contentChanged'), this);\n        }\n      }\n    },\n\n    _onSaved: function () {\n      var file = this.getFile();\n      file.resetModified();\n      file.resetTemporary();\n    },\n\n    showErrors: function (path, errorList) {},\n    showDecorations: function (path, decorators) {}\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    if (this._client) {\n      this._client = null;\n    }\n  }\n});\n"
  ]
}