{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "cv",
    "ui",
    "manager",
    "editor",
    "AbstractEditor",
    "construct",
    "_setLayout",
    "layout",
    "Grow",
    "_handledActions",
    "_initWorker",
    "_schema",
    "model",
    "Schema",
    "getInstance",
    "onLoaded",
    "setReady",
    "_draw",
    "__modifiedElements",
    "__modifiedPreviewElements",
    "data",
    "Array",
    "addListener",
    "ev",
    "getData",
    "setPreviewState",
    "structureChanges",
    "some",
    "element",
    "hasChildrenModified",
    "initUnDos",
    "initReDos",
    "__buttonListeners",
    "core",
    "Init",
    "getApplication",
    "getRoot",
    "_onElementKeyUp",
    "_maintainPreviewVisibility",
    "statics",
    "SUPPORTED_FILES",
    "TITLE",
    "locale",
    "Manager",
    "tr",
    "ICON",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "Allowed",
    "NONE",
    "BEFORE",
    "AFTER",
    "INSIDE",
    "FIRST_CHILD",
    "properties",
    "appearance",
    "refine",
    "init",
    "expert",
    "check",
    "ready",
    "selected",
    "nullable",
    "event",
    "apply",
    "clipboard",
    "unDos",
    "deferredInit",
    "reDos",
    "autoRefreshPreview",
    "previewState",
    "showPreview",
    "dragging",
    "members",
    "_workerWrapper",
    "__editing",
    "__searchResults",
    "__searchResultIndex",
    "isPreviewSynced",
    "getPreviewState",
    "_applyHandlerOptions",
    "handlerOptions",
    "getHandlerOptions",
    "setShowPreview",
    "bom",
    "Viewport",
    "getWidth",
    "noPreview",
    "_applyShowPreview",
    "value",
    "getChildControl",
    "setVisibility",
    "clearLayoutProperties",
    "updateLayoutProperties",
    "noStretch",
    "setLayoutProperties",
    "flex",
    "getFile",
    "preview",
    "previewConfig",
    "FileItem",
    "getParent",
    "setFile",
    "_updatePreview",
    "handleAction",
    "actionName",
    "canHandleAction",
    "undo",
    "redo",
    "_onCut",
    "_onCopy",
    "_onPaste",
    "_showHelp",
    "configureButton",
    "actionId",
    "button",
    "getUnDos",
    "length",
    "setEnabled",
    "setToolTipText",
    "getItem",
    "getTitle",
    "resetToolTipText",
    "getReDos",
    "bind",
    "converter",
    "isDeletable",
    "unConfigureButton",
    "removeListenerById",
    "removeRelatedBindings",
    "addUndo",
    "elementChange",
    "ElementChange",
    "push",
    "pop",
    "error",
    "clearUnDosReDos",
    "removeAll",
    "forEach",
    "elem",
    "dispose",
    "clearReDos",
    "_applyClipboard",
    "navigator",
    "writeText",
    "getNode",
    "outerHTML",
    "e",
    "Worker",
    "showErrors",
    "path",
    "errorList",
    "showDecorations",
    "decorators",
    "_loadFile",
    "file",
    "old",
    "close",
    "getType",
    "isSupported",
    "hasChildControl",
    "resetFile",
    "resetPreviewState",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "container",
    "Composite",
    "HBox",
    "_add",
    "Canvas",
    "addAt",
    "VBox",
    "isShowPreview",
    "exclude",
    "viewer",
    "Config",
    "set",
    "target",
    "minWidth",
    "ok",
    "noSync",
    "notOk",
    "basic",
    "Atom",
    "setRich",
    "setWrap",
    "label",
    "icon",
    "removeState",
    "addState",
    "toolbar",
    "Button",
    "_onEdit",
    "add",
    "_onDelete",
    "CheckBox",
    "toggleExpert",
    "ToolBar",
    "top",
    "left",
    "right",
    "form",
    "TextField",
    "liveUpdate",
    "placeholder",
    "margin",
    "util",
    "Function",
    "debounce",
    "_onSearch",
    "getKeyIdentifier",
    "_showNextResult",
    "_showPreviousResult",
    "stopPropagation",
    "tree",
    "VirtualTree",
    "selectionMode",
    "width",
    "openMode",
    "itemHeight",
    "Environment",
    "get",
    "_initDragDrop",
    "setDelegate",
    "createItem",
    "item",
    "VirtualElementItem",
    "_onContextMenu",
    "_onContextMenuAction",
    "bindItem",
    "controller",
    "index",
    "bindProperty",
    "bindPropertyReverse",
    "getSelection",
    "_onChangeTreeSelection",
    "bottom",
    "setDraggable",
    "setMarginLeft",
    "setZIndex",
    "setAppearance",
    "getSelected",
    "_onCreate",
    "qxl",
    "dialog",
    "Dialog",
    "alert",
    "Widget",
    "setDecorator",
    "decoration",
    "Decorator",
    "widthTop",
    "styleTop",
    "colorTop",
    "setHeight",
    "setOpacity",
    "setDroppable",
    "contextmenu",
    "ConfigElement",
    "getCurrentTarget",
    "getModel",
    "replace",
    "setSelected",
    "menu",
    "setElement",
    "openAtPointer",
    "getBubbles",
    "stop",
    "action",
    "added",
    "resetSelected",
    "openByQuerySelector",
    "selector",
    "edit",
    "Promise",
    "resolve",
    "reject",
    "rootNode",
    "result",
    "querySelector",
    "__showSearchResult",
    "from",
    "querySelectorAll",
    "filter",
    "el",
    "tagName",
    "startsWith",
    "hasAttribute",
    "getAttribute",
    "firstMatch",
    "$$widget",
    "openNodeAndParents",
    "current",
    "ancestors",
    "parentElement",
    "load",
    "i",
    "p",
    "draggedXmlElement",
    "dragTarget",
    "getDragTarget",
    "setDragging",
    "isEditable",
    "preventDefault",
    "addAction",
    "addType",
    "addData",
    "addButton",
    "Tree",
    "accepted",
    "mode",
    "getCurrentAction",
    "supportsType",
    "addNew",
    "getTarget",
    "indicator",
    "debug",
    "isAncestor",
    "layerContent",
    "getPane",
    "getLayers",
    "getContentLocation",
    "getDocumentTop",
    "lastElem",
    "document",
    "elementFromPoint",
    "Math",
    "round",
    "getWidgetByElement",
    "isAnonymous",
    "getLayoutParent",
    "parent",
    "parentSchemaElement",
    "getSchemaElement",
    "allowedElements",
    "getAllowedElements",
    "Object",
    "keys",
    "addable",
    "getAddableChildren",
    "areChildrenSortable",
    "acc",
    "allowedSorting",
    "getAllowedElementsSorting",
    "elementName",
    "__getAllowedPositions",
    "getName",
    "isChildElementAllowed",
    "lookInside",
    "getFirstLevelElementSorting",
    "targetPosition",
    "undefined",
    "getChildren",
    "firstChild",
    "maxPosition",
    "firstChildPosition",
    "expandTimer",
    "lastTreeItem",
    "treeContainer",
    "onDrag",
    "position",
    "cursor",
    "getManager",
    "getCursor",
    "DragDropCursor",
    "_native",
    "pointerType",
    "hasState",
    "origElem",
    "getDocumentLeft",
    "orig",
    "skipDetection",
    "origCoords",
    "leftPos",
    "spacer",
    "_getChildren",
    "getPaddingLeft",
    "setWidth",
    "getBounds",
    "lastCoords",
    "distance",
    "isOpen",
    "getUserData",
    "setDomPosition",
    "Timer",
    "once",
    "openNode",
    "setUserData",
    "getAction",
    "resetAction",
    "console",
    "assert",
    "setAction",
    "onDrop",
    "clone",
    "getDisplayName",
    "moveAfter",
    "snackbar",
    "Controller",
    "info",
    "insertAfter",
    "moveBefore",
    "insertBefore",
    "moveInside",
    "insertChild",
    "onDragEnd",
    "resetUserData",
    "resetDragging",
    "children",
    "sorting",
    "minPosition",
    "targetIndex",
    "indexOf",
    "found",
    "sibling",
    "name",
    "hasOwnProperty",
    "typeChooserForm",
    "ElementForm",
    "allowCancel",
    "context",
    "message",
    "formData",
    "type",
    "help",
    "options",
    "sort",
    "a",
    "b",
    "localeCompare",
    "map",
    "validation",
    "required",
    "show",
    "promise",
    "then",
    "ownerDocument",
    "isElement",
    "createComment",
    "createTextNode",
    "createCDATASection",
    "createElement",
    "schemaElement",
    "getSchemaElementForElementName",
    "initChildren",
    "requiredChildren",
    "getRequiredElements",
    "schema",
    "Element",
    "sortChildNodes",
    "childName",
    "child",
    "appendChild",
    "isTextContentRequired",
    "xmlElement",
    "XmlElement",
    "getEditor",
    "res",
    "isShowEditButton",
    "setSelection",
    "err",
    "targetName",
    "depth",
    "currentPosition",
    "split",
    "test",
    "parseInt",
    "min",
    "__checkProvider",
    "provider",
    "Provider",
    "getLive",
    "userInputAllowed",
    "includes",
    "endsWith",
    "isArray",
    "unshift",
    "__getAttributeFormDefinition",
    "attribute",
    "docs",
    "getDocumentation",
    "def",
    "join",
    "enabled",
    "getDefaultValue",
    "isOptional",
    "validator",
    "ListItem",
    "getValue",
    "isValueValid",
    "ValidationError",
    "getTypeString",
    "enums",
    "getEnumeration",
    "isNew",
    "isWriteable",
    "title",
    "caption",
    "getShowEditButton",
    "typeElement",
    "nodeType",
    "Node",
    "ELEMENT_NODE",
    "allowed",
    "getAllowedAttributes",
    "getExpert",
    "appInfo",
    "getAppinfo",
    "parser",
    "DOMParser",
    "attrName",
    "nodeName",
    "lines",
    "autoSize",
    "innerHTML",
    "dom",
    "parseFromString",
    "getElementsByTagName",
    "TEXT_NODE",
    "COMMENT_NODE",
    "CDATA_SECTION_NODE",
    "getTextContent",
    "isTextNode",
    "convertTextNodeType",
    "newNodeName",
    "formDialog",
    "maxWidth",
    "setAttributes",
    "validate",
    "destroy",
    "remove",
    "execCommand",
    "setClipboard",
    "copy",
    "clipboardElement",
    "getClipboard",
    "resetClipboard",
    "updateModified",
    "previewIndex",
    "$$removed",
    "splice",
    "isModified",
    "setModified",
    "_onContentChanged",
    "_createChildControl",
    "addSeparator",
    "addSpacer",
    "_applySelected",
    "_updateHighlightWidget",
    "node",
    "parentNode",
    "openPage",
    "setHighlightWidget",
    "getWidgetPath",
    "isVisible",
    "_applyContent",
    "open",
    "initialValidation",
    "modified",
    "validateXmlConfig",
    "getPath",
    "__loadContent",
    "Main",
    "closeFile",
    "Bus",
    "dispatchByName",
    "getFullPath",
    "handler",
    "jumpToError",
    "hide",
    "resetModel",
    "errors",
    "xml",
    "Document",
    "fromString",
    "getElementNode",
    "documentElement",
    "setEditable",
    "getWriteable",
    "setModel",
    "setContentPaddingBottom",
    "isTemporary",
    "parts",
    "substr",
    "part",
    "shift",
    "match",
    "exec",
    "toString",
    "setValid",
    "content",
    "getCurrentContent",
    "contentChanged",
    "isAutoRefreshPreview",
    "reset",
    "previewFile",
    "_client",
    "updateSync",
    "getBusTopic",
    "source",
    "fast",
    "XMLSerializer",
    "serializeToString",
    "_prettify",
    "level",
    "singleton",
    "tabs",
    "fill",
    "newLine",
    "textContent",
    "trim",
    "String",
    "escape",
    "output",
    "attributes",
    "childNodes",
    "onlyOneTextChild",
    "_onSaved",
    "onSaved",
    "focusedWidget",
    "FocusHandler",
    "getFocusedWidget",
    "dialogConf",
    "modal",
    "image",
    "maxHeight",
    "getHeight",
    "BigAlert",
    "destruct",
    "_disposeArray",
    "removeListener"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n    this._initWorker();\n\n    // init schema\n    this._schema = cv.ui.manager.model.Schema.getInstance('visu_config.xsd');\n    this._schema.onLoaded(function () {\n      this.setReady(true);\n      this._draw();\n    }, this);\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', (ev) => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    }, this);\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener(\"keyup\", this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schema: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n\n    isPreviewSynced: function () {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions: function () {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility: function () {\n      const handlerOptions = this.getHandlerOptions();\n      this.setShowPreview(qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview));\n    },\n\n    _applyShowPreview: function (value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({flex: 1});\n        }\n      }\n      if (value && this.getFile()) {\n        const preview = this.getChildControl('preview');\n        if (!preview.getFile()) {\n          const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', this.getFile().getParent());\n          preview.setFile(previewConfig);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'undo':\n            if (!this.__editing) {\n              this.undo();\n            }\n            break;\n\n          case 'redo':\n            if (!this.__editing) {\n              this.redo();\n            }\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            if (!this.__editing) {\n              this._showHelp();\n            }\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr(\"Undo: %1\", this.getUnDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr(\"Undo: %1\", this.getReDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return value ? !value.isDeletable() : false;\n            }\n          })\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          })\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          })\n          break;\n      }\n    },\n    unConfigureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo: function (elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo: function () {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error(\"could not undo \" + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo: function () {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error(\"could not redo \" + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos: function () {\n      this.getUnDos().removeAll().forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos: function () {\n      this.getReDos().removeAll().forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard: function (value) {\n      try {\n        if (value) {\n          navigator.clipboard.writeText(value.getNode().outerHTML);\n        } else {\n          navigator.clipboard.writeText('');\n        }\n      } catch (e) {\n        // clipboard api is only available in secure environment, copying to clipboards only use case\n        // here is that it can be pasted in the source editor. And because that also only works when the clipboard\n        // api is available we fail silently here.\n      }\n    },\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors: function (path, errorList) {\n    },\n    showDecorations: function (path, decorators) {\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        this.base(arguments, file, old);\n      } else {\n        this.base(arguments, null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n       var control;\n\n       switch (id) {\n         case 'splitpane':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this._add(control);\n           break;\n\n         case 'left':\n           control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n           this.getChildControl('splitpane').addAt(control, 0);\n           break;\n\n         case 'right':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n           if (!this.isShowPreview()) {\n             control.exclude();\n           }\n           this.getChildControl('splitpane').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview':\n           control = new cv.ui.manager.viewer.Config();\n           control.set({\n             target: 'iframe',\n             minWidth: 600\n           });\n           this.getChildControl('right').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview-sync-hint':\n           const ok = this.tr(\"Preview shows the current state of the edited configuration.\");\n           const noSync = this.tr(\"Preview is out of sync. Click here to refresh.\");\n           const notOk = this.tr(\"Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.\");\n           control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n           control.setRich(true);\n           control.getChildControl('label').setWrap(true);\n           control.addListener(\"tap\", () => {\n             if (!this.isPreviewSynced() && this.isShowPreview()) {\n               this._updatePreview();\n             }\n           }, this);\n           this.getChildControl('right').addAt(control, 0);\n           this.addListener('previewStateChanged', (ev) => {\n             switch (ev.getData()) {\n               case 'synced':\n               control.set({\n                 label: ok,\n                 icon: cv.theme.dark.Images.getIcon('valid', 16)\n               });\n               control.getChildControl(\"icon\").removeState('error');\n                 control.getChildControl(\"icon\").removeState('warning');\n               break;\n\n               case 'changed':\n                 control.set({\n                   label: noSync,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl(\"icon\").removeState('error');\n                 control.getChildControl(\"icon\").addState('warning');\n                 break;\n\n               case 'structureChanged':\n                 control.set({\n                   label: notOk,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl(\"icon\").addState('error');\n                 control.getChildControl(\"icon\").removeState('warning');\n                 break;\n             }\n           }, this);\n           break;\n\n         case 'edit-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n           control.setEnabled(false);\n           control.addListener('execute', this._onEdit, this);\n           this.bind(\"file.writeable\", control, 'icon', {\n             converter: function (value) {\n               return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16)\n             }\n           })\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n           control.setEnabled(false);\n           control.addListener('execute', this._onDelete, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toggle-expert':\n           control = new qx.ui.toolbar.CheckBox(this.tr(\"Expertview\"),\n             cv.theme.dark.Images.getIcon('expert', 16));\n           control.addListener('execute', function () {\n             this.toggleExpert();\n           }, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'refresh-preview':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n           control.setToolTipText(this.tr(\"Reload preview\"));\n           control.addListener('execute', this._updatePreview, this);\n           this.bind('showPreview', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'hidden'\n             }\n           });\n           this.bind('previewState', control, 'enabled', {\n             converter: function (value) {\n               return value !== 'synced';\n             }\n           })\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toolbar':\n           control = new qx.ui.toolbar.ToolBar();\n           this.getChildControl('left').add(control, {\n             top: 0,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar-container':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this.getChildControl('left').add(control, {\n             top: 36,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             placeholder: this.tr(\"Search...\"),\n             margin: 8\n           });\n           control.addListener(\"changeValue\", qx.util.Function.debounce(this._onSearch, 250), this);\n           control.addListener(\"keyup\", function (ev) {\n             switch (ev.getKeyIdentifier()) {\n               case 'Enter':\n               case 'Down':\n                 this._showNextResult();\n                 break;\n               case 'Up':\n                 this._showPreviousResult();\n                 break;\n             }\n             ev.stopPropagation();\n           }, this);\n           this.getChildControl('searchbar-container').add(control, {flex: 1});\n           break;\n\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n           control.set({\n             selectionMode: 'single',\n             width: 350,\n             openMode: 'none',\n             itemHeight: qx.core.Environment.get(\"device.touch\") ? 40 : 20\n           });\n           this.bind(\"file.writeable\", control, \"droppable\");\n           this.bind(\"file.writeable\", control, \"draggable\");\n           this._initDragDrop(control);\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualElementItem();\n               if (!qx.core.Environment.get(\"device.touch\")) {\n                 item.addListener('contextmenu', this._onContextMenu, this);\n               } else {\n                 item.addListener('action', this._onContextMenuAction, this);\n               }\n               item.addListener('dbltap', this._onEdit, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem: function (controller, item, index) {\n               controller.bindProperty(\"\", \"model\", null, item, index);\n               controller.bindProperty(\"displayName\", \"label\", null, item, index);\n               controller.bindProperty(\"name\", \"name\", null, item, index);\n               controller.bindPropertyReverse(\"open\", \"open\", null, item, index);\n               controller.bindProperty(\"open\", \"open\", null, item, index);\n               controller.bindProperty(\"showEditButton\", \"editable\", null, item, index);\n               controller.bindProperty(\"sortable\", \"sortable\", null, item, index);\n               controller.bindProperty(\"icon\", \"icon\", null, item, index);\n               controller.bindProperty(\"status\", 'status', null, item, index);\n               controller.bindProperty(\"invalidMessage\", \"toolTipText\", null, item, index);\n               controller.bindProperty(\"dragging\", \"dragging\", null, item, index);\n             }\n           });\n           control.getSelection().addListener(\"change\", this._onChangeTreeSelection, this);\n           this.getChildControl('left').add(control, {\n             top: 72,\n             left: 0,\n             right: 0,\n             bottom: 0\n           });\n           break;\n\n         case 'add-button':\n           control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n           control.setDraggable(true);\n           control.setMarginLeft(-16);\n           control.setZIndex(20);\n           this.addListener('changeDragging', ev => {\n             control.setLayoutProperties({\n               bottom: 16,\n               left: ev.getData() ? -1000 : \"50%\"\n             });\n           }, this);\n           control.setAppearance(\"round-button\");\n           control.addListener(\"pointerover\", () => control.addState(\"hovered\"));\n           control.addListener(\"pointerout\", () => control.removeState(\"hovered\"));\n           control.addListener(\"tap\", () => {\n             if (this.getSelected()) {\n               this._onCreate(this.getSelected(), 'inside');\n             } else {\n               qxl.dialog.Dialog.alert(this.tr(\"Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.\"));\n             }\n           }, this);\n           this.getChildControl(\"left\").add(control, {\n             bottom: 16,\n             left: \"50%\"\n           });\n           break;\n\n         case 'drag-indicator':\n           // Create drag indicator\n           control = new qx.ui.core.Widget();\n           control.setDecorator(new qx.ui.decoration.Decorator().set({\n             widthTop: 1,\n             styleTop: \"solid\",\n             colorTop: \"white\"\n           }));\n           control.setHeight(0);\n           control.setOpacity(0.5);\n           control.setZIndex(100);\n           control.setDroppable(true);\n           control.setLayoutProperties({left: -1000, top: -1000});\n           qx.core.Init.getApplication().getRoot().add(control);\n           break;\n\n         case 'context-menu':\n           control = new cv.ui.manager.contextmenu.ConfigElement(this);\n           control.addListener('action', this._onContextMenuAction, this);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    _onContextMenu: function (ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction: function (ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, \"inside\");\n            break;\n\n          default:\n            this.error(\"unhandled context menu action\", data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n\n    openByQuerySelector: function (selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch: function (ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || el.hasAttribute(\"name\") && el.getAttribute(\"name\").startsWith(value);\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult: function () {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult: function () {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult: function () {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length-1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop: function (control) {\n      let draggedXmlElement;\n      control.addListener(\"dragstart\", function (ev) {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction(\"copy\");\n          if (element.isDeletable()) {\n            ev.addAction(\"move\");\n          }\n          ev.addType(\"cv/tree-element\");\n          ev.addData(\"cv/tree-element\", element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      }, this);\n\n      const addButton = this.getChildControl(\"add-button\");\n      addButton.addListener(\"dragstart\", function (ev) {\n        ev.addAction(\"copy\");\n        ev.addType(\"cv/new-tree-element\");\n        this.setDragging(true);\n      }, this);\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      }\n\n      control.addListener(\"dragover\", function (ev) {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType(\"cv/tree-element\")) {\n          element = ev.getData(\"cv/tree-element\");\n        }\n        const addNew = action === \"copy\" && !element && ev.supportsType(\"cv/new-tree-element\");\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug(\"dragging over indicator\");\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem ) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug(\"dropping on same element forbidden\");\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug(\"moving inside own subtree forbidden\");\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && (ev.getDocumentTop() - layerContent.bottom <= 20)) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(Math.round((layerContent.left + layerContent.right) / 2), layerContent.bottom - 20);\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug(\"drop target not found\");\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug(\"drop not allowed here, no drag element\");\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n                    if ((acc & Allowed.BEFORE) && (acc & Allowed.AFTER)) {\n                      // we cannot find more\n                      return true;\n                    }\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug(\"no children allowed here\");\n            }\n          } else {\n            if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n              // not allowed on this level\n              accepted.mode = Allowed.NONE;\n              this.debug(\"not allowed as child element of\", parent.getName());\n            } else if (parentSchemaElement.areChildrenSortable()) {\n              // children can be put anywhere\n              // so this is allowed anywhere\n              accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n            } else {\n              // check position\n              accepted.mode = this.__getAllowedPositions(parentSchemaElement.getAllowedElementsSorting(), element.getName(), model.getName());\n            }\n          }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug(\"dropping not accepted here\");\n        }\n      }, this);\n\n      const indicator = this.getChildControl(\"drag-indicator\");\n\n      let expandTimer;\n\n      control.addListener(\"dragleave\", function (ev) {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      }, this);\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = \"\";\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = \"after\";\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if ((ev.getDocumentTop() - origCoords.top) <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = \"before\";\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = \"inside\";\n              }\n            } else if ((origCoords.bottom - ev.getDocumentTop()) <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = \"after\";\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = \"inside\";\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = \"first-child\";\n                } else {\n                  this.debug(\"not allowed as first child\");\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData(\"position\") !== \"first-child\") {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = \"first-child\";\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = \"inside\";\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(function () {\n                    if (accepted.target) {\n                      control.openNode(accepted.target);\n                    }\n                  }, this, 1000);\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData(\"position\", position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData(\"action\", ev.getCurrentAction());\n          cursor.resetAction();\n          console.assert(left < 0);\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData(\"action\")) {\n          cursor.setAction(indicator.getUserData(\"action\"));\n          indicator.setUserData(\"action\", null);\n        }\n      }\n      control.addListener(\"drag\", onDrag, this);\n      addButton.addListener(\"drag\", onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction()\n        let element = ev.supportsType(\"cv/tree-element\") ? ev.getData(\"cv/tree-element\") : null;\n        if (action === \"copy\") {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = \"add\";\n          }\n        }\n        const elementName = element ? element.getDisplayName() : \"new\";\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData(\"position\")) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, \"after\", target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", action, elementName, \"after\", target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, \"before\", target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", action, elementName, \"after\", target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, \"into\", target.getDisplayName(), \"as first child\");\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", elementName, \"into\", target.getDisplayName() + \" as first child\");\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, \"into\", target.getDisplayName(), \"as child\");\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData(\"position\"));\n                  break;\n              }\n            } else {\n              this.debug(\"NOT ALLOWED\", elementName, \"into\", target.getDisplayName(), \"as child\");\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener(\"drop\", onDrop, this);\n      indicator.addListener(\"drop\", onDrop, this);\n\n      const onDragEnd = function(ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener(\"dragend\", onDragEnd, this);\n      addButton.addListener(\"dragend\", onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate: function (target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex-1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(name => sorting.hasOwnProperty(name) && sorting[name] <= maxPosition && sorting[name] >= minPosition);\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr(\"<p style='font-weight:bold'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>\"),\n            formData: {\n              type: {\n                type: \"SelectBox\",\n                label: this.tr(\"Choose element\"),\n                help: this.tr(\"Please choose the element you want to add here.\"),\n                options: addable.sort((a, b) => {\n                  if (a.startsWith('#') && !b.startsWith('#')) {\n                    return 1;\n                  } else if (!a.startsWith('#') && b.startsWith('#')) {\n                    return -1;\n                  }\n                  return a.localeCompare(b);\n                }).map(name => ({label: name, value: name})),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          }).show().promise();\n        } else {\n          typeChooserForm = Promise.resolve({type: addable[0]});\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment(\"\");\n                break;\n\n              case '#text':\n                element = document.createTextNode(\"\");\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection(\"\");\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode(\"-\");\n                element.appendChild(child);\n              }\n            }\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement, true);\n            }\n            res.then((data) => {\n              if (data) {\n                // finally insert the new node\n                switch (position) {\n                  case 'before':\n                    xmlElement.insertBefore(target);\n                    break;\n\n                  case 'after':\n                    xmlElement.insertAfter(target);\n                    break;\n\n                  case 'inside':\n                    target.insertChild(xmlElement, -1, false, 'added');\n                    break;\n\n                  case 'first-child':\n                    target.insertChild(xmlElement, 0, false, 'added');\n                    break;\n                }\n                this.getChildControl('tree').openNodeAndParents(xmlElement);\n                this.getChildControl('tree').setSelection([xmlElement]);\n              }\n            }, this).catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions: function (allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === \"string\") {\n          currentPosition = currentPosition.split(\".\").map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === \"string\") {\n          targetPosition = targetPosition.split(\".\").map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length)\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n        return cv.ui.manager.editor.Tree.Allowed.NONE;\n      }\n    },\n\n    __checkProvider: function (id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error(\"misconfigured provider found for \" + id);\n        }\n        formData.type = provider.userInputAllowed ? \"VirtualComboBox\" : \"VirtualSelectBox\";\n      } else if ([\"mapping\", \"styling\"].includes(id.split(\"@\").pop())) {\n        const type = id.split(\"@\").pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = \"SelectBox\";\n        formData.options = [];\n        rootNode.querySelectorAll(\"meta > \" + type + \"s > \" + type).forEach(element => {\n          const name = element.getAttribute(\"name\");\n          formData.options.push({label: name, value: name});\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options.then(res => {\n              if (Array.isArray(res)) {\n                res.unshift({label: \" - \" + this.tr(\"not set\") + \" - \", value: \"\"})\n              }\n            }).catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({label: \" - \" + this.tr(\"not set\") + \" - \", value: \"\"});\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition: function (element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: \"TextField\",\n        label: attribute.getName(),\n        placeholder: \" - \" + this.tr(\"not set\") + \" - \",\n        help: docs.join(\"<br/>\"),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator: function (value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr(\"This is not a valid value.\"));\n            }\n          }\n        }\n      }\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = \"CheckBox\";\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string':\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = \"SelectBox\";\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({label: name, value: name});\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({label: \" - \" + this.tr(\"not set\") + \" - \", value: \"\"});\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + \"@\" + attribute.getName(), def, element.getNode());\n          }\n          break;\n      }\n      return def;\n    },\n\n    _onEdit: function (ev, element, isNew) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return;\n      }\n      let title, caption;\n      if (!element) {\n        if (this.getSelected()) {\n          element = this.getSelected();\n        } else {\n          return;\n        }\n      }\n      if (!element.getShowEditButton()) {\n        return;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (isNew) {\n        title = this.tr(\"Create new %1 element\", element.getName());\n        caption = this.tr(\"Please edit the attributes of the new %1 element, that will be added to the chosen position.\", element.getName());\n      } else {\n        title = this.tr(\"Edit element attributes\");\n        caption = element.isEditable() ? this.tr(\"Edit %1\", element.getName()) : this.tr(\"Show %1\", element.getName());\n      }\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n        if (typeElement.isChildElementAllowed('*')) {\n          const parser = new DOMParser();\n          const attrName = element.getNode().nodeName === 'custom' ? '#innerHTML' : '#outerHTML';\n          if (isNew) {\n            title = this.tr(\"Create new %1 element\", element.getName());\n            caption = this.tr(\"Please edit the content of the new %1 element, that will be added to the chosen position.\", element.getName());\n          } else {\n            title = attrName === '#outerHTML' ? this.tr(\"Edit element and content\") : this.tr(\"Edit element content\");\n          }\n          formData[attrName] = {\n            type: \"TextArea\",\n            label: \"\",\n            lines: 5,\n            autoSize: true,\n            width: Math.min(qx.bom.Viewport.getWidth(), 500),\n            enabled: element.isEditable(),\n            value: attrName === '#outerHTML' ? element.getNode().outerHTML : element.getNode().innerHTML,\n            validation: {\n              validator: function (value) {\n                if (value) {\n                  const dom = parser.parseFromString(value, \"text/xml\");\n                  if (dom.getElementsByTagName('parsererror').length > 0) {\n                    throw new qx.core.ValidationError(qx.locale.Manager.tr(\"This is not a valid value.\"));\n                  }\n                }\n              }\n            }\n          }\n        }\n      } else if (element.getNode().nodeType === Node.TEXT_NODE || element.getNode().nodeType === Node.COMMENT_NODE || element.getNode().nodeType === Node.CDATA_SECTION_NODE) {\n        title = this.tr(\"Edit text content\", element.getName());\n        caption = \"\";\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: \"TextArea\",\n          label: \"\",\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr(\"not set\"),\n          help: docs.join(\"<br/>\"),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator: function (value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr(\"This is not a valid value.\"));\n              }\n            }\n          }\n        }\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute(\"type\");\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(element.getParent().getName() + \"@\" + element.getName(), formData[nodeName], element.getNode());\n      }\n      this.__editing = true;\n\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption:  title,\n        message: caption,\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          if (!data.hasOwnProperty('#outerHTML') && !data.hasOwnProperty('#innerHTML')) {\n            element.validate();\n          }\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete: function (ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n    },\n\n    _onCut: function () {\n      if (this.__editing) {\n        document.execCommand(\"cut\");\n      } else {\n        const element = this._onDelete();\n        if (element) {\n          this.setClipboard(element);\n        }\n      }\n    },\n\n    _onCopy: function () {\n      if (this.__editing) {\n        document.execCommand(\"copy\");\n      } else {\n        const element = this.getSelected();\n        if (element) {\n          const copy = element.clone();\n          this.setClipboard(copy);\n        }\n      }\n    },\n\n    _onPaste: function () {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified: function (element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else {\n        if (element.isModified()) {\n          if (index === -1) {\n            this.__modifiedElements.push(element);\n          }\n          if (previewIndex === -1) {\n            this.__modifiedPreviewElements.push(element);\n          }\n        } else {\n          if (index >= 0) {\n            this.__modifiedElements.splice(index, 1);\n          }\n          if (previewIndex >= 0) {\n            this.__modifiedPreviewElements.splice(index, 1);\n          }\n        }\n      }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw: function () {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget: function () {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          while (node && node.nodeName !== 'pages') {\n            if (node.nodeName === 'page') {\n              path.unshift(node.getAttribute(\"name\"));\n            }\n            node = node.parentNode;\n          }\n          if (path.length > 0) {\n            preview.openPage(path.pop(), path.join(\"/\"));\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp: function(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === \"Enter\") {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent: function(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + \" is a valid config file\");\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n              dialog.addListener('action', (ev) => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source':\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: \"cv.ui.manager.editor.Source\",\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n                    break;\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n                dialog.hide();\n                dialog.destroy();\n              }, this);\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __loadContent: function (value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const document = qx.xml.Document.fromString(value);\n        const schemaElement = this._schema.getElementNode(document.documentElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(document.documentElement, schemaElement, this);\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n          // extra space für add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (!preview.getFile()) {\n            const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', file.getParent());\n            preview.setFile(previewConfig);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split(\"/\");\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error(\"Error loading \" + current.getName() + \": \" + e.toString());\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error(\"patch segment format error: \" + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      }\n    },\n\n    _onContentChanged: function () {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview: function (ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        this._client.updateSync({\n          path: previewFile.getFullPath(),\n          hash: 'ignore'\n        }, content, () => {\n          qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n            type: 'contentChanged',\n            file: previewFile,\n            data: content,\n            source: this\n          });\n          this.__modifiedPreviewElements.removeAll();\n          this.resetPreviewState();\n        }, this);\n      }\n    },\n\n    getCurrentContent: function (fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        } else {\n          // prettify content\n          return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n` + this._prettify(rootNode, 0);\n        }\n      } else {\n        return null;\n      }\n    },\n\n    _prettify: function (node, level, singleton) {\n      let tabs = Array(level + 1).fill('').join('\\t')\n      let newLine = '\\n';\n      if (node.nodeType === Node.TEXT_NODE) {\n        if (node.textContent.trim()) {\n          return (singleton ? '' : tabs) + qx.xml.String.escape(node.textContent.trim()) + (singleton ? '' : newLine);\n        } else {\n          return '';\n        }\n      }\n      if (node.nodeType === Node.COMMENT_NODE) {\n        return (singleton ? '' : tabs) + `<!--${node.textContent}--> ${(singleton ? '' : newLine)}`;\n      } else if (node.nodeType === Node.CDATA_SECTION_NODE) {\n        return (singleton ? '' : tabs) + `<![CDATA[${node.textContent}]]> ${(singleton ? '' : newLine)}`;\n      }\n      if (!node.tagName) {\n        return this._prettify(node.firstChild, level);\n      }\n      let output = tabs + `<${node.tagName}`; // >\\n\n      for (let i = 0; i < node.attributes.length; i++) {\n        output += ` ${node.attributes[i].name}=\"${node.attributes[i].value}\"`;\n      }\n      if (node.childNodes.length === 0) {\n        return output + ' />' + newLine;\n      } else {\n        output += '>';\n      }\n      let onlyOneTextChild = ((node.childNodes.length === 1) && (node.childNodes[0].nodeType === 3));\n      if (!onlyOneTextChild) {\n        output += newLine;\n      }\n      for (let i = 0; i < node.childNodes.length; i++) {\n        output += this._prettify(node.childNodes[i], level + 1, onlyOneTextChild);\n      }\n      return output + (onlyOneTextChild ? '' : tabs) + `</${node.tagName}>` + newLine;\n    },\n\n    _onSaved: function () {\n      this.base(arguments);\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported: function (file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp: function () {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr(\"Help\"),\n        modal: true,\n        image: \"qxl.dialog.icon.info\",\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: \"\"\n      }\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr(\"<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with 'Enter' or the 'Down' key. Accordingly you can jump the the previous found element \\\nwith the 'Up' key.</p>\");\n      } else {\n        // show general help\n        dialogConf.message = this.tr(\"<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the 'edit'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the 'edit'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the 'add child'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the 'Expertview'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>\");\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._schema = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener(\"keyup\", this._onElementKeyUp, this);\n  }\n});\n"
  ]
}