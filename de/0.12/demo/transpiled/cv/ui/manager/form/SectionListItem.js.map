{
  "version": 3,
  "sources": [
    "/home/travis/build/CometVisu/CometVisu/source/class/cv/ui/manager/form/SectionListItem.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "construct",
    "grid",
    "layout",
    "Grid",
    "setColumnFlex",
    "setColumnAlign",
    "_setLayout",
    "_createChildControl",
    "properties",
    "appearance",
    "refine",
    "init",
    "model",
    "check",
    "nullable",
    "apply",
    "modified",
    "event",
    "events",
    "members",
    "_listController",
    "_originalName",
    "_originalOptions",
    "_applyModel",
    "value",
    "old",
    "nameField",
    "getChildControl",
    "__unbindModel",
    "bind",
    "getName",
    "getOptions",
    "forEach",
    "option",
    "addListener",
    "__checkForModification",
    "getKey",
    "getValue",
    "length",
    "emptyOption",
    "cv",
    "manager",
    "config",
    "Option",
    "push",
    "removeRelatedBindings",
    "removeListener",
    "getModel",
    "setModified",
    "Object",
    "keys",
    "some",
    "hasOwnProperty",
    "_onDeleteOption",
    "ev",
    "getData",
    "options",
    "resetKey",
    "resetValue",
    "removed",
    "remove",
    "_onAddOption",
    "_createChildControlImpl",
    "id",
    "control",
    "basic",
    "Label",
    "tr",
    "_add",
    "row",
    "column",
    "form",
    "TextField",
    "set",
    "liveUpdate",
    "required",
    "Button",
    "theme",
    "dark",
    "Images",
    "getIcon",
    "setToolTipText",
    "fireDataEvent",
    "List",
    "setEnableInlineFind",
    "data",
    "controller",
    "setNullValueTitle",
    "setAllowNull",
    "setDelegate",
    "createItem",
    "OptionListItem",
    "configureItem",
    "item",
    "bindItem",
    "index",
    "bindProperty",
    "destruct",
    "_disposeObjects",
    "SectionListItem"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * This widgets shows and editable config section in a list.\n */\nqx.Class.define('cv.ui.manager.form.SectionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    var grid = new qx.ui.layout.Grid(8, 8);\n    grid.setColumnFlex(1, 1);\n    grid.setColumnAlign(0, 'left', 'top');\n    this._setLayout(grid);\n    this._createChildControl('section-title');\n    this._createChildControl('list');\n    this._createChildControl('delete');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-section'\n    },\n\n    model: {\n      check: \"cv.ui.manager.model.config.Section\",\n      nullable: false,\n      apply: '_applyModel'\n    },\n\n    modified:{\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'delete': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n    _originalName: null,\n    _originalOptions: null,\n\n    _applyModel: function (value, old) {\n      var nameField = this.getChildControl('name');\n      this.__unbindModel(old);\n      if (value) {\n        value.bind('name', nameField, 'value');\n        this._originalName = value.getName();\n        this._originalOptions = {};\n        value.getOptions().forEach(function (option) {\n          option.addListener('change', this.__checkForModification, this);\n          this._originalOptions[option.getKey()] = option.getValue();\n        }, this);\n        nameField.bind('value', value, 'name');\n        value.addListener('changeName', this.__checkForModification, this);\n        value.bind('options', this._listController, 'model');\n        // add at least one empty entry, when there are no options\n        if (value.getOptions().length === 0) {\n          var emptyOption = new cv.ui.manager.model.config.Option('', '')\n          value.getOptions().push(emptyOption);\n        }\n      } else {\n        this._originalName = null;\n        this._originalOptions = null;\n      }\n    },\n\n    __unbindModel: function (model) {\n      if (model) {\n        var nameField = this.getChildControl('name');\n        if (this._listController) {\n          model.removeRelatedBindings(this._listController);\n        }\n        model.removeListener('changeName', this.__checkForModification, this);\n        model.removeRelatedBindings(nameField);\n        nameField.removeRelatedBindings(model);\n        model.getOptions().forEach(function (option) {\n          option.removeListener('change', this.__checkForModification, this);\n        }, this);\n      }\n    },\n\n    __checkForModification: function () {\n      if (this._originalName !== this.getModel().getName()) {\n        this.setModified(true);\n        return;\n      }\n      // check if the still have the same the same amount of options\n      if (Object.keys(this._originalOptions).length !== this.getModel().getOptions().length) {\n        this.setModified(true);\n        return;\n      }\n      // compare options one by one\n      var modified = this.getModel().getOptions().some(function (option) {\n        return (!this._originalOptions.hasOwnProperty(option.getKey()) ||\n          this._originalOptions[option.getKey()] !== option.getValue()\n        );\n      }, this);\n      this.setModified(modified);\n    },\n\n    _onDeleteOption: function (ev) {\n      var option = ev.getData();\n      var options = this.getModel().getOptions();\n      if (options.length === 1) {\n        // do not delete the last option, just reset its values\n        option.resetKey();\n        option.resetValue();\n      } else {\n        var removed = this.getModel().getOptions().remove(option);\n        if (removed) {\n          removed.removeListener('change', this.__checkForModification, this);\n        }\n      }\n      this.__checkForModification();\n    },\n\n    _onAddOption: function () {\n      var option = new cv.ui.manager.model.config.Option('', '');\n      option.addListener('change', this.__checkForModification, this);\n      this.getModel().getOptions().push(option);\n      this.__checkForModification();\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n       var control;\n\n       switch (id) {\n         case 'section-title':\n           control = new qx.ui.basic.Label(this.tr('Section'));\n           this._add(control, {row: 0, column: 0});\n           break;\n\n         case 'name':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             required: true\n           });\n           this._add(control, {row: 0, column: 1});\n           break;\n\n         case 'delete':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n           control.setToolTipText(this.tr('Delete section'));\n           control.addListener('execute', function() {\n             this.fireDataEvent('delete', this.getModel());\n           }, this);\n           this._add(control, {row: 0, column: 2});\n           break;\n\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(null, control);\n           this._listController.setNullValueTitle('header');\n           this._listController.setAllowNull(true);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.OptionListItem();\n             },\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteOption, this);\n               item.addListener('add', this._onAddOption, this);\n             }.bind(this),\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n             }\n           });\n           this._add(control, {row: 1, column: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_listController');\n  }\n});\n"
  ]
}