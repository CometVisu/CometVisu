{
  "version": 3,
  "sources": [
    "/home/runner/work/CometVisu/CometVisu/source/class/cv/ConfigCache.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "statics",
    "_cacheKey",
    "_parseCacheData",
    "_valid",
    "replayCache",
    "__initPromise",
    "DB",
    "init",
    "Promise",
    "resolve",
    "reject",
    "cv",
    "ConfigCache",
    "request",
    "indexedDB",
    "open",
    "onsuccess",
    "ev",
    "log",
    "Logger",
    "debug",
    "result",
    "onerror",
    "event",
    "Error",
    "onupgradeneeded",
    "db",
    "target",
    "error",
    "objectStore",
    "createObjectStore",
    "keyPath",
    "createIndex",
    "unique",
    "dump",
    "xml",
    "hash",
    "model",
    "data",
    "Model",
    "getInstance",
    "save",
    "toHash",
    "VERSION",
    "Version",
    "REV",
    "JSON",
    "stringify",
    "getWidgetDataModel",
    "addresses",
    "getAddressList",
    "configSettings",
    "Config",
    "config",
    "configSuffix",
    "body",
    "document",
    "querySelector",
    "innerHTML",
    "restore",
    "getData",
    "then",
    "cache",
    "mappings",
    "Object",
    "keys",
    "forEach",
    "name",
    "mapping",
    "formulaSource",
    "formula",
    "Function",
    "mobileDevice",
    "classList",
    "add",
    "hasMobile",
    "stylesToLoad",
    "some",
    "style",
    "endsWith",
    "push",
    "clientDesign",
    "filter",
    "setWidgetDataModel",
    "setAddressList",
    "widgetsToInitialize",
    "widgetId",
    "$$initOnCacheLoad",
    "length",
    "TemplateEngine",
    "addListenerOnce",
    "widgetData",
    "ui",
    "structure",
    "WidgetFactory",
    "createInstance",
    "$$type",
    "transaction",
    "put",
    "key",
    "dataRequest",
    "get",
    "parse",
    "bind",
    "isCached",
    "cacheVersion",
    "isValid",
    "cachedHash",
    "hashCode",
    "XMLSerializer",
    "serializeToString",
    "clear",
    "string",
    "Array",
    "prototype",
    "reduce",
    "split",
    "a",
    "b",
    "charCodeAt",
    "i",
    "l",
    "character"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAAA,EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACAH,EAAAA,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,gBAAhB,EAAkC;AAChCC,IAAAA,IAAI,EAAE,QAD0B;;AAGhC;AACF;AACA;AACA;AACA;AACEC,IAAAA,OAAO,EAAE;AACPC,MAAAA,SAAS,EAAG,MADL;AAEPC,MAAAA,eAAe,EAAG,IAFX;AAGPC,MAAAA,MAAM,EAAG,IAHF;AAIPC,MAAAA,WAAW,EAAE,IAJN;AAKPC,MAAAA,QAAa,EAAE,IALR;AAMPC,MAAAA,EAAE,EAAE,IANG;AAQPC,MAAAA,IAAI,EAAE,gBAAY;AAChB,YAAI,CAAC,KAAKF,QAAV,EAAyB;AACvB,eAAKA,QAAL,GAAqB,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpD,gBAAI,CAACC,EAAE,CAACC,WAAH,CAAeN,EAApB,EAAwB;AACtB,kBAAMO,OAAO,GAAGC,SAAS,CAACC,IAAV,CAAe,SAAf,EAA0B,CAA1B,CAAhB;;AACAF,cAAAA,OAAO,CAACG,SAAR,GAAoB,UAAUC,EAAV,EAAc;AAChCxB,gBAAAA,EAAE,CAACyB,GAAH,CAAOC,MAAP,CAAcC,KAAd,CAAoBT,EAAE,CAACC,WAAvB,EAAoC,+CAApC;AACAD,gBAAAA,EAAE,CAACC,WAAH,CAAeN,EAAf,GAAoBO,OAAO,CAACQ,MAA5B;;AAEAV,gBAAAA,EAAE,CAACC,WAAH,CAAeN,EAAf,CAAkBgB,OAAlB,GAA4B,UAAUC,KAAV,EAAiB;AAC3Cb,kBAAAA,MAAM,CAAC,IAAIc,KAAJ,CAAU,6CAAV,CAAD,CAAN;AACD,iBAFD;;AAGAf,gBAAAA,OAAO,CAACE,EAAE,CAACC,WAAH,CAAeN,EAAhB,CAAP;AACD,eARD;;AASAO,cAAAA,OAAO,CAACY,eAAR,GAA0B,UAAUF,KAAV,EAAiB;AACzC,oBAAMG,EAAE,GAAGH,KAAK,CAACI,MAAN,CAAaN,MAAxB;;AAEAK,gBAAAA,EAAE,CAACJ,OAAH,GAAa,UAAUC,KAAV,EAAiB;AAC5B9B,kBAAAA,EAAE,CAACyB,GAAH,CAAOC,MAAP,CAAcS,KAAd,CAAoBjB,EAAE,CAACC,WAAvB,EAAoC,yBAApC;AACD,iBAFD;;AAGA,oBAAMiB,WAAW,GAAGH,EAAE,CAACI,iBAAH,CAAqB,MAArB,EAA6B;AAACC,kBAAAA,OAAO,EAAE;AAAV,iBAA7B,CAApB;AACAF,gBAAAA,WAAW,CAACG,WAAZ,CAAwB,QAAxB,EAAkC,QAAlC,EAA4C;AAACC,kBAAAA,MAAM,EAAE;AAAT,iBAA5C;AACD,eARD;AASD,aApBD,MAoBO;AACLxB,cAAAA,OAAO,CAACE,EAAE,CAACC,WAAH,CAAeN,EAAhB,CAAP;AACD;AACF,WAxBoB,CAArB;AAyBD;;AACD,eAAO,KAAKD,QAAZ;AACD,OArCM;AAuCP6B,MAAAA,IAAI,EAAE,cAASC,GAAT,EAAcC,IAAd,EAAoB;AACxB,YAAMC,KAAK,GAAG1B,EAAE,CAAC2B,IAAH,CAAQC,KAAR,CAAcC,WAAd,EAAd;AACA,aAAKC,IAAL,CAAU;AACRL,UAAAA,IAAI,EAAEA,IAAI,IAAI,KAAKM,MAAL,CAAYP,GAAZ,CADN;AAERQ,UAAAA,OAAO,EAAEhC,EAAE,CAACiC,OAAH,CAAWD,OAFZ;AAGRE,UAAAA,GAAG,EAAElC,EAAE,CAACiC,OAAH,CAAWC,GAHR;AAIRP,UAAAA,IAAI,EAAEQ,IAAI,CAACC,SAAL,CAAeV,KAAK,CAACW,kBAAN,EAAf,CAJE;AAKRC,UAAAA,SAAS,EAAEZ,KAAK,CAACa,cAAN,EALH;AAMRC,UAAAA,cAAc,EAAEL,IAAI,CAACC,SAAL,CAAepC,EAAE,CAACyC,MAAH,CAAUD,cAAzB,CANR;AAORE,UAAAA,MAAM,EAAE1C,EAAE,CAACyC,MAAH,CAAUE,YAAV,KAA2B,IAA3B,GAAkC,MAAlC,GAA2C3C,EAAE,CAACyC,MAAH,CAAUE,YAPrD;AAQRC,UAAAA,IAAI,EAAEC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+BC;AAR7B,SAAV;AAUD,OAnDM;AAqDPC,MAAAA,OAAO,EAAE,mBAAW;AAAA;;AAClB,YAAMJ,IAAI,GAAGC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAb;AACA,YAAMpB,KAAK,GAAG1B,EAAE,CAAC2B,IAAH,CAAQC,KAAR,CAAcC,WAAd,EAAd;AACA,aAAKoB,OAAL,GAAeC,IAAf,CAAoB,UAAAC,KAAK,EAAI;AAC3BnD,UAAAA,EAAE,CAACyC,MAAH,CAAUD,cAAV,GAA2BW,KAAK,CAACX,cAAjC,CAD2B,CAE3B;;AACA,cAAIxC,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyBY,QAA7B,EAAuC;AACrCC,YAAAA,MAAM,CAACC,IAAP,CAAYtD,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyBY,QAArC,EAA+CG,OAA/C,CAAuD,UAAUC,IAAV,EAAgB;AACrE,kBAAMC,OAAO,GAAGzD,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyBY,QAAzB,CAAkCI,IAAlC,CAAhB;;AACA,kBAAIC,OAAO,IAAIA,OAAO,CAACC,aAAvB,EAAsC;AACpCD,gBAAAA,OAAO,CAACE,OAAR,GAAkB,IAAIC,QAAJ,CAAa,GAAb,EAAkB,WAAWH,OAAO,CAACC,aAAnB,GAAmC,aAArD,CAAlB,CADoC,CACmD;AACxF;AACF,aALD,EAKG,KALH;AAMD;;AACD,cAAI1D,EAAE,CAACyC,MAAH,CAAUoB,YAAd,EAA4B;AAC1BhB,YAAAA,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+BgB,SAA/B,CAAyCC,GAAzC,CAA6C,QAA7C;AACA,gBAAMC,SAAS,GAAGhE,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyByB,YAAzB,CAAsCC,IAAtC,CAA2C,UAAAC,KAAK;AAAA,qBAAIA,KAAK,CAACC,QAAN,CAAe,YAAf,CAAJ;AAAA,aAAhD,CAAlB;;AACA,gBAAI,CAACJ,SAAL,EAAgB;AACdhE,cAAAA,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyByB,YAAzB,CAAsCI,IAAtC,CAA2C,aAAarE,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyB8B,YAAtC,GAAqD,aAAhG;AACD;AACF,WAND,MAMO;AACL;AACAtE,YAAAA,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyByB,YAAzB,GAAwCjE,EAAE,CAACyC,MAAH,CAAUD,cAAV,CAAyByB,YAAzB,CAAsCM,MAAtC,CAA6C,UAAAJ,KAAK;AAAA,qBAAI,CAACA,KAAK,CAACC,QAAN,CAAe,YAAf,CAAL;AAAA,aAAlD,CAAxC;AACD;;AACD1C,UAAAA,KAAK,CAAC8C,kBAAN,CAAyBrB,KAAK,CAACxB,IAA/B;AACAD,UAAAA,KAAK,CAAC+C,cAAN,CAAqBtB,KAAK,CAACb,SAA3B;AACA,cAAMoC,mBAAmB,GAAGrB,MAAM,CAACC,IAAP,CAAYH,KAAK,CAACxB,IAAlB,EAAwB4C,MAAxB,CAA+B,UAAUI,QAAV,EAAoB;AAC7E,mBAAOxB,KAAK,CAACxB,IAAN,CAAWgD,QAAX,EAAqBC,iBAArB,KAA2C,IAAlD;AACD,WAF2B,CAA5B;;AAGA,cAAIF,mBAAmB,CAACG,MAApB,GAA6B,CAAjC,EAAoC;AAClC7E,YAAAA,EAAE,CAAC8E,cAAH,CAAkBjD,WAAlB,GAAgCkD,eAAhC,CAAgD,aAAhD,EAA+D,YAAY;AACzEL,cAAAA,mBAAmB,CAACnB,OAApB,CAA4B,UAAUoB,QAAV,EAAoB;AAC9C,oBAAMK,UAAU,GAAG7B,KAAK,CAACxB,IAAN,CAAWgD,QAAX,CAAnB;AACA3E,gBAAAA,EAAE,CAACiF,EAAH,CAAMC,SAAN,CAAgBC,aAAhB,CAA8BC,cAA9B,CAA6CJ,UAAU,CAACK,MAAxD,EAAgEL,UAAhE;AACD,eAHD;AAID,aALD,EAKG,KALH;AAMD;;AACDpC,UAAAA,IAAI,CAACG,SAAL,GAAiBI,KAAK,CAACP,IAAvB;AACA9D,UAAAA,EAAE,CAACyB,GAAH,CAAOC,MAAP,CAAcC,KAAd,CAAoB,KAApB,EAA0B,6BAA1B;AACD,SApCD;AAqCD,OA7FM;AA+FPqB,MAAAA,IAAI,EAAE,cAASH,IAAT,EAAe;AACnB,YAAMT,WAAW,GAAGlB,EAAE,CAACC,WAAH,CAAeN,EAAf,CAAkB2F,WAAlB,CAA8B,CAAC,MAAD,CAA9B,EAAwC,WAAxC,EAAqDpE,WAArD,CAAiE,MAAjE,CAApB;AACAA,QAAAA,WAAW,CAACqE,GAAZ,CAAgB5D,IAAhB;AACD,OAlGM;AAoGPsB,MAAAA,OAAO;AAAA,+EAAE,iBAAeuC,GAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,mDACA,IAAI3F,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,wBAAI,CAAC,MAAI,CAACR,eAAV,EAA2B;AACzB,0BAAM2B,WAAW,GAAGlB,EAAE,CAACC,WAAH,CAAeN,EAAf,CAAkB2F,WAAlB,CAA8B,CAAC,MAAD,CAA9B,EAAwC,UAAxC,EAAoDpE,WAApD,CAAgE,MAAhE,CAApB;AACA,0BAAMuE,WAAW,GAAGvE,WAAW,CAACwE,GAAZ,CAAgB1F,EAAE,CAACyC,MAAH,CAAUE,YAAV,KAA2B,IAA3B,GAAkC,MAAlC,GAA2C3C,EAAE,CAACyC,MAAH,CAAUE,YAArE,CAApB;;AACA8C,sBAAAA,WAAW,CAACpF,SAAZ,GAAwB,UAASO,KAAT,EAAgB;AACtC,4BAAI,CAAC6E,WAAW,CAAC/E,MAAjB,EAAyB;AACvBZ,0BAAAA,OAAO,CAAC,IAAD,CAAP;AACD,yBAFD,MAEO;AACL,+BAAKP,eAAL,GAAuBkG,WAAW,CAAC/E,MAAnC,CADK,CAEL;;AACA,+BAAKnB,eAAL,CAAqBoC,IAArB,GAA4BQ,IAAI,CAACwD,KAAL,CAAW,KAAKpG,eAAL,CAAqBoC,IAAhC,CAA5B;AACA,+BAAKpC,eAAL,CAAqBiD,cAArB,GAAsCL,IAAI,CAACwD,KAAL,CAAW,KAAKpG,eAAL,CAAqBiD,cAAhC,CAAtC;;AACA,8BAAIgD,GAAJ,EAAS;AACP1F,4BAAAA,OAAO,CAAC,KAAKP,eAAL,CAAqBiG,GAArB,CAAD,CAAP;AACD,2BAFD,MAEO;AACL1F,4BAAAA,OAAO,CAAC,KAAKP,eAAN,CAAP;AACD;AACF;AACF,uBAduB,CActBqG,IAdsB,CAcjB,MAdiB,CAAxB;AAeD,qBAlBD,MAkBO,IAAIJ,GAAJ,EAAS;AACd1F,sBAAAA,OAAO,CAAC,MAAI,CAACP,eAAL,CAAqBiG,GAArB,CAAD,CAAP;AACD,qBAFM,MAEA;AACL1F,sBAAAA,OAAO,CAAC,MAAI,CAACP,eAAN,CAAP;AACD;AACF,mBAxBM,CADA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SApGA;;AAgIP;AACJ;AACA;AACIsG,MAAAA,QAAQ;AAAA,gFAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACF7F,EAAE,CAACC,WAAH,CAAeL,IAAf,EADE;;AAAA;AAAA;AAAA,yBAEW,KAAKqD,OAAL,EAFX;;AAAA;AAEFtB,kBAAAA,IAFE;;AAAA,sBAGHA,IAHG;AAAA;AAAA;AAAA;;AAAA,oDAIC,KAJD;;AAAA;AAMR;AACMmE,kBAAAA,YAPE,GAOanE,IAAI,CAACK,OAAL,GAAe,GAAf,GAAqBL,IAAI,CAACO,GAPvC;AAQRpD,kBAAAA,EAAE,CAACyB,GAAH,CAAOC,MAAP,CAAcC,KAAd,CAAoB,IAApB,EAA0B,qBAAmBqF,YAAnB,GAAgC,gBAAhC,GAAiD9F,EAAE,CAACiC,OAAH,CAAWD,OAA5D,GAAsE,GAAtE,GAA4EhC,EAAE,CAACiC,OAAH,CAAWC,GAAjH;AARQ,oDASA4D,YAAY,KAAK9F,EAAE,CAACiC,OAAH,CAAWD,OAAX,GAAqB,GAArB,GAA2BhC,EAAE,CAACiC,OAAH,CAAWC,GATvD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SAnID;AA+IP6D,MAAAA,OAAO;AAAA,+EAAE,kBAAevE,GAAf,EAAoBC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAEH,KAAKjC,MAAL,KAAgB,IAFb;AAAA;AAAA;AAAA;;AAAA;AAAA,yBAGoB,KAAKyD,OAAL,CAAa,MAAb,CAHpB;;AAAA;AAGC+C,kBAAAA,UAHD;;AAIL,sBAAI,CAACA,UAAL,EAAiB;AACf,yBAAKxG,MAAL,GAAc,KAAd;AACD,mBAFD,MAEO;AACL,wBAAI,CAACiC,IAAL,EAAW;AACTA,sBAAAA,IAAI,GAAG,KAAKM,MAAL,CAAYP,GAAZ,CAAP;AACD;;AACD1C,oBAAAA,EAAE,CAACyB,GAAH,CAAOC,MAAP,CAAcC,KAAd,CAAoB,IAApB,EAA0B,oBAAoBgB,IAApB,GAA2B,mBAA3B,GAAiDuE,UAAjD,GAA8D,GAAxF;AACA,yBAAKxG,MAAL,GAAciC,IAAI,KAAKuE,UAAvB;AACD;;AAZI;AAAA,oDAcA,KAAKxG,MAdL;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SA/IA;AAgKPuC,MAAAA,MAAM,EAAE,gBAASP,GAAT,EAAc;AACpB,eAAO,KAAKyE,QAAL,CAAe,IAAIC,aAAJ,EAAD,CAAsBC,iBAAtB,CAAwC3E,GAAxC,CAAd,CAAP;AACD,OAlKM;AAoKP4E,MAAAA,KAAK,EAAE,eAASzD,YAAT,EAAuB;AAC5BA,QAAAA,YAAY,GAAGA,YAAY,KAAK3C,EAAE,CAACyC,MAAH,CAAUE,YAAV,KAA2B,IAA3B,GAAkC,MAAlC,GAA2C3C,EAAE,CAACyC,MAAH,CAAUE,YAA1D,CAA3B;AACA,YAAMzB,WAAW,GAAGlB,EAAE,CAACC,WAAH,CAAeN,EAAf,CAAkB2F,WAAlB,CAA8B,CAAC,MAAD,CAA9B,EAAwC,WAAxC,EAAqDpE,WAArD,CAAiE,MAAjE,CAApB;AACA,YAAMuE,WAAW,GAAGvE,WAAW,UAAX,CAAmByB,YAAnB,CAApB;;AACA8C,QAAAA,WAAW,CAACpF,SAAZ,GAAwB,YAAY;AAClCvB,UAAAA,EAAE,CAACyB,GAAH,CAAOC,MAAP,CAAcC,KAAd,CAAoB,eAAekC,YAAf,GAA8B,SAAlD;AACD,SAFD;AAGD,OA3KM;;AA6KP;AACJ;AACA;AACA;AACIsD,MAAAA,QAAQ,EAAE,kBAASI,MAAT,EAAgB;AACxB,YAAIC,KAAK,CAACC,SAAN,CAAgBC,MAApB,EAA2B;AACzB,iBAAOH,MAAM,CAACI,KAAP,CAAa,EAAb,EAAiBD,MAAjB,CAAwB,UAASE,CAAT,EAAWC,CAAX,EAAa;AAACD,YAAAA,CAAC,GAAE,CAACA,CAAC,IAAE,CAAJ,IAAOA,CAAR,GAAWC,CAAC,CAACC,UAAF,CAAa,CAAb,CAAb;AAA6B,mBAAOF,CAAC,GAACA,CAAT;AAAY,WAA/E,EAAgF,CAAhF,CAAP;AACD;;AACD,YAAIjF,IAAI,GAAG,CAAX;;AACA,YAAI4E,MAAM,CAACxB,MAAP,KAAkB,CAAtB,EAAyB;AACvB,iBAAOpD,IAAP;AACD;;AACD,aAAK,IAAIoF,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGT,MAAM,CAACxB,MAA3B,EAAmCgC,CAAC,GAAGC,CAAvC,EAA0CD,CAAC,EAA3C,EAA+C;AAC7C,cAAIE,SAAS,GAAIV,MAAM,CAACO,UAAP,CAAkBC,CAAlB,CAAjB;AACApF,UAAAA,IAAI,GAAK,CAACA,IAAI,IAAE,CAAP,IAAUA,IAAX,GAAiBsF,SAAzB;AACAtF,UAAAA,IAAI,GAAGA,IAAI,GAAGA,IAAd,CAH6C,CAGzB;AACrB;;AACD,eAAOA,IAAP;AACD;AA/LM;AARuB,GAAlC;AA1BAzB,EAAAA,EAAE,CAACC,WAAH,CAAehB,aAAf,GAA+BA,aAA/B",
  "sourcesContent": [
    "/* ConfigCache.js \n * \n * copyright (c) 2010-2017, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Handles caches for cometvisu configs\n *\n * @author Tobias BrÃ¤utigam\n * @since 0.10.0\n */\nqx.Class.define('cv.ConfigCache', {\n  type: \"static\",\n  \n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    _cacheKey : \"data\",\n    _parseCacheData : null,\n    _valid : null,\n    replayCache: null,\n    __initPromise: null,\n    DB: null,\n\n    init: function () {\n      if (!this.__initPromise) {\n        this.__initPromise = new Promise((resolve, reject) => {\n          if (!cv.ConfigCache.DB) {\n            const request = indexedDB.open(\"cvCache\", 1);\n            request.onsuccess = function (ev) {\n              qx.log.Logger.debug(cv.ConfigCache, \"Success creating/accessing IndexedDB database\");\n              cv.ConfigCache.DB = request.result;\n\n              cv.ConfigCache.DB.onerror = function (event) {\n                reject(new Error(\"Error creating/accessing IndexedDB database\"))\n              };\n              resolve(cv.ConfigCache.DB);\n            }\n            request.onupgradeneeded = function (event) {\n              const db = event.target.result;\n\n              db.onerror = function (event) {\n                qx.log.Logger.error(cv.ConfigCache, \"Error loading database.\");\n              };\n              const objectStore = db.createObjectStore(\"data\", {keyPath: \"config\"});\n              objectStore.createIndex(\"config\", \"config\", {unique: true});\n            };\n          } else {\n            resolve(cv.ConfigCache.DB);\n          }\n        });\n      }\n      return this.__initPromise;\n    },\n    \n    dump: function(xml, hash) {\n      const model = cv.data.Model.getInstance();\n      this.save({\n        hash: hash || this.toHash(xml),\n        VERSION: cv.Version.VERSION,\n        REV: cv.Version.REV,\n        data: JSON.stringify(model.getWidgetDataModel()),\n        addresses: model.getAddressList(),\n        configSettings: JSON.stringify(cv.Config.configSettings),\n        config: cv.Config.configSuffix === null ? 'NULL' : cv.Config.configSuffix,\n        body: document.querySelector('body').innerHTML\n      });\n    },\n\n    restore: function() {\n      const body = document.querySelector(\"body\");\n      const model = cv.data.Model.getInstance();\n      this.getData().then(cache => {\n        cv.Config.configSettings = cache.configSettings;\n        // restore formulas\n        if (cv.Config.configSettings.mappings) {\n          Object.keys(cv.Config.configSettings.mappings).forEach(function (name) {\n            const mapping = cv.Config.configSettings.mappings[name];\n            if (mapping && mapping.formulaSource) {\n              mapping.formula = new Function('x', 'var y;' + mapping.formulaSource + '; return y;'); // jshint ignore:line\n            }\n          }, this);\n        }\n        if (cv.Config.mobileDevice) {\n          document.querySelector('body').classList.add('mobile');\n          const hasMobile = cv.Config.configSettings.stylesToLoad.some(style => style.endsWith('mobile.css'));\n          if (!hasMobile) {\n            cv.Config.configSettings.stylesToLoad.push(\"designs/\" + cv.Config.configSettings.clientDesign + \"/mobile.css\");\n          }\n        } else {\n          // do not load mobile css\n          cv.Config.configSettings.stylesToLoad = cv.Config.configSettings.stylesToLoad.filter(style => !style.endsWith('mobile.css'));\n        }\n        model.setWidgetDataModel(cache.data);\n        model.setAddressList(cache.addresses);\n        const widgetsToInitialize = Object.keys(cache.data).filter(function (widgetId) {\n          return cache.data[widgetId].$$initOnCacheLoad === true;\n        });\n        if (widgetsToInitialize.length > 0) {\n          cv.TemplateEngine.getInstance().addListenerOnce('changeReady', function () {\n            widgetsToInitialize.forEach(function (widgetId) {\n              const widgetData = cache.data[widgetId];\n              cv.ui.structure.WidgetFactory.createInstance(widgetData.$$type, widgetData);\n            })\n          }, this);\n        }\n        body.innerHTML = cache.body;\n        qx.log.Logger.debug(this, \"content restored from cache\");\n      });\n    },\n    \n    save: function(data) {\n      const objectStore = cv.ConfigCache.DB.transaction([\"data\"], \"readwrite\").objectStore('data');\n      objectStore.put(data);\n    },\n    \n    getData: async function(key) {\n      return new Promise((resolve, reject) => {\n        if (!this._parseCacheData) {\n          const objectStore = cv.ConfigCache.DB.transaction([\"data\"], \"readonly\").objectStore('data');\n          const dataRequest = objectStore.get(cv.Config.configSuffix === null ? 'NULL' : cv.Config.configSuffix);\n          dataRequest.onsuccess = function(event) {\n            if (!dataRequest.result) {\n              resolve(null);\n            } else {\n              this._parseCacheData = dataRequest.result;\n              // parse stringified data\n              this._parseCacheData.data = JSON.parse(this._parseCacheData.data);\n              this._parseCacheData.configSettings = JSON.parse(this._parseCacheData.configSettings);\n              if (key) {\n                resolve(this._parseCacheData[key]);\n              } else {\n                resolve(this._parseCacheData);\n              }\n            }\n          }.bind(this);\n        } else if (key) {\n          resolve(this._parseCacheData[key]);\n        } else {\n          resolve(this._parseCacheData);\n        }\n      });\n    },\n    \n    /**\n     * Returns true if there is an existing cache for the current config file\n     */\n    isCached: async function() {\n      await cv.ConfigCache.init();\n      const data = await this.getData();\n      if (!data) {\n        return false;\n      }\n      // compare versions\n      const cacheVersion = data.VERSION + '|' + data.REV;\n      qx.log.Logger.debug(this, \"Cached version: \"+cacheVersion+\", CV-Version: \"+cv.Version.VERSION + '|' + cv.Version.REV);\n      return (cacheVersion === cv.Version.VERSION + '|' + cv.Version.REV);\n    },\n    \n    isValid: async function(xml, hash) {\n      // cache the result, as the config stays the same until next reload\n      if (this._valid === null) {\n        const cachedHash = await this.getData(\"hash\");\n        if (!cachedHash) {\n          this._valid = false;\n        } else {\n          if (!hash) {\n            hash = this.toHash(xml);\n          }\n          qx.log.Logger.debug(this, \"Current hash: '\" + hash + \"', cached hash: '\" + cachedHash + \"'\");\n          this._valid = hash === cachedHash;\n        }\n      }\n      return this._valid;\n    },\n    \n    toHash: function(xml) {\n      return this.hashCode((new XMLSerializer()).serializeToString(xml));\n    },\n    \n    clear: function(configSuffix) {\n      configSuffix = configSuffix || (cv.Config.configSuffix === null ? 'NULL' : cv.Config.configSuffix);\n      const objectStore = cv.ConfigCache.DB.transaction([\"data\"], \"readwrite\").objectStore('data');\n      const dataRequest = objectStore.delete(configSuffix);\n      dataRequest.onsuccess = function () {\n        qx.log.Logger.debug('cache for ' + configSuffix + 'cleared');\n      }\n    },\n    \n    /**\n     * @see http://stackoverflow.com/q/7616461/940217\n     * @return {number}\n     */\n    hashCode: function(string){\n      if (Array.prototype.reduce){\n        return string.split(\"\").reduce(function(a,b){a=((a<<5)-a)+b.charCodeAt(0);return a&a;},0);\n      }\n      let hash = 0;\n      if (string.length === 0) {\n        return hash;\n      }\n      for (let i = 0, l = string.length; i < l; i++) {\n        let character  = string.charCodeAt(i);\n        hash  = ((hash<<5)-hash)+character;\n        hash = hash & hash; // Convert to 32bit integer\n      }\n      return hash;\n    }\n  }\n});\n"
  ]
}