{
  "version": 3,
  "sources": [
    "/home/travis/build/CometVisu/CometVisu/external/qooxdoo/framework/source/class/qx/util/DynamicScriptLoader.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "scriptArr",
    "__started",
    "__QUEUE",
    "lang",
    "Type",
    "isString",
    "Array",
    "clone",
    "events",
    "loaded",
    "failed",
    "ready",
    "statics",
    "__IN_PROGRESS",
    "__LOADED",
    "members",
    "start",
    "isDisposed",
    "Error",
    "__loadScripts",
    "DynamicScriptLoader",
    "util",
    "script",
    "dynLoader",
    "id1",
    "id2",
    "uri",
    "loader",
    "shift",
    "fireEvent",
    "fireDataEvent",
    "status",
    "addListener",
    "e",
    "data",
    "getData",
    "removeListenerById",
    "ResourceManager",
    "getInstance",
    "toUri",
    "bom",
    "request",
    "Script",
    "on",
    "onError",
    "open",
    "send",
    "destruct",
    "key",
    "undefined"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2016 Visionet GmbH, http://www.visionet.de\n     2016 OETIKER+PARTNER AG, https://www.oetiker.ch\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Dietrich Streifert (level420)\n     * Tobias Oetiker (oetiker)\n\n************************************************************************ */\n\n\n/**\n * Dynamically load non qx scripts. This class is aware of all scripts that have\n * been loaded using its instances, so if two instances load jquery, it will only\n * be loaded once, and the second instance will wait for the jquery to be loaded\n * before continuing to load additional scripts.\n *\n * Usage example:\n *\n * <pre>\n *  ... assets ...\n * /**\n *  * @asset(myapp/jquery/*)\n *  * @asset(myapp/highcharts/*)\n *  *\n *  * @ignore(jQuery.*)\n *  * @ignore(Highcharts.*)\n *  ...\n *\n *\n *    // in debug mode load the uncompressed unobfuscated scripts\n *    var src = '';\n *    var min = '.min';\n *    if (qx.core.Environment.get(\"qx.debug\")) {\n *      src = '.src';\n *      min = '';\n *    }\n *\n *    // initialize the script loading\n *    var dynLoader = new qx.util.DynamicScriptLoader([\n *        \"myapp/jquery/jquery\"+min+\".js\",\n *        \"myapp/highcharts/highcharts\"+src+\".js\",\n *        \"myapp/highcharts/highcharts-more\"+src+\".js\",\n *        \"myapp/highcharts/highcharts-modifications.js\"\n *    ]);\n *\n *\n *    dynLoader.addListenerOnce('ready',function(e){\n *      console.log(\"all scripts have been loaded!\");\n *    });\n *\n *    dynLoader.addListener('failed',function(e){\n *      var data = e.getData();\n *      console.log(\"failed to load \"+data.script);\n *    });\n *\n *    dynLoader.start();\n *    \n * </pre>\n */\nqx.Class.define(\"qx.util.DynamicScriptLoader\", {\n  extend: qx.core.Object,\n\n  /**\n   * Create a loader for the given scripts.\n   *\n   * @param scriptArr {Array|String} the uri name(s) of the script(s) to load \n   */\n\n  construct: function (scriptArr) {\n    this.base(arguments);\n    this.__started = false;\n    this.__QUEUE = (qx.lang.Type.isString(scriptArr)\n                ? [ scriptArr ]\n                : qx.lang.Array.clone(scriptArr));\n  },\n\n  /*\n  *****************************************************************************\n     EVENTS\n  *****************************************************************************\n  */\n\n  events: {\n    /**\n     * fired when a script is loaded successfully. The data contains 'script' and 'status' keys.\n     */\n    loaded: 'qx.event.type.Data',\n\n    /**\n     * fired when a specific script fails loading.  The data contains 'script' and 'status' keys.\n     */\n    failed: 'qx.event.type.Data',\n\n    /**\n     * fired when all given scripts are loaded, each time loadScriptsDynamic is called.\n     */\n    ready: 'qx.event.type.Event'\n  },\n\n  statics: {\n    /**\n     * Map of scripts being added at the present time. Key is script name; value is instance of this class which\n     * is loading it.\n     */\n    __IN_PROGRESS: {},\n     /**\n      * Map of scripts that have fully loaded. Key is script name; value is true\n      */\n    __LOADED: {}\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n\n  members: {\n\n    /**\n     * Array of the scripts to be loaded\n     */\n    __QUEUE: null,\n\n    /**\n     * True if start has been called.\n     */\n    __started: null,\n\n\n\n    /**\n     * Start loading scripts. This may only be called once!\n     * @return {Promise?} a promise which will be resolved after load of all scripts if promise support is enabled; nothing (undefined) if promises are not enabled.\n     */\n    start: qx.core.Environment.select('qx.promise', {\n      \"true\": function() {\n        return new qx.Promise(function (resolve, reject) {\n          this.addListenerOnce(\"ready\", resolve, this);\n          this.addListenerOnce(\"failed\", function (e) {\n            reject(new Error(e.getData()));\n          }, this);\n          if (this.isDisposed()) {\n            reject(new Error('disposed'));\n          }\n          if (this.__started) {\n            reject(new Error('you can only call start once per instance'));\n          }\n          this.__started = true;\n          this.__loadScripts();\n        }, this);\n      },\n      \"false\": function () {\n        if (this.isDisposed()) {\n          return;\n        }\n        if (this.__started) {\n          throw new Error('you can only call start once per instance');\n        }\n        this.__started = true;\n        this.__loadScripts();\n      }\n    }),\n\n\n    /**\n     * Chain loading scripts.\n     *\n     * Recursively called until the array of scripts is consumed\n     *\n     */\n    __loadScripts: function () {\n      var DynamicScriptLoader = qx.util.DynamicScriptLoader;\n      var script;\n      var dynLoader;\n      var id1, id2;\n      var uri;\n      var loader;\n\n      script = this.__QUEUE.shift();\n      if (!script){\n        this.fireEvent(\"ready\")\n        return;\n      }\n\n      if (DynamicScriptLoader.__LOADED[script]){\n        this.fireDataEvent('loaded',{\n          script: script,\n          status: 'preloaded'\n        });\n        this.__loadScripts();\n        return;\n      }           \n\n      dynLoader = DynamicScriptLoader.__IN_PROGRESS[script];\n      if (dynLoader){\n\n          id1 = dynLoader.addListener('loaded',function (e) {\n            if (this.isDisposed()) {\n              return;\n            }\n            var data = e.getData();\n            if (data.script === script){\n              dynLoader.removeListenerById(id2);\n              dynLoader.removeListenerById(id1);\n              this.fireDataEvent('loaded',data);\n              this.__loadScripts();\n            }\n          },this);\n\n          id2 = dynLoader.addListener('failed',function (e) {\n            if (this.isDisposed()) {\n              return;\n            }\n            var data = e.getData();\n            dynLoader.removeListenerById(id1);\n            dynLoader.removeListenerById(id2);              \n            this.fireDataEvent('failed',{\n              script: script,\n              status: 'loading of ' + data.script + ' failed while waiting for ' + script\n            });\n          },this);\n\n          return;\n      }\n\n      uri = qx.util.ResourceManager.getInstance().toUri(script);\n\n      loader = new qx.bom.request.Script();\n\n      loader.on(\"load\", function(request) {\n        if (this.isDisposed()) {\n           return;\n        }\n        DynamicScriptLoader.__LOADED[script] = true;\n        delete DynamicScriptLoader.__IN_PROGRESS[script];\n        this.fireDataEvent('loaded', {\n          script: script,\n          status: request.status\n        });\n        this.__loadScripts();\n      },this);\n\n      var onError = function(request) {\n        if (this.isDisposed()) {\n           return;\n        }\n        delete DynamicScriptLoader.__IN_PROGRESS[script];\n        this.fireDataEvent('failed', {\n          script: script,\n          status: request.status\n        });\n      };\n\n      loader.on(\"error\", onError,this);\n      loader.on(\"timeout\", onError,this);\n\n      // this.debug(\"Loading \" + script + \" started\");\n      loader.open(\"GET\", uri);\n      DynamicScriptLoader.__IN_PROGRESS[script] = this;\n      loader.send();\n    }\n  },\n  destruct : function() {\n    var DynamicScriptLoader = qx.util.DynamicScriptLoader;\n    for (var key in DynamicScriptLoader.__IN_PROGRESS){\n      if (DynamicScriptLoader.__IN_PROGRESS[key] === this) {\n        delete DynamicScriptLoader.__IN_PROGRESS[key];\n      }\n    }\n    this.__QUEUE = undefined;\n  }\n});\n"
  ]
}