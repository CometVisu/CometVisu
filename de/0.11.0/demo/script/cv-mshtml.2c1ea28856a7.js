//PROCESSED
qx.$$packageData['16384']={"locales":{},"resources":{"plugins/openweathermap/openweathermap.css":"cv","plugins/openweathermap/owm/jquery.owm.js":"cv"},"translations":{"de":{},"en":{}}};
qx.Part.$$notifyLoad("16384", function() {
(function(){var a='plugins/openweathermap/openweathermap.css',b='plugins/openweathermap/owm/jquery.owm.js',c='"><div id="owm_',d='cssClass',e="openweathermap",f='<div class="',g="setup.dom.finished",h=" ",i='cv.plugins.OpenweatherMap',j='" class="openweathermap_value"></div></div>',k="String",l="widget clearfix text openweathermap",m='interval';qx.Class.define(i,{extend:cv.ui.structure.AbstractBasicWidget,include:cv.ui.common.Refresh,construct:function(n){n.refresh=n.refresh*60;cv.ui.structure.AbstractBasicWidget.call(this,n);this.__uB={};Object.keys(n).forEach(function(o){if(n[o]){this.__uB[o]=n[o];};},this);qx.event.message.Bus.subscribe(g,function(){this._refreshAction();},this);},statics:{parse:function(p,t,r,q){var s=cv.parser.WidgetParser.parseElement(this,p,t,r,q,this.getAttributeToPropertyMappings());cv.parser.WidgetParser.parseRefresh(p,t);return s;},getAttributeToPropertyMappings:function(){return {'class':{target:d},'lang':{},'q':{},'lat':{},'lon':{},'units':{},'type':{},'forecastItems':{},'detailItems':{},'appid':{}};}},properties:{cssClass:{check:k,nullable:true},lang:{check:k,nullable:true},q:{check:k,nullable:true},lat:{check:k,nullable:true},lon:{check:k,nullable:true},units:{check:k,nullable:true},type:{check:k,nullable:true},forecastItems:{check:k,nullable:true},detailItems:{check:k,nullable:true},appid:{check:k,nullable:true}},members:{__uB:null,_getInnerDomString:function(){var u=l;if(this.getCssClass()){u+=h+this.getCssClass();};return f+u+c+this.getPath()+j;},_setupRefreshAction:function(){this._timer=new qx.event.Timer(this.getRefresh());this._timer.addListener(m,this._refreshAction,this);this._timer.start();},_refreshAction:function(){var v=$(this.getDomElement());v.openweathermap(this.__uB);return false;}},defer:function(w){var x=cv.util.ScriptLoader.getInstance();x.addStyles(a);x.addScripts(b);cv.parser.WidgetParser.addHandler(e,cv.plugins.OpenweatherMap);cv.ui.structure.WidgetFactory.registerClass(e,w);}});})();
}); var jOWM=jOWM||{};(function($){$.fn.openweathermap=function(options,fn){var defaults={baseURL:'https://api.openweathermap.org/data/2.5/',detailItems:4,forecastItems:5,forecastToday:true,units:'metric',type:'like',refresh:30,appid:''};var options=$.extend(defaults,options);options.detailItems=parseInt(options.detailItems,10);if(options.detailItems<0){options.detailItems=0;}
if(options.detailItems>4){options.detailItems=4;}
options.forecastItems=parseInt(options.forecastItems,10);if(options.forecastItems<0){options.forecastItems=0;}
if(options.forecastItems>16){options.forecastItems=16;}
Date.ext.locales['de']={a:['So','Mo','Di','Mi','Do','Fr','Sa'],A:['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'],b:['Jan','Feb','Mär','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Dez'],B:['Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'],};return this.each(function(i,e){$element=$(e);if(!$element.hasClass('jowm')){$element.addClass('jowm');}
_process(e,options);});};var _process=function(e,options){var html='';var paramsDefault=_parametersFromOptions(options);var currentURL=options.baseURL+'forecast?'+paramsDefault.join('&');var forecastItems=paramsDefault;forecastItems.push('cnt='+options.forecastItems);var forecastURL=options.baseURL+'forecast/daily?'+forecastItems.join('&');if($('ul.detailed',$(e)).length===0){$('<ul>').addClass('detailed').addClass('clearfix').appendTo($(e));}
if($('ul.forecast',$(e)).length===0){$('<ul>').addClass('forecast').addClass('clearfix').appendTo($(e));}
$.getJSON(options.baseURL+'weather?'+paramsDefault.join('&'),function(data){if(data.cod==200){options.sunrise=data.sys.sunrise;options.sunset=data.sys.sunset;_processDataDetailed(e,currentURL,options);_processDataForecast(e,forecastURL,options);}
else{$(e).after('<!-- Failed to fetch detailed weather data. -->');}});}
var _processDataDetailed=function(e,url,options){$('ul.detailed',$(e)).html('');if(options.detailItems===0){return;}
$.getJSON(url,function(data){if(data.cod==200){var dataItems=data.list.slice(0,options.detailItems);$.each(dataItems,function(index,elem){$item=$('<li>');if(elem.dt<options.sunrise||elem.dt>options.sunset){$item.addClass('night');}
if(index===0){$item.addClass('first');}
if(index===(dataItems.length-1)){$item.addClass('last');}
$item.html(jOWM.theme('weatherDetailItem',elem,options));$item.appendTo($('ul.detailed',$(e)));});}
else{$(e).after('<!-- Failed to fetch detailed weather data. -->');}});}
var _processDataForecast=function(e,url,options){$('ul.forecast',$(e)).html('');if(options.forecastItems===0){return;}
$.getJSON(url,function(data){if(data.cod==200){var dataItems=data.list;if(!options.forecastToday){dataItems.shift();}
$.each(dataItems,function(index,elem){$item=$('<li>');if(index===0){$item.addClass('first');}
if(index===(dataItems.length-1)){$item.addClass('last');}
$item.html(jOWM.theme('weatherForecastItem',elem,options));$item.appendTo($('ul.forecast',$(e)));});}
else{$(e).after('<!-- Failed to fetch forecast weather data. -->');}});}
var _parametersFromOptions=function(options){var items=[];if(options.hasOwnProperty('lang')){items.push('lang='+options.lang);}
if(options.hasOwnProperty('q')){items.push('q='+options.q);}
else if(options.hasOwnProperty('lat')&&options.hasOwnProperty('lon')){items.push('lat='+options.lat);items.push('lon='+options.lon);}
if(options.hasOwnProperty('units')){items.push('units='+options.units);}
if(options.hasOwnProperty('type')){items.push('type='+options.type);}
if(options.hasOwnProperty('appid')){items.push('appid='+options.appid);}
return items;}
jOWM.theme=function(func){var args=Array.prototype.slice.apply(arguments,[1]);return(jOWM.theme[func]||jOWM.theme.prototype[func]).apply(this,args);};jOWM.theme.prototype.weatherTemperature=function(temperature,precision,suffix){suffix=suffix||'°';return parseFloat(temperature).toFixed(precision)+suffix;}
jOWM.theme.prototype.weatherDetailItem=function(data,options){var weather=data.weather[0];var temperature=data.main;var d=new Date(data.dt*1000);d.locale=options.lang;var output='<div class="weather-detailed weather-'+weather.id+' clearfix">';output+=' <div class="weather">';output+='  <span class="weather-icon" data-weather-text="'+weather.description+'" data-weather-code="'+weather.id+'"></span>';output+=' </div>';output+=' <div class="temperature">'+jOWM.theme('weatherTemperature',temperature.temp,1)+'</div>';output+='</div>';return output;};jOWM.theme.prototype.weatherForecastItem=function(data,options){var weather=data.weather[0];var temperature=data.temp;var d=new Date(data.dt*1000);d.locale=options.lang;var output='<div class="weather-forecast weather-'+weather.id+' clearfix">';output+=' <div class="day">'+d.strftime('%a')+'</div>';output+=' <div class="weather-icon" data-weather-text="'+weather.description+'" data-weather-code="'+weather.id+'"></div>';output+=' <div class="temperature high">'+jOWM.theme('weatherTemperature',temperature.max,0,' °C')+'</div>';output+=' <div class="temperature low">'+jOWM.theme('weatherTemperature',temperature.max,0,' °C')+'</div>';output+='</div>';return output;};})(jQuery);