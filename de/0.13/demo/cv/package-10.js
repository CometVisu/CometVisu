!function(){var e={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.AbstractWidget":{require:!0},"cv.ui.common.Refresh":{require:!0},"cv.parser.WidgetParser":{defer:"runtime"},"qx.event.Timer":{},"cv.util.ScriptLoader":{defer:"runtime"},"cv.ui.structure.WidgetFactory":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(e);qx.Class.define("cv.plugins.Rss",{extend:cv.ui.structure.AbstractWidget,include:[cv.ui.common.Refresh],statics:{parse:function(e,t,r,i){var n=cv.parser.WidgetParser.parseElement(this,e,t,r,i,this.getAttributeToPropertyMappings());cv.parser.WidgetParser.parseRefresh(e,t);return n},getAttributeToPropertyMappings:function(){return{src:{},width:{default:""},height:{default:""},limit:{default:10},header:{default:!0},date:{default:!0},content:{default:!0},snippet:{default:!0},showerror:{default:!0},ssl:{default:!1},linktarget:{default:"_new"},link:{default:!0},title:{default:!0}}}},properties:{src:{check:"String",init:""},width:{init:""},height:{init:""},limit:{init:10},header:{init:!0},date:{init:!0},content:{init:!0},snippet:{init:!0},showerror:{init:!0},ssl:{init:!1},linktarget:{init:"_new"},link:{init:!0},title:{init:!0}},members:{_parser:null,_getInnerDomString:function(){return'<div class="actor"><ul class="rss_inline" style="'+(""+this.getWidth()?"width:"+this.getWidth():""+this.getHeight()?"height:"+this.getHeight():"")+'"></ul>'},_onDomReady:function(){cv.plugins.Rss.prototype._onDomReady.base.call(this);this._parser=new RSSParser;this.refreshRSS()},_setupRefreshAction:function(){this._timer=new qx.event.Timer(this.getRefresh());this._timer.addListener("interval",function(){this.refreshRSS()},this);this._timer.start()},refreshRSS:function(){var e=this;this._parser.parseURL(this.getSrc(),function(t,r){var i=e.getActor(),n=i.querySelector(".rss_inline");if(t){e.error(t);e.getShowerror()&&(n.textContent="ERROR: "+t)}else{if(e.getHeader()){var s=i.querySelector(":scope > h3");if(!s){s=document.createElement("h3");i.insertBefore(s,i.firstElementChild)}s.textContent=r.title}for(var a=n.querySelectorAll(":scope > li"),c=a.length;c>=r.items.length;c--)a[c].remove();var l=e.getLink(),o=e.getContent(),u=e.getDate();r.items.some(function(t,r){var i,s,a,c=n.querySelector(':scope > li[data-row="'+r+'"]');if(c){l&&(i=c.querySelector(":scope > a"));o&&(s=c.querySelector(":scope > p.content"));u&&(a=c.querySelector(":scope > p.date"))}else{c=document.createElement("li");if(l){(i=document.createElement("a")).setAttribute("target",e.getLinktarget());c.appendChild(i)}if(o){(s=document.createElement("p")).classList.add("content");c.appendChild(s)}if(u){(a=document.createElement("p")).classList.add("date");c.appendChild(a)}c.setAttribute("data-row",""+r);n.appendChild(c)}if(l){i.textContent=t.title;i.setAttribute("href",t.link)}else c.textContent=t.title;o&&(s.innerHTML=e.getSnippet()?t.contentSnippet:t.content);u&&(a.innerText=new Date(t.isoDate).toLocaleString());return r>=e.getLimit()})}})}},destruct:function(){this._parser=null},defer:function(e){cv.util.ScriptLoader.getInstance().addScripts("plugins/rss/rss-parser.min.js");cv.parser.WidgetParser.addHandler("rss",cv.plugins.Rss);cv.ui.structure.WidgetFactory.registerClass("rss",e)}});cv.plugins.Rss.$$dbClassInfo=e}();qx.$$packageData[10]={locales:{},resources:{},translations:{}};
//# sourceMappingURL=package-10.js.map