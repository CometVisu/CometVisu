{"version":3,"names":["qx","Class","define","extend","cv","ui","structure","pure","AbstractWidget","include","common","Update","construct","props","name1","singlePhase","name2","name3","constructor","call","this","setSpectrum","isSinglePhase","setupSpectrum","setCurve","setupCurve","statics","CURRENT","VOLTAGE","limitEN50160_1999","limitEN61000_3_2","referenceSin","fixLimits","entry","index","array","lastShifted","last","length","parse","xml","path","flavour","pageType","data","parser","WidgetParser","parseElement","getAttributeToPropertyMappings","parseFormat","parseAddress","makeAddressListFn","type","target","transform","value","plugins","PowerSpectrum","singlephase","limitname","default","spectrumonly","showlegend","limitcolor","color1","color2","color3","src","mode","variant","properties","displayType","check","init","spectrum","limitName","curve","showCurve","showLegend","current","limitColor","members","__P_14_0","__P_14_1","_getInnerDomString","actor","isShowCurve","_onDomReady","superclass","prototype","colors","getLimitColor","getColor1","getColor2","getColor3","diagramCurve","$","getPath","empty","optionsCurve","legend","show","isShowLegend","xaxis","yaxis","diagramSpectrum","optionsSpectrum","series","bars","fill","fillColor","lineWidth","align","barWidth","plot","createDatasetCurve","createDatasetSpectrum","bind","layout","ResizeHandler","states","isPageSizeInvalid","addListenerOnce","_update","ga","undefined","phase","addressInfo","getAddress","variantInfo","Transform","encode","getCurrent","substr","parseInt","factor","values","i","Math","pow","getSpectrum","setData","draw","updateCurve","getCurve","offset","ret_val","push","input","inp","out","shift","PI","phi","cos","j","label","color","getLimitName","getDisplayType","lines","steps","getName1","getName2","getName3","defer","util","ScriptLoader","getInstance","addScripts","addHandler","WidgetFactory","registerClass","forEach","time","sin","$$dbClassInfo"],"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/PowerSpectrum.js"],"sourcesContent":["/* PowerSpectrum.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * The powerspectrum plugin and widget creates a graph to show the power\n * spectral data that the Enertex Smartmeter can send on the KNX bus.\n *\n * @author Christian Mayer\n * @since 0.10.0\n * @asset(plugins/diagram/dep/flot/jquery.flot.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.canvas.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.resize.min.js)\n * @asset(plugins/diagram/dep/flot/jquery.flot.navigate.min.js)\n */\nqx.Class.define('cv.plugins.PowerSpectrum', {\n  extend: cv.ui.structure.pure.AbstractWidget,\n  include: [cv.ui.common.Update],\n\n  /*\n  ******************************************************\n    CONSTRUCTOR\n  ******************************************************\n  */\n  construct(props) {\n    if (!props.name1) {\n      props.name1 = props.singlePhase === true ? 'L' : 'L1';\n    }\n    if (!props.name2) {\n      props.name2 = 'L2';\n    }\n    if (!props.name3) {\n      props.name3 = 'L3';\n    }\n    super(props);\n\n    // some initializations\n    this.setSpectrum(\n      this.isSinglePhase()\n        ? [this.setupSpectrum()]\n        : [this.setupSpectrum(-0.26), this.setupSpectrum(0), this.setupSpectrum(0.26)]\n    );\n\n    this.setCurve(\n      this.isSinglePhase() ? [this.setupCurve()] : [this.setupCurve(), this.setupCurve(), this.setupCurve()]\n    );\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    // Constants\n    CURRENT: 0,\n    VOLTAGE: 1,\n    limitEN50160_1999: [\n      [2, 0.02],\n      [3, 0.05],\n      [4, 0.01],\n      [5, 0.06],\n      [6, 0.005],\n      [7, 0.05],\n      [8, 0.005],\n      [9, 0.015],\n      [10, 0.005],\n      [11, 0.035],\n      [12, 0.005],\n      [13, 0.03],\n      [14, 0.005],\n      [15, 0.005],\n      [16, 0.005],\n      [17, 0.02],\n      [18, 0.005],\n      [19, 0.015],\n      [20, 0.005],\n      [21, 0.005],\n      [22, 0.005],\n      [23, 0.015],\n      [24, 0.005],\n      [25, 0.015]\n    ],\n\n    // limit for voltage in ratio\n    limitEN61000_3_2: [\n      [2, 1.62],\n      [3, 3.45],\n      [4, 0.65],\n      [5, 1.71],\n      [6, 0.45],\n      [7, 1.16],\n      [8, 0.35],\n      [9, 0.6],\n      [10, 0.28],\n      [11, 0.5],\n      [12, 0.233],\n      [13, 0.32],\n      [14, 0.2],\n      [15, 0.23],\n      [16, 0.175],\n      [17, 0.203],\n      [18, 0.155],\n      [19, 0.182],\n      [20, 0.14],\n      [21, 0.164],\n      [22, 0.127],\n      [23, 0.15],\n      [24, 0.117],\n      [25, 0.139]\n    ],\n\n    // limit for current in Ampere\n    referenceSin: [[], [], []],\n\n    // fix limits for better displaying\n    fixLimits(entry, index, array) {\n      array[index][0] -= 0.5;\n    },\n    lastShifted(array) {\n      const last = array[array.length - 1];\n      return [last[0] + 1, last[1]];\n    },\n\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse(xml, path, flavour, pageType) {\n      const data = cv.parser.pure.WidgetParser.parseElement(\n        this,\n        xml,\n        path,\n        flavour,\n        pageType,\n        this.getAttributeToPropertyMappings()\n      );\n\n      cv.parser.pure.WidgetParser.parseFormat(xml, path);\n      cv.parser.pure.WidgetParser.parseAddress(xml, path, this.makeAddressListFn);\n\n      return data;\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        type: {\n          target: 'displayType',\n          transform(value) {\n            return value === 'current' ? cv.plugins.PowerSpectrum.CURRENT : cv.plugins.PowerSpectrum.VOLTAGE;\n          }\n        },\n\n        singlephase: {\n          target: 'singlePhase',\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        limitname: {\n          target: 'limitName',\n          default: 'limit'\n        },\n\n        name1: {},\n        name2: {},\n        name3: {},\n        spectrumonly: {\n          target: 'showCurve',\n          transform(value) {\n            return value !== 'true';\n          }\n        },\n\n        showlegend: {\n          target: 'showLegend',\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        limitcolor: {\n          target: 'limitColor',\n          default: '#edc240' // default directly from flot code\n        },\n        color1: {\n          default: '#afd8f8'\n        },\n\n        color2: {\n          default: '#cb4b4b'\n        },\n\n        color3: {\n          default: '#4da74d'\n        }\n      };\n    },\n\n    makeAddressListFn(src, transform, mode, variant) {\n      if (!variant) {\n        variant = 'spectrum'; // the default\n      }\n      return [true, variant];\n    }\n  },\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    displayType: {\n      check: [0, 1],\n      init: 1\n    },\n\n    singlePhase: {\n      check: 'Boolean',\n      init: false\n    },\n\n    spectrum: {\n      check: 'Array',\n      init: []\n    },\n\n    limitName: {\n      check: 'String',\n      init: 'limit'\n    },\n\n    name1: {\n      check: 'String',\n      init: 'L1'\n    },\n\n    name2: {\n      check: 'String',\n      init: 'L2'\n    },\n\n    name3: {\n      check: 'String',\n      init: 'L3'\n    },\n\n    curve: {\n      check: 'Array',\n      init: []\n    },\n\n    showCurve: {\n      check: 'Boolean',\n      init: false\n    },\n\n    showLegend: {\n      check: 'Boolean',\n      init: false\n    },\n\n    current: {\n      check: 'Array',\n      init: []\n    },\n\n    limitColor: {\n      check: 'Color',\n      init: '#edc240'\n    },\n\n    color1: {\n      check: 'Color',\n      init: '#afd8f8'\n    },\n\n    color2: {\n      check: 'Color',\n      init: '#cb4b4b'\n    },\n\n    color3: {\n      check: 'Color',\n      init: '#4da74d'\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __plot: null,\n    __plotCurve: null,\n\n    _getInnerDomString() {\n      // create the actor\n      let actor = '<div class=\"actor clickable\">';\n      if (this.isShowCurve()) {\n        actor += '<div class=\"diagram_inline curve\">loading...</div>';\n      }\n      actor += '<div class=\"diagram_inline spectrum\">loading...</div></div>';\n      return actor;\n    },\n\n    _onDomReady() {\n      super._onDomReady();\n      const colors = [this.getLimitColor(), this.getColor1(), this.getColor2(), this.getColor3()];\n\n      const diagramCurve = this.isShowCurve() && $('#' + this.getPath() + ' .actor div.curve').empty();\n      const optionsCurve = this.isShowCurve() && {\n        colors: colors,\n        legend: {\n          show: this.isShowLegend()\n        },\n\n        xaxis: {\n          show: false\n        },\n\n        yaxis: {\n          show: false\n        }\n      };\n\n      const diagramSpectrum = $('#' + this.getPath() + ' .actor div.spectrum').empty();\n      const optionsSpectrum = {\n        colors: colors,\n        series: {\n          bars: {\n            show: true,\n            fill: 1,\n            fillColor: null,\n            lineWidth: 0\n          }\n        },\n\n        bars: {\n          align: 'center',\n          barWidth: this.isSinglePhase() ? 0.75 : 0.25\n        },\n\n        legend: {\n          show: this.isShowLegend()\n        },\n\n        xaxis: {\n          show: false\n        },\n\n        yaxis: {\n          show: false\n        }\n      };\n\n      const init = function () {\n        this.__plotCurve = this.isShowCurve() && $.plot(diagramCurve, this.createDatasetCurve(), optionsCurve);\n        this.__plot = $.plot(diagramSpectrum, this.createDatasetSpectrum(), optionsSpectrum);\n      }.bind(this);\n\n      // check if sizes are set yet, otherwise wait some time\n      if (cv.ui.structure.pure.layout.ResizeHandler.states.isPageSizeInvalid()) {\n        cv.ui.structure.pure.layout.ResizeHandler.states.addListenerOnce('changePageSizeInvalid', init);\n      } else {\n        init();\n      }\n    },\n\n    _update(ga, data) {\n      if (ga === undefined) {\n        return;\n      }\n      const addressInfo = this.getAddress()[ga];\n\n      let phase;\n      if (addressInfo.variantInfo[0] === 'I') {\n        phase = this.isSinglePhase() ? 1 : +(addressInfo.variantInfo[1] || 1);\n        const value = cv.Transform.encode(addressInfo, data);\n        this.getCurrent()[phase - 1] = value / 1000; // transform mA to A\n      } else if (addressInfo.variantInfo.substr(0, 8) === 'spectrum' && data.length === 28) {\n        // sanity check for 14 bytes\n        phase = this.isSinglePhase() ? 1 : +(addressInfo.variantInfo[8] || 1);\n        const index = parseInt(data.substr(0, 2), 16);\n        const factor = this.getCurrent()[phase - 1] || 1;\n        const values = [];\n\n        for (let i = 0; i < 13; i++) {\n          if (index + i < 2) {\n            continue;\n          }\n          values[i] = Math.pow(10, (parseInt(data.substr(i * 2 + 2, 2), 16) - 253) / 80);\n\n          this.getSpectrum()[phase - 1][index + i - 2][1] = values[i] * factor;\n        }\n        this.__plot.setData(this.createDatasetSpectrum());\n        this.__plot.draw();\n\n        if (this.__plotCurve) {\n          this.updateCurve(this.getSpectrum(), this.getCurve(), phase - 1);\n          this.__plotCurve.setData(this.createDatasetCurve());\n          this.__plotCurve.draw();\n        }\n      }\n    },\n\n    /**\n     * Setup helper\n     */\n    setupCurve() {\n      return [\n        [0, 0],\n        [0.4, 0],\n        [0.8, 0],\n        [1.2, 0],\n        [1.6, 0],\n        [2, 0],\n        [2.4, 0],\n        [2.8, 0],\n        [3.2, 0],\n        [3.6, 0],\n        [4, 0],\n        [4.4, 0],\n        [4.8, 0],\n        [5.2, 0],\n        [5.6, 0],\n        [6, 0],\n        [6.4, 0],\n        [6.8, 0],\n        [7.2, 0],\n        [7.6, 0],\n        [8, 0],\n        [8.4, 0],\n        [8.8, 0],\n        [9.2, 0],\n        [9.6, 0],\n        [10, 0],\n        [10.4, 0],\n        [10.8, 0],\n        [11.2, 0],\n        [11.6, 0],\n        [12, 0],\n        [12.4, 0],\n        [12.8, 0],\n        [13.2, 0],\n        [13.6, 0],\n        [14, 0],\n        [14.4, 0],\n        [14.8, 0],\n        [15.2, 0],\n        [15.6, 0],\n        [16, 0],\n        [16.4, 0],\n        [16.8, 0],\n        [17.2, 0],\n        [17.6, 0],\n        [18, 0],\n        [18.4, 0],\n        [18.8, 0],\n        [19.2, 0],\n        [19.6, 0]\n      ];\n    },\n    setupSpectrum(offset) {\n      const ret_val = [];\n\n      if (undefined === offset) {\n        offset = 0;\n      }\n      for (let i = 2; i < 52; i++) {\n        ret_val.push([i + offset, 0]);\n      }\n      return ret_val;\n    },\n\n    /**\n     * Convert a spectrum to a curve\n     * @param input\n     * @param target\n     * @param phase\n     */\n    updateCurve(input, target, phase) {\n      const inp = input[phase];\n      const out = target[phase];\n      const shift = ((phase * 2) / 3 - 0.5) * Math.PI;\n\n      for (let i = 0; i < 50; i++) {\n        const phi = (i * Math.PI) / 25;\n        let value = Math.cos(phi + shift); // the base with 50 Hz\n\n        // the harmonics\n        for (let j = 2; j < 50; j++) {\n          value += Math.cos((phi + shift) * j) * inp[j][1];\n        }\n\n        out[i][1] = value;\n      }\n    },\n\n    /**\n     * Little helper to setup the Flot dataset structure.\n     */\n    createDatasetCurve() {\n      return this.isSinglePhase()\n        ? [\n            {\n              label: null,\n              data: this.self(arguments).referenceSin[0],\n              color: 13\n            },\n\n            // trick flot to automatically make color darker\n            { label: 'L', data: this.getCurve()[0], color: 1 }\n          ]\n        : [\n            {\n              label: null,\n              data: this.self(arguments).referenceSin[0],\n              color: 13\n            },\n\n            {\n              label: null,\n              data: this.self(arguments).referenceSin[1],\n              color: 14\n            },\n\n            {\n              label: null,\n              data: this.self(arguments).referenceSin[2],\n              color: 15\n            },\n\n            { label: 'L1', data: this.getCurve()[0], color: 1 },\n            { label: 'L2', data: this.getCurve()[1], color: 2 },\n            { label: 'L3', data: this.getCurve()[2], color: 3 }\n          ];\n    },\n\n    /**\n     * Little helper to setup the Flot dataset structure.\n     */\n    createDatasetSpectrum() {\n      return this.isSinglePhase()\n        ? [\n            {\n              label: this.getLimitName(),\n              data:\n                this.getDisplayType() === this.self(arguments).VOLTAGE\n                  ? this.self(arguments).limitEN50160_1999\n                  : this.self(arguments).limitEN61000_3_2,\n              bars: { show: false },\n              lines: { steps: true },\n              color: 0\n            },\n\n            { label: this.getName1(), data: this.getSpectrum()[0], color: 1 }\n          ]\n        : [\n            {\n              label: this.getLimitName(),\n              data:\n                this.getDisplayType() === this.self(arguments).VOLTAGE\n                  ? this.self(arguments).limitEN50160_1999\n                  : this.self(arguments).limitEN61000_3_2,\n              bars: { show: false },\n              lines: { steps: true },\n              color: 0\n            },\n\n            { label: this.getName1(), data: this.getSpectrum()[0], color: 1 },\n            { label: this.getName2(), data: this.getSpectrum()[1], color: 2 },\n            { label: this.getName3(), data: this.getSpectrum()[2], color: 3 }\n          ];\n    }\n  },\n\n  defer(statics) {\n    const loader = cv.util.ScriptLoader.getInstance();\n    loader.addScripts([\n      'plugins/diagram/dep/flot/jquery.flot.min.js',\n      'plugins/diagram/dep/flot/jquery.flot.canvas.min.js',\n      'plugins/diagram/dep/flot/jquery.flot.resize.min.js',\n      'plugins/diagram/dep/flot/jquery.flot.navigate.min.js'\n    ]);\n\n    cv.parser.pure.WidgetParser.addHandler('powerspectrum', cv.plugins.PowerSpectrum);\n\n    cv.ui.structure.WidgetFactory.registerClass('powerspectrum', statics);\n\n    // init\n    statics.limitEN50160_1999.forEach(statics.fixLimits);\n    statics.limitEN50160_1999.push(statics.lastShifted(statics.limitEN50160_1999));\n\n    statics.limitEN61000_3_2.forEach(statics.fixLimits);\n    statics.limitEN61000_3_2.push(statics.lastShifted(statics.limitEN61000_3_2));\n\n    // fill reference\n    for (let phi = 0; phi < 50; phi++) {\n      const time = (phi * 20) / 50; // time in milliseconds\n\n      statics.referenceSin[0].push([time, Math.sin((phi * Math.PI) / 25)]);\n      statics.referenceSin[1].push([time, Math.sin(((phi + 50 / 3) * Math.PI) / 25)]);\n\n      statics.referenceSin[2].push([time, Math.sin(((phi + 100 / 3) * Math.PI) / 25)]);\n    }\n  }\n});\n"],"mappings":"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"}