{"version":3,"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/upload/MDragUpload.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/FileSystem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/snackbar/Controller.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/MFileEventHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/IFileEventHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/FileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/upload/UploadMgr.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/FileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/GlobalFileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/VirtualFsItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Preferences.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Message.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/snackbar/Message.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/BackupFolder.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileHandlerRegistry.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/CompareFiles.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/Prompt.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileController.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/IEditor.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/IActionHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/AbstractViewer.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Folder.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Icons.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/Start.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/AbstractEditor.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Source.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Diff.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Worker.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/FileListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/ToolBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/core/IconAtom.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/completion/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/completion/CometVisu.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Schema.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/ElementChange.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/VirtualElementItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/ConfigElement.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ElementForm.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Base.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/MAnnotation.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Element.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/XmlElement.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/data/Provider.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/ValidationError.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/Main.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/BigAlert.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/config/Section.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SectionListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/MenuBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/basic/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SourceCodeField.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/Option.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/VirtualSelectBox.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/CheckBox.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ElementFormRenderer.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/DocumentationMapping.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/SimpleType.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Choice.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Sequence.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Group.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Any.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Attribute.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/ActionDispatcher.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/core/GlobalState.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/OpenFile.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/FileTabItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/config/Option.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/OptionListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/basic/Icon.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/SvgIcon.js"],"names":["qx","Mixin","define","construct","this","setDroppable","_applyStartDragListeners","addListenerOnce","addListener","__P_52_0","properties","uploadMode","check","init","apply","uploadHint","statics","onHtml5Drop","ev","preventDefault","getFiles","forEach","uploadFile","file","replaceFile","folder","cv","ui","manager","model","FileItem","isConfigFile","name","tree","FileSystem","isAccepted","type","set","upload","UploadMgr","setFolder","hasDroppableFile","length","i","l","files","dataTransfer","items","item","getAsFile","push","members","__P_52_2","_boundOnStop","bounds","getBounds","getChildControl","setUserBounds","left","top","width","height","_createMDragUploadChildControlImpl","id","control","container","Composite","setZIndex","exclude","_add","edge","_getLayout","layout","Grow","setBackgroundColor","dropBox","basic","Atom","getUploadHint","theme","dark","Images","getIcon","iconPosition","rich","center","setAnonymous","add","_onStopDragging","setUploadMode","document","removeEventListener","getContentElement","getDomElement","addEventListener","_isDroppable","MDragUpload","bind","_applyDragListeners","element","uploadable","_onDrop","lid","getData","__P_52_1","value","show","$$dbClassInfo","Bootstrap","executePendingDefers","Class","extend","core","Widget","include","rootFolder","constructor","call","_setLayout","setRootFolder","event","message","Bus","subscribe","_onEnableTree","MIMETYPES","text/xml","application/xml","text/javascript","application/x-httpd-php","text/css","image/png","image/svg+xml","text/plain","getMimetypeFromSuffix","suffix","Object","keys","find","mime","mimetype","prototype","hasOwnProperty","events","changeSelection","selectedNode","nullable","__P_49_0","__P_49_1","__P_49_2","_replacementManager","reload","openPaths","getOpenNodes","map","node","getFullPath","root","getModel","refresh","setOpen","openPath","path","_applyRootFolder","setModel","load","setHideRoot","_applySelectedNode","contextMenu","contextmenu","GlobalFileItem","getInstance","configure","setContextMenu","setSelection","getSelection","replace","_onDblTapTreeSelection","sel","getSelectedNode","stop","getType","fireDataEvent","mode","_onChangeTreeSelection","getItem","setSelectedNode","Timer","once","resetContextMenu","resetSelectedNode","_onFsItemRightClick","widget","getTarget","VirtualFsItem","setEnabled","_createChildControlImpl","VirtualTree","selectionMode","minWidth","showTopLevelOpenCloseIcons","Preferences","converter","setDelegate","createItem","bindItem","controller","index","bindProperty","bindPropertyReverse","superclass","destruct","unsubscribe","_disposeObjects","VBox","initMessages","data","Array","_onMessage","_listController","List","getMessages","_initDelegate","info","msg","Message","title","dispatchByName","error","_typeof","statusText","sticky","appearance","refine","messages","deferredInit","_onCloseMessage","remove","snackbar","form","flex","Controller","_disableFileEvents","_handleFileEvent","MFileEventHandler","Interface","IFileEventHandler","marshal","MEventBubbling","implement","parent","fakeChildren","initChildren","setFakeChildren","endsWith","__P_41_0","setName","setParent","locale","Manager","_onChangeLocale","ROOT","_fakeIconFile","_hiddenConfigFakeFile","_acceptedFiles",".","media","test","getConfigName","filename","match","exec","getIconFile","overrideIcon","writeable","readable","open","loaded","hasChildren","fake","icon","getHiddenConfigFile","displayName","tr","getAcceptedFiles","loading","children","hash","editing","special","temporary","valid","hasWarnings","content","modified","transform","parentFolder","mounted","trash","inTrash","__P_41_1","__P_41_2","_toLowerCase","toLowerCase","isRelated","isFake","action","startsWith","dispose","getChildren","some","child","removeRelatedBindings","_applyName","old","getDisplayName","setDisplayName","getPath","getParentFolder","_onOpen","isLoaded","_maintainIcon","isOverrideIcon","setIcon","isTrash","isOpen","isMounted","getName","_applyHasChildren","unload","setLoaded","setLoading","removeAll","callback","context","addChild","oldParent","getParent","_onGet","nodeChildren","getFakeChildren","append","sortElements","_onError","err","isLoading","io","rest","Client","getFsClient","readSync","res","getBusTopic","getUri","getServerPath","util","LibraryManager","get","sort","a","b","localeCompare","parts","lang","Type","isArray","split","relPath","shift","translate","com","zenesis","uploadUrl","_init","LAST_ID","multiple","force","_updateUploadUrl","getFolder","url","getBaseUrl","setUploadUrl","evt","getFilename","setParam","isForce","progressListenerId","uploadedSize","debug","getSize","Math","round","stateListenerId","state","getStatus","qxl","dialog","Dialog","confirm","confirmed","forceUpload","getResponse","Json","parse","e","removeListenerById","_getUniqueFileId","setForce","newFile","File","getBrowserObject","getId","size","uploadWidget","getUploadWidget","getUploadHandler","_addFile","getAutoUpload","beginUploads","bomFile","fileName","fileSize","setSize","setUploadWidget","UploadButton","replacedFile","menu","Menu","noCompare","_noCompare","_commandGroup","Init","getApplication","getCommandManager","getActive","_dateFormat","format","DateFormat","Date","getDateFormat","_timeFormat","getTimeFormat","setActive","active","_selectedNode","_renameDialog","isFolder","isBackup","enabled","isWriteable","visibility","setVisibility","setLabel","compareMenu","backups","BackupFolder","getBackupFiles","date","getTime","group","backupEntry","Separator","groupButton","Button","button","setUserData","_onCompareWith","defaultHandler","FileHandlerRegistry","getFileHandler","openWithMenu","availableHandlers","getAllFileHandlers","Clazz","TITLE","toString","handlerConf","ICON","setAppearance","classname","addState","_onOpenWith","setFilename","controlName","isInTrash","label","_noNew","sep","isActive","compareWith","getUserData","CompareFiles","handlerId","handler","_onRename","Prompt","FileController","rename","caption","filter","_onDownload","download","_onRestore","restore","_onValidate","validate","_onClone","_onConvert","UploadMenuButton","addWidget","VirtualTreeItem","status","_applyEditing","field","setValue","getLabel","getValue","_applyTemporary","removeState","_applyModel","removeListener","_applyStatus","getRelatedTarget","__P_51_0","setEditing","_onKeypress","getKeyIdentifier","TextField","_restorePreferences","defaultConfigEditor","quickPreview","expertMode","startViewMode","_skipSaving","_savePreferences","store","bom","Storage","getLocal","Serializer","toNativeObject","setItem","report","Record","record","STORAGE","setPreferences","preferences","noSave","HBox","_onAppear","close","timeout","_timer","_applyType","setDecorator","getAppearance","_applyTimeout","getTimeout","Image","_addAt","Label","wrap","_onFilesSystemMessage","includes","pathparts","pop","join","fileRegex","RegExp","backupFile","parseInt","substring","__P_30_0","__P_30_1","registerFileHandler","viewer","SUPPORTED_FILES","Config","Icons","Folder","Start","editor","Source","Tree","preview","Diff","_onChangesDefaultConfigEditor","selector","clazz","options","config","assign","instance","isClass","instanceOf","selectorId","priority","isRegExp","regex","isFunction","isString","fullPath","handlers","key","isTemporary","noTemporaryFiles","noReadOnlyFiles","getFileHandlerById","__P_30_2","hasFileHandler","setDefault","getDefaultConfigEditor","DEFAULT_FOR","original","setOriginalFile","setModifiedFile","originalFile","modifiedFile","permanent","getOriginalFile","getModifiedFile","_applyModifiedFile","_createWidgetContent","_textField","setLiveUpdate","__P_29_0","newName","newPath","createSync","resetTemporary","resetModified","moveSync","src","target","resetEditing","move","__P_29_1","targetFileName","targetFile","updateSync","source","delete","__P_29_2","deleteSync","createElement","setAttribute","style","display","body","appendChild","click","removeChild","__P_29_3","d","alert","Worker","validateConfig","then","setValid","handlerOptions","jumpToError","trn","external","ready","save","getCurrentContent","IEditor","canHandleAction","actionName","handleAction","configureButton","actionId","unConfigureButton","IActionHandler","_applyFile","Scroll","_scaleImage","AbstractViewer","getImageData","ResourceManager","aspectRatio","ImageLoader","resetIcon","resetLabel","getFile","availableHeight","paddingY","paddingX","scale","connectToWindow","_windowRef","_source","_reloading","_applyConnectToWindow","setExternal","_onChange","configName","Uri","getAbsolute","setSource","hint","isVisible","ref","window","isConnectToWindow","_onClose","onbeforeunload","iframe","hasChildControl","resetSource","_this","getDocument","location","href","resetFile","openPage","page","contentWindow","otherController","Application","structureController","pageId","getPageIdByPath","scrollToPage","setHighlightWidget","widgetId","TemplateEngine","setHighlightedWidget","_this2","embed","Iframe","font","focus","backgroundColor","ISingleSelection","IModelSelection","MSingleSelectionHandling","MRemoteChildrenHandling","MModelSelection","noToolbar","_isImageRegex","initModel","_newItem","_debouncedOnFilter","Function","debounce","_onFilter","_createChildControl","addItem","removeItem","permanentFilter","showTextFilter","labelConverter","disableScrolling","viewMode","_controller","_getItems","_isAllowEmptySelection","_defaultLabelConverter","getViewMode","_getDelegate","getLabelConverter","FileListItem","configureItem","_onDblTap","setShowFileActions","getCurrentTarget","getSpecial","openAtPointer","getBubbles","stopPropagation","resetModel","getPermanentFilter","resetParent","_applyShowTextFilter","filterString","filterFunction","filtered","getChildrenContainer","_onAddChild","_onRemoveChild","_onFileEvent","_applyDisableScrolling","scrollContainer","ToolBar","placeholder","liveUpdate","margin","isShowTextFilter","Flow","isDisableScrolling","IconAtom","entry","IconHandler","IconConfig","DB","getIconSource","_configRegex","selectedItem","_ignoreSelectionChanges","_previewButton","_listButton","_radioGroup","_loadRoot","setFile","found","_onChangeSelection","list","selection","resetSelection","setSelectedItem","_applySelectedItem","_onToggleExpand","getVisibility","_onChangeViewMode","getStartViewMode","toolbar","part","Part","listButton","RadioButton","toolTipText","previewButton","RadioGroup","setStartViewMode","__P_25_0","folderWidget","specialFiles","unshift","fakeFolder","_initClient","_nativePasteSupported","queryCommandSupported","CLIPBOARD","_handledActions","_client","_applyHandlerOptions","_loadFile","getContent","setContent","_loadFromFs","resetContent","XMLDocument","XMLSerializer","serializeToString","_applyContent","_handleSaveResponse","_onSaved","overrideHash","isModified","getHash","curry","showErrors","errorList","showDecorations","decorators","AbstractEditor","droppable","focusable","effectAllowed","dropEffect","FocusHandler","setUseTabNavigation","_draw","_initWorker","_currentDecorations","COUNTER","MONACO_EXTENSION_REGEX","monaco","languages","extensions","getLanguages","ext","indexOf","sourcePath","loader","DynamicScriptLoader","require","paths","vs","vs/nls","availableLanguages","*","getLanguage","qxLib","typescript","javascriptDefaults","addExtraLib","completionProvider","completion","cvCompletionProvider","CometVisu","registerCompletionItemProvider","getProvider","log","Logger","start","_editor","_workerWrapper","_configClient","_onDidChangeContentGuard","setEditor","_getDefaultModelOptions","tabSize","indentSize","insertSpaces","domElement","create","suggestOnTriggerCharacters","folding","autoIndent","automaticLayout","dragAndDrop","formatOnPaste","formatOnType","renderValidationDecorations","minimap","baseVersion","Version","VERSION","xhr","request","Xhr","toUri","method","accept","schema","json","jsonDefaults","setDiagnosticsOptions","allowComments","schemas","uri","fileMatch","send","onDidChangeModelContent","_onContentChanged","trigger","getValueInRange","_paste","op","identifier","major","minor","range","text","forceMoveMarkers","executeEdits","isSupported","getConfigClient","JSON","stringify","section","isValid","getHasWarnings","__P_32_0","saveSync","newModel","xml","Document","isXmlDocument","documentElement","outerHTML","createModel","_getLanguage","onDidChangeDecorations","errors","warnings","getModelMarkers","owner","getLanguageId","resource","marker","severity","MarkerSeverity","Warning","Error","setHasWarnings","updateOptions","readOnly","_processHandlerOptions","getHandlerOptions","upgradeVersion","_this$_upgradeConfig","_upgradeConfig","_this$_upgradeConfig2","_slicedToArray","_convertToString","ConfigUpgrader","upgrade","contentChanged","fileType","typeExt","markers","firstErrorLine","line","startLineNumber","endLineNumber","startColumn","endColumn","setModelMarkers","getScrollTop","revealLineInCenter","deltaDecorations","_schemas","__P_33_0","__P_33_1","setPreviewState","structureChanges","hasChildrenModified","initUnDos","initReDos","__P_33_2","getRoot","_onElementKeyUp","_maintainPreviewVisibility","Allowed","NONE","BEFORE","AFTER","INSIDE","FIRST_CHILD","expert","selected","clipboard","unDos","reDos","autoRefreshPreview","previewState","showPreview","dragging","__P_33_3","__P_33_4","__P_33_5","_structure","getSchema","_asyncToGenerator","regeneratorRuntime","mark","_callee","_context","prev","next","Schema","abrupt","Promise","resolve","reject","onLoaded","setReady","isPreviewSynced","getPreviewState","setShowPreview","Viewport","getWidth","noPreview","_applyShowPreview","clearLayoutProperties","updateLayoutProperties","noStretch","setLayoutProperties","__P_33_6","_updatePreview","undo","redo","_onCut","_onCopy","_onPaste","_showHelp","_this3","getUnDos","setToolTipText","getTitle","resetToolTipText","getReDos","isDeletable","addUndo","elementChange","ElementChange","clearUnDosReDos","elem","clearReDos","_applyClipboard","navigator","writeText","getNode","resetPreviewState","_this4","Canvas","addAt","isShowPreview","ok","noSync","notOk","setRich","setWrap","_onEdit","_onDelete","CheckBox","toggleExpert","right","_onSearch","_showNextResult","_showPreviousResult","openMode","itemHeight","Environment","_initDragDrop","VirtualElementItem","_onContextMenuAction","_onContextMenu","bottom","setDraggable","setMarginLeft","getSelected","_onCreate","decoration","Decorator","widthTop","styleTop","colorTop","setHeight","setOpacity","ConfigElement","setSelected","setElement","added","resetSelected","openByQuerySelector","edit","_this5","result","querySelector","__P_33_7","rootNode","from","querySelectorAll","el","tagName","hasAttribute","getAttribute","firstMatch","$$widget","openNodeAndParents","current","ancestors","parentElement","p","draggedXmlElement","dragTarget","getDragTarget","setDragging","isEditable","addAction","addType","addData","addButton","accepted","_this6","getCurrentAction","supportsType","addNew","indicator","isAncestor","layerContent","getPane","getLayers","getContentLocation","getDocumentTop","lastElem","elementFromPoint","getWidgetByElement","isAnonymous","getLayoutParent","parentSchemaElement","getSchemaElement","allowedElements","getAllowedElements","addable","getAddableChildren","areChildrenSortable","acc","allowedSorting","getAllowedElementsSorting","elementName","__P_33_8","isChildElementAllowed","_allowedSorting","getFirstLevelElementSorting","targetPosition","undefined","firstChildPosition","expandTimer","lastTreeItem","treeContainer","onDrag","position","cursor","getManager","getCursor","DragDropCursor","_native","pointerType","hasState","origElem","getDocumentLeft","orig","skipDetection","origCoords","leftPos","_getChildren","getPaddingLeft","setWidth","lastCoords","setDomPosition","openNode","getAction","resetAction","console","assert","setAction","onDrop","clone","moveAfter","insertAfter","moveBefore","insertBefore","moveInside","insertChild","onDragEnd","resetUserData","resetDragging","_this7","sorting","minPosition","maxPosition","targetIndex","sibling","_targetIndex","_found","_i","_sibling","firstChild","ElementForm","allowCancel","formData","help","validation","required","promise","_document","ownerDocument","isElement","createComment","createTextNode","createCDATASection","schemaElement","getSchemaElementForElementName","requiredChildren","getRequiredElements","Element","sortChildNodes","childName","isTextContentRequired","xmlElement","XmlElement","getEditor","isShowEditButton","targetName","depth","currentPosition","_depth","min","__P_33_9","_this8","provider","Provider","getLive","userInputAllowed","__P_33_10","attribute","docs","getDocumentation","def","getDefaultValue","isOptional","validator","ListItem","isValueValid","ValidationError","getTypeString","enums","getEnumeration","isNew","_this9","getShowEditButton","typeElement","nodeType","Node","ELEMENT_NODE","allowed","getAllowedAttributes","getExpert","getAppinfo","parser","DOMParser","attrName","nodeName","lines","autoSize","innerHTML","parseFromString","getElementsByTagName","TEXT_NODE","COMMENT_NODE","CDATA_SECTION_NODE","getTextContent","isTextNode","convertTextNodeType","newNodeName","formDialog","maxWidth","setAttributes","destroy","execCommand","setClipboard","copy","clipboardElement","getClipboard","resetClipboard","updateModified","previewIndex","$$removed","splice","setModified","addSeparator","addSpacer","_applySelected","_updateHighlightWidget","parentNode","getWidgetPath","_this10","initialValidation","validateXmlConfig","__P_33_11","_file","Main","closeFile","hide","f","setTemporary","_P_33_","_callee2","doc","rootElement","_this11","_context2","fromString","getAttributeNS","sent","getElementNode","getStructure","setEditable","getWriteable","setContentPaddingBottom","substr","_x","_x2","arguments","isAutoRefreshPreview","reset","_this12","previewFile","fast","Prettifier","onSaved","focusedWidget","getFocusedWidget","dialogConf","modal","image","maxHeight","getHeight","BigAlert","_disposeArray","originalContent","modifiedContent","editable","_applyEditable","createDiffEditor","getEditable","getOriginalContent","getModifiedContent","originalModel","modifiedModel","getModifiedEditor","clear","setOriginalContent","_err","upgradedContent","changes","setModifiedContent","changesText","yesButtonLabel","noButtonLabel","resetEditable","resetOriginalContent","resetModifiedContent","_model","__P_31_0","_onModelValueChange","sectionName","Section","optionKey","addOption","__P_31_1","_onDeleteSection","sectionListItem","optionKeys","getOptions","option","getKey","setEnableInlineFind","SectionListItem","_files","_worker","FileWorker","code","features","postMessage","topic","setHash","currentHash","terminate","IModel","setDesktop","_onPointerOver","_onPointerOut","_maintainFileActions","setUploadHint","dereference","showFileActions","themeable","gap","inheritable","acceptUpload","_uploadManager","_forwardStates","focused","dragover","hovered","_applyViewMode","handled","String","firstUp","_applyIcon","__P_37_0","isShowFileActions","editorConf","viewerConf","openButton","editButton","sizeHint","getSizeHint","padding","setPadding","_maintainFileTypePosition","iconBounds","prop","zIndex","anonymous","textAlign","textColor","fireEvent","Tap","getNativeEvent","capture","releaseCapture","uploadManager","showOnly","__P_26_0","_menuBar","MenuBar","_menuButtonConfig","getButtonConfiguration","__P_26_1","newButton","fileController","createPart","marginLeft","MenuButton","_createButton","deleteSelection","checkConfig","Spacer","doNotUseCommand","args","_applyFolder","resetFolder","__P_26_2","_fontIconRegex","_onTap","_iconChildControlName","_applyLabel","_value","_excludeChildControl","_icon","_handleIcon","getShow","_showChildControl","__P_34_0","__P_34_1","_dataProvider","currentPath","__P_34_2","__P_34_3","__P_34_4","__P_34_5","_getSuggestions","_applyCurrentPath","setStructure","pure","providePureCompletionItems","tile","provideTileCompletionItems","getLastOpenedTag","tags","closingTags","tagPosition","lastIndexOf","tag","openedTag","contentSearch","currentAttribute","attrMatch","filteredElementSearch","isAttributeSearch","isContentSearch","findElements","maxDepth","currentDepth","inMeta","cache","isItemAvailable","itemName","maxOccurs","count","getElementString","indent","prefix","insertText","allowedAttributes","getOwnPropertyNames","attr","requiredElements","allowedContent","getAllowedContent","_text","_grouping","trim","elemName","getAvailableElements","usedItems","availableItems","childElem","max","kind","CompletionItemKind","Field","detail","documentation","getAvailableAttributes","usedChildTags","attrs","Property","detectSchema","completeText","triggerCharacters","provideCompletionItems","setCurrentPath","suggestions","vmap","textUntilPosition","lineNumber","column","metaEndPos","textMeta","mappingNames","stylingNames","templates","templatesStart","rawTemplate","nameMatch","variables","vregex","lastOpenedTag","openedTags","openedAttributes","cleanedText","lastChild","lastElementChild","lastFound","attributes","searchedElement","getDesigns","sugg","getTransforms","getPlugins","getIcons","getInfluxDBs","getInfluxDBFields","EnumMember","variableName","Variable","mappingName","stylingName","getNamedItem","getInfluxDBTags","getInfluxDBValues","getAddresses","getRrds","typeFilter","getMediaFiles","currentItem","Value","_schema","TEMPLATES","getTemplates","filterText","insertTextRules","CompletionItemInsertTextRule","InsertAsSnippet","KeepWhitespace","Struct","Method","__filename","__P_43_0","__P_43_1","__P_43_2","_cacheXSD","__P_43_3","schemaFile","structure","__P_43_4","__P_43_5","__P_43_6","_widgetNames","__P_43_7","__P_43_8","__P_43_9","_applyStructure","ajaxRequest","_parseXSD","getReferencedNode","refName","noFallback","fallbackType","getTypeNode","typeNode","getTextNodeSchemaElement","tmpXML","getCommentNodeSchemaElement","getSchemaDOM","getWidgetNames","pageParent","isRoot","isPage","_disposeMap","setTitle","setChanges","setChangeType","changeType","change","getElement","success","isDisposed","getChangeType","getChanges","moveTo","oldIndex","sortable","touch","__P_50_0","_applyDragging","menuButton","getMenu","_applySortable","_addWidgets","addClass","forceScale","alignY","setShow","addLabel","_remove","buttons","_applyEditor","_maintainClipboardButtons","_applyElement","isChildAllowedAtPosition","Number","POSITIVE_INFINITY","__P_28_0","command","Form","labelColumnWidth","useBlocker","blockerOpacity","blockerColor","__P_36_0","__P_36_1","_rootListenerId","_applyFormData","firstWidget","inverse","_formController","removeAllBindings","_form","getValidationManager","_formContainer","modelData","_iterator","_createForOfIteratorHelper","_step","s","n","done","mappedKey","replaceAll","p1","toUpperCase","setQxObjectId","addOwnedQxObject","_onFormReady","atom","_iterator2","_step2","_loop","fieldData","formElement","elementModel","elementModelReady","addGroupHeader","TextArea","setMinimalLineHeight","setAutoSize","setMinHeight","maxLength","setMaxLength","SourceCodeField","language","DateField","dateFormat","setDateFormat","PasswordField","ComboBox","parseComboOptions","listItem","groupName","groupItem","setPlaceholder","VirtualComboBox","iconPath","labelPath","Option","getHints","parseVComboOptions","concat","hints","groupModel","setType","SelectBox","VirtualSelectBox","bindDefaultProperties","iconOptions","orientation","radioButton","setTriState","Spinner","setMinimum","setMaximum","step","setSingleStep","fractionsDigits","fd","nf","NumberFormat","setMinimumFractionDigits","setMaximumFractionDigits","setNumberFormat","reverseOptions","bidirectional","addTarget","selectables","getSelectables","selectable","setRequired","Validate","charAt","regExp","errorMessage","AsyncValidator","proxy","eval","warn","invalidMessage","validationFunc","validatorObj","__P_36_2","isObject","func","view","ElementFormRenderer","getLayout","setColumnFlex","setColumnMaxWidth","getLabelColumnWidth","spacingX","setAllowGrowX","scroll","setMaxHeight","_handleOk","getCallback","getContext","resetCallback","setNode","setSchema","_bounds","_allowedElements","_sortedContent","_subGroupings","elementsHaveOrder","subGroupings","_regexCache","isElementAllowed","_Object$entries","entries","_Object$entries$_i","grouping","subRequiredElements","_i2","myAllowedElements","_i3","_Object$entries2","_Object$entries2$_i","sortNumber","getRegex","separator","nocapture","hasMultiLevelBounds","getBoundsForElementName","regexFromString","input","modifiers","Base","__P_47_0","__P_47_1","__P_47_2","__P_47_3","__P_47_4","xpath","texts","nsResolver","createNSResolver","iterator","evaluate","XPathResult","UNORDERED_NODE_ITERATOR_TYPE","thisNode","iterateNext","textContent","appInfo","_toConsumableArray","_type","_documentation","_documentation2","createDocumentationWebLinks","contents","reference","link","DocumentationMapping","MAP","_base","MAnnotation","getElementName","aSortvalue","bSortvalue","aSortvaluesList","bSortvaluesList","defaultValue","mixed","__P_46_0","__P_46_1","__P_46_2","__P_46_3","setDefaultValue","setMixed","SimpleType","tmpDOMGrouping","Choice","Sequence","Group","Any","sub","subElement","aGroup","attributeGroup","Attribute","getElementsHaveOrder","excludeComment","textOnly","isMixed","getChildBounds","isTextContentAllowed","regexString","boundsMin","boundsMax","getChildrenRegex","_node","setSchemaElement","initName","_updateShowEditButton","_maintainStatus","_initialAttributes","Map","entityMap","&","\"","'","`","deletable","showEditButton","_schemaElement","_initialChildNames","_initialTextContent","__P_44_0","__P_44_1","setStatus","_applyValid","resetInvalidMessage","newType","getText","oldNode","newTextNode","replaceChild","updateDeletable","setShowEditButton","existing","setDeletable","_existing","skipUndo","_move","targetParent","targetChildren","newParent","newIndex","stillAllowed","countExisting","childBounds","textNodes","otherNodes","previousSibling","findPositionForChild","newChild","internalOperation","childNodes","previousChild","before","$$added","_validateTextContent","recursive","nodeValue","setInvalidMessage","_applyTextContent","updateDisplayName","setText","changed","newValue","oldValue","setTextContent","removeAttribute","_oldValue","_changed","isRequired","parentChanges","dom","newNode","_oldValue2","parentChange","_applySchemaElement","_applyModified","hasChildNodes","childNode","_syncChildNodes","childSchemaElement","_child","setSortable","_child2","_child3","getInvalidMessage","appendInvalidMessage","_updateChildrenDeletableFlags","errorMsg","initial","currentChildNames","_currentChildNames","_step$value","names","widgets","ids","c","_c","_parent","cloneNode","__P_35_0","getDataProviderClient","address","#text","grouped","rrd","influx","measurement","live","plugin","pages","design","ga","_id$split","_id$split2","conf","_len","_key","_getFromCache","cacheId","__P_35_1","_addToCache","designs","designStructureMap","designName","__P_35_2","rpc","rpcContext","converterContext","cached","handleResponse","__P_35_3","client","BackendConnections","getClient","authorize","hasProvider","getProviderUrl","getProviderConvertFunction","_parseDpResponseForEditor","_parseDpResponseForMonaco","__P_35_4","withMeasurement","auth","__P_35_5","x","__P_35_6","fsClient","useCache","transforms","Transform","registry","suggestion","lname","plugins","qxParts","PartLoader","getParts","partName","pluginName","icons","iconHandler","iconName","matches","template","firstElementChild","_content","_errors","highlight","colorizeElement","_createDialogContainer","vbox","prologue","labelOptions","allowGrowX","errorBox","errorScroll","decorator","errorLabels","errorId","has","codeSnippet","startIndex","endIndex","minIndent","search","trimRight","escape","headline","buttonPane","_createButtonPane","closeButton","proceedButton","openSourceButton","iconfont","material","Load","_checkEnvironment","initOpenFiles","__P_23_0","ActionDispatcher","setMain","__P_23_1","_onManagerEvent","tooltip","_onBeforeUnload","openFiles","writeableFolder","currentFolder","currentSelection","deleteableSelection","renameableSelection","visible","__P_23_2","__P_23_3","_pane","_tree","_stack","_oldCommandGroup","_managerCommands","_mainContent","_openFilesController","_applyVisible","Style","__P_23_4","checkEnvironmentSync","env","refreshActions","entity","setReadable","setWriteable","resetFocusedWidget","setFocusedWidget","getCurrentSelection","actions","getCurrentFolder","_doClose","configLoader","ConfigLoader","app","bootstrap","setVisible","unsavedFiles","closeCurrentFile","getOpenFiles","openFile","Confirm","_converter$convertPur","convertPureToTile","_converter$convertPur2","convertedContent","suggestedName","_showAbout","returnValue","resetCurrentFolder","__P_23_5","demoFolder","isQuickPreview","__P_23_6","setCurrentFolder","setCurrentSelection","resetCurrentSelection","_applyCurrentFolder","resetWriteableFolder","_applyCurrentSelection","resetDeleteableSelection","_onChangeFileSelection","editorConfig","getHandlerId","setHandlerOptions","GlobalState","setOpenedFocusedFile","resetOpenedFocusedFile","handlerType","isExternal","of","OpenFile","resetHandlerOptions","isPermanent","setPermanent","setModelSelection","checkUnsavedChanged","noButtonIcon","isCloseable","resetPermanent","selectionIndex","currentHandler","hasInterface","fileHandlerConf","oldModel","_onCloseFile","insertEnd","Meta","setTheme","Dark","Command","renameCommand","_onChangeStackSelection","toArray","__P_23_7","prompt","existsMessage","handlePrompt","__P_23_8","domRoot","Inline","setRoot","setLayout","resize","innerHeight","main","Dock","menuBar","uploadButton","getButton","splitpane","Pane","fakeIconFile","leftContainer","leftBar","buttonConfig","FileTabItem","Stack","startOpenFile","setCloseable","DATE","REV","LIBRARY_VERSION","application","DeferredCall","resetRoot","schedule","$$instance","Alert","_hbox","_applyImage","_image","hbox","getImage","_message","setAllowStretchX","okButton","_createOkButton","initOptions","grid","Grid","setColumnAlign","_originalName","_originalOptions","nameField","__P_39_0","__P_39_1","emptyOption","_onDeleteOption","resetKey","resetValue","removed","_onAddOption","row","setNullValueTitle","setAllowNull","OptionListItem","menubar","__P_24_0","__P_24_1","__P_24_2","editorGroup","new-file","new-folder","new-config-file","save-as","hidden","quit","cut","paste","source-editor","general","xml-editor","quick-preview","expert-mode","about","maintainButtons","prefs","getModelSelection","setDefaultConfigEditor","__P_24_3","buttonName","preferenceName","merge","buttonConf","ButtonClass","onAfterCreate","__P_27_0","forceRatio","allowScaleUp","allowShrinkX","allowShrinkY","allowGrowY","loadingFailed","aborted","PLACEHOLDER_IMAGE","__P_27_1","__P_27_2","__P_27_3","__P_27_4","__P_27_5","__P_27_6","_transformSource","_onChangeTheme","_styleSource","__P_27_7","_createContentElement","_getContentHint","_applyDecorator","getSource","AliasManager","getChild","__P_27_8","_applyTextColor","__P_27_9","setStyle","Color","removeStyle","_applyPadding","setStyles","getPaddingTop","html","renderLayout","getPaddingRight","getPaddingBottom","_applyEnabled","_applySource","abort","_applyScale","__P_27_10","isPng","getScale","getForceScale","__P_27_11","connectWidget","overflowX","overflowY","boxSizing","setScale","wrapper","$$disposed","__P_27_13","repeat","tagNameHint","Decoration","getTagName","contentEl","__P_27_14","isFontUri","__P_27_15","color","getTextColor","highResolutionSource","findHighResolutionSource","imageWidth","getImageWidth","imageHeight","getImageHeight","backgroundSize","__P_27_16","__P_27_17","__P_27_18","__P_27_12","AnimationFrame","rId","select","mshtml","alphaImageLoader","isFont","isSvg","__P_27_19","default","elementToAdd","currentContentElement","styles","currentStyles","getAllStyles","backgroundImage","insets","getInsets","getStyle","newEl","setSelectable","getSelectable","isIncluded","removeAt","getNodeName","currentEl","flush","currentDomEl","newDomEl","getListeners","listenerData","self","$$hash","getEnabled","disabled","Font","__P_27_20","_applyDimension","isFailed","__P_27_21","useMarkup","sparts","fontSource","fontStyles","getStyles","fromCharCode","charCode","getDecorator","hasGradient","getStartColor","getEndColor","hasBackground","getBackgroundImage","getAttributes","decoratorStyle","combinedStyles","backgroundPosition","backgroundRepeat","getBackgroundRepeat","imageInfo","failed","_recalc","queue","Layout","originalWidth","originalHeight","getMaxWidth","getMaxHeight","getMinWidth","minHeight","getMinHeight","ratio","getForceRatio","isAllowScaleUp","disconnectWidget","IStringForm","IForm","MForm","changeValue","__P_40_0","__P_40_1","_hasBeenEdited","_autoSize","isAutoSize","contentHeight","getLineCount","_setAreaHeight","_onContentChange","getFocusElement","setHints","setCenter","_onExecute","isTriState","toggleValue","_applyValue","FormRenderer","addItems","_createHeader","_row","colSpan","_createHBoxForRadioGroup","_createWidgetForRadioGroup","_createLabel","audio","bashrc","break","clock","colorchooser","custom-css","custom-cssrules","custom-plugins","customizing","cv-installation-in-terminal","designtoggle","diagram","diagram-influx","diagram-info","docker","docker-openhab-installation","dockerenvironment","enablecache","flavour","gauge","hidden-config","imagetrigger","info-seite","infoaction","infotrigger","install-no-pakets","long-polling","mapping","multitrigger","navbar","nodered-installation-in-terminal","notificationcenterbadge","notifications","openhab-plugin","openweathermap","pagejump","powerspectrum","pushbutton","reporterrors","reporting","rgb","roundbar","rpi-tutorial-cometvisu-in-docker","rrd-introduction","rsslog","size-attributes","slide","speech","sse","strftime","styling","switch","system-voraussetzungen","tile-backend-system","tile-component-button","tile-component-group","tile-component-icon","tile-component-image","tile-component-list","tile-component-menu","tile-component-page","tile-component-popup","tile-component-select","tile-component-slider","tile-component-spinner","tile-component-value","tile-components","tile-element-address","tile-element-address-target","tile-element-backend","tile-element-loader","tile-element-mapping","tile-element-styling","tile-info","tile-media-player","tile-rtc","tile-shutter","tile-simmer","tile-status","tile-switch","tile-tile-pair","tile-widgets","timberwolf","timberwolf-portainer","toggle","tr064","tutorials","urltrigger","video","visu-config-details","web","wgplugin-info","worker","xml-format","xml-format-files","xml-format-header","xml-format-icons","xml-format-mappings","xml-format-pages","xml-format-plugins","xml-format-statusbar","xml-format-stylings","xml-format-templates","__P_48_0","__P_48_1","__P_48_2","__P_48_3","optional","baseType","setOptional","__P_48_4","setBaseType","subnode","subNode","_subnode","patternNode","enumerationNode","getBaseType","boolValid","branchIndices","isRootBranch","j","branches","elementRegexes","_Object$values","values","sortnumber","namesWithSorting","mySortnumber","subSortedElements","subObject","elementBounds","sequenceBounds","resultBounds","isNaN","tmpBounds","mySortNumber","getAttributeName","description","__P_45_0","__P_45_1","_onAction","updateBarButtons","actionHandler","hasHandler","_applyFocusedWidget","_getHandler","getMain","openedFocusedFile","setHandlerId","closeable","__P_42_0","_maintainPermanent","handlerClass","getByName","removeBinding","fileHandler","objectImplements","_transformFilename","_applyPermanent","setFont","_applyCloseable","labelValue","setKey","_applyChange","keyField","valueField","keyTitleField","valueTitleField","__P_38_0","Icon","__P_53_0","__P_53_1","setAttributeNS","svgElem","svg","SvgIcon"],"mappings":"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","sourcesContent":["/* MDragUpload.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Add upload via drag&drop feature to this widget. The including widget must have a\n * \"upload-dropbox\" childcontrol or add\n *  <pre class=\"javascript\">\n *   if (!control) {\n        control = this._createMDragUploadChildControlImpl(id);\n      }\n *   </pre>\n *   to their own _createChildControlImpl method\n */\nqx.Mixin.define('cv.ui.manager.upload.MDragUpload', {\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n  construct : function() {\n    this.setDroppable(true);\n    if (this.getBounds()) {\n      this._applyStartDragListeners();\n    } else {\n      this.addListenerOnce('appear', function() {\n        this._applyStartDragListeners();\n      }, this);\n    }\n    const layout = this._getLayout();\n    if (!(layout instanceof qx.ui.layout.Grow) && !(layout instanceof qx.ui.layout.Canvas)) {\n      this.addListener('resize', this.__syncBounds, this);\n    }\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n  properties : {\n    uploadMode: {\n      check: 'Boolean',\n      init: false,\n      apply: '__applyUploadMode'\n    },\n\n    uploadHint: {\n      check: 'String',\n      init: ''\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Handles HTML5 drop events (dropping external files on dom element)\n     * @param ev {Event}\n     */\n    onHtml5Drop : function (ev) {\n      ev.preventDefault();\n      this.getFiles(ev).forEach(this.uploadFile, this);\n    },\n\n    /**\n     * Uploads the dropped file to the correct folder:\n     * - config files to the resources/config folder\n     * - accepted media files to the resources/config/media folder\n     * @param file {File}\n     * @param replaceFile {cv.ui.manager.model.FileItem?} optional, if set this files content gets replaced with the uploaded ones\n     */\n    uploadFile: function (file, replaceFile) {\n      const isConfig = cv.ui.manager.model.FileItem.isConfigFile(file.name);\n\n      let folder;\n      if (isConfig) {\n        // upload to root folder\n        folder = new cv.ui.manager.model.FileItem('.');\n      } else if (cv.ui.manager.tree.FileSystem.isAccepted(file.type)) {\n        // upload to media folder\n        folder = new cv.ui.manager.model.FileItem('media');\n      }\n      if (folder) {\n        folder.set({\n          type: 'dir'\n        });\n        const manager = new cv.ui.manager.upload.UploadMgr();\n        if (replaceFile) {\n          manager.replaceFile(file, replaceFile);\n        } else {\n          manager.setFolder(folder);\n          manager.uploadFile(file);\n        }\n      }\n    },\n\n    hasDroppableFile: function (ev) {\n      return this.getFiles(ev).length > 0;\n    },\n\n    /**\n     * Extracts acceptable files from event\n     * @param ev {Event}\n     * @private\n     */\n    getFiles: function (ev) {\n      const files = [];\n      let i;\n      let l;\n      let file;\n\n      if (ev.dataTransfer.items) {\n        // Use DataTransferItemList interface to access the file(s)\n        for (i = 0, l = ev.dataTransfer.items.length; i < l; i++) {\n          // If dropped items aren't files, reject them\n          const item = ev.dataTransfer.items[i];\n          if (item.kind === 'file' && cv.ui.manager.tree.FileSystem.isAccepted(item.type)) {\n            file = item.getAsFile();\n            files.push(file);\n          }\n        }\n      } else {\n        for (i = 0, l = ev.dataTransfer.files.length; i < l; i++) {\n          file = ev.dataTransfer.files[i];\n          if (cv.ui.manager.tree.FileSystem.isAccepted(file.type)) {\n            files.push(file);\n          }\n        }\n      }\n      return files;\n    }\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n  members : {\n    __hasEmptyInfo: null,\n    _boundOnStop: null,\n\n    __syncBounds: function () {\n      const bounds = this.getBounds();\n      this.getChildControl('upload-overlay').setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n      this.getChildControl('upload-dropbox').setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n    },\n\n    // overridden\n    _createMDragUploadChildControlImpl: function(id) {\n      let control;\n      const bounds = this.getBounds();\n      const layout = this._getLayout();\n\n      switch (id) {\n        case 'upload-overlay':\n          control = new qx.ui.container.Composite();\n          control.setZIndex(1000000);\n          control.exclude();\n          if (layout instanceof qx.ui.layout.Canvas) {\n            this._add(control, {edge: 0});\n          } else if (!(this._getLayout() instanceof qx.ui.layout.Grow) && bounds) {\n            control.setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n          }\n          this._add(control);\n          this.getChildControl('upload-dropbox').bind('visibility', control, 'visibility');\n          break;\n\n        case 'upload-dropbox': {\n          control = new qx.ui.container.Composite(new qx.ui.layout.Grow());\n          control.setBackgroundColor('rgba(32, 32, 32, 0.9)');\n          control.setZIndex(1000);\n          const dropBox = new qx.ui.basic.Atom(this.getUploadHint(), cv.theme.dark.Images.getIcon('upload', 32));\n          dropBox.set({\n            iconPosition: 'top',\n            rich: true,\n            center: true\n          });\n          // control.bind('width', dropBox, 'maxWidth');\n          dropBox.getChildControl('label').setWrap(true);\n          control.setAnonymous(true);\n          control.add(dropBox);\n          control.exclude();\n          if (layout instanceof qx.ui.layout.Canvas) {\n            this._add(control, {edge: 0});\n          } else if (!(this._getLayout() instanceof qx.ui.layout.Grow) && bounds) {\n            control.setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n          }\n          this._add(control);\n          break;\n        }\n      }\n      return control;\n    },\n\n    _onStopDragging: function(ev) {\n      ev.preventDefault();\n      this.setUploadMode(false);\n      document.removeEventListener('dragend', this._boundOnStop, false);\n    },\n\n    /**\n     * Apply dragover/-leave listeners to the dashboard to recognize File uploads via Drag&Drop\n     */\n    _applyStartDragListeners: function() {\n      // add the start listener to this widget\n      this.getContentElement().getDomElement().addEventListener('dragenter', function(ev) {\n        // ev.preventDefault();\n        if (this._isDroppable) {\n          if (this._isDroppable(ev.dataTransfer.items)) {\n            // we have something to drop\n            this.setUploadMode(true);\n          }\n        } else if (cv.ui.manager.upload.MDragUpload.hasDroppableFile(ev)) {\n          // we have something to drop\n          this.setUploadMode(true);\n        }\n      }.bind(this), false);\n      if (this.getChildControl('upload-overlay').getBounds()) {\n        this._applyDragListeners();\n      } else {\n        this.getChildControl('upload-overlay').addListenerOnce('appear', function() {\n          this._applyDragListeners();\n        }, this);\n      }\n    },\n\n    /**\n     * Apply dragover/-leave listeners to the dashboard to recognize File uploads via Drag&Drop\n     */\n    _applyDragListeners: function() {\n      const element = this.getChildControl('upload-overlay').getContentElement().getDomElement();\n      if (!element) {\n        const lid = this.getChildControl('upload-overlay').addListener('visibility', function (ev) {\n          if (ev.getData() === 'visible') {\n            this._applyDragListeners();\n            this.getChildControl('upload-overlay').removeListenerById(lid);\n          }\n        }, this);\n        return;\n      }\n      element.addEventListener('dragexit', function() {\n        this.setUploadMode(false);\n      }.bind(this), false);\n\n      element.addEventListener('dragover', function (ev) {\n        ev.preventDefault();\n        let uploadable = false;\n        if (this._isDroppable) {\n          uploadable = this._isDroppable(ev.dataTransfer.items);\n        } else if (cv.ui.manager.upload.MDragUpload.hasDroppableFile(ev)) {\n          uploadable = true;\n        }\n        this.setUploadMode(uploadable);\n      }.bind(this), false);\n\n      this._boundOnStop = this._onStopDragging.bind(this);\n\n      element.addEventListener('dragleave', this._boundOnStop, false);\n      element.addEventListener('dragend', function() {\n        this.setUploadMode(false);\n      }.bind(this), false);\n\n      document.addEventListener('dragend', this._boundOnStop, false);\n\n      if (this._onDrop) {\n        element.addEventListener('drop', this._onDrop.bind(this), false);\n      } else {\n        element.addEventListener('drop', function (ev) {\n          cv.ui.manager.upload.MDragUpload.onHtml5Drop(ev);\n          this._onStopDragging(ev);\n        }.bind(this), false);\n      }\n    },\n\n    // property apply\n    __applyUploadMode: function(value) {\n      if (value === true) {\n        this.getChildControl('upload-dropbox').show();\n        if (this.hasChildControl('empty-info') && this.getChildControl('empty-info').isVisible()) {\n          this.getChildControl('empty-info').exclude();\n          this.__hasEmptyInfo = true;\n        } else {\n          this.__hasEmptyInfo = false;\n        }\n      } else {\n        this.getChildControl('upload-dropbox').exclude();\n        if (this.__hasEmptyInfo === true) {\n          this.getChildControl('empty-info').show();\n        }\n      }\n    }\n  }\n});\n","/* FileSystem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Shows filesystem content in a tree.\n */\nqx.Class.define('cv.ui.manager.tree.FileSystem', {\n  extend: qx.ui.core.Widget,\n  include: [\n    cv.ui.manager.upload.MDragUpload\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (rootFolder) {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this.setRootFolder(rootFolder);\n\n    qx.event.message.Bus.subscribe('cv.manager.tree.enable', this._onEnableTree, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    MIMETYPES: {\n      'text/xml': 'xml',\n      'application/xml': 'xml',\n      'text/javascript': 'js',\n      'application/x-httpd-php': 'php',\n      'text/css': 'css',\n      'image/png': 'png',\n      'image/svg+xml': 'svg',\n      'text/plain': ''\n    },\n\n    getMimetypeFromSuffix: function (suffix) {\n      return Object.keys(this.MIMETYPES).find(function (mime) {\n        return this.MIMETYPES[mime] === suffix;\n      }, this);\n    },\n\n    isAccepted: function (mimetype) {\n      return Object.prototype.hasOwnProperty.call(this.MIMETYPES, mimetype);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'changeSelection': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    // appearance: {\n    //   refine: true,\n    //   init: 'cv-filesystem'\n    // },\n\n    rootFolder: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_applyRootFolder'\n    },\n\n    selectedNode: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_applySelectedNode',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __selectionTimer: null,\n    __doubleTapWaitingTime: 500,\n    __ignoreSelectionChange: false,\n    _replacementManager: null,\n\n    reload: function () {\n      const tree = this.getChildControl('tree');\n      const openPaths = tree.getOpenNodes().map(function (node) {\n        return node.getFullPath();\n      });\n      const root = tree.getModel();\n      root.reload(function () {\n        this.getChildControl('tree').refresh();\n        root.setOpen(true);\n        openPaths.forEach(this.openPath, this);\n      }, this);\n    },\n\n    openPath: function (path) {\n      const root = this.getChildControl('tree').getModel();\n      if (path === '.') {\n        root.setOpen(true);\n      } else {\n        root.setOpen(true);\n        root.openPath(path);\n      }\n    },\n\n    refresh: function () {\n      this.getChildControl('tree').refresh();\n    },\n\n    _applyRootFolder: function (value) {\n      if (value) {\n        const tree = this.getChildControl('tree');\n        tree.setModel(value);\n        value.load(function () {\n          tree.setHideRoot(true);\n        }, this);\n      }\n    },\n\n    _applySelectedNode: function (value) {\n      const tree = this.getChildControl('tree');\n      const contextMenu = cv.ui.manager.contextmenu.GlobalFileItem.getInstance();\n      contextMenu.configure(value);\n      if (value) {\n        tree.setContextMenu(contextMenu);\n      }\n    },\n\n    setSelection : function (node) {\n      this.getChildControl('tree').getSelection().replace([node]);\n    },\n\n    _onDblTapTreeSelection: function () {\n      const sel = this.getSelectedNode();\n      if (sel) {\n        if (this.__selectionTimer) {\n          this.__selectionTimer.stop();\n        }\n        // only files show a different behaviour when double-clicked (permanent vs. preview mode)\n        if (sel.getType() === 'file') {\n          this.fireDataEvent('changeSelection', {\n            'node': sel,\n            'mode': 'dbltap'\n          });\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function () {\n      if (this.__selectionTimer) {\n        this.__selectionTimer.stop();\n      }\n      if (this.__ignoreSelectionChange === true) {\n        return;\n      }\n      const tree = this.getChildControl('tree');\n      const sel = tree.getSelection();\n      if (sel.length > 0) {\n        const node = sel.getItem(0);\n        this.setSelectedNode(node);\n        // wait for double tap\n        if (node.getType() === 'file') {\n          this.__selectionTimer = qx.event.Timer.once(function () {\n            this.fireDataEvent('changeSelection', {\n              'node': this.getSelectedNode(),\n              'mode': 'tap'\n            });\n            this.__selectionTimer = null;\n          }, this, this.__doubleTapWaitingTime);\n        } else {\n          this.fireDataEvent('changeSelection', {\n            'node': node,\n            'mode': 'tap'\n          });\n        }\n      } else {\n        tree.resetContextMenu();\n        this.resetSelectedNode();\n      }\n    },\n\n    _onFsItemRightClick: function (ev) {\n      const tree = this.getChildControl('tree');\n      const widget = ev.getTarget();\n      if (widget instanceof cv.ui.manager.tree.VirtualFsItem) {\n        const node = widget.getModel();\n        if (node) {\n          this.__ignoreSelectionChange = true;\n          tree.getSelection().replace([node]);\n          this.setSelectedNode(node);\n          this.fireDataEvent('changeSelection', {\n            'node': node,\n            'mode': 'contextmenu'\n          });\n          this.__ignoreSelectionChange = false;\n        }\n      }\n    },\n\n    /**\n     * Handle message on 'cv.manager.tree.enable' topic.\n     * @param ev {Event}\n     * @protected\n     */\n    _onEnableTree: function (ev) {\n      this.getChildControl('tree').setEnabled(ev.getData());\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'name', 'children');\n           control.set({\n             selectionMode: 'single',\n             minWidth: 250,\n             showTopLevelOpenCloseIcons: true\n           });\n           cv.ui.manager.model.Preferences.getInstance().bind('quickPreview', control, 'openMode', {\n             converter: function (value) {\n               return value ? 'tap' : 'dbltap';\n             }\n           });\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualFsItem();\n               item.addListener('dbltap', this._onDblTapTreeSelection, this);\n               item.addListener('contextmenu', this._onFsItemRightClick, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem : function(controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('readable', 'enabled', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('editing', 'editing', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this._add(control);\n           break;\n       }\n\n       if (!control) {\n         control = this._createMDragUploadChildControlImpl(id);\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.tree.enable', this._onEnableTree, this);\n\n    this._disposeObjects('_dateFormat', '_timeFormat', '_replacementManager');\n  }\n});\n","/* Controller.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Main view component responsible for showing a list of snackbar messages.\n */\nqx.Class.define('cv.ui.manager.snackbar.Controller', {\n  extend: qx.ui.core.Widget,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.VBox(8));\n    this.initMessages(new qx.data.Array());\n    qx.event.message.Bus.subscribe('cv.manager.msg.snackbar', this._onMessage, this);\n    this._listController = new qx.data.controller.List(this.getMessages(), this.getChildControl('list'));\n    this._initDelegate();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    info: function (message) {\n      const msg = new cv.ui.manager.model.Message();\n      msg.set({\n        title: message\n      });\n      qx.event.message.Bus.dispatchByName('cv.manager.msg.snackbar', msg);\n    },\n\n    error: function (message) {\n      const msg = new cv.ui.manager.model.Message();\n      if (typeof message === 'object' && Object.prototype.hasOwnProperty.call(message, 'statusText')) {\n        message = message.statusText;\n      }\n      msg.set({\n        title: message,\n        type: 'error',\n        sticky: true\n      });\n      qx.event.message.Bus.dispatchByName('cv.manager.msg.snackbar', msg);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-snackbar'\n    },\n\n    messages: {\n      check: 'qx.data.Array',\n      deferredInit: true,\n      event: 'changeMessages'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n\n    _onMessage: function (ev) {\n      const msg = ev.getData();\n      if (msg instanceof cv.ui.manager.model.Message) {\n        this.getMessages().push(msg);\n        this.show();\n      }\n    },\n\n    _onCloseMessage: function (ev) {\n      const msg = ev.getData();\n      this.getMessages().remove(msg);\n      if (this.getMessages().length === 0) {\n        this.exclude();\n      }\n    },\n\n    _initDelegate: function () {\n      this._listController.setDelegate({\n        createItem: function () {\n          const item = new cv.ui.manager.snackbar.Message();\n          item.addListener('close', this._onCloseMessage, this);\n          return item;\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n        }\n      });\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'list':\n           control = new qx.ui.form.List();\n           this._add(control, {flex: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.msg.snackbar', this._onMessage, this);\n    this._disposeObjects('_listController');\n  }\n});\n","/* MFileEventHandler.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Mixin for all classes that have to handle event on the 'cv.manager.file' topic.\n * Those classes need to implement the cv.ui.manager.control.IFileEventHandler interface.\n */\nqx.Mixin.define('cv.ui.manager.control.MFileEventHandler', {\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    if (qx.core.Environment.get('qx.debug')) {\n      qx.core.Assert.assertInterface(this, cv.ui.manager.control.IFileEventHandler);\n    }\n    if (!this._disableFileEvents) {\n      qx.event.message.Bus.subscribe('cv.manager.file', this._handleFileEvent, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _disableFileEvents: false\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.file', this._handleFileEvent, this);\n  }\n});\n","/* IFileEventHandler.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Interface.define('cv.ui.manager.control.IFileEventHandler', {\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _handleFileEvent: function (ev) {}\n  }\n});\n","/* FileItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Represents an entry in the filesystem (file or folder).\n */\nqx.Class.define('cv.ui.manager.model.FileItem', {\n  extend: qx.core.Object,\n  include: [\n    qx.data.marshal.MEventBubbling,\n    cv.ui.manager.control.MFileEventHandler\n  ],\n  implement: [cv.ui.manager.control.IFileEventHandler],\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name, path, parent, fakeChildren) {\n    this.base(arguments);\n    this.initChildren(new qx.data.Array());\n    if (fakeChildren) {\n      this.setFakeChildren(fakeChildren);\n    }\n    if (path) {\n      if (!path.endsWith('/')) {\n        path += '/';\n      }\n      this.__path = path;\n    }\n    if (name) {\n      this.setName(name);\n    }\n    if (parent) {\n      this.setParent(parent);\n    }\n    if (qx.core.Environment.get('qx.dynlocale')) {\n      qx.locale.Manager.getInstance().addListener('changeLocale', this._onChangeLocale, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    ROOT: null,\n    _fakeIconFile: null,\n    _hiddenConfigFakeFile: null,\n    _acceptedFiles: {\n      '.': '*.xml',\n      'media': '*.js,*.jpg,*.gif,*.png,*.conf,*.svg,*.md,*.rst,*,css,*.txt'\n    },\n\n    isConfigFile: function (path) {\n      return /visu_config.*\\.xml/.test(path);\n    },\n\n    getConfigName: function (filename) {\n      const match = /visu_config_?([^.]+)\\.xml/.exec(filename);\n      if (match) {\n        return match[1];\n      }\n      return null;\n    },\n\n    getIconFile: function () {\n      if (!this._fakeIconFile) {\n        this._fakeIconFile = new cv.ui.manager.model.FileItem('CometVisu-Icons', '', cv.ui.manager.model.FileItem.ROOT).set({\n          type: 'file',\n          overrideIcon: true,\n          writeable: false,\n          readable: true,\n          open: true,\n          loaded: true,\n          hasChildren: false,\n          fake: true,\n          icon: cv.theme.dark.Images.getIcon('icons', 18)\n        });\n      }\n      return this._fakeIconFile;\n    },\n\n    getHiddenConfigFile: function () {\n      if (!this._hiddenConfigFakeFile) {\n        this._hiddenConfigFakeFile = new cv.ui.manager.model.FileItem('hidden.php', '', cv.ui.manager.model.FileItem.ROOT).set({\n          hasChildren: false,\n          loaded: true,\n          readable: true,\n          writeable: true,\n          overrideIcon: true,\n          icon: cv.theme.dark.Images.getIcon('hidden-config', 15),\n          type: 'file',\n          fake: true,\n          displayName: qx.locale.Manager.tr('Hidden configuration')\n        });\n      }\n      return this._hiddenConfigFakeFile;\n    },\n\n    getAcceptedFiles: function (folder) {\n      return this._acceptedFiles[folder.getFullPath()];\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    open : {\n      check : 'Boolean',\n      event : 'changeOpen',\n      apply : '_onOpen',\n      init : false\n    },\n\n    loaded : {\n      check : 'Boolean',\n      event : 'changeLoaded',\n      init : false\n    },\n\n    loading : {\n      check : 'Boolean',\n      event : 'changeLoading',\n      init : false\n    },\n\n    parent : {\n      event : 'changeParent',\n      init : null\n    },\n\n    children : {\n      check : 'qx.data.Array',\n      event : 'changeChildren',\n      apply: '_applyEventPropagation',\n      deferredInit : true\n    },\n\n    fakeChildren: {\n      check: 'Array',\n      nullable: true\n    },\n\n    displayName: {\n      check: 'String',\n      init: '',\n      event: 'changeDisplayName'\n    },\n\n    /**\n     * Fake items only exist in the client not in the backend\n     */\n    fake: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeFake'\n    },\n\n    overrideIcon: {\n      check: 'Boolean',\n      init: false\n    },\n\n    icon: {\n      check: 'String',\n      nullable: true,\n      event: 'changeIcon'\n    },\n\n    hash: {\n      check: 'Number',\n      nullable: true\n    },\n\n    editing: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeEditing'\n    },\n\n    /**\n     * A special configuration option for mulitple purposes, e.g. creating a fake FileItem with a special\n     * behaviour like an \"Add new File\" used in writeable Folders.\n     */\n    special: {\n      check: 'String',\n      nullable: true,\n      event: 'changeSpecial'\n    },\n\n    /**\n     * Temporary file are not save in the backend yet\n     */\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTemporary'\n    },\n\n    /**\n     * Validation result for this files content (e.g. config file validation)\n     */\n    valid: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeValid'\n    },\n\n    /**\n     * The validation of this files content found some warnings\n     */\n    hasWarnings: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeHasWarnings'\n    },\n\n    /**\n     * Temporary content to show, e.g. for new files, when there is no 'real' file with content yet to request from the backend\n     * this content should be shown\n     */\n    content: {\n      check: 'String',\n      nullable: true\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    },\n\n    // Backend properties\n\n    hasChildren : {\n      check : 'Boolean',\n      event : 'changeHasChildren',\n      apply : '_applyHasChildren',\n      init : false\n    },\n\n    name : {\n      check : 'String',\n      event : 'changeName',\n      init : '',\n      apply: '_applyName'\n    },\n\n    type: {\n      check: ['dir', 'file'],\n      transform: '_toLowerCase',\n      nullable: true,\n      apply: '_maintainIcon'\n    },\n\n    parentFolder: {\n      check: 'String',\n      nullable: true\n    },\n\n    readable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadable'\n    },\n\n    writeable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeWriteable'\n    },\n\n    mounted: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeMounted'\n    },\n\n    trash: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTrash'\n    },\n\n    inTrash: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeInTrash'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __path: null,\n    __fullPath: null,\n    __onLoadCallback: null,\n\n    _toLowerCase: function (name) {\n      return name.toLowerCase();\n    },\n\n    isRelated: function (path) {\n      return this.getFullPath() === path;\n    },\n\n    _handleFileEvent: function (ev) {\n      if (this.isFake()) {\n        return;\n      }\n      const data = ev.getData();\n      switch (data.action) {\n        case 'moved':\n          this.reload();\n          break;\n\n        case 'added':\n          if (this.getType() === 'dir' && data.path.startsWith(this.getFullPath())) {\n            this.reload();\n          }\n          break;\n\n        case 'deleted':\n          if (data.path === this.getFullPath()) {\n            // this item has been deleted\n            this.dispose();\n          } else if (this.getType() === 'dir' && data.path.startsWith(this.getFullPath())) {\n            // delete child\n            const children = this.getChildren();\n            children.some(function (child) {\n              if (child.getFullPath() === data.path) {\n                children.remove(child);\n                this.removeRelatedBindings(child);\n                return true;\n              }\n              return false;\n            }, this);\n          }\n          break;\n      }\n    },\n\n    _applyName: function (value, old) {\n      this.__fullPath = null;\n      if (value && (this.getDisplayName() === null || this.getDisplayName() === old)) {\n        // use name as default display name\n        this.setDisplayName(value);\n      }\n    },\n\n    getPath: function () {\n      if (!this.__path) {\n        let parentFolder = this.getParentFolder();\n        if (!parentFolder) {\n          parentFolder = '';\n        } else if (!parentFolder.endsWith('/')) {\n          parentFolder += '/';\n        }\n        this.__path = parentFolder;\n      }\n      return this.__path;\n    },\n\n    _onOpen : function(value) {\n      if (!this.isLoaded() && value) {\n        this.load();\n      }\n      this._maintainIcon();\n    },\n\n    _maintainIcon: function () {\n      if (!this.isOverrideIcon()) {\n        if (this.getType() === 'file') {\n          this.setIcon(cv.theme.dark.Images.getIcon('file', 18));\n        } else if (this.isTrash()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('trash', 18));\n        } else if (this.isOpen()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('folder-open', 18));\n        } else if (this.isMounted()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('mounted-folder', 18));\n        } else {\n          this.setIcon(cv.theme.dark.Images.getIcon('folder', 18));\n        }\n      }\n    },\n\n    isConfigFile: function () {\n      return cv.ui.manager.model.FileItem.isConfigFile(this.getName());\n    },\n\n    _applyHasChildren: function (value) {\n      if (value === true && this.getChildren().length === 0) {\n        // add dummy child\n        this.getChildren().push(new cv.ui.manager.model.FileItem(''));\n      }\n    },\n\n    unload: function() {\n      this.setLoaded(false);\n      this.setLoading(false);\n      this.getChildren().removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n    },\n\n    reload : function(callback, context) {\n      this.unload();\n      return this.load(callback, context);\n    },\n\n    addChild: function (child) {\n      const oldParent = child.getParent();\n      if (oldParent !== this) {\n        oldParent.getChildren().remove(child);\n        oldParent.removeRelatedBindings(child);\n      }\n      child.setParent(this);\n      if (child.getType() !== 'dir' || !child.isMounted()) {\n        // inherit the mounted state from the parent folder\n        this.bind('mounted', child, 'mounted');\n      }\n      this.getChildren().push(child);\n    },\n\n    _onGet: function (data) {\n      const children = this.getChildren();\n      children.removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n      if (data) {\n        data.forEach(function (node) {\n          const child = new cv.ui.manager.model.FileItem(null, null, this);\n          if (Object.prototype.hasOwnProperty.call(node, 'children')) {\n            const nodeChildren = node.children;\n            delete node.children;\n            if (nodeChildren.length > 0) {\n              child.getChildren().replace(nodeChildren);\n              child.setLoaded(true);\n            }\n          }\n          child.set(node);\n          children.push(child);\n        }, this);\n      }\n      if (this.getFakeChildren()) {\n        children.append(this.getFakeChildren());\n      }\n      this.sortElements();\n\n      this.setLoaded(true);\n      if (this.__onLoadCallback) {\n        this.__onLoadCallback();\n      }\n      this.setLoading(false);\n    },\n\n    _onError: function (err) {\n      this.error(err);\n      cv.ui.manager.snackbar.Controller.error(err);\n      this.getChildren().removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n      this.setLoaded(true);\n      if (this.__onLoadCallback) {\n        this.__onLoadCallback();\n      }\n      this.setLoading(false);\n    },\n\n    load: function(callback, context) {\n      // If currently loading, delay ready\n      if (this.getType() === 'file') {\n        // nothing to load\n        this.setLoaded(true);\n        return;\n      } else if (this.isFake()) {\n        this.setLoaded(true);\n        if (this.getFakeChildren()) {\n          this.getChildren().append(this.getFakeChildren());\n        }\n        return;\n      }\n      if (this.isLoading()) {\n        if (callback) {\n          this.addListenerOnce('changeLoading', callback, context);\n        }\n      } else if (this.isLoaded()) {\n        // If not done yet, resolve the child elements of this container\n        if (callback) {\n          callback.apply(context);\n        }\n      } else {\n        this.setLoading(true);\n        if (callback) {\n          this.__onLoadCallback = callback.bind(context || this);\n        }\n        cv.io.rest.Client.getFsClient().readSync({path: this.getFullPath()}, function (err, res) {\n          if (err) {\n            this._onError(err);\n          } else {\n            this._onGet(res);\n          }\n        }, this);\n      }\n    },\n\n    /**\n     * Returns the complete path needed for the REST API  to identify this file\n     * @returns {null}\n     */\n    getFullPath: function () {\n      if (!this.__fullPath) {\n        this.__fullPath = this.getPath() + this.getName();\n      }\n      return this.__fullPath;\n    },\n\n    getBusTopic: function () {\n      return 'cv.manager.fs.' + this.getFullPath().replace(/\\//g, '.');\n    },\n\n    /**\n     * Returns a fake URI that can be used to identify the file.\n     * Used by monaco editor as model URI.\n     * @returns {Uri}\n     */\n    getUri: function () {\n      return 'cv://' + this.getFullPath();\n    },\n\n    /**\n     * Returns the path to this file for requests over HTTP (not the REST API)\n     *\n     * Note: Please be aware that this path does not work if the file is in a mounted folder\n     * like the demo configs. The backend handles those mounts transparently to the client. But\n     * because of that the client does not know the real path to the file.\n     *\n     * @returns {string}\n     */\n    getServerPath: function () {\n      if (!this.isMounted()) {\n        return qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/config/' + this.getFullPath();\n      }\n      return qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/' + this.getFullPath();\n    },\n\n    /**\n     *  Sort entries: folders first, files then\n     */\n    sortElements: function () {\n      const sortF = function (a, b) {\n        if (a.getType() === 'dir') {\n          if (b.getType() === 'dir') {\n            if (a.isTrash()) {\n              return 1;\n            } else if (b.isTrash()) {\n              return -1;\n            }\n            return a.getName().localeCompare(b.getName());\n          }\n          return -1;\n        } else if (b.getType() === 'dir') {\n          return 1;\n        }\n        return a.getName().localeCompare(b.getName());\n      };\n      this.getChildren().sort(sortF);\n    },\n\n    openPath: function (path) {\n      const parts = qx.lang.Type.isArray(path) ? path : path.split('/');\n      const relPath = parts.shift();\n      this.getChildren().some(function (child) {\n        if (child.getName() === relPath) {\n          child.load(function () {\n            child.setOpen(true);\n            if (parts.length > 0) {\n              child.openPath(parts);\n            }\n          }, this);\n          return true;\n        }\n        return false;\n      }, this);\n    },\n\n    _onChangeLocale : qx.core.Environment.select('qx.dynlocale', {\n      'true': function () {\n        const content = this.getDisplayName();\n        if (content && content.translate) {\n          this.setDisplayName(content.translate());\n        }\n      },\n\n      'false' : null\n    })\n  },\n  \n  /*\n  ***********************************************\n    DESTRUCTOR  \n  ***********************************************\n  */\n  destruct: function () {\n    this.__fullPath = null;\n  } \n});\n","/* UploadMgr.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Extend {com.zenesis.qx.upload.UploadMgr} to allow files to e uploaded via HTML5 drop\n */\nqx.Class.define('cv.ui.manager.upload.UploadMgr', {\n  extend : com.zenesis.qx.upload.UploadMgr,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (widget, uploadUrl) {\n    this.base(arguments, widget, uploadUrl);\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    LAST_ID: 0\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    multiple: {\n      refine: true,\n      init: false\n    },\n\n    folder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_updateUploadUrl'\n    },\n\n    filename: {\n      check: 'String',\n      nullable: true\n    },\n\n    force: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  members : {\n\n    _updateUploadUrl: function () {\n      const folder = this.getFolder();\n      const path = folder ? folder.getFullPath() : '.';\n      const url = cv.io.rest.Client.getBaseUrl() + '/fs?type=file&path=' + path;\n      this.setUploadUrl(url);\n    },\n\n    _init: function () {\n      this.addListener('addFile', function(evt) {\n        const file = evt.getData();\n        const filename = this.getFilename();\n        if (filename) {\n          file.setParam('filename', filename);\n        }\n        if (this.isForce()) {\n          file.setParam('force', true);\n        }\n        const progressListenerId = file.addListener('changeProgress', function (evt) {\n          const file = evt.getTarget();\n          const uploadedSize = evt.getData();\n\n          this.debug('Upload ' + file.getFilename() + ': ' +\n            uploadedSize + ' / ' + file.getSize() + ' - ' +\n            Math.round(uploadedSize / file.getSize() * 100) + '%');\n        }, this);\n\n        const stateListenerId = file.addListener('changeState', function (evt) {\n          const state = evt.getData();\n          const file = evt.getTarget();\n\n          if (state === 'uploading') {\n            this.debug(file.getFilename() + ' (Uploading...)');\n          } else if (state === 'uploaded') {\n            this.debug(file.getFilename() + ' (Complete)');\n            if (file.getStatus() !== 200) {\n              // something went wrong\n              switch (file.getStatus()) {\n                case 406:\n                  if (this.isForce()) {\n                    cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Replacing the file failed.'));\n                  } else {\n                    qxl.dialog.Dialog.confirm(qx.locale.Manager.tr('This file already exists, do you want to replace it?'), function (confirmed) {\n                      if (confirmed) {\n                        this.forceUpload(file);\n                      }\n                    }, this, qx.locale.Manager.tr('File already exists'));\n                  }\n                  break;\n\n                case 403:\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Uploading this file is not allowed here.'));\n                  break;\n\n                default: {\n                  let err = file.getResponse();\n                  try {\n                    err = qx.lang.Json.parse(err).message;\n                  } catch (e) {\n                  }\n                  this.error(err);\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('File upload stopped with an error: %1', err));\n                  break;\n                }\n              }\n            } else {\n              cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('File has been uploaded'));\n              qx.event.message.Bus.dispatchByName('cv.manager.file', {\n                action: 'uploaded',\n                path: this.getFolder().getFullPath() + '/' + file.getFilename()\n              });\n            }\n          } else if (state === 'cancelled') {\n            this.debug(file.getFilename() + ' (Cancelled)');\n          }\n          // Remove the listeners\n          if (state === 'uploaded' || state === 'cancelled') {\n            file.removeListenerById(progressListenerId);\n            file.removeListenerById(stateListenerId);\n          }\n        }, this);\n      }, this);\n    },\n\n    /**\n     * Allocates a unique ID\n     *\n     * @return {Number}\n     */\n    _getUniqueFileId: function() {\n      return ++cv.ui.manager.upload.UploadMgr.LAST_ID;\n    },\n\n    /**\n     * Re-upload a file in forced mode\n     * @param file {com.zenesis.qx.upload.File}\n     */\n    forceUpload: function (file) {\n      this.setForce(true);\n      const newFile = new com.zenesis.qx.upload.File(file.getBrowserObject(), file.getFilename(), file.getId());\n      newFile.set({\n        size: file.getSize(),\n        uploadWidget: file.getUploadWidget()\n      });\n      newFile.setParam('force', true);\n      this.getUploadHandler()._addFile(newFile);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    },\n\n    /**\n     * Upload file directly to the backend\n     *\n     * @param bomFile {File}\n     */\n    uploadFile: function(bomFile) {\n      const id = 'upload-' + this._getUniqueFileId();\n      const filename = typeof bomFile.name !== 'undefined' ? bomFile.name : bomFile.fileName;\n      const file = new com.zenesis.qx.upload.File(bomFile, filename, id);\n      const fileSize = typeof bomFile.size !== 'undefined' ? bomFile.size : bomFile.fileSize;\n      file.setSize(fileSize);\n      if (this.isForce()) {\n        file.setParam('force', true);\n      }\n      file.setUploadWidget(new com.zenesis.qx.upload.UploadButton());\n\n      this.getUploadHandler()._addFile(file);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    },\n\n    /**\n     * Replace content of existing file with the upload\n     * @param bomFile {File}\n     * @param replacedFile {cv.ui.manager.model.FileItem}\n     */\n    replaceFile: function(bomFile, replacedFile) {\n      this.setFolder(replacedFile.getParent());\n      const id = 'upload-' + this._getUniqueFileId();\n      const filename = replacedFile.getName();\n      const file = new com.zenesis.qx.upload.File(bomFile, filename, id);\n      file.setParam('force', true);\n      file.setParam('filename', filename);\n      const fileSize = typeof bomFile.size !== 'undefined' ? bomFile.size : bomFile.fileSize;\n      file.setSize(fileSize);\n      file.setUploadWidget(new com.zenesis.qx.upload.UploadButton());\n\n      this.getUploadHandler()._addFile(file);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    }\n  }\n});\n","/* FileItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.contextmenu.FileItem', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (file, noCompare) {\n    this.base(arguments);\n    this._noCompare = noCompare === true;\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n    this._dateFormat = new qx.util.format.DateFormat(qx.locale.Date.getDateFormat('medium'));\n    this._timeFormat = new qx.util.format.DateFormat(qx.locale.Date.getTimeFormat('medium'));\n\n    if (file) {\n      this.configure(file);\n    }\n\n    // only react to events when this menu is visible\n    this.addListener('appear', function () {\n      this.setActive(true);\n    });\n    this.addListener('disappear', function () {\n      this.setActive(false);\n    });\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-file-contextmenu'\n    },\n    \n    /* This flag enables the event handling for this menu */\n    active: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _commandGroup: null,\n    _selectedNode: null,\n    _dateFormat: null,\n    _timeFormat: null,\n    _renameDialog: null,\n    _noCompare: false,\n\n    configure: function (file) {\n      this._selectedNode = file;\n      if (file) {\n        const isFolder = file.getType() === 'dir';\n        const folder = isFolder ? file : file.getParent();\n        let isBackup = false;\n        if (folder && folder.getFullPath().startsWith('backup') || file.getFullPath().startsWith('backup')) {\n          isBackup = true;\n        }\n        if (!isFolder) {\n          this.getChildControl('new-file-button').exclude();\n          this.getChildControl('new-folder-button').exclude();\n        } else {\n          this.getChildControl('new-file-button').set({\n            enabled: folder && !isBackup ? folder.isWriteable() : false,\n            visibility: 'visible'\n          });\n          this.getChildControl('new-folder-button').set({\n            enabled: folder && !isBackup ? folder.isWriteable() : false,\n            visibility: 'visible'\n          });\n        }\n        this.getChildControl('clone-file-button').setVisibility(file.isConfigFile() && !isBackup ? 'visible' : 'excluded');\n        this.getChildControl('convert-file-button').setVisibility(file.isConfigFile() && !file.isMounted() && !isBackup ? 'visible' : 'excluded');\n        this.getChildControl('delete-button').setLabel(file.isTrash()\n          ? this.tr('Clear')\n          : this.tr('Delete'));\n\n        // create compare menu\n        if (!this._noCompare) {\n          const compareMenu = this.getChildControl('compare-menu');\n          compareMenu.removeAll();\n          if (!isBackup) {\n            this.getChildControl('compare-with-button').show();\n            const backups = cv.ui.manager.model.BackupFolder.getInstance().getBackupFiles(file);\n            this.getChildControl('compare-with-button').setEnabled(backups.length > 0);\n            backups.sort(function (a, b) {\n              return b.date.getTime() - a.date.getTime();\n            });\n            let group = null;\n            backups.forEach(function (backupEntry) {\n              const date = this._dateFormat.format(backupEntry.date);\n              if (group !== date) {\n                if (group !== null) {\n                  compareMenu.add(new qx.ui.menu.Separator());\n                }\n                const groupButton = new qx.ui.menu.Button(date);\n                groupButton.setEnabled(false);\n                compareMenu.add(groupButton);\n                group = date;\n              }\n              const button = new qx.ui.menu.Button(this.tr('Backup from %1', this._timeFormat.format(backupEntry.date)));\n              button.setUserData('file', backupEntry.file);\n              button.addListener('execute', this._onCompareWith, this);\n              compareMenu.add(button);\n            }, this);\n          } else {\n            this.getChildControl('compare-with-button').exclude();\n          }\n        }\n\n        const defaultHandler = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n\n        // open with menu\n        const openWithMenu = this.getChildControl('open-with-menu');\n        openWithMenu.removeAll();\n        if (!isBackup) {\n          this.getChildControl('open-with-button').show();\n          const availableHandlers = cv.ui.manager.control.FileHandlerRegistry.getInstance().getAllFileHandlers(file);\n\n          // this menu only makes sense when there is more than one option to select from\n          this.getChildControl('open-with-button').setEnabled(availableHandlers.length > 1);\n          availableHandlers.sort(function (a, b) {\n            return a.Clazz.constructor.TITLE.toString().localeCompare(b.Clazz.constructor.TITLE.toString());\n          });\n          availableHandlers.forEach(function (handlerConf) {\n            const button = new qx.ui.menu.Button(handlerConf.Clazz.constructor.TITLE, handlerConf.Clazz.constructor.ICON);\n            button.setAppearance('open-with-button');\n            if (defaultHandler.Clazz.classname === handlerConf.Clazz.classname) {\n              button.addState('default');\n            }\n            button.setUserData('handlerId', handlerConf.Clazz.classname);\n            button.addListener('execute', this._onOpenWith, this);\n            openWithMenu.add(button);\n          }, this);\n        } else {\n          this.getChildControl('open-with-button').exclude();\n        }\n\n        // validate button\n        this.getChildControl('validate-config-button').setVisibility(file.isConfigFile() && !file.isMounted() && !isBackup ? 'visible' : 'excluded');\n\n        // replacement button\n        if (!isFolder && !isBackup) {\n          this.getChildControl('replace-button').show();\n          this._replacementManager.setFilename(file.getName());\n          this._replacementManager.setFolder(file.getParent());\n        } else {\n          this.getChildControl('replace-button').exclude();\n        }\n        // buttons that need write access\n        ['delete-button', 'replace-button', 'rename-button'].forEach(function (controlName) {\n          this.getChildControl(controlName).setEnabled(!file.isFake() && file.isWriteable() && (!isBackup || controlName === 'delete-button'));\n        }, this);\n        this.getChildControl('download-button').setEnabled(!file.isFake() && file.getType() === 'file');\n        this.getChildControl('restore-button').setVisibility(file.isInTrash() || isBackup ? 'visible' : 'excluded');\n      } else {\n        this.getChildControl('delete-button').set({\n          label: this.tr('Delete'),\n          enabled: false\n        });\n        this.getChildControl('replace-button').exclude();\n        this.getChildControl('download-button').setEnabled(false);\n        this.getChildControl('restore-button').exclude();\n      }\n    },\n\n    _init: function () {\n      if (!this._noNew) {\n        this.add(this.getChildControl('new-file-button'));\n      }\n      this.add(this.getChildControl('clone-file-button'));\n      this.add(this.getChildControl('convert-file-button'));\n      if (!this._noNew) {\n        this.add(this.getChildControl('new-folder-button'));\n      }\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('open-button'));\n      this.add(this.getChildControl('open-with-button'));\n      if (!this._noCompare) {\n        this.add(this.getChildControl('compare-with-button'));\n      }\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('rename-button'));\n      this.add(this.getChildControl('delete-button'));\n      this.add(this.getChildControl('restore-button'));\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('download-button'));\n      let sep = new qx.ui.menu.Separator();\n      let button = this.getChildControl('replace-button');\n      this.add(sep);\n      this.add(button);\n      button.bind('visibility', sep, 'visibility');\n      sep = new qx.ui.menu.Separator();\n      button = this.getChildControl('validate-config-button');\n      button.bind('visibility', sep, 'visibility');\n      this.add(sep);\n      this.add(button);\n    },\n\n    _onCompareWith: function (ev) {\n      if (this.isActive()) {\n        const compareWith = ev.getTarget().getUserData('file');\n        qx.event.message.Bus.dispatchByName('cv.manager.compareFiles',\n          new cv.ui.manager.model.CompareFiles(compareWith, this._selectedNode)\n        );\n      }\n    },\n\n    _onOpenWith: function (ev) {\n      if (this.isActive()) {\n        const handlerId = ev.getTarget().getUserData('handlerId');\n        qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n          file: this._selectedNode,\n          handler: handlerId\n        });\n      }\n    },\n\n    _onRename: function () {\n      if (this._selectedNode && this.isActive()) {\n        if (!this._renameDialog) {\n          this._renameDialog = new cv.ui.manager.dialog.Prompt({\n            message: this.tr('New name'),\n            callback: function (name) {\n              if (name && name !== this._selectedNode.getName()) {\n                cv.ui.manager.control.FileController.getInstance().rename(this._selectedNode, name);\n              }\n            },\n            context: this,\n            value: this._selectedNode.getName(),\n            caption: this.tr('Rename file'),\n            filter: /[\\w\\d_\\-\\.\\s]/\n          });\n        }\n        this._renameDialog.show();\n      }\n    },\n\n    _onDownload: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().download(this._selectedNode);\n      }\n    },\n\n    _onRestore: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().restore(this._selectedNode);\n      }\n    },\n\n    _onValidate: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().validate(this._selectedNode);\n      }\n    },\n\n    _onClone: function () {\n      if (this._selectedNode && this.isActive()) {\n        qx.event.message.Bus.dispatchByName('cv.manager.action.clone', {\n          file: this._selectedNode\n        });\n      }\n    },\n\n    _onConvert: function () {\n      if (this._selectedNode && this.isActive()) {\n        qx.event.message.Bus.dispatchByName('cv.manager.action.convertToTile', {\n          file: this._selectedNode\n        });\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'new-file-button':\n           control = new qx.ui.menu.Button(this.tr('New file'), cv.theme.dark.Images.getIcon('new-file', 18));\n           control.addListener('execute', function () {\n             if (this._selectedNode.isConfigFile()) {\n               qx.event.message.Bus.dispatchByName('cv.manager.action.new-config-file', this._selectedNode.getParent());\n             } else {\n               qx.event.message.Bus.dispatchByName('cv.manager.action.new-file', this._selectedNode.getType() === 'dir' ? this._selectedNode : this._selectedNode.getParent());\n             }\n           }, this);\n           break;\n\n         case 'clone-file-button':\n           control = new qx.ui.menu.Button(this.tr('Clone file'), cv.theme.dark.Images.getIcon('clone-file', 18));\n           control.exclude();\n           control.addListener('execute', this._onClone, this);\n           break;\n\n         case 'new-folder-button':\n           control = new qx.ui.menu.Button(this.tr('New folder'), cv.theme.dark.Images.getIcon('new-folder', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.action.new-folder', this._selectedNode.getType() === 'dir' ? this._selectedNode : this._selectedNode.getParent());\n           }, this);\n           break;\n\n         case 'rename-button':\n           control = new qx.ui.menu.Button(this.tr('Rename'), cv.theme.dark.Images.getIcon('rename', 18));\n           control.addListener('execute', this._onRename, this);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.menu.Button(this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.action.delete', this._selectedNode);\n           }, this);\n           break;\n\n         case 'download-button':\n           control = new qx.ui.menu.Button(this.tr('Download'), cv.theme.dark.Images.getIcon('download', 18));\n           control.addListener('execute', this._onDownload, this);\n           break;\n\n         case 'open-button':\n           control = new qx.ui.menu.Button(this.tr('Open'), cv.theme.dark.Images.getIcon('open', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.open', this._selectedNode);\n           }, this);\n           break;\n\n         case 'restore-button':\n           control = new qx.ui.menu.Button(this.tr('Restore'), cv.theme.dark.Images.getIcon('trash', 18));\n           control.exclude();\n           control.addListener('execute', this._onRestore, this);\n           break;\n\n         case 'validate-config-button':\n           control = new qx.ui.menu.Button(this.tr('Validate'), cv.theme.dark.Images.getIcon('validate', 18));\n           control.exclude();\n           control.addListener('execute', this._onValidate, this);\n           break;\n\n         case 'replace-button':\n           control = new com.zenesis.qx.upload.UploadMenuButton(this.tr('Replace'), cv.theme.dark.Images.getIcon('upload', 18));\n           control.exclude();\n           this._replacementManager = new cv.ui.manager.upload.UploadMgr();\n           this._replacementManager.setForce(true);\n           this._replacementManager.addWidget(control);\n           break;\n\n         case 'compare-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'compare-with-button':\n           control = new qx.ui.menu.Button(this.tr('Compare with...'), cv.theme.dark.Images.getIcon('compare', 18), null, this.getChildControl('compare-menu'));\n           break;\n\n         case 'open-with-button':\n           control = new qx.ui.menu.Button(this.tr('Open with...'), cv.theme.dark.Images.getIcon('open-with', 18), null, this.getChildControl('open-with-menu'));\n           break;\n\n         case 'open-with-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n        case 'convert-file-button':\n          control = new qx.ui.menu.Button(this.tr('Convert to tile structure'), cv.theme.dark.Images.getIcon('convert', 18));\n          control.addListener('execute', this._onConvert, this);\n          break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n    this._renameDialog = null;\n    this._disposeObjects('_dateFormat', '_timeFormat');\n  }\n});\n","/* GlobalFileItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.contextmenu.GlobalFileItem', {\n  extend: cv.ui.manager.contextmenu.FileItem,\n  type: 'singleton'\n});\n","/* VirtualFsItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Widget for filesystem items in a virtual tree.\n */\nqx.Class.define('cv.ui.manager.tree.VirtualFsItem', {\n  extend: qx.ui.tree.VirtualTreeItem,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'fs-tree-item'\n    },\n\n    editing: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyEditing'\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName'\n    },\n\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyTemporary'\n    },\n\n    status: {\n      check: ['valid', 'error'],\n      nullable: true,\n      apply: '_applyStatus'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _applyEditing: function (value, old) {\n      if (value !== old) {\n        const field = this.getChildControl('edit');\n        if (value) {\n          field.setValue(this.getLabel());\n          field.show();\n          qx.event.message.Bus.dispatchByName('cv.manager.tree.enable', false);\n        } else {\n          qx.event.message.Bus.dispatchByName('cv.manager.tree.enable', true);\n          field.exclude();\n          // save new name\n          if (field.getValue() !== this.getName()) {\n            cv.ui.manager.control.FileController.getInstance().rename(this.getModel(), field.getValue());\n          }\n        }\n      }\n    },\n    _applyTemporary: function (value) {\n      if (value) {\n        this.addState('temporary');\n      } else {\n        this.removeState('temporary');\n      }\n    },\n\n    // overridden\n    _applyModel : function(value, old) {\n      this.base(arguments, value, old);\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        if (value.isTrash()) {\n          this.setLabel(this.tr('Trash'));\n        } else {\n          value.bind('name', this, 'label');\n          value.bind('valid', this, 'status', {\n            converter: function (value) {\n              return value === true ? 'valid' : 'error';\n            }\n          });\n        }\n        value.bind('temporary', this, 'temporary');\n        if (value.getType() === 'dir') {\n          this.setDroppable(true);\n          this.addListener('drop', this._onDrop, this);\n        } else {\n          this.setDroppable(false);\n          this.removeListener('drop', this._onDrop, this);\n        }\n      }\n    },\n\n    _applyStatus: function (value) {\n      const control = this.getChildControl('icon');\n      if (value) {\n        switch (value) {\n          case 'valid':\n            control.removeState('error');\n            break;\n\n          case 'error':\n            control.addState('error');\n            break;\n        }\n      }\n    },\n\n    /**\n     * Handle drop events\n     * @param ev {Event}\n     * @private\n     */\n    _onDrop: function (ev) {\n      this.info(ev.getRelatedTarget());\n    },\n\n    __cancelEditing: function () {\n      this.getChildControl('edit').setValue(this.getName());\n      this.setEditing(false);\n    },\n\n    _onKeypress: function (ev) {\n      if (ev.getKeyIdentifier() === 'Enter') {\n        this.setEditing(false);\n      } else if (ev.getKeyIdentifier() === 'Esc') {\n        this.__cancelEditing();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'edit':\n           control = new qx.ui.form.TextField();\n           control.addListener('keypress', this._onKeypress, this);\n           control.exclude();\n           control.addListener('changeVisibility', function (ev) {\n              if (ev.getData() === 'visible') {\n                this.getChildControl('label').exclude();\n              } else {\n                this.getChildControl('label').show();\n              }\n           }, this);\n           control.addListener('blur', function () {\n             this.setEditing(false);\n           }, this);\n           this._add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  }\n});\n","/* Preferences.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * User preferences.\n */\nqx.Class.define('cv.ui.manager.model.Preferences', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._restorePreferences();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    defaultConfigEditor: {\n      check: ['source', 'xml'],\n      init: 'source',\n      event: 'changeDefaultConfigEditor',\n      apply: '_savePreferences'\n    },\n\n    quickPreview: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeQuickPreview',\n      apply: '_savePreferences'\n    },\n\n    /**\n     * In export mode the manager looks and behaves like a file explorer.\n     */\n    expertMode: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeExpertMode',\n      apply: '_savePreferences'\n    },\n\n    /**\n     * View mode of the start page\n     */\n    startViewMode: {\n      check: ['list', 'preview'],\n      init: 'preview',\n      event: 'changeStartViewMode',\n      apply: '_savePreferences'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _skipSaving: false,\n\n    _savePreferences: function () {\n      if (!this._skipSaving) {\n        const store = qx.bom.Storage.getLocal();\n        const data = qx.util.Serializer.toNativeObject(this);\n        store.setItem('preferences', data);\n        cv.report.Record.record(cv.report.Record.STORAGE, 'preferences', data);\n      }\n    },\n\n    _restorePreferences: function () {\n      const store = qx.bom.Storage.getLocal();\n      this.set(store.getItem('preferences'));\n    },\n\n    setPreferences: function (preferences, noSave) {\n      if (noSave) {\n        this._skipSaving = true;\n      }\n      this.set(preferences);\n      this._skipSaving = false;\n    }\n  }\n});\n","/* Message.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Model for Messages shown in Snackbar/Dialog (usually error, warnings or info messages).\n */\nqx.Class.define('cv.ui.manager.model.Message', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    title: {\n      check: 'String',\n      init: '',\n      event: 'changeTitle'\n    },\n\n    content: {\n      check: 'String',\n      init: '',\n      event: 'changeContent'\n    },\n\n    type: {\n      check: ['alert', 'hint', 'warning', 'error'],\n      nullable: true,\n      event: 'changeType'\n    },\n\n    sticky: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeSticky'\n    }\n  }\n});\n","/* Message.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * View component that shows a snackbar message.\n */\nqx.Class.define('cv.ui.manager.snackbar.Message', {\n  extend: qx.ui.core.Widget,\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox(8));\n    this.addListener('appear', this._onAppear, this);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'close': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-snackbar-msg'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.Message',\n      nullable: true,\n      apply: '_applyModel'\n    },\n\n    timeout: {\n      check: 'Number',\n      init: 5000,\n      apply: '_applyTimeout'\n    },\n\n    type: {\n      check: ['alert', 'hint', 'warning', 'error'],\n      nullable: true,\n      apply: '_applyType'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _timer: null,\n\n    _applyModel: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n        old.removeRelatedBindings(this.getChildControl('content'));\n      }\n      if (value) {\n        value.bind('title', this.getChildControl('content'), 'value');\n        value.bind('type', this, 'type');\n        value.bind('sticky', this, 'timeout', {\n          converter: function (value) {\n            return value ? 0 : 5000;\n          }\n        });\n        this.getChildControl('close');\n      }\n    },\n\n    _applyType: function (value) {\n      if (value) {\n        this.setDecorator(this.getAppearance() + '-' + value);\n      } else {\n        this.setDecorator(this.getAppearance());\n      }\n    },\n\n    _applyTimeout: function (value) {\n      if (this._timer) {\n        this._timer.stop();\n        if (value === 0) {\n          this._timer = null;\n        }\n      }\n    },\n\n    _onAppear: function () {\n      const timeout = this.getTimeout();\n      if (this._timer) {\n        this._timer.stop();\n      }\n      if (timeout > 0) {\n        this._timer = qx.event.Timer.once(this.close, this, timeout);\n      }\n    },\n\n    close: function () {\n      this.fireDataEvent('close', this.getModel());\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new qx.ui.basic.Image();\n           this._addAt(control, 0);\n           break;\n\n         case 'content':\n           control = new qx.ui.basic.Label();\n           control.set({\n             rich: true,\n             wrap: true\n           });\n           this._addAt(control, 1, {flex: 1});\n           break;\n\n         case 'close':\n           control = new qx.ui.basic.Image(cv.theme.dark.Images.getIcon('close', 15));\n           control.addListener('tap', this.close, this);\n           this._addAt(control, 2);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_timer');\n  }\n});\n","/* BackupFolder.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.model.BackupFolder', {\n  extend: cv.ui.manager.model.FileItem,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments, 'backup');\n    this.load();\n    qx.event.message.Bus.subscribe('cv.manager.fs.*', this._onFilesSystemMessage, this);\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _onFilesSystemMessage: function (ev) {\n      if (/^cv\\.manager\\.fs\\.visu_config.*\\.xml$/.test(ev.getName())) {\n        // Fs event on config file\n        const data = ev.getData();\n        if (['contentChanged', 'fsContentChanged'].includes(data.type)) {\n          // config file has been changed or restored, refresh the backups\n          this.reload();\n        }\n      }\n    },\n\n    /**\n     * Returns the list of existing backup files for the given file.\n     * @param file {cv.ui.manager.model.FileItem}\n     */\n    getBackupFiles: function (file) {\n      const files = [];\n      if (file.getType() === 'file') {\n        const pathparts = file.getFullPath().split('/');\n        pathparts.pop();\n        const path = pathparts.join('\\/');\n        const parts = file.getName().split('.');\n        const suffix = parts.pop();\n        const filename = parts.join('.');\n        const fileRegex = new RegExp(path + filename + '-([\\\\d]{14})\\\\.' + suffix);\n        this.getChildren().forEach(function (backupFile) {\n          const match = fileRegex.exec(backupFile.getFullPath().replace('backup/', ''));\n          if (match) {\n            files.push({\n              date: new Date(\n                parseInt(match[1].substring(0, 4)),\n                parseInt(match[1].substring(4, 6))-1,\n                parseInt(match[1].substring(6, 8)),\n                parseInt(match[1].substring(8, 10)),\n                parseInt(match[1].substring(10, 12)),\n                parseInt(match[1].substring(12, 14))\n              ),\n              file: backupFile\n            });\n          }\n        }, this);\n      }\n      return files;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.fs.*', this._onFilesSystemMessage, this);\n  }\n});\n","/* FileHandlerRegistry.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Central registry for all available file editors/viewers.\n */\nqx.Class.define('cv.ui.manager.control.FileHandlerRegistry', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__registry = {};\n    this.__defaults = [];\n\n    // register viewers\n    this.registerFileHandler(new RegExp('\\\\.(' + cv.ui.manager.viewer.Image.SUPPORTED_FILES.join('|') + ')$', 'i'), cv.ui.manager.viewer.Image, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Config.SUPPORTED_FILES, cv.ui.manager.viewer.Config, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Icons.SUPPORTED_FILES, cv.ui.manager.viewer.Icons, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Folder.SUPPORTED_FILES, cv.ui.manager.viewer.Folder, {type: 'view'});\n    this.registerFileHandler(null, cv.ui.manager.Start, {type: 'view'});\n\n    // register the basic editors\n    this.registerFileHandler(cv.ui.manager.editor.Source.SUPPORTED_FILES, cv.ui.manager.editor.Source, {type: 'edit'});\n    this.registerFileHandler(cv.ui.manager.editor.Tree.SUPPORTED_FILES, cv.ui.manager.editor.Tree, {\n      preview: false,\n      type: 'edit'\n    });\n    this.registerFileHandler(cv.ui.manager.model.CompareFiles, cv.ui.manager.editor.Diff, {type: 'view'});\n\n    this.registerFileHandler('hidden.php', cv.ui.manager.editor.Config, {type: 'edit'});\n\n    cv.ui.manager.model.Preferences.getInstance().addListener('changeDefaultConfigEditor', this._onChangesDefaultConfigEditor, this);\n    this._onChangesDefaultConfigEditor();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __registry: null,\n    __defaults: null,\n\n    /**\n     * Registers an editor for a specific file, that is identified by the given selector.\n     * @param selector {String|RegExp|Class|Function|null} filename-/path or regular expression. If null this is a special handler that must be loaded manually (like cv.ui.manager.Start)\n     * @param clazz {qx.ui.core.Widget} widget class that handles those type of files\n     * @param options {Map?} additional options to store in the registry\n     */\n    registerFileHandler: function (selector, clazz, options) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertTrue(qx.Interface.classImplements(clazz, cv.ui.manager.editor.IEditor));\n      }\n      const config = Object.assign({\n        Clazz: clazz,\n        instance: null\n      }, options || {});\n      if (qx.Class.isClass(selector)) {\n        config.instanceOf = selector;\n        config.selectorId = 'instanceOf:' + selector.classname;\n        // highest priority\n        config.priority = 0;\n      } else if (qx.lang.Type.isRegExp(selector)) {\n        config.regex = selector;\n        config.selectorId = 'regex:' + selector.toString();\n        config.priority = 4;\n      } else if (qx.lang.Type.isFunction(selector)) {\n        config.selectorId = 'function:' + selector.name;\n        config.priority = 3;\n        config.function = selector;\n      } else if (qx.lang.Type.isString(selector)) {\n        // simple file matcher\n        if (selector.includes('/')) {\n          config.fullPath = selector;\n          config.selectorId = 'fullPath:' + selector;\n          config.priority = 1;\n        } else {\n          config.fileName = selector;\n          config.selectorId = 'fileName:' + selector;\n          config.priority = 2;\n        }\n      } else {\n        config.selectorId = 'none';\n        config.priority = 10;\n      }\n      this.__registry[clazz.classname] = config;\n    },\n\n    getFileHandler: function (file, type) {\n      const handlers = [];\n      if (!(file instanceof cv.ui.manager.model.CompareFiles)) {\n        // check if there is a default first\n        let defaultHandler;\n        Object.keys(this.__defaults).some(function (key) {\n          if (this.__defaults[key].regex.test(file.getFullPath()) &&\n            (!file.isTemporary() || !this.__defaults[key].noTemporaryFiles) &&\n            (file.isWriteable() || !this.__defaults[key].noReadOnlyFiles)\n          ) {\n            if (type) {\n              const config = this.getFileHandlerById(this.__defaults[key].clazz.classname);\n              if (config.type === type) {\n                defaultHandler = config;\n              }\n            } else {\n              defaultHandler = this.getFileHandlerById(this.__defaults[key].clazz.classname);\n            }\n          }\n          return !!defaultHandler;\n        }, this);\n        if (defaultHandler) {\n          return defaultHandler;\n        }\n      }\n\n      Object.keys(this.__registry).forEach(function (classname) {\n        const config = this.__registry[classname];\n        if (this.__canHandle(config, file) && (!type || config.type === type)) {\n          handlers.push(config);\n        }\n      }, this);\n      if (handlers.length === 0) {\n        if (!file.isFake() && file.getDisplayName().split('.').length === 1) {\n          // file without file ending => use the source code editor\n          return this.getFileHandlerById('cv.ui.manager.editor.Source');\n        }\n        // no editors found\n        return null;\n      } else if (handlers.length === 1) {\n        return handlers[0];\n      } \n        // sort by selector priority (instance, fullpath, filename, regex)\n        handlers.sort(function (a, b) {\n          return a.priority - b.priority;\n        });\n        // no default handler, just take the first one\n        return handlers[0];\n    },\n\n    getFileHandlerById: function (handlerId) {\n      return this.__registry[handlerId];\n    },\n\n    hasFileHandler: function (file, type) {\n      return Object.keys(this.__registry).some(function (classname) {\n        const config = this.__registry[classname];\n        return this.__canHandle(config, file) && (!type || config.type === type);\n      }, this);\n    },\n\n    /**\n     * Mark the handler with the given classname as default for the selector-id and all others with the same selector id not,\n     * @param selector {RegExp}\n     * @param clazz {qx.Class}\n     * @param noTemporaryFiles {Boolean} flag to prevent this default editor from being used to open temporary files.\n     * @param noReadOnlyFiles {Boolean} fleag to prevent this default editor from being used to open file that are not writeable\n     */\n    setDefault: function (selector, clazz, noTemporaryFiles, noReadOnlyFiles) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertRegExp(selector);\n        qx.core.Assert.assertTrue(qx.Class.isClass(clazz));\n      }\n      this.__defaults[selector.toString()] = {\n        regex: selector,\n        clazz: clazz,\n        noTemporaryFiles: noTemporaryFiles,\n        noReadOnlyFiles: noReadOnlyFiles\n      };\n    },\n\n    _onChangesDefaultConfigEditor: function () {\n      switch (cv.ui.manager.model.Preferences.getInstance().getDefaultConfigEditor()) {\n        case 'source':\n          this.setDefault(cv.ui.manager.editor.Source.DEFAULT_FOR, cv.ui.manager.editor.Source);\n          break;\n\n        case 'xml':\n          this.setDefault(cv.ui.manager.editor.Tree.SUPPORTED_FILES, cv.ui.manager.editor.Tree);\n          break;\n      }\n    },\n\n    __canHandle: function(config, file) {\n      if (config.noTemporaryFiles === true && file.isTemporary()) {\n        return false;\n      } else if (config.noReadOnlyFiles === true && !file.isWriteable()) {\n          return false;\n      } else if (config.fileName && file.getName() === config.fileName) {\n        return true;\n      } else if (config.fullPath && file.getFullPath() === config.fullPath) {\n        return true;\n      } else if (config.regex && config.regex.test(file.getFullPath().toLowerCase())) {\n        return true;\n      } else if (config.instanceOf && file instanceof config.instanceOf) {\n        return true;\n      } else if (config.function && config.function(file)) {\n        return true;\n      }\n      return false;\n    },\n\n    getAllFileHandlers: function (file, type) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertTrue(file instanceof cv.ui.manager.model.FileItem || file instanceof cv.ui.manager.model.CompareFiles);\n      }\n      return Object.keys(this.__registry).filter(function (key) {\n        return this.__canHandle(this.__registry[key], file) && (!type || this.__registry[key].type === type);\n      }, this).map(function (key) {\n        return this.__registry[key];\n      }, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    // cleanup handler instances\n    Object.keys(this.__registry).forEach(function (regex) {\n      if (this.__registry[regex].instance) {\n        this.__registry[regex].instance.dispose();\n        this.__registry[regex].instance = null;\n      }\n    }, this);\n\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeDefaultConfigEditor', this._onChangesDefaultConfigEditor, this);\n  }\n});\n","/* CompareFiles.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.model.CompareFiles', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (original, modified) {\n    this.base(arguments);\n    this.setOriginalFile(original);\n    this.setModifiedFile(modified);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    originalFile: {\n      check: 'cv.ui.manager.model.FileItem',\n      event: 'changeOriginal'\n    },\n    modifiedFile: {\n      check: 'cv.ui.manager.model.FileItem',\n      event: 'changeModifiedFile',\n      apply: '_applyModifiedFile'\n    },\n\n    permanent: {\n      check: 'Boolean',\n      init: true\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName'\n    },\n\n    type: {\n      check: 'String',\n      init: 'file'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    isRelated: function (path) {\n      return this.getOriginalFile().getFullPath() === path || this.getModifiedFile().getFullPath() === path;\n    },\n\n    isConfigFile: function () {\n      return this.getModifiedFile().isConfigFile();\n    },\n\n    getFullPath: function () {\n      return this.getOriginalFile().getFullPath();\n    },\n\n    _applyModifiedFile: function () {\n      this.setName(qx.locale.Manager.tr('Diff: %1', this.getModifiedFile().getName()));\n    },\n\n    getParent: function () {\n      return this.getModifiedFile().getParent();\n    },\n\n    isWriteable: function () {\n      return this.getModifiedFile().isWriteable();\n    },\n\n    isTrash: function () {\n      return this.getModifiedFile().isTrash();\n    },\n\n    isInTrash: function () {\n      return this.getModifiedFile().isInTrash();\n    },\n\n    isFake: function () {\n      return this.getModifiedFile().isFake();\n    },\n\n    isTemporary: function () {\n      return this.getModifiedFile().isTemporary() || this.getOriginalFile().isTemporary();\n    },\n\n    isMounted: function () {\n      return this.getModifiedFile().isMounted() || this.getOriginalFile().isMounted();\n    },\n\n    /**\n     * Returns a fake URI that can be used to identify the file.\n     * Used by monaco editor as model URI.\n     * @returns {Uri}\n     */\n    getUri: function () {\n      return 'cv://' + this.getOriginalFile().getFullPath() + '+' + this.getModifiedFile().getFullPath();\n    }\n  }\n});\n","/* Prompt.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.dialog.Prompt', {\n  extend: qxl.dialog.Prompt,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _createWidgetContent: function() {\n      this.base(arguments);\n      this._textField.setLiveUpdate(true);\n    }\n  }\n});\n","/* FileController.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The FileController is responsible for all file operations, like config check, move, replace, delete etc.\n */\nqx.Class.define('cv.ui.manager.control.FileController', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__fsClient = cv.io.rest.Client.getFsClient();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __fsClient: null,\n\n    rename: function (file, newName) {\n      let newPath = file.getPath() || '';\n      if (newPath.length > 0 && !newPath.endsWith('/')) {\n        newPath += '/';\n      }\n      newPath += newName;\n      if (file.isTemporary()) {\n        // create new item\n        this.__fsClient.createSync({path: newPath, type: file.getType()}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been created', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been created', file.getDisplayName())\n            );\n            file.resetTemporary();\n            file.resetModified();\n            file.setName(newName);\n            file.reload();\n          }\n        }, this);\n      } else if (file.getFullPath() !== newPath) {\n        this.__fsClient.moveSync({src: file.getFullPath(), target: newPath}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been renamed', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been renamed', file.getDisplayName())\n            );\n            file.setName(newName);\n            file.resetModified();\n            file.reload();\n          }\n          file.resetEditing();\n        }, this);\n      }\n    },\n\n    /**\n     * Move file to another path\n     * @param file {cv.ui.manager.model.FileItem} file to move\n     * @param target {String} new path of the file\n     */\n    move: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been moved', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been moved', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'moved',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    /**\n     * Restore file from trash by moving it out of the trash to the old path\n     * @param file {cv.ui.manager.model.FileItem} file to restore\n     */\n    restore: function (file) {\n      if (file.isInTrash()) {\n        const target = file.getFullPath().replace('.trash/', '');\n        this.__moveFile(file, target);\n      } else if (file.getType() === 'file' && !file.isTemporary()) {\n        const match = /^\\/?backup\\/visu_config(.*)-[0-9]{14}\\.xml$/.exec(file.getFullPath());\n        if (match) {\n          // find the existing target config to restore\n          const targetFileName = 'visu_config' + match[1] + '.xml';\n\n          // find the target file\n          const parentFolder = file.getParent().getParent();\n          let targetFile = null;\n          parentFolder.getChildren().some(function(child) {\n            if (child.getFullPath() === targetFileName) {\n              targetFile = child;\n              return true;\n            }\n            return false;\n          });\n\n          // load the backup content\n          this.__fsClient.readSync({path: file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else if (targetFile) {\n                this.__fsClient.updateSync({\n                  path: targetFile.getFullPath(),\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                    targetFile.resetModified();\n                    targetFile.resetTemporary();\n                    qx.event.message.Bus.dispatchByName(targetFile.getBusTopic(), {\n                      type: 'fsContentChanged',\n                      data: res,\n                      source: this\n                    });\n                  }\n                }, this);\n              } else {\n                // target file does not exist copy to a new file\n                this.__fsClient.createSync({\n                  path: targetFileName,\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                  }\n                }, this);\n              }\n          }, this);\n        }\n      }\n    },\n\n    __moveFile: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been restored', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been restored', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'restored',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    'delete': function(file, callback, context) {\n      if (file.isTemporary()) {\n        // new file, no need to call the backend\n        if (callback) {\n          callback.apply(context, true);\n        }\n      } else if (file) {\n        let message;\n        if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Do you really want to clear the trash?');\n          } else if (file.isInTrash()) {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\" from the trash?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\" from the trash?', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\"?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\"?', file.getDisplayName());\n          }\n          qxl.dialog.Dialog.confirm(message, function (confirmed) {\n            if (confirmed) {\n              this.__doDelete(file, callback, context);\n            } else if (callback) {\n              callback.apply(context, false);\n            }\n          }, this, qx.locale.Manager.tr('Confirm deletion'));\n        }\n    },\n\n    __doDelete: function (file, callback, context) {\n      this.__fsClient.deleteSync({path: file.getFullPath(), force: file.isTrash()}, null, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n          if (callback) {\n            callback.apply(context, false);\n          }\n        } else {\n          let message;\n          if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Trash has been cleared');\n          } else if (file.isInTrash()) {\n            message = this.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been removed from trash', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been removed from trash', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been deleted', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been deleted', file.getDisplayName());\n          }\n          cv.ui.manager.snackbar.Controller.info(message);\n          if (callback) {\n            callback.apply(context, true);\n          }\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'deleted',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    download: function (file) {\n      if (file.getType() === 'file') {\n        const element = document.createElement('a');\n        element.setAttribute('href', cv.io.rest.Client.getBaseUrl() + '/fs?download=true&path=' + file.getFullPath());\n        element.style.display = 'none';\n        document.body.appendChild(element);\n        element.click();\n        document.body.removeChild(element);\n      }\n    },\n\n    validate: function (file) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertInstance(file, cv.ui.manager.model.FileItem);\n      }\n      if (file.isConfigFile()) {\n        this.__validateConfig(file);\n      } else {\n        this.info('no validation available for file: ' + file.getFullPath());\n      }\n    },\n\n    __validateConfig: function (file) {\n      const d = qxl.dialog.Dialog.alert(qx.locale.Manager.tr('Validating %1', file.getFullPath()));\n      cv.ui.manager.editor.Worker.getInstance().validateConfig(file).then(function (res) {\n        d.close();\n        if (res === true) {\n          file.setValid(true);\n          cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has no errors!', file.getFullPath()));\n        } else {\n          file.setValid(false);\n          qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n            file: file,\n            handler: 'cv.ui.manager.editor.Source',\n            handlerOptions: {\n              jumpToError: true\n            }\n          });\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.trn(\n            '%1 error found in %2!',\n            '%1 errors found in %2!',\n            res.length,\n            res.length,\n            file.getFullPath())\n          );\n        }\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__fsClient = null;\n  }\n});\n","/* IEditor.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Interface all file editors must implement.\n */\nqx.Interface.define('cv.ui.manager.editor.IEditor', {\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_loadFile'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * If the handler needs some time to initialize before it can accept a file, this should be set false until the handler is ready\n     */\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: ''\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    save: function () {},\n\n    getCurrentContent: function () {}\n  }\n});\n","/* IActionHandler.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * All Widgets that need to handle actions from the managers action event, need to implement this interface.\n */\nqx.Interface.define('cv.ui.manager.IActionHandler', {\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * Checks if the action handle can process the action.\n     * @param actionName {String} action name\n     */\n    canHandleAction: function(actionName) {},\n\n    /**\n     * Executes the action handling.\n     * @param actionName {String} action name\n     * @param data {var} action payload\n     */\n    handleAction: function (actionName, data) {},\n\n    /**\n     * The ActionHandler can configure the menubutton itself, e.g. disable it, when that action is currently not possible\n     * or change the button text / tooltip text etc.\n     * @param actionId {String} ID of the action that button triggers\n     * @param button {Widget} the button that should be configured\n     */\n    configureButton: function (actionId, button) {},\n\n    /**\n     * Undo all changes that have been applied to the button in configureButton\n     * @param actionId {String} ID of the action that button triggers\n     * @param button {Widget}\n     */\n    unConfigureButton: function (actionId, button) {}\n  }\n});\n","/* AbstractViewer.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Abstract base class for all widgets that can display file items.\n */\nqx.Class.define('cv.ui.manager.viewer.AbstractViewer', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFile',\n      event: 'changeFile'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    canHandleAction: function () {\n      return false;\n    },\n    handleAction: function () {},\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n    save: function () {},\n    getCurrentContent: function () {},\n\n    _applyFile: function (file, old) {\n      // show icon for file type\n    },\n\n    // overridden\n    _createChildControlImpl : function (id) {\n      let control;\n\n      switch (id) {\n        case 'scroll':\n          control = new qx.ui.container.Scroll();\n          this._add(control);\n          break;\n\n        case 'image':\n          control = new qx.ui.basic.Atom();\n          this.getChildControl('scroll').add(control);\n          control.getChildControl('icon').addListener('resize', this._scaleImage, this);\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  }\n});\n","/* Image.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n// noinspection JSClosureCompilerSyntax\n/**\n * Show images.\n */\nqx.Class.define('cv.ui.manager.viewer.Image', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n\n  /*\n    ***********************************************\n      PROPERTIES\n    ***********************************************\n    */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'image-viewer'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: ['jpg', 'jpeg', 'png', 'gif', 'svg'],\n    TITLE: qx.locale.Manager.tr('Show image'),\n    ICON: cv.theme.dark.Images.getIcon('image', 18),\n\n    /**\n     * Returns size information for images\n     * @param source {String} path to image\n     * @returns {{width: *, aspectRatio: number, height: *}}\n     */\n    getImageData: function (source) {\n      let data = qx.util.ResourceManager.getInstance().getData(source);\n      if (data) {\n        return {\n          width: data[0],\n          height: data[1],\n          aspectRatio: data[0] / data[1]\n        };\n      } \n        data = qx.io.ImageLoader.getSize(source);\n        if (data && data.width && data.height) {\n          return Object.assign({\n            aspectRatio: data.width / data.height\n          }, data);\n        }\n      \n      return null;\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyFile: function (file) {\n      const control = this.getChildControl('image');\n      if (file) {\n        control.setIcon(file.getServerPath());\n        control.setLabel(file.getFullPath());\n        if (!cv.ui.manager.viewer.Image.getImageData(file.getServerPath())) {\n          control.getChildControl('icon').addListenerOnce('loaded', this._scaleImage, this);\n        } else {\n          this._scaleImage();\n        }\n        this.addListener('resize', this._scaleImage, this);\n      } else {\n        control.resetIcon();\n        control.resetLabel();\n        this.removeListener('resize', this._scaleImage, this);\n      }\n    },\n\n    _scaleImage: function () {\n      const bounds = this.getBounds();\n      if (!bounds) {\n        this.addListenerOnce('appear', this._scaleImage, this);\n        return;\n      }\n      const file = this.getFile();\n      if (!file) {\n        return;\n      }\n      const icon = this.getChildControl('image').getChildControl('icon');\n      const data = cv.ui.manager.viewer.Image.getImageData(file.getServerPath());\n      const paddingX = 10;\n      const paddingY = 20;\n      const availableHeight = bounds.height - paddingY * 2;\n      let width = bounds.width - paddingX * 2;\n      let height = Math.round(1 / data.aspectRatio * width);\n      if (height > availableHeight) {\n        height = availableHeight;\n        width = Math.round(data.aspectRatio * availableHeight);\n      }\n      icon.set({\n        width: width,\n        height: height,\n        scale: true\n      });\n    }\n  }\n});\n","/* Config.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Show rendered configs.\n */\nqx.Class.define('cv.ui.manager.viewer.Config', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n  },\n\n  /*\n    ***********************************************\n      PROPERTIES\n    ***********************************************\n    */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'config-viewer'\n    },\n\n    target: {\n      check: ['iframe', 'window'],\n      init: 'window'\n    },\n\n    external: {\n      refine: true,\n      init: true\n    },\n\n    connectToWindow: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyConnectToWindow'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Config viewer'),\n    ICON: cv.theme.dark.Images.getIcon('preview', 18)\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _windowRef: null,\n    _source: null,\n    _reloading: false,\n\n    _applyConnectToWindow: function (value) {\n      this.setExternal(!value);\n    },\n\n    _applyFile: function (file, old) {\n      if (old && old.isConfigFile()) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (file) {\n        if (file.isConfigFile()) {\n          const configName = cv.ui.manager.model.FileItem.getConfigName(file.getFullPath());\n          let url = qx.util.Uri.getAbsolute(qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/..') + '?config=' + (configName || '');\n          if (this.getTarget() === 'iframe') {\n            url += '&preview=1&libraryCheck=false';\n            const control = this.getChildControl('iframe');\n            this._source = url;\n            this.getChildControl('loading').show();\n            control.setSource(url);\n            control.show();\n            const hint = this.getChildControl('hint', true);\n            if (hint && hint.isVisible()) {\n              hint.exclude();\n            }\n          } else {\n            this._source = url;\n            let ref = window.open(url, configName);\n            if (this.isConnectToWindow()) {\n              this._windowRef = ref;\n              this._windowRef.onbeforeunload = this._onClose.bind(this);\n              const hint = this.getChildControl('hint');\n              hint.show();\n              const iframe = this.getChildControl('iframe', true);\n              if (iframe && iframe.isVisible()) {\n                iframe.exclude();\n              }\n            } else {\n              // no connection close this immediately\n              this._onClose();\n              return;\n            }\n          }\n          qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n        } else {\n          cv.ui.manager.snackbar.Controller.error(this.tr('%1 is no configuration file', file.getFullPath()));\n          this._source = null;\n        }\n      } else {\n        if (this.hasChildControl('iframe')) {\n          this.getChildControl('iframe').resetSource();\n          this.getChildControl('iframe').exclude();\n        }\n        if (this.hasChildControl('hint')) {\n          this.getChildControl('hint').exclude();\n        }\n        if (this._windowRef) {\n          this._windowRef.close();\n        }\n      }\n    },\n\n    _onChange: function (ev) {\n      const data = ev.getData();\n      if (data.type === 'contentChanged') {\n        if (this.hasChildControl('iframe')) {\n          const iframe = this.getChildControl('iframe');\n          const href = iframe.getDocument().location.href;\n          // use href to get the anchor to keep the currently opened page on reload\n          const url = href.startsWith(this._source) ? iframe.getDocument().location.href : this._source;\n          if (url && url !== 'about:blank') {\n            this._reloading = true;\n            this.getChildControl('loading').show();\n            iframe.addListenerOnce('load', () => {\n              this._reloading = false;\n              iframe.setSource(url);\n            }, this);\n          }\n          iframe.setSource('about:blank');\n        } else if (this._windowRef) {\n          this._windowRef.reload();\n        }\n      }\n    },\n\n    _onClose: function () {\n      if (this._windowRef) {\n        qx.event.message.Bus.dispatchByName('cv.manager.action.close', this.getFile());\n        this._windowRef = null;\n      }\n      this.resetFile();\n    },\n\n    openPage: function (page, path) {\n      if (this.hasChildControl('iframe')) {\n        const element = this.getChildControl('iframe').getContentElement().getDomElement();\n        if (element && element.contentWindow.cv) {\n          const otherController = element.contentWindow.cv.Application.structureController;\n          const pageId = path ? otherController.getPageIdByPath(page, path) : page;\n          otherController.scrollToPage(pageId, 0);\n        }\n      }\n    },\n\n    setHighlightWidget: function (widgetId) {\n      if (this.hasChildControl('iframe')) {\n        const element = this.getChildControl('iframe').getContentElement().getDomElement();\n        if (element && element.contentWindow.cv) {\n          const otherEngine = element.contentWindow.cv.TemplateEngine.getInstance();\n          otherEngine.setHighlightedWidget(widgetId);\n        }\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'iframe':\n           control = new qx.ui.embed.Iframe();\n           control.exclude();\n           control.addListener('load', () => {\n             if (this.hasChildControl('loading') && !this._reloading) {\n               this.getChildControl('loading').exclude();\n             }\n           }, this);\n           this.getChildControl('scroll').add(control);\n           break;\n\n         case 'hint':\n           control = new qx.ui.basic.Atom(this.tr('This configuration has been opened in another window. When you close this file, the window will also be closed. Click here top jump the the window.'));\n           control.set({\n             center: true,\n             font: 'title'\n           });\n           control.addListener('tap', function () {\n             if (this._windowRef) {\n               this._windowRef.focus();\n             }\n           }, this);\n           this.getChildControl('scroll').add(control);\n           break;\n\n         case 'loading':\n           control = new qx.ui.basic.Atom(this.tr('Loading...'), cv.theme.dark.Images.getIcon('reload', 64));\n           control.set({\n             center: true,\n             font: 'title',\n             iconPosition: 'top',\n             backgroundColor: 'rgba(0,0,0,0.2)'\n           });\n           control.addListener('appear', () => {\n             qx.event.Timer.once(() => {\n               control.exclude();\n             }, this, 5000);\n           });\n           control.exclude();\n           this._add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._windowRef = null;\n  }\n});\n","/* Folder.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Displays folder content in an explorer like view.\n */\nqx.Class.define('cv.ui.manager.viewer.Folder', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n  implement: [\n    qx.ui.core.ISingleSelection,\n    qx.ui.form.IModelSelection\n  ],\n  include: [\n    qx.ui.core.MSingleSelectionHandling,\n    qx.ui.core.MRemoteChildrenHandling,\n    qx.ui.form.MModelSelection,\n    cv.ui.manager.control.MFileEventHandler\n  ],\n\n  /*\n ***********************************************\n   CONSTRUCTOR\n ***********************************************\n */\n  construct: function (noToolbar) {\n    this.base(arguments);\n    cv.ui.manager.model.Preferences.getInstance().bind('startViewMode', this, 'viewMode');\n    this._isImageRegex = new RegExp('\\\\.(' + cv.ui.manager.viewer.Image.SUPPORTED_FILES.join('|') + ')$', 'i');\n    this.initModel(new qx.data.Array());\n    this._setLayout(new qx.ui.layout.VBox(8));\n\n    this._newItem = new cv.ui.manager.model.FileItem('new', 'new', null).set({\n      fake: true,\n      type: 'file',\n      loaded: true,\n      icon: cv.theme.dark.Images.getIcon('upload'),\n      displayName: this.tr('Upload file'),\n      special: 'add-file'\n    });\n\n    this._debouncedOnFilter = qx.util.Function.debounce(this._onFilter, 500, false);\n    if (!noToolbar) {\n      this._createChildControl('toolbar');\n    }\n    this._createChildControl('filter');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: function isDir(item) {\n      // noinspection JSConstructorReturnsPrimitive\n      return item.getType() === 'dir';\n    },\n    TITLE: qx.locale.Manager.tr('Show folder'),\n    ICON: cv.theme.dark.Images.getIcon('folder', 18)\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /**\n     * This event is fired after a list item was added to the list. The\n     * {@link qx.event.type.Data#getData} method of the event returns the\n     * added item.\n     */\n    addItem : 'qx.event.type.Data',\n\n    /**\n     * This event is fired after a list item has been removed from the list.\n     * The {@link qx.event.type.Data#getData} method of the event returns the\n     * removed item.\n     */\n    removeItem : 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    model: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    permanentFilter: {\n      check: 'Function',\n      nullable: true,\n      apply: '_onFilter'\n    },\n\n    showTextFilter: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowTextFilter'\n    },\n\n    labelConverter: {\n      check: 'Function',\n      nullable: true\n    },\n\n    disableScrolling: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDisableScrolling'\n    },\n\n    viewMode: {\n      check: ['list', 'preview'],\n      init: 'list',\n      event: 'changeViewMode'\n    }\n  },\n\n  /*\n ***********************************************\n   MEMBERS\n ***********************************************\n */\n  members: {\n    _controller: null,\n    _isImageRegex: null,\n    _newItem: null,\n\n    _getItems: function() {\n      return this.getChildControl('list').getChildren();\n    },\n\n    _isAllowEmptySelection: function () {\n      return true;\n    },\n\n    _defaultLabelConverter: function (name) {\n      if (this.getViewMode() === 'list') {\n        // do not remove file type in list mode\n        return name;\n      }\n      const parts = name.split('.');\n      if (parts.length > 1) {\n        parts.pop();\n      }\n      return parts.join('.');\n    },\n\n    _getDelegate: function () {\n      const labelConverter = this.getLabelConverter();\n      const converter = {\n        converter: labelConverter ? labelConverter : this._defaultLabelConverter.bind(this)\n      };\n      return {\n        createItem: function () {\n          return new cv.ui.manager.form.FileListItem();\n        },\n\n        configureItem: function (item) {\n          item.addListener('dbltap', this._onDblTap, this);\n          item.addListener('contextmenu', this._onFsItemRightClick, this);\n          item.addListener('action', this._onFsItemRightClick, this);\n          item.setShowFileActions(true);\n          this.bind('viewMode', item, 'viewMode');\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n          controller.bindProperty('displayName', 'label', converter, item, index);\n          controller.bindProperty('icon', 'icon', {\n            converter: function (source, file) {\n              if (file.getType() === 'file' && this._isImageRegex.test(file.getName())) {\n                // use the image as icon\n                return file.getServerPath();\n              } \n                if (!source) {\n                  return null;\n                }\n                // remove size from icon source\n              const parts = source.split('/');\n              if (parts.length === 3) {\n                  parts.pop();\n                }\n                return parts.join('/');\n            }.bind(this)\n          }, item, index);\n        }.bind(this)\n      };\n    },\n\n    _onFsItemRightClick: function (ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        ev.preventDefault();\n        if (ev.getBubbles()) {\n          ev.stopPropagation();\n        }\n        return;\n      }\n      const menu = cv.ui.manager.contextmenu.GlobalFileItem.getInstance();\n      menu.configure(file);\n      ev.getCurrentTarget().setContextMenu(menu);\n      menu.openAtPointer(ev);\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onDblTap: function (ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        // Select file for upload\n\n      } else {\n        qx.event.message.Bus.dispatchByName('cv.manager.open', file);\n      }\n    },\n\n    _applyFile: function (file, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n        this.resetModel();\n      }\n      if (file) {\n        const container = this.getChildControl('list');\n        if (!this._controller) {\n          this._controller = new qx.data.controller.List(null, container);\n          this._controller.setDelegate(this._getDelegate());\n        }\n        file.bind('children', this, 'model');\n        const model = this.getModel();\n        this._newItem.setParent(file);\n        model.addListener('change', function () {\n          if (this.getChildControl('filter').getValue() || this.getPermanentFilter()) {\n            this._onFilter();\n          } else {\n            this._controller.setModel(model);\n          }\n        }, this);\n        this._controller.setModel(model);\n        file.load();\n      } else {\n        if (this._controller) {\n          this._controller.resetModel();\n        }\n        this._newItem.resetParent();\n      }\n    },\n\n    _handleFileEvent: function (ev) {\n      const folder = this.getFile();\n      const data = ev.getData();\n      switch (data.action) {\n        case 'moved':\n          folder.reload();\n          break;\n\n        case 'added':\n        case 'uploaded':\n        case 'created':\n          if (data.path.startsWith(folder.getFullPath())) {\n            folder.reload();\n          }\n          break;\n\n        case 'deleted': {\n          let children;\n          if (folder) {\n            if (data.path === folder.getFullPath()) {\n              // this item has been deleted\n              this.dispose();\n            } else if (data.path.startsWith(folder.getFullPath())) {\n              // delete child\n              children = folder.getChildren();\n              children.some(function (child) {\n                if (child.getFullPath() === data.path) {\n                  children.remove(child);\n                  this.removeRelatedBindings(child);\n                  return true;\n                }\n                return false;\n              }, this);\n            }\n          }\n          children = this.getModel();\n          children.some(function (child) {\n            if (child.getFullPath() === data.path) {\n              children.remove(child);\n              this.removeRelatedBindings(child);\n              return true;\n            }\n            return false;\n          }, this);\n          break;\n        }\n      }\n    },\n\n    _applyShowTextFilter: function (value) {\n      this.getChildControl('filter').setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    _onFilter: function () {\n      if (this._controller) {\n        const filterString = this.getChildControl('filter').getValue();\n        const filterFunction = this.getPermanentFilter();\n        const filtered = this.getModel().filter(function (file) {\n          return (!filterFunction || filterFunction(file)) && (!filterString || file.getName().includes(filterString));\n        });\n        this._controller.setModel(filtered);\n      }\n    },\n\n    getChildrenContainer: function () {\n      return this.getChildControl('list');\n    },\n\n    /**\n     * Handle child widget adds on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onAddChild : function(e) {\n      this.fireDataEvent('addItem', e.getData());\n    },\n\n    /**\n     * Handle child widget removes on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onRemoveChild : function(e) {\n      this.fireDataEvent('removeItem', e.getData());\n    },\n\n    _onFileEvent: function (ev) {\n      const data = ev.getData();\n      switch (data.action) {\n        case 'deleted':\n          break;\n      }\n    },\n\n    _applyDisableScrolling: function (value) {\n      if (value) {\n        this.getChildControl('scroll').exclude();\n        this._addAt(this.getChildControl('list'), 1, {flex: 1});\n      } else {\n        const scrollContainer = this.getChildControl('scroll');\n        scrollContainer.show();\n        scrollContainer.add(this.getChildControl('list'));\n        this._addAt(scrollContainer, 1, {flex: 1});\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n        case 'toolbar':\n          control = new cv.ui.manager.ToolBar(null, ['new-file', 'new-folder', 'upload', 'reload']);\n          this.bind('file', control, 'folder');\n          control.addListener('reload', function () {\n            this.getFile().reload();\n          }, this);\n          this._addAt(control, 0);\n          break;\n\n        case 'filter':\n          control = new qx.ui.form.TextField();\n          control.set({\n            placeholder: this.tr('Filter by name...'),\n            liveUpdate: true,\n            margin: 8\n          });\n          if (!this.isShowTextFilter()) {\n            control.exclude();\n          }\n          control.addListener('changeValue', this._debouncedOnFilter, this);\n          this._addAt(control, 1);\n          break;\n\n        case 'scroll':\n          control = new qx.ui.container.Scroll();\n          this._addAt(control, 2, {flex: 1});\n          break;\n\n        case 'list':\n          control = new qx.ui.container.Composite(new qx.ui.layout.Flow(8, 8));\n\n          // Used to fire item add/remove events\n          control.addListener('addChildWidget', this._onAddChild, this);\n          control.addListener('removeChildWidget', this._onRemoveChild, this);\n          if (this.isDisableScrolling()) {\n            this._addAt(control, 1, {flex: 1});\n          } else {\n            this.getChildControl('scroll').add(control);\n          }\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_controller');\n    this._isImageRegex = null;\n    cv.ui.manager.model.Preferences.getInstance().removeRelatedBindings(this);\n  }\n});\n","/* Icons.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Shows the available icons.\n */\nqx.Class.define('cv.ui.manager.viewer.Icons', {\n  extend: cv.ui.manager.viewer.Folder,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this._disableFileEvents = true;\n    this.base(arguments, true);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^CometVisu-Icons$/i,\n    TITLE: qx.locale.Manager.tr('Show icons'),\n    ICON: cv.theme.dark.Images.getIcon('icons', 18)\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _getDelegate: function () {\n      return {\n        createItem: function () {\n          return new cv.ui.manager.core.IconAtom();\n        },\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n        }\n      };\n    },\n\n    _onFilter: function () {\n      const filterString = this.getChildControl('filter').getValue();\n      const filtered = this.getModel().filter(function (entry) {\n        return entry[0].includes(filterString);\n      });\n      this._controller.setModel(filtered);\n    },\n\n    _applyFile: function(file, old) {\n      if (file) {\n        const container = this.getChildControl('list');\n        if (!this._controller) {\n          this._controller = new qx.data.controller.List(null, container);\n          this._controller.setDelegate(this._getDelegate());\n        }\n        const model = this.getModel();\n        const handler = cv.IconHandler.getInstance();\n        // as the file is just a fake file, we do not really care about it\n        Object.keys(cv.IconConfig.DB).forEach(name => {\n          model.push([name, handler.getIconSource(name, 'icon-preview')]);\n        });\n        if (this.getChildControl('filter').getValue() || this.getPermanentFilter()) {\n          this._onFilter();\n        } else {\n          this._controller.setModel(model);\n        }\n      } else if (this._controller) {\n          this._controller.resetModel();\n        }\n    }\n  }\n});\n","/* Start.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Simple view that provides all of the file-related features of the old editor in an easy to use way.\n */\nqx.Class.define('cv.ui.manager.Start', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.VBox());\n    this._configRegex = /^visu_config_?([^.]+)?\\.xml$/;\n    [ 'toolbar', 'configs-title', 'configs-toolbar', 'configs',\n      'demo-configs-title', 'demo-configs',\n      'media-title', 'media-toolbar', 'media',\n      'misc-title', 'misc'\n    ].forEach(this._createChildControl, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_loadRoot',\n      event: 'changeFile'\n    },\n    appearance: {\n      refine: true,\n      init: 'cv-start'\n    },\n\n    selectedItem: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applySelectedItem'\n    },\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _configRegex: null,\n    _ignoreSelectionChanges: false,\n    _previewButton: null,\n    _listButton: null,\n    _radioGroup: null,\n\n    save: function () {},\n    getCurrentContent: function () {},\n    canHandleAction: function () {\n      return false;\n    },\n    handleAction: function () {},\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _loadRoot: function (value) {\n      this.getChildControl('configs').setFile(value);\n      let found = 0;\n\n      if (value) {\n        value.load(function () {\n          value.getChildren().some(function (file) {\n            if (file.getName() === 'media') {\n              this.getChildControl('media').setFile(file);\n              this.getChildControl('media-toolbar').setFolder(file);\n              found++;\n            } else if (file.getName() === 'demo') {\n              this.getChildControl('demo-configs').setFile(file);\n              found++;\n            }\n            return found === 2;\n          }, this);\n        }, this);\n      }\n    },\n\n    _onChangeSelection: function (ev) {\n      if (this._ignoreSelectionChanges === false) {\n        const list = ev.getTarget();\n        const selection = ev.getData();\n        this._ignoreSelectionChanges = true;\n\n        // unselect the other lists\n        ['configs', 'demo-configs', 'media'].forEach(function (name) {\n          const control = this.getChildControl(name);\n          if (control !== list) {\n            control.resetSelection();\n          }\n        }, this);\n        this._ignoreSelectionChanges = false;\n        if (selection.length > 0) {\n          this.setSelectedItem(selection[0].getModel());\n        }\n      }\n    },\n\n    _applySelectedItem: function () {\n    },\n\n    _onToggleExpand: function (ev) {\n      const control = this.getChildControl(ev.getTarget().getUserData('control'));\n      if (control.getVisibility() === 'visible') {\n        control.exclude();\n        ev.getTarget().setIcon(cv.theme.dark.Images.getIcon('drop-down', 18));\n      } else {\n        control.show();\n        ev.getTarget().setIcon(cv.theme.dark.Images.getIcon('drop-up', 18));\n      }\n    },\n\n    _onChangeViewMode: function () {\n      switch (cv.ui.manager.model.Preferences.getInstance().getStartViewMode()) {\n        case 'list':\n          this._radioGroup.setSelection([this._listButton]);\n          break;\n\n        case 'preview':\n          this._radioGroup.setSelection([this._previewButton]);\n          break;\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'scroll-container':\n           control = new qx.ui.container.Scroll();\n           this._add(control, {flex: 1});\n           break;\n\n         case 'content':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox(8));\n           this.getChildControl('scroll-container').add(control);\n           break;\n\n         case 'toolbar': {\n           control = new qx.ui.toolbar.ToolBar();\n           const part = new qx.ui.toolbar.Part();\n           const listButton = this._listButton = new qx.ui.toolbar.RadioButton('', cv.theme.dark.Images.getIcon('listViewMode', 22));\n           listButton.setUserData('mode', 'list');\n           listButton.set({\n             show: 'icon',\n             toolTipText: this.tr('List mode')\n           });\n           const previewButton = this._previewButton = new qx.ui.toolbar.RadioButton('', cv.theme.dark.Images.getIcon('previewMode', 22));\n           previewButton.setUserData('mode', 'preview');\n           previewButton.set({\n             show: 'icon',\n             toolTipText: this.tr('Preview mode')\n           });\n           part.add(listButton);\n           part.add(previewButton);\n           control.add(part);\n           this._radioGroup = new qx.ui.form.RadioGroup(listButton, previewButton);\n           this._onChangeViewMode();\n           this._radioGroup.addListener('changeSelection', function (ev) {\n             const selection = ev.getData()[0];\n             cv.ui.manager.model.Preferences.getInstance().setStartViewMode(selection.getUserData('mode'));\n           }, this);\n           cv.ui.manager.model.Preferences.getInstance().addListener('changeStartViewMode', this._onChangeViewMode, this);\n\n           this._add(control);\n           break;\n         }\n\n         case 'configs-title':\n           control = new qx.ui.basic.Atom(this.tr('Configurations'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'configs');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('configs-header').add(control);\n           break;\n\n         case 'configs-header':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           control.getContentElement().setAttribute('data-section', 'configs');\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'configs-toolbar':\n           control = new cv.ui.manager.ToolBar(null, ['new-config-file', 'upload', 'reload']);\n           control.setFolder(cv.ui.manager.model.FileItem.ROOT);\n           control.addListener('reload', function () {\n             cv.ui.manager.model.FileItem.ROOT.reload();\n           }, this);\n           this.getChildControl('configs-header').add(control);\n           break;\n\n         case 'configs':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             permanentFilter: function (file) {\n               const match = this._configRegex.exec(file.getName());\n               return !!match && (!match[1] || !match[1].endsWith('temp'));\n             }.bind(this),\n             labelConverter: function (name, file) {\n               if (file.isFake()) {\n                 return name;\n               }\n               const configName = cv.ui.manager.model.FileItem.getConfigName(name);\n               return configName ? configName : '<Default>';\n             },\n             file: cv.ui.manager.model.FileItem.ROOT,\n             disableScrolling: true\n           });\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'demo-configs-title':\n           control = new qx.ui.basic.Atom(this.tr('Demo configurations'), cv.theme.dark.Images.getIcon('drop-down', 18));\n           control.setUserData('control', 'demo-configs');\n           control.getContentElement().setAttribute('data-section', 'demo');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'demo-configs':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             permanentFilter: function (file) {\n               return this._configRegex.test(file.getName());\n             }.bind(this),\n             labelConverter: function (name) {\n               const configName = cv.ui.manager.model.FileItem.getConfigName(name);\n               return configName ? configName : '<Default>';\n             },\n             disableScrolling: true\n           });\n           control.exclude();\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'media-title':\n           control = new qx.ui.basic.Atom(this.tr('Media files'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'media');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('media-header').add(control);\n           break;\n\n         case 'media-header':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           control.getContentElement().setAttribute('data-section', 'media');\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'media-toolbar':\n           control = new cv.ui.manager.ToolBar(null, ['new-file', 'upload', 'reload']);\n           control.addListener('reload', function () {\n             control.getFolder().reload();\n           }, this);\n           this.getChildControl('media-header').add(control);\n           break;\n\n         case 'media':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             disableScrolling: true\n           });\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'misc-title':\n           control = new qx.ui.basic.Atom(this.tr('Miscellaneous'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'misc');\n           control.getContentElement().setAttribute('data-section', 'misc');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'misc':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             disableScrolling: true\n           });\n           this.__initMiscFolder(control);\n           this.getChildControl('content').add(control, {flex: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    __initMiscFolder: function (folderWidget) {\n      if (!cv.ui.manager.model.FileItem.ROOT.isLoaded()) {\n        cv.ui.manager.model.FileItem.ROOT.addListenerOnce('changeLoaded', function () {\n          this.__initMiscFolder(folderWidget);\n        }, this);\n        return;\n      }\n      // find the real 'hidden.php' in the root folder\n      const specialFiles = [cv.ui.manager.model.FileItem.getIconFile()];\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(function (file) {\n        if (file.getFullPath() === 'hidden.php') {\n          // set some special flags needed to configure the special hidden configuration file\n          file.set({\n            overrideIcon: true,\n            icon: cv.theme.dark.Images.getIcon('hidden-config', 15),\n            displayName: qx.locale.Manager.tr('Hidden configuration'),\n            fake: true\n          });\n          specialFiles.unshift(file);\n          return true;\n        }\n        return false;\n      });\n      const fakeFolder = new cv.ui.manager.model.FileItem('fake', 'fake', cv.ui.manager.model.FileItem.ROOT, specialFiles).set({\n        fake: true,\n        type: 'dir',\n        loaded: true\n      });\n      folderWidget.setFile(fakeFolder);\n      folderWidget.addListener('changeSelection', this._onChangeSelection, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._configRegex = null;\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeStartViewMode', this._onChangeViewMode, this);\n    this._disposeObjects('_previewButton', '_listButton', '_radioGroup');\n  }\n});\n","/* AbstractEditor.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Abstract base class for all editors.\n */\nqx.Class.define('cv.ui.manager.editor.AbstractEditor', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._initClient();\n    this._nativePasteSupported = document.queryCommandSupported('paste');\n  },\n\n  /*\n ***********************************************\n   PROPERTIES\n ***********************************************\n */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      apply: '_loadFile',\n      event: 'changeFile'\n    },\n\n    content: {\n      nullable: true,\n      event: 'changeContent',\n      apply: '_applyContent'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true,\n      apply: '_applyHandlerOptions'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    // fake clipboard data when native clipboard is not supported\n    CLIPBOARD: null\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _handledActions: null,\n    _nativePasteSupported: false,\n\n    canHandleAction: function (actionName) {\n      if (actionName === 'save' && this.getFile() && !this.getFile().isWriteable()) {\n        return false;\n      }\n      return this._handledActions && this._handledActions.includes(actionName);\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'save':\n            this.save();\n            break;\n        }\n      }\n    },\n\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getFsClient();\n    },\n\n    _applyHandlerOptions: function () {},\n\n    _loadFile: function (file, old) {\n      if (old) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (file && file.getType() === 'file') {\n        if (file.getContent() !== null) {\n          this.setContent(file.getContent());\n        } else {\n          this._loadFromFs();\n        }\n        qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n      } else {\n        this.resetContent();\n      }\n    },\n\n    _loadFromFs: function () {\n      this._client.readSync({path: this.getFile().getFullPath()}, function (err, res) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          if (res instanceof XMLDocument) {\n            res = new XMLSerializer().serializeToString(res);\n          }\n          this.setContent(res);\n        }\n      }, this);\n    },\n\n    _onChange: function (ev) {\n      const data = ev.getData();\n      if (data.type === 'fsContentChanged' && data.source !== this) {\n        this.setContent(data.data);\n      }\n    },\n\n    // must be overridden by inheriting classes\n    _applyContent: function() {},\n\n    // must be overridden by inheriting classes\n    getCurrentContent: function () {},\n\n    _handleSaveResponse: function (type, err) {\n      if (err) {\n        cv.ui.manager.snackbar.Controller.error(err);\n      } else {\n        const message = type === 'created' ? this.tr('File has been created') : this.tr('File has been saved');\n        cv.ui.manager.snackbar.Controller.info(message);\n        this._onSaved();\n        const file = this.getFile();\n        if (file) {\n          // file content loaded from FS is outdated now\n          file.resetContent();\n          qx.event.message.Bus.dispatchByName(file.getBusTopic(), {\n            type: type,\n            file: file,\n            data: this.getCurrentContent(),\n            source: this\n          });\n        }\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      const file = this.getFile();\n      if (file.isModified()) {\n        if (file.isTemporary()) {\n          this._client.createSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash(),\n            type: 'file'\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'created'), this);\n        } else {\n          this._client.updateSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash()\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'contentChanged'), this);\n        }\n      }\n    },\n\n    _onSaved: function () {\n      const file = this.getFile();\n      if (file) {\n        file.resetModified();\n        file.resetTemporary();\n      }\n    },\n\n    showErrors: function (path, errorList) {},\n    showDecorations: function (path, decorators) {}\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    if (this._client) {\n      this._client = null;\n    }\n  }\n});\n","/* Source.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Monaco Texteditor integration\n */\nqx.Class.define('cv.ui.manager.editor.Source', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo'];\n    this.getContentElement().setAttribute('contentEditable', 'true');\n    this.set({\n      droppable: false,\n      focusable: true\n    });\n    this.addListener('dragover', function (ev) {\n      ev.preventDefault();\n      ev.dataTransfer.effectAllowed = 'none';\n      ev.dataTransfer.dropEffect = 'none';\n    });\n    this.addListener('drop', function (ev) {\n      ev.preventDefault();\n    });\n    this.addListener('appear', function () {\n      qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(false);\n    });\n    this.addListener('disappear', function () {\n      qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(true);\n    });\n    this._draw();\n    this._initWorker();\n    this._currentDecorations = [];\n    this.bind('file.writeable', this, 'selectable');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: qx.locale.Manager.tr('Texteditor'),\n    COUNTER: 0,\n    MONACO_EXTENSION_REGEX: null,\n    SUPPORTED_FILES: function (file) {\n      let filename = typeof file === 'string' ? file : file.getFullPath().toLowerCase();\n      if (window.monaco && window.monaco.languages) {\n        if (!cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX) {\n          // monaco has already been loaded, we can use its languages configuration to check if this file is supported\n          const extensions = [];\n          monaco.languages.getLanguages().forEach(function (lang) {\n            if (lang.extensions) {\n              lang.extensions.forEach(function (ext) {\n                ext = ext.replace(/\\./g, '\\\\.');\n                if (extensions.indexOf(ext) === -1) {\n                  extensions.push(ext);\n                }\n              });\n            }\n          });\n          cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX = new RegExp('(' + extensions.join('|') + ')$');\n        }\n        return cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX.test(filename);\n      } \n        return /\\.(xml|html|php|css|js|svg|json|md|yaml|conf|ts|rst|py|txt)$/i.test(filename);\n    },\n    DEFAULT_FOR: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    ICON: cv.theme.dark.Images.getIcon('text', 18),\n\n    load: function (callback, context) {\n      const version = qx.core.Environment.get('qx.debug') ? 'dev' : 'min';\n      const sourcePath = qx.util.Uri.getAbsolute(qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/..');\n      const loader = new qx.util.DynamicScriptLoader([\n        sourcePath + 'node_modules/monaco-editor/' + version + '/vs/loader.js',\n        'manager/xml.js'\n      ]);\n      loader.addListener('ready', function () {\n        window.require.config({\n          paths: {\n            'vs': sourcePath + 'node_modules/monaco-editor/' + version + '/vs'\n          }\n        });\n        window.require.config({\n          'vs/nls' : {\n            availableLanguages: {\n              '*': qx.locale.Manager.getInstance().getLanguage() !== 'en' ? qx.locale.Manager.getInstance().getLanguage() : ''\n            }\n          }\n        });\n        window.require([\n          'xml!*./resource/manager/completion-libs/qooxdoo.d.ts', // the xml loader can load any file by adding * before the path,\n          'vs/editor/editor.main'\n        ], function (qxLib) {\n          callback.apply(context);\n          window.monaco.languages.typescript.javascriptDefaults.addExtraLib(qxLib, 'qooxdoo.d.ts');\n          const completionProvider = new cv.ui.manager.editor.completion.Config();\n          const cvCompletionProvider = new cv.ui.manager.editor.completion.CometVisu();\n          window.monaco.languages.registerCompletionItemProvider('javascript', cvCompletionProvider.getProvider());\n          window.monaco.languages.registerCompletionItemProvider('xml', completionProvider.getProvider());\n        });\n      }, this);\n      loader.addListener('failed', function (ev) {\n        qx.log.Logger.error(this, ev.getData());\n      }, this);\n      loader.start();\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _editor: null,\n    _workerWrapper: null,\n    _currentDecorations: null,\n    _configClient: null,\n    _onDidChangeContentGuard: 0,\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n      this._workerWrapper.setEditor(this);\n    },\n\n    _getDefaultModelOptions: function () {\n      return {\n        tabSize: 2,\n        indentSize: 2,\n        insertSpaces: true\n      };\n    },\n\n    _draw: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._draw, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', this._draw, this);\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: true\n            },\n            theme: 'vs-dark'\n          });\n          const baseVersion = cv.Version.VERSION.split('-')[0];\n          const xhr = new qx.io.request.Xhr(qx.util.ResourceManager.getInstance().toUri('hidden-schema.json'));\n          xhr.set({\n            method: 'GET',\n            accept: 'application/json'\n          });\n          xhr.addListenerOnce('success', function (e) {\n            const req = e.getTarget();\n            const schema = req.getResponse();\n            window.monaco.languages.json.jsonDefaults.setDiagnosticsOptions({\n              validate: true,\n              allowComments: true,\n              schemas: [{\n                uri: 'https://www.cometvisu.org/CometVisu/schemas/' + baseVersion + '/hidden-schema.json',\n                fileMatch: ['hidden.php'],\n                schema: schema\n              }]\n            });\n          }, this);\n          xhr.send();\n\n          if (this.getFile()) {\n            this._loadFile(this.getFile());\n          }\n          this._editor.onDidChangeModelContent(this._onContentChanged.bind(this));\n        }\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'cut':\n            this._editor.trigger('external', 'editor.action.clipboardCutAction');\n            if (!this._nativePasteSupported) {\n              // we have no access to the native clipboard for pasting, so we need to save the value to copy somewhere else\n              // and implement the pasting manually\n              cv.ui.manager.editor.AbstractEditor.CLIPBOARD = this._editor.getModel().getValueInRange(this._editor.getSelection());\n            }\n            break;\n          case 'copy':\n            this._editor.trigger('external', 'editor.action.clipboardCopyAction');\n            if (!this._nativePasteSupported) {\n              // we have no access to the native clipboard for pasting, so we need to save the value to copy somewhere else\n              // and implement the pasting manually\n              cv.ui.manager.editor.AbstractEditor.CLIPBOARD = this._editor.getModel().getValueInRange(this._editor.getSelection());\n            }\n            break;\n          case 'paste':\n            if (this._nativePasteSupported) {\n              this._editor.trigger('external', 'editor.action.clipboardPasteAction');\n            } else {\n              this._paste();\n            }\n            break;\n          case 'undo':\n          case 'redo':\n            this._editor.trigger('external', actionName);\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    /**\n     * Manual paste into source editor is used when the native paste is not supported by the browser.\n     * This is the case when the cometvisu is not running is a safe environment (no https / localhost)\n     * @private\n     */\n    _paste: function () {\n      if (cv.ui.manager.editor.AbstractEditor.CLIPBOARD) {\n        const selection = this._editor.getSelection();\n        const id = {major: 1, minor: 1};\n        const op = {\n          identifier: id,\n          range: selection,\n          text: cv.ui.manager.editor.AbstractEditor.CLIPBOARD,\n          forceMoveMarkers: true\n        };\n        this._editor.executeEdits('clipboard', [op]);\n      }\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (this._editor) {\n        if (file && file.getType() === 'file' && this.isSupported(file)) {\n          this.base(arguments, file, old);\n        } else {\n          this.base(arguments, null, old);\n        }\n      }\n    },\n\n    _loadFromFs: function () {\n      if (this.getFile().getName() === 'hidden.php') {\n        if (!this._configClient) {\n          this._configClient = cv.io.rest.Client.getConfigClient();\n          this._configClient.addListener('getSuccess', function (ev) {\n            this.setContent(JSON.stringify(ev.getData(), null, 2));\n          }, this);\n          this._configClient.addListener('updateSuccess', this._onSaved, this);\n        }\n        this._configClient.get({section: '*', key: '*'});\n      } else {\n        this.base(arguments);\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      if (this.getFile().getName() === 'hidden.php') {\n        if (!this.getFile().isValid()) {\n          cv.ui.manager.snackbar.Controller.error(this.tr('Hidden config is invalid, please correct the errors'));\n        } else if (this.getFile().getHasWarnings()) {\n          // ask user if he really want to save a file with warnings\n          qxl.dialog.Dialog.confirm(this.tr('Hidden config content has some warnings! It is recommended to fix the warnings before saving. Save anyways?'), function (confirmed) {\n            if (confirmed) {\n              this.__saveHiddenConfig();\n            }\n          }, this, qx.locale.Manager.tr('Confirm saving with warnings'));\n        } else {\n          this.__saveHiddenConfig();\n        }\n      } else {\n        this.base(arguments, callback, overrideHash);\n      }\n    },\n\n    __saveHiddenConfig: function () {\n      this._configClient.saveSync(null, JSON.parse(this.getCurrentContent()), function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(this.tr('Saving hidden config failed with error %1 (%2)', err.status, err.statusText));\n        } else {\n          cv.ui.manager.snackbar.Controller.info(this.tr('Hidden config has been saved'));\n          this._onSaved();\n        }\n      }, this);\n    },\n\n    _applyContent: function(value) {\n      const file = this.getFile();\n      if (!file) {\n        return;\n      }\n      const model = this._editor.getModel();\n      if (this._workerWrapper) {\n        this._workerWrapper.open(file, value);\n      }\n      const id = monaco.Uri.parse(file.getUri());\n      let newModel = window.monaco.editor.getModel(id);\n      if (!newModel) {\n        // create new model\n        if (qx.xml.Document.isXmlDocument(value)) {\n          value = value.documentElement.outerHTML;\n        } else if (typeof value === 'object') {\n          value = JSON.stringify(value, null, 2);\n        }\n        newModel = window.monaco.editor.createModel(value, this._getLanguage(file), id);\n        newModel.onDidChangeDecorations(function (ev) {\n          let errors = false;\n          let warnings = false;\n          monaco.editor.getModelMarkers({\n            owner: newModel.getLanguageId(),\n            resource: id\n          }).some(function (marker) {\n            if (marker.severity === monaco.MarkerSeverity.Warning) {\n              warnings = true;\n            } else if (marker.severity === monaco.MarkerSeverity.Error) {\n              errors = true;\n            }\n            return warnings && errors;\n          }, this);\n          file.setValid(!errors);\n          file.setHasWarnings(warnings);\n        });\n      }\n\n      if (model !== newModel) {\n        newModel.updateOptions(this._getDefaultModelOptions());\n        this._editor.setModel(newModel);\n      } else {\n        this._editor.setValue(value);\n      }\n      this._editor.updateOptions({ readOnly: !file.isWriteable() });\n      this._processHandlerOptions(value);\n    },\n\n    _processHandlerOptions: function (content) {\n      const handlerOptions = this.getHandlerOptions() || {};\n      if (Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true && content) {\n        const [err, res] = this._upgradeConfig(content);\n        if (err) {\n          this.error(err);\n        } else {\n          this._editor.setValue(this._convertToString(res));\n        }\n      }\n    },\n\n    _convertToString: function (xml) {\n      return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n' + xml.documentElement.outerHTML;\n    },\n\n    _upgradeConfig: function (content) {\n      if (this.getFile()) {\n        if (this.getFile().isWriteable()) {\n          const upgrader = new cv.util.ConfigUpgrader();\n          return upgrader.upgrade(content);\n        }\n        cv.ui.manager.snackbar.Controller.error(this.tr('\"%1\" is not writable. Upgrading not possible.', this.getFile().getFullPath()));\n      }\n      return [null, '', []];\n    },\n\n    getCurrentContent: function () {\n      return this._editor.getValue();\n    },\n\n    _onContentChanged: function () {\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), this._editor.getValue());\n      }\n    },\n\n    isSupported: function (file) {\n      const parts = file.getName().split('.');\n      const fileType = parts.length > 1 ? parts.pop() : 'txt';\n      const typeExt = '.' + fileType;\n      return monaco.languages.getLanguages().some(function (lang) {\n        return lang.id === fileType || (lang.extensions && lang.extensions.indexOf(typeExt) >= 0);\n      });\n    },\n\n    showErrors: function (path, errorList) {\n      const markers = [];\n      const model = this._editor.getModel();\n      if (!model) {\n        return;\n      }\n      let firstErrorLine = -1;\n      /**\n       * @param line\n       */\n      function check(line) {\n        if (firstErrorLine < 0 || firstErrorLine > line) {\n          firstErrorLine = line;\n        }\n      }\n      if (errorList) {\n        errorList.forEach(function (error) {\n          check(error.line);\n          markers.push({\n            severity: window.monaco.MarkerSeverity.Error,\n            startLineNumber: error.line,\n            endLineNumber: error.line,\n            message: error.message,\n            startColumn: error.startColumn,\n            endColumn: error.endColumn\n          });\n        });\n      }\n      if (this.getFile().getFullPath() === path) {\n        window.monaco.editor.setModelMarkers(model, model.getLanguageId(), markers);\n        const options = this.getHandlerOptions();\n        if (options && options.jumpToError) {\n          // jump too first error (only when we are at the beginning\n          if (this._editor.getScrollTop() === 0) {\n            this._editor.revealLineInCenter(firstErrorLine);\n          }\n        }\n      } else {\n        // TODO: save errors for later\n      }\n    },\n\n    showDecorations: function (path, decorators) {\n      if (this.getFile().getFullPath() === path) {\n        this._editor.deltaDecorations(this._currentDecorations[path], decorators);\n      }\n      this._currentDecorations[path] = decorators;\n    },\n\n    _getLanguage: function (file) {\n      if (file.getName() === 'hidden.php') {\n        // override this setting as we are loading the hidden config from its REST endpoint as JSON\n        return 'json';\n      }\n      let type = file.getName().split('.').pop();\n      switch (type) {\n        case 'svg':\n          return 'xml';\n        case 'js':\n          return 'javascript';\n        case 'md':\n          return 'markdown';\n        default: {\n          if (!type) {\n            return 'txt';\n          }\n          // check if monaco knows this ending, otherwise fallback to plaintext\n          const typeExt = '.' + type;\n          const found = monaco.languages.getLanguages().some(function (lang) {\n            return lang.id === type || (lang.extensions && lang.extensions.indexOf(typeExt) >= 0);\n          });\n          if (!found) {\n            type = 'txt';\n          }\n          return type;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._workerWrapper = null;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n    this._configClient = null;\n    qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(true);\n  }\n});\n","/* Tree.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n    this._initWorker();\n\n    // init schema\n    this._schemas = {};\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', ev => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    }, this);\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener('keyup', this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n    this._draw();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schemas: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n    _structure: null,\n\n    async getSchema(file) {\n      if (file.startsWith('../')) {\n        file = file.substring(3);\n      }\n      if (!Object.prototype.hasOwnProperty.call(this, file)) {\n        this._schemas[file] = cv.ui.manager.model.Schema.getInstance(file);\n      }\n      return new Promise((resolve, reject) => {\n        this._schemas[file].onLoaded(function () {\n          this.setReady(true);\n          resolve(this._schemas[file]);\n        }, this);\n      });\n    },\n\n    isPreviewSynced: function () {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions: function () {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility: function () {\n      const handlerOptions = this.getHandlerOptions();\n      this.setShowPreview(qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview));\n    },\n\n    _applyShowPreview: function (value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({flex: 1});\n        }\n      }\n      const file = this.getFile();\n      if (value && file) {\n        const preview = this.getChildControl('preview');\n        if (file.isWriteable()) {\n          if (!preview.getFile()) {\n            preview.setFile(this.__getPreviewFile());\n          }\n        } else {\n          // this file is not writable, we can use the real one for preview\n          preview.setFile(file);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'undo':\n            if (!this.__editing) {\n              this.undo();\n            }\n            break;\n\n          case 'redo':\n            if (!this.__editing) {\n              this.redo();\n            }\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            if (!this.__editing) {\n              this._showHelp();\n            }\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getUnDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getReDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return value ? !value.isDeletable() : false;\n            }\n          });\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n      }\n    },\n    unConfigureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo: function (elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo: function () {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error('could not undo ' + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo: function () {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error('could not redo ' + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos: function () {\n      this.getUnDos().removeAll().forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos: function () {\n      this.getReDos().removeAll().forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard: function (value) {\n      try {\n        if (value) {\n          navigator.clipboard.writeText(value.getNode().outerHTML);\n        } else {\n          navigator.clipboard.writeText('');\n        }\n      } catch (e) {\n        // clipboard api is only available in secure environment, otherwise we have to do it ourself\n        cv.ui.manager.editor.AbstractEditor.CLIPBOARD = value ? value.getNode().outerHTML : '';\n      }\n    },\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors: function (path, errorList) {\n    },\n    showDecorations: function (path, decorators) {\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        this.base(arguments, file, old);\n      } else {\n        this.base(arguments, null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'splitpane':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this._add(control);\n           break;\n\n         case 'left':\n           control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n           this.getChildControl('splitpane').addAt(control, 0);\n           break;\n\n         case 'right':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n           if (!this.isShowPreview()) {\n             control.exclude();\n           }\n           this.getChildControl('splitpane').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview':\n           control = new cv.ui.manager.viewer.Config();\n           control.set({\n             target: 'iframe',\n             minWidth: 600\n           });\n           this.getChildControl('right').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview-sync-hint': {\n           const ok = this.tr('Preview shows the current state of the edited configuration.');\n           const noSync = this.tr('Preview is out of sync. Click here to refresh.');\n           const notOk = this.tr('Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.');\n           control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n           control.setRich(true);\n           control.getChildControl('label').setWrap(true);\n           control.addListener('tap', () => {\n             if (!this.isPreviewSynced() && this.isShowPreview()) {\n               this._updatePreview();\n             }\n           }, this);\n           this.getChildControl('right').addAt(control, 0);\n           this.addListener('previewStateChanged', ev => {\n             switch (ev.getData()) {\n               case 'synced':\n                 control.set({\n                   label: ok,\n                   icon: cv.theme.dark.Images.getIcon('valid', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n\n               case 'changed':\n                 control.set({\n                   label: noSync,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').addState('warning');\n                 break;\n\n               case 'structureChanged':\n                 control.set({\n                   label: notOk,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').addState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n             }\n           }, this);\n           break;\n         }\n\n         case 'edit-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n           control.setEnabled(false);\n           control.addListener('execute', this._onEdit, this);\n           this.bind('file.writeable', control, 'icon', {\n             converter: function (value) {\n               return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16);\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n           control.setEnabled(false);\n           control.addListener('execute', this._onDelete, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toggle-expert':\n           control = new qx.ui.toolbar.CheckBox(this.tr('Expertview'),\n             cv.theme.dark.Images.getIcon('expert', 16));\n           control.addListener('execute', function () {\n             this.toggleExpert();\n           }, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'refresh-preview':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n           control.setToolTipText(this.tr('Reload preview'));\n           control.addListener('execute', this._updatePreview, this);\n           this.bind('showPreview', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'hidden';\n             }\n           });\n           this.bind('previewState', control, 'enabled', {\n             converter: function (value) {\n               return value !== 'synced';\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toolbar':\n           control = new qx.ui.toolbar.ToolBar();\n           this.getChildControl('left').add(control, {\n             top: 0,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar-container':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this.getChildControl('left').add(control, {\n             top: 36,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             placeholder: this.tr('Search...'),\n             margin: 8\n           });\n           control.addListener('changeValue', qx.util.Function.debounce(this._onSearch, 250), this);\n           control.addListener('keyup', function (ev) {\n             switch (ev.getKeyIdentifier()) {\n               case 'Enter':\n               case 'Down':\n                 this._showNextResult();\n                 break;\n               case 'Up':\n                 this._showPreviousResult();\n                 break;\n             }\n             ev.stopPropagation();\n           }, this);\n           this.getChildControl('searchbar-container').add(control, {flex: 1});\n           break;\n\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n           control.set({\n             selectionMode: 'single',\n             width: 350,\n             openMode: 'none',\n             itemHeight: qx.core.Environment.get('device.touch') ? 40 : 20\n           });\n           this.bind('file.writeable', control, 'droppable');\n           this.bind('file.writeable', control, 'draggable');\n           this._initDragDrop(control);\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualElementItem();\n               if (!qx.core.Environment.get('device.touch')) {\n                 item.addListener('contextmenu', this._onContextMenu, this);\n               } else {\n                 item.addListener('action', this._onContextMenuAction, this);\n               }\n               item.addListener('dbltap', this._onEdit, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindProperty('displayName', 'label', null, item, index);\n               controller.bindProperty('name', 'name', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('showEditButton', 'editable', null, item, index);\n               controller.bindProperty('sortable', 'sortable', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('status', 'status', null, item, index);\n               controller.bindProperty('invalidMessage', 'toolTipText', null, item, index);\n               controller.bindProperty('dragging', 'dragging', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this.getChildControl('left').add(control, {\n             top: 72,\n             left: 0,\n             right: 0,\n             bottom: 0\n           });\n           break;\n\n         case 'add-button':\n           control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n           control.setDraggable(true);\n           control.setMarginLeft(-16);\n           control.setZIndex(20);\n           this.addListener('changeDragging', ev => {\n             control.setLayoutProperties({\n               bottom: 16,\n               left: ev.getData() ? -1000 : '50%'\n             });\n           }, this);\n           control.setAppearance('round-button');\n           control.addListener('pointerover', () => control.addState('hovered'));\n           control.addListener('pointerout', () => control.removeState('hovered'));\n           control.addListener('tap', () => {\n             if (this.getSelected()) {\n               this._onCreate(this.getSelected(), 'inside');\n             } else {\n               qxl.dialog.Dialog.alert(this.tr('Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.'));\n             }\n           }, this);\n           this.getChildControl('left').add(control, {\n             bottom: 16,\n             left: '50%'\n           });\n           break;\n\n         case 'drag-indicator':\n           // Create drag indicator\n           control = new qx.ui.core.Widget();\n           control.setDecorator(new qx.ui.decoration.Decorator().set({\n             widthTop: 1,\n             styleTop: 'solid',\n             colorTop: 'white'\n           }));\n           control.setHeight(0);\n           control.setOpacity(0.5);\n           control.setZIndex(100);\n           control.setDroppable(true);\n           control.setLayoutProperties({left: -1000, top: -1000});\n           qx.core.Init.getApplication().getRoot().add(control);\n           break;\n\n         case 'context-menu':\n           control = new cv.ui.manager.contextmenu.ConfigElement(this);\n           control.addListener('action', this._onContextMenuAction, this);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    _onContextMenu: function (ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction: function (ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, 'inside');\n            break;\n\n          default:\n            this.error('unhandled context menu action', data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n\n    openByQuerySelector: function (selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch: function (ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || el.hasAttribute('name') && el.getAttribute('name').startsWith(value);\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult: function () {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult: function () {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult: function () {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length-1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop: function (control) {\n      let draggedXmlElement;\n      control.addListener('dragstart', function (ev) {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction('copy');\n          if (element.isDeletable()) {\n            ev.addAction('move');\n          }\n          ev.addType('cv/tree-element');\n          ev.addData('cv/tree-element', element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      }, this);\n\n      const addButton = this.getChildControl('add-button');\n      addButton.addListener('dragstart', function (ev) {\n        ev.addAction('copy');\n        ev.addType('cv/new-tree-element');\n        this.setDragging(true);\n      }, this);\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      };\n\n      control.addListener('dragover', function (ev) {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType('cv/tree-element')) {\n          element = ev.getData('cv/tree-element');\n        }\n        const addNew = action === 'copy' && !element && ev.supportsType('cv/new-tree-element');\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug('dragging over indicator');\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug('dropping on same element forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug('moving inside own subtree forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && (ev.getDocumentTop() - layerContent.bottom <= 20)) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(Math.round((layerContent.left + layerContent.right) / 2), layerContent.bottom - 20);\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug('drop target not found');\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug('drop not allowed here, no drag element');\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n                    if ((acc & Allowed.BEFORE) && (acc & Allowed.AFTER)) {\n                      // we cannot find more\n                      return true;\n                    }\n                    return false;\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug('no children allowed here');\n            }\n          } else if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n              // not allowed on this level\n              accepted.mode = Allowed.NONE;\n              this.debug('not allowed as child element of', parent.getName());\n            } else if (parentSchemaElement.areChildrenSortable()) {\n              // children can be put anywhere\n              // so this is allowed anywhere\n              accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n            } else {\n              // check position\n              accepted.mode = this.__getAllowedPositions(parentSchemaElement.getAllowedElementsSorting(), element.getName(), model.getName());\n            }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug('dropping not accepted here');\n        }\n      }, this);\n\n      const indicator = this.getChildControl('drag-indicator');\n\n      let expandTimer;\n\n      control.addListener('dragleave', function (ev) {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      }, this);\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = '';\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = 'after';\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if ((ev.getDocumentTop() - origCoords.top) <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = 'before';\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = 'inside';\n              }\n            } else if ((origCoords.bottom - ev.getDocumentTop()) <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = 'after';\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = 'inside';\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                // eslint-disable-next-line no-lonely-if\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                } else {\n                  this.debug('not allowed as first child');\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              // eslint-disable-next-line no-lonely-if\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData('position') !== 'first-child') {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = 'inside';\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(function () {\n                    if (accepted.target) {\n                      control.openNode(accepted.target);\n                    }\n                  }, this, 1000);\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData('position', position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData('action', ev.getCurrentAction());\n          cursor.resetAction();\n          // eslint-disable-next-line no-console\n          console.assert(left < 0);\n          // eslint-disable-next-line no-console\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData('action')) {\n          cursor.setAction(indicator.getUserData('action'));\n          indicator.setUserData('action', null);\n        }\n      };\n      control.addListener('drag', onDrag, this);\n      addButton.addListener('drag', onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction();\n        let element = ev.supportsType('cv/tree-element') ? ev.getData('cv/tree-element') : null;\n        if (action === 'copy') {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = 'add';\n          }\n        }\n        const elementName = element ? element.getDisplayName() : 'new';\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData('position')) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, 'after', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, 'before', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as first child');\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName() + ' as first child');\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as child');\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName(), 'as child');\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener('drop', onDrop, this);\n      indicator.addListener('drop', onDrop, this);\n\n      const onDragEnd = function(ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener('dragend', onDragEnd, this);\n      addButton.addListener('dragend', onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate: function (target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex-1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(name => Object.prototype.hasOwnProperty.call(sorting, name) && sorting[name] <= maxPosition && sorting[name] >= minPosition);\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm;\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr('<p style=\\'font-weight:bold\\'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>'),\n            formData: {\n              type: {\n                type: 'SelectBox',\n                label: this.tr('Choose element'),\n                help: this.tr('Please choose the element you want to add here.'),\n                options: addable.sort((a, b) => {\n                  if (a.startsWith('#') && !b.startsWith('#')) {\n                    return 1;\n                  } else if (!a.startsWith('#') && b.startsWith('#')) {\n                    return -1;\n                  }\n                  return a.localeCompare(b);\n                }).map(name => ({label: name, value: name})),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          }).show().promise();\n        } else {\n          typeChooserForm = Promise.resolve({type: addable[0]});\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment('');\n                break;\n\n              case '#text':\n                element = document.createTextNode('');\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection('');\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode('-');\n                element.appendChild(child);\n              }\n            };\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement, true);\n            }\n            res.then(data => {\n              if (data) {\n                // finally insert the new node\n                switch (position) {\n                  case 'before':\n                    xmlElement.insertBefore(target);\n                    break;\n\n                  case 'after':\n                    xmlElement.insertAfter(target);\n                    break;\n\n                  case 'inside':\n                    target.insertChild(xmlElement, -1, false, 'added');\n                    break;\n\n                  case 'first-child':\n                    target.insertChild(xmlElement, 0, false, 'added');\n                    break;\n                }\n                this.getChildControl('tree').openNodeAndParents(xmlElement);\n                this.getChildControl('tree').setSelection([xmlElement]);\n              }\n            }, this).catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions: function (allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === 'string') {\n          currentPosition = currentPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === 'string') {\n          targetPosition = targetPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length);\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n      }\n      return cv.ui.manager.editor.Tree.Allowed.NONE;\n    },\n\n    __checkProvider: function (id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error('misconfigured provider found for ' + id);\n        }\n        formData.type = provider.userInputAllowed ? 'VirtualComboBox' : 'VirtualSelectBox';\n      } else if (['mapping', 'styling'].includes(id.split('@').pop())) {\n        const type = id.split('@').pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = 'SelectBox';\n        formData.options = [];\n        const selector = this._structure === 'tile' ? 'cv-meta > cv-' + type : 'meta > ' + type + 's > ' + type;\n        rootNode.querySelectorAll(selector).forEach(element => {\n          const name = element.getAttribute('name');\n          formData.options.push({label: name, value: name});\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options.then(res => {\n              if (Array.isArray(res)) {\n                res.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n              }\n            }).catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition: function (element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: 'TextField',\n        label: attribute.getName(),\n        placeholder: ' - ' + this.tr('not set') + ' - ',\n        help: docs.join('<br/>'),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator: function (value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n            }\n          }\n        }\n      };\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = 'CheckBox';\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string': {\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = 'SelectBox';\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({label: name, value: name});\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + '@' + attribute.getName(), def, element.getNode());\n          }\n          break;\n        }\n      }\n      return def;\n    },\n\n    _onEdit: function (ev, element, isNew) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return null;\n      }\n      let title;\n      let caption;\n      if (!element) {\n        if (this.getSelected()) {\n          element = this.getSelected();\n        } else {\n          return null;\n        }\n      }\n      if (!element.getShowEditButton()) {\n        return null;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (isNew) {\n        title = this.tr('Create new %1 element', element.getName());\n        caption = this.tr('Please edit the attributes of the new %1 element, that will be added to the chosen position.', element.getName());\n      } else {\n        title = this.tr('Edit element attributes');\n        caption = element.isEditable() ? this.tr('Edit %1', element.getName()) : this.tr('Show %1', element.getName());\n      }\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n        if (typeElement.isChildElementAllowed('*')) {\n          const parser = new DOMParser();\n          const attrName = element.getNode().nodeName === 'custom' ? '#innerHTML' : '#outerHTML';\n          if (isNew) {\n            title = this.tr('Create new %1 element', element.getName());\n            caption = this.tr('Please edit the content of the new %1 element, that will be added to the chosen position.', element.getName());\n          } else {\n            title = attrName === '#outerHTML' ? this.tr('Edit element and content') : this.tr('Edit element content');\n          }\n          formData[attrName] = {\n            type: 'TextArea',\n            label: '',\n            lines: 5,\n            autoSize: true,\n            width: Math.min(qx.bom.Viewport.getWidth(), 500),\n            enabled: element.isEditable(),\n            value: attrName === '#outerHTML' ? element.getNode().outerHTML : element.getNode().innerHTML,\n            validation: {\n              validator: function (value) {\n                if (value) {\n                  const dom = parser.parseFromString(value, 'text/xml');\n                  if (dom.getElementsByTagName('parsererror').length > 0) {\n                    throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n                  }\n                }\n              }\n            }\n          };\n        }\n      } else if (element.getNode().nodeType === Node.TEXT_NODE || element.getNode().nodeType === Node.COMMENT_NODE || element.getNode().nodeType === Node.CDATA_SECTION_NODE) {\n        title = this.tr('Edit text content', element.getName());\n        caption = '';\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: 'TextArea',\n          label: '',\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr('not set'),\n          help: docs.join('<br/>'),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator: function (value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n              }\n            }\n          }\n        };\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute('type');\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(element.getParent().getName() + '@' + element.getName(), formData[nodeName], element.getNode());\n      }\n      this.__editing = true;\n\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption:  title,\n        message: caption,\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          if (!Object.prototype.hasOwnProperty.call(data, '#outerHTML') && !Object.prototype.hasOwnProperty.call(data, '#innerHTML')) {\n            element.validate();\n          }\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete: function (ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n      return null;\n    },\n\n    _onCut: function () {\n      if (this.__editing) {\n        document.execCommand('cut');\n      } else {\n        const element = this._onDelete();\n        if (element) {\n          this.setClipboard(element);\n        }\n      }\n    },\n\n    _onCopy: function () {\n      if (this.__editing) {\n        document.execCommand('copy');\n      } else {\n        const element = this.getSelected();\n        if (element) {\n          const copy = element.clone();\n          this.setClipboard(copy);\n        }\n      }\n    },\n\n    _onPaste: function () {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified: function (element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else if (element.isModified()) {\n          if (index === -1) {\n            this.__modifiedElements.push(element);\n          }\n          if (previewIndex === -1) {\n            this.__modifiedPreviewElements.push(element);\n          }\n        } else {\n          if (index >= 0) {\n            this.__modifiedElements.splice(index, 1);\n          }\n          if (previewIndex >= 0) {\n            this.__modifiedPreviewElements.splice(index, 1);\n          }\n        }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw: function () {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget: function () {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          if (this._structure === 'tile') {\n            while (node && node.nodeName !== 'config') {\n              if (node.nodeName === 'cv-page') {\n                preview.openPage(node.getAttribute('id'));\n                break;\n              }\n              node = node.parentNode;\n            }\n          } else {\n            while (node && node.nodeName !== 'pages') {\n              if (node.nodeName === 'page') {\n                path.unshift(node.getAttribute('name'));\n              }\n              node = node.parentNode;\n            }\n            if (path.length > 0) {\n              preview.openPage(path.pop(), path.join('/'));\n            }\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp: function(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === 'Enter') {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent: function(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + ' is a valid config file');\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n              dialog.addListener('action', ev => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source': {\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: 'cv.ui.manager.editor.Source',\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n                    break;\n                  }\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n                dialog.hide();\n                dialog.destroy();\n              }, this);\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __getPreviewFile: function () {\n      let file;\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(f => {\n        if (f.getName() === 'visu_config_previewtemp.xml') {\n          file = f;\n          return true;\n        }\n        return false;\n      });\n      if (!file) {\n        file = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', this.getFile().getParent());\n        file.setTemporary(true);\n      }\n      return file;\n    },\n\n    __loadContent: async function (value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const doc = qx.xml.Document.fromString(value);\n        const rootElement = doc.documentElement;\n        const schema = await this.getSchema(rootElement.getAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'noNamespaceSchemaLocation'));\n        const schemaElement = schema.getElementNode(rootElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(rootElement, schemaElement, this);\n        this._structure = schema.getStructure();\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n          // extra space fr add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (file.isWriteable()) {\n            if (!preview.getFile()) {\n              preview.setFile(this.__getPreviewFile());\n            }\n          } else {\n            preview.setFile(file);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split('/');\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error('Error loading ' + current.getName() + ': ' + e.toString());\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error('patch segment format error: ' + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      } else {\n        this._structure = null;\n      }\n    },\n\n    _onContentChanged: function () {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview: function (ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        if (previewFile.isTemporary()) {\n          this._client.createSync({\n            path: previewFile.getFullPath(),\n            hash: 'ignore'\n          }, content, () => {\n            qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n              type: 'contentChanged',\n              file: previewFile,\n              data: content,\n              source: this\n            });\n            this.__modifiedPreviewElements.removeAll();\n            this.resetPreviewState();\n            previewFile.resetTemporary();\n          }, this);\n        } else {\n          this._client.updateSync({\n            path: previewFile.getFullPath(),\n            hash: 'ignore'\n          }, content, () => {\n            qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n              type: 'contentChanged',\n              file: previewFile,\n              data: content,\n              source: this\n            });\n            this.__modifiedPreviewElements.removeAll();\n            this.resetPreviewState();\n          }, this);\n        }\n      }\n    },\n\n    getCurrentContent: function (fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        } \n        // prettify content\n        return cv.util.Prettifier.xml(rootNode.ownerDocument);\n      } \n        return null;\n    },\n\n    _onSaved: function () {\n      this.base(arguments);\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported: function (file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp: function () {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr('Help'),\n        modal: true,\n        image: 'qxl.dialog.icon.info',\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: ''\n      };\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr('<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with \\'Enter\\' or the \\'Down\\' key. Accordingly you can jump the the previous found element \\\nwith the \\'Up\\' key.</p>');\n      } else {\n        // show general help\n        dialogConf.message = this.tr('<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the \\'edit\\'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the \\'edit\\'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the \\'add child\\'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the \\'Expertview\\'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>');\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._schemas = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener('keyup', this._onElementKeyUp, this);\n  }\n});\n","/* Diff.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Monaco Texteditor for file content comparison\n */\nqx.Class.define('cv.ui.manager.editor.Diff', {\n  extend: cv.ui.manager.editor.Source,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    // this._handledActions = [];\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    COUNTER: 0,\n    TITLE: qx.locale.Manager.tr('File compare'),\n    ICON: cv.theme.dark.Images.getIcon('compare', 18)\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    originalContent: {\n      check: 'String',\n      init: '',\n      apply: '_applyContent'\n    },\n\n    modifiedContent: {\n      check: 'String',\n      init: '',\n      apply: '_applyContent'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyEditable'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyEditable: function(value) {\n      if (this._editor) {\n        this._editor.updateOptions({readOnly: !value});\n      }\n    },\n\n    // overridden, worker is a singleton and not usable for the diff editor\n    _initWorker: function () {},\n\n    _draw: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._draw, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', this._draw, this);\n        } else {\n          this._editor = window.monaco.editor.createDiffEditor(domElement, {\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            theme: 'vs-dark',\n            readOnly: !this.getEditable()\n          });\n          if (this.getFile()) {\n            this._loadFile(this.getFile());\n          }\n        }\n      }\n    },\n\n    _applyContent: function () {\n      const original = this.getOriginalContent();\n      const modified = this.getModifiedContent();\n      if (original && modified) {\n        const file = this.getFile();\n        const originalFile = file instanceof cv.ui.manager.model.CompareFiles ? file.getOriginalFile() : file;\n        const modifiedFile = file instanceof cv.ui.manager.model.CompareFiles ? file.getModifiedFile() : file;\n        const originalModel = window.monaco.editor.createModel(original, this._getLanguage(originalFile));\n        originalModel.updateOptions(this._getDefaultModelOptions());\n        const modifiedModel = window.monaco.editor.createModel(modified, this._getLanguage(modifiedFile));\n        modifiedModel.updateOptions(this._getDefaultModelOptions());\n        this._editor.setModel({\n          original: originalModel,\n          modified: modifiedModel\n        });\n      }\n    },\n\n    getCurrentContent: function () {\n      return this._editor.getModifiedEditor().getValue();\n    },\n\n    clear: function () {\n      this._editor.getModel().original.dispose();\n      this._editor.getModel().modified.dispose();\n    },\n\n    save: function (callback) {\n      const handlerOptions = this.getHandlerOptions();\n      if (this.getFile() instanceof cv.ui.manager.model.FileItem && Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true) {\n        this.base(arguments, callback, 'ignore');\n      }\n    },\n\n    _loadFile: function (file, old) {\n      if (old && old instanceof cv.ui.manager.model.FileItem) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (this._editor) {\n        const handlerOptions = this.getHandlerOptions();\n        if (file && file instanceof cv.ui.manager.model.FileItem && Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true) {\n          if (!file.isWriteable()) {\n            cv.ui.manager.snackbar.Controller.error(this.tr('\"%1\" is not writable. Upgrading not possible.', this.getFile().getFullPath()));\n            cv.ui.manager.Main.getInstance().closeFile(file);\n            return;\n          }\n          qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n          this.setEditable(file.isWriteable());\n          this._client.readSync({path: file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setOriginalContent(res);\n              const [err, upgradedContent, changes] = this._upgradeConfig(res);\n              if (err) {\n                qxl.dialog.Dialog.error(err);\n                qx.event.message.Bus.dispatchByName('cv.manager.action.close');\n              } else {\n                this.setModifiedContent(this._convertToString(upgradedContent));\n                let changesText = changes.length > 0\n                  ? '<div>' + qx.locale.Manager.tr('The following changes have been made') + '</div>' +\n                  '<ul><li>'+changes.join('</li><li>')+ '</li></ul>' +\n                  '<div>' + qx.locale.Manager.tr('You can check the changes in the editor. The left side shows the content before the upgrade and the right side shows the content after the upgrade.') + '</div>'\n                  : '<div><strong>' + qx.locale.Manager.tr('No changes have been made') + '</strong></div>';\n\n                let msg = '<h3>' + qx.locale.Manager.tr('Config file has been upgraded to the current library version.').translate().toString() + '</h3>' + changesText +\n                  '<div>' + qx.locale.Manager.tr('Click \"Apply\" if you want to save the changes and reload the browser.') + '</div>' +\n                  '<div>' + qx.locale.Manager.tr('Click \"Check\" if you want to check the changes. You have to save the changes and reload your browser yourself in this case.') + '</div>';\n                const d = qxl.dialog.Dialog.confirm(msg, function (ok) {\n                  if (ok) {\n                    this.save(function () {\n                      // remove #manager to avoid reloading into manager\n                      window.location.hash = '';\n                      window.location.reload();\n                    });\n                  }\n                }, this, qx.locale.Manager.tr('Upgrade successful'));\n                d.set({\n                  width: Math.min(qx.bom.Viewport.getWidth(), 600),\n                  yesButtonLabel: qx.locale.Manager.tr('Apply'),\n                  noButtonLabel: qx.locale.Manager.tr('Check')\n                });\n                file.setModified(true);\n              }\n            }\n          }, this);\n        } else if (file && file instanceof cv.ui.manager.model.CompareFiles && this.isSupported(file.getModifiedFile())) {\n          this.resetEditable();\n          this._client.readSync({path: file.getModifiedFile().getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setModifiedContent(res);\n            }\n          }, this);\n\n          this._client.readSync({path: file.getOriginalFile().getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setOriginalContent(res);\n            }\n          }, this);\n        } else {\n          this.resetOriginalContent();\n          this.resetModifiedContent();\n        }\n      }\n    }\n  }\n});\n","/* Config.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Editor for the (hidden) configuration.\n */\nqx.Class.define('cv.ui.manager.editor.Config', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._handledActions = ['save'];\n    this._setLayout(new qx.ui.layout.VBox(8));\n    this._createChildControl('list');\n    this._createChildControl('add-section');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: qx.locale.Manager.tr('Hidden configuration')\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _model: null,\n    _listController: null,\n    __initialSectionCount: 0,\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getConfigClient();\n      this._client.addListener('getSuccess', this._onModelValueChange, this);\n      this._client.addListener('updateSuccess', this._onSaved, this);\n    },\n\n    _loadFile: function (file) {\n      if (file) {\n        this._client.get({section: '*', key: '*'});\n      }\n    },\n\n    _onModelValueChange: function (ev) {\n      if (this.getFile()) {\n        this.setContent(ev.getData());\n      }\n    },\n\n    // overridden\n    _applyContent: function(value) {\n      const model = this._listController.getModel();\n      model.removeAll();\n\n      this.__initialSectionCount = Object.keys(value).length;\n\n      Object.keys(value).forEach(function (sectionName) {\n        const section = new cv.ui.manager.model.config.Section(sectionName);\n        Object.keys(value[sectionName]).forEach(function (optionKey) {\n          section.addOption(optionKey, value[sectionName][optionKey]);\n        }, this);\n        model.push(section);\n      }, this);\n\n      this.__checkForModification();\n    },\n\n    // overridden\n    getCurrentContent: function () {\n      return this.getContent();\n    },\n\n    _onDeleteSection: function (ev) {\n      if (this.getFile() && this.getFile().isWriteable()) {\n        const section = ev.getData();\n        const model = this._listController.getModel();\n        model.remove(section);\n        this.__checkForModification();\n      }\n    },\n\n    // compare current controller model with the loaded config content\n    __checkForModification: function () {\n      const file = this.getFile();\n      if (this.__initialSectionCount !== this._listController.getModel().length) {\n        file.setModified(true);\n        return;\n      }\n      const modified = this.getChildControl('list').getChildren().some(function (sectionListItem) {\n        return sectionListItem.isModified();\n      }, this);\n      file.setModified(modified);\n    },\n\n    save: function () {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        cv.ui.manager.snackbar.Controller.info(this.tr('Hidden configuration file (hidden.php) not writeable'));\n        return;\n      }\n      // check for duplicate section names of keys\n      const model = this._listController.getModel();\n      const keys = [];\n      let valid = true;\n      model.forEach(function (section) {\n        const key = section.getName();\n        if (!keys.includes(key)) {\n          keys.push(key);\n        } else {\n          valid = false;\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section name duplicate: \"%1\".', key));\n        }\n        // check for key duplicates in this sections options\n        const optionKeys = [];\n        section.getOptions().forEach(function (option) {\n          const optionKey = option.getKey();\n          if (!optionKeys.includes(optionKey)) {\n            optionKeys.push(optionKey);\n          } else {\n            valid = false;\n            cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Option key duplicate: \"%1\" in section \"%2\".', optionKey, key));\n          }\n        }, this);\n      }, this);\n\n      if (valid) {\n        const data = {};\n        this._listController.getModel().forEach(function (section) {\n          const options = {};\n          section.getOptions().forEach(function (option) {\n            options[option.getKey()] = option.getValue();\n          });\n          data[section.getName()] = options;\n        }, this);\n        this._client.saveSync(null, data, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(this.tr('Saving hidden config failed with error %1 (%2)', err.status, err.statusText));\n          } else {\n            cv.ui.manager.snackbar.Controller.info(this.tr('Hidden config has been saved'));\n            this._onSaved();\n          }\n        }, this);\n      } else {\n        cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section is invalid and has not been saved.'));\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(new qx.data.Array(), control);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.SectionListItem();\n             },\n\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteSection, this);\n               item.addListener('changeModified', this.__checkForModification, this);\n             }.bind(this),\n\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               this.bind('file.writeable', item, 'readOnly', {\n                 converter: function (value) {\n                   return !value;\n                 }\n               });\n             }.bind(this)\n           });\n           this._add(control, {flex: 1});\n           break;\n\n         case 'buttons':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox(8));\n           this._add(control);\n           break;\n\n         case 'add-section':\n           control = new qx.ui.form.Button(this.tr('Add section'));\n           control.addListener('execute', function () {\n             this._listController.getModel().push(new cv.ui.manager.model.config.Section(''));\n             this.__checkForModification();\n           }, this);\n           this.bind('file.writeable', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'excluded';\n             }\n           });\n           this.getChildControl('buttons').add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_model', '_listController');\n  }\n});\n","/* Worker.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.editor.Worker', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._files = {};\n    // create WebWorker\n    this._worker = cv.data.FileWorker.getInstance();\n    this._worker.addListener('message', this._onMessage, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    editor: {\n      check: 'cv.ui.manager.editor.AbstractEditor',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _worker: null,\n    _files: null,\n\n    open: function (file, code, schema, features) {\n      this._worker.postMessage(['openFile', {\n        path: file.getFullPath(),\n        code: qx.xml.Document.isXmlDocument(code) ? code.documentElement.outerHTML : code,\n        schema: schema\n      }, features]);\n      this._files[file.getFullPath()] = file;\n    },\n\n    close: function (file) {\n      this._worker.postMessage(['closeFile', {\n        path: file.getFullPath()\n      }]);\n      delete this._files[file.getFullPath()];\n    },\n\n    contentChanged: function (file, content) {\n      this._worker.postMessage(['contentChange', {\n        path: file.getFullPath(),\n        code: content\n      }]);\n    },\n\n    validateConfig: function (file) {\n      if (file.isConfigFile()) {\n        return this._worker.validateConfig(file.getServerPath());\n      }\n      qx.log.Logger.error(this, file.getFullPath() + ' is no configuration file');\n      return true;\n    },\n\n    validateXmlConfig: function (content) {\n      return this._worker.validateXmlConfig(content);\n    },\n\n    _onMessage: function (e) {\n      let topic = e.getData().topic;\n      let data = e.getData().data;\n      let path = e.getData().path;\n      let file = this._files[path];\n      if (!file && topic !== 'validationResult') {\n        qx.log.Logger.error(this, 'no file found for path ' + path + ' ignoring worker message for topic ' + topic);\n        return;\n      }\n      let editor = this.getEditor();\n      switch (topic) {\n        case 'modified':\n          // new files are always modified, to not override that state\n          if (!file.isTemporary()) {\n            file.setModified(data.modified);\n          }\n          file.setHash(data.currentHash);\n          break;\n\n        case 'hash':\n          file.setHash(data);\n          break;\n\n        case 'errors':\n          file.setValid(!data || data.length === 0);\n          if (editor) {\n            editor.showErrors(path, data);\n          }\n          break;\n\n        case 'decorations':\n          if (editor) {\n            editor.showDecorations(path, data);\n          }\n          break;\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._worker.terminate();\n    this._worker = null;\n  }\n});\n","/* FileListItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A qx.ui.form.ListItem with an additional label overlay over the icon to show the file type\n */\nqx.Class.define('cv.ui.manager.form.FileListItem', {\n  extend: qx.ui.core.Widget,\n  implement : [qx.ui.form.IModel],\n  include: [cv.ui.manager.upload.MDragUpload],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label, icon, model) {\n    this.base(arguments, label, icon);\n    const layout = new qx.ui.layout.Canvas();\n    layout.setDesktop(true);\n    this._setLayout(layout);\n\n    if (model) {\n      this.setModel(model);\n    }\n    this.addListener('pointerover', this._onPointerOver, this);\n    this.addListener('pointerout', this._onPointerOut, this);\n\n    cv.ui.manager.model.Preferences.getInstance().addListener('changeDefaultConfigEditor', this._maintainFileActions, this);\n\n    this.setUploadHint(this.tr('Drop the file here to replace the content.'));\n  },\n\n  /*\n  *****************************************************************************\n     EVENTS\n  *****************************************************************************\n  */\n  events: {\n    /** (Fired by {@link qx.ui.form.List}) */\n    'action' : 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-file-item'\n    },\n\n    model: {\n      nullable: true,\n      event: 'changeModel',\n      apply: '_applyModel',\n      dereference: true,\n      check: 'cv.ui.manager.model.FileItem'\n    },\n\n    /**\n     * Show the action buttons.\n     */\n    showFileActions: {\n      check: 'Boolean',\n      init: false,\n      apply: '_maintainFileActions'\n    },\n\n    /** The label/caption/text of the qx.ui.basic.Atom instance */\n    label: {\n      nullable: true,\n      check: 'String',\n      event: 'changeLabel'\n    },\n\n    /** Any URI String supported by qx.ui.basic.Image to display an icon */\n    icon: {\n      check: 'String',\n      nullable: true,\n      themeable: true,\n      event: 'changeIcon'\n    },\n\n    /**\n     * The space between the icon and the label\n     */\n    gap: {\n      check : 'Integer',\n      nullable : false,\n      event : 'changeGap',\n      themeable : true,\n      init : 4\n    },\n\n\n    /**\n     * Configure the visibility of the sub elements/widgets.\n     * Possible values: both, label, icon\n     */\n    show: {\n      init : 'both',\n      check : [ 'both', 'label', 'icon' ],\n      themeable : true,\n      inheritable : true,\n      event : 'changeShow'\n    },\n\n\n    /**\n     * The position of the icon in relation to the text.\n     * Only useful/needed if text and icon is configured and 'show' is configured as 'both' (default)\n     */\n    iconPosition: {\n      init   : 'left',\n      check : ['top', 'right', 'bottom', 'left', 'top-left', 'bottom-left', 'top-right', 'bottom-right'],\n      themeable : true,\n      event: 'changeIconPosition'\n    },\n\n\n    /**\n     * Whether the content should be rendered centrally when to much space\n     * is available. Enabling this property centers in both axis. The behavior\n     * when disabled of the centering depends on the {@link #iconPosition} property.\n     * If the icon position is <code>left</code> or <code>right</code>, the X axis\n     * is not centered, only the Y axis. If the icon position is <code>top</code>\n     * or <code>bottom</code>, the Y axis is not centered. In case of e.g. an\n     * icon position of <code>top-left</code> no axis is centered.\n     */\n    center : {\n      init : false,\n      check : 'Boolean',\n      themeable : true,\n      event: 'changeCenter'\n    },\n\n    /**\n     * Restrict possible file uploads (not supported by every browxer)\n     */\n    acceptUpload: {\n      init: null,\n      nullable: true,\n      check: 'String'\n    },\n\n    viewMode: {\n      check: ['list', 'preview'],\n      init: 'preview',\n      apply: '_applyViewMode'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    _uploadManager: null,\n\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates: {\n      focused : true,\n      selected : true,\n      dragover : true,\n      hovered: true\n    },\n\n    _applyViewMode: function () {\n      switch (this.getViewMode()) {\n        case 'list':\n          this.addState('list');\n          this.getChildControl('atom').setLayoutProperties({left: 10, top: 0, bottom: 0, right: null});\n          this.getChildControl('bottom-bar').setLayoutProperties({top: 0, bottom: 0, right: 0, left: null});\n          break;\n\n        case 'preview':\n          this.removeState('list');\n          this.getChildControl('atom').setLayoutProperties({left: 0, top: 0, bottom: 34, right: 0});\n          this.getChildControl('bottom-bar').setLayoutProperties({left: 0, bottom: 0, right: 0, top: null});\n          break;\n      }\n    },\n\n    /**\n     * Event handler for the pointer over event.\n     */\n    _onPointerOver : function() {\n      this.addState('hovered');\n    },\n\n\n    /**\n     * Event handler for the pointer out event.\n     */\n    _onPointerOut : function() {\n      this.removeState('hovered');\n    },\n\n    _isDroppable: function (files) {\n      if (files.length === 1) {\n        if (this.getModel().getSpecial() === 'add-file') {\n          return true;\n        }\n        const myMime = cv.ui.manager.tree.FileSystem.getMimetypeFromSuffix(this.getModel().getName().split('.').pop());\n        return myMime === files[0].type;\n      }\n      return false;\n    },\n\n    _onDrop: function (ev) {\n      ev.preventDefault();\n      if (this.getModel().getSpecial() === 'add-file') {\n        cv.ui.manager.upload.MDragUpload.uploadFile(cv.ui.manager.upload.MDragUpload.getFiles(ev)[0]);\n      } else {\n        qxl.dialog.Dialog.confirm(this.tr('Do you really want to replace the \\'%1\\' with the uploaded files content?', this.getModel().getName()), function (confirmed) {\n          if (confirmed) {\n            const newFile = cv.ui.manager.upload.MDragUpload.getFiles(ev)[0];\n            cv.ui.manager.upload.MDragUpload.uploadFile(newFile, this.getModel());\n          }\n        }, this);\n      }\n      this._onStopDragging(ev);\n    },\n\n    _applyModel: function (value) {\n      if (value && value.getType() === 'file') {\n        const control = this.getChildControl('file-type');\n        if (!value.isFake()) {\n          const name = value.getName();\n          this.getChildControl('atom').setToolTipText(this.tr('Double click to open \"%1\"', name));\n          let type = name.split('.').pop();\n\n          // do not use file types that are longer than 4 chars (not enough space)\n          if (type.length <= 4) {\n            let handled = false;\n            switch (type) {\n              case 'xml':\n                control.setValue('</>');\n                handled = true;\n                break;\n\n              case 'js':\n                type = qx.lang.String.firstUp(type); // jshint ignore:line\n              // eslint-disable-next-line no-fallthrough\n              case 'css':\n              case 'conf':\n                control.setValue(type);\n                handled = true;\n                break;\n            }\n            if (handled && this.getViewMode() === 'preview') {\n              control.show();\n            } else {\n              control.exclude();\n            }\n          } else {\n            control.exclude();\n          }\n        }\n      } else {\n        this.getChildControl('file-type').exclude();\n        this.getChildControl('atom').resetToolTipText();\n      }\n      // this.getChildControl('bottom-bar').show();\n      // this.setUploadHint(this.tr('Drop the file here to replace the content.'));\n      // this.getChildControl('atom').setToolTipText(this.tr('Double click to open'));\n      this._maintainFileActions();\n      // if (this._uploadManager) {\n      //   try {\n      //     this._uploadManager.removeWidget(this);\n      //   } catch (e) {}\n      // }\n    },\n\n    _onOpenWith: function (ev) {\n      const handlerId = ev.getTarget().getUserData('handlerId');\n      qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n        file: this.getModel(),\n        handler: handlerId\n      });\n    },\n\n    _applyIcon: function (value, old) {\n      this.base(arguments, value, old);\n      if (value && !value.startsWith('@')) {\n        const control = this.getChildControl('atom').getChildControl('icon');\n        if (!cv.ui.manager.viewer.Image.getImageData(value)) {\n          // wait for image to be loaded\n          control.addListenerOnce('loaded', this.__scaleWithAspect, this);\n        } else {\n          this.__scaleWithAspect();\n        }\n      }\n    },\n\n    _maintainFileActions: function () {\n      const file = this.getModel();\n      if (this.isShowFileActions() && file) {\n        this.getChildControl('download-button').setVisibility(file.getType() === 'dir' || file.isFake() ? 'excluded' : 'visible');\n        this.getChildControl('action-button').setVisibility(file.isFake() ? 'excluded' : 'visible');\n        const editorConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, 'edit');\n        const viewerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, 'view');\n        const openButton = this.getChildControl('open-button');\n        const editButton = this.getChildControl('edit-button');\n        if (file.isWriteable() && editorConf) {\n          editButton.setUserData('handlerId', editorConf.Clazz.classname);\n          editButton.set({\n            icon: editorConf.Clazz.ICON || cv.theme.dark.Images.getIcon('edit', 18),\n            enabled: true,\n            toolTipText: editorConf.Clazz.TITLE ? editorConf.Clazz.TITLE.translate().toString() : ''\n          });\n          editButton.show();\n        } else {\n          editButton.exclude();\n        }\n        if (viewerConf) {\n          openButton.setUserData('handlerId', viewerConf.Clazz.classname);\n          openButton.set({\n            icon: viewerConf.Clazz.ICON || cv.theme.dark.Images.getIcon('preview', 18),\n            enabled: true,\n            toolTipText: viewerConf.Clazz.TITLE ? viewerConf.Clazz.TITLE.translate().toString() : ''\n          });\n          openButton.show();\n        } else {\n          openButton.exclude();\n        }\n        this.getChildControl('action-button');\n        this.getChildControl('bottom-bar').show();\n      } else {\n        this.getChildControl('bottom-bar').exclude();\n      }\n    },\n\n    __scaleWithAspect: function () {\n      const data = cv.ui.manager.viewer.Image.getImageData(this.getIcon());\n      const control = this.getChildControl('atom').getChildControl('icon');\n      const sizeHint = control.getSizeHint();\n      let width = sizeHint.width;\n      let height = Math.round(1 / data.aspectRatio * width);\n      const padding = [0, 0, 0, 0];\n      if (height > sizeHint.height) {\n        height = sizeHint.height;\n        width = Math.round(data.aspectRatio * height);\n        padding[1] = Math.round((sizeHint.width - width) / 2);\n        padding[3] = padding[1];\n      } else {\n        padding[0] = Math.round((sizeHint.height - height) / 2);\n        padding[2] = padding[0];\n      }\n      control.setPadding(padding);\n    },\n\n    _maintainFileTypePosition: function () {\n      const iconBounds = this.getChildControl('atom').getChildControl('icon').getBounds();\n      const top = Math.round(iconBounds.top + iconBounds.height / 2);\n      this.getChildControl('file-type').setLayoutProperties({\n        left: iconBounds.left,\n        top: top,\n        right: iconBounds.left + iconBounds.width,\n        bottom: top + 18\n      });\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n        case 'atom':\n          control = new qx.ui.basic.Atom();\n          ['label', 'icon', 'gap', 'iconPosition', 'show', 'center'].forEach(function (prop) {\n            this.bind(prop, control, prop);\n          }, this);\n          control.setAnonymous(true);\n          this._add(control, {top: 0, left: 0, right: 0, bottom: 34});\n          break;\n\n        case 'file-type': {\n          control = new qx.ui.basic.Label();\n          control.set({\n            zIndex: 100,\n            anonymous: true,\n            font: 'title',\n            textAlign: 'center',\n            textColor: 'background-main',\n            minWidth: 70\n          });\n          const icon = this.getChildControl('atom').getChildControl('icon');\n          icon.bind('visibility', control, 'visibility');\n          icon.addListener('resize', this._maintainFileTypePosition, this);\n          this._add(control, {width: '100%'});\n          break;\n        }\n\n        case 'bottom-bar':\n          control = new qx.ui.container.Composite(new qx.ui.layout.HBox(4, 'center'));\n          control.setAnonymous(true);\n          this._add(control, {left: 0, bottom: 0, right: 0});\n          break;\n\n        case 'download-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('download', 18));\n          control.setToolTipText(this.tr('Download file'));\n          control.addListener('execute', function () {\n            cv.ui.manager.control.FileController.getInstance().download(this.getModel());\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n\n        case 'action-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('menu', 18));\n          control.setToolTipText(this.tr('Other file actions'));\n          this.getChildControl('bottom-bar').add(control);\n          control.addListener('tap', function (ev) {\n            this.fireEvent('action', qx.event.type.Tap, [ev.getNativeEvent(), this, ev.getTarget(), false, true]);\n          }, this);\n          break;\n\n        case 'open-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('preview', 18));\n          control.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n              file: this.getModel(),\n              handler: control.getUserData('handlerId')\n            });\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n\n        case 'edit-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('preview', 18));\n          control.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n              file: this.getModel(),\n              handler: control.getUserData('handlerId')\n            });\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n      }\n      if (!control) {\n        control = this._createMDragUploadChildControlImpl(id);\n      }\n\n      return control || this.base(arguments, id);\n    },\n\n    // overridden\n    capture: function () {\n      // do not fire capture method for upload-items (see: com.zenesis.qx.upload.MUploadButton)\n      if (!this.getFile() || this.getFile().getSpecial() !== 'add-file') {\n        this.base(arguments);\n      }\n    },\n\n    // overridden\n    releaseCapture: function() {\n      // do not fire capture method for upload-items (see: com.zenesis.qx.upload.MUploadButton)\n      if (!this.getFile() || this.getFile().getSpecial() !== 'add-file') {\n        this.base(arguments);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.removeListener('pointerover', this._onPointerOver, this);\n    this.removeListener('pointerout', this._onPointerOut, this);\n\n    this._disposeObjects('_uploadManager');\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeDefaultConfigEditor', this._maintainFileActions, this);\n  }\n});\n","/* ToolBar.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.ToolBar', {\n  extend: qx.ui.toolbar.ToolBar,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (uploadManager, showOnly) {\n    this.base(arguments);\n\n    if (showOnly) {\n      this.__showOnly = showOnly;\n    }\n\n    this._menuBar = cv.ui.manager.MenuBar.getInstance();\n    this._menuButtonConfig = this._menuBar.getButtonConfiguration();\n    this._uploadManager = uploadManager;\n\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'reload': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-toolbar'\n    },\n\n    folder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFolder',\n      event: 'changeFolder'\n    },\n\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFile',\n      event: 'changeFile'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _menuButtonConfig: null,\n    _uploadManager: null,\n    _menuBar: null,\n    __showOnly: null,\n\n    __show: function (name) {\n      return this.__showOnly === null || this.__showOnly.includes(name);\n    },\n\n    _init: function () {\n      if (!this._uploadManager) {\n        this._uploadManager = new cv.ui.manager.upload.UploadMgr();\n      }\n\n      const fileController = cv.ui.manager.control.FileController.getInstance();\n\n      const createPart = new qx.ui.toolbar.Part();\n      createPart.set({\n        marginLeft: 0\n      });\n      this.add(createPart);\n      let newButton;\n\n      if (this.__show('new-menu')) {\n        newButton = new qx.ui.toolbar.MenuButton(null,\n          cv.theme.dark.Images.getIcon('new-file', 15),\n          this._menuBar.getChildControl('new-menu')\n        );\n        this.bind('folder.writeable', newButton, 'enabled');\n        createPart.add(newButton);\n      } else {\n        if (this.__show('new-config-file')) {\n          newButton = this._createButton('new-config-file', cv.theme.dark.Images.getIcon('new-file', 15));\n          this.bind('folder.writeable', newButton, 'enabled');\n          this.bind('folder', newButton, 'visibility', {\n            converter: function (folder) {\n              return folder === cv.ui.manager.model.FileItem.ROOT ? 'visible' : 'excluded';\n            }\n          });\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-config-file', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        } else if (this.__show('new-file')) {\n          newButton = this._createButton('new-file', null, true);\n          this.bind('folder.writeable', newButton, 'enabled');\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-file', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        }\n        if (this.__show('new-folder')) {\n          newButton = this._createButton('new-folder', cv.theme.dark.Images.getIcon('new-folder', 15), true);\n          this.bind('folder.writeable', newButton, 'enabled');\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-folder', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        }\n      }\n\n      if (this.__show('upload')) {\n        const upload = this._createButton('upload');\n        this._uploadManager.addWidget(upload);\n        this.bind('folder.writeable', upload, 'enabled');\n        createPart.add(upload);\n      }\n\n      if (this.__show('delete')) {\n        const deleteSelection = this._createButton('delete');\n        deleteSelection.addListener('execute', function () {\n          fileController.delete(this.getFile());\n        }, this);\n        this.bind('file', deleteSelection, 'enabled', {\n          converter: function (file) {\n            return !!file && file.isWriteable() && !file.isFake();\n          }\n        });\n        this.add(deleteSelection);\n      }\n\n      if (this.__show('download')) {\n        const download = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('download', 15));\n        download.setAppearance('cv-toolbar-button');\n        download.setToolTipText(qx.locale.Manager.tr('Download'));\n        download.addListener('execute', function () {\n          fileController.download(this.getFile());\n        }, this);\n        // download button is only enabled when a file is selected\n        this.bind('file', download, 'enabled', {\n          converter: function (file) {\n            return !!file && file.getType() === 'file' && !file.isFake();\n          }\n        });\n        createPart.add(download);\n      }\n\n      if (this.__show('validate')) {\n        // config check\n        const checkConfig = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('validate', 15));\n        checkConfig.setAppearance('cv-toolbar-button');\n        checkConfig.setToolTipText(qx.locale.Manager.tr('Validate'));\n        checkConfig.addListener('execute', function () {\n          fileController.validate(this.getFile());\n        }, this);\n\n        // validate button is only enabled when a file is selected\n        this.bind('file', checkConfig, 'enabled', {\n          converter: function (file) {\n            return !!file && file.isConfigFile();\n          }\n        });\n        this.add(checkConfig);\n      }\n\n      if (this.__show('reload')) {\n        const reload = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 15));\n        reload.setAppearance('cv-toolbar-button');\n        reload.setToolTipText(qx.locale.Manager.tr('Reload'));\n        reload.addListener('execute', function () {\n          this.fireEvent('reload');\n        }, this);\n        this.add(new qx.ui.core.Spacer(), {flex: 1});\n        this.add(reload);\n      }\n    },\n\n    _createButton: function (name, icon, doNotUseCommand) {\n      const args = this._menuButtonConfig[name].args;\n      const button = new qx.ui.toolbar.Button(null, icon || args[1].replace(/\\/[0-9]+$/, '/15'), !doNotUseCommand ? args[2] : null);\n      button.setAppearance('cv-toolbar-button');\n      button.setToolTipText(args[0]);\n      return button;\n    },\n\n    _applyFile: function () {\n\n    },\n\n    _applyFolder: function (value) {\n      if (this._uploadManager) {\n        if (value) {\n          this._uploadManager.setFolder(value);\n        } else {\n          this._uploadManager.resetFolder();\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._menuButtonConfig = null;\n    this._uploadManager = null;\n    this.__menuBar = null;\n  }\n});\n","/* IconAtom.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Atom with cv.ui.manager.viewer.SvgIcon instead of a qx.ui.basic.Image\n */\nqx.Class.define('cv.ui.manager.core.IconAtom', {\n  extend: qx.ui.basic.Atom,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label, icon) {\n    this.base(arguments, label, icon);\n    this._fontIconRegex = /^\\<i.*class=\".*(knxuf-|ri-)([^\\s\"]+).*\".*\\<\\/i\\>$/;\n    this.addListener('tap', this._onTap, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-icon'\n    },\n\n    model: {\n      check: 'Array',\n      apply: '_applyModel'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _fontIconRegex: null,\n    _iconChildControlName: null,\n\n    _onTap() {\n      navigator.clipboard.writeText(this.getLabel());\n      cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('Icon name has been copied to clipboard'));\n    },\n\n    // property apply\n    _applyLabel(value, old) {\n      this.base(arguments, value, old);\n      this.setToolTipText(value);\n    },\n\n    _applyModel: function (value) {\n      if (value) {\n        const [name, icon] = value;\n        this.setLabel(name);\n        this.setIcon(icon);\n      } else {\n        this.resetLabel();\n        this.resetIcon();\n      }\n    },\n\n    _applyIcon(value, old) {\n      if (value) {\n        if (this._fontIconRegex.test(value)) {\n          this._iconChildControlName = 'htmlIcon';\n          const icon = this.getChildControl(this._iconChildControlName, true);\n          if (icon) {\n            icon.setValue(value);\n          }\n          this._excludeChildControl('icon');\n        } else {\n          this._iconChildControlName = 'icon';\n          const icon = this.getChildControl(this._iconChildControlName, true);\n          if (icon) {\n            icon.setSource(value);\n          }\n          this._excludeChildControl('htmlIcon');\n        }\n      } else {\n        this._iconChildControlName = 'icon';\n        this._excludeChildControl('htmlIcon');\n      }\n      this._handleIcon();\n    },\n\n    _handleIcon() {\n      if (this.getIcon() === null || this.getShow() === 'label') {\n        this._excludeChildControl(this._iconChildControlName);\n      } else {\n        this._showChildControl(this._iconChildControlName);\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new cv.ui.manager.basic.Image(this.getIcon());\n           control.set({\n             anonymous: true,\n             scale: true,\n             maxHeight: 64\n           });\n           this._addAt(control, 0);\n           if (this.getIcon() === null || this.getShow() === 'label') {\n             control.exclude();\n           }\n           break;\n\n        case 'htmlIcon':\n          control = new qx.ui.basic.Label(this.getIcon());\n          control.set({\n            anonymous: true,\n            rich: true,\n            height: 64,\n            width: 64\n          });\n          this._addAt(control, 0);\n          if (this.getIcon() === null || this.getShow() === 'label') {\n            control.exclude();\n          }\n       }\n\n       return control || this.base(arguments, id);\n    }\n  }\n});\n","/* Config.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * XSD-based code completion provider for the monaco text editor.\n *\n * @since 0.11.0\n * @author Tobias Brutigam\n */\nqx.Class.define('cv.ui.manager.editor.completion.Config', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   *\n   */\n  construct: function () {\n    this.base(arguments);\n    this.__elementCache = {};\n    this.__currentSchemas = {};\n    this._dataProvider = cv.ui.manager.editor.data.Provider.getInstance();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    currentPath: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyCurrentPath'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schemas: null,\n    __currentSchema: null,\n    __elementCache: null,\n    __metaElementCache: null,\n    _dataProvider: null,\n    __rootTagName: null,\n    __metaTagName: null,\n    _getSuggestions: null,\n\n    _applyCurrentPath() {\n      this.__currentSchema = null;\n      this.__rootTagName = '';\n    },\n\n    setStructure(name) {\n      const loaded = Object.prototype.hasOwnProperty.call(this.__currentSchemas, name);\n      switch (name) {\n        case 'pure':\n          if (!loaded) {\n            this.__currentSchemas.pure = cv.ui.manager.model.Schema.getInstance('visu_config.xsd');\n          }\n          this.__currentSchema = this.__currentSchemas.pure;\n          this.__rootTagName = 'pages';\n          this.__metaTagName = 'meta';\n          this._getSuggestions = this.providePureCompletionItems;\n          break;\n\n        case 'tile':\n          if (!loaded) {\n            this.__currentSchemas.tile = cv.ui.manager.model.Schema.getInstance('visu_config_tile.xsd');\n          }\n          this.__currentSchema = this.__currentSchemas.tile;\n          this.__rootTagName = 'config';\n          this.__metaTagName = 'cv-meta';\n          this._getSuggestions = this.provideTileCompletionItems;\n          break;\n      }\n    },\n\n    getLastOpenedTag: function (text) {\n      // get all tags inside of the content\n      const tags = text.match(/<\\/*(?=\\S*)([a-zA-Z-]+)/g);\n      if (!tags) {\n        return null;\n      }\n      // we need to know which tags are closed\n      const closingTags = [];\n      for (let i = tags.length - 1; i >= 0; i--) {\n        if (tags[i].indexOf('</') === 0) {\n          closingTags.push(tags[i].substring('</'.length));\n        } else {\n          // get the last position of the tag\n          const tagPosition = text.lastIndexOf(tags[i]);\n          const tag = tags[i].substring('<'.length);\n          const closingBracketIdx = text.indexOf('/>', tagPosition);\n          // if the tag wasn't closed\n          if (closingBracketIdx === -1) {\n            // if there are no closing tags or the current tag wasn't closed\n            if (!closingTags.length || closingTags[closingTags.length - 1] !== tag) {\n              // we found our tag, but let's get the information if we are looking for\n              // a child element or an attribute\n              text = text.substring(tagPosition);\n\n              const openedTag = text.indexOf('<') > text.indexOf('>');\n              let contentSearch = false;\n              let currentAttribute = null;\n              if (openedTag) {\n                const attrMatch = /([\\w\\-_\\.\\d]+)=\"[^\"]*$/.exec(text);\n                contentSearch = !!attrMatch;\n                currentAttribute = attrMatch ? attrMatch[1] : null;\n              }\n              const filteredElementSearch = /<[\\w-_\\d]+$/.test(text);\n              return {\n                tagName: tag,\n                currentAttribute: currentAttribute,\n                filteredElementSearch: filteredElementSearch,\n                isAttributeSearch: !filteredElementSearch && openedTag && !contentSearch,\n                isContentSearch: contentSearch,\n                text: text\n              };\n            }\n            // remove the last closed tag\n            closingTags.splice(closingTags.length - 1, 1);\n          }\n          // remove the last checked tag and continue processing the rest of the content\n          text = text.substring(0, tagPosition);\n        }\n      }\n      return null;\n    },\n\n    findElements: function (parent, elementName, maxDepth, currentDepth, inMeta) {\n      const cache = inMeta === true ? this.__metaElementCache : this.__elementCache;\n      if (elementName in cache) {\n        return cache[elementName];\n      }\n      if (maxDepth < currentDepth) {\n        return null;\n      }\n      if (!parent) {\n        parent = this.__currentSchema.getElementNode(this.__rootTagName);\n      }\n      if (currentDepth === undefined) {\n        currentDepth = 1;\n      }\n      const allowedElements = parent.getAllowedElements();\n      // console.log(parent.name+\" looking for \"+elementName+\" in tree level \"+currentDepth+ \"(<\"+maxDepth+\") (\"+Object.getOwnPropertyNames(allowedElements).join(\", \")+\")\");\n      if (elementName in allowedElements) {\n        // console.log(\"found \"+elementName+\" in tree level \"+currentDepth);\n        this.__elementCache[elementName] = allowedElements[elementName];\n        return allowedElements[elementName];\n      }\n      for (let element in allowedElements) {\n        if (inMeta !== true && element === this.__metaTagName) {\n          continue;\n        }\n        if (maxDepth > currentDepth) {\n          const result = this.findElements(allowedElements[element], elementName, maxDepth, currentDepth + 1);\n          if (result) {\n            cache[elementName] = result;\n            // console.log(\"found \" + elementName + \" in tree level \" + currentDepth);\n            return result;\n          }\n        }\n      }\n      return null;\n    },\n\n    isItemAvailable: function (itemName, maxOccurs, items) {\n      // the default for 'maxOccurs' is 1\n      maxOccurs = maxOccurs || '1';\n      // the element can appere infinite times, so it is available\n      if (maxOccurs && maxOccurs === 'unbounded') {\n        return true;\n      }\n      // count how many times the element appeared\n      let count = 0;\n      for (let i = 0; i < items.length; i++) {\n        if (items[i] === itemName) {\n          count++;\n        }\n      }\n      // if it didn't appear yet, or it can appear again, then it\n      // is available, otherwise it't not\n      return count === 0 || parseInt(maxOccurs) > count;\n    },\n\n    getElementString: function (element, indent, prefix) {\n      let insertText = indent + prefix + element.getName() + ' ';\n      // add all required attributes with default values\n      const allowedAttributes = element.getAllowedAttributes();\n      Object.getOwnPropertyNames(allowedAttributes).forEach(function(attr) {\n        const attribute = allowedAttributes[attr];\n        if (!attribute.isOptional) {\n          insertText += attr+'=\"'+(attribute.getDefaultValue() ? attribute.getDefaultValue() : '')+'\" ';\n        }\n      });\n      // add mandatory children\n      const requiredElements = element.getRequiredElements();\n      const allowedContent = element.getAllowedContent();\n      const isContentAllowed = allowedContent._text || requiredElements.length > 0 || !!allowedContent._grouping;\n      if (!isContentAllowed) {\n        // close tag\n        insertText = insertText.trim()+'/';\n      } else {\n        // close open tag\n        insertText = insertText.trim()+'>';\n\n        // insert required elements\n        let children = 0;\n        requiredElements.forEach(function(elemName) {\n          const elem = this.findElements(element, elemName, 1, 0);\n          if (elem) {\n            insertText += '\\n    ' + this.getElementString(elem, indent + '    ', '<') + '>';\n            children++;\n          }\n        }, this);\n        // add closing tag\n        if (children > 0) {\n          insertText += '\\n'+indent;\n        }\n        insertText += '</'+element.getName();\n      }\n      return insertText;\n    },\n\n    getAvailableElements: function (element, usedItems) {\n      const availableItems = [];\n      const children = element.getAllowedElements();\n\n      // if there are no such elements, then there are no suggestions\n      if (!children) {\n        return [];\n      }\n      Object.getOwnPropertyNames(children).filter(name => !name.startsWith('#')).forEach(function(name) {\n        // get all element attributes\n        const childElem = children[name];\n        // the element is a suggestion if it's available\n        if (this.isItemAvailable(childElem.getName(), childElem.getBounds().max, usedItems)) {\n          // mark it as a 'field', and get the documentation\n          availableItems.push({\n            label: childElem.getName(),\n            insertText: this.getElementString(childElem, '', ''),\n            kind: window.monaco.languages.CompletionItemKind.Field,\n            detail: childElem.getType(),\n            documentation: childElem.getDocumentation().join('\\n')\n          });\n        }\n      }, this);\n      // return the suggestions we found\n      return availableItems;\n    },\n\n    getAvailableAttributes: function (element, usedChildTags) {\n      const availableItems = [];\n      // get all attributes for the element\n      const attrs = element.getAllowedAttributes();\n      Object.getOwnPropertyNames(attrs).forEach(function(name) { // jshint ignore:line\n        const attr = attrs[name];\n        // accept it in a suggestion list only the attribute is not used yet\n        if (usedChildTags.indexOf(attr.name) === -1) {\n          // mark it as a 'property', and get it's documentation\n          availableItems.push({\n            label: attr.getName(),\n            insertText: attr.getName()+'=\"\"',\n            kind: window.monaco.languages.CompletionItemKind.Property,\n            detail: attr.getTypeString(),\n            documentation: attr.getDocumentation().join('\\n')\n          });\n        }\n      }, this);\n\n      // return the elements we found\n      return availableItems;\n    },\n\n    detectSchema(completeText) {\n      const match = /:noNamespaceSchemaLocation=\"([^\"]+)\"/.exec(completeText.substring(0, 200));\n      if (match && match[1].endsWith('visu_config_tile.xsd')) {\n        this.setStructure('tile');\n      } else {\n        this.setStructure('pure');\n      }\n    },\n\n    getProvider: function () {\n      return {\n        triggerCharacters: ['<', '\"'],\n        provideCompletionItems: function (model, position) {\n          this.setCurrentPath(model.uri.toString());\n          const completeText = model.getValue();\n          if (!this.__currentSchema) {\n            this.detectSchema(completeText);\n          }\n          if (this._getSuggestions) {\n            return this._getSuggestions(model, position);\n          }\n          return {suggestions: []};\n        }.bind(this)\n      };\n    },\n\n    providePureCompletionItems(model, position) {\n      // get editor content before the pointer\n      const textUntilPosition = model.getValueInRange({\n        startLineNumber: 1,\n        startColumn: 1,\n        endLineNumber: position.lineNumber,\n        endColumn: position.column\n      });\n      // parse mappings\n      const completeText = model.getValue();\n      const metaEndPos = completeText.indexOf('</meta>');\n      const textMeta = metaEndPos > 0 ? completeText.substring(0, metaEndPos) : completeText;\n      const mappingNames = [];\n      const stylingNames = [];\n      const templates = {};\n      let map;\n      let vmap;\n      let regex = /<mapping name=\"([^\"]+)\"/gm;\n      while ((map = regex.exec(textMeta)) !== null) {\n        mappingNames.push(map[1]);\n      }\n      regex = /<styling name=\"([^\"]+)\"/gm;\n      while ((map = regex.exec(textMeta)) !== null) {\n        stylingNames.push(map[1]);\n      }\n      const templatesStart = textMeta.indexOf('<templates>');\n      if (templatesStart >= 0) {\n        const templatesString = textMeta.substring(templatesStart + 11, textMeta.indexOf('</templates>') - 12).replace(/(?:\\r\\n|\\r|\\n)/g, '');\n        templatesString.split('</template>').forEach(function (rawTemplate) {\n          const nameMatch = /<template name=\"([^\"]+)\"/.exec(rawTemplate);\n          // search for variables\n          const variables = [];\n          const vregex = /{{{?\\s*([\\w\\d]+)\\s*}?}}/gm;\n          while ((vmap = vregex.exec(rawTemplate)) !== null) {\n            variables.push(vmap[1]);\n          }\n          templates[nameMatch[1]] = variables;\n        }, this);\n      }\n\n      // if we want suggestions, inside of which tag are we?\n      const lastOpenedTag = this.getLastOpenedTag(textUntilPosition);\n      // console.log(lastOpenedTag);\n      // get opened tags to see what tag we should look for in the XSD schema\n      const openedTags = [];\n      // attrobutes of the ancestors\n      const openedAttributes = [];\n      // get the elements/attributes that are already mentioned in the element we're in\n      const usedItems = [];\n      const isAttributeSearch = lastOpenedTag && lastOpenedTag.isAttributeSearch;\n      const isContentSearch = lastOpenedTag && lastOpenedTag.isContentSearch;\n      const filteredElementSearch = lastOpenedTag && lastOpenedTag.filteredElementSearch;\n      // no need to calculate the position in the XSD schema if we are in the root element\n      let parts;\n      if (lastOpenedTag) {\n        // try to create a valid XML document\n        parts = lastOpenedTag.text.split(' ');\n        parts.shift();\n        let cleanedText = textUntilPosition;\n        if (parts.length) {\n          cleanedText = cleanedText.substring(0, cleanedText.length-parts.join(' ').length)+'>';\n        }\n        // parse the content (not cleared text) into an xml document\n        const xmlDoc = qx.xml.Document.fromString(cleanedText);\n        let lastChild = xmlDoc.lastElementChild;\n        let i;\n        let lastFound = false;\n        while (lastChild && lastChild.tagName.toLowerCase() !== 'parsererror') {\n          openedTags.push(lastChild.tagName);\n          openedAttributes.push(lastChild.attributes);\n          // if we found our last opened tag\n          if (lastChild.tagName === lastOpenedTag.tagName) {\n            lastFound = true;\n            // if we are looking for attributes, then used items should\n            // be the attributes we already used\n            if (lastOpenedTag.isAttributeSearch && lastChild.outerHTML === lastOpenedTag.text) {\n              const attrs = lastChild.attributes;\n              for (i = 0; i < attrs.length; i++) {\n                usedItems.push(attrs[i].nodeName);\n              }\n            } else {\n              // if we are looking for child elements, then used items\n              // should be the elements that were already used\n              const children = lastChild.children;\n              for (i = 0; i < children.length; i++) {\n                if (children[i].tagName.toLowerCase() !== 'parsererror') {\n                  usedItems.push(children[i].tagName);\n                }\n              }\n            }\n            break;\n          }\n          // we haven't found the last opened tag yet, so we move to\n          // the next element\n          lastChild = lastChild.lastElementChild;\n        }\n        if (!lastFound) {\n          // fallback -> parse string\n          if (isAttributeSearch || isContentSearch) {\n            parts = lastOpenedTag.text.split(' ');\n            // skip tag name\n            parts.shift();\n            parts.forEach(function(entry) {\n              usedItems.push(entry.split('=').shift());\n            });\n          }\n        }\n      }\n      let res = [];\n      let match;\n      // find the last opened tag in the schema to see what elements/attributes it can have\n      let searchedElement = openedTags[openedTags.length - 1];\n      if (isContentSearch) {\n        // handle data providers if the is one relevant\n        if (lastOpenedTag.tagName === 'pages' && lastOpenedTag.currentAttribute === 'design') {\n          return this._dataProvider.getDesigns().then(function (sugg) {\n            return {suggestions: sugg};\n          });\n        } else if (lastOpenedTag.tagName === 'address' && lastOpenedTag.currentAttribute === 'transform') {\n          return {suggestions: this._dataProvider.getTransforms()};\n        } else if (lastOpenedTag.tagName === 'plugin' && lastOpenedTag.currentAttribute === 'name') {\n          return {suggestions: this._dataProvider.getPlugins()};\n        } else if (lastOpenedTag.tagName === 'icon' && lastOpenedTag.currentAttribute === 'name') {\n          return {suggestions: this._dataProvider.getIcons('monaco', {cache: false}, completeText)};\n        } else if (lastOpenedTag.tagName === 'influx') {\n          if (lastOpenedTag.currentAttribute === 'measurement') {\n            return this._dataProvider.getInfluxDBs().then(function (suggestions) {\n              return {suggestions: suggestions};\n            });\n          } else if (lastOpenedTag.currentAttribute === 'field') {\n            match = /measurement=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n            if (match) {\n              return this._dataProvider.getInfluxDBFields(match[1]).then(function (suggestions) {\n                return {suggestions: suggestions};\n              });\n            }\n          }\n        } else if (lastOpenedTag.tagName === 'tag' && (lastOpenedTag.currentAttribute === 'key' || lastOpenedTag.currentAttribute === 'value') && openedTags.includes('influx')) {\n          const influxAttributes = openedAttributes[openedTags.indexOf('influx')];\n          const attr = influxAttributes.getNamedItem('measurement');\n          if (attr) {\n            if (lastOpenedTag.currentAttribute === 'key') {\n              return this._dataProvider.getInfluxDBTags(attr.value).then(function (suggestions) {\n                return {suggestions: suggestions};\n              });\n            } else if (lastOpenedTag.currentAttribute === 'value') {\n              match = /key=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n              if (match) {\n                return this._dataProvider.getInfluxDBValues(attr.value, match[1]).then(function (suggestions) {\n                  return {suggestions: suggestions};\n                });\n              }\n            }\n          }\n        } else if (lastOpenedTag.tagName === 'template' && lastOpenedTag.currentAttribute === 'name' && openedTags.includes('meta')) {\n          res = Object.keys(templates).map(function (name) {\n            return {\n              label: name,\n              insertText: name,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          }, this);\n          return {suggestions: res};\n        } else if (lastOpenedTag.tagName === 'value' &&\n          lastOpenedTag.currentAttribute === 'name' &&\n          !openedTags.includes('meta') &&\n          openedTags.includes('template')) {\n          // TODO: find out template name\n          const templateNames = Object.keys(templates);\n          templateNames.forEach(function (name) {\n            templates[name].forEach(function (variableName) {\n              res.push({\n                label: variableName,\n                insertText: variableName,\n                detail: qx.locale.Manager.tr('Variable from template %1', name),\n                kind: window.monaco.languages.CompletionItemKind.Variable\n              });\n            }, this);\n          }, this);\n          return {suggestions: res};\n        } else if (lastOpenedTag.currentAttribute === 'mapping') {\n          res = mappingNames.map(function (mappingName) {\n            return {\n              label: mappingName,\n              insertText: mappingName,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          }, this);\n          return {suggestions: res};\n        } else if (lastOpenedTag.currentAttribute === 'styling') {\n          res = stylingNames.map(function (stylingName) {\n            return {\n              label: stylingName,\n              insertText: stylingName,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          }, this);\n          return {suggestions: res};\n        }\n\n        // TODO: completions that have to be retrieved from the backend\n        // * rrds\n        // * Influx: dbs, tags fields\n        // * media files\n\n        searchedElement = lastOpenedTag.tagName;\n      } else if (!isAttributeSearch && filteredElementSearch) {\n        searchedElement = openedTags[openedTags.length-2];\n      } else if (lastOpenedTag.tagName === 'address' && lastOpenedTag.currentAttribute === null) {\n        return this._dataProvider.getAddresses('monaco').then(res => ({suggestions: res}));\n      }\n      if (searchedElement === 'rrd') {\n        return this._dataProvider.getRrds('monaco').then(res => ({suggestions: res}));\n      } else if (searchedElement === 'file' && !isAttributeSearch && !isContentSearch && openedTags.includes('files')) {\n        match = /type=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n        const typeFilter = match ? match[1] : null;\n        return this._dataProvider.getMediaFiles(typeFilter).then(function (suggestions) {\n          return {suggestions: suggestions};\n        });\n      }\n      const currentItem = this.findElements(this.__currentSchema.getElementNode('pages'), searchedElement, openedTags.length, openedTags.includes('meta'));\n\n      // return available elements/attributes if the tag exists in the schema, or an empty\n      // array if it doesn't\n      if (isContentSearch) {\n        const currentAttribute = usedItems[usedItems.length - 1];\n\n        if (currentItem && currentAttribute in currentItem.getAllowedAttributes()) {\n          const attribute = currentItem.getAllowedAttributes()[currentAttribute];\n          const type = attribute.getTypeString();\n          attribute.getEnumeration().forEach(function(entry) {\n            res.push({\n              label: entry,\n              insertText: entry,\n              kind: window.monaco.languages.CompletionItemKind.Value,\n              detail: type,\n              documentation: attribute.getDocumentation().join('\\n')\n            });\n          });\n        }\n      } else if (isAttributeSearch) {\n        // get attributes completions\n        res = currentItem ? this.getAvailableAttributes(currentItem, usedItems) : [];\n      } else {\n        // get elements completions\n        // eslint-disable-next-line no-lonely-if\n        if (lastOpenedTag && lastOpenedTag.text.endsWith('</')) {\n          res.push({\n            label: lastOpenedTag.tagName,\n            insertText: lastOpenedTag.tagName,\n            kind: window.monaco.languages.CompletionItemKind.Field\n          });\n        } else {\n          res = currentItem ? this.getAvailableElements(currentItem, usedItems) : [];\n        }\n      }\n      return {suggestions: res};\n    },\n\n    provideTileCompletionItems(model, position) {\n      // get editor content before the pointer\n      const textUntilPosition = model.getValueInRange({\n        startLineNumber: 1,\n        startColumn: 1,\n        endLineNumber: position.lineNumber,\n        endColumn: position.column\n      });\n      // parse mappings\n      const completeText = model.getValue();\n      const metaEndPos = completeText.indexOf('</cv-meta>');\n      const textMeta = metaEndPos > 0 ? completeText.substring(0, metaEndPos) : completeText;\n      const mappingNames = [];\n      const stylingNames = [];\n      let map;\n      let regex = /<cv-mapping name=\"([^\"]+)\"/gm;\n      while ((map = regex.exec(textMeta)) !== null) {\n        mappingNames.push(map[1]);\n      }\n      regex = /<cv-styling name=\"([^\"]+)\"/gm;\n      while ((map = regex.exec(textMeta)) !== null) {\n        stylingNames.push(map[1]);\n      }\n\n      // if we want suggestions, inside of which tag are we?\n      const lastOpenedTag = this.getLastOpenedTag(textUntilPosition);\n      // console.log(lastOpenedTag);\n      // get opened tags to see what tag we should look for in the XSD schema\n      const openedTags = [];\n      // attrobutes of the ancestors\n      const openedAttributes = [];\n      // get the elements/attributes that are already mentioned in the element we're in\n      const usedItems = [];\n      const isAttributeSearch = lastOpenedTag && lastOpenedTag.isAttributeSearch;\n      const isContentSearch = lastOpenedTag && lastOpenedTag.isContentSearch;\n      const filteredElementSearch = lastOpenedTag && lastOpenedTag.filteredElementSearch;\n      // no need to calculate the position in the XSD schema if we are in the root element\n      let parts;\n      if (lastOpenedTag) {\n        // try to create a valid XML document\n        parts = lastOpenedTag.text.split(' ');\n        parts.shift();\n        let cleanedText = textUntilPosition;\n        if (parts.length) {\n          cleanedText = cleanedText.substring(0, cleanedText.length-parts.join(' ').length)+'>';\n        }\n        // parse the content (not cleared text) into an xml document\n        const xmlDoc = qx.xml.Document.fromString(cleanedText);\n        let lastChild = xmlDoc.lastElementChild;\n        let i;\n        let lastFound = false;\n        while (lastChild) {\n          openedTags.push(lastChild.tagName);\n          openedAttributes.push(lastChild.attributes);\n          // if we found our last opened tag\n          if (lastChild.tagName === lastOpenedTag.tagName) {\n            lastFound = true;\n            // if we are looking for attributes, then used items should\n            // be the attributes we already used\n            if (lastOpenedTag.isAttributeSearch && lastChild.outerHTML === lastOpenedTag.text) {\n              const attrs = lastChild.attributes;\n              for (i = 0; i < attrs.length; i++) {\n                usedItems.push(attrs[i].nodeName);\n              }\n            } else {\n              // if we are looking for child elements, then used items\n              // should be the elements that were already used\n              const children = lastChild.children;\n              for (i = 0; i < children.length; i++) {\n                if (children[i].tagName.toLowerCase() !== 'parsererror') {\n                  usedItems.push(children[i].tagName);\n                }\n              }\n            }\n            break;\n          }\n          // we haven't found the last opened tag yet, so we move to\n          // the next element\n          lastChild = lastChild.lastElementChild;\n        }\n        if (!lastFound) {\n          // fallback -> parse string\n          if (isAttributeSearch || isContentSearch) {\n            parts = lastOpenedTag.text.split(' ');\n            // skip tag name\n            parts.shift();\n            parts.forEach(function(entry) {\n              usedItems.push(entry.split('=').shift());\n            });\n          }\n        }\n      }\n      let res = [];\n      let match;\n      // find the last opened tag in the schema to see what elements/attributes it can have\n      let searchedElement = openedTags[openedTags.length - 1];\n      if (isContentSearch) {\n        // handle data providers if the is one relevant\n        if (lastOpenedTag.tagName === 'config' && lastOpenedTag.currentAttribute === 'design') {\n          const suggestions = this._dataProvider.getDesigns(null, null, 'tile');\n          return {suggestions: suggestions};\n        } else if (lastOpenedTag.tagName === 'cv-address' && lastOpenedTag.currentAttribute === 'transform') {\n          return {suggestions: this._dataProvider.getTransforms()};\n        } else if (lastOpenedTag.tagName === 'cv-icon' && lastOpenedTag.currentAttribute === 'name') {\n          return {suggestions: this._dataProvider.getIcons()};\n        } else if (lastOpenedTag.currentAttribute === 'mapping') {\n          res = mappingNames.map(function (mappingName) {\n            return {\n              label: mappingName,\n              insertText: mappingName,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          }, this);\n          return {suggestions: res};\n        } else if (lastOpenedTag.currentAttribute === 'styling') {\n          res = stylingNames.map(function (stylingName) {\n            return {\n              label: stylingName,\n              insertText: stylingName,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          }, this);\n          return {suggestions: res};\n        }\n        searchedElement = lastOpenedTag.tagName;\n      } else if (!isAttributeSearch && filteredElementSearch) {\n        searchedElement = openedTags[openedTags.length-2];\n      } else if (lastOpenedTag.tagName === 'cv-address' && lastOpenedTag.currentAttribute === null) {\n        return this._dataProvider.getAddresses('monaco').then(res => ({suggestions: res}));\n      } else if (lastOpenedTag.tagName === 'cv-chart' && lastOpenedTag.currentAttribute === 'src') {\n        return this._dataProvider.getRrds('monaco').then(res => ({suggestions: res}));\n      } else if (lastOpenedTag.tagName === 'cv-loader' && lastOpenedTag.currentAttribute === 'src') {\n        match = /type=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n        const typeFilter = match ? match[1] : null;\n        return this._dataProvider.getMediaFiles(typeFilter).then(function (suggestions) {\n          return {suggestions: suggestions};\n        });\n      }\n      const currentItem = this.findElements(this.__currentSchema.getElementNode('config'), searchedElement, openedTags.length, openedTags.includes('cv-meta'));\n\n      // return available elements/attributes if the tag exists in the schema, or an empty\n      // array if it doesn't\n      if (isContentSearch) {\n        const currentAttribute = lastOpenedTag.currentAttribute;\n\n        if (currentItem && currentAttribute in currentItem.getAllowedAttributes()) {\n          const attribute = currentItem.getAllowedAttributes()[currentAttribute];\n          const type = attribute.getTypeString();\n          attribute.getEnumeration().forEach(function(entry) {\n            res.push({\n              label: entry,\n              insertText: entry,\n              kind: window.monaco.languages.CompletionItemKind.Value,\n              detail: type,\n              documentation: attribute.getDocumentation().join('\\n')\n            });\n          });\n        }\n      } else if (isAttributeSearch) {\n        // get attributes completions\n        res = currentItem ? this.getAvailableAttributes(currentItem, usedItems) : [];\n      } else {\n        // get elements completions\n        // eslint-disable-next-line no-lonely-if\n        if (lastOpenedTag && lastOpenedTag.text.endsWith('</')) {\n          res.push({\n            label: lastOpenedTag.tagName,\n            insertText: lastOpenedTag.tagName,\n            kind: window.monaco.languages.CompletionItemKind.Field\n          });\n        } else {\n          res = currentItem ? this.getAvailableElements(currentItem, usedItems) : [];\n        }\n      }\n      return {suggestions: res};\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__elementCache = null;\n    this._schema = null;\n    this._dataProvider = null;\n  }\n});\n","/* CometVisu.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.editor.completion.CometVisu', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    TEMPLATES: null,\n\n    getTemplates: function () {\n      if (!this.TEMPLATES) {\n        this.TEMPLATES = [{\n          filterText: 'cvclass',\n          label: 'CometVisu-Class',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A generic CometVisu class.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Class.define(\"cv.$0\", {\\n  extend: qx.core.Object,\\n\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvwidget',\n          label: 'CometVisu-Widget',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A CometVisu class for a widget.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Class.define(\"cv.ui.structure.pure.$0\", {\\n  extend: cv.ui.structure.pure.AbstractWidget,\\n\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvinterface',\n          label: 'CometVisu-Interface',\n          kind: window.monaco.languages.CompletionItemKind.Interface,\n          detail: 'A generic CometVisu Interface.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Interface.define(\"cv.$0\", {\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvmixin',\n          label: 'CometVisu-Mixin',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A generic CometVisu Mixin.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Mixin.define(\"cv.$0\", {\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvmembers',\n          label: 'CometVisu-Class members',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'A CometVisu classes members section.',\n          insertText: '  /*\\n  ***********************************************\\n    MEMBERS\\n  ***********************************************\\n  */\\n  members: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvproperties',\n          label: 'CometVisu-Class properties',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'A CometVisu classes properties section.',\n          insertText: '  /*\\n  ***********************************************\\n    PROPERTIES\\n  ***********************************************\\n  */\\n  properties: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvstatics',\n          label: 'CometVisu-Class statics',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'statics section.',\n          insertText: '  /*\\n  ***********************************************\\n    STATICS\\n  ***********************************************\\n  */\\n  statics: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvevents',\n          label: 'CometVisu-Class events',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'events section.',\n          insertText: '  /*\\n  ***********************************************\\n    EVENTS\\n  ***********************************************\\n  */\\n  events: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvconstructor',\n          label: 'Constructor',\n          kind: window.monaco.languages.CompletionItemKind.Method,\n          detail: 'constructor.',\n          insertText: '  /*\\n  ***********************************************\\n    CONSTRUCTOR\\n  ***********************************************\\n  */\\n  construct: function () {\\n    this.base(arguments);\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvdestructor',\n          label: 'Destructor',\n          kind: window.monaco.languages.CompletionItemKind.Method,\n          detail: 'destructor.',\n          insertText: '  /*\\n  ***********************************************\\n    DESTRUCTOR\\n  ***********************************************\\n  */\\n  destruct: function () {\\n    this.base(arguments);\\n    $0\\n  }\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }];\n\n        // load plugin template from backend\n        return new Promise(function (resolve, reject) {\n          cv.io.rest.Client.getFsClient().readSync({path: 'demo/templates/Plugin.js'}, function (err, res) {\n            if (err) {\n              reject(err);\n            } else {\n              this.TEMPLATES.push({\n                filterText: 'cvplugin',\n                label: 'CometVisu-Plugin',\n                kind: window.monaco.languages.CompletionItemKind.Class,\n                detail: 'A CometVisu class for a plugin.',\n                insertText: res.replace('###SINCE###', cv.Version.VERSION.replace('-dev', '')+ ' ($CURRENT_YEAR)'),\n                insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n              });\n              resolve(this.TEMPLATES);\n            }\n          }, this);\n        }.bind(this));\n      }\n      return Promise.resolve(this.TEMPLATES);\n    },\n\n    getProvider: function () {\n      return {\n        triggerCharacters: ['cv'],\n        provideCompletionItems: function () {\n          // get editor content before the pointer\n          return this.getTemplates().then(function (sugg) {\n            return {suggestions: sugg};\n          });\n        }.bind(this)\n      };\n    }\n  }\n});\n","/* Schema.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.model.Schema', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (filename) {\n    this.base(arguments);\n    if (!filename || !filename.match(/\\.xsd$/)) {\n      throw new Error('no, empty or invalid filename given, can not instantiate without one');\n    }\n    this.__filename = filename;\n    this.setStructure(filename.endsWith('visu_config_tile.xsd') ? 'tile' : 'pure');\n    this.__allowedRootElements = {};\n    this.__referencedNodeCache = {};\n    this.__typeNodeCache = {};\n    this._cacheXSD();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    __CACHE: {},\n\n    getInstance: function (schemaFile) {\n      if (!Object.prototype.hasOwnProperty.call(this.__CACHE, schemaFile)) {\n        this.__CACHE[schemaFile] = new cv.ui.manager.model.Schema(qx.util.ResourceManager.getInstance().toUri(schemaFile));\n      }\n      return this.__CACHE[schemaFile];\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    loaded: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeLoaded'\n    },\n\n    structure: {\n      check: ['pure', 'tile'],\n      apply: '_applyStructure'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __filename: null,\n    /**\n     * object of the schema/xsd\n     * @var object\n     */\n    __xsd: null,\n\n    /**\n     * object of allowed root-level elements\n     * @var object\n     */\n    __allowedRootElements: null,\n\n    /**\n     * cache for referenced nods\n     * @var object\n     */\n    __referencedNodeCache: null,\n\n    /**\n     * cache for getTypeNode\n     * @var object\n     */\n    __typeNodeCache: null,\n\n    /**\n     * cache for #text-SchemaElement\n     * @var object\n     */\n    __textNodeSchemaElement: null,\n\n    /**\n     * cache for #comment-SchemaElement\n     * @var object\n     */\n    __commentNodeSchemaElement: null,\n\n    /**\n     * @var {Array<String>}\n     */\n    _widgetNames: null,\n\n    /**\n     * @var {String}\n     */\n    __rootElementName: null,\n\n    /**\n     * @var {String}\n     */\n    __pageParentElementName: null,\n\n    /**\n     * @var {String}\n     */\n    __pageElementName: null,\n\n    _applyStructure(structure) {\n      if (structure === 'tile') {\n        this.__rootElementName = 'config';\n        this.__pageParentElementName = 'main';\n        this.__pageElementName = 'cv-page';\n      } else {\n        this.__rootElementName = 'pages';\n        this.__pageElementName = 'page';\n      }\n    },\n\n    onLoaded: function (callback, context) {\n      if (this.isLoaded()) {\n        callback.call(context);\n      } else {\n        this.addListenerOnce('changeLoaded', callback, context);\n      }\n    },\n\n    /**\n     * load and cache the xsd from the server\n     */\n    _cacheXSD: function () {\n      const ajaxRequest = new qx.io.request.Xhr(this.__filename);\n      ajaxRequest.set({\n        accept: 'application/xml'\n      });\n      ajaxRequest.addListenerOnce('success', function (e) {\n        const req = e.getTarget();\n        // Response parsed according to the server's response content type\n        let xml = req.getResponse();\n        if (xml && (typeof xml === 'string')) {\n          xml = qx.xml.Document.fromString(xml);\n        }\n        this.__xsd = xml;\n\n        // parse the data, to have at least a list of root-level-elements\n        this._parseXSD();\n      }, this);\n      ajaxRequest.send();\n    },\n\n    /**\n     * parse the schema once\n     */\n    _parseXSD: function () {\n      // make a list of root-level elements\n      this.__xsd.querySelectorAll('schema > element').forEach(element => {\n        const name = element.getAttribute('name');\n        this.__allowedRootElements[name] = new cv.ui.manager.model.schema.Element(element, this);\n      });\n      this.setLoaded(true);\n    },\n\n    getElementNode: function (name) {\n      if (Object.prototype.hasOwnProperty.call(this.__allowedRootElements, name)) {\n        return this.__allowedRootElements[name];\n      }\n      throw new Error('schema/xsd appears to be invalid, element ' + name + ' not allowed on root level');\n    },\n\n    /**\n     * dive into the schema and find the element that is being pulled in by a ref.\n     * Do so recursively.\n     * referenced nodes can be top-level-nodes only!\n     *\n     * @param   type       string  Type of the node (e.g. element, attributeGroup, ...)\n     * @param   refName    string  Name as per the ref-attribute\n     * @param   noFallback boolean Don't look up other types as fallback, if the requested type is not found\n     * @return  object          jQuery-object of the ref'ed element\n     */\n    getReferencedNode: function (type, refName, noFallback) {\n      if (Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type) && Object.prototype.hasOwnProperty.call(this.__referencedNodeCache[type], refName)) {\n        return this.__referencedNodeCache[type][refName];\n      }\n      const fallbackType = type === 'simpleType' ? 'complexType' : 'simpleType';\n      if (!noFallback) {\n        if (Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, fallbackType) && Object.prototype.hasOwnProperty.call(this.__referencedNodeCache[fallbackType], refName)) {\n          return this.__referencedNodeCache[fallbackType][refName];\n        }\n      }\n\n      const selector = 'schema > ' + type + '[name=\"' + refName + '\"]';\n      let ref = this.__xsd.querySelector(selector);\n      if (!ref && !noFallback) {\n        try {\n          ref = this.getReferencedNode(fallbackType, refName, true);\n        } catch (e) {}\n      }\n      if (!ref) {\n        throw new Error('schema/xsd appears to be invalid, reference ' + type + ' \"' + refName + '\" can not be found');\n      }\n\n      if (ref.hasAttribute('ref')) {\n        // do it recursively, if necessary\n        ref = this.getReferencedNode(type, ref.getAttribute('ref'));\n      }\n\n      if (!Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type)) {\n        this.__referencedNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__referencedNodeCache[type][refName] = ref;\n\n      return ref;\n    },\n\n\n    /**\n     * get the definition of a type, be it complex or simple\n     *\n     * @param   type    string  Type of type to find (either simple or complex)\n     * @param   name    string  Name of the type to find\n     */\n    getTypeNode: function (type, name) {\n      if (Object.prototype.hasOwnProperty.call(this.__typeNodeCache, type) && Object.prototype.hasOwnProperty.call(this.__typeNodeCache[type], name)) {\n        return this.__typeNodeCache[type][name];\n      }\n      let typeNode = this.__xsd.querySelector(type + 'Type[name=\"' + name + '\"]');\n\n      if (!typeNode) {\n        throw new Error('schema/xsd appears to be invalid, ' + type + 'Type \"' + name + '\" can not be found');\n      }\n\n      if (typeof this.__typeNodeCache[type] == 'undefined') {\n        this.__typeNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__typeNodeCache[type][name] = typeNode;\n\n      return typeNode;\n    },\n\n    /**\n     * get a SchemaElement for a #text-node\n     *\n     * @return  object  SchemaElement for #text-node\n     */\n    getTextNodeSchemaElement: function () {\n      if (this.__textNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#text');\n        tmpXML.setAttribute('type', 'xsd:string');\n        this.__textNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__textNodeSchemaElement;\n    },\n\n    /**\n     * get a SchemaElement for a #comment-node\n     *\n     * @return  object  SchemaElement for #comment-node\n     */\n    getCommentNodeSchemaElement: function () {\n      if (this.__commentNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#comment');\n        tmpXML.setAttribute('type', 'xsd:string');\n        tmpXML.setAttribute('minOccurs', '0');\n        tmpXML.setAttribute('maxOccurs', 'unbounded');\n        this.__commentNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__commentNodeSchemaElement;\n    },\n\n    /**\n     * get the DOM for this Schema\n     *\n     * @return  object  DOM\n     */\n    getSchemaDOM: function () {\n      return this.__xsd;\n    },\n\n    /**\n     * A CometVisu-Schema specific helper function that returns an array of all widget names.\n     * @returns {Array<String>}\n     */\n    getWidgetNames: function () {\n      if (!this._widgetNames) {\n        const root = this.getElementNode(this.__rootElementName);\n        let pageParent = root;\n        if (this.__pageParentElementName) {\n          pageParent = root.getSchemaElementForElementName(this.__pageParentElementName);\n        }\n        const page = pageParent.getSchemaElementForElementName(this.__pageElementName);\n        this._widgetNames = Object.keys(page.getAllowedElements()).filter(name => !name.startsWith('#') && name !== 'layout');\n      }\n      return this._widgetNames;\n    },\n\n    isRoot(name) {\n      return name === this.__rootElementName;\n    },\n\n    isPage(name) {\n      return name = this.__pageElementName;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__xsd = null;\n    this._disposeObjects('__commentNodeSchemaElement', '__textNodeSchemaElement');\n    this._disposeMap('__allowedRootElements');\n    this.__referencedNodeCache = null;\n    this.__typeNodeCache = null;\n    this._widgetNames = null;\n  }\n});\n\n","/* ElementChange.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * An atomic change on an cv.ui.manager.model.XmlElement that can be undone / redone.\n */\nqx.Class.define('cv.ui.manager.model.ElementChange', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (title, element, changes, type) {\n    this.base(arguments);\n    this.setTitle(title);\n    this.setElement(element);\n    this.setChanges(changes);\n    this.setChangeType(type || 'content');\n  },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement'\n    },\n    title: {\n      check: 'String'\n    },\n    changes: {\n      check: 'Array'\n    },\n    changeType: {\n      check: ['content', 'created', 'deleted', 'moved'],\n      init: ['content']\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * Undo all changes\n     * @return {Boolean} true if all changes are undone\n     */\n    undo: function() {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.undo();\n              } else {\n                element.setAttribute(change.attribute, change.old);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.child) {\n              change.child.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.oldParent, change.oldIndex, true);\n            break;\n        }\n      }\n      return success;\n    },\n\n    /**\n     * Redo all change\n     *  @return {Boolean} true if all changes are redone\n     */\n    redo: function () {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.redo();\n              } else {\n                element.setAttribute(change.attribute, change.value);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            if (element) {\n              element.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.parent, change.index, true);\n            break;\n        }\n      }\n      return success;\n    }\n  }\n});\n","/* VirtualElementItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Widget for node items in XML-File\n */\nqx.Class.define('cv.ui.manager.tree.VirtualElementItem', {\n  extend: qx.ui.tree.VirtualTreeItem,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label) {\n    this.base(arguments, label);\n    if (qx.core.Environment.get('device.touch')) {\n      this.addState('touch');\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'element-tree-item'\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName',\n      apply: '_applyName'\n    },\n\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyTemporary'\n    },\n\n    status: {\n      check: ['valid', 'error', 'comment'],\n      nullable: true,\n      apply: '_applyStatus'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: false\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applySortable'\n    },\n\n    droppable: {\n      refine: true,\n      init: true\n    },\n\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    edit: 'qx.event.type.Data',\n    action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates : {\n      selected : true,\n      touch: true\n    },\n    __labelAdded: false,\n\n    _applyName: function(value) {\n      this.getContentElement().setAttribute('data-nodename', value);\n    },\n\n    // this has to be set by model binding, because the qx way by adding a state does not survive a widget re-binding\n    _applyDragging: function (value) {\n      if (value) {\n        this.addState('drag');\n      } else {\n        this.removeState('drag');\n      }\n    },\n\n    _applyModel: function (value) {\n      if (qx.core.Environment.get('device.touch')) {\n        if (value) {\n          const menuButton = this.getChildControl('menu-button');\n          menuButton.show();\n          let menu = menuButton.getMenu();\n          menu.setEditor(value.getEditor());\n          menu.setElement(value);\n        } else {\n          this.getChildControl('menu-button').hide();\n        }\n      } else if (this.hasChildControl('menu-button')) {\n        this.getChildControl('menu-button').exclude();\n      }\n    },\n\n    _applyTemporary: function (value) {\n      if (value) {\n        this.addState('temporary');\n      } else {\n        this.removeState('temporary');\n      }\n    },\n\n    _applySortable: function (value) {\n      if (value) {\n        this.getChildControl('move-button').show();\n      } else {\n        this.getChildControl('move-button').hide();\n      }\n    },\n\n    _applyStatus: function (value, old) {\n      const icon = this.getChildControl('icon');\n      const label = this.getChildControl('label');\n      if (old) {\n        icon.removeState(old);\n        label.removeState(old);\n      }\n      if (value) {\n        icon.addState(value);\n        label.addState(value);\n      }\n    },\n\n    _addWidgets: function() {\n      this.base(arguments);\n      const open = this.getChildControl('open', true);\n      if (open && qx.core.Environment.get('device.touch')) {\n        open.getContentElement().addClass('touch-tree-open-icon');\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new cv.ui.manager.basic.Image().set({\n             forceScale: true,\n             alignY: 'middle',\n             anonymous: true,\n             source: this.getIcon(),\n             maxWidth: 22,\n             maxHeight: 22\n           });\n           break;\n\n         case 'buttons':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox(8));\n           control.setAnonymous(true);\n           break;\n\n         case 'move-button':\n           control = new qx.ui.basic.Atom('', cv.theme.dark.Images.getIcon('drag-handle', qx.core.Environment.get('device.touch') ? 36 : 18));\n           control.setToolTipText(this.tr('Drag to move'));\n           control.setAnonymous(true);\n           control.setShow('icon');\n           this.getChildControl('buttons').addAt(control, 0);\n           break;\n\n         case 'menu-button':\n           control = new qx.ui.form.MenuButton('', cv.theme.dark.Images.getIcon('menu', qx.core.Environment.get('device.touch') ? 24 : 14), new cv.ui.manager.contextmenu.ConfigElement());\n           control.getMenu().addListener('action', ev => {\n             this.fireDataEvent('action', ev.getData());\n           });\n           this.getChildControl('buttons').addAt(control, 1);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    // overridden\n    addLabel : function(text) {\n      const label = this.getChildControl('label');\n\n      if (this.__labelAdded) {\n        this._remove(label);\n      }\n\n      if (text) {\n        this.setLabel(text);\n      } else {\n        label.setValue(this.getLabel());\n      }\n\n      this._add(label);\n      this._add(new qx.ui.core.Spacer(), {flex: 1});\n      const buttons = this.getChildControl('buttons');\n      this._add(buttons);\n      this.__labelAdded = true;\n    }\n  }\n});\n","/* ConfigElement.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Contextmenu for an XML-Element in a CometVisu config file.\n */\nqx.Class.define('cv.ui.manager.contextmenu.ConfigElement', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (editor) {\n    this.base(arguments);\n    if (editor) {\n      this.setEditor(editor);\n    }\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'action': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      apply: '_applyElement'\n    },\n\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      apply: '_applyEditor'\n    }\n\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {qx.ui.command.GroupManager}\n     */\n    _commandGroup: null,\n\n    _applyEditor: function (value, old) {\n      if (old) {\n        old.removeListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n      if (value) {\n        value.addListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n    },\n\n    _applyElement: function(value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n        old.removeRelatedBindings(this.getChildControl('cut-button'));\n      }\n      if (value) {\n        const editable = value.isEditable();\n        this.getChildControl('copy-button').setEnabled(true);\n        if (editable) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n          value.bind('deletable', this.getChildControl('cut-button'), 'enabled');\n          this.getChildControl('view-button').exclude();\n          this.getChildControl('edit-button').show();\n          this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n          let addable = value.getAddableChildren(true);\n          this.getChildControl('create-button').setEnabled(addable.length > 0);\n        } else {\n          this.getChildControl('delete-button').setEnabled(false);\n          this.getChildControl('cut-button').setEnabled(false);\n          this.getChildControl('create-button').setEnabled(false);\n          this.getChildControl('view-button').show();\n          // enable view button when there are attributes to show\n          this.getChildControl('view-button').setEnabled(value.getShowEditButton());\n          this.getChildControl('edit-button').exclude();\n        }\n      } else {\n        ['edit', 'delete', 'cut', 'copy', 'paste', 'create'].forEach(name => this.getChildControl(name + '-button').setEnabled(false));\n      }\n      this._maintainClipboardButtons();\n    },\n\n    _init: function () {\n      ['view', 'edit', 'delete'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      ['cut', 'copy', 'paste'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      this.add(this.getChildControl('create-button'));\n    },\n\n    _maintainClipboardButtons: function () {\n      const content = this.getEditor().getClipboard();\n      const element = this.getElement();\n      let enabled = (element ? element.isEditable() : false) && content instanceof cv.ui.manager.model.XmlElement;\n      if (enabled) {\n        // check if content is allowed as child here\n        let addable = element.getAddableChildren(true);\n        enabled = addable.includes(content.getName()) && element.isChildAllowedAtPosition(content, Number.POSITIVE_INFINITY);\n      }\n      this.getChildControl('paste-button').setEnabled(enabled);\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n       let control;\n\n       switch (id) {\n         case 'view-button':\n           control = this.__createButton('view', this.tr('View'), cv.theme.dark.Images.getIcon('view', 18));\n           control.exclude();\n           break;\n\n         case 'edit-button':\n           control = this.__createButton('edit', this.tr('Edit'), cv.theme.dark.Images.getIcon('edit', 18));\n           break;\n\n         case 'delete-button':\n           control = this.__createButton('delete', this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n           break;\n\n         case 'cut-button':\n           control = this.__createButton('cut', this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18));\n           break;\n\n         case 'copy-button':\n           control = this.__createButton('copy', this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18));\n           break;\n\n         case 'paste-button':\n           control = this.__createButton('paste', this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18));\n           break;\n\n         case 'create-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'create-button':\n           control = this.__createButton('create', this.tr('Add child'), cv.theme.dark.Images.getIcon('add', 18));\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    __createButton: function (action, title, icon, command, menu) {\n      const button = new qx.ui.menu.Button(title, icon, command, menu);\n      button.addListener('execute', function () {\n        this.fireDataEvent('action', {\n          action: action,\n          element: this.getElement()\n        });\n      }, this);\n      return button;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n  }\n});\n","/* ElementForm.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.form.ElementForm', {\n  extend: qxl.dialog.Form,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    labelColumnWidth: {\n      refine: true,\n      init: 300\n    },\n\n    useBlocker: {\n      refine: true,\n      init: true\n    },\n\n    blockerOpacity: {\n      refine: true,\n      init: 0.9\n    },\n\n    blockerColor: {\n      refine: true,\n      init: '#585858'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __mappedKeys: null,\n    __hints: null,\n    _rootListenerId: null,\n\n    _applyFormData: function (formData, old) {\n      this.__mappedKeys = {\n        map: {},\n        inverse: {}\n      };\n      let firstWidget;\n      if (this._formController) {\n        try {\n          this.getModel().removeAllBindings();\n          this._formController.dispose();\n        } catch (e) {\n        }\n      }\n      if (this._form) {\n        try {\n          this._form.getValidationManager().removeAllBindings();\n          this._form.dispose();\n        } catch (e) {\n        }\n      }\n      this._formContainer.removeAll();\n      if (!formData) {\n        return;\n      }\n      if (this.getModel()) {\n        this.getModel().removeAllBindings();\n        this.getModel().dispose();\n      }\n      let modelData = {};\n      for (let key of Object.getOwnPropertyNames(formData)) {\n        let i = 0;\n        let mappedKey = key.replaceAll(/[-_\\.#]+([a-z])/g, (match, p1) => p1.toUpperCase()) + i++;\n        while (Object.prototype.hasOwnProperty.call(modelData, mappedKey)) {\n          mappedKey = mappedKey.substr(0, mappedKey.length - 1) + i++;\n        }\n        if (mappedKey !== key) {\n          this.__mappedKeys.map[mappedKey] = key;\n          this.__mappedKeys.inverse[key] = mappedKey;\n        }\n        modelData[mappedKey] = formData[key].value !== undefined\n          ? formData[key].value\n          : null;\n      }\n      let model = qx.data.marshal.Json.createModel(modelData);\n      this.setModel(model);\n      // form\n      this._form = new qx.ui.form.Form();\n      if (qx.core.Environment.get('module.objectid') === true) {\n        this._form.setQxObjectId('form');\n        this.addOwnedQxObject(this._form);\n      }\n      this._formController = new qx.data.controller.Object(model);\n      this._onFormReady(this._form);\n      let i = 0;\n      let atom;\n      for (let key of Object.getOwnPropertyNames(formData)) {\n        const mappedKey = this.__mappedKeys.inverse[key];\n        let fieldData = formData[key];\n        let formElement = null;\n        let elementModel = null;\n        let elementModelReady = null;\n        switch (fieldData.type.toLowerCase()) {\n          case 'groupheader':\n            this._form.addGroupHeader(fieldData.value);\n            break;\n          case 'textarea':\n            formElement = new qx.ui.form.TextArea();\n            formElement.setMinimalLineHeight(fieldData.lines);\n            if (fieldData.autoSize === true) {\n              formElement.setAutoSize(true);\n              formElement.setMinHeight(fieldData.lines * 16);\n            } else {\n              formElement.setHeight(fieldData.lines * 16);\n            }\n            formElement.setLiveUpdate(true);\n            break;\n          case 'textfield':\n            formElement = new qx.ui.form.TextField();\n            if (fieldData.maxLength) {\n              formElement.setMaxLength(fieldData.maxLength);\n            }\n            formElement.setLiveUpdate(true);\n            break;\n          case 'sourceeditor':\n            formElement = new cv.ui.manager.form.SourceCodeField('', fieldData.language);\n            if (fieldData.autoSize === true) {\n              formElement.setAutoSize(true);\n              formElement.setMinHeight(fieldData.lines * 16);\n            } else {\n              formElement.setHeight(fieldData.lines * 16);\n            }\n            break;\n          case 'datefield':\n          case 'date':\n            formElement = new qx.ui.form.DateField();\n            if (fieldData.dateFormat) {\n              formElement.setDateFormat(fieldData.dateFormat);\n            }\n            break;\n          case 'passwordfield':\n          case 'password':\n            formElement = new qx.ui.form.PasswordField();\n            formElement.getContentElement().setAttribute('autocomplete', 'password');\n            break;\n          case 'combobox': {\n            formElement = new qx.ui.form.ComboBox();\n            const parseComboOptions = function (options) {\n              if (Array.isArray(options)) {\n                options.forEach(function (item) {\n                  let listItem = new qx.ui.form.ListItem(item.label, item.icon);\n                  formElement.add(listItem);\n                });\n              } else if (typeof options === 'object') {\n                // grouped options\n                Object.keys(options).forEach(groupName => {\n                  let groupItem = new qx.ui.form.ListItem(groupName);\n                  groupItem.set({\n                    anonymous: true,\n                    appearance: 'optiongroup'\n                  });\n                  formElement.add(groupItem);\n                  options[groupName].forEach(function (item) {\n                    let listItem = new qx.ui.form.ListItem(item.label, item.icon, item.value);\n                    formElement.add(listItem);\n                  });\n                });\n              }\n            };\n            if (fieldData.options instanceof Promise) {\n              formElement.setPlaceholder(this.tr('Loading...'));\n              elementModelReady = fieldData.options.then(options => {\n                formElement.setPlaceholder(fieldData.placeholder);\n                parseComboOptions(options);\n                return true;\n              }, this).catch(err => {\n                this.error(err);\n                formElement.setPlaceholder(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n              }, this);\n            } else {\n              parseComboOptions(fieldData.options);\n            }\n            break;\n          }\n          case 'virtualcombobox': {\n            formElement = new qx.ui.form.VirtualComboBox();\n            formElement.set({\n              iconPath: 'icon',\n              labelPath: 'value'\n            });\n            if (fieldData.validation) {\n              formElement.getChildControl('textfield').setLiveUpdate(true);\n            }\n            const selection = formElement.getChildControl('dropdown').getSelection();\n            selection.addListener('change', function (ev) {\n              const selected = selection.getItem(0);\n              if (selected && selected instanceof cv.ui.manager.form.Option) {\n                this.__hints = selected.getHints();\n              } else {\n                this.__hints = null;\n              }\n            }, this);\n            elementModel = new qx.data.Array();\n            const parseVComboOptions = function (options) {\n              if (Array.isArray(options)) {\n                options.forEach(item => {\n                  elementModel.push(new cv.ui.manager.form.Option(item.label + (item.value ? ` (${item.value})` : ''), item.icon, item.value, item.hints));\n                });\n              } else if (typeof options === 'object') {\n                Object.keys(options).forEach(groupName => {\n                  const groupModel = new cv.ui.manager.form.Option(groupName);\n                  groupModel.setType('group');\n                  elementModel.push(groupModel);\n                  options[groupName].forEach(function (item) {\n                    elementModel.push(new cv.ui.manager.form.Option(item.label + (item.value ? ` (${item.value})` : ''), item.icon, item.value, item.hints));\n                  });\n                });\n              }\n            };\n            if (fieldData.options instanceof Promise) {\n              formElement.setPlaceholder(this.tr('Loading...'));\n              fieldData.options.then(options => {\n                formElement.setPlaceholder(fieldData.placeholder);\n                parseVComboOptions(options);\n              }, this).catch(err => {\n                this.error(err);\n                formElement.setPlaceholder(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n              }, this);\n            } else {\n              parseVComboOptions(fieldData.options);\n            }\n\n            formElement.setDelegate({\n              createItem: function () {\n                return new cv.ui.manager.form.ListItem();\n              },\n              bindItem: function (controller, item, index) {\n                controller.bindProperty('icon', 'icon', null, item, index);\n                controller.bindProperty('label', 'label', null, item, index);\n                controller.bindProperty('type', 'appearance', {\n                  converter: function (value) {\n                    switch (value) {\n                      case 'state':\n                        return 'state-option';\n                      case 'error':\n                        return 'error-option';\n                      case 'group':\n                        return 'optiongroup';\n                      default:\n                        return 'listitem';\n                    }\n                  }\n                }, item, index);\n                controller.bindProperty('type', 'anonymous', {\n                  converter: function (value) {\n                    return value === 'group';\n                  }\n                }, item, index);\n              }\n            });\n            formElement.setModel(elementModel);\n            break;\n          }\n\n          case 'selectbox': {\n            formElement = new qx.ui.form.SelectBox();\n            if (fieldData.options instanceof Promise) {\n              atom = formElement.getChildControl('atom');\n              atom.setLabel(this.tr('Loading...'));\n              atom.addState('loading');\n              elementModelReady = fieldData.options.then(options => {\n                const atom = formElement.getChildControl('atom');\n                atom.resetLabel();\n                atom.removeState('loading');\n                // eslint-disable-next-line no-new\n                new qx.data.controller.List(qx.data.marshal.Json.createModel(options), formElement, 'label');\n                return true;\n              }, this).catch(err => {\n                this.error(err);\n                const atom = formElement.getChildControl('atom');\n                atom.setLabel(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n                atom.removeState('loading');\n                atom.addState('error');\n              }, this);\n            } else {\n              // eslint-disable-next-line no-new\n              new qx.data.controller.List(qx.data.marshal.Json.createModel(fieldData.options), formElement, 'label');\n            }\n            break;\n          }\n\n          case 'virtualselectbox':\n            formElement = new cv.ui.manager.form.VirtualSelectBox();\n            elementModel = new qx.data.Array();\n            if (fieldData.options) {\n              if (fieldData.options instanceof Promise) {\n                atom = formElement.getChildControl('atom');\n                atom.setLabel(this.tr('Loading...'));\n                atom.addState('loading');\n                elementModelReady = fieldData.options.then(options => {\n                  const atom = formElement.getChildControl('atom');\n                  atom.resetLabel();\n                  atom.removeState('loading');\n                  options.forEach(item => {\n                    elementModel.push(new cv.ui.manager.form.Option(item.label, item.icon, item.value));\n                  });\n                  return true;\n                }).catch(err => {\n                  this.error(err);\n                  const atom = formElement.getChildControl('atom');\n                  atom.setLabel(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n                  atom.removeState('loading');\n                  atom.addState('error');\n                }, this);\n              } else {\n                fieldData.options.forEach(item => {\n                  elementModel.push(new cv.ui.manager.form.Option(item.label, item.icon, item.value));\n                });\n              }\n            }\n            formElement.setDelegate({\n              createItem: function() {\n                return new cv.ui.manager.form.ListItem();\n              },\n              bindItem:  function (controller, item, index) {\n                controller.bindDefaultProperties(item, index);\n                controller.bindProperty('value', 'model', null, item, index);\n              }\n            });\n            formElement.set({\n              labelPath: 'label',\n              iconPath: 'icon',\n              iconOptions: {\n                converter: function (value) {\n                  if (typeof value === 'function') {\n                    return value().trim();\n                  }\n                  return value;\n                }\n              },\n              model: elementModel\n            });\n            break;\n          case 'radiogroup':\n            formElement = new qx.ui.form.RadioGroup();\n            if (fieldData.orientation) {\n              formElement.setUserData('orientation', fieldData.orientation);\n            }\n            fieldData.options.forEach(function (item) {\n              let radioButton = new qx.ui.form.RadioButton(item.label);\n              radioButton.setUserData(\n                'value',\n                item.value !== undefined ? item.value : item.label\n              );\n              formElement.add(radioButton);\n            }, this);\n            break;\n          case 'label':\n            formElement = new qx.ui.form.TextField(); // dummy\n            formElement.setUserData('excluded', true);\n            break;\n          case 'checkbox':\n            formElement = new cv.ui.manager.form.CheckBox();\n            formElement.setTriState(true);\n            break;\n          case 'spinner':\n            formElement = new qx.ui.form.Spinner();\n            if (fieldData.min) {\n              formElement.setMinimum(fieldData.min);\n            }\n            if (fieldData.max) {\n              formElement.setMaximum(fieldData.max);\n            }\n            if (fieldData.step) {\n              formElement.setSingleStep(fieldData.step);\n            }\n            if (fieldData.fractionsDigits) {\n              let fd = fieldData.fractionsDigits;\n              let nf = new qx.util.format.NumberFormat();\n              if (fd.min) {\n                nf.setMinimumFractionDigits(fd.min);\n              }\n              if (fd.max) {\n                nf.setMaximumFractionDigits(fd.max);\n              }\n              formElement.setNumberFormat(nf);\n            }\n            break;\n          default:\n            this.error('Invalid form field type:' + fieldData.type);\n        }\n        formElement.setUserData('key', key);\n        formElement.setUserData('mappedKey', mappedKey);\n        if (i === 0) {\n          firstWidget = formElement;\n        }\n        i++;\n        if (typeof fieldData.type == 'string') {\n          let options = null;\n          let reverseOptions = null;\n          let bidirectional = true;\n          let handled = false;\n          switch (fieldData.type.toLowerCase()) {\n            case 'textarea':\n            case 'textfield':\n            case 'passwordfield':\n            case 'combobox':\n            case 'virtualcombobox':\n            case 'datefield':\n            case 'spinner':\n            case 'sourceeditor':\n              reverseOptions = {\n                converter: function (value) {\n                  // just validate when the value has changed\n                  this.getValidationManager().validate();\n                  return value;\n                }.bind(this._form)\n              };\n              break;\n            case 'virtualselectbox':\n              options = {\n                converter: function (value) {\n                  if (typeof value === 'string') {\n                    let option;\n                    this.getModel().some(item => {\n                      if (item.getValue() === value) {\n                        option = item;\n                        return true;\n                      }\n                      return false;\n                    });\n                    return option;\n                  }\n                  return value;\n                }.bind(formElement)\n              };\n              reverseOptions = {\n                converter: function (option) {\n                  this.getValidationManager().validate();\n                  return option ? option.getValue() : null;\n                }.bind(this._form)\n              };\n              break;\n            case 'checkbox':\n              break;\n            case 'selectbox':\n              // for some strange timing reason this only works, when addTarget is called here\n              this._formController.addTarget(formElement, 'selection', mappedKey, true, {\n                converter: function (value) {\n                  let selected = null;\n                  let selectables = this.getSelectables();\n                  selectables.some(function (selectable) {\n                    if (selectable.getModel().getValue() === value) {\n                      selected = selectable;\n                      return true;\n                    }\n                    return false;\n                  }, this);\n                  if (!selected) {\n                    return [selectables[0]];\n                  }\n                  return [selected];\n                }.bind(formElement)\n              }, {\n                converter: function (selection) {\n                  return selection[0].getModel().getValue();\n                }\n              });\n              handled = true;\n              break;\n            case 'radiogroup':\n              options = {\n                converter: function (value) {\n                  let selectables = this.getSelectables();\n                  let selection = [];\n                  if (value) {\n                    selectables.forEach(function (selectable) {\n                      let sValue = selectable.getUserData('value');\n                      if (sValue === value) {\n                        selection = [selectable];\n                      }\n                    }, this);\n                  }\n                  return selection;\n                }.bind(formElement)\n              };\n              reverseOptions = {\n                converter: function (selection) {\n                  return selection[0].getUserData('value');\n                }\n              };\n              break;\n          }\n          if (!handled) {\n            if (elementModelReady) {\n              // do not add the binding before the model is there\n              elementModelReady.then(() => {\n                this._formController.addTarget(formElement, 'value', mappedKey, bidirectional, options, reverseOptions);\n              });\n            } else {\n              this._formController.addTarget(formElement, 'value', mappedKey, bidirectional, options, reverseOptions);\n            }\n          }\n        }\n        /**\n         * Validation\n         */\n        let validator = null;\n        if (formElement && fieldData.validation) {\n          // required field\n          if (fieldData.validation.required) {\n            formElement.setRequired(true);\n          }\n          // sync validation\n          if (fieldData.validation.validator) {\n            validator = fieldData.validation.validator;\n            if (typeof validator == 'string') {\n              if (qx.util.Validate[validator]) {\n                validator = qx.util.Validate[validator]();\n              } else if (validator.charAt(0) === '/') {\n                validator = qx.util.Validate.regExp(\n                  new RegExp(validator.substr(1, validator.length - 2)),\n                  fieldData.validation.errorMessage\n                );\n              } else {\n                this.error('Invalid string validator.');\n              }\n            } else if (!(validator instanceof qx.ui.form.validation.AsyncValidator) && typeof validator !== 'function') {\n              this.error('Invalid validator.');\n            }\n          }\n          // async validation\n          if (qx.lang.Type.isString(fieldData.validation.proxy) &&\n            qx.lang.Type.isString(fieldData.validation.method)\n          ) {\n            /**\n             * fieldData.validation.proxy\n             * the name of a global variable (or path) to a function that acts as the proxy of\n             * the 'send' or 'execute' function of a preconfigured JsonRpc client. The function\n             * receives the following parameters: service method (string), parameters (array)\n             * and callback (function). It proxies the parameters to the given JsonRpc method and\n             * calls the callback with the result (true if valid, false if not) received from the\n             * server. The JsonRpc service name is preconfigured by the server and cannot be\n             * changed by the client.\n             */\n              // clean\n            let proxy = fieldData.validation.proxy.replace(/;\\n/g, '');\n            try {\n              // eslint-disable-next-line no-eval\n              eval('proxy = ' + proxy + ';');\n            } catch (e) {\n              this.warn('Invalid proxy name');\n            }\n            if (typeof proxy == 'function') {\n              let method = fieldData.validation.method;\n              let message = fieldData.validation.invalidMessage;\n              let validationFunc = function (validatorObj, value) {\n                if (!validatorObj.__asyncInProgress) {\n                  validatorObj.__asyncInProgress = true;\n                  proxy(method, [value], function (valid) {\n                    validatorObj.setValid(valid, message || qx.locale.Manager.tr('Value is invalid'));\n                    validatorObj.__asyncInProgress = false;\n                  });\n                }\n              };\n              validator = new qx.ui.form.validation.AsyncValidator(validationFunc);\n            }\n          }\n        }\n\n        /**\n         * other widget properties @todo: allow to set all properties\n         */\n        if (fieldData.width !== undefined) {\n          formElement.setWidth(fieldData.width);\n        }\n        if (fieldData.placeholder !== undefined) {\n          formElement.setPlaceholder(fieldData.placeholder);\n        }\n        if (fieldData.enabled !== undefined) {\n          formElement.setEnabled(fieldData.enabled);\n        }\n        if (fieldData.help !== undefined) {\n          formElement.setUserData('help', fieldData.help);\n        }\n\n        /**\n         * Events\n         */\n        if (qx.lang.Type.isObject(fieldData.events)) {\n          for (let type in fieldData.events) {\n            try {\n              // eslint-disable-next-line no-eval\n              let func = eval('(' + fieldData.events[type] + ')'); // eval is evil, I know.\n              if (!qx.lang.Type.isFunction(func)) {\n                throw new Error();\n              }\n              formElement.addListener(type, func, formElement);\n            } catch (e) {\n              this.warn('Invalid \\'' + type + '\\' event handler for form element \\'' + key + '\\'.');\n            }\n          }\n        }\n\n        // Putting it all together\n        let label = fieldData.label;\n        this._form.add(formElement, label, validator);\n        // Add the form elements as objects owned by the form widget\n        if (qx.core.Environment.get('module.objectid') === true) {\n          formElement.setQxObjectId(key);\n          this._form.addOwnedQxObject(formElement);\n        }\n      }\n\n\n      let view = new cv.ui.manager.form.ElementFormRenderer(this._form);\n      view.getLayout().setColumnFlex(0, 0);\n      view.getLayout().setColumnMaxWidth(0, this.getLabelColumnWidth());\n      view.getLayout().setColumnFlex(1, 1);\n      view.getLayout().set({\n        spacingX: 8\n      });\n      view.setAllowGrowX(true);\n      const scroll = new qx.ui.container.Scroll(view);\n      scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      this._rootListenerId = qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      });\n\n      view.bind('width', scroll, 'width');\n      view.bind('height', scroll, 'height');\n      this._formContainer.add(scroll);\n      this._form.getValidationManager().validate();\n      if (firstWidget) {\n        qx.event.Timer.once(() => {\n          firstWidget.focus();\n        }, this, 200);\n      }\n    },\n\n    _handleOk: function () {\n      this.hide();\n      if (this.getCallback()) {\n        const data = qx.util.Serializer.toNativeObject(this.getModel());\n        const mappedNames = Object.keys(this.__mappedKeys.map);\n        mappedNames.forEach(mappedKey => {\n          if (Object.prototype.hasOwnProperty.call(data, mappedKey)) {\n            data[this.__mappedKeys.map[mappedKey]] = data[mappedKey];\n            delete data[mappedKey];\n          }\n        });\n        if (this.__hints) {\n          Object.keys(this.__hints).forEach(name => data[name] = this.__hints[name]);\n        }\n        this.getCallback().call(\n          this.getContext(),\n          data\n        );\n      }\n      this.resetCallback();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    if (this._rootListenerId) {\n      qx.core.Init.getApplication().getRoot().removeListenerById(this._rootListenerId);\n      this._rootListenerId = null;\n    }\n  }\n});\n","/* Base.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.model.schema.Base', {\n  extend: qx.core.Object,\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   * @param   node    {Node} the group-node\n   * @param   schema  {cv.ui.manager.model.Schema}  the corresponding schema\n   */\n  construct: function (node, schema) {\n    this.base(arguments);\n    this.setNode(node);\n    this.setSchema(schema);\n    this._bounds = {\n      min: undefined,\n      max: undefined\n    };\n    this._allowedElements = {};\n    this._sortedContent = [];\n    this._subGroupings = [];\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    /**\n     * type of this object\n     * @var string\n     */\n    type: {\n      check: 'String',\n      init: 'unknown'\n    },\n    elementsHaveOrder: {\n      check: 'Boolean',\n      init: false\n    },\n    schema: {\n      check: 'cv.ui.manager.model.Schema',\n      nullable: false\n    },\n    node: {\n      check: 'Node',\n      nullable: false\n    },\n    /**\n     * array of sub-choices, -sequences, -groups that are defined\n     * @var array\n     */\n    subGroupings: {\n      check: 'Array'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * bounds for this element\n     * @var object\n     */\n    _bounds: null,\n\n    /**\n     * cache for getRegex\n     * @var string\n     */\n    _regexCache: null,\n\n    /**\n     * list of elements that are allowed as per our own definition\n     * @var object\n     */\n    _allowedElements: null,\n\n    /**\n     * the sorted listed of allowed elements and sub-groupings\n     * @var array\n     */\n    _sortedContent: null,\n\n    /**\n     * array of sub-choices, -sequences, -groups that are defined\n     * @var array\n     */\n    _subGroupings: null,\n\n    /// needs to be implemented by the inheriting classes\n    parse: function () {\n      const n = this.getNode();\n      let min = n.hasAttribute('minOccurs') ? n.getAttribute('minOccurs') : 1; // default is 1\n      let max = n.hasAttribute('maxOccurs') ? n.getAttribute('maxOccurs') : 1; // default is 1\n      this._bounds = {\n        min: parseInt(min),\n        max: max === 'unbounded' ? Number.POSITIVE_INFINITY : parseInt(max)\n      };\n    },\n\n    /**\n     * is an element (specified by its name) allowed in this group?\n     * Goes recursive.\n     * Does NOT check bounds! Does NOT check dependencies!\n     *\n     * @param   element string  the element we check for\n     * @return  boolean         is it allowed?\n     */\n    isElementAllowed: function (element) {\n      if (typeof this._allowedElements[element] !== 'undefined') {\n        // this element is immediately allowed\n        return true;\n      }\n\n      // go over the list of subGroupings and check, if the element is allowed with any of them\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        if (this._subGroupings[i].isElementAllowed(element) === true) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    /**\n     * get the SchemaElement-object for a certain element-name.\n     * May return undefined if no element is found, so you might be interested in checking isElementAllowed beforehand.\n     *\n     * @param   elementName string  name of the element to find the SchemaElement for\n     * @return  object              SchemaElement-object, or undefined if none is found\n     */\n    getSchemaElementForElementName: function (elementName) {\n      if (typeof this._allowedElements[elementName] != 'undefined') {\n        // this element is immediately allowed\n        return this._allowedElements[elementName];\n      }\n\n      // go over the list of sub-choices and check, if the element is allowed with them\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        if (this._subGroupings[i].isElementAllowed(elementName) === true) {\n          // this element is allowed\n          return this._subGroupings[i].getSchemaElementForElementName(elementName);\n        }\n      }\n\n      // can not find any reason why elementName is allowed with us...\n      return undefined;\n    },\n\n\n    /**\n     * get a list of required elements.\n     * if an element is required multiple times, it is listed multiple times\n     * Attention: elements are NOT sorted.\n     *\n     * @return  array   list of required elements\n     */\n    getRequiredElements: function () {\n      // we do know what we require. might not be too easy to find out, but ok\n\n      // if we have no lower bounds, then nothing is required\n      if (this._bounds.min === 0) {\n        return [];\n      }\n\n      const requiredElements = [];\n\n      // my own elements\n      for (const [name, item] of Object.entries(this._allowedElements)) {\n        if (item.getBounds().min > 0) {\n          for (let i = 0; i < item.getBounds().min; ++i) {\n            requiredElements.push(name);\n          }\n        }\n      }\n\n      // elements of our sub-groupings, if any\n      this._subGroupings.forEach(grouping => {\n        const subRequiredElements = grouping.getRequiredElements();\n\n        if (subRequiredElements.length > 0) {\n          for (let i = 0; i < subRequiredElements.length; ++i) {\n            requiredElements.push(subRequiredElements[i]);\n          }\n        }\n      });\n\n      return requiredElements;\n    },\n\n    /**\n     * get the elements allowed for this group\n     *\n     * @return  object      list of allowed elements, key is the name\n     */\n    getAllowedElements: function () {\n      const myAllowedElements = {};\n\n      for (const [name, item] of Object.entries(this._allowedElements)) {\n        myAllowedElements[name] = item;\n      }\n\n      // also the elements allowed by our sub-choices etc.\n      this._subGroupings.forEach(grouping => {\n        Object.assign(myAllowedElements, grouping.getAllowedElements());\n      });\n\n      return myAllowedElements;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * @param   sortNumber  integer the sort number of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      return {};\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      return '';\n    },\n\n\n    /**\n     * find out if this Grouping has multi-level-bounds, i.e. sub-groupings with bounds.\n     * This makes it more or less impossible to know in advance which elements might be needed\n     *\n     * @return  boolean does it?\n     */\n    hasMultiLevelBounds: function () {\n      return this._subGroupings.length > 0;\n    },\n\n\n    /**\n     * get the bounds of this very grouping\n     *\n     * @return  object  like {min: x, max: y}\n     */\n    getBounds: function () {\n      return this._bounds;\n    },\n\n\n    /**\n     * get bounds for a specific element.\n     * Take into account the bounds of the element and/or our own bounds\n     *\n     * @param   childName   string  name of the child-to-be\n     * @return  object              {max: x, min: y}, or undefined if none found\n     */\n    getBoundsForElementName: function (childName) {\n      return this._bounds;\n    },\n\n    /**\n     * create a regex-object from a pattern\n     *\n     * For some obscure reason, this may not be inside a classes method, or else that class is not instantiateable\n     *\n     * @param   input       string  the pattern to match (without //)\n     * @param   modifiers   string  modifiers, if any\n     * @return  object              RegExp-object\n     */\n    regexFromString: function (input, modifiers) {\n      if (modifiers === undefined) {\n        modifiers = '';\n      }\n\n      return new RegExp(input, modifiers);\n    }\n  }\n});\n","/* MAnnotation.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Code the extract data from annotations (e.g. appinfo, documentation) in Element/Attribute\n */\nqx.Mixin.define('cv.ui.manager.model.schema.MAnnotation', {\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.__linkRegex = new RegExp(':ref:[`\\'](.+?)[`\\']', 'g');\n    this.__language = qx.locale.Manager.getInstance().getLanguage() === 'de' ? 'de' : 'en';\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * cache for getAppinfo\n     * @var array\n     */\n    __appInfoCache: null,\n    __linkRegex: null,\n    __language: null,\n\n    /**\n     * cache for getDocumentation\n     * @var array\n     */\n    __documentationCache: null,\n\n    __getTextNodesByXPath: function (node, xpath) {\n      const texts = [];\n      const doc = node.ownerDocument;\n      const nsResolver = doc.createNSResolver(doc.documentElement);\n      let iterator = doc.evaluate(xpath, node, nsResolver, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);\n      try {\n        let thisNode = iterator.iterateNext();\n\n        while (thisNode) {\n          texts.push(thisNode.textContent.replaceAll(/``([^`]+)``/g, '<code>$1</code>'));\n          thisNode = iterator.iterateNext();\n        }\n      } catch (e) {\n        this.error('Error: Document tree modified during iteration ' + e);\n      }\n      return texts;\n    },\n\n    /**\n     * get the appinfo information from the element, if any\n     *\n     * @return  array   list of texts, or empty list if none\n     */\n    getAppinfo: function () {\n      if (this.__appInfoCache !== null) {\n        return this.__appInfoCache;\n      }\n      const node = this.getNode();\n      const appInfo = this.__getTextNodesByXPath(node, 'xsd:annotation/xsd:appinfo');\n      const type = this.getType();\n      if (type === 'element') {\n        // only aggregate types appinfo if it is not an immediate child of the element-node, but referenced/typed\n        if (node.querySelectorAll(':scope > complexType').length === 0) {\n          appInfo.push(...this.__getTextNodesByXPath(this._type, 'xsd:annotation/xsd:appinfo'));\n        }\n      } else if (type === 'attribute') {\n        if (node.hasAttribute('ref')) {\n          // the attribute is a reference, so take appinfo from there, too\n\n          const refName = node.getAttribute('ref');\n          const ref = this.getSchema().getReferencedNode('attribute', refName);\n\n          appInfo.push(...this.__getTextNodesByXPath(ref, 'xsd:annotation/xsd:appinfo'));\n        }\n      }\n\n      // fill the cache\n      this.__appInfoCache = appInfo;\n\n      return appInfo;\n    },\n\n    /**\n     * get the documentation information from the element, if any\n     *\n     * @return  array   list of texts, or empty list if none\n     */\n    getDocumentation: function () {\n      if (this.__documentationCache !== null) {\n        return this.__documentationCache;\n      }\n      const node = this.getNode();\n\n      const lang = qx.locale.Manager.getInstance().getLanguage();\n      const selector = 'xsd:annotation/xsd:documentation[@xml:lang=\\'' + lang + '\\']';\n\n      // any appinfo this element itself might carry\n      let documentation = this.__getTextNodesByXPath(node, selector);\n\n      const type = this.getType();\n      if (type === 'element') {\n        // only aggregate types appinfo if it is not an immediate child of the element-node, but referenced/typed\n        if (node.querySelectorAll(':scope > complexType').length === 0) {\n          documentation.push(...this.__getTextNodesByXPath(this._type, selector));\n        }\n      } else if (type === 'attribute') {\n        if (node.hasAttribute('ref')) {\n          // the attribute is a reference, so take appinfo from there, too\n\n          const refName = node.getAttribute('ref');\n          const ref = this.getSchema().getReferencedNode('attribute', refName);\n\n          documentation.push(...this.__getTextNodesByXPath(ref, selector));\n\n          documentation = documentation.map(entry => this.createDocumentationWebLinks(entry));\n        }\n      }\n      this.__documentationCache = documentation;\n\n      return documentation;\n    },\n\n\n    /**\n     * Transform documentation text to link to the online documentation when it\n     * contains a reference.\n     * @param text\n     * @return string The transformed input string.\n     */\n    createDocumentationWebLinks: function (text) {\n      const language = this.__language;\n      return text.replace(this.__linkRegex, function(match, contents) {\n        const reference = contents.match(/^(.*?) *<([^<]*)>$/);\n        const label = reference ? reference[1] : contents;\n        const key = reference ? reference[2] : contents;\n        const link = cv.ui.manager.model.schema.DocumentationMapping.MAP[key];\n        if (link) {\n          return '<a class=\"doclink\" target=\"_blank\" href=\"' + cv.ui.manager.model.schema.DocumentationMapping.MAP._base + language + link + '\">' + label + '</a>';\n        }\n        return label;\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__appInfoCache = null;\n    this.__documentationCache = null;\n    this.__linkRegex = null;\n  }\n});\n","/* Element.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * a single element from the schema\n */\nqx.Class.define('cv.ui.manager.model.schema.Element', {\n  extend: cv.ui.manager.model.schema.Base,\n  include: cv.ui.manager.model.schema.MAnnotation,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Get the name of a schema-element\n     * @param e object  element to find the name of\n     * @param schema\n     * @return  string          name of the element\n     * @throws  if the name can not be found\n     */\n    getElementName: function(e, schema) {\n      if (e.hasAttribute('name')) {\n        return e.getAttribute('name');\n      }\n\n      if (e.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = e.getAttribute('ref');\n        const ref = schema.getReferencedNode('element', refName);\n\n        if (ref.length !== 1) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n\n        return ref.getAttribute('name');\n      }\n\n      return 'unknown';\n    },\n\n    /**\n     * find the type-node for this element\n     * @param node\n     * @param schema\n     * @return  object  object of the type-Node\n     */\n    getTypeNode: function (node, schema) {\n      let type;\n\n      if (node.hasAttribute('type')) {\n        if (node.getAttribute('type').match(/^xsd:/)) {\n          // if it starts with xsd:, it's actually a simple type\n          // does not start with\n          type = node;\n        } else {\n          // otherwise, the element is linked to a complexType\n          type = schema.getTypeNode('complex', node.getAttribute('type'));\n        }\n      } else if (node.hasAttribute('ref')) {\n        // the link is a reference to another element, which means it does not even have it's own name.\n        // this one is most certainly deprecated, as we do not have many root-level-elements, and only those can\n        // be ref'ed\n      } else {\n        // the element is it's own type\n        type = node.querySelector(':scope > complexType');\n      }\n\n      return type;\n    },\n\n    sortChildNodes: function (sorting) {\n      /**\n       * the comparison-function that helps the sorting\n       *\n       * @param   a   mixed   whatever sort gives us\n       * @param   b   mixed   whatever sort gives us\n       * @return  integer     -1, 0, 1 - depending on sort-order\n       */\n      return function (a, b) {\n        let aSortvalue = sorting[a.name];\n        let bSortvalue = sorting[b.name];\n\n        if (aSortvalue === undefined || bSortvalue === undefined) {\n          // undefined means: no sorting available\n          return 0;\n        }\n\n        if (aSortvalue === bSortvalue) {\n          // identical means 'no sorting necessary'\n          return 0;\n        }\n\n        // we need to go through the complete list of values the sorting is composed of,\n        // to find the first one that distinguishes a from b\n\n        // first, typecast to string!\n        if (typeof aSortvalue !== 'string') {\n          aSortvalue = aSortvalue.toString();\n        }\n        if (typeof bSortvalue !== 'string') {\n          bSortvalue = bSortvalue.toString();\n        }\n\n        let aSortvaluesList = aSortvalue.split('.');\n        let bSortvaluesList = bSortvalue.split('.');\n\n        for (let i = 0; i < aSortvaluesList.length; ++i) {\n          if (aSortvaluesList[i] < bSortvaluesList[i]) {\n            return -1;\n          } else if (aSortvaluesList[i] > bSortvaluesList[i]) {\n            return 1;\n          }\n        }\n\n        // if nothing else matched, then they are treated equal\n        return 0;\n      };\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'element'\n    },\n\n    name: {\n      check: 'String',\n      init: ''\n    },\n\n    defaultValue: {\n      check: 'String',\n      nullable: true\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeSortable'\n    },\n\n    mixed: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __allowedContentLoaded: false,\n    __allowedContent: null,\n    __allowedAttributes: null,\n    __textNodeSchemaElement: null,\n\n    /**\n     * get and set the type-node for the element\n     * @var object  Type-Node (most certainly a complexType)\n     */\n    _type: null,\n\n    parse: function () {\n      this.base(arguments);\n      const node = this.getNode();\n      const schema = this.getSchema();\n\n      this._type = cv.ui.manager.model.schema.Element.getTypeNode(node, schema);\n      this.setName(cv.ui.manager.model.schema.Element.getElementName(node, schema));\n      if (node.hasAttribute('default')) {\n        this.setDefaultValue(node.getAttribute('default'));\n      }\n      this.setMixed(this._type.hasAttribute('mixed') && this._type.getAttribute('mixed') === 'true');\n    },\n\n    /**\n     * get a list of allowed elements for this element\n     *\n     * @return  object  object of SchemaElement-elements, key is the name\n     */\n    getAllowedContent: function () {\n      if (this.__allowedContent !== null) {\n        // if we have parsed this already, we can simply return the 'cache'\n        return this.__allowedContent;\n      }\n      const schema = this.getSchema();\n\n      const allowedContent = {\n        _grouping: undefined,\n        _text: false\n      };\n\n      // allowed sub-elements\n      // can be either simpleContent, or (choice|sequence|group|all)?\n      // 'all' is not supported yet.\n\n      if (this._type.querySelectorAll(':scope > simpleContent').length > 0) {\n        // it's simpleContent? Then it's either extension or restriction\n        // anyways, we will handle it, as if it were a simpleType\n        allowedContent._text = new cv.ui.manager.model.schema.SimpleType(this._type.querySelector(':scope > simpleContent'), schema);\n      } else if (this._type.querySelectorAll('complexType > choice, complexType> sequence, complexType > group').length > 0) {\n        // we have a choice, group or sequence. great\n        // as per the W3C, only one of these may appear per element/type\n\n        let tmpDOMGrouping = this._type.querySelector('complexType > choice, complexType > sequence, complexType > group');\n\n        // create the appropriate Schema*-object and append it to this very element\n        switch (tmpDOMGrouping.nodeName) {\n          case 'xsd:choice':\n          case 'choice':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Choice(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:sequence':\n          case 'sequence':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Sequence(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:group':\n          case 'group':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Group(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:any':\n          case 'any':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Any(tmpDOMGrouping, schema);\n            break;\n        }\n      } else if (this._type.hasAttribute('type') && this._type.getAttribute('type').match(/^xsd:/)) {\n        // this is a really simple node that defines its own baseType\n        allowedContent._text = new cv.ui.manager.model.schema.SimpleType(this._type, schema);\n      } else {\n        // no type, no children, no choice - this is an element with NO allowed content/children\n        this.__allowedContent = allowedContent;\n        return allowedContent;\n      }\n\n\n      const children = Array.from(this._type.querySelectorAll(':scope > element'));\n      children.forEach(sub => {\n        const subElement = new cv.ui.manager.model.schema.Element(sub, schema);\n        allowedContent[subElement.getName()] = subElement;\n      });\n\n      // fill the cache\n      this.__allowedContent = allowedContent;\n\n      return allowedContent;\n    },\n\n    /**\n     * get and set the list of allowed attributes\n     * @var array   List of SchemaAttribute-objects\n     */\n    getAllowedAttributes: function () {\n      if (this.__allowedAttributes === null) {\n        const allowedAttributes = {};\n\n        // allowed attributes\n        const attributes = Array.from(this._type.querySelectorAll(':scope > attribute, :scope > simpleContent > extension > attribute'));\n\n        // now add any attribute that comes from an attribute-group\n        const attributeGroups = Array.from(this._type.querySelectorAll(':scope > attributeGroup, :scope > simpleContent > extension > attributeGroup'));\n\n        attributeGroups.forEach(aGroup => {\n          // get get group itself, by reference if necessary\n          // then extract all attributes, and add them to the list of already know attributes\n\n          let attributeGroup = {};\n          if (aGroup.hasAttribute('ref')) {\n            // we do have a reffed group\n            attributeGroup = this.getSchema().getReferencedNode('attributeGroup', aGroup.getAttribute('ref'));\n          } else {\n            attributeGroup = aGroup;\n          }\n\n          Array.from(attributeGroup.querySelectorAll(':scope > attribute')).forEach(child => {\n            attributes.push(child);\n          });\n        });\n\n        // convert all allowed attributes to a more object-oriented approach\n        attributes.forEach(attr => {\n          const attribute = new cv.ui.manager.model.schema.Attribute(attr, this.getSchema());\n          allowedAttributes[attribute.getName()] = attribute;\n        });\n\n        this.__allowedAttributes = allowedAttributes;\n      }\n      return this.__allowedAttributes;\n    },\n\n    /**\n     * are this elements children sortable? this is not the case if a sequence is used, e.g.\n     *\n     * @return  boolean     are children sortable?\n     */\n    areChildrenSortable: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        return true;\n      }\n\n      // the inverse of \"do the elements have a given order?\"\n      return !allowedContent._grouping.getElementsHaveOrder();\n    },\n\n    /**\n     * get a list of required elements.\n     * if an element is required multiple times, it is listed multiple times\n     *\n     * @return  array   list of required elements\n     */\n    getRequiredElements: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping !== undefined) {\n        // we do have a grouping as a child\n        return allowedContent._grouping.getRequiredElements();\n      }\n\n      // there is no grouping, hence no elements defined as children\n      return [];\n    },\n\n    /**\n     * get a list of all allowed elements for this element\n     * @param excludeComment\n     * @return  object  list of SchemaElement-elements, key is the name\n     */\n    getAllowedElements: function (excludeComment) {\n      const allowedContent = this.getAllowedContent();\n\n      const allowedElements = {};\n      if (allowedContent._grouping !== undefined) {\n        Object.assign(allowedElements, allowedContent._grouping.getAllowedElements());\n      }\n\n      let textOnly = false;\n      if (this.isMixed()) {\n        // mixed elements are allowed to have #text-nodes\n        allowedElements['#text'] = this.getSchema().getTextNodeSchemaElement();\n      } else if (allowedContent._text && allowedContent._grouping === undefined) {\n        // text only\n        allowedElements['#text'] = allowedContent._text;\n        textOnly = true;\n      }\n\n      if (!textOnly && !excludeComment) {\n        // although its basically allowed to add comments in a text-only content, we do not allow it\n        allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n      }\n\n      return allowedElements;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     *\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping !== undefined) {\n        return allowedContent._grouping.getAllowedElementsSorting();\n      }\n\n      return undefined;\n    },\n\n    getFirstLevelElementSorting: function () {\n      const allowedSorting = this.getAllowedElementsSorting();\n      if (allowedSorting) {\n        // we only care about the first level here\n        Object.keys(allowedSorting).forEach(name => {\n          let sort = allowedSorting[name];\n          if (typeof sort === 'string') {\n            sort = parseInt(sort.split('.')[0]);\n          }\n          allowedSorting[name] = sort;\n        });\n      }\n      return allowedSorting;\n    },\n\n    /**\n     * get the bounds for this elements children (as defined by a choice)\n     *\n     * @return  object  bounds ({min: x, max: y})\n     */\n    getChildBounds: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // no choice = no idea about bounds\n        return undefined;\n      }\n\n      if (allowedContent._grouping.hasMultiLevelBounds() === true) {\n        // if our choice has sub-choices, then we have not fucking clue about bounds (or we can not process them)\n        return undefined;\n      }\n\n      return allowedContent._grouping.getBounds();\n    },\n\n    /**\n     * get the bounds for a specific element-name\n     * will go through all of the groupings-tree to find out, just how many elements of this may appear\n     *\n     * @param   childName   string  name of the child-to-be\n     * @return  object              {min: x, max: y}\n     */\n    getBoundsForElementName: function (childName) {\n      const allowedContent = this.getAllowedContent();\n\n      return allowedContent._grouping.getBoundsForElementName(childName);\n    },\n\n    /**\n     * check if a text-only-node is allowed ...\n     *\n     * @return  boolean\n     */\n    isTextContentAllowed: function () {\n      if (this.isMixed()) {\n        // mixed means that we allow for text-content\n        return true;\n      }\n\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._text !== undefined && allowedContent._text !== false) {\n        // if _text is defined and there, we assume that text-content is allowed\n        return true;\n      }\n\n      // had no reason to allow text-content, so gtfoml!\n      return false;\n    },\n\n    isTextContentRequired: function () {\n      if (this.isTextContentAllowed()) {\n        return !this.isMixed() && !this.getAllowedContent()._text.isValueValid('');\n      }\n      return false;\n    },\n\n    /**\n     * check if an element (specified by its name) is allowed as one of our immediate children\n     * Goes recursive if we have choices.\n     *\n     * @param   child   string  name of the element we want to check\n     * @return  boolean         is this element allowed?\n     */\n    isChildElementAllowed: function (child) {\n      if (child === '#text' || child === '#cdata-section') {\n        // text-nodes are somewhat special :)\n        return this.isTextContentAllowed();\n      } else if (child === '#comment') {\n        return true;\n      }\n\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // when there is no choice, then there is no allowed element\n        return false;\n      } \n        // see, if this child is allowed with our choice\n        return allowedContent._grouping.isElementAllowed(child);\n    },\n\n\n    /**\n     * get the SchemaElement-object for a certain element-name.\n     * May return undefined if no element is found, so you might be interested in checking isElementAllowed beforehand.\n     *\n     * @param   elementName string  name of the element to find the SchemaElement for\n     * @return  object              SchemaElement-object, or undefined if none is found\n     */\n    getSchemaElementForElementName: function (elementName) {\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (elementName === '#text' || elementName === '#cdata-section') {\n        // no special handling for mixed nodes, they do have a #text-SchemaElement already!\n        // text-nodes may be allowed. we will see ...\n        if (this.isTextContentAllowed() === false) {\n          return undefined;\n        }\n\n        if (!this.__textNodeSchemaElement) {\n          const tmpXML = this.getSchema().getSchemaDOM().createElement('element');\n          tmpXML.setAttribute('name', '#text');\n          tmpXML.setAttribute('type', 'xsd:string');\n          this.__textNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this.getSchema());\n          if (allowedContent._text) {\n            this.__textNodeSchemaElement.getAllowedContent()._text = allowedContent._text;\n          } else if (this.isMixed()) {\n            this.__textNodeSchemaElement.getAllowedContent._text = this.getSchema().getTextNodeSchemaElement();\n          }\n        }\n        return this.__textNodeSchemaElement;\n      } else if (elementName === '#comment') {\n        // comments are always allowed\n        return this.getSchema().getCommentNodeSchemaElement();\n      }\n\n      if (allowedContent._grouping === undefined) {\n        // when there is no choice, then there is no allowed element\n        return undefined;\n      }\n\n      // go over our choice, if the element is allowed with it\n      if (allowedContent._grouping.isElementAllowed(elementName)) {\n        // only look in this tree, if the element is allowed there.\n        return allowedContent._grouping.getSchemaElementForElementName(elementName);\n      }\n\n      return undefined;\n    },\n\n    /**\n     * return the DOM this Schema is based on\n     *\n     * @return  object  DOM of $xsd\n     */\n    getSchemaDOM: function () {\n      return this.getSchema().getSchemaDOM();\n    },\n\n    /**\n     * check if a given value is valid for this element\n     *\n     * @param   value   string  value to check\n     * @return  boolean         is it valid?\n     */\n    isValueValid: function (value) {\n      if (this.isTextContentAllowed() === false) {\n        // if no text-content is allowed, then it can not be valid\n        return false;\n      }\n\n      if (this.isMixed()) {\n        // mixed is always good!\n        return true;\n      }\n\n      const allowedContent = this.getAllowedContent();\n\n      return allowedContent._text.isValueValid(value);\n    },\n\n    /**\n     * create and retrieve the part of a regular expression which describes this very element\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string\n     */\n    getRegex: function (separator, nocapture) {\n      if (typeof separator === 'undefined' || separator === undefined) {\n        // default to an empty string\n        separator = '';\n      }\n\n      let regexString = '(';\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      // start with the name of the element\n      regexString += this.getName() + separator + ')';\n\n      // append bounds\n      let boundsMin = '';\n      let boundsMax = '';\n      const bounds = this.getBounds();\n      if (bounds.min !== undefined) {\n        boundsMin = bounds.min;\n      }\n\n      if (bounds.max !== undefined) {\n        if (bounds.max !== Number.POSITIVE_INFINITY) {\n          boundsMax = bounds.max;\n        }\n      }\n\n      if (boundsMin !== '' || boundsMax !== '') {\n        // append bounds to the regex-string\n        regexString += '{' + boundsMin + ',' + boundsMax + '}';\n      }\n\n      // and thats all\n      return regexString;\n    },\n\n    /**\n     * create a full-blown regular expression that describes this elements immediate children\n     * @param separator   string  the string used to separate different elements, e.g. ';'\n     * @param nocapture\n     * @return  string              the regular expression\n     */\n    getChildrenRegex: function(separator, nocapture) {\n      if (typeof separator == 'undefined' || separator === undefined) {\n        // default to an empty string\n        separator = '';\n      }\n\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // not really something to match\n        return '^';\n      }\n\n      return allowedContent._grouping.getRegex(separator, nocapture);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeMap('__allowedAttributes');\n    this._disposeMap('__allowedContent');\n    this._disposeObjects('__textNodeSchemaElement');\n  }\n});\n","/* XmlElement.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Represents an Element or TextNode in an XML document\n */\nqx.Class.define('cv.ui.manager.model.XmlElement', {\n  extend: qx.core.Object,\n  include: [\n    qx.data.marshal.MEventBubbling\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schemaElement, editor, parent) {\n    this.base(arguments);\n    this._node = node;\n    const children = new qx.data.Array();\n    if (node) {\n      this._node.$$widget = this;\n      this.setSchemaElement(schemaElement);\n      this.initName(node.nodeName);\n      this._updateShowEditButton();\n      if (this.hasChildren()) {\n        // we have to add a fake node to the children to show the tree that this node has children\n        // it will be removed when the real children are loaded\n        children.push(new cv.ui.manager.model.XmlElement());\n      }\n      if (editor) {\n        this.setEditor(editor);\n      }\n      if (parent) {\n        this.setParent(parent);\n      }\n      this._maintainIcon();\n      this._maintainStatus();\n    } else {\n      // this is a fake node needed for children simulation\n      this.initName('#temp');\n    }\n    this.initChildren(children);\n    this._initialAttributes = new Map();\n    this.bind('editor.file.writeable', this, 'editable');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    entityMap: {\n      '&': '&amp;',\n      '\"': '&quot;',\n      '\\'': '&#39;',\n      '`': '&#x60;'\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    // the current editor this element os shown in\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      event: 'changeEditor'\n    },\n    schemaElement: {\n      check: 'cv.ui.manager.model.schema.Element',\n      apply: '_applySchemaElement'\n    },\n    name: {\n      check: 'String',\n      deferredInit: true,\n      event: 'changeName',\n      apply: 'updateDisplayName'\n    },\n    displayName: {\n      check: 'String',\n      init: '',\n      event: 'changeDisplayName'\n    },\n    open : {\n      check : 'Boolean',\n      event : 'changeOpen',\n      init : false,\n      apply : '_onOpen'\n    },\n    loaded : {\n      check : 'Boolean',\n      event : 'changeLoaded',\n      init : false\n    },\n    children : {\n      check : 'qx.data.Array',\n      event : 'changeChildren',\n      apply: '_applyEventPropagation',\n      deferredInit : true\n    },\n\n    textContent: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyTextContent',\n      event: 'changeTextContent',\n      validate: '_validateTextContent'\n    },\n    /**\n     * Temporary nodes are not save in the backend yet\n     */\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTemporary'\n    },\n\n    /**\n     * Validation result for this nodes content\n     */\n    valid: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeValid',\n      apply: '_applyValid'\n    },\n\n    invalidMessage: {\n      check: 'String',\n      init: '',\n      event: 'changeInvalidMessage'\n    },\n\n    status: {\n      check: ['error', 'valid', 'comment'],\n      init: 'valid',\n      event: 'changeStatus'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeEditable',\n      apply: '_applyEditable'\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeSortable'\n    },\n\n    /**\n     * true if this element can be deleted (either no bounds.min or more existing elements)\n     */\n    deletable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeDeletable'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyModified'\n    },\n\n    showEditButton: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeShowEditButton'\n    },\n    parent: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true\n    },\n\n    // icon to show in the tree\n    icon: {\n      check: 'String',\n      nullable: true,\n      event: 'changeIcon'\n    },\n\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _node: null,\n    _schema: null,\n    _schemaElement: null,\n    _initialAttributes: null,\n    _initialChildNames: null,\n    _initialTextContent: null,\n    __initializing: false,\n    __addableChildren: null,\n    _structure: null,\n\n    _maintainStatus: function () {\n      if (this._node.nodeType === Node.COMMENT_NODE) {\n        this.setStatus('comment');\n      } else if (!this.isValid()) {\n        this.setStatus('error');\n      } else {\n        this.setStatus('valid');\n      }\n    },\n\n    _applyValid: function (value) {\n      this._maintainStatus();\n      if (value) {\n        this.resetInvalidMessage();\n      }\n    },\n\n    convertTextNodeType: function (newType) {\n      if (this.isTextNode() && this._node.nodeType !== newType && (newType === Node.TEXT_NODE || newType === Node.CDATA_SECTION_NODE)) {\n        const content = this.getText();\n        const oldNode = this._node;\n        const newTextNode = newType === Node.CDATA_SECTION_NODE ? this._node.ownerDocument.createCDATASection(content) : this._node.ownerDocument.createTextNode(content);\n        if (oldNode.parentNode) {\n          oldNode.parentNode.replaceChild(newTextNode, oldNode);\n        }\n        this._node = newTextNode;\n        this.setName(this._node.nodeName);\n        this.load(true);\n      }\n    },\n\n    _maintainIcon: function () {\n      if (this._node) {\n        if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n          this.setIcon(cv.theme.dark.Images.getIcon('text-fields', 18));\n          return;\n        } else if (this._node.nodeType === Node.COMMENT_NODE) {\n          this.setIcon(cv.theme.dark.Images.getIcon('comment-fields', 18));\n          return;\n        } else if (this.getName() === 'icon' && this.getAttribute('name') && this.getAttribute('name').indexOf('{{') === -1) {\n          // try to use the configured icon (if its not set by a template variable)\n          const source = cv.IconHandler.getInstance().getIconSource(this.getAttribute('name'), 'tree-icon');\n          if (source) {\n            this.setIcon(source);\n          } else {\n            this.setIcon(cv.theme.dark.Images.getIcon('image', 18));\n          }\n          return;\n        }\n      }\n      if (this.isOpen()) {\n        this.setIcon(cv.theme.dark.Images.getIcon('folder-open', 18));\n      } else {\n        this.setIcon(cv.theme.dark.Images.getIcon('folder', 18));\n      }\n    },\n\n    _applyEditable: function () {\n      this._updateShowEditButton();\n      this.updateDeletable();\n    },\n\n    _updateShowEditButton: function () {\n      const schemaElement = this.getSchemaElement();\n      this.setShowEditButton(\n        schemaElement.isTextContentAllowed() && this.getName().startsWith('#') ||\n        Object.keys(schemaElement.getAllowedAttributes()).length > 0 ||\n        schemaElement.isChildElementAllowed('*') // any element allowed, this is edited as text (outerHTML)\n      );\n    },\n\n    updateDeletable: function () {\n      if (!this.isEditable()) {\n        this.setDeletable(false);\n      } else {\n        const parent = this.getParent();\n        if (this.isTextNode()) {\n          if (this.getSchemaElement().isTextContentRequired()) {\n            const existing = parent.getChildren().filter(child => child.isTextNode()).length;\n            this.setDeletable(existing > 1);\n          } else {\n            this.setDeletable(true);\n          }\n        } else {\n          let deletable = false;\n          if (parent) {\n            const schemaElement = parent.getSchemaElement();\n            const requiredFromParent = schemaElement.getRequiredElements();\n            if (requiredFromParent.includes(this.getName())) {\n              const bounds = schemaElement.getBoundsForElementName(this.getName());\n              if (bounds) {\n                const existing = parent.getChildren().filter(child => child.getName() === this.getName()).length;\n                // check if we can afford to delete one\n                deletable = (bounds.min <= existing - 1);\n              } else {\n                deletable = true;\n              }\n            } else {\n              deletable = true;\n            }\n          } else {\n            deletable = true;\n          }\n          this.setDeletable(deletable);\n        }\n      }\n    },\n\n    getNode: function () {\n      return this._node;\n    },\n\n    remove: function (skipUndo) {\n      const parent = this.getParent();\n      if (parent) {\n        const changes = [{\n          index: parent.getChildren().indexOf(this),\n          parent: parent,\n          child: this\n        }];\n        this._node.remove();\n        parent.getChildren().remove(this);\n        const editor = this.getEditor();\n        this.$$removed = true;\n        if (editor) {\n          // editor should not consider the modification state of removed elements\n          editor.updateModified(this);\n        }\n        parent.updateModified();\n        if (!skipUndo) {\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Remove %1', this.getDisplayName()), this, changes, 'deleted');\n            editor.addUndo(change);\n          }\n        }\n      }\n    },\n\n    /**\n     * Check is this element is an ancestor of the given element\n     * @param element {cv.ui.manager.model.XmlElement} element to check\n     * @returns {boolean}\n     */\n    isAncestor: function (element) {\n      let parent = element.getParent();\n      while (parent) {\n        if (parent === this) {\n          return true;\n        }\n        parent = parent.getParent();\n      }\n      return false;\n    },\n\n    /**\n     * Move this node to a new position in relation to the target\n     * @param target {cv.ui.manager.model.XmlElement} new direct sibling\n     * @param position {String} more 'before', 'after' or 'inside' target\n     * @param skipUndo {Boolean} no not add an undo operation for this\n     * @private\n     */\n    _move: function (target, position, skipUndo) {\n      if (this.isAncestor(target)) {\n        // we cannot move into ourselves descendants\n        return false;\n      }\n      if (target === this) {\n        // do not move ourselves before, after or inside ourselves\n        return false;\n      }\n      const parent = this.getParent();\n      const children = parent.getChildren();\n      const targetParent = position === 'inside' ? target : target.getParent();\n      const targetChildren = targetParent.getChildren();\n      const changes = [{\n        oldIndex: children.indexOf(this),\n        oldParent: parent,\n        parent: targetParent,\n        child: this,\n        index: targetChildren.indexOf(target) + (position === 'after' ? 1 : 0)\n      }];\n      if ((position === 'inside' && targetParent.getSchemaElement().isChildElementAllowed(this.getName())) || targetParent.isChildAllowedAtPosition(this, changes[0].index)) {\n        children.remove(this);\n        this.getNode().remove();\n        if (targetParent === parent) {\n          // target index might have changed by removing\n          changes[0].index = targetChildren.indexOf(target) + (position === 'after' ? 1 : 0);\n        }\n        targetParent.insertChild(this, changes[0].index, true, 'moved');\n        if (!skipUndo) {\n          const editor = this.getEditor();\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Move %1', this.getDisplayName()), this, changes, 'moved');\n            editor.addUndo(change);\n          }\n        }\n        return true;\n      }\n      return false;\n    },\n\n    moveTo: function (newParent, index, skipUndo) {\n      if (this.isAncestor(newParent)) {\n        // we cannot move into ourselves descendants\n        return false;\n      }\n      const parent = this.getParent();\n      const children = parent.getChildren();\n      const changes = [{\n        oldIndex: children.indexOf(this),\n        oldParent: parent,\n        parent: newParent,\n        child: this,\n        index: index\n      }];\n      // save old target index because we are moving inside the same parent, and the target index might change after removing\n      const target = newParent === parent && index < children.length ? children.getItem(index) : null;\n      if (newParent.isChildAllowedAtPosition(this, index)) {\n        children.remove(this);\n        this.getNode().remove();\n\n        if (target) {\n          index = children.indexOf(target);\n          changes[0].index = index;\n        }\n        newParent.insertChild(this, index, true, 'moved');\n        if (!skipUndo) {\n          const editor = this.getEditor();\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Move %1', this.getDisplayName()), this, changes, 'moved');\n            editor.addUndo(change);\n          }\n        }\n        return true;\n      }\n      return false;\n    },\n\n    moveAfter: function (target, skipUndo) {\n      return this._move(target, 'after', skipUndo);\n    },\n\n    moveBefore: function (target, skipUndo) {\n      return this._move(target, 'before', skipUndo);\n    },\n\n    moveInside: function (target, skipUndo) {\n      return this._move(target, 'inside', skipUndo);\n    },\n\n    insertAfter: function (target, skipUndo) {\n      const targetParent = target.getParent();\n      const newIndex = targetParent.getChildren().indexOf(target) + 1;\n      return targetParent.insertChild(this, newIndex, skipUndo, 'added');\n    },\n\n    insertBefore: function (target, skipUndo) {\n      const targetParent = target.getParent();\n      const newIndex = targetParent.getChildren().indexOf(target);\n      return targetParent.insertChild(this, newIndex, skipUndo, 'added');\n    },\n\n    /**\n     * Returns a list of element names that can be added to this element.\n     * Checks the allowed elements and their bounds and the existing children\n     * to find out if we can add more of them.\n     * @param excludeComment {Boolean} exclude #comment child when set to true\n     */\n    getAddableChildren: function(excludeComment) {\n      if (!this.__addableChildren) {\n        if (this.getName().startsWith('#')) {\n          this.__addableChildren = [];\n        } else {\n          const schemaElement = this.getSchemaElement();\n          const allowed = schemaElement.getAllowedElements();\n          const stillAllowed = [];\n          const countExisting = {};\n          if (!this.isLoaded()) {\n            this.load();\n          }\n          this.getChildren().forEach(child => {\n            if (!Object.prototype.hasOwnProperty.call(countExisting, child.getName())) {\n              countExisting[child.getName()] = 0;\n            }\n            countExisting[child.getName()]++;\n          });\n\n          Object.keys(allowed).forEach(elementName => {\n            if (excludeComment === true && elementName === '#comment') {\n              return;\n            }\n            if ((elementName === '#text' || elementName === '#cdata-section')) {\n              if (schemaElement.isTextContentAllowed()) {\n                if (schemaElement.isMixed()) {\n                  // is a mixed content has only one text child and no other childs, we do not allow another text child -> avoid direct text siblings\n                  let textNodes = 0;\n                  let otherNodes = 0;\n                  Object.keys(countExisting).forEach(key => {\n                    if (key === '#text' || key === '#cdata-section') {\n                      textNodes+=countExisting[key];\n                    } else {\n                      otherNodes+=countExisting[key];\n                    }\n                  });\n                  if (textNodes<=otherNodes) {\n                    // we do not allow more text nodes than other nodes (e.g. a sequence of #text, elem would allow another #text node after elem)\n                    stillAllowed.push(elementName);\n                  }\n                } else if (!Object.prototype.hasOwnProperty.call(countExisting, '#text') && !Object.prototype.hasOwnProperty.call(countExisting, '#cdata-section')) {\n                  stillAllowed.push(elementName);\n                }\n              }\n              return;\n            }\n            const childBounds = schemaElement.getBoundsForElementName(elementName);\n            const existing = Object.prototype.hasOwnProperty.call(countExisting, elementName) ? countExisting[elementName] : 0;\n            if (childBounds && childBounds.max > existing) {\n              stillAllowed.push(elementName);\n            }\n          });\n          this.__addableChildren = stillAllowed;\n        }\n      }\n      return this.__addableChildren;\n    },\n\n    /**\n     * Checks if a new child is allowed at the given position\n     * @param xmlElement {cv.ui.manager.model.XmlElement|String} the element or an element name as string\n     * @param index {Number} position to check, use Number.POSITIVE_INFINITY to check if the child is allowed to be appended\n     * @returns {boolean}\n     */\n    isChildAllowedAtPosition: function (xmlElement, index) {\n      const schemaElement = this.getSchemaElement();\n      const nodeName = xmlElement instanceof cv.ui.manager.model.XmlElement ? xmlElement.getName() : xmlElement;\n      if (!schemaElement.isChildElementAllowed(nodeName)) {\n        this.debug(nodeName, 'is not allowed as child of', this.getName());\n        return false;\n      }\n      if (schemaElement.areChildrenSortable()) {\n        // allowed at any position\n        return true;\n      }\n      // check position\n      const allowedSorting = schemaElement.getFirstLevelElementSorting();\n      if (!this.isLoaded()) {\n        this.load();\n      }\n      const children = this.getChildren();\n      if (children.length === 0) {\n        // no children yet, no position problem\n        return true;\n      }\n      let currentPosition = index;\n      if (children.length > index) {\n        currentPosition = allowedSorting[children.getItem(index).getName()];\n      } else {\n        currentPosition = children.length;\n      }\n      let targetPosition = allowedSorting[nodeName];\n      if (currentPosition === targetPosition || targetPosition >= children.length) {\n        // no special position\n        return true;\n      } \n        // find the first previous sibling of a different type\n        let previousSibling;\n        if (index > 0) {\n          for (let i = Math.min(index, children.length) - 1; i >= 0; i--) {\n            if (children.getItem(i).getName() !== nodeName) {\n              previousSibling = children.getItem(i).getName();\n              break;\n            }\n          }\n        }\n        if (previousSibling) {\n          currentPosition = allowedSorting[previousSibling];\n        }\n        // only allow if it can be inserted before\n        const allowed = currentPosition + 1 >= targetPosition;\n        if (!allowed) {\n          this.debug(nodeName, 'is not allowed as child of', this.getName());\n          return false;\n        }\n      \n      return true;\n    },\n\n    findPositionForChild: function(newChild) {\n      const schemaElement = this.getSchemaElement();\n      if (schemaElement.isChildElementAllowed(newChild.getName())) {\n        if (!this.isLoaded()) {\n          this.load();\n        }\n        if (schemaElement.areChildrenSortable()) {\n          // any position is fine, just append it to the end\n          return this.getChildren().length;\n        } \n          const allowedSorting = schemaElement.getFirstLevelElementSorting();\n          if (allowedSorting && Object.prototype.hasOwnProperty.call(allowedSorting, newChild.getName())) {\n            const position = allowedSorting[newChild.getName()];\n            // search for the first sibling with a position > than the newChilds and insert it there\n            let targetIndex = position;\n            const found = this.getChildren().some((child, index) => {\n              const childPos = allowedSorting[child.getName()];\n              if (childPos > position) {\n                targetIndex = index;\n                return true;\n              }\n              return false;\n            });\n            if (!found) {\n              // append to the end\n              targetIndex = this.getChildren().length;\n            }\n            return targetIndex;\n          }\n      }\n      return -1;\n    },\n\n    /**\n     * insert child at given index\n     * @param xmlElement {cv.ui.manager.model.XmlElement} new child\n     * @param index {Number} index to insert the child, if set to -1 insert it at any allowed position\n     * @param skipUndo {Boolean} do not add an undo operation for this change\n     * @param internalOperation\n     * @return {Boolean} true if the child has been added\n     */\n    insertChild: function (xmlElement, index, skipUndo, internalOperation) {\n      if (!this.isLoaded()) {\n        this.load();\n      }\n      const children = this.getChildren();\n      let success = false;\n      if (index === -1) {\n        index = this.findPositionForChild(xmlElement);\n        if (index === -1) {\n          // no valid position found\n          return false;\n        }\n      }\n      if (this.isChildAllowedAtPosition(xmlElement, index)) {\n        if (index >= children.length) {\n          // append\n          this._node.appendChild(xmlElement.getNode());\n          children.push(xmlElement);\n          success = true;\n        } else if (index === 0) {\n          // add before first child\n          this._node.insertBefore(xmlElement.getNode(), this._node.childNodes[0]);\n          children.unshift(xmlElement);\n          success = true;\n        } else {\n          const previousChild = children.getItem(index);\n          if (previousChild) {\n            previousChild.getNode().before(xmlElement.getNode());\n            children.insertBefore(previousChild, xmlElement);\n            success = true;\n          }\n        }\n      }\n      if (success) {\n        const editor = this.getEditor();\n        xmlElement.setParent(this);\n        if (xmlElement.$$removed) {\n          delete xmlElement.$$removed;\n          if (editor) {\n            editor.updateModified(xmlElement);\n          }\n          xmlElement.updateModified();\n        } else if (!internalOperation || internalOperation === 'added') {\n            xmlElement.$$added = true;\n            xmlElement.updateModified();\n          }\n        this.updateModified();\n        if (children.length === 1) {\n          // first child added -> open it\n          this.setOpen(true);\n        }\n        if (!skipUndo) {\n          if (editor) {\n            const changes = [{\n              index: index,\n              parent: this,\n              child: xmlElement\n            }];\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Add %1', this.getDisplayName()), this, changes, 'created');\n            editor.addUndo(change);\n          }\n        }\n      }\n      return success;\n    },\n\n    _validateTextContent: function (value) {\n      // do not validate content that is loaded from the actual node\n      if (!this.__initializing) {\n        if (this._node) {\n          if (!this.getSchemaElement().isValueValid(value)) {\n            throw new qx.core.ValidationError(qx.locale.Manager.tr('Invalid text content: \\'%1\\'', value));\n          }\n        } else {\n          throw new qx.core.ValidationError(qx.locale.Manager.tr('Text content not allowed here'));\n        }\n      }\n    },\n\n    /**\n     * Validate this element (and its parent when this is a text node)\n     * @param recursive {Boolean} validate children too\n     */\n    validate: function (recursive) {\n      const schemaElement = this.getSchemaElement();\n      if (this.isTextNode()) {\n        this.getParent().validate(false);\n        this.setValid(schemaElement.isValueValid(this.getText()));\n      } else if (this.isElement()) {\n        const allowedAttributes = schemaElement.getAllowedAttributes();\n        const errors = [];\n        // check attribute values\n        for (let i = 0; i < this._node.attributes.length; i++) {\n          const attr = this._node.attributes.item(i);\n          if (Object.prototype.hasOwnProperty.call(allowedAttributes, attr.name)) {\n            if (!allowedAttributes[attr.name].isValueValid(attr.value)) {\n              errors.push({\n                attribute: attr.name,\n                error: qx.locale.Manager.tr('Invalid value')\n              });\n            }\n          } else {\n            errors.push({\n              attribute: attr.name,\n              error: qx.locale.Manager.tr('Attribute \\'%1\\' not allowed', attr.name)\n            });\n          }\n        }\n        // check for missing required attributes\n        Object.keys(allowedAttributes).filter(name => !allowedAttributes[name].isOptional()).forEach(name => {\n          if (!this._node.hasAttribute(name)) {\n            errors.push({\n              attribute: name,\n              error: qx.locale.Manager.tr('Attribute \\'%1\\' is required but missing', name)\n            });\n          }\n        });\n        if (schemaElement.isTextContentRequired()) {\n          // check if we have at least one non empty #text child\n          const found = this.getChildren().some(child => child.isTextNode() && child.getNode().nodeValue.trim() !== '');\n          if (!found) {\n            errors.push({\n              attribute: '#text',\n              error: qx.locale.Manager.tr('Text content is missing')\n            });\n          }\n        }\n        if (schemaElement.isTextContentAllowed()) {\n          this.getChildren().forEach(child => {\n            if (child.isTextNode()) {\n              child.load();\n              child.setValid(schemaElement.isValueValid(child.getText()));\n              if (!child.isValid()) {\n                child.setInvalidMessage(qx.locale.Manager.tr('Text content is invalid'));\n              }\n            }\n          });\n        }\n        this.setInvalidMessage(errors.map(err => err.error).join('<br/>'));\n        this.setValid(errors.length === 0);\n      }\n    },\n\n    isTextNode: function () {\n      return this.getName() === '#text' || this.getName() === '#cdata-section';\n    },\n\n    _applyTextContent: function (value) {\n      if (!this.__initializing) {\n        if (this._node) {\n          if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n            this._node.nodeValue = value;\n            this.updateDisplayName();\n          } else if (this._node.nodeType === Node.ELEMENT_NODE) {\n            this._node.textContent = value;\n          }\n        }\n      }\n    },\n\n    getText: function () {\n      return this.getTextContent();\n    },\n\n    setText: function (text, nodeName) {\n      let changed = false;\n      let newValue = text;\n      let oldValue = '';\n      if (this.getSchemaElement().isTextContentAllowed()) {\n        oldValue = this.getTextContent();\n        if (this.getSchemaElement().isValueValid(text)) {\n          if (oldValue !== text) {\n            this.setTextContent(text);\n            changed = true;\n          }\n        } else {\n          this.error('\\''+text+'\\' is no valid text content for a \\''+this.getName() + '\\' element');\n        }\n      } else {\n        this.error('text content is not allowed for a \\''+this.getName() + '\\' element');\n      }\n      return {\n        changed: changed,\n        attribute: nodeName || '#text',\n        value: newValue,\n        old: oldValue\n      };\n    },\n\n    getAttribute: function (name) {\n      return this._node.getAttribute(name);\n    },\n\n    setAttribute: function (name, value) {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        const attribute = this.getSchemaElement().getAllowedAttributes()[name];\n        let changed = false;\n        let newValue = value;\n        let oldValue = this._node.hasAttribute(name) ? this._node.getAttribute(name) : '';\n        if (attribute) {\n          if (value === null || value === undefined) {\n            value = '';\n          } else {\n            value = '' + value;\n          }\n          value = value.replace(/[&\"'`]/g, function (s) {\n            return cv.ui.manager.model.XmlElement.entityMap[s];\n          });\n          newValue = value;\n          if (attribute.isValueValid(value)) {\n            if (oldValue !== value) {\n              if (!value || value === attribute.getDefaultValue()) {\n                this._node.removeAttribute(name);\n                newValue = '';\n              } else {\n                this._node.setAttribute(name, value);\n              }\n              if (name === 'name') {\n                this.updateDisplayName();\n                if (this.getName() === 'icon') {\n                  this._maintainIcon();\n                }\n              }\n              changed = true;\n            }\n          } else {\n            this.error('\\'' + value + '\\' is not allowed for attribute \\'' + name + '\\'');\n          }\n        } else {\n          this.error('\\'' + name + '\\' is no allowed attribute for a \\'' + this.getName() + '\\' element');\n        }\n        return {\n          changed: changed,\n          attribute: name,\n          value: newValue,\n          old: oldValue\n        };\n      } else if (this._node.nodeType === Node.TEXT_NODE && name === '#text' || (this._node.nodeType === Node.CDATA_SECTION_NODE && name === '#cdata-section')) {\n        return this.setText(value, name);\n      } else if ((this._node.nodeType === Node.COMMENT_NODE && name === '#comment')) {\n        const oldValue = this.getTextContent();\n        const changed = value !== oldValue;\n        this.setTextContent(value);\n        return {\n          changed: changed,\n          attribute: name,\n          value: value,\n          old: oldValue\n        };\n      }\n      return null;\n    },\n\n    /**\n     * @return {Boolean} true if this element is a required child from its parent\n     */\n    isRequired: function () {\n      const parent = this.getParent();\n      if (parent) {\n        const requiredFromParent = parent.getSchemaElement().getRequiredElements();\n        return requiredFromParent.includes(this.getName());\n      }\n      // only root element has nor parent, and a root element is always required\n      return true;\n    },\n\n    setAttributes: function (data) {\n      const changes = [];\n      let change;\n      const parentChanges = [];\n      const isTextNode = (this.getName() === '#text' || this.getName() === '#cdata-section');\n      const parent = this.getParent();\n      Object.keys(data).forEach(attrName => {\n        if (isTextNode && !attrName.startsWith('#')) {\n          // special mode for editing text content from a data provider with hints, those hints must be applied to the parent\n          change = parent.setAttribute(attrName, data[attrName]);\n          if (change.changed) {\n            parentChanges.push(change);\n          }\n        } else if (attrName === '#outerHTML' || attrName === '#innerHTML') {\n          if (this.getSchemaElement().isChildElementAllowed('*')) {\n            const dom = new DOMParser().parseFromString(data[attrName], 'text/xml');\n            if (dom.getElementsByTagName('parsererror').length === 0) {\n              const oldValue = attrName === '#outerHTML' ? this._node.outerHTML : this._node.innerHTML;\n              const newNode = dom.documentElement;\n              if (attrName === '#outerHTML') {\n                const oldNode = this._node;\n                oldNode.parentNode.replaceChild(newNode, oldNode);\n                this._node = newNode;\n                this.setName(this._node.nodeName);\n              } else {\n                this._node.innerHTML = data[attrName];\n              }\n              changes.push({\n                changed: true,\n                attribute: attrName,\n                value: data[attrName],\n                old: oldValue\n              });\n              this.load(true);\n            }\n          } else if (attrName === '#innerHTML' && !data[attrName]) {\n            // allow empty values\n            const oldValue = this._node.innerHTML;\n            this._node.innerHTML = data[attrName];\n            changes.push({\n              changed: true,\n              attribute: attrName,\n              value: data[attrName],\n              old: oldValue\n            });\n            this.load(true);\n          }\n        } else {\n          change = this.setAttribute(attrName, data[attrName]);\n          if (change.changed) {\n            changes.push(change);\n          }\n        }\n      });\n      const editor = this.getEditor();\n      if (editor && changes.length > 0) {\n        if (parentChanges.length > 0) {\n          const parentChange = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Change %1', parent.getDisplayName()), parent, parentChanges);\n          changes.push(parentChange);\n          parent.updateModified();\n        }\n        editor.addUndo(new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Change %1', this.getDisplayName()), this, changes));\n      }\n      this.updateModified();\n    },\n\n    _applySchemaElement: function (schemaElement) {\n      if (schemaElement) {\n        this._structure = schemaElement.getSchema().getStructure();\n      } else {\n        this._structure = null;\n      }\n      schemaElement.bind('sortable', this, 'sortable', {\n        converter: function (value) {\n          return this.isEditable() && value;\n        }.bind(this)\n      });\n    },\n\n    _onOpen: function (value) {\n      if (value && !this.isLoaded()) {\n        this.load();\n      }\n      this._maintainIcon();\n    },\n\n    _applyModified: function () {\n      this.updateDisplayName();\n    },\n\n    updateDisplayName: function () {\n      let displayName = this.getName();\n      if (this._node) {\n        if (this._node.nodeType === Node.ELEMENT_NODE) {\n          if (this._node.hasAttribute('name')) {\n            const nameAttr = this._node.getAttribute('name');\n            displayName += ' \"' + nameAttr + '\"';\n          } else if (this.getSchemaElement().getSchema().isRoot(this.getName()) && this._node.hasAttribute('design')) {\n            const designAttr = this._node.getAttribute('design');\n            displayName += ' \"' + designAttr + '\"';\n          }\n        } else if ((this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE || this._node.nodeType === Node.COMMENT_NODE) && this._node.nodeValue.trim()) {\n          let textContent = this._node.nodeValue.trim();\n          if (textContent.length > 26) {\n            textContent = textContent.substring(0, 26) + '...';\n          }\n          displayName = textContent;\n        }\n      }\n      if (this.isModified()) {\n        displayName += ' *';\n      }\n      this.setDisplayName(displayName);\n    },\n    hasChildren: function() {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        if (this._node && this._node.hasChildNodes()) {\n          for (let i = 0; i < this._node.childNodes.length; i++) {\n            const childNode = this._node.childNodes.item(i);\n            if (childNode.nodeType === Node.ELEMENT_NODE ||\n              ((childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.CDATA_SECTION_NODE) && childNode.nodeValue.trim() !== '')) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    },\n\n    load: function (force) {\n      if (!this.isLoaded() || force) {\n        this.__initializing = true;\n        const children = this.getChildren();\n        children.removeListener('change', this._syncChildNodes, this);\n        children.removeAll();\n        if (this._node) {\n          if (this._node.nodeType === Node.ELEMENT_NODE) {\n            // read children\n            const schemaElement = this.getSchemaElement();\n            this._initialChildNames = [];\n            for (let i = 0; i < this._node.childNodes.length; i++) {\n              const childNode = this._node.childNodes.item(i);\n              const childSchemaElement = schemaElement.getSchemaElementForElementName(childNode.nodeName);\n              if (childSchemaElement) {\n                if (childNode.nodeType === Node.ELEMENT_NODE) {\n                  const child = new cv.ui.manager.model.XmlElement(childNode, childSchemaElement, this.getEditor(), this);\n                  children.push(child);\n                  this._initialChildNames.push(childNode.nodeName);\n                } else if (childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.CDATA_SECTION_NODE) {\n                  if (childNode.nodeValue.trim()) {\n                    // do not use childSchemaElement here, because our schemeElement already knows how to validate text\n                    const child = new cv.ui.manager.model.XmlElement(childNode, schemaElement, this.getEditor(), this);\n                    if (schemaElement.isMixed()) {\n                      // text nodes can be re-ordered in mixed content\n                      child.setSortable(true);\n                    }\n                    children.push(child);\n                    if (childNode.nodeValue.trim()) {\n                      this._initialChildNames.push(childNode.nodeName);\n                    }\n                  }\n                } else if (childNode.nodeType === Node.COMMENT_NODE) {\n                  if (childNode.nodeValue) {\n                    const child = new cv.ui.manager.model.XmlElement(childNode, childSchemaElement, this.getEditor(), this);\n                    // comment nodes are allowed everywhere. but we do not allow them to be moved via drag&drop now\n                    // because comments might contains template conditions, which will get invalid when moved and we cannot validate that\n                    child.setSortable(false);\n                    children.push(child);\n                    if (childNode.nodeValue.trim()) {\n                      this._initialChildNames.push(childNode.nodeName);\n                    }\n                  }\n                }\n              } else if (childNode.nodeType === Node.ELEMENT_NODE) {\n                if (schemaElement.isChildElementAllowed(childNode.nodeName)) {\n                  // allowed but no schema element\n                  const child = new cv.ui.manager.model.XmlElement(childNode, schemaElement, this.getEditor(), this);\n                  if (schemaElement.isMixed()) {\n                    // text nodes can be re-ordered in mixed content\n                    child.setSortable(true);\n                  }\n                  children.push(child);\n                  this._initialChildNames.push(childNode.nodeName);\n                } else {\n                  // only complain for real childs (no comments, textNodes)\n                  this.setValid(false);\n                  let msg = this.getInvalidMessage();\n                  msg = (msg ? msg + '<br/>' : '') + qx.locale.Manager.tr('Child element \\'%1\\' not allowed.', childNode.nodeName);\n                  this.setInvalidMessage(msg);\n                  this.setValid(false);\n                }\n              }\n            }\n\n            // read attributes\n            this._initialAttributes.clear();\n            for (let i = 0; i < this._node.attributes.length; i++) {\n              const attr = this._node.attributes.item(i);\n              this._initialAttributes.set(attr.name, attr.value);\n            }\n          } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n            this._initialTextContent = this._node.nodeValue;\n            try {\n              this.setTextContent(this._node.nodeValue);\n            } catch (e) {\n              this.appendInvalidMessage(e.toString());\n            }\n          }\n        }\n        this.setLoaded(true);\n        children.addListener('change', this._syncChildNodes, this);\n        this._updateChildrenDeletableFlags();\n        this.__initializing = false;\n      }\n    },\n\n    appendInvalidMessage: function (errorMsg) {\n      if (errorMsg) {\n        const existing = this.getInvalidMessage();\n        this.setInvalidMessage(existing ? existing + '<br/>' + errorMsg : errorMsg);\n      }\n    },\n\n    updateModified: function () {\n      if (this.$$added) {\n        this.setModified(true);\n      } else if (this._node.nodeType === Node.ELEMENT_NODE) {\n        const initial = this._initialAttributes;\n        const currentChildNames = this._currentChildNames();\n        if (this._node.attributes.length !== initial.size) {\n          this.setModified(true);\n        } else if (currentChildNames.length !== this._initialChildNames.length || currentChildNames.join('') !== this._initialChildNames.join('')) {\n          this.setModified(true);\n        } else {\n          let modified = false;\n          for (const [key, value] of initial) {\n            if (!this._node.hasAttribute(key) || this._node.getAttribute(key) !== value) {\n              modified = true;\n              break;\n            }\n          }\n          this.setModified(modified);\n        }\n      } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n        this.setModified(this._initialTextContent !== this.getTextContent());\n      }\n      const editor = this.getEditor();\n      if (editor) {\n        editor.updateModified(this);\n      }\n    },\n\n    /**\n     * Special check if this element has modified children (position, of length)\n     * This is used to determine if the preview highlighting needs to be disabled because the xml structure has changed\n     * @returns {*|boolean}\n     */\n    hasChildrenModified: function () {\n      if (this._node.nodeType === Node.ELEMENT_NODE && this.isLoaded()) {\n        const currentChildNames = this._currentChildNames();\n        return this.isModified() && (currentChildNames.length !== this._initialChildNames.length || currentChildNames.join('') !== this._initialChildNames.join(''));\n      }\n      return false;\n    },\n\n    onSaved: function () {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        // read attributes\n        this._initialAttributes.clear();\n        for (let i = 0; i < this._node.attributes.length; i++) {\n          const attr = this._node.attributes.item(i);\n          this._initialAttributes.set(attr.name, attr.value);\n        }\n        this._initialChildNames = this._currentChildNames();\n      } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n        this._initialTextContent = this._node.nodeValue;\n      }\n      if (this.$$added) {\n        delete this.$$added;\n      }\n      this.setModified(false);\n    },\n\n    isElement: function () {\n      return this._node.nodeType === Node.ELEMENT_NODE;\n    },\n\n    _currentChildNames: function () {\n      const names = [];\n      let name;\n      let widget;\n      for (let i = 0; i < this._node.childNodes.length; i++) {\n        const childNode = this._node.childNodes.item(i);\n        if (childNode.nodeType === Node.ELEMENT_NODE) {\n          widget = this._node.$$widget;\n          name = widget ? widget.getDisplayName() : childNode.nodeName;\n          names.push(name);\n        } else if ((childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) && childNode.nodeValue.trim()) {\n          names.push(childNode.nodeName);\n        }\n      }\n      return names;\n    },\n\n    _syncChildNodes: function (ev) {\n      // children have changed clear cache\n      this.__addableChildren = null;\n      // we have to update all deletable flags for this elements children, when their siblings changed\n      this._updateChildrenDeletableFlags();\n    },\n\n    _updateChildrenDeletableFlags: function () {\n      if (this.isEditable()) {\n        this.getChildren().forEach(child => {\n          if (child.isElement() || child.isTextNode()) {\n            child.updateDeletable();\n          }\n        });\n      }\n    },\n\n    getWidgetPath: function () {\n      if (this.getName() === '#comment') {\n        return '';\n      }\n      const schema = this.getSchemaElement().getSchema();\n      const widgets = schema.getWidgetNames();\n      let current = this;\n      while (current && !widgets.includes(current.getName())) {\n        current = current.getParent();\n      }\n      if (!current) {\n        return '';\n      }\n      if (this._structure === 'pure') {\n        if (current.getName() === 'navbar') {\n          return 'navbar' + qx.lang.String.firstUp(current.getAttribute('position'));\n        }\n\n        const ids = [];\n        let c = current;\n        while (c) {\n          const parent = c.getParent();\n          if (parent.getName() === 'pages') {\n            ids.unshift('id');\n            break;\n          }\n          let id = parent.getChildren().filter(child => child.getNode().nodeType === Node.ELEMENT_NODE && child.getName() !== 'layout').indexOf(c);\n          ids.unshift(id);\n          c = parent;\n        }\n        if (current.getName() === 'page') {\n          // make sure that the join ends with '_'\n          ids.push('');\n        }\n        return '#' + ids.join('_');\n      } else if (this._structure === 'tile') {\n        let c = current.getNode();\n        let index = 0;\n        let selector = '';\n        while (c) {\n          const parent = c.parentElement;\n          if (c.hasAttribute('id')) {\n            selector = selector ? `#${c.getAttribute('id')} > ${selector}` : `#${c.getAttribute('id')}`;\n            break;\n          } else if (c.nodeName.toLowerCase() === 'config') {\n            selector = selector ? `config > ${selector}` : 'config';\n            break;\n          } else {\n            index = Array.prototype.indexOf.call(parent.children, c) + 1;\n            selector = selector ? `*:nth-child(${index}) > ${selector}` : `*:nth-child(${index})`;\n          }\n          c = parent;\n        }\n        return selector;\n      }\n      return '';\n    },\n\n    // overridden\n    clone: function() {\n      return new cv.ui.manager.model.XmlElement(this._node.cloneNode(true), this.getSchemaElement(), this.getEditor());\n    }\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._node = null;\n    this._schema = null;\n    this._initialAttributes = null;\n    this.__addableChildren = null;\n    this._disposeObjects('_schemaElement');\n  }\n});\n","/* Provider.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Wrapper class for all data providers.\n * @ignore(Element)\n */\nqx.Class.define('cv.ui.manager.editor.data.Provider', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__cache = {};\n    this._client = cv.io.rest.Client.getDataProviderClient();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    Config: {\n      'address': {\n        '#text': {\n          cache: true,\n          userInputAllowed: true,\n          grouped: true,\n          method: 'getAddresses'\n        }\n      },\n      'rrd': {\n        '#text': {\n          cache: true,\n          userInputAllowed: true,\n          method: 'getRrds'\n        }\n      },\n      'influx': {\n        'measurement': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBs'\n        },\n        'field': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBFields'\n        }\n      },\n      'tag': {\n        'key': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBTags'\n        },\n        'value': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBValues'\n        }\n      },\n      'icon': {\n        'name': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getIcons'\n        }\n      },\n      'plugin': {\n        'name': {\n          cache: true,\n          userInputAllowed: false,\n          method: 'getPlugins'\n        }\n      },\n      'pages': {\n        'design': {\n          method: 'getDesigns',\n          cache: true,\n          userInputAllowed: false\n        }\n      },\n      // wildcard: will match ANY elements attribute (lower prio than an exact element-attribute-match)\n      '*': {\n        'rrd': {\n          method: 'getRrds',\n          cache: true,\n          userInputAllowed: true\n        },\n        'ga': {\n          method: 'getAddresses',\n          cache: true,\n          userInputAllowed: true,\n          grouped: true\n        },\n        'transform': {\n          method: 'getTransforms',\n          cache: true,\n          userInputAllowed: false\n        }\n      }\n    },\n\n    get: function (id, ...args) {\n      const instance = cv.ui.manager.editor.data.Provider.getInstance();\n      const format = 'dp';\n      const [element, attribute] = id.split('@');\n      let config = null;\n      if (this.Config[element] && this.Config[element][attribute]) {\n        config = this.Config[element][attribute];\n      } else if (this.Config['*'][attribute]) {\n        config = this.Config['*'][attribute];\n      }\n      if (config) {\n        const conf = {};\n        if (config.live) {\n          conf.getLive = qx.lang.Function.curry(instance[config.method], format, config).bind(instance);\n        } else {\n          args.unshift(config);\n          args.unshift(format);\n          conf.data = instance[config.method].apply(instance, args);\n        }\n        return Object.assign(conf, config);\n      }\n      return null;\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __cache: null,\n\n    _getFromCache: function (cacheId) {\n      return this.__cache[cacheId];\n    },\n\n    __clearFromCache: function (cacheId) {\n      if (!cacheId) {\n        this.__cache = {};\n      } else {\n        delete this.__cache[cacheId];\n      }\n    },\n\n    _addToCache: function (cacheId, data) {\n      this.__cache[cacheId] = data;\n    },\n\n    /**\n     * Returns the available design names as array of suggestions.\n     * @param format\n     * @param config\n     * @param structure {String} pure (default) or tile\n     * @returns {Array} suggestions\n     */\n    getDesigns: function (format, config, structure) {\n      if (!structure) {\n        structure = 'pure';\n      }\n      const designs = cv.Config.designStructureMap[structure] || [];\n      if (format === 'dp') {\n        return designs.map(function (designName) {\n          return {\n            label: designName,\n            value: designName\n          };\n        });\n      }\n      return designs.map(function (designName) {\n        return {\n          label: designName,\n          insertText: designName,\n          kind: window.monaco.languages.CompletionItemKind.EnumMember\n        };\n      });\n    },\n\n    /**\n     * @param cacheId {String}\n     * @param rpc {String|Function} rpcname to use with this._client or function to call\n     * @param rpcContext {Object} rpc context\n     * @param args {Array} rpc arguments\n     * @param converter {Function} converter that converts the response to suggestions for the text editor\n     * @param converterContext {Object} context fot the converter function\n     * @param cache\n     * @returns {Promise<any>}\n     * @private\n     */\n    __getData: function (cacheId, rpc, rpcContext, args, converter, converterContext, cache) {\n      const cached = cache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return Promise.resolve(converter.call(converterContext || this, cached));\n      } \n        return new Promise(function (resolve, reject) {\n          const handleResponse = function (err, res) {\n            if (err) {\n              reject(err);\n            } else if (typeof res === 'string' && res.startsWith('Error:')) {\n              qx.log.Logger.error(this, res);\n              resolve(converter.call(converterContext || this, []));\n            } else {\n              if (cache) {\n                // cache the raw values not the converted ones\n                this._addToCache(cacheId, res);\n              }\n              resolve(converter.call(converterContext || this, res));\n            }\n          };\n          if (!args) {\n            args = [handleResponse, this];\n          } else {\n            args.push(handleResponse);\n            args.push(this);\n          }\n          if (qx.lang.Type.isString(rpc)) {\n            this._client[rpc].apply(rpcContext || this._client, args);\n          } else if (qx.lang.Type.isFunction(rpc)) {\n            rpc.apply(rpcContext, args);\n          }\n        }.bind(this));\n    },\n\n    __getFromUrl: function (url, converter, converterContext, cache) {\n      let cached = cache ? this._getFromCache(url) : null;\n      if (cached) {\n        if (converter) {\n          cached = converter.call(converterContext || this, cached);\n        }\n        return Promise.resolve(cached);\n      } \n        return new Promise(function (resolve, reject) {\n          const xhr = new qx.io.request.Xhr(url);\n          const client = cv.io.BackendConnections.getClient();\n          if (client) {\n            client.authorize(xhr);\n          }\n          xhr.set({\n            accept: 'application/json'\n          });\n          xhr.addListener('success', ev => {\n            let data = ev.getTarget().getResponse();\n            if (cache) {\n              this._addToCache(url, data);\n            }\n            if (converter) {\n              data = converter.call(converterContext || this, data);\n            }\n            resolve(data);\n            }, this);\n          xhr.addListener('statusError', reject, this);\n          xhr.send();\n        }.bind(this));\n    },\n\n    getAddresses: function (format, config) {\n      const client = cv.io.BackendConnections.getClient();\n      if (!config) {\n        config = {cache: true};\n      }\n      if (client && client.hasProvider('addresses')) {\n        return this.__getFromUrl(client.getProviderUrl('addresses'), client.getProviderConvertFunction('addresses', format), client, config.cache);\n      } \n        return this.__getData('addresses', 'addressesSync', null, [], format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    getRrds: function (format, config) {\n      const client = cv.io.BackendConnections.getClient();\n      if (!config) {\n        config = {cache: true};\n      }\n      if (client && client.hasProvider('rrd')) {\n        return this.__getFromUrl(client.getProviderUrl('rrd'), client.getProviderConvertFunction('rrd', format), client, config.cache);\n      } \n        return this.__getData('rrds', 'rrdsSync', null, [], format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    getInfluxDBs: function (format, config, element) {\n      const args = this.__getInfluxArgs(element, false);\n      return this.__getData('influxdbs', 'influxdbsSync', null, args, format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    __getInfluxArgs: function (element, withMeasurement) {\n      const args = [];\n      if (element.hasAttribute('authentication')) {\n        args.push({auth: element.getAttribute('authentication')});\n      }\n      if (withMeasurement) {\n        let influx = element;\n        // walk the tree to get the selected data source in the influx element\n        while (influx.nodeName !== 'influx') {\n          influx = influx.parentElement;\n          if (undefined === influx) {\n            // this safety measure can not happen without a bug somewhere!\n            throw new Error();\n          }\n        }\n        args.push({measurement: element.getAttribute('measurement')});\n      }\n      return args;\n    },\n\n    getInfluxDBFields: function (format, config, element) {\n     try {\n       const args = this.__getInfluxArgs(element, true);\n       return this.__getData('influxdbfields|' + args.measurement + '|' + args.auth, 'influxdbfieldsSync', null, args, format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n     } catch (e) {\n       return [];\n     }\n    },\n\n    __getInfluxDBTags: function (format, config, element, converter) {\n      try {\n        const args = this.__getInfluxArgs(element, true);\n        return this.__getData('influxdbtags|' + args.measurement + '|' + args.auth, 'influxdbtagsSync', null, args, converter, this, config.cache);\n      } catch (e) {\n        return [];\n      }\n    },\n\n    getInfluxDBTags: function (format, config, element) {\n      return this.__getInfluxDBTags(format, config, element, function (res) {\n        if (format === 'monaco') {\n          return Object.keys(res).map(function (x) {\n            return {\n              label: x,\n              insertText: x,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } \n          return Object.keys(res).map(function (x) {\n            return {value: x, label: x};\n          });\n      });\n    },\n\n    getInfluxDBValues: function (format, config, element, tag) {\n      return this.__getInfluxDBTags(format, config, element, function (res) {\n        if (res === null || !(element.attributes.key in res)) {\n          return [];\n        }\n        if (format === 'monaco') {\n          return res[tag].map(function (x) {\n            return {\n              label: x,\n              insertText: x,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } \n          return res[tag].map(function (x) {\n            return {\n              label: x,\n              value: x\n            };\n          });\n      });\n    },\n\n    _parseDpResponseForMonaco: function (data) {\n      return this.__parseDpResponse(data, 'monaco');\n    },\n\n    _parseDpResponseForEditor: function (data) {\n      return this.__parseDpResponse(data, 'dp');\n    },\n\n    __parseDpResponse: function (data, format) {\n      const target = [];\n      if (!format || format === 'monaco') {\n        data.forEach(function (entry) {\n          target.push({\n            label: entry.label,\n            insertText: entry.value,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          });\n        }, this);\n      } else if (format === 'dp') {\n        return data || [];\n      }\n      return target;\n    },\n\n    getMediaFiles: function (format, config, typeFilter) {\n      const fsClient = cv.io.rest.Client.getFsClient();\n      return this.__getData('media', fsClient.readSync, fsClient, [{path: 'media', recursive: true}], function (res) {\n        return res.filter(function (file) {\n          return !typeFilter || file.name.endsWith('.' + typeFilter);\n        }).map(function (file) {\n          const path = file.parentFolder + file.name;\n          return {\n            label: path,\n            insertText: path,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          };\n        });\n      }, this, config.cache);\n    },\n\n    /**\n     * Returns the list of available transformations as suggestion entry array.\n     * @param format\n     * @param config\n     * @returns {Array}\n     */\n    getTransforms: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const cacheId = 'transforms|' + format;\n      const useCache = !config || config.cache === true;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      }\n      const transforms = [];\n      Object.keys(cv.Transform.registry).forEach(function (key) {\n          const entry = cv.Transform.registry[key];\n          let suggestion;\n          if (format === 'dp') {\n            suggestion = {\n              label: entry.name + ' [' + key + ']',\n              value: key\n            };\n          } else {\n            suggestion = {\n              label: key,\n              insertText: key,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n            if (entry.lname && Object.prototype.hasOwnProperty.call(entry.lname, qx.locale.Manager.getInstance().getLanguage())) {\n              suggestion.detail = entry.lname[qx.locale.Manager.getInstance().getLanguage()];\n            }\n          }\n          transforms.push(suggestion);\n        }, this);\n        if (useCache) {\n          this._addToCache(cacheId, transforms);\n        }\n        return transforms;\n    },\n\n    /**\n     * Returns the plugin names (all defined parts staring with 'plugin-')\n     * @param format\n     * @param config\n     * @returns {Array}\n     */\n    getPlugins: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const useCache = !config || config.cache === true;\n      const cacheId = 'plugins|' + format;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      }\n      const plugins = [];\n      const qxParts = qx.io.PartLoader.getInstance().getParts();\n      Object.keys(qxParts).forEach(function (partName) {\n          if (partName.startsWith('plugin-')) {\n            const pluginName = partName.substring(7);\n            if (format === 'dp') {\n              plugins.push({\n                label: pluginName,\n                value: pluginName\n              });\n            } else {\n              plugins.push({\n                label: pluginName,\n                insertText: pluginName,\n                kind: window.monaco.languages.CompletionItemKind.EnumMember\n              });\n            }\n          }\n        }, this);\n        if (useCache) {\n          this._addToCache(cacheId, plugins);\n        }\n        return plugins;\n    },\n\n    /**\n     * \n     * @param {String} format \n     * @param {Map?} config \n     * @param {Element?} element \n     * @returns {Array} array with icon definitions\n     */\n    getIcons: function (format, config, element) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const useCache = !config || config.cache === true;\n      const cacheId = 'icons|' + format;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      } \n      let icons;\n      const iconHandler = cv.IconHandler.getInstance();\n      if (format === 'monaco') {\n        // do not use icons from config when we can query them ourselves\n        icons = Object.keys(cv.IconConfig.DB)\n          .filter(name => !element || cv.IconConfig.DB[name].source !== 'config')\n          .map(function (iconName) {\n            return {\n              label: iconName,\n              insertText: iconName,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n      } else if (format === 'dp') {\n        // dataprovider format\n        // do not use icons from config when we can query them ourselves\n        icons = Object.keys(cv.IconConfig.DB)\n          .filter(name => !element || cv.IconConfig.DB[name].source !== 'config')\n          .map(function (iconName) {\n            return {\n              label: iconName,\n              value: iconName,\n              icon: iconHandler.getIconSource(iconName)\n            };\n          });\n      }\n      if (element) {\n        if (element instanceof Element) {\n          element.ownerDocument.querySelectorAll('pages > meta > icons > icon-definition').forEach(icon => {\n            const iconName = icon.getAttribute('name');\n            if (format === 'monaco') {\n              icons.push({\n                label: iconName,\n                insertText: iconName,\n                kind: window.monaco.languages.CompletionItemKind.EnumMember\n              });\n            } else if (format === 'dp') {\n              icons.push({\n                label: iconName,\n                value: iconName,\n                icon: icon.getAttribute('uri')\n              });\n            }\n          });\n        } else if (typeof element === 'string') {\n          const matches = element.match(/<icon-definition.+>/gm);\n          const template = document.createElement('template');\n          matches.forEach(match => {\n            template.innerHTML = match;\n            const icon = template.content.firstElementChild;\n            const iconName = icon.getAttribute('name');\n            if (format === 'monaco') {\n              icons.push({\n                label: iconName,\n                insertText: iconName,\n                kind: window.monaco.languages.CompletionItemKind.EnumMember\n              });\n            } else if (format === 'dp') {\n              icons.push({\n                label: iconName,\n                value: iconName,\n                icon: icon.getAttribute('uri')\n              });\n            }\n          });\n        }\n      }\n      if (useCache) {\n        this._addToCache(cacheId, icons);\n      }\n      return icons;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__cache = null;\n  }\n});\n","/* ValidationError.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Show validation errors for a config file.\n */\nqx.Class.define('cv.ui.manager.dialog.ValidationError', {\n  extend: qxl.dialog.Dialog,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   *\n   * @param file {cv.ui.manager.model.FileItem}\n   * @param content {String}\n   * @param errors {Array<Map>}\n   * @param properties {Map?}\n   */\n  construct: function (file, content, errors, properties) {\n    this._file = file;\n    this._content = content.split('\\n');\n    this._errors = errors;\n    this.base(arguments, Object.assign(properties || {}, {\n      useBlocker: true\n    }));\n\n    this.addListener('appear', () => {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this.highlight, this);\n      } else {\n        this.highlight();\n      }\n    });\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n   action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _content: null,\n    _errors: null,\n    _rootListenerId: null,\n\n    /**\n     * @var {cv.ui.manager.model.FileItem}\n     */\n    _file: null,\n\n    highlight: function () {\n      Array.from(document.querySelectorAll('pre.highlight')).forEach(elem => {\n        monaco.editor.colorizeElement(elem, {\n          theme: 'vs-dark'\n        });\n      });\n    },\n\n    /**\n     * Create the main content of the widget\n     */\n    _createWidgetContent: function() {\n      let container = this._createDialogContainer();\n      let vbox = new qx.ui.container.Composite(new qx.ui.layout.VBox(10));\n      container.add(vbox);\n\n      let prologue = this.tr('<h3>Config Errors</h3>\\\n<p>The validation of \"%1\" showed some errors. It is NOT recommended to edit this file in the XML-Tree editor, because \\\nit can break the file completely. Please open this file in the text editor and fix the errors there. \\\nOnly proceed to edit the file in the XML-Tree editor if you know what you are doing.</p>', this._file.getFullPath());\n\n      let options = this.tr('<p>You can choose between the following options:\\\n<ul>\\\n    <li><b>Cancel</b> - Close this editor</li>\\\n    <li><b>Proceed</b> - Open the defective file in this editor</li>\\\n    <li><b>Open in text editor</b> - Close this editor and open the defective file in the text editor</li>\\\n</ul>\\\n</p>');\n      const labelOptions = {\n        rich: true,\n        width: Math.min(qx.bom.Viewport.getWidth() - 32, 750),\n        allowGrowX: true\n      };\n      const message = new qx.ui.basic.Label(prologue);\n      message.set(labelOptions);\n      vbox.add(message);\n\n      // errors\n      const errorBox = new qx.ui.container.Composite(new qx.ui.layout.VBox(0));\n      const errorScroll = new qx.ui.container.Scroll(errorBox);\n      errorScroll.set({\n        padding: [0, 0, 8, 8],\n        decorator: 'cv-editor-config-section'\n      });\n      errorScroll.setMinHeight(100);\n      errorScroll.setHeight(Math.min(300, qx.bom.Document.getHeight() - 340));\n      this._rootListenerId = qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        errorScroll.setHeight(Math.min(300, qx.bom.Document.getHeight() - 340));\n      });\n      vbox.add(errorScroll, {flex: 1});\n      const errorLabels = new Map();\n      this._errors.forEach(error => {\n        const errorId = error.line + error.element + error.attribute;\n        let label;\n        if (!errorLabels.has(errorId)) {\n          let codeSnippet = [];\n          const startIndex = Math.max(0, error.line-3);\n          const endIndex = Math.min(this._content.length - 1, error.line+2);\n          let minIndent = Number.POSITIVE_INFINITY;\n          for (let i = startIndex; i < endIndex; i++) {\n            const line = this._content[i];\n            const indent = line.search(/\\S|$/);\n            if (indent < minIndent && indent >= 0) {\n              minIndent = indent;\n            }\n            codeSnippet.push([i+1, line.trimRight()]);\n          }\n          if (minIndent === Number.POSITIVE_INFINITY) {\n            minIndent = 0;\n          }\n          codeSnippet = codeSnippet.map(line => line[0] + ': ' + qx.xml.String.escape(line[1].substr(minIndent)));\n          const headline = this.tr('Line %1', error.line);\n          label = new qx.ui.basic.Label(`<h4>${headline}</h4><pre class=\"highlight\" style=\"background-color: black; padding: 8px;\" data-lang=\"text/xml\">${codeSnippet.join('\\n')}</pre>`);\n          label.set(labelOptions);\n          errorLabels.set(errorId, label);\n          errorBox.add(label);\n        } else {\n          label = errorLabels.get(errorId);\n        }\n        if (!error.message.startsWith('[facet')) {\n          label.setValue(label.getValue() + `<p>${error.message}</p>`);\n        }\n      }, this);\n\n      const option = new qx.ui.basic.Label(options);\n      option.set(labelOptions);\n      vbox.add(option);\n\n      // buttons\n      let buttonPane = this._createButtonPane();\n\n      // close button\n      let closeButton = new qx.ui.form.Button(this.tr('Cancel'));\n      closeButton.addListener('execute', () => this.fireDataEvent('action', 'cancel'), this);\n\n      let proceedButton = new qx.ui.form.Button(this.tr('Proceed'));\n      proceedButton.addListener('execute', () => this.fireDataEvent('action', 'proceed'), this);\n\n      let openSourceButton = new qx.ui.form.Button(this.tr('Open in text editor'));\n      openSourceButton.addListener('execute', () => this.fireDataEvent('action', 'open-source'), this);\n\n      buttonPane.add(closeButton);\n      buttonPane.add(proceedButton);\n      buttonPane.add(openSourceButton);\n\n      container.add(buttonPane);\n      this.add(container);\n    }\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._content = null;\n    this._errors = null;\n    this._file = null;\n    if (this._rootListenerId) {\n      qx.core.Init.getApplication().getRoot().removeListenerById(this._rootListenerId);\n      this._rootListenerId = null;\n    }\n  }\n});\n","/* Main.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Main class of the CometVisu file manager.\n * @author Tobias Brutigam\n * @since 0.12.0\n *\n * @asset(manager/*)\n */\nqx.Class.define('cv.ui.manager.Main', {\n  extend: qx.core.Object,\n  type: 'singleton',\n  include: [\n    cv.ui.manager.control.MFileEventHandler\n  ],\n  implement: [cv.ui.manager.IActionHandler, cv.ui.manager.control.IFileEventHandler],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    iconfont.material.Load;\n    cv.ui.manager.model.BackupFolder.getInstance();\n    this._checkEnvironment();\n    this.initOpenFiles(new qx.data.Array());\n    this.__actionDispatcher = cv.ui.manager.control.ActionDispatcher.getInstance();\n    this.__actionDispatcher.setMain(this);\n\n    this.__initCommands();\n    this._draw();\n\n    qx.event.message.Bus.subscribe('cv.manager.*', this._onManagerEvent, this);\n\n    // Initialize tooltip manager\n    qx.ui.tooltip.Manager.getInstance();\n\n    //qx.event.Registration.addListener(window, 'beforeunload', this._onBeforeUnload, this);\n    window.addEventListener('beforeunload', event => {\n      this._onBeforeUnload(event);\n    });\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    ROOT: null\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    openFiles: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    /**\n     * Current selected folder (if a file is selected its parent folder) is writeable.\n     */\n    writeableFolder: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeWriteableFolder'\n    },\n\n    currentFolder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyCurrentFolder',\n      event: 'changeCurrentFolder'\n    },\n\n    currentSelection: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyCurrentSelection',\n      event: 'changeCurrentSelection'\n    },\n\n    deleteableSelection: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDeleteableSelection'\n    },\n\n    renameableSelection: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeRenameableSelection'\n    },\n\n    visible: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeVisible',\n      apply: '_applyVisible'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __previewFileIndex: null,\n    __root: null,\n    _pane: null,\n    _tree: null,\n    _stack: null,\n    _oldCommandGroup: null,\n    _managerCommands: null,\n    _mainContent: null,\n    _openFilesController: null,\n    _hiddenConfigFakeFile: null,\n    __actionDispatcher: null,\n\n    _applyVisible: function (value) {\n      const manager = qx.core.Init.getApplication().getCommandManager();\n      if (value) {\n        manager.setActive(this._managerCommands);\n        qx.bom.element.Style.set(this.__getRoot(), 'display', 'block');\n      } else {\n        manager.setActive(this._oldCommandGroup);\n        qx.bom.element.Style.set(this.__getRoot(), 'display', 'none');\n      }\n    },\n\n    _checkEnvironment: function () {\n      cv.io.rest.Client.getFsClient().checkEnvironmentSync(function (err, res) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else if (res) {\n          res.forEach(function (env) {\n            let refreshActions = false;\n            switch (env.entity) {\n              case '.':\n                // config folder must be writeable\n                if ((env.state & 1) === 0) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder does not exists'));\n                } else if ((env.state & 2) === 0) {\n                  cv.ui.manager.model.FileItem.ROOT.setReadable(false);\n                  refreshActions = true;\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder is not readable'));\n                } else if ((env.state & 4) === 0) {\n                  cv.ui.manager.model.FileItem.ROOT.setWriteable(false);\n                  refreshActions = true;\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder is not writeable'));\n                }\n                if (refreshActions) {\n                  const widget = this.__actionDispatcher.getFocusedWidget();\n                  this.__actionDispatcher.resetFocusedWidget();\n                  this.__actionDispatcher.setFocusedWidget(widget);\n                }\n                break;\n\n              case 'backup':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('backup folder is not writeable'));\n                }\n                break;\n\n              case 'media':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('media folder is not writeable'));\n                }\n                break;\n\n              case 'hidden.php':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Hidden configuration file (hidden.php) not writeable'));\n                }\n                break;\n            }\n          }, this);\n        }\n      }, this);\n    },\n\n    canHandleAction: function (actionName) {\n      if (actionName === 'delete' && this.getCurrentSelection() && !this.getCurrentSelection().isWriteable()) {\n        // needs a writeable file\n        return false;\n      }\n      let actions = ['close', 'quit', 'about'];\n      const currentFolder = this.getCurrentFolder();\n      if (currentFolder.isWriteable()) {\n        actions.push('new-file');\n        actions.push('new-folder');\n        actions.push('delete');\n        actions.push('upload');\n        actions.push('clone');\n        actions.push('convertToTile');\n      }\n      if (cv.ui.manager.model.FileItem.ROOT.isWriteable()) {\n        actions.push('new-config-file');\n      }\n      return actions.includes(actionName);\n    },\n\n    _doClose() {\n      if (document.querySelector('#main.loading')) {\n        // there is no config file loaded, load the default one\n        let configLoader = new cv.util.ConfigLoader();\n        let app = qx.core.Init.getApplication();\n        configLoader.load(app.bootstrap, app);\n      }\n      this.setVisible(false);\n    },\n\n    handleAction: function (actionName, data) {\n      let unsavedFiles;\n      switch (actionName) {\n        case 'close':\n          if (!data) {\n            this.closeCurrentFile();\n          } else {\n            this.closeFile(data);\n          }\n          break;\n\n        case 'quit':\n          unsavedFiles = this.getOpenFiles().filter(openFile => openFile.getFile().isModified());\n\n          if (unsavedFiles.length > 0) {\n            const dialog = new qxl.dialog.Confirm({\n              message: qx.locale.Manager.tr('You have files opened with unsaved changes, you should save them now.'),\n              callback: function (confirmed) {\n                if (confirmed) {\n                  unsavedFiles.forEach(openFile => {\n                    openFile.save();\n                  });\n                }\n                dialog.dispose();\n                this._doClose();\n              },\n              context: this,\n              caption: qx.locale.Manager.tr('Unsaved changes'),\n              yesButtonLabel: qx.locale.Manager.tr('Save & quit'),\n              noButtonLabel: qx.locale.Manager.tr('Quit without saving'),\n              useBlocker: true\n            });\n            dialog.show();\n          } else {\n            this._doClose();\n          }\n          break;\n\n        case 'new-file':\n          this._onCreate('file', null, data);\n          break;\n\n        case 'new-config-file':\n          cv.io.rest.Client.getFsClient().readSync({path: 'demo/templates/visu_config.xml'}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Cannot load config template'));\n            } else {\n              this._onCreate('config', res, cv.ui.manager.model.FileItem.ROOT);\n            }\n          }, this);\n          break;\n\n        case 'clone':\n          cv.io.rest.Client.getFsClient().readSync({path: data.file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Cannot load file content'));\n            } else if (data.file.isConfigFile()) {\n                // config files need to be cloned in the root folder\n                this._onCreate('config', res, cv.ui.manager.model.FileItem.ROOT);\n              } else {\n                this._onCreate('file', res);\n              }\n          }, this);\n          break;\n\n        case 'convertToTile':\n          cv.io.rest.Client.getFsClient().readSync({path: data.file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Cannot load file content'));\n            } else if (data.file.isConfigFile()) {\n              const converter = new cv.util.ConfigUpgrader();\n              const [err, convertedContent] = converter.convertPureToTile(res);\n              if (err) {\n                cv.ui.manager.snackbar.Controller.error(err);\n              } else {\n                let suggestedName = 'tile';\n                const match = /visu[_-]config[_-]([\\w\\d_-]+)(\\.xml)?/.exec(data.file.getName());\n                if (match) {\n                  suggestedName = 'tile-' + match[1];\n                }\n                // config files need to be cloned in the root folder\n                this._onCreate('config', convertedContent, cv.ui.manager.model.FileItem.ROOT, 'cv.ui.manager.editor.Source', suggestedName);\n              }\n            }\n          }, this);\n          break;\n\n        case 'new-folder':\n          this._onCreate('dir', null, data);\n          break;\n\n        case 'delete':\n          this._onDelete(data);\n          break;\n\n        case 'upload':\n          // nothing to to, this is handled in another way\n          break;\n\n        case 'about':\n          this._showAbout();\n          break;\n\n        default:\n          this.warn(actionName + ' handling is not implemented yet!');\n          break;\n      }\n    },\n\n    _onBeforeUnload: function (ev) {\n      const unsavedFiles = this.getOpenFiles().filter(openFile => openFile.getFile().isModified());\n      if (unsavedFiles.length > 0) {\n        ev.preventDefault();\n        ev.returnValue = '';\n      } else {\n        delete ev['returnValue'];\n      }\n    },\n\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _handleFileEvent: function (ev) {\n      const data = ev.getData();\n      if (data.action === 'deleted') {\n        // check if file is currently opened and close it\n        const openFiles = this.getOpenFiles().copy();\n        openFiles.some(function (openFile) {\n          if (openFile.getFile().isRelated(data.path)) {\n            this.closeFile(openFile);\n          }\n          return false;\n        }, this);\n        if (this.getCurrentFolder() && this.getCurrentFolder().getFullPath() === data.path) {\n          this.resetCurrentFolder();\n        }\n      } else {\n        this.warn('unhandled file event', data.action);\n      }\n      this._tree.refresh();\n    },\n\n    __findConfigFile: function (name) {\n      let file = null;\n      let demoFolder = null;\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(child => {\n        if (child.getName() === 'demo') {\n          demoFolder = child;\n        } else if (child.getName() === name) {\n          file = child;\n          return true;\n        }\n        return false;\n      });\n      if (!file && demoFolder) {\n        if (name.startsWith('demo/')) {\n          name = name.substr(5);\n        }\n        // check demo configs\n        demoFolder.getChildren().some(child => {\n          if (child.getName() === name) {\n            file = child;\n            return true;\n          }\n          return false;\n        });\n      }\n      return file;\n    },\n\n    _onManagerEvent: function (ev) {\n      let data = ev.getData();\n      switch (ev.getName()) {\n        case 'cv.manager.compareFiles':\n          this.openFile(data, false);\n          break;\n\n        case 'cv.manager.openWith':\n          if (typeof data.file === 'string') {\n            // this can only by a file in the root dir (a config)\n            data.file = this.__findConfigFile(data.file);\n          }\n          this.openFile(data.file || this.getCurrentSelection(), false, data.handler, null, data.handlerOptions);\n          break;\n\n        case 'cv.manager.open':\n          if (typeof data === 'string') {\n            // this can only by a file in the root dir (a config)\n            data = this.__findConfigFile(data);\n          }\n          this.openFile(data || this.getCurrentSelection(), false);\n          break;\n      }\n    },\n\n    /**\n     * open selected file in preview mode\n     * @param ev\n     * @private\n     */\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if ((cv.ui.manager.model.Preferences.getInstance().isQuickPreview() && data.mode === 'tap') || data.mode === 'dbltap') {\n        this.__openSelectedFile(data.node, data.mode);\n      }\n      const node = data.node;\n      if (node) {\n        if (data.node.getType() === 'file') {\n          this.setCurrentFolder(data.node.getParent());\n        } else {\n          this.setCurrentFolder(node);\n        }\n        this.setCurrentSelection(node);\n      } else {\n        this.resetCurrentFolder();\n        this.resetCurrentSelection();\n      }\n    },\n\n    __openSelectedFile: function (node, mode) {\n      if (node) {\n        if (node.getType() === 'file') {\n          this.openFile(node, mode === 'tap');\n        } else if (mode === 'dbltap') {\n          // edit folder name on dbltap\n          node.setEditing(true);\n        }\n      }\n    },\n\n    _applyCurrentFolder: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('writeable', this, 'writeableFolder');\n      } else {\n        this.resetWriteableFolder();\n      }\n    },\n\n    _applyCurrentSelection: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('writeable', this, 'deleteableSelection');\n        value.bind('inTrash', this, 'renameableSelection', {\n          converter: function (value) {\n            return !value;\n          }\n        });\n      } else {\n        this.resetDeleteableSelection();\n      }\n    },\n\n    _onChangeFileSelection: function () {\n      const sel = this._openFilesController.getSelection();\n      if (sel.length > 0) {\n        const openFile = sel.getItem(0);\n        const file = openFile.getFile();\n        let editorConfig;\n        const handlerId = openFile.getHandlerId();\n        if (handlerId) {\n          editorConfig = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n        } else {\n          editorConfig = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n        }\n        if (!editorConfig.instance) {\n          editorConfig.instance = new editorConfig.Clazz();\n        }\n        editorConfig.instance.setFile(file);\n        if (this._stack.indexOf(editorConfig.instance) < 0) {\n          this._stack.add(editorConfig.instance);\n        }\n        if (editorConfig.instance instanceof cv.ui.manager.editor.AbstractEditor) {\n          editorConfig.instance.setHandlerOptions(openFile.getHandlerOptions());\n        }\n        this._stack.setSelection([editorConfig.instance]);\n        this.__actionDispatcher.setFocusedWidget(editorConfig.instance);\n\n        cv.ui.manager.core.GlobalState.getInstance().setOpenedFocusedFile(file);\n      } else {\n        cv.ui.manager.core.GlobalState.getInstance().resetOpenedFocusedFile();\n      }\n    },\n\n    /**\n     * @param file {cv.ui.manager.model.FileItem} the file to open\n     * @param preview {Boolean} open the file in preview mode\n     * @param handlerId {String} use this handler to open the file (classname as string)\n     * @param handlerType {String} use a special handler type, e.g. 'edit' if you want to open the file with an editor and not a viewer\n     * @param handlerOptions\n     */\n    openFile: function (file, preview, handlerId, handlerType, handlerOptions) {\n      const openFiles = this.getOpenFiles();\n      let openFile;\n      let handlerConf;\n      if (!handlerId) {\n        handlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, handlerType);\n\n        if (!handlerConf) {\n          // no handler\n          cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('Cannot open file: \"%1\"', file.getName()));\n          return;\n        } \n          handlerId = handlerConf.Clazz.classname;\n      } else {\n        // check if this handler opens the file in a external frame that is not connected to the manager\n        handlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n        if (!handlerConf.instance) {\n          handlerConf.instance = new handlerConf.Clazz();\n        }\n        if (handlerConf.instance.isExternal()) {\n          handlerConf.instance.setFile(file);\n          return;\n        }\n      }\n      const isOpen = openFiles.some(function (of) {\n        if (of.getFile() === file && handlerId === of.getHandlerId()) {\n          openFile = of;\n          return true;\n        }\n        return false;\n      });\n      if (!openFile) {\n        openFile = new cv.ui.manager.model.OpenFile(file, handlerId);\n      }\n      if (handlerOptions) {\n        openFile.setHandlerOptions(handlerOptions);\n      } else {\n        openFile.resetHandlerOptions();\n      }\n      if (preview === true) {\n        if (!openFile.isPermanent()) {\n          if (this.__previewFileIndex !== null && openFiles.getItem(this.__previewFileIndex) && !openFiles.getItem(this.__previewFileIndex).isPermanent()) {\n            openFiles.setItem(this.__previewFileIndex, openFile);\n          } else {\n            this.__previewFileIndex = openFiles.length;\n            openFiles.push(openFile);\n          }\n          // do not 'downgrade' the permanent state\n          openFile.setPermanent(false);\n        }\n      } else {\n        if (!isOpen && (this.__previewFileIndex === null || openFiles.indexOf(openFile) !== this.__previewFileIndex)) {\n          openFiles.push(openFile);\n        }\n        openFile.setPermanent(true);\n        this.__previewFileIndex = null;\n      }\n      this._openFilesController.getTarget().setModelSelection([openFile]);\n    },\n\n    /**\n     * Opens a confirm dialog on how to treat the unsaved changes in the file if it has been modified and not saved.\n     * @param openFile {cv.ui.manager.model.OpenFile|cv.ui.manager.model.FileItem} file to check\n     * @return {boolean} true if the confirm dialog has been shown\n     */\n    checkUnsavedChanged: function (openFile) {\n      if (openFile instanceof cv.ui.manager.model.FileItem) {\n        // find the opened file\n        const found = this.getOpenFiles().some(function (f) {\n          if (f.getFile().getFullPath() === openFile.getFullPath()) {\n            openFile = f;\n            return true;\n          }\n          return false;\n        });\n        if (!found) {\n          return false;\n        }\n      }\n      const file = openFile.getFile();\n      if (file.isModified()) {\n        // check if temporary\n        let message = qx.locale.Manager.tr('This file has unsaved changes that will be lost when you close it without saving.');\n        if (file.isTemporary()) {\n          message = qx.locale.Manager.tr('This file has not been saved on the backend yet. It will be lost when you close it without saving.');\n        }\n        const dialog = new qxl.dialog.Confirm({\n          message: message,\n          callback: confirmed => {\n            if (confirmed === true) {\n              openFile.save();\n              this.closeFile(openFile, true);\n            } else if (confirmed === false) {\n              file.resetModified();\n              if (file.isTemporary()) {\n                qx.event.message.Bus.dispatchByName('cv.manager.file', {\n                  action: 'deleted',\n                  path: file.getFullPath()\n                });\n              }\n              this.closeFile(openFile, true);\n            } else {\n              // cancel closing, do nothing\n            }\n            dialog.dispose();\n          },\n          context: this,\n          caption: qx.locale.Manager.tr('Unsaved changes'),\n          yesButtonLabel: qx.locale.Manager.tr('Save & close'),\n          noButtonLabel: qx.locale.Manager.tr('Discard & close'),\n          noButtonIcon: 'qxl.dialog.icon.delete',\n          useBlocker: true,\n          allowCancel: true\n        });\n        dialog.show();\n        return true;\n      }\n      return false;\n    },\n\n    closeFile: function (openFile, force) {\n      if (openFile instanceof cv.ui.manager.model.FileItem) {\n        // find the opened file\n        const found = this.getOpenFiles().some(function (f) {\n          if (f.getFile().getFullPath() === openFile.getFullPath()) {\n            openFile = f;\n            return true;\n          }\n          return false;\n        });\n        if (!found) {\n          return;\n        }\n      }\n      if (!openFile || !openFile.isCloseable()) {\n        return;\n      }\n      const file = openFile.getFile();\n\n      // check if this file is modified\n      if (!force && this.checkUnsavedChanged(openFile)) {\n        return;\n      }\n      if (openFile instanceof cv.ui.manager.model.OpenFile) {\n        openFile.resetPermanent();\n      }\n      const currentSelection = this._openFilesController.getSelection();\n      let selectionIndex = -1;\n      const openFiles = this.getOpenFiles();\n      if (currentSelection.length > 0 && currentSelection.getItem(0) === openFile) {\n        // we need to select another file after this one got closed\n        selectionIndex = openFiles.indexOf(openFile);\n      }\n      openFiles.remove(openFile);\n      const currentHandler = this._stack.getSelection()[0];\n      if (qx.Class.hasInterface(currentHandler.constructor, cv.ui.manager.editor.IEditor) && !(currentHandler instanceof cv.ui.manager.Start)) {\n        // reset the handlers file\n        currentHandler.resetFile();\n      }\n      if (this.getOpenFiles().length === 0) {\n        this._stack.resetSelection();\n        this.__actionDispatcher.resetFocusedWidget();\n        this.__previewFileIndex = null;\n      }\n      if (selectionIndex > 0) {\n        this._openFilesController.getSelection().replace(openFiles.getItem(selectionIndex - 1));\n      } else if (selectionIndex === 0 && openFiles.length > 0) {\n        this._openFilesController.getSelection().replace(openFiles.getItem(0));\n      }\n\n      if (file instanceof cv.ui.manager.model.CompareFiles) {\n        const fileHandlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n        fileHandlerConf.instance.clear();\n        if (openFiles.filter(function (openFile) {\n          return openFile.getFile() instanceof cv.ui.manager.model.CompareFiles;\n        }).length === 0) {\n          fileHandlerConf.instance.destroy();\n          fileHandlerConf.instance = null;\n        }\n      } else if (window.monaco && openFile.getHandlerId() === 'cv.ui.manager.editor.Source') {\n        // close textmodel in monaco editor if exists\n        const oldModel = window.monaco.editor.getModel(file.getUri());\n        if (oldModel) {\n          oldModel.dispose();\n        }\n      }\n    },\n\n    closeCurrentFile: function () {\n      const selected = this._openFilesController.getSelection().length > 0 ? this._openFilesController.getSelection().getItem(0) : null;\n      if (selected) {\n        this.closeFile(selected);\n      }\n    },\n\n    _onCloseFile: function (ev) {\n      this.closeFile(ev.getData());\n    },\n\n    __getRoot: function () {\n      if (!this.__root) {\n        this.__root = qx.dom.Element.create('div', {\n          id: 'manager',\n          style: 'position: absolute; top: 0; left: 0; right: 0; bottom: 0;'\n        });\n        qx.dom.Element.insertEnd(this.__root, document.body);\n        qx.theme.manager.Meta.getInstance().setTheme(cv.theme.Dark);\n      }\n      return this.__root;\n    },\n\n    __initCommands: function () {\n      const group = this._managerCommands = new qx.ui.command.Group();\n      group.add('save', new qx.ui.command.Command('Ctrl+S'));\n      group.add('save-as', new qx.ui.command.Command('Ctrl+Shift+S'));\n      // this command will close the browser window, thats not what we want\n      // group.add('close', new qx.ui.command.Command('Ctrl+W'));\n      group.add('new-file', new qx.ui.command.Command('Ctrl+N'));\n      group.add('new-folder', new qx.ui.command.Command('Ctrl+Shift+N'));\n      group.add('quit', new qx.ui.command.Command('Ctrl+Q'));\n      // group.add('delete', new qx.ui.command.Command('Ctrl+Del'));\n\n      const renameCommand = new qx.ui.command.Command('F2');\n      group.add('rename', renameCommand);\n      this.bind('renameableSelection', renameCommand, 'enabled');\n\n      group.add('undo', new qx.ui.command.Command('Ctrl+Z'));\n      group.add('redo', new qx.ui.command.Command('Ctrl+Y'));\n\n      // edit commands (adding cut/copy/paste command will deactivate the native browser functions)\n      // and as we cannot simulate pasting from clipboard, we do not use them here\n      group.add('cut', new qx.ui.command.Command('Ctrl+X'));\n      group.add('copy', new qx.ui.command.Command('Ctrl+C'));\n      group.add('paste', new qx.ui.command.Command('Ctrl+V'));\n\n      group.add('help', new qx.ui.command.Command('F1'));\n\n      const manager = qx.core.Init.getApplication().getCommandManager();\n      this._oldCommandGroup = manager.getActive();\n      manager.add(group);\n      manager.setActive(group);\n    },\n\n    _onDelete: function (file) {\n      const item = file || this.getCurrentSelection();\n      if (item) {\n        cv.ui.manager.control.FileController.getInstance().delete(item);\n      }\n    },\n\n    _onChangeStackSelection: function (ev) {\n      const selection = ev.getData();\n      const openFiles = [];\n      // sync tab selection with currently visible page\n      selection.forEach(function(page) {\n        const openFile = this.getOpenFiles().toArray().find(function (openFile) {\n          return openFile.getFile() === page.getFile() && openFile.getHandlerId() === page.classname;\n        });\n        if (openFile) {\n          openFiles.push(openFile);\n        }\n      }, this);\n\n      this._openFilesController.getSelection().replace(openFiles);\n    },\n\n    __getFileNamePrompt: function (message, callback, context, value, caption) {\n      const prompt = new cv.ui.manager.dialog.Prompt({\n        message: message,\n        callback: callback || null,\n        context: context || null,\n        value: value || null,\n        caption: caption || '',\n        filter: /[\\w\\d_\\-\\.\\s]/\n      });\n      prompt.show();\n      return prompt;\n    },\n\n    _onCreate: function (type, content, folder, handlerId, suggestedName) {\n      const currentFolder = folder || this.getCurrentFolder();\n      if (!currentFolder) {\n        return;\n      }\n      let message;\n      let existsMessage;\n      if (type === 'config') {\n        message = qx.locale.Manager.tr('Please enter the name of the new configuration (without \"visu_config_\" at the beginning and \".xml\" at the end)');\n        existsMessage = qx.locale.Manager.tr('A configuration with this name already exists.');\n      } else if (type === 'file') {\n        message = qx.locale.Manager.tr('Please enter the file name.');\n        existsMessage = qx.locale.Manager.tr('A file with this name already exists.');\n      } else {\n        message = qx.locale.Manager.tr('Please enter the folder name.');\n        existsMessage = qx.locale.Manager.tr('A folder with this name already exists.');\n      }\n      const handlePrompt = function (name) {\n        if (!name) {\n          // canceled\n          return;\n        }\n        let filename = name;\n        // add visu_config_..-xml\n        if (type === 'config') {\n          const match = /visu[_-]config[_-]([\\w\\d_-]+)(\\.xml)?/.exec(name);\n          if (match) {\n            name = match[1];\n          }\n          filename = 'visu_config_' + name + '.xml';\n        }\n        // check if name does not exist\n        const exists = currentFolder.getChildren().some(function (child) {\n          return (child.getName() === filename && child.getType() === type);\n        }, this);\n\n        if (exists) {\n          cv.ui.manager.snackbar.Controller.error(existsMessage);\n          this.__getFileNamePrompt(message, handlePrompt, this, name);\n        } else {\n          const item = new cv.ui.manager.model.FileItem(filename, currentFolder.getFullPath(), currentFolder);\n          item.set({\n            type: type === 'config' ? 'file' : type,\n            readable: true,\n            writeable: true,\n            loaded: true,\n            modified: true,\n            temporary: true,\n            parentFolder: currentFolder.getFullPath(),\n            content: content || ''\n          });\n          if (type === 'dir') {\n            // create directory directly\n            cv.io.rest.Client.getFsClient().createSync({\n              path: item.getFullPath(),\n              type: type\n            }, null, function (err) {\n              if (err) {\n                cv.ui.manager.snackbar.Controller.error(err);\n              } else {\n                cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('Folder has been created'));\n                item.set({\n                  modified: false,\n                  temporary: false\n                });\n                qx.event.message.Bus.dispatchByName(item.getBusTopic(), {\n                  type: 'created',\n                  file: item,\n                  data: '',\n                  source: this\n                });\n              }\n            }, this);\n          }\n          currentFolder.addChild(item);\n          currentFolder.sortElements();\n          this._tree.refresh();\n          this._tree.setSelection(item);\n          // do not open new folders\n          if (type !== 'dir') {\n            // open the file in an editor\n            this.openFile(item, false, handlerId, 'edit');\n          }\n        }\n      };\n\n      this.__getFileNamePrompt(message, handlePrompt, this, suggestedName);\n    },\n\n    /**\n     * Finds next droppable parent of the given element. Maybe the element itself as well.\n     *\n     * Looks for the attribute <code>qxDroppable</code> with the value <code>on</code>.\n     *\n     * @param elem {Element} The element to query\n     * @return {Element} The next parent element which is droppable. May also be <code>null</code>\n     */\n    __findDroppable : function (elem) {\n      while (elem && elem.nodeType === 1) {\n        if (elem.getAttribute('qxDroppable') === 'on') {\n          return elem;\n        }\n\n        elem = elem.parentNode;\n      }\n\n      return null;\n    },\n\n    // overridden\n    _draw: function () {\n      const domRoot = this.__getRoot();\n      const root = new qx.ui.root.Inline(domRoot, true, true);\n      this.bind('visible', root, 'visibility', {\n        converter: function (visible) {\n          return visible ? 'visible' : 'excluded';\n        }\n      });\n      root.addListenerOnce('appear', function () {\n        // disable file drop\n        const element = root.getContentElement().getDomElement();\n        element.addEventListener('drop', function (ev) {\n          const target = this.__findDroppable(ev.target);\n          if (!target) {\n            ev.preventDefault();\n          }\n        }.bind(this));\n        element.addEventListener('dragover', function (ev) {\n          const target = this.__findDroppable(ev.target);\n          if (!target) {\n            ev.preventDefault();\n          }\n        }.bind(this));\n      }, this);\n      qx.core.Init.getApplication().setRoot(root);\n      root.setLayout(new qx.ui.layout.Canvas());\n\n      const snackbar = cv.ui.manager.snackbar.Controller.getInstance();\n      root.add(snackbar, {\n        bottom: 10,\n        left: 200\n      });\n\n      /**\n       *\n       */\n      function resize() {\n        const bounds = root.getBounds();\n        snackbar.setLayoutProperties({\n          bottom: 10,\n          left: Math.round(bounds.width / 2) - 150\n        });\n        snackbar.setMaxHeight(bounds.height - 40);\n      }\n      root.addListener('resize', resize, this);\n      root.addListener('appear', resize, this);\n      window.addEventListener('resize', function () {\n        // sync window height with manager height\n        domRoot.style.height = window.innerHeight + 'px';\n      });\n\n      const main = new qx.ui.container.Composite(new qx.ui.layout.Dock());\n      root.add(main, {edge: 0});\n      // menu on top\n      const menuBar = cv.ui.manager.MenuBar.getInstance();\n      main.add(menuBar, {edge: 'north'});\n\n      const uploadButton = menuBar.getButton('upload');\n      const uploadManager = new cv.ui.manager.upload.UploadMgr(uploadButton);\n      this.bind('currentFolder', uploadManager, 'folder');\n\n      this._pane = new qx.ui.splitpane.Pane();\n      main.add(this._pane, {edge: 'center'});\n\n      const rootFolder = cv.ui.manager.model.FileItem.ROOT = new cv.ui.manager.model.FileItem('.');\n      const fakeIconFile = cv.ui.manager.model.FileItem.getIconFile();\n      // TODO: needs to be verified by the backend\n      rootFolder.set({\n        overrideIcon: true,\n        writeable: true,\n        readable: true,\n        open: true,\n        fakeChildren: [fakeIconFile],\n        icon: cv.theme.dark.Images.getIcon('home', 18)\n      });\n      this.setCurrentFolder(rootFolder);\n      this._tree = new cv.ui.manager.tree.FileSystem(rootFolder);\n      this._tree.addListener('changeSelection', this._onChangeTreeSelection, this);\n\n      // left container\n      const leftContainer = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n\n      // left toolbar\n      const leftBar = new cv.ui.manager.ToolBar(uploadManager);\n      this.bind('currentFolder', leftBar, 'folder');\n      this.bind('currentSelection', leftBar, 'file');\n      leftBar.addListener('reload', this._tree.reload, this._tree);\n\n      // globally bind writeable folder to command for new files\n      const buttonConfig = menuBar.getButtonConfiguration();\n      this.bind('writeableFolder', buttonConfig['new-file'].args[2], 'enabled');\n      this.bind('writeableFolder', buttonConfig['new-folder'].args[2], 'enabled');\n      // this.bind('deleteableSelection', buttonConfig['delete'].args[2], 'enabled');\n\n      leftContainer.add(leftBar);\n      leftContainer.add(this._tree, {flex: 1});\n      this._pane.add(leftContainer, 0);\n      cv.ui.manager.model.Preferences.getInstance().bind('expertMode', leftContainer, 'visibility', {\n        converter: function (value) {\n          return value ? 'visible' : 'excluded';\n        }\n      });\n\n      this._mainContent = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n\n      // tab list\n      const list = new qx.ui.form.List(true);\n      list.setAppearance('open-files-tabs');\n      this._openFilesController = new qx.data.controller.List(this.getOpenFiles(), list, 'file.name');\n      this._openFilesController.setDelegate({\n        createItem: function () {\n          const item = new cv.ui.manager.form.FileTabItem();\n          item.addListener('close', this._onCloseFile, this);\n          return item;\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindDefaultProperties(item, index);\n          controller.bindProperty('file.permanent', 'permanent', null, item, index);\n          controller.bindProperty('file.modified', 'modified', null, item, index);\n          controller.bindProperty('icon', 'icon', null, item, index);\n          controller.bindProperty('closeable', 'closeable', null, item, index);\n        }\n      });\n      list.addListener('changeSelection', this._onChangeFileSelection, this);\n      this._mainContent.add(list);\n\n      this._stack = new qx.ui.container.Stack();\n      this._stack.addListener('changeSelection', this._onChangeStackSelection, this);\n      this._mainContent.add(this._stack, {flex: 1});\n      this._pane.add(this._mainContent, 1);\n\n      const startOpenFile = new cv.ui.manager.model.OpenFile(rootFolder, 'cv.ui.manager.Start');\n      startOpenFile.setCloseable(false);\n      this.getOpenFiles().push(startOpenFile);\n      list.setModelSelection([startOpenFile]);\n    },\n\n    _showAbout: function () {\n      const dialogConf = {\n        caption: qx.locale.Manager.tr('About'),\n        modal: true,\n        minWidth: Math.min(500, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: `\n<div class=\"about-cv\">\n <img src=\"resource/icons/comet_icon_128x128_ff8000.png\" width=\"128\" height=\"128\"/>\n <h2>CometVisu ${cv.Version.VERSION}</h2>\n <div class=\"info\">\n   <label for=\"date\">${qx.locale.Manager.tr('Build date')}: </label><span id=\"date\">${cv.Version.DATE}</span><br/>\n   <label for=\"build\">${qx.locale.Manager.tr('Build revision')}: </label><span id=\"build\">${cv.Version.REV}</span><br/>\n   <label for=\"lib-version\">${qx.locale.Manager.tr('Library version')}: </label><span id=\"lib-version\">${cv.Version.LIBRARY_VERSION}</span>\n </div>\n</div>`};\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects(\n      '_pane', '_tree', '_stack', '_mainContent', '_openFilesController'\n    );\n    // restore former command group\n    const application = qx.core.Init.getApplication();\n    const manager = application.getCommandManager();\n    manager.setActive(this._oldCommandGroup);\n    this._oldCommandGroup = null;\n\n    // defer the reset to let the dispose queue to be emptied before removing the root\n    new qx.util.DeferredCall(function () {\n      application.resetRoot();\n    }).schedule();\n\n    document.body.removeChild(this.__root);\n    this.__root = null;\n    this.__actionDispatcher = null;\n\n    qx.event.message.Bus.unsubscribe('cv.manager.*', this._onManagerEvent, this);\n\n    // destroy the singleton instance\n    delete cv.ui.manager.Main.$$instance;\n  }\n});\n","/* BigAlert.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * A dialog that alerts the user to something.\n *\n */\nqx.Class.define('cv.ui.manager.dialog.BigAlert', {\n  extend: qxl.dialog.Alert,\n  members: {\n    _hbox: null,\n\n    _applyImage: function(value, old) {\n      if (!this._image) {\n        this._image = new qx.ui.basic.Image().set({\n          scale: true,\n          height: 32,\n          width: 32\n        });\n        this._hbox.addAt(this._image, 0);\n      }\n      this._image.setSource(value);\n      this._image.setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    /**\n     * Create the main content of the widget\n     */\n    _createWidgetContent: function() {\n      let container = this._createDialogContainer();\n      this.add(container);\n      let hbox = this._hbox = new qx.ui.container.Composite(new qx.ui.layout.HBox(10));\n      let scroll = new qx.ui.container.Scroll(hbox);\n      scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      }, this);\n      container.add(scroll);\n      hbox.bind('width', scroll, 'width');\n      hbox.bind('height', scroll, 'height');\n      const image = this.getImage();\n      if (image) {\n        this._image = new qx.ui.basic.Image(image).set({\n          scale: true,\n          height: 32,\n          width: 32\n        });\n        hbox.add(this._image);\n      }\n      this._message = new qx.ui.basic.Label();\n      this._message.setRich(true);\n      this._message.setWidth(200);\n      this._message.setAllowStretchX(true);\n      hbox.addAt(this._message, 1, {\n        flex: 1\n      });\n      let buttonPane = this._createButtonPane();\n      let okButton = this._createOkButton();\n      buttonPane.add(okButton);\n      container.add(buttonPane);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_hbox');\n  }\n});\n","/* Section.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.model.config.Section', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name) {\n    this.base(arguments);\n    this.setName(name);\n    this.initOptions(new qx.data.Array());\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    name: {\n      check: 'String',\n      event: 'changeName',\n      init: ''\n    },\n\n    options: {\n      check: 'qx.data.Array',\n      deferredInit: true,\n      event: 'changeOptions'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    addOption: function(key, value) {\n      const options = this.getOptions();\n      const found = options.some(function (option) {\n        if (option.getKey() === key) {\n          option.setValue(value);\n          return true;\n        }\n        return false;\n      }, this);\n      if (!found) {\n        options.push(new cv.ui.manager.model.config.Option(key, value));\n      }\n    }\n  }\n});\n","/* SectionListItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This widgets shows and editable config section in a list.\n */\nqx.Class.define('cv.ui.manager.form.SectionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    const grid = new qx.ui.layout.Grid(8, 8);\n    grid.setColumnFlex(1, 1);\n    grid.setColumnAlign(0, 'left', 'top');\n    this._setLayout(grid);\n    this._createChildControl('section-title');\n    this._createChildControl('list');\n    this._createChildControl('delete');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-section'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.config.Section',\n      nullable: false,\n      apply: '_applyModel'\n    },\n\n    modified:{\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    },\n\n    readOnly: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadOnly'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'delete': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n    _originalName: null,\n    _originalOptions: null,\n\n    _applyModel: function (value, old) {\n      const nameField = this.getChildControl('name');\n      this.__unbindModel(old);\n      if (value) {\n        value.bind('name', nameField, 'value');\n        this._originalName = value.getName();\n        this._originalOptions = {};\n        value.getOptions().forEach(function (option) {\n          option.addListener('change', this.__checkForModification, this);\n          this._originalOptions[option.getKey()] = option.getValue();\n        }, this);\n        nameField.bind('value', value, 'name');\n        value.addListener('changeName', this.__checkForModification, this);\n        value.bind('options', this._listController, 'model');\n        // add at least one empty entry, when there are no options\n        if (value.getOptions().length === 0) {\n          const emptyOption = new cv.ui.manager.model.config.Option('', '');\n          value.getOptions().push(emptyOption);\n        }\n      } else {\n        this._originalName = null;\n        this._originalOptions = null;\n      }\n    },\n\n    __unbindModel: function (model) {\n      if (model) {\n        const nameField = this.getChildControl('name');\n        if (this._listController) {\n          model.removeRelatedBindings(this._listController);\n        }\n        model.removeListener('changeName', this.__checkForModification, this);\n        model.removeRelatedBindings(nameField);\n        nameField.removeRelatedBindings(model);\n        model.getOptions().forEach(function (option) {\n          option.removeListener('change', this.__checkForModification, this);\n        }, this);\n      }\n    },\n\n    __checkForModification: function () {\n      if (this._originalName !== this.getModel().getName()) {\n        this.setModified(true);\n        return;\n      }\n      // check if the still have the same the same amount of options\n      if (Object.keys(this._originalOptions).length !== this.getModel().getOptions().length) {\n        this.setModified(true);\n        return;\n      }\n      // compare options one by one\n      const modified = this.getModel().getOptions().some(function (option) {\n        return (!Object.prototype.hasOwnProperty.call(this._originalOptions, option.getKey()) ||\n          this._originalOptions[option.getKey()] !== option.getValue()\n        );\n      }, this);\n      this.setModified(modified);\n    },\n\n    _onDeleteOption: function (ev) {\n      const option = ev.getData();\n      const options = this.getModel().getOptions();\n      if (options.length === 1) {\n        // do not delete the last option, just reset its values\n        option.resetKey();\n        option.resetValue();\n      } else {\n        const removed = this.getModel().getOptions().remove(option);\n        if (removed) {\n          removed.removeListener('change', this.__checkForModification, this);\n        }\n      }\n      this.__checkForModification();\n    },\n\n    _onAddOption: function () {\n      const option = new cv.ui.manager.model.config.Option('', '');\n      option.addListener('change', this.__checkForModification, this);\n      this.getModel().getOptions().push(option);\n      this.__checkForModification();\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'section-title':\n           control = new qx.ui.basic.Label(this.tr('Section'));\n           this._add(control, {row: 0, column: 0});\n           break;\n\n         case 'name':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             required: true\n           });\n           this.bind('readOnly', control, 'readOnly');\n           this._add(control, {row: 0, column: 1});\n           break;\n\n         case 'delete':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n           control.setToolTipText(this.tr('Delete section'));\n           control.addListener('execute', function() {\n             this.fireDataEvent('delete', this.getModel());\n           }, this);\n           this.bind('readOnly', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'hidden' : 'visible';\n             }\n           });\n           this._add(control, {row: 0, column: 2});\n           break;\n\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(null, control);\n           this._listController.setNullValueTitle('header');\n           this._listController.setAllowNull(true);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.OptionListItem();\n             },\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteOption, this);\n               item.addListener('add', this._onAddOption, this);\n               this.bind('readOnly', item, 'readOnly');\n             }.bind(this),\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n             }\n           });\n           this._add(control, {row: 1, column: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_listController');\n  }\n});\n","/* MenuBar.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Main toolbar on top.\n */\nqx.Class.define('cv.ui.manager.MenuBar', {\n  extend: qx.ui.menubar.MenuBar,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this.__buttons = {};\n\n    this._draw();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _commandGroup: null,\n    __buttons: null,\n    __defaultButtonConfiguration: null,\n    __buttonConfiguration: null,\n\n    _draw: function () {\n      this._createChildControl('file');\n      this._createChildControl('edit');\n      this._createChildControl('preferences');\n      this.add(new qx.ui.core.Spacer(), {flex: 1});\n\n      this._createChildControl('title');\n      this.add(new qx.ui.core.Spacer(), {flex: 1});\n      this._createChildControl('help');\n\n      const editorGroup = new qx.ui.form.RadioGroup();\n\n      this.__defaultButtonConfiguration = {\n        'new-file': {\n          menu: 'new-menu',\n          args: [this.tr('New file'), cv.theme.dark.Images.getIcon('new-file', 18), this._commandGroup.get('new-file')],\n          enabled: true\n        },\n        'new-folder': {\n          menu: 'new-menu',\n          args: [this.tr('New folder'), cv.theme.dark.Images.getIcon('new-folder', 18), this._commandGroup.get('new-folder')],\n          enabled: true,\n          separator: 'after'\n        },\n        'new-config-file': {\n          menu: 'new-menu',\n          args: [this.tr('New config file')],\n          enabled: true\n        },\n        'upload': {\n          menu: 'file-menu',\n          clazz: com.zenesis.qx.upload.UploadMenuButton,\n          args: [this.tr('Upload file'), cv.theme.dark.Images.getIcon('upload', 18)],\n          enabled: true,\n          separator: 'before'\n        },\n        'save': {\n          menu: 'file-menu',\n          args: [this.tr('Save'), cv.theme.dark.Images.getIcon('save', 18), this._commandGroup.get('save')],\n          enabled: false,\n          separator: 'before'\n        },\n        'save-as': {\n          menu: 'file-menu',\n          args: [this.tr('Save as...'), null, this._commandGroup.get('save-as')],\n          enabled: false\n        },\n        'delete': {\n          args: [this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18), this._commandGroup.get('delete')],\n          enabled: false,\n          hidden: true\n        },\n        'quit': {\n          menu: 'file-menu',\n          args: [this.tr('Quit'), cv.theme.dark.Images.getIcon('quit', 18), this._commandGroup.get('quit')],\n          enabled: true,\n          separator: 'before'\n        },\n        // edit menu basics\n        'undo': {\n          menu: 'edit-menu',\n          args: [this.tr('Undo'), cv.theme.dark.Images.getIcon('undo', 18), this._commandGroup.get('undo')],\n          enabled: true\n        },\n        'redo': {\n          menu: 'edit-menu',\n          args: [this.tr('Redo'), cv.theme.dark.Images.getIcon('redo', 18), this._commandGroup.get('redo')],\n          enabled: true\n        },\n        'cut': {\n          menu: 'edit-menu',\n          args: [this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18), this._commandGroup.get('cut')],\n          enabled: false,\n          separator: 'before'\n        },\n        'copy': {\n          menu: 'edit-menu',\n          args: [this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18), this._commandGroup.get('copy')],\n          enabled: false\n        },\n        'paste': {\n          menu: 'edit-menu',\n          args: [this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18), this._commandGroup.get('paste')],\n          enabled: false\n        },\n        // preferences\n        'source-editor': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.RadioButton,\n          args: [this.tr('Use text editor')],\n          general: true,\n          enabled: true,\n          properties: {\n            model: 'source',\n            group: editorGroup\n          }\n        },\n        'xml-editor': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.RadioButton,\n          args: [this.tr('Use xml editor')],\n          general: true,\n          enabled: true,\n          properties: {\n            model: 'xml',\n            group: editorGroup\n          }\n        },\n        'quick-preview': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.CheckBox,\n          args: [this.tr('Enable quick preview')],\n          general: true,\n          enabled: true,\n          separator: 'before'\n        },\n        'expert-mode': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.CheckBox,\n          args: [this.tr('Expert mode')],\n          general: true,\n          enabled: true\n        },\n        'help': {\n          menu: 'help-menu',\n          args: [this.tr('Help'), cv.theme.dark.Images.getIcon('help', 18), this._commandGroup.get('help')],\n          enabled: false\n        },\n        'about': {\n          menu: 'help-menu',\n          args: [this.tr('About')],\n          enabled: false\n        }\n      };\n      this.maintainButtons();\n\n      const prefs = cv.ui.manager.model.Preferences.getInstance();\n\n      prefs.bind('defaultConfigEditor', editorGroup, 'modelSelection', {\n        converter: function (value) {\n          return [value];\n        }\n      });\n      editorGroup.getModelSelection().addListener('change', function () {\n        prefs.setDefaultConfigEditor(editorGroup.getModelSelection().getItem(0));\n      }, this);\n\n      this.__bindToPreference('quick-preview', 'quickPreview');\n      this.__bindToPreference('expert-mode', 'expertMode');\n    },\n\n    __bindToPreference: function (buttonName, preferenceName) {\n      const button = this.getButton(buttonName);\n      const prefs = cv.ui.manager.model.Preferences.getInstance();\n      prefs.bind(preferenceName, button, 'value');\n      button.bind('value', prefs, preferenceName);\n    },\n\n    maintainButtons: function (config) {\n      if (!config) {\n        config = this.__defaultButtonConfiguration;\n      } else {\n        config = Object.merge(this.__defaultButtonConfiguration, config);\n        this.__buttonConfiguration = config;\n      }\n      Object.keys(config).forEach(function (id) {\n        let button;\n        const buttonConf = config[id];\n        if (!Object.prototype.hasOwnProperty.call(this.__buttons, id)) {\n          // create button\n          const label = buttonConf.args[0];\n          const icon = buttonConf.args[1];\n          const command = buttonConf.args[2];\n          const ButtonClass = buttonConf.clazz || qx.ui.menu.Button;\n          if (qx.lang.Type.isString(command) || !command) {\n            // no command connected\n            button = new ButtonClass(label, icon);\n            if (command) {\n              // just add the string as shortcut hint\n              button.getChildControl('shortcut').setValue(command);\n            }\n          } else {\n            button = new ButtonClass(label, icon, command);\n            if (qx.core.Environment.get('qx.command.bindEnabled')) {\n              button.bind('enabled', command, 'enabled');\n            }\n          }\n          button.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.' + id);\n          }, this);\n          if (!buttonConf.hidden) {\n            const menu = this.getChildControl(buttonConf.menu);\n            if (!menu) {\n              throw new Error('no menu named ' + buttonConf.menu + ' found!');\n            }\n            if (buttonConf.separator === 'before') {\n              menu.add(new qx.ui.menu.Separator());\n            }\n            menu.add(button);\n            if (buttonConf.separator === 'after') {\n              menu.add(new qx.ui.menu.Separator());\n            }\n          }\n          this.__buttons[id] = button;\n\n          if (Object.prototype.hasOwnProperty.call(buttonConf, 'onAfterCreate')) {\n            buttonConf.onAfterCreate(button);\n          }\n        } else {\n          button = this.__buttons[id];\n        }\n        button.setEnabled(buttonConf.enabled);\n        if (buttonConf.properties) {\n          button.set(buttonConf.properties);\n        }\n      }, this);\n    },\n\n    getButton: function (id) {\n      return this.__buttons[id];\n    },\n\n    getButtonConfiguration: function () {\n      return this.__buttonConfiguration || this.__defaultButtonConfiguration;\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'title':\n           control = new qx.ui.basic.Label(this.tr('CometVisu Manager'));\n           this.add(control);\n           break;\n\n         case 'file':\n           control = new qx.ui.menubar.Button(this.tr('File'), null, this.getChildControl('file-menu'));\n           this.add(control);\n           break;\n\n         case 'edit':\n           control = new qx.ui.menubar.Button(this.tr('Edit'), null, this.getChildControl('edit-menu'));\n           this.add(control);\n           break;\n\n         case 'help':\n           control = new qx.ui.menubar.Button(this.tr('Help'), null, this.getChildControl('help-menu'));\n           this.add(control);\n           break;\n\n         case 'about':\n           control = new qx.ui.menubar.Button(this.tr('About'), null, this.getChildControl('help-menu'));\n           this.add(control);\n           break;\n\n         case 'new':\n           control = new qx.ui.menu.Button(this.tr('New'), null, null, this.getChildControl('new-menu'));\n           break;\n\n         case 'preferences':\n           control = new qx.ui.menubar.Button(this.tr('Preferences'), null, this.getChildControl('preferences-menu'));\n           this.add(control);\n           break;\n\n         case 'new-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'file-menu':\n           control = new qx.ui.menu.Menu();\n           control.add(this.getChildControl('new'));\n           break;\n\n         case 'edit-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'preferences-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'help-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n  }\n});\n","/* Image.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Fabian Jakobs (fjakobs)\n     * Sebastian Werner (wpbasti)\n\n************************************************************************ */\n\n/**\n * The image class displays an image file\n *\n * This class supports image clipping, which means that multiple images can be combined\n * into one large image and only the relevant part is shown.\n *\n * *Example*\n *\n * Here is a little example of how to use the widget.\n *\n * <pre class='javascript'>\n *   var image = new qx.ui.basic.Image(\"icon/32/actions/format-justify-left.png\");\n *\n *   this.getRoot().add(image);\n * </pre>\n *\n * This example create a widget to display the image\n * <code>icon/32/actions/format-justify-left.png</code>.\n *\n * *External Documentation*\n *\n * <a href='http://qooxdoo.org/docs/#desktop/widget/image.md' target='_blank'>\n * Documentation of this widget in the qooxdoo manual.</a>\n *\n * NOTE: Instances of this class must be disposed of after use\n *\n */\nqx.Class.define('cv.ui.manager.basic.Image',\n  {\n    extend : qx.ui.core.Widget,\n\n\n\n    /*\n    *****************************************************************************\n       CONSTRUCTOR\n    *****************************************************************************\n    */\n\n    /**\n     * @param source {String?null} The URL of the image to display.\n     */\n    construct : function(source) {\n      this.__contentElements = {};\n\n      this.base(arguments);\n\n      if (source) {\n        this.setSource(source);\n      }\n    },\n\n\n\n\n    /*\n    *****************************************************************************\n       PROPERTIES\n    *****************************************************************************\n    */\n\n    properties :\n      {\n        /** The URL of the image. Setting it will possibly abort loading of current image. */\n        source :\n          {\n            check : 'String',\n            init : null,\n            nullable : true,\n            event : 'changeSource',\n            apply : '_applySource',\n            themeable : true,\n            transform: '_transformSource'\n          },\n\n\n        /**\n         * Whether the image should be scaled to the given dimensions\n         *\n         * This is disabled by default because it prevents the usage\n         * of image clipping when enabled.\n         */\n        scale :\n          {\n            check : 'Boolean',\n            init : false,\n            event : 'changeScale',\n            themeable : true,\n            apply : '_applyScale'\n          },\n\n        forceScale: {\n          check: 'Boolean',\n          init: false\n        },\n\n        /**\n         * Whether to preserve the image ratio (ie prevent distortion), and which dimension\n         * to prioritise\n         */\n        forceRatio : {\n          init : 'auto',\n          check : [ 'disabled', 'height', 'width', 'auto' ],\n          apply : '_applyDimension'\n        },\n\n        /**\n         * Whether to allow scaling the image up\n         */\n        allowScaleUp : {\n          init : false,\n          check : 'Boolean',\n          apply : '_applyDimension'\n        },\n\n        // overridden\n        appearance :\n          {\n            refine : true,\n            init : 'image'\n          },\n\n\n        // overridden\n        allowShrinkX :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowShrinkY :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowGrowX :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowGrowY :\n          {\n            refine : true,\n            init : false\n          }\n      },\n\n\n    /*\n    *****************************************************************************\n       EVENTS\n    *****************************************************************************\n    */\n\n    events :\n      {\n        /**\n         * Fired if the image source can not be loaded. This event can only be\n         * fired for the first loading of an unmanaged resource (external image).\n         */\n        loadingFailed : 'qx.event.type.Event',\n\n\n        /**\n         * Fired if the image has been loaded. This is even true for managed\n         * resources (images known by generator).\n         */\n        loaded : 'qx.event.type.Event',\n\n\n        /** Fired when the pending request has been aborted. */\n        aborted : 'qx.event.type.Event'\n      },\n\n\n    statics:\n      {\n        PLACEHOLDER_IMAGE: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'\n      },\n\n    /*\n    *****************************************************************************\n       MEMBERS\n    *****************************************************************************\n    */\n\n    members :\n      {\n        __width : null,\n        __height : null,\n        __mode : null,\n        __contentElements : null,\n        __currentContentElement : null,\n        __wrapper : null,\n        __requestId : 0,\n\n        /**\n         * Remove the \"resource/\" prefix when the ResourceManager knows the image\n         * @param value\n         * @return {*}\n         * @private\n         */\n        _transformSource: function (value) {\n          if (value && value.startsWith('resource/')) {\n            const ResourceManager = qx.util.ResourceManager.getInstance();\n            if (ResourceManager.has(value.substring('resource/'.length))) {\n              return value.substring('resource/'.length);\n            }\n          }\n          return value;\n        },\n\n\n        // overridden\n        _onChangeTheme : function() {\n          this.base(arguments);\n          // restyle source (theme change might have changed the resolved url)\n          this._styleSource();\n        },\n\n        /*\n        ---------------------------------------------------------------------------\n          WIDGET API\n        ---------------------------------------------------------------------------\n        */\n\n        // overridden\n        getContentElement : function() {\n          return this.__getSuitableContentElement();\n        },\n\n\n        // overridden\n        _createContentElement : function() {\n          return this.__getSuitableContentElement();\n        },\n\n\n        // overridden\n        _getContentHint : function() {\n          return {\n            width : this.__width || 0,\n            height : this.__height || 0\n          };\n        },\n\n        // overridden\n        _applyDecorator : function(value, old) {\n          this.base(arguments, value, old);\n\n          let source = this.getSource();\n          source = qx.util.AliasManager.getInstance().resolve(source);\n          let el = this.getContentElement();\n          if (this.__wrapper) {\n            el = el.getChild(0);\n          }\n          this.__setSource(el, source);\n        },\n\n        // overridden\n        _applyTextColor : function(value) {\n          if (this.__getMode() === 'font') {\n            let el = this.getContentElement();\n            if (this.__wrapper) {\n              el = el.getChild(0);\n            }\n\n            if (value) {\n              el.setStyle('color', qx.theme.manager.Color.getInstance().resolve(value));\n            } else {\n              el.removeStyle('color');\n            }\n          }\n        },\n\n        // overridden\n        _applyPadding : function(value, old, name) {\n          this.base(arguments, value, old, name);\n\n          const element = this.getContentElement();\n          if (this.__wrapper) {\n            element.getChild(0).setStyles({\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          } else if (this.__getMode() === 'font') {\n            element.setStyles({\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          } else if (element instanceof qx.html.Image) {\n            element.setPadding(\n              this.getPaddingLeft() || 0, this.getPaddingTop() || 0\n            );\n          }\n        },\n\n        renderLayout : function(left, top, width, height) {\n          this.base(arguments, left, top, width, height);\n\n          const element = this.getContentElement();\n          if (this.__wrapper) {\n            element.getChild(0).setStyles({\n              width: width - (this.getPaddingLeft() || 0) - (this.getPaddingRight() || 0),\n              height: height - (this.getPaddingTop() || 0) - (this.getPaddingBottom() || 0),\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          }\n        },\n\n\n\n\n        /*\n        ---------------------------------------------------------------------------\n          IMAGE API\n        ---------------------------------------------------------------------------\n        */\n\n        // property apply, overridden\n        _applyEnabled : function(value, old) {\n          this.base(arguments, value, old);\n\n          if (this.getSource()) {\n            this._styleSource();\n          }\n        },\n\n\n        // property apply\n        _applySource : function(value, old) {\n          // abort loading current image\n          if (old) {\n            if (qx.io.ImageLoader.isLoading(old)) {\n              qx.io.ImageLoader.abort(old);\n            }\n          }\n\n          this._styleSource();\n        },\n\n\n        // property apply\n        _applyScale : function(value) {\n          this._styleSource();\n        },\n\n\n        /**\n         * Remembers the mode to keep track which contentElement is currently in use.\n         * @param mode {String} internal mode (alphaScaled|scaled|nonScaled)\n         */\n        __setMode : function(mode) {\n          this.__mode = mode;\n        },\n\n\n        /**\n         * Returns the current mode if set. Otherwise checks the current source and\n         * the current scaling to determine the current mode.\n         *\n         * @return {String} current internal mode\n         */\n        __getMode : function() {\n          if (this.__mode === null) {\n            const source = this.getSource();\n\n            if (source && qx.lang.String.startsWith(source, '@')) {\n              this.__mode = 'font';\n            } else if (source && source.startsWith('<svg')) {\n              this.__mode = 'svg';\n            } else {\n              let isPng = false;\n              if (source !== null) {\n                isPng = source.endsWith('.png');\n              }\n\n              if (this.getScale() && isPng && qx.core.Environment.get('css.alphaimageloaderneeded')) {\n                this.__mode = 'alphaScaled';\n              } else if (this.getScale() || this.getForceScale()) {\n                this.__mode = 'scaled';\n              } else {\n                this.__mode = 'nonScaled';\n              }\n            }\n          }\n\n          return this.__mode;\n        },\n\n\n        /**\n         * Creates a contentElement suitable for the current mode\n         *\n         * @param mode {String} internal mode\n         * @return {qx.html.Image} suitable image content element\n         */\n        __createSuitableContentElement : function(mode) {\n          let scale;\n          let tagName;\n          let Clazz = qx.html.Image;\n\n          switch (mode) {\n            case 'svg':\n              Clazz = qx.html.Element;\n              tagName = 'div';\n              break;\n            case 'font':\n              Clazz = qx.html.Label;\n              scale = true;\n              tagName = 'div';\n              break;\n            case 'alphaScaled':\n              scale = true;\n              tagName = 'div';\n              break;\n            case 'nonScaled':\n              scale = false;\n              tagName = 'div';\n              break;\n            default:\n              scale = true;\n              tagName = 'img';\n              break;\n          }\n\n          const element = new (Clazz)(tagName);\n          element.connectWidget(this);\n          element.setStyles({\n            'overflowX': 'hidden',\n            'overflowY': 'hidden',\n            'boxSizing': 'border-box'\n          });\n\n          if (mode === 'font') {\n            element.setRich(true);\n          } else if (mode !== 'svg') {\n            element.setScale(scale);\n\n            if (qx.core.Environment.get('css.alphaimageloaderneeded')) {\n              const wrapper = this.__wrapper = new qx.html.Element('div');\n              element.connectWidget(this);\n              wrapper.setStyle('position', 'absolute');\n              wrapper.add(element);\n              return wrapper;\n            }\n          }\n\n          return element;\n        },\n\n\n        /**\n         * Returns a contentElement suitable for the current mode\n         *\n         * @return {qx.html.Image} suitable image contentElement\n         */\n        __getSuitableContentElement : function() {\n          if (this.$$disposed) {\n            return null;\n          }\n\n          const mode = this.__getMode();\n\n          if (!this.__contentElements[mode]) {\n            this.__contentElements[mode] = this.__createSuitableContentElement(mode);\n          }\n\n          const element = this.__contentElements[mode];\n\n          if (!this.__currentContentElement) {\n            this.__currentContentElement = element;\n          }\n\n          return element;\n        },\n\n\n        /**\n         * Applies the source to the clipped image instance or preload\n         * an image to detect sizes and apply it afterwards.\n         *\n         */\n        _styleSource : function() {\n          const AliasManager = qx.util.AliasManager.getInstance();\n          const ResourceManager = qx.util.ResourceManager.getInstance();\n\n          let source = AliasManager.resolve(this.getSource());\n\n          let element = this.getContentElement();\n          if (this.__wrapper) {\n            element = element.getChild(0);\n          }\n\n          if (!source) {\n            this.__resetSource(element);\n            return;\n          }\n\n          this.__checkForContentElementSwitch(source);\n\n          if ((qx.core.Environment.get('engine.name') == 'mshtml') &&\n            (parseInt(qx.core.Environment.get('engine.version'), 10) < 9 ||\n              qx.core.Environment.get('browser.documentmode') < 9)) {\n            const repeat = this.getScale() ? 'scale' : 'no-repeat';\n            element.tagNameHint = qx.bom.element.Decoration.getTagName(repeat, source);\n          }\n\n          const contentEl = this.__getContentElement();\n\n          // Detect if the image registry knows this image\n          if (ResourceManager.isFontUri(source)) {\n            this.__setManagedImage(contentEl, source);\n            const color = this.getTextColor();\n            if (qx.lang.Type.isString(color)) {\n              this._applyTextColor(color, null);\n            }\n          } else if (source && source.startsWith('<svg')) {\n            this.__setManagedImage(contentEl, source);\n          } else if (ResourceManager.has(source)) {\n            const highResolutionSource = ResourceManager.findHighResolutionSource(source);\n            if (highResolutionSource) {\n              const imageWidth = ResourceManager.getImageWidth(source);\n              const imageHeight = ResourceManager.getImageHeight(source);\n              this.setWidth(imageWidth);\n              this.setHeight(imageHeight);\n\n              // set background size on current element (div or img)\n              const backgroundSize = imageWidth + 'px, ' + imageHeight + 'px';\n              this.__currentContentElement.setStyle('background-size', backgroundSize);\n\n              this.setSource(highResolutionSource);\n              source = highResolutionSource;\n            }\n            this.__setManagedImage(contentEl, source);\n            this.__fireLoadEvent();\n          } else if (qx.io.ImageLoader.isLoaded(source)) {\n            this.__setUnmanagedImage(contentEl, source);\n            this.__fireLoadEvent();\n          } else {\n            this.__loadUnmanagedImage(contentEl, source);\n          }\n        },\n\n\n        /**\n         * Helper function, which fires <code>loaded</code> event asynchronously.\n         * It emulates native <code>loaded</code> event of an image object. This\n         * helper will be called, if you try to load a managed image or an\n         * previously loaded unmanaged image.\n         */\n        __fireLoadEvent : function() {\n          this.__requestId++;\n          qx.bom.AnimationFrame.request(function(rId) {\n            // prevent firing of the event if source changed in the meantime\n            if (rId === this.__requestId) {\n              this.fireEvent('loaded');\n            } else {\n              this.fireEvent('aborted');\n            }\n          }.bind(this, this.__requestId));\n        },\n\n\n        /**\n         * Returns the content element.\n         * @return {qx.html.Image} content element\n         */\n        __getContentElement : function() {\n          let contentEl = this.__currentContentElement;\n          if (this.__wrapper) {\n            contentEl = contentEl.getChild(0);\n          }\n\n          return contentEl;\n        },\n\n\n        /**\n         * Checks if the current content element is capable to display the image\n         * with the current settings (scaling, alpha PNG)\n         *\n         * @param source {String} source of the image\n         */\n        __checkForContentElementSwitch : qx.core.Environment.select('engine.name',\n          {\n            'mshtml' : function(source) {\n              const alphaImageLoader = qx.core.Environment.get('css.alphaimageloaderneeded');\n              const isPng = source.endsWith('.png');\n              const isFont = source.startsWith('@');\n              const isSvg = source.startsWith('<svg');\n              const scale = this.getScale() || this.getForceScale();\n\n              if (isFont) {\n                this.__setMode('font');\n              } else if (isSvg) {\n                this.__setMode('svg');\n              } else if (alphaImageLoader && isPng) {\n                if (scale && this.__getMode() !== 'alphaScaled') {\n                  this.__setMode('alphaScaled');\n                } else if (!scale && this.__getMode() !== 'nonScaled') {\n                  this.__setMode('nonScaled');\n                }\n              } else if (scale && this.__getMode() !== 'scaled') {\n                  this.__setMode('scaled');\n                } else if (!scale && this.__getMode() !== 'nonScaled') {\n                  this.__setMode('nonScaled');\n                }\n\n              this.__checkForContentElementReplacement(this.__getSuitableContentElement());\n            },\n\n            'default' : function(source) {\n              const isFont = source && qx.lang.String.startsWith(source, '@');\n              const isSvg = source.startsWith('<svg');\n              const scale = this.getScale() || this.getForceScale();\n\n              if (isFont) {\n                this.__setMode('font');\n              } else if (isSvg) {\n                this.__setMode('svg');\n              } else if (scale && this.__getMode() !== 'scaled') {\n                this.__setMode('scaled');\n              } else if (!scale && this.__getMode() !== 'nonScaled') {\n                this.__setMode('nonScaled');\n              }\n\n              this.__checkForContentElementReplacement(this.__getSuitableContentElement());\n            }\n          }),\n\n\n        /**\n         * Checks the current child and replaces it if necessary\n         *\n         * @param elementToAdd {qx.html.Image} content element to add\n         */\n        __checkForContentElementReplacement : function(elementToAdd) {\n          const currentContentElement = this.__currentContentElement;\n\n          if (currentContentElement !== elementToAdd) {\n            if (currentContentElement !== null) {\n              const pixel = 'px';\n              const styles = {};\n\n              //inherit styles from current element\n              const currentStyles = currentContentElement.getAllStyles();\n              if (currentStyles) {\n                for (let prop in currentStyles) {\n                  styles[prop] = currentStyles[prop];\n                }\n              }\n\n              // Don't transfer background image when switching from image to icon font\n              if (this.__getMode() === 'font' || this.__getMode() === 'svg') {\n                delete styles.backgroundImage;\n              }\n\n              // Copy dimension and location of the current content element\n              const bounds = this.getBounds();\n              if (bounds !== null) {\n                styles.width = bounds.width + pixel;\n                styles.height = bounds.height + pixel;\n              }\n\n              const insets = this.getInsets();\n              styles.left = parseInt(currentContentElement.getStyle('left') || insets.left) + pixel;\n              styles.top = parseInt(currentContentElement.getStyle('top') || insets.top) + pixel;\n\n              styles.zIndex = 10;\n\n              const newEl = this.__wrapper ? elementToAdd.getChild(0) : elementToAdd;\n              newEl.setStyles(styles, true);\n              newEl.setSelectable(this.getSelectable());\n\n              if (!currentContentElement.isVisible()) {\n                elementToAdd.hide();\n              } else if (!elementToAdd.isVisible()) {\n                elementToAdd.show();\n              }\n\n              if (!currentContentElement.isIncluded()) {\n                elementToAdd.exclude();\n              } else if (!elementToAdd.isIncluded()) {\n                elementToAdd.include();\n              }\n\n              const container = currentContentElement.getParent();\n\n              if (container) {\n                const index = container.getChildren().indexOf(currentContentElement);\n                container.removeAt(index);\n                container.addAt(elementToAdd, index);\n              }\n              // force re-application of source so __setSource is called again\n              const hint = newEl.getNodeName();\n              if (newEl.setSource) {\n                newEl.setSource(null);\n              } else if (newEl.setValue) {\n                newEl.setValue('');\n              } else {\n                newEl.removeAll();\n              }\n              const currentEl = this.__getContentElement();\n              newEl.tagNameHint = hint;\n              newEl.setAttribute('class', currentEl.getAttribute('class'));\n\n              // Flush elements to make sure the DOM elements are created.\n              qx.html.Element.flush();\n              const currentDomEl = currentEl.getDomElement();\n              const newDomEl = elementToAdd.getDomElement();\n\n              // copy event listeners\n              const listeners = currentContentElement.getListeners() || [];\n              listeners.forEach(function(listenerData) {\n                elementToAdd.addListener(listenerData.type, listenerData.handler, listenerData.self, listenerData.capture);\n              });\n\n              if (currentDomEl && newDomEl) {\n                // Switch the DOM elements' hash codes. This is required for the event\n                // layer to work [BUG #7447]\n                const currentHash = currentDomEl.$$hash;\n                currentDomEl.$$hash = newDomEl.$$hash;\n                newDomEl.$$hash = currentHash;\n              }\n\n              this.__currentContentElement = elementToAdd;\n            }\n          }\n        },\n\n\n        /**\n         * Use the ResourceManager to set a managed image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setManagedImage : function(el, source) {\n          const ResourceManager = qx.util.ResourceManager.getInstance();\n          const isFont = ResourceManager.isFontUri(source);\n          const isSvg = source.startsWith('<svg');\n\n          // Try to find a disabled image in registry\n          if (!this.getEnabled()) {\n            const disabled = source.replace(/\\.([a-z]+)$/, '-disabled.$1');\n            if (!isFont && ResourceManager.has(disabled)) {\n              source = disabled;\n              this.addState('replacement');\n            } else {\n              this.removeState('replacement');\n            }\n          }\n\n          // Optimize case for enabled changes when no disabled image was found\n          if (!isFont && !isSvg && el.getSource() === source) {\n            return;\n          }\n\n          // Special case for non resource manager handled font icons\n          if (isFont) {\n            // Don't use scale if size is set via postfix\n            if (this.getScale() && parseInt(source.split('/')[2], 10)) {\n              this.setScale(false);\n            }\n\n            // Adjust size if scaling is applied\n            let width;\n            let height;\n            if (this.getScale()) {\n              const hint = this.getSizeHint();\n              width = this.getWidth() || hint.width;\n              height = this.getHeight() || hint.height;\n            } else {\n              const font = qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]);\n              if (qx.core.Environment.get('qx.debug')) {\n                this.assertObject(font, 'Virtual image source contains unkown font descriptor');\n              }\n              const size = parseInt(source.split('/')[2] || font.getSize(), 10);\n              width = ResourceManager.getImageWidth(source) || size;\n              height = ResourceManager.getImageHeight(source) || size;\n            }\n\n            this.__updateContentHint(width, height);\n            this.__setSource(el, source);\n          } else if (isSvg) {\n            // Apply source\n            this.__setSource(el, source);\n\n            // Adjust size\n            this.__updateContentHint(40, 40);\n          } else {\n            // Apply source\n            this.__setSource(el, source);\n\n            // Compare with old sizes and relayout if necessary\n            this.__updateContentHint(\n              ResourceManager.getImageWidth(source),\n              ResourceManager.getImageHeight(source)\n            );\n          }\n        },\n\n        _applyDimension : function() {\n          this.base(arguments);\n\n          const isFont = this.getSource() && qx.lang.String.startsWith(this.getSource(), '@');\n          if (isFont) {\n            const el = this.getContentElement();\n            if (el) {\n              if (this.getScale()) {\n                const hint = this.getSizeHint();\n                const width = this.getWidth() || hint.width || 40;\n                const height = this.getHeight() || hint.height || 40;\n                el.setStyle('fontSize', (width > height ? height : width) + 'px');\n              } else {\n                const font = qx.theme.manager.Font.getInstance().resolve(this.getSource().match(/@([^/]+)/)[1]);\n                el.setStyle('fontSize', font.getSize() + 'px');\n              }\n            }\n          } else {\n            this.__updateContentHint();\n          }\n        },\n\n        /**\n         * Use the infos of the ImageLoader to set an unmanaged image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setUnmanagedImage : function(el, source) {\n          const ImageLoader = qx.io.ImageLoader;\n\n          // Apply source\n          this.__setSource(el, source);\n\n          // Compare with old sizes and relayout if necessary\n          const width = ImageLoader.getWidth(source);\n          const height = ImageLoader.getHeight(source);\n          this.__updateContentHint(width, height);\n        },\n\n\n        /**\n         * Use the ImageLoader to load an unmanaged image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __loadUnmanagedImage : function(el, source) {\n          const ImageLoader = qx.io.ImageLoader;\n\n          if (qx.core.Environment.get('qx.debug')) {\n            // loading external images via HTTP/HTTPS is a common usecase, as is\n            // using data URLs.\n            const sourceLC = source.toLowerCase();\n            if (!sourceLC.startsWith('http') &&\n              !sourceLC.startsWith('data:image/')) {\n              const self = this.self(arguments);\n\n              if (!self.__warned) {\n                self.__warned = {};\n              }\n\n              if (!self.__warned[source]) {\n                this.debug('try to load an unmanaged relative image: ' + source);\n                self.__warned[source] = true;\n              }\n            }\n          }\n\n          // only try to load the image if it not already failed\n          if (!ImageLoader.isFailed(source)) {\n            ImageLoader.load(source, this.__loaderCallback, this);\n          } else {\n            this.__resetSource(el);\n          }\n        },\n\n        /**\n         * Reset source displayed by the DOM element.\n         *\n         * @param el {Element} image DOM element\n         */\n        __resetSource : function(el) {\n          if (el !== null) {\n            if (el instanceof qx.html.Image) {\n              el.resetSource();\n            } else if (el instanceof qx.html.Label) {\n              el.resetValue();\n            } else {\n              el.removeAll();\n            }\n          }\n        },\n\n        /**\n         * Combines the decorator's image styles with our own image to make sure\n         * gradient and backgroundImage decorators work on Images.\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setSource: function (el, source) {\n          const isFont = source && qx.lang.String.startsWith(source, '@');\n          const isSvg = source && qx.lang.String.startsWith(source, '<svg');\n\n          if (isSvg) {\n            const child = new qx.html.Element('svg');\n            child.useMarkup(source);\n            el.removeAll();\n            el.add(child);\n          } else if (isFont) {\n            const sparts = source.split('/');\n            let fontSource = source;\n            if (sparts.length > 2) {\n              fontSource = sparts[0] + '/' + sparts[1];\n            }\n\n\n            const ResourceManager = qx.util.ResourceManager.getInstance();\n            const font = qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]);\n            const fontStyles = qx.lang.Object.clone(font.getStyles());\n            delete fontStyles.color;\n            el.setStyles(fontStyles);\n            el.setStyle('font');\n            el.setStyle('display', 'table-cell');\n            el.setStyle('verticalAlign', 'middle');\n            el.setStyle('textAlign', 'center');\n\n            if (this.getScale()) {\n              el.setStyle('fontSize', (this.__width > this.__height ? this.__height : this.__width) + 'px');\n            } else {\n              const size = parseInt(sparts[2] || qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]).getSize());\n              el.setStyle('fontSize', size + 'px');\n            }\n\n            const resource = ResourceManager.getData(fontSource);\n            if (resource) {\n              el.setValue(String.fromCharCode(resource[2]));\n            } else {\n              const charCode = parseInt(qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)\\/(.*)$/)[2]), 16);\n              if (qx.core.Environment.get('qx.debug')) {\n                this.assertNumber(charCode, 'Font source needs either a glyph name or the unicode number in hex');\n              }\n              el.setValue(String.fromCharCode(charCode));\n            }\n\n            return;\n          } else if (el.getNodeName() === 'div') {\n            // checks if a decorator already set.\n            // In this case we have to merge background styles\n            const decorator = qx.theme.manager.Decoration.getInstance().resolve(this.getDecorator());\n            if (decorator) {\n              const hasGradient = (decorator.getStartColor() && decorator.getEndColor());\n              const hasBackground = decorator.getBackgroundImage();\n              if (hasGradient || hasBackground) {\n                const repeat = this.getScale() ? 'scale' : 'no-repeat';\n\n                // get the style attributes for the given source\n                const attr = qx.bom.element.Decoration.getAttributes(source, repeat);\n                // get the background image(s) defined by the decorator\n                const decoratorStyle = decorator.getStyles(true);\n\n                const combinedStyles = {\n                  'backgroundImage': attr.style.backgroundImage,\n                  'backgroundPosition': (attr.style.backgroundPosition || '0 0'),\n                  'backgroundRepeat': (attr.style.backgroundRepeat || 'no-repeat')\n                };\n\n                if (hasBackground) {\n                  combinedStyles['backgroundPosition'] += ',' + decoratorStyle['background-position'] || '0 0';\n                  combinedStyles['backgroundRepeat'] += ', ' + decorator.getBackgroundRepeat();\n                }\n\n                if (hasGradient) {\n                  combinedStyles['backgroundPosition'] += ', 0 0';\n                  combinedStyles['backgroundRepeat'] += ', no-repeat';\n                }\n\n                combinedStyles['backgroundImage'] += ',' + (decoratorStyle['background-image'] || decoratorStyle['background']);\n\n                // apply combined background images\n                el.setStyles(combinedStyles);\n\n                return;\n              }\n            } else if (el.setSource) {\n              // force re-apply to remove old decorator styles\n              el.setSource(null);\n            }\n          }\n          if (el.setSource) {\n            el.setSource(source);\n          }\n        },\n\n        /**\n         * Event handler fired after the preloader has finished loading the icon\n         *\n         * @param source {String} Image source which was loaded\n         * @param imageInfo {Map} Dimensions of the loaded image\n         */\n        __loaderCallback : function(source, imageInfo) {\n          // Ignore the callback on already disposed images\n          if (this.$$disposed === true) {\n            return;\n          }\n\n          // Ignore when the source has already been modified\n          if (source !== qx.util.AliasManager.getInstance().resolve(this.getSource())) {\n            this.fireEvent('aborted');\n            return;\n          }\n\n          /// Output a warning if the image could not loaded and quit\n          if (imageInfo.failed) {\n            this.warn('Image could not be loaded: ' + source);\n            this.fireEvent('loadingFailed');\n          } else if (imageInfo.aborted) {\n            this.fireEvent('aborted');\n            return;\n          } else {\n            this.fireEvent('loaded');\n          }\n\n          // Update image\n          this.__setUnmanagedImage(this.__getContentElement(), source);\n        },\n\n\n        /**\n         * Updates the content hint when the image size has been changed\n         *\n         * @param width {Integer} width of the image\n         * @param height {Integer} height of the image\n         */\n        __updateContentHint : function(width, height) {\n          if (width === undefined) {\n            width = this.__width;\n          }\n          if (height === undefined) {\n            height = this.__height;\n          }\n          if (this._recalc(width, height)) {\n            qx.ui.core.queue.Layout.add(this);\n          }\n        },\n\n\n        /**\n         * Recalculates the size of the image, according to scaling parameters\n         * @param originalWidth\n         * @param originalHeight\n         */\n        _recalc: function(originalWidth, originalHeight) {\n          const maxWidth = this.getMaxWidth();\n          const maxHeight = this.getMaxHeight();\n          const minWidth = this.getMinWidth();\n          const minHeight = this.getMinHeight();\n\n          let width = originalWidth;\n          let height = originalHeight;\n\n          const ratio = originalHeight / originalWidth;\n\n          switch (this.getForceRatio()) {\n            case 'height':\n              if (maxHeight !== null && height > maxHeight) {\n                height = maxHeight;\n                width = height / ratio;\n              } else if (height < minHeight) {\n                height = minHeight;\n                width = height / ratio;\n              }\n              if (height < maxHeight && this.isAllowScaleUp()) {\n                height = maxHeight;\n                width = height / ratio;\n              }\n              break;\n\n            case 'width':\n              if (maxWidth !== null && width > maxWidth) {\n                width = maxWidth;\n                height = width * ratio;\n              } else if (width < minWidth) {\n                width = minWidth;\n                height = width * ratio;\n              }\n              if (width < maxWidth && this.isAllowScaleUp()) {\n                width = maxWidth;\n                height = width * ratio;\n              }\n              break;\n\n            case 'auto':\n            case 'bestfit':\n              if (maxWidth !== null && width > maxWidth) {\n                width = maxWidth;\n                height = width * ratio;\n              } else if (width < minWidth) {\n                width = minWidth;\n                height = width * ratio;\n              }\n              if (width < maxWidth && this.isAllowScaleUp()) {\n                width = maxWidth;\n                height = width * ratio;\n              }\n              if (maxHeight !== null && height > maxHeight) {\n                height = maxHeight;\n                width = height / ratio;\n              }\n              break;\n          }\n\n          width = Math.round(width);\n          height = Math.round(height);\n          if (width != this.__width || height != this.__height) {\n            this.__width = width;\n            this.__height = height;\n            return true;\n          }\n          return false;\n        }\n      },\n\n\n    /*\n    *****************************************************************************\n       DESTRUCTOR\n    *****************************************************************************\n    */\n\n    destruct : function() {\n      for (let mode in this.__contentElements) {\n        if (Object.prototype.hasOwnProperty.call(this.__contentElements, mode)) {\n          this.__contentElements[mode].disconnectWidget(this);\n        }\n      }\n\n      delete this.__currentContentElement;\n      if (this.__wrapper) {\n        delete this.__wrapper;\n      }\n\n      this._disposeMap('__contentElements');\n    }\n  });\n","/* SourceCodeField.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.form.SourceCodeField', {\n  extend : qx.ui.core.Widget,\n  implement : [\n    qx.ui.form.IStringForm,\n    qx.ui.form.IForm\n  ],\n  include : [\n    qx.ui.form.MForm\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (value, type) {\n    this.base(arguments);\n    this._init();\n\n    if (type) {\n      this.setType(type);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /** Fired when the value was modified */\n    'changeValue' : 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: 'String',\n      init: 'xml',\n      apply: '_applyType'\n    },\n    // overridden\n    focusable: {\n      refine : true,\n      init : true\n    },\n    autoSize: {\n      check: 'Boolean',\n      init: false,\n      apply: '_autoSize'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _editor: null,\n    __delayedValue: null,\n    __areaHeight: null,\n    _hasBeenEdited: false,\n\n    _applyType: function (value) {\n      if (value && this.__delayedValue) {\n        this.setValue(this.__delayedValue);\n        this.__delayedValue = null;\n      }\n    },\n\n    _autoSize: function () {\n      if (this._editor && this.isAutoSize()) {\n        const contentHeight = (this._editor.getModel().getLineCount() + 1) * 19;\n        this._setAreaHeight(contentHeight);\n      }\n    },\n\n    /**\n     * Sets the element's value.\n     *\n     * @param value {String|null} The new value of the element.\n     */\n    setValue: function(value) {\n      if (!this._hasBeenEdited) {\n        if (this._editor && this.getType()) {\n          this._editor.setValue(value);\n        } else {\n          this.__delayedValue = value;\n        }\n      }\n      this._autoSize();\n    },\n\n\n    /**\n     * Resets the element's value to its initial value.\n     */\n    resetValue : function() {\n      if (this._editor) {\n        this._editor.setValue('');\n      }\n    },\n\n\n    /**\n     * The element's user set value.\n     *\n     * @return {String|null} The value.\n     */\n    getValue : function() {\n      if (this._editor) {\n        return this._editor.getValue();\n      } else if (this.__delayedValue) {\n        return this.__delayedValue;\n      } \n        return '';\n    },\n\n    _init: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._init, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', () => {\n            this._init();\n          }, this);\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: false\n            },\n            theme: 'vs-dark'\n          });\n          if (this.getType()) {\n            const model = this._editor.getModel();\n            const uri = monaco.Uri.parse('cv://SourceCode.' + this.getType());\n            let newModel = window.monaco.editor.getModel(uri);\n            if (!newModel) {\n              newModel = window.monaco.editor.createModel(this.__delayedValue, this.getType(), uri);\n            } else {\n              newModel.setValue(this.__delayedValue);\n            }\n            if (model !== newModel) {\n              newModel.updateOptions({\n                tabSize: 2,\n                indentSize: 2,\n                insertSpaces: true\n              });\n              this._editor.setModel(newModel);\n            }\n          }\n          if (this.__delayedValue) {\n            this.__delayedValue = null;\n          }\n          this._editor.onDidChangeModelContent(this._onContentChange.bind(this));\n        }\n      }\n    },\n\n    _onContentChange: function () {\n      this._hasBeenEdited = true;\n      this.fireDataEvent('changeValue', this._editor.getValue());\n      this._autoSize();\n    },\n\n    // overridden\n    getFocusElement : function() {\n      const el = this.getContentElement();\n      if (el) {\n        return el;\n      }\n      return null;\n    },\n\n    _setAreaHeight: function(height) {\n      if (this.__areaHeight !== height) {\n        this.__areaHeight = height;\n        qx.ui.core.queue.Layout.add(this);\n        qx.ui.core.queue.Manager.flush();\n        if (this._editor) {\n          this._editor.layout();\n        }\n      }\n    },\n\n    // overridden\n    _getContentHint: function() {\n      const hint = this.base(arguments);\n\n      if (this.isAutoSize()) {\n        hint.height = this.__areaHeight || hint.height;\n      }\n\n      return hint;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._hasBeenEdited = false;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n  }\n});\n","/* Option.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Option model for a VirtualComboBox / -SelectBox\n */\nqx.Class.define('cv.ui.manager.form.Option', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label, icon, value, hints) {\n    this.base(arguments);\n    if (label) {\n      this.setLabel(label);\n    }\n    if (icon) {\n      this.setIcon(icon);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n    if (hints) {\n      this.setHints(hints);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: ['default', 'group', 'state', 'error'],\n      init: 'default',\n      event: 'changeType'\n    },\n    label: {\n      check: 'String',\n      event: 'changeLabel'\n    },\n    icon: {\n      event: 'changeIcon',\n      nullable: true\n    },\n    value: {\n      check: 'String',\n      event: 'changeValue',\n      nullable: true\n    },\n    hints: {\n      check: 'Object',\n      nullable: true\n    }\n  }\n});\n","/* ListItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * ListItem that uses cv.ui.manager.basic.Image\n */\nqx.Class.define('cv.ui.manager.form.ListItem', {\n  extend: qx.ui.form.ListItem,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'icon':\n          control = new cv.ui.manager.basic.Image(this.getIcon());\n          control.set({\n            anonymous: true,\n            scale: true,\n            maxHeight: 64\n          });\n          this._addAt(control, 0);\n          if (this.getIcon() === null || this.getShow() === 'label') {\n            control.exclude();\n          }\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  }\n});\n","/* VirtualSelectBox.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * qx.ui.form.VirtualSelectBox that uses cv.ui.manager.form.ListItem as 'atom' childcontrol.\n */\nqx.Class.define('cv.ui.manager.form.VirtualSelectBox', {\n  extend: qx.ui.form.VirtualSelectBox,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'atom':\n          control = new cv.ui.manager.form.ListItem('');\n          control.setCenter(false);\n          control.setAnonymous(true);\n\n          this._add(control, {flex:1});\n          break;\n      }\n\n      return control || this.base(arguments, id, hash);\n    }\n  }\n});\n","/* CheckBox.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.form.CheckBox', {\n  extend: qx.ui.form.CheckBox,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _onExecute : function(e) {\n      if (this.isTriState()) {\n        // toggle between three states\n        if (this.getValue() === true) {\n          this.setValue(false);\n        } else if (this.getValue() === false) {\n          this.setValue(null);\n        } else {\n          this.setValue(true);\n        }\n      } else {\n        this.toggleValue();\n      }\n    },\n\n    _applyValue : function(value, old) {\n      this.base(arguments, value, old);\n      if (value === null) {\n        this.setLabel(' - ' + this.tr('not set') + ' - ');\n      } else {\n        this.setLabel('');\n      }\n    }\n  }\n});\n","/* ElementFormRenderer.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Special form renderer for editing XML-Config elements (allows special help texts for items)\n */\nqx.Class.define('cv.ui.manager.form.ElementFormRenderer', {\n  extend: qxl.dialog.FormRenderer,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    addItems: function(items, names, title) {\n      if (title !== null) {\n        this._add(\n          this._createHeader(title), {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          }\n        );\n        this._row++;\n      }\n      for (let i = 0; i < items.length; i++) {\n        let item = items[i];\n        let widget;\n        let label;\n        if (item instanceof qx.ui.form.RadioGroup) {\n          if (item.getUserData('orientation') === 'horizontal') {\n            widget = this._createHBoxForRadioGroup(item);\n          } else {\n            widget = this._createWidgetForRadioGroup(item);\n          }\n        } else {\n          widget = item;\n        }\n        if (names[i] && item.getUserData('excluded')) {\n          label = new qx.ui.basic.Label(names[i]);\n          label.setRich(true);\n          this._add(label, {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          });\n        } else if (!names[i]) {\n          this._add(widget, {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          });\n        } else {\n          label = this._createLabel(names[i], item);\n          label.setRich(true);\n          this._add(label, {\n            row: this._row,\n            column: 0\n          });\n          this._add(widget, {\n            row: this._row,\n            column: 1\n          });\n        }\n        this._row++;\n        if (item.getUserData('help')) {\n          label = new qx.ui.basic.Label(item.getUserData('help'));\n          label.setRich(true);\n          label.setAppearance('helptext');\n          this._add(label, {\n            row: this._row,\n            column: 1\n          });\n          this._row++;\n        }\n        this._add(new qx.ui.menu.Separator(), {\n          row: this._row,\n          column: 0,\n          colSpan: 2\n        });\n        this._row++;\n        if (i === 0) {\n          widget.focus();\n        }\n      }\n    }\n  }\n});\n","/* DocumentationMapping.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.model.schema.DocumentationMapping', {\n  type: 'static',\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    MAP: {\n      '_base': 'https://www.cometvisu.org/CometVisu/',\n      'address': '/develop/manual/config/address.html#address',\n      'audio': '/develop/manual/config/widgets/audio/index.html#audio',\n      'bashrc': '/develop/manual/tutorial/rpi_prequesites.html#bashrc',\n      'break': '/develop/manual/config/widgets/break/index.html#break',\n      'clock': '/develop/manual/config/widgets/plugins/clock/index.html#clock',\n      'colorchooser': '/develop/manual/config/widgets/colorchooser/index.html#colorchooser',\n      'custom-css': '/develop/manual/config/customizing.html#custom-css',\n      'custom-cssrules': '/develop/manual/config/customizing.html#custom-cssrules',\n      'custom-plugins': '/develop/manual/config/customizing.html#custom-plugins',\n      'customizing': '/develop/manual/config/customizing.html#customizing',\n      'cv-installation-in-terminal': '/develop/manual/tutorial/rpi_cometvisu.html#cv-installation-in-terminal',\n      'designtoggle': '/develop/manual/config/widgets/designtoggle/index.html#designtoggle',\n      'diagram': '/develop/manual/config/widgets/plugins/diagram/index.html#diagram',\n      'diagram-influx': '/develop/manual/config/widgets/plugins/diagram/index.html#diagram-influx',\n      'diagram-info': '/develop/manual/config/widgets/plugins/diagram_info/index.html#diagram-info',\n      'docker': '/develop/manual/install/docker.html#docker',\n      'docker-openhab-installation': '/develop/manual/install/docker_openhab.html#docker-openhab-installation',\n      'dockerenvironment': '/develop/manual/install/docker.html#dockerenvironment',\n      'editor': '/develop/manual/config/editor.html#editor',\n      'enablecache': '/develop/manual/config/url-params.html#enablecache',\n      'flavour': '/develop/manual/config/flavour.html#flavour',\n      'format': '/develop/manual/config/format.html#format',\n      'gauge': '/develop/manual/config/widgets/plugins/gauge/index.html#gauge',\n      'group': '/develop/manual/config/widgets/group/index.html#group',\n      'hidden-config': '/develop/manual/config/hidden-config.html#hidden-config',\n      'image': '/develop/manual/config/widgets/image/index.html#image',\n      'imagetrigger': '/develop/manual/config/widgets/imagetrigger/index.html#imagetrigger',\n      'include': '/develop/manual/config/widgets/include/index.html#include',\n      'info': '/develop/manual/config/widgets/info/index.html#info',\n      'info-seite': '/develop/manual/config/widgets/plugins/rsslog/index.html#info-seite',\n      'infoaction': '/develop/manual/config/widgets/infoaction/index.html#infoaction',\n      'infotrigger': '/develop/manual/config/widgets/infotrigger/index.html#infotrigger',\n      'install-no-pakets': '/develop/manual/install/install-dev.html#install-no-pakets',\n      'layout': '/develop/manual/config/layout.html#layout',\n      'line': '/develop/manual/config/widgets/line/index.html#line',\n      'link': '/develop/manual/config/widgets/plugins/link/index.html#link',\n      'log': '/develop/manual/config/url-params.html#log',\n      'long-polling': '/develop/manual/devel/transport/long-polling.html#long-polling',\n      'manager': '/develop/manual/config/manager.html#manager',\n      'mapping': '/develop/manual/config/mapping.html#mapping',\n      'multitrigger': '/develop/manual/config/widgets/multitrigger/index.html#multitrigger',\n      'navbar': '/develop/manual/config/widgets/navbar/index.html#navbar',\n      'nodered-installation-in-terminal': '/develop/manual/tutorial/rpi_nodered.html#nodered-installation-in-terminal',\n      'notificationcenterbadge': '/develop/manual/config/widgets/notificationcenterbadge/index.html#notificationcenterbadge',\n      'notifications': '/develop/manual/config/notifications.html#notifications',\n      'openhab-plugin': '/develop/manual/config/widgets/plugins/openhab/index.html#openhab-plugin',\n      'openweathermap': '/develop/manual/config/widgets/plugins/openweathermap/index.html#openweathermap',\n      'page': '/develop/manual/config/widgets/page/index.html#page',\n      'pagejump': '/develop/manual/config/widgets/pagejump/index.html#pagejump',\n      'powerspectrum': '/develop/manual/config/widgets/plugins/powerspectrum/index.html#powerspectrum',\n      'pushbutton': '/develop/manual/config/widgets/pushbutton/index.html#pushbutton',\n      'refresh': '/develop/manual/config/widgets/refresh/index.html#refresh',\n      'reload': '/develop/manual/config/widgets/reload/index.html#reload',\n      'reporterrors': '/develop/manual/config/url-params.html#reporterrors',\n      'reporting': '/develop/manual/config/url-params.html#reporting',\n      'rgb': '/develop/manual/config/widgets/rgb/index.html#rgb',\n      'roundbar': '/develop/manual/config/widgets/roundbar/index.html#roundbar',\n      'rpi-tutorial-cometvisu-in-docker': '/develop/manual/tutorial/rpi_cometvisu.html#rpi-tutorial-cometvisu-in-docker',\n      'rrd-introduction': '/develop/manual/config/rrd_examples.html#rrd-introduction',\n      'rsslog': '/develop/manual/config/widgets/plugins/rsslog/index.html#rsslog',\n      'size-attributes': '/develop/manual/config/size-attributes.html#size-attributes',\n      'slide': '/develop/manual/config/widgets/slide/index.html#slide',\n      'speech': '/develop/manual/config/widgets/plugins/speech/index.html#speech',\n      'sse': '/develop/manual/devel/transport/sse.html#sse',\n      'strftime': '/develop/manual/config/widgets/plugins/strftime/index.html#strftime',\n      'styling': '/develop/manual/config/styling.html#styling',\n      'switch': '/develop/manual/config/widgets/switch/index.html#switch',\n      'system-voraussetzungen': '/develop/manual/#system-voraussetzungen',\n      'text': '/develop/manual/config/widgets/text/index.html#text',\n      'tile-backend-system': '/develop/manual/config/structure-tile/elements/backend.html#tile-backend-system',\n      'tile-component-button': '/develop/manual/config/structure-tile/components/button.html#tile-component-button',\n      'tile-component-group': '/develop/manual/config/structure-tile/components/group.html#tile-component-group',\n      'tile-component-icon': '/develop/manual/config/structure-tile/components/icon.html#tile-component-icon',\n      'tile-component-image': '/develop/manual/config/structure-tile/components/image.html#tile-component-image',\n      'tile-component-list': '/develop/manual/config/structure-tile/components/list.html#tile-component-list',\n      'tile-component-menu': '/develop/manual/config/structure-tile/components/menu.html#tile-component-menu',\n      'tile-component-page': '/develop/manual/config/structure-tile/components/page.html#tile-component-page',\n      'tile-component-popup': '/develop/manual/config/structure-tile/components/popup.html#tile-component-popup',\n      'tile-component-select': '/develop/manual/config/structure-tile/components/select.html#tile-component-select',\n      'tile-component-slider': '/develop/manual/config/structure-tile/components/slider.html#tile-component-slider',\n      'tile-component-spinner': '/develop/manual/config/structure-tile/components/spinner.html#tile-component-spinner',\n      'tile-component-value': '/develop/manual/config/structure-tile/components/value.html#tile-component-value',\n      'tile-components': '/develop/manual/config/structure-tile/index.html#tile-components',\n      'tile-element-address': '/develop/manual/config/structure-tile/elements/address.html#tile-element-address',\n      'tile-element-address-target': '/develop/manual/config/structure-tile/elements/address.html#tile-element-address-target',\n      'tile-element-backend': '/develop/manual/config/structure-tile/elements/backend.html#tile-element-backend',\n      'tile-element-loader': '/develop/manual/config/structure-tile/elements/loader.html#tile-element-loader',\n      'tile-element-mapping': '/develop/manual/config/structure-tile/elements/mapping.html#tile-element-mapping',\n      'tile-element-styling': '/develop/manual/config/structure-tile/elements/styling.html#tile-element-styling',\n      'tile-info': '/develop/manual/config/structure-tile/widgets/info.html#tile-info',\n      'tile-media-player': '/develop/manual/config/structure-tile/widgets/media-player.html#tile-media-player',\n      'tile-rtc': '/develop/manual/config/structure-tile/widgets/rtc.html#tile-rtc',\n      'tile-shutter': '/develop/manual/config/structure-tile/widgets/shutter.html#tile-shutter',\n      'tile-simmer': '/develop/manual/config/structure-tile/widgets/dimmer.html#tile-simmer',\n      'tile-status': '/develop/manual/config/structure-tile/widgets/status.html#tile-status',\n      'tile-switch': '/develop/manual/config/structure-tile/widgets/switch.html#tile-switch',\n      'tile-tile-pair': '/develop/manual/config/structure-tile/widgets/tile-pair.html#tile-tile-pair',\n      'tile-widgets': '/develop/manual/config/structure-tile/index.html#tile-widgets',\n      'timberwolf': '/develop/manual/install/timberwolf.html#timberwolf',\n      'timberwolf-portainer': '/develop/manual/install/timberwolf.html#timberwolf-portainer',\n      'timeout': '/develop/manual/config/widgets/plugins/timeout/index.html#timeout',\n      'toggle': '/develop/manual/config/widgets/toggle/index.html#toggle',\n      'tr064': '/develop/manual/config/widgets/plugins/tr064/index.html#tr064',\n      'trigger': '/develop/manual/config/widgets/trigger/index.html#trigger',\n      'tutorials': '/develop/manual/tutorial/index.html#tutorials',\n      'urltrigger': '/develop/manual/config/widgets/urltrigger/index.html#urltrigger',\n      'video': '/develop/manual/config/widgets/video/index.html#video',\n      'visu-config-details': '/develop/manual/config/index.html#visu-config-details',\n      'web': '/develop/manual/config/widgets/web/index.html#web',\n      'wgplugin-info': '/develop/manual/config/widgets/wgplugin_info/index.html#wgplugin-info',\n      'widgets': '/develop/manual/config/widgets/index.html#widgets',\n      'worker': '/develop/manual/config/url-params.html#worker',\n      'xml-format': '/develop/manual/config/xml-format.html#xml-format',\n      'xml-format-files': '/develop/manual/config/xml-format.html#xml-format-files',\n      'xml-format-header': '/develop/manual/config/xml-format.html#xml-format-header',\n      'xml-format-icons': '/develop/manual/config/xml-format.html#xml-format-icons',\n      'xml-format-mappings': '/develop/manual/config/xml-format.html#xml-format-mappings',\n      'xml-format-pages': '/develop/manual/config/xml-format.html#xml-format-pages',\n      'xml-format-plugins': '/develop/manual/config/xml-format.html#xml-format-plugins',\n      'xml-format-statusbar': '/develop/manual/config/xml-format.html#xml-format-statusbar',\n      'xml-format-stylings': '/develop/manual/config/xml-format.html#xml-format-stylings',\n      'xml-format-templates': '/develop/manual/config/xml-format.html#xml-format-templates'\n    }\n  }\n});\n","/* SimpleType.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * a single SimpleType from the schema.\n * Should be useable for SimpleContent, too.\n * Is usable for attributes, too.\n */\nqx.Class.define('cv.ui.manager.model.schema.SimpleType', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.__enumerations = [];\n    this.__pattern = [];\n    this.__regexCache = {};\n    this.__bases = [];\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'simpleType'\n    },\n    optional: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * the baseType of this element, which is one of the xsd-namespaced types (like 'string')\n     * @var string\n     */\n    baseType: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __pattern: null,\n    __enumerations: null,\n    __bases: null,\n    __regexCache: null,\n\n    parse: function () {\n      const node = this.getNode();\n      this.setOptional(node.getAttribute('use') === 'required');\n      this.__fillNodeData(node);\n    },\n\n    /**\n     * parse a node, find it's data (restrictions, extensions, bases ... whatever)\n     *\n     * @param   node    DOMNode the node to parse\n     */\n    __fillNodeData: function (node) {\n      const schema = this.getSchema();\n\n      if (node.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = node.getAttribute('ref');\n        node = schema.getReferencedNode('attribute', refName);\n\n        if (!node) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n      }\n\n      if (node.hasAttribute('type')) {\n        // hacked: allow this to be used for attributes\n        const baseType = node.getAttribute('type');\n\n        if (!baseType.match(/^xsd:/)) {\n          // if it's not an xsd-default-basetype, we need to find out what it is\n          const subnode = schema.getReferencedNode('simpleType', baseType);\n          this.__fillNodeData(subnode);\n        } else {\n          this.setBaseType(baseType);\n        }\n        // is this attribute optional?\n        this.setOptional(node.getAttribute('use') !== 'required');\n\n        return;\n      }\n\n      const subNodes = Array.from(node.querySelectorAll(':scope > restriction, :scope > extension, :scope > simpleType > restriction, :scope > simpleType > extension'));\n\n      subNodes.forEach(subNode => {\n        const baseType = subNode.getAttribute('base');\n\n        if (!baseType.match(/^xsd:/)) {\n          // don't dive in for default-types, they simply can not be found\n          const subnode = schema.getReferencedNode('simpleType', baseType);\n          this.__fillNodeData(subnode);\n        } else {\n          this.setBaseType(baseType);\n        }\n        Array.from(subNode.querySelectorAll(':scope > pattern')).forEach(patternNode => {\n          this.__pattern.push(patternNode.getAttribute('value'));\n        });\n\n        Array.from(subNode.querySelectorAll(':scope > enumeration')).forEach(enumerationNode => {\n          this.__enumerations.push(enumerationNode.getAttribute('value'));\n        });\n      });\n\n      if (!this.getBaseType()) {\n        this.setBaseType('xsd:anyType');\n      }\n      this.__bases.push(this.getBaseType());\n    },\n\n    /**\n     * check if a given value is valid for this type\n     *\n     * @param   value   mixed   the value to check\n     * @return  boolean         if the value is valid\n     */\n    isValueValid: function (value) {\n      const baseType = this.getBaseType();\n      const schema = this.getSchema();\n      if (!baseType) {\n        throw new Error('something is wrong, do not have a baseType for type');\n      }\n\n      if (value === '') {\n        // empty values are valid if this node is optional!\n        return this.isOptional();\n      }\n\n      if (baseType.search(/^xsd:/) === -1) {\n        // created our own type, will need to find and use it.\n        const typeNode = schema.getTypeNode('simple', baseType);\n        const subType = new cv.ui.manager.model.schema.SimpleType(typeNode, schema);\n        return subType.isValueValid(value);\n      } \n        // xsd:-namespaces types, those are the originals\n        switch (baseType) {\n          case 'xsd:string':\n          case 'xsd:anyURI':\n          case 'xsd:anyType':\n            if (!(typeof (value) == 'string')) {\n              // it's not a string, but it should be.\n              // pretty much any input a user gives us is string, so this is pretty much moot.\n              return false;\n            }\n            break;\n          case 'xsd:decimal':\n            if (!value.match(/^[-+]?[0-9]*(\\.[0-9]+)?$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:unsignedByte':\n          case 'xsd:nonNegativeInteger':\n            if (!value.match(/^[+]?[0-9]+$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:integer':\n            if (!value.match(/^[-+]?[0-9]+$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:float':\n            if (!value.match(/^[-+]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:boolean':\n            if (!value.match(/^(true|false|0|1)$/)) {\n              return false;\n            }\n            break;\n          default:\n            throw new Error('not implemented baseType ' + baseType);\n        }\n      \n\n      // check if the value is in our list of valid values, if there is such a list\n      if (this.__enumerations.length > 0) {\n        if (!this.__enumerations.includes(value)) {\n          return false;\n        }\n      }\n\n      // check if the value matches any given pattern\n      if (this.__pattern.length > 0) {\n        // start with assuming it's valid\n        let boolValid = true;\n\n        this.__pattern.forEach(item => {\n          if (!Object.prototype.hasOwnProperty.call(this.__regexCache, item)) {\n            // create a regex from the pattern; mind ^ an $ - XSD has them implicitly (XSD Datatypes, Appendix G)\n            // so for our purpose, we need to add them for every branch (that is not inside [])\n            const branchIndices = [];\n            let start = 0;\n            let i = item.indexOf('|', start);\n            while (i < item.length) {\n              if (i < 0) {\n                break;\n              }\n              // go backwards and look for an [ stop looking on ]\n              let isRootBranch = true;\n              for (let j = i; j >= start; j--) {\n                if (item[j] === ']') {\n                  break;\n                } else if (item[j] === '[') {\n                  isRootBranch = false;\n                }\n              }\n              if (isRootBranch) {\n                branchIndices.push([start, i - start]);\n              }\n              start = i + 1;\n              i = item.indexOf('|', start);\n              if (branchIndices.length > 100) {\n                this.error('too many branchIndices');\n                break;\n              }\n            }\n            if (item.length > start) {\n              // append the rest\n              branchIndices.push([start, item.length - start]);\n            }\n            const branches = branchIndices.map(entry => `^${item.substr(entry[0], entry[1]).replace(/\\\\([\\s\\S])|(\\$)/g, '\\\\$1$2')}$`);\n            this.__regexCache[item] = this.regexFromString(branches.join('|'));\n          }\n\n          if (this.__regexCache[item].test(value) === false) {\n            // regular expression did not match\n            // bad bad value!\n            boolValid = false;\n          }\n        }, this);\n\n        // if the value has been marked invalid by a regex, return invalid.\n        if (boolValid === false) {\n          return false;\n        }\n      }\n\n      // if no check said the value is invalid, then it is not invalid\n      return true;\n    },\n\n    /**\n     * get this elements enumeration (if there is any)\n     *\n     * @return  array   list of allowed values (if there are any)\n     */\n    getEnumeration: function () {\n      if (this.getBaseType() === 'xsd:boolean') {\n        // special handling for boolean, as we KNOW it to be an enumeration\n        return ['true', 'false'];\n      }\n\n      return this.__enumerations;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__regexCache = null;\n  }\n});\n","/* Choice.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * a single choice.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Choice', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'choice'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const node = this.getNode();\n      const schema = this.getSchema();\n      const subElements = Array.from(node.querySelectorAll(':scope > element'));\n      subElements.forEach(elem => {\n        const subElement = new cv.ui.manager.model.schema.Element(elem, schema);\n        subElement.setSortable(true);\n        this._allowedElements[subElement.getName()] = subElement;\n      });\n      this._allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n\n      // choices\n      Array.from(node.querySelectorAll(':scope > choice')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      });\n\n      // sequences\n      Array.from(node.querySelectorAll(':scope > sequence')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n      });\n\n      // groups\n      Array.from(node.querySelectorAll(':scope > group')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Group(grouping, schema));\n      });\n    },\n\n    // overridden\n    getRequiredElements: function () {\n      // a choice has no defined required elements\n      // if you want required elements, use sequence or all\n      return [];\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // create list of allowed elements\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      const elementRegexes = [];\n      for (const element of Object.values(this._allowedElements)) {\n        elementRegexes.push(element.getRegex(separator, nocapture));\n      }\n\n      // also collect the regex for each and every grouping we might have\n      this._subGroupings.forEach(grouping => {\n        elementRegexes.push(grouping.getRegex(separator, nocapture));\n      });\n\n      regexString += elementRegexes.join('|');\n\n      regexString += ')';\n\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // as we are a choice, we can define the number of occurences for children of ANY level\n      if (this.isElementAllowed(childName) === true) {\n        return this.getBounds();\n      }\n\n      return undefined;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * For a choice, all elements have the same sorting, so they will all have the\n     * same sortnumber\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     *\n     * @param   sortnumber  integer the sortnumber of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortnumber) {\n      const namesWithSorting = {};\n\n      // all elements allowed directly\n      Object.keys(this._allowedElements).forEach(function (name) {\n        const item = this._allowedElements[name];\n        let mySortnumber = 'x'; // for a choice, sortnumber is always the same\n        if (sortnumber !== undefined) {\n          mySortnumber = sortnumber + '.' + mySortnumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortnumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortnumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n\n      // all elements allowed by subGroupings\n      this._subGroupings.forEach(function (item, i) {\n        let mySortnumber = 'x'; // for a choice, sortnumber is always the same\n        if (sortnumber !== undefined) {\n          mySortnumber = sortnumber + '.' + mySortnumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortnumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortnumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n      return namesWithSorting;\n    }\n  }\n});\n","/* Sequence.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * a single sequence.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Sequence', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'sequence'\n    },\n    elementsHaveOrder: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      // for a sequence, we need to keep the order of the elements\n      // so we have to use a 'mixed' approach in reading them\n      const subNodes = Array.from(this.getNode().children);\n\n      subNodes.forEach(subNode => {\n        let subObject;\n\n        switch (subNode.nodeName) {\n          case 'xsd:element':\n          case 'element':\n            subObject = new cv.ui.manager.model.schema.Element(subNode, schema);\n            // sequences' children are non-sortable\n            subObject.setSortable(false);\n            this._allowedElements[subObject.getName()] = subObject;\n            break;\n          case 'xsd:choice':\n          case 'choice':\n            subObject = new cv.ui.manager.model.schema.Choice(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:sequence':\n          case 'sequence':\n            subObject = new cv.ui.manager.model.schema.Sequence(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:group':\n          case 'group':\n            subObject = new cv.ui.manager.model.schema.Group(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:any':\n          case 'any':\n            subObject = new cv.ui.manager.model.schema.Any(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n        }\n\n        this._sortedContent.push(subObject);\n      });\n      this._allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // create list of allowed elements\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      const elementRegexes = [];\n\n      // this goes over ALL elements AND sub-groupings\n      this._sortedContent.forEach(element => {\n        elementRegexes.push(element.getRegex(separator, nocapture));\n      });\n\n      regexString += elementRegexes.join('');\n\n      regexString += ')';\n\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // we are a sequence-element; there is actually a lot of sayings ...\n      if (typeof this._allowedElements[childName] !== 'undefined') {\n        const elementBounds = this._allowedElements[childName].getBounds();\n        const sequenceBounds = this.getBounds();\n\n        const resultBounds = {\n          min: 1,\n          max: 1\n        };\n\n        // if it is bounded, we must duplicate element and sequence bounds\n        // (an element may appear as often as the number of sequences times the number of elements\n        // in each sequence - roughly)\n        if (Object.prototype.hasOwnProperty.call(elementBounds, 'min')) {\n          resultBounds.min = elementBounds.min;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'min') && !isNaN(sequenceBounds.min)) {\n          resultBounds.min *= sequenceBounds.min;\n        }\n\n        if (elementBounds.max === Number.POSITIVE_INFINITY || sequenceBounds.max === Number.POSITIVE_INFINITY) {\n          resultBounds.max = Number.POSITIVE_INFINITY;\n        } else {\n          if (Object.prototype.hasOwnProperty.call(elementBounds, 'max')) {\n            resultBounds.max = elementBounds.max;\n          }\n\n          if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'max') && !isNaN(sequenceBounds.max)) {\n            resultBounds.max *= sequenceBounds.max;\n          }\n        }\n\n        return resultBounds;\n      }\n\n      let childBounds;\n\n      let tmpBounds;\n\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        tmpBounds = this._subGroupings[i].getBoundsForElementName(childName);\n\n        if (undefined !== tmpBounds) {\n          // once we find the first set of bounds, we return that\n          childBounds = tmpBounds;\n          break;\n        }\n      }\n\n      return childBounds;\n    },\n\n    /**\n     * get the sorting of the allowed elements\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     * @param sortNumber  integer the sortNumber of a parent (only used when recursive)\n     * @return object     list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      const namesWithSorting = {};\n\n      this._sortedContent.forEach((item, i) => {\n        let mySortNumber = i;\n        if (sortNumber !== undefined) {\n          mySortNumber = sortNumber + '.' + i;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortNumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortNumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      });\n\n      return namesWithSorting;\n    }\n  }\n});\n","/* Group.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * a single group.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Group', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'group'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      let group = this.getNode();\n      if (group.hasAttribute('ref')) {\n        // if this is a reference, unravel it.\n        group = schema.getReferencedNode('group', group.getAttribute('ref'));\n      }\n\n      // we are allowed choice and sequence, but only ONE AT ALL is allowed\n      let grouping = group.querySelector(':scope > choice');\n      if (grouping) {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      } else {\n        grouping = group.querySelector(':scope > sequence');\n        if (grouping) {\n          this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n        }\n      }\n    },\n\n    /**\n     * get the elements allowed for this group\n     *\n     * @return  object      list of allowed elements, key is the name\n     */\n    getAllowedElements: function () {\n      // we have non of ourselves, so we return what the child says\n      return this._subGroupings[0].getAllowedElements();\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * For a group, all elements have the same sorting, so they will all have the\n     * same sort number\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     *\n     * @param   sortNumber  integer the sort number of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      const namesWithSorting = {};\n      const allowedElements = this.getAllowedElements();\n      Object.keys(allowedElements).forEach(name => {\n        const item = allowedElements[name];\n        let mySortNumber = 'x'; // for a group, sortNumber is always the same\n        if (sortNumber !== undefined) {\n          mySortNumber = sortNumber + '.' + mySortNumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortNumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortNumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n      return namesWithSorting;\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // collect the regex for each and every grouping we might have;\n      // 'each and every' means 'the only ONE'\n      this._subGroupings.forEach(grouping => {\n        regexString = '(';\n        if (nocapture) {\n regexString += '?:'; \n}\n        regexString += grouping.getRegex(separator, nocapture) + ')';\n      });\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // we are a group. we have no saying of ourselves\n      // (@FIXME: by definition we do, but we do not take that into account)\n      return this._subGroupings[0].getBoundsForElementName(childName);\n    }\n  }\n});\n","/* Any.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * any content.\n */\nqx.Class.define('cv.ui.manager.model.schema.Any', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'any'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      let group = this.getNode();\n      if (group.hasAttribute('ref')) {\n        // if this is a reference, unravel it.\n        group = schema.getReferencedNode('group', group.getAttribute('ref'));\n      }\n      // we are allowed choice and sequence, but only ONE AT ALL is allowed\n      group.querySelectorAll(':scope > choice').forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      });\n\n      // sequences\n      group.querySelectorAll(':scope > sequence').forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n      });\n\n      // there may be only one, so we simply us the first we found\n      if (this._subGroupings.length > 0) {\n        this._subGroupings = [this._subGroupings[0]];\n      }\n    },\n\n    // overridden\n    isElementAllowed: function (element) {\n      return true;\n    },\n\n    // overridden\n    getSchemaElementForElementName: function (elementName) {\n      // can not find any reason why elementName is allowed with us...\n      return undefined;\n    },\n\n    // overridden\n    getRequiredElements: function () {\n      return [];\n    },\n\n    // overridden\n    getAllowedElements: function() {\n      return {};\n    },\n\n    getRegex: function (separator, nocapture) {\n      return '.*';\n    },\n\n    hasMultiLevelBounds: function () {\n      return true;\n    },\n\n    getBoundsForElementName: function (childName) {\n      return this._bounds;\n    }\n  }\n});\n","/* Attribute.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * a single attribute from the schema.\n */\nqx.Class.define('cv.ui.manager.model.schema.Attribute', {\n  extend: cv.ui.manager.model.schema.Base,\n  include: cv.ui.manager.model.schema.MAnnotation,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Get the name of a schema-node\n     * @param e object  element to find the name of\n     * @param schema\n     * @return  string          name of the element\n     * @throws  if the name can not be found\n     */\n    getAttributeName: function(e, schema) {\n      if (e.hasAttribute('name')) {\n        return e.getAttribute('name');\n      }\n\n      if (e.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = e.getAttribute('ref');\n        const ref = schema.getReferencedNode('attribute', refName);\n\n        if (!ref) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n\n        return ref.getAttribute('name');\n      }\n\n      return 'unknown';\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'attribute'\n    },\n    name: {\n      check: 'String',\n      init: ''\n    },\n    optional: {\n      check: 'Boolean',\n      init: false\n    },\n    defaultValue: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _type: null,\n\n    parse: function () {\n      const node = this.getNode();\n      const schema = this.getSchema();\n      /**\n       * we have our own type\n       * @var object  SchemaSimpleType of the attribute, for validating purposes\n       */\n      this._type = new cv.ui.manager.model.schema.SimpleType(node, schema);\n      this.setName(cv.ui.manager.model.schema.Attribute.getAttributeName(node, schema));\n      if (node.hasAttribute('default')) {\n        this.setDefaultValue(node.getAttribute('default'));\n      }\n      this.setOptional(node.getAttribute('use') !== 'required');\n    },\n\n    /**\n     * check if a given value is valid for this attribute\n     *\n     * @param   value   mixed   the value to check\n     * @return  boolean         if the value is valid\n     */\n    isValueValid: function (value) {\n      if (value === null || value === undefined) {\n        value = '';\n      } else {\n        value = '' + value;\n      }\n      if (value === '') {\n        // empty values are valid if this node is optional!\n        return this.isOptional();\n      }\n      return this._type.isValueValid(value);\n    },\n\n    /**\n     * get a simple string telling us, what type of content is allowed\n     *\n     * @return  string  description of allowed values, almost user-readable :)\n     */\n    getTypeString: function () {\n      const description = this._type.getBaseType();\n\n      if (description.match(/xsd\\:/)) {\n        return description.replace(/xsd\\:/, '');\n      }\n\n      return this.tr('complex type, please see documentation');\n    },\n\n    /**\n     * get the list of values that are valid for this attribute, if it is an enumeration\n     *\n     * @return  array   list of string of valid values\n     */\n    getEnumeration: function () {\n      return this._type.getEnumeration();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__appInfoCache = null;\n    this.__documentationCache = null;\n  }\n});\n","/* ActionDispatcher.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * The ActionDispatcher listens to the events in the 'cv.manager.action' topic and\n * dispatched those events to the currently relevant handler (e.g. the save event to the opened editor).\n */\nqx.Class.define('cv.ui.manager.control.ActionDispatcher', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    qx.event.message.Bus.subscribe('cv.manager.action.*', this._onAction, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    focusedWidget: {\n      check: 'cv.ui.manager.IActionHandler',\n      nullable: true,\n      apply: '_applyFocusedWidget'\n    },\n\n    main: {\n      check: 'cv.ui.manager.Main',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    updateBarButtons: function () {\n      const actionHandler = this.getFocusedWidget();\n      const menuBar = cv.ui.manager.MenuBar.getInstance();\n      const config = menuBar.getButtonConfiguration();\n      let button;\n      Object.keys(config).forEach(function (actionId) {\n        button = menuBar.getButton(actionId);\n        if (button) {\n          button.setEnabled(config[actionId].general || this.hasHandler(actionId));\n          if (actionHandler) {\n            actionHandler.configureButton(actionId, button);\n          }\n        }\n      }, this);\n    },\n\n    _applyFocusedWidget: function (value, old) {\n      if (old) {\n        const menuBar = cv.ui.manager.MenuBar.getInstance();\n        const config = menuBar.getButtonConfiguration();\n        let button;\n        Object.keys(config).forEach(function (actionId) {\n          button = menuBar.getButton(actionId);\n          if (button) {\n            old.unConfigureButton(actionId, button);\n          }\n        }, this);\n      }\n      this.updateBarButtons();\n    },\n\n    /**\n     * Check if there is an existing handler for the given actionName.\n     * @param actionName\n     * @return {Boolean}\n     */\n    hasHandler: function (actionName) {\n      return !!this._getHandler(actionName);\n    },\n\n    _getHandler: function (actionName) {\n      const handler = this.getFocusedWidget();\n      const main = this.getMain();\n      if (handler && handler.canHandleAction(actionName)) {\n        return handler;\n      } else if (main && main.canHandleAction(actionName)) {\n        return main;\n      }\n      return null;\n    },\n\n    _onAction: function (ev) {\n      const topic = ev.getName();\n      const actionName = topic.split('.').pop();\n      const handler = this._getHandler(actionName);\n      if (handler) {\n        handler.handleAction(actionName, ev.getData());\n      } else {\n        this.warn('no action handler found for action: ' + actionName);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.subscribe('cv.manager.action.*', this._onAction, this);\n  }\n});\n","/* GlobalState.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Global singleton that hold some states that are relevant for many parts of the manager.\n */\nqx.Class.define('cv.ui.manager.core.GlobalState', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    openedFocusedFile: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      event: 'changeOpenedFocusedFile',\n      apply: '_applyFile'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyFile: function () {\n      cv.ui.manager.control.ActionDispatcher.getInstance().updateBarButtons();\n    }\n  }\n});\n","/* OpenFile.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Data model for currently opened files, a combination of cv.ui.manager.model.FileItem and a certain FileHandler.\n */\nqx.Class.define('cv.ui.manager.model.OpenFile', {\n  extend: qx.core.Object,\n\n\n    /*\n    ***********************************************\n      CONSTRUCTOR\n    ***********************************************\n    */\n    construct: function (file, handlerId) {\n      this.base(arguments);\n      if (file) {\n        this.setFile(file);\n      }\n      if (handlerId) {\n        this.setHandlerId(handlerId);\n      }\n    },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      event: 'changeFile',\n      apply: '_applyFile'\n    },\n\n    handlerId: {\n      check: '!!qx.Class.getByName(value)',\n      nullable: true,\n      apply: '_maintainIcon'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true\n    },\n\n    /**\n     * The opening state: permanent false behaves like a quick preview, where\n     * the current file content is replaces by the next selected file on single click.\n     * In permanent mode a new tab will be created, which content will not be replaced.\n     */\n    permanent: {\n      check: 'Boolean',\n      init: false,\n      event: 'changePermanent'\n    },\n\n    /**\n     * Icon to show in e.g. the File-Tab\n     */\n    icon: {\n      check: 'String',\n      init: '',\n      event: 'changeIcon'\n    },\n\n    closeable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeCloseable'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __ibid: null,\n\n    _applyFile: function (value, old) {\n      if (old) {\n        old.removeListener('changeModified', this._maintainPermanent, this);\n        old.removeRelatedBindings(this);\n        this.__ibid = null;\n      }\n      if (value) {\n        value.addListener('changeModified', this._maintainPermanent, this);\n      }\n      this._maintainIcon();\n    },\n\n    _maintainIcon: function () {\n      // use the handlers icon is there is one, otherwise the file items icon\n      const file = this.getFile();\n      if (this.getHandlerId() && file) {\n        const handlerClass = qx.Class.getByName(this.getHandlerId());\n        if (handlerClass && handlerClass.ICON) {\n          this.setIcon(handlerClass.ICON);\n          if (this.__ibid) {\n            file.removeBinding(this.__ibid);\n            this.__ibid = null;\n          }\n        } else {\n          this.__ibid = file.bind('icon', this, 'icon');\n        }\n      } else {\n        this.resetIcon();\n      }\n    },\n\n    _maintainPermanent: function () {\n      if (this.getFile().isModified() && !this.isPermanent()) {\n        // change to permanent once we have a modification\n        this.setPermanent(true);\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      const file = this.getFile();\n      const handlerId = this.getHandlerId();\n      let fileHandler;\n      if (handlerId) {\n        fileHandler = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n      } else {\n        fileHandler = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n      }\n      if (file.isModified()) {\n        if (fileHandler && fileHandler.instance && qx.Interface.objectImplements(fileHandler.instance, cv.ui.manager.editor.IEditor)) {\n          fileHandler.instance.save(callback, overrideHash);\n        }\n      }\n    }\n  }\n});\n","/* FileTabItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n *\n */\nqx.Class.define('cv.ui.manager.form.FileTabItem', {\n  extend: qx.ui.core.Widget,\n  implement : [qx.ui.form.IModel],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox());\n    this._createChildControl('icon');\n    this._createChildControl('label');\n    this._createChildControl('close');\n\n    this.addListener('pointerover', this._onPointerOver, this);\n    this.addListener('pointerout', this._onPointerOut, this);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'close': 'qx.event.type.Data',\n\n    /** (Fired by {@link qx.ui.form.List}) */\n    'action' : 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'open-file-item'\n    },\n\n    model: {\n      nullable: true,\n      event: 'changeModel',\n      apply: '_applyModel',\n      dereference: true\n    },\n\n    label: {\n      check: 'String',\n      nullable: true,\n      transform: '_transformFilename',\n      event: 'changeLabel',\n      apply: '_applyLabel'\n    },\n\n    icon: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyIcon'\n    },\n\n    permanent: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyPermanent'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyLabel'\n    },\n\n    closeable: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyCloseable'\n    },\n\n    writeable:{\n      check: 'Boolean',\n      init: true,\n      apply: '_applyLabel'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates :\n      {\n        focused : true,\n        hovered : true,\n        selected : true,\n        dragover : true\n      },\n\n\n    /**\n     * Event handler for the pointer over event.\n     */\n    _onPointerOver : function() {\n      this.addState('hovered');\n    },\n\n    _transformFilename: function(name) {\n      if (name === '.') {\n        return '';\n      }\n      return name;\n    },\n\n    /**\n     * Event handler for the pointer out event.\n     */\n    _onPointerOut : function() {\n      this.removeState('hovered');\n    },\n\n    _applyPermanent: function (value) {\n      this.setFont(value ? 'default' : 'italic');\n    },\n\n    _applyCloseable: function (value) {\n      this.getChildControl('close').setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    _applyModel: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('file.writeable', this, 'writeable');\n      }\n    },\n\n    _applyIcon: function (value) {\n      const control = this.getChildControl('icon');\n      control.setSource(value);\n      if (value) {\n        control.show();\n      } else {\n        control.exclude();\n      }\n    },\n\n    _applyLabel: function () {\n      const label = this.getChildControl('label');\n      const value = this.getLabel();\n      if (value) {\n        let labelValue = this.getLabel();\n        // special treatment for hidden.php which is marked as fake, but has a special editor, so it has to be marked as not writeable\n        if (!this.isWriteable() && (!this.getModel().getFile().isFake() || this.getModel().getFile().getName() === 'hidden.php')) {\n          labelValue += ' !';\n          this.setToolTipText(this.tr('This file is not writeable'));\n        } else {\n          this.resetToolTipText();\n        }\n        if (this.isModified()) {\n          labelValue += ' *';\n        }\n        label.setValue(labelValue);\n        label.show();\n      } else {\n        label.exclude();\n        this.resetToolTipText();\n      }\n    },\n\n    _onClose: function () {\n      if (this.isCloseable()) {\n        this.fireDataEvent('close', this.getModel());\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new qx.ui.basic.Image();\n           control.setAppearance('open-file-item/icon');\n           control.setAnonymous(true);\n           control.exclude();\n           this._addAt(control, 0);\n           break;\n\n         case 'label':\n           control = new qx.ui.basic.Label();\n           control.setAppearance('open-file-item/label');\n           control.setAnonymous(true);\n           this._addAt(control, 1);\n           break;\n\n         case 'close':\n           control = new qx.ui.basic.Image('decoration/tabview/close.gif');\n           control.setAppearance('open-file-item/close');\n           if (this.isCloseable()) {\n             control.addListener('tap', this._onClose, this);\n           } else {\n             control.exclude();\n           }\n           this._addAt(control, 2);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.removeListener('pointerover', this._onPointerOver, this);\n    this.removeListener('pointerout', this._onPointerOut, this);\n  }\n});\n","/* Option.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Simple config entry.\n */\nqx.Class.define('cv.ui.manager.model.config.Option', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (key, value) {\n    this.base(arguments);\n    this.setKey(key);\n    this.setValue(value);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    // sent whenever the options key or value has been changed\n    'change': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    key: {\n      check: 'String',\n      init: '',\n      event: 'changeKey',\n      apply: '_applyChange'\n    },\n\n    value: {\n      check: 'String',\n      init: '',\n      event: 'changeValue',\n      apply: '_applyChange'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyChange: function () {\n      this.fireEvent('change');\n    }\n  }\n});\n","/* OptionListItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * This widgets shows and editable config option in a list.\n */\nqx.Class.define('cv.ui.manager.form.OptionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox(8));\n    this._createChildControl('key');\n    this._createChildControl('value');\n    this._createChildControl('key-title');\n    this._createChildControl('value-title');\n    this._createChildControl('delete');\n    this._createChildControl('add');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-option'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.config.Option',\n      nullable: true,\n      apply: '_applyModel'\n    },\n\n    readOnly: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadOnly'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'delete': 'qx.event.type.Data',\n    'add': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // list controller with allowNull calls setLabel\n    setLabel: function (label) {\n\n    },\n\n    // list controller with allowNull calls setIcon\n    setIcon: function () {},\n\n    _applyModel: function (value, old) {\n      const keyField = this.getChildControl('key');\n      const valueField = this.getChildControl('value');\n      const keyTitleField = this.getChildControl('key-title');\n      const valueTitleField = this.getChildControl('value-title');\n      this.__unbindModel(old);\n      if (value) {\n        // bi-directional bind\n        value.bind('key', keyField, 'value');\n        value.bind('value', valueField, 'value');\n        keyField.bind('value', value, 'key');\n        valueField.bind('value', value, 'value');\n        keyField.show();\n        valueField.show();\n        keyTitleField.exclude();\n        valueTitleField.exclude();\n        this.getChildControl('delete').show();\n        this.getChildControl('add').show();\n      } else {\n        keyField.exclude();\n        valueField.exclude();\n        keyTitleField.show();\n        valueTitleField.show();\n        this.getChildControl('delete').hide();\n        this.getChildControl('add').hide();\n      }\n    },\n\n    __unbindModel: function (model) {\n      if (model) {\n        const keyField = this.getChildControl('key');\n        const valueField = this.getChildControl('value');\n        if (model) {\n          model.removeRelatedBindings(keyField);\n          model.removeRelatedBindings(valueField);\n          keyField.removeRelatedBindings(model);\n          valueField.removeRelatedBindings(model);\n        }\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'key':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             required: true\n           });\n           this.bind('readOnly', control, 'readOnly');\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'value':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true\n           });\n           this.bind('readOnly', control, 'readOnly');\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'delete':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n           control.setToolTipText(this.tr('Delete option'));\n           control.addListener('execute', function() {\n             this.fireDataEvent('delete', this.getModel());\n           }, this);\n           this.bind('readOnly', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'hidden' : 'visible';\n             }\n           });\n           this._add(control);\n           break;\n\n         case 'add':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('add', 18));\n           control.setToolTipText(this.tr('Add option'));\n           control.addListener('execute', function() {\n             this.fireEvent('add');\n           }, this);\n           this.bind('readOnly', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'hidden' : 'visible';\n             }\n           });\n           this._add(control);\n           break;\n\n         case 'key-title':\n           control = new qx.ui.basic.Label(this.tr('Key'));\n           control.exclude();\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'value-title':\n           control = new qx.ui.basic.Label(this.tr('Value'));\n           control.exclude();\n           this._add(control, {width: '40%'});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__unbindModel(this.getModel());\n  }\n});\n","/* Icon.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * Wrapper for cometvisu icons to make the usable as Qx-Widget.\n */\nqx.Class.define('cv.ui.manager.basic.Icon', {\n  extend: qx.ui.core.Widget\n\n});\n","/* SvgIcon.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n\n/**\n * QX version of the svg use icon way of displaying the KNF-UF icons.\n */\nqx.Class.define('cv.ui.manager.viewer.SvgIcon', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name) {\n    this.base(arguments);\n    if (name) {\n      this.setName(name);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    name: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyName'\n    },\n\n    appearance: {\n      refine: true,\n      init: 'cv-svg-icon'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __spriteUrl: null,\n    __useElement: null,\n\n    _applyName: function (value) {\n      if (value) {\n        if (!this.__spriteUrl) {\n          this.__spriteUrl = qx.util.ResourceManager.getInstance().toUri('icons/knx-uf-iconset.svg');\n        }\n        if (!this.__useElement.getDomElement()) {\n          this.__useElement.addListenerOnce('appear', function () {\n            this._applyName(value);\n          }, this);\n          return;\n        }\n        // qx.xml.Element.setAttributeNS(document, this.__useElement.getDomElement(), 'http://www.w3.org/1999/xlink', 'xlink:href', this.__spriteUrl + '#kuf-' + value);\n        this.__useElement.getDomElement().setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', this.__spriteUrl + '#kuf-' + value);\n      } else {\n        this.__useElement.removeAttribute('xlink:href');\n      }\n    },\n\n    // overridden\n    _createContentElement : function() {\n      const svgElem = new cv.svg.Element('svg');\n      this.__useElement = new cv.svg.Element('use');\n      svgElem.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n      svgElem.add(this.__useElement);\n      return svgElem;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__useElement = null;\n  }\n});\n"]}