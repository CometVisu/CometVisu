{"version":3,"names":["qx","Class","define","extend","cv","ui","structure","pure","AbstractWidget","include","common","Update","Operate","properties","pagejumpTarget","check","nullable","gaugeType","subtype","gType","init","titleString","unitString","unitStringVisible","size","width","height","minValue","maxValue","frameDesign","backgroundColor","foregroundType","pointerType","pointerColor","lcdColor","lcdVisible","lcdDecimals","ledVisible","ledColor","valueColor","trendVisible","thresholdRising","threshold","apply","thresholdVisible","autoScroll","valuesNumeric","statics","parse","xml","path","flavour","pageType","data","parser","WidgetParser","parseElement","this","getAttributeToPropertyMappings","parseFormat","parseAddress","makeAddressListFn","target","type","default","transform","value","parseFloat","framedesign","background","parseInt","src","mode","variant","members","__P_11_0","__P_11_1","_getInnerDomString","getPagejumpTarget","getPath","_onDomReady","additional","getSubtype","steelseries","GaugeType","undefined","getFrameDesign","FrameDesign","getBackgroundColor","BackgroundColor","getValueColor","ColorDef","RED","ForegroundType","TYPE1","PointerType","LcdColor","STANDARD","LedColor","RED_LED","params","Object","assign","Model","getInstance","getWidgetData","getGType","getValueElement","getDomElement","querySelector","_applyThreshold","setThresholdVisible","_processIncomingValue","address","defaultUpdate","handleUpdate","gaugeElement","setValueAnimatedAverage","setValue","setTrend","trend","TrendState","UP","DOWN","STEADY","setThreshold","setMinValue","setMaxValue","setValueAnimatedLatest","setValueAnimated","_action","Application","structureController","scrollToPage","defer","loader","util","ScriptLoader","addStyles","addScripts","addHandler","plugins","Gauge","WidgetFactory","registerClass","$$dbClassInfo"],"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/plugins/Gauge.js"],"sourcesContent":["/* Gauge.js\n *\n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n *\n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * This plugins integrates Gauge (in canvas) into the visualization\n *\n * @author NetFritz [NetFritz at gmx dot de]\n * @since 0.8.1\n *\n * @ignore(steelseries.*)\n * @asset(plugins/gauge/gauge.css)\n * @asset(plugins/gauge/dep/steelseries.js)\n * @asset(plugins/gauge/dep/tween.js)\n */\nqx.Class.define('cv.plugins.Gauge', {\n  extend: cv.ui.structure.pure.AbstractWidget,\n  include: [cv.ui.common.Update, cv.ui.common.Operate],\n\n  /*\n  ******************************************************\n    PROPERTIES\n  ******************************************************\n  */\n  properties: {\n    pagejumpTarget: { check: 'String', nullable: true },\n    gaugeType: { check: 'String', nullable: true },\n    subtype: { check: 'String', nullable: true },\n    gType: { check: 'String', init: 'Radial' },\n    titleString: { check: 'String', nullable: true },\n    unitString: { check: 'String', nullable: true },\n    unitStringVisible: { check: 'Boolean', init: false },\n    size: { check: 'Number', init: 150 },\n    width: { check: 'Number', init: 320 },\n    height: { check: 'Number', init: 140 },\n    minValue: { check: 'Number', init: 0 },\n    maxValue: { check: 'Number', init: 100 },\n    frameDesign: { check: 'String', nullable: true },\n    backgroundColor: { check: 'String', nullable: true },\n    foregroundType: { check: 'String', nullable: true },\n    pointerType: { check: 'String', nullable: true },\n    pointerColor: { check: 'String', nullable: true },\n    lcdColor: { check: 'String', nullable: true },\n    lcdVisible: { check: 'Boolean', init: false },\n    lcdDecimals: { check: 'Number', nullable: true },\n    ledVisible: { check: 'Boolean', init: false },\n    ledColor: { check: 'String', nullable: true },\n    valueColor: { check: 'String', nullable: true },\n    trendVisible: { check: 'Boolean', init: false },\n    thresholdRising: { check: 'Boolean', init: false },\n    threshold: {\n      check: 'Number',\n      init: 0,\n      apply: '_applyThreshold'\n    },\n\n    thresholdVisible: { check: 'Boolean', init: false },\n    autoScroll: { check: 'Boolean', init: false },\n    valuesNumeric: { check: 'Boolean', init: false }\n  },\n\n  /*\n  ******************************************************\n    STATICS\n  ******************************************************\n  */\n  statics: {\n    /**\n     * Parses the widgets XML configuration and extracts the given information\n     * to a simple key/value map.\n     *\n     * @param xml {Element} XML-Element\n     * @param path {String} internal path of the widget\n     * @param flavour {String} Flavour of the widget\n     * @param pageType {String} Page type (2d, 3d, ...)\n     * @return {Map} extracted data from config element as key/value map\n     */\n    parse(xml, path, flavour, pageType) {\n      const data = cv.parser.pure.WidgetParser.parseElement(\n        this,\n        xml,\n        path,\n        flavour,\n        pageType,\n        this.getAttributeToPropertyMappings()\n      );\n\n      cv.parser.pure.WidgetParser.parseFormat(xml, path);\n      cv.parser.pure.WidgetParser.parseAddress(xml, path, this.makeAddressListFn);\n\n      return data;\n    },\n\n    getAttributeToPropertyMappings() {\n      return {\n        target: { target: 'pagejumpTarget' },\n        type: { target: 'gType', default: 'Radial' },\n        subtype: {},\n        titleString: {},\n        unitString: {},\n        unitStringVisible: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        size: { default: 150, transform: parseFloat },\n        width: { default: 320, transform: parseFloat },\n        height: { default: 140, transform: parseFloat },\n        minValue: { default: 0, transform: parseFloat },\n        maxValue: { default: 100, transform: parseFloat },\n        framedesign: { target: 'frameDesign' },\n        background: { target: 'backgroundColor' },\n        lcdVisible: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        lcdDecimals: { default: 0, transform: parseInt },\n        ledVisible: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        valueColor: {},\n        trendVisible: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        thresholdRising: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        threshold: { default: 0, transform: parseFloat },\n        autoScroll: {\n          transform(value) {\n            return value === 'true';\n          }\n        },\n\n        valuesNumeric: {\n          transform(value) {\n            return value === 'true';\n          }\n        }\n      };\n    },\n\n    makeAddressListFn(src, transform, mode, variant) {\n      return [true, variant];\n    }\n  },\n\n  /*\n  ******************************************************\n    MEMBERS\n  ******************************************************\n  */\n  members: {\n    __gaugeElement: null,\n    __updateQueue: null,\n\n    _getInnerDomString() {\n      return (\n        '<div class=\"actor' +\n        (this.getPagejumpTarget() ? 'clickable' : '') +\n        '\"><canvas id=\"gauge_' +\n        this.getPath() +\n        '\"></canvas></div>'\n      );\n    },\n\n    // overridden\n    _onDomReady() {\n      const additional = {\n        gaugeType: this.getSubtype() ? steelseries.GaugeType[this.getSubtype()] : undefined,\n        frameDesign: this.getFrameDesign() ? steelseries.FrameDesign[this.getFrameDesign()] : undefined,\n        backgroundColor: this.getBackgroundColor() ? steelseries.BackgroundColor[this.getBackgroundColor()] : undefined,\n        valueColor: this.getValueColor() ? steelseries.ColorDef[this.getValueColor()] : steelseries.ColorDef.RED,\n        foregroundType: steelseries.ForegroundType.TYPE1,\n        pointerType: steelseries.PointerType.TYPE1,\n        pointerColor: steelseries.ColorDef.RED,\n        lcdColor: steelseries.LcdColor.STANDARD,\n        ledColor: steelseries.LedColor.RED_LED\n      };\n\n      const params = Object.assign({}, cv.data.Model.getInstance().getWidgetData(this.getPath()), additional);\n\n      this.__gaugeElement = new steelseries[this.getGType()]('gauge_' + this.getPath(), params);\n\n      super._onDomReady();\n    },\n\n    // overridden\n    getValueElement() {\n      return this.getDomElement().querySelector('#gauge_' + this.getPath());\n    },\n\n    // property apply\n    _applyThreshold(value) {\n      if (value > 0) {\n        this.setThresholdVisible(true);\n      }\n    },\n\n    // overridden\n    _processIncomingValue(address, data) {\n      if (address && data) {\n        return this.defaultUpdate(address, data, this.getDomElement(), true, this.getPath());\n      }\n      return null;\n    },\n\n    /**\n     * Handle the incoming data\n     * @param value {var} Processed incoming value\n     * @param address {String} source address of the value\n     */\n    handleUpdate(value, address) {\n      if (!address || value === undefined) {\n        return;\n      }\n\n      const variant = this.getAddress()[address].variantInfo;\n      const gaugeElement = this.__gaugeElement;\n      if (gaugeElement) {\n        switch (variant) {\n          case 'average':\n            if (gaugeElement.setValueAnimatedAverage) {\n              gaugeElement.setValueAnimatedAverage(value);\n            }\n            break;\n          case 'setValue':\n            if (gaugeElement.setValue) {\n              gaugeElement.setValue(value);\n            }\n            break;\n          case 'trend':\n            if (gaugeElement.setTrend) {\n              let trend;\n              if (value > 0) {\n                trend = steelseries.TrendState.UP;\n              } else if (value < 0) {\n                trend = steelseries.TrendState.DOWN;\n              } else {\n                trend = steelseries.TrendState.STEADY;\n              }\n              gaugeElement.setTrend(trend);\n            }\n            break;\n          case 'threshold':\n            if (gaugeElement.setThreshold) {\n              gaugeElement.setThreshold(value);\n            }\n            break;\n          case 'min':\n            if (gaugeElement.setMinValue) {\n              gaugeElement.setMinValue(value);\n            }\n            break;\n          case 'max':\n            if (gaugeElement.setMaxValue) {\n              gaugeElement.setMaxValue(value);\n            }\n            break;\n          default:\n            if (gaugeElement.setValueAnimatedLatest) {\n              gaugeElement.setValueAnimatedLatest(value);\n            }\n            if (gaugeElement.setValueAnimated) {\n              gaugeElement.setValueAnimated(value);\n            }\n        }\n      }\n    },\n\n    // overridden\n    _action() {\n      if (this.getPagejumpTarget()) {\n        cv.Application.structureController.scrollToPage(this.getPagejumpTarget());\n      }\n    }\n  },\n\n  defer(statics) {\n    const loader = cv.util.ScriptLoader.getInstance();\n    loader.addStyles('plugins/gauge/gauge.css');\n    loader.addScripts(['plugins/gauge/dep/tween.js', 'plugins/gauge/dep/steelseries.js']);\n\n    cv.parser.pure.WidgetParser.addHandler('gauge', cv.plugins.Gauge);\n    cv.ui.structure.WidgetFactory.registerClass('gauge', statics);\n  }\n});\n"],"mappings":"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"}