function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)},_wrapNativeSuper(t)}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var i=new(t.bind.apply(t,n));return r&&_setPrototypeOf(i,r.prototype),i}function _isNativeFunction(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:A(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",_="executing",d="completed",y={};function m(){}function v(){}function b(){}var g={};u(g,a,(function(){return this}));var P=Object.getPrototypeOf,C=P&&P(P(q([])));C&&C!==r&&n.call(C,a)&&(g=C);var w=b.prototype=m.prototype=Object.create(g);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,r,n){var i=p;return function(o,a){if(i===_)throw Error("Generator is already running");if(i===d){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=_;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?d:h,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=d,n.method="throw",n.arg=u.arg)}}}function x(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function q(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(_typeof(e)+" is not iterable")}return v.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},O(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new S(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(w),u(w,c,"Generator"),u(w,a,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=q,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:q(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){asyncGeneratorStep(o,n,i,a,s,"next",t)}function s(t){asyncGeneratorStep(o,n,i,a,s,"throw",t)}a(void 0)}))}}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",defer:"runtime",require:!0},"qx.core.Object":{construct:!0,require:!0},"cv.ui.structure.IController":{require:!0},"qx.bom.Stylesheet":{construct:!0},"qx.util.ResourceManager":{construct:!0},"cv.Config":{construct:!0},"qx.locale.Manager":{construct:!0,defer:"runtime"},"qx.log.Logger":{defer:"runtime"},"qx.bom.History":{},"qx.event.message.Bus":{},"qx.io.request.Xhr":{},"cv.TemplateEngine":{},"qx.util.Request":{},"cv.data.Model":{},"qx.lang.String":{defer:"runtime"},"cv.ui.structure.tile.widgets.TemplateWidget":{},"cv.Application":{defer:"runtime"},"cv.ui.structure.tile.elements.AbstractCustomElement":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.Controller",{extend:qx.core.Object,type:"singleton",implement:cv.ui.structure.IController,construct:function(){qx.core.Object.constructor.call(this);this.__P_72_0="";qx.bom.Stylesheet.includeFile(qx.util.ResourceManager.getInstance().toUri("designs/tile-globals.scss").replace(".scss",".css")+(!0===cv.Config.forceReload?"?"+Date.now():""));qx.locale.Manager.getInstance().addListener("changeLocale",this._onChangeLocale,this)},statics:{PREFIX:"cv-",__P_72_1:{},__P_72_2:{},MAPPING_PARAM_REGEX:/^(.+)\(([^)]+)\)$/,register:function(t,e){this.__P_72_1[t]=e},onComponentCreated:function(t){var e=t.tagName.toLowerCase();if(Object.prototype.hasOwnProperty.call(this,e)){var r=this.__P_72_1[e];Object.prototype.hasOwnProperty.call(this,e)||(this.__P_72_2[e]=[]);this.__P_72_2[e].push(new r(t))}else qx.log.Logger.error(this,"no QxClass registered for custom element "+e)}},properties:{renderTarget:{check:"Element",init:document.body},namespace:{check:"String",init:""},scrolled:{check:"Boolean",init:!1,apply:"_applyScrolled"}},members:{__P_72_0:null,__P_72_3:null,__P_72_4:null,_templateWidgets:null,getHtmlStructure:function(){return this.__P_72_0},supports:function(t,e){return!1},initLayout:function(){},__P_72_5:function(){document.location.hash?this.scrollToPage(document.location.hash.substring(1)):this.scrollToPage(this.getInitialPageId())},onHistoryRequest:function(t){t&&this.scrollToPage(t)},scrollToPage:function(t,e){if(t){var r=document.querySelector("cv-page#"+t);if(r){if(!r.classList.contains("active")){var n,i=_createForOfIteratorHelper(document.querySelectorAll("cv-page.active"));try{for(i.s();!(n=i.n()).done;){n.value.classList.remove("active")}}catch(t){i.e(t)}finally{i.f()}var o,a=_createForOfIteratorHelper(document.querySelectorAll("cv-page.sub-active"));try{for(a.s();!(o=a.n()).done;){o.value.classList.remove("sub-active")}}catch(t){a.e(t)}finally{a.f()}r.classList.add("active");for(var s=r.parentElement;s&&"main"!==s.nodeName.toLowerCase();){"cv-page"===s.nodeName.toLowerCase()&&s.classList.add("sub-active");s=s.parentElement}if(void 0===e){var c=r.getAttribute("name"),u="CometVisu";c&&(u=c+" - "+u);qx.bom.History.getInstance().addToHistory(t,u)}qx.event.message.Bus.dispatchByName("cv.ui.structure.tile.currentPage",r)}}else this.warn("no page with id",t,"found")}},parseBackendSettings:function(t){return!1},parseSettings:function(t){var e=this;document.body.classList.add("loading-structure");var r=cv.Config.configSettings,n=t.documentElement;r.bindClickToWidget="true"===n.getAttribute("bind_click_to_widget");this.translate(t,!0);if(!cv.Config.cacheUsed){var i=qx.util.ResourceManager.getInstance().toUri("structures/tile/templates.xml"),o=new qx.io.request.Xhr(i);o.set({accept:"application/xml",cache:!cv.Config.forceReload});o.addListenerOnce("success",(function(t){var r,i=t.getTarget().getResponse(),o=e.getRenderTarget();e.debug("creating pages");e.registerTemplates(i);if(!i.documentElement.xmlns){var a=t.getTarget().getResponseText();a=a.replace("<templates",'<templates xmlns="http://www.w3.org/1999/xhtml"');i=(new DOMParser).parseFromString(a,"text/xml")}for(;r=i.documentElement.firstElementChild;)o.appendChild(r);for(;r=n.firstElementChild;)o.appendChild(r);document.body.classList.remove("loading-structure");e.debug("finalizing");e.observeVisibility();qx.event.message.Bus.dispatchByName("setup.dom.append");e.debug("pages created");e.__P_72_5();e.debug("setup.dom.finished");qx.event.message.Bus.dispatchByName("setup.dom.finished.before");cv.TemplateEngine.getInstance().setDomFinished(!0);var s=document.body.querySelector(":scope > main");if(s){var c=-1,u=!1;s.addEventListener("scroll",(function(){if(c<0){c=1;var t,r,n=_createForOfIteratorHelper(document.body.querySelectorAll(':scope > header [hide-on-scroll="true"]'));try{for(n.s();!(r=n.n()).done;){var i=r.value;t=getComputedStyle(i);u||(u=!!i.style.height);c+=parseInt(t.height)+parseInt(t.paddingTop)+parseInt(t.paddingBottom)+parseInt(t.marginTop)+parseInt(t.marginBottom)}}catch(t){n.e(t)}finally{n.f()}}if(!e.isScrolled()&&s.scrollTop>c){e.setScrolled(!0);u||(s.scrollTop-=c)}else if(e.isScrolled()&&0===s.scrollTop){e.setScrolled(!1);c=-1}}))}e.enablePullToRefresh()}));o.addListener("statusError",(function(t){var r=t.getTarget().getTransport().status;qx.util.Request.isSuccessful(r)||e.error("filenotfound",i);document.body.classList.remove("loading-structure")}));o.send()}},_applyScrolled:function(t){if(t){var e,r=_createForOfIteratorHelper(document.body.querySelectorAll(':scope > header [hide-on-scroll="true"]'));try{for(r.s();!(e=r.n()).done;){e.value.classList.add("scrolled")}}catch(t){r.e(t)}finally{r.f()}}else{var n,i=_createForOfIteratorHelper(document.body.querySelectorAll(':scope > header [hide-on-scroll="true"]'));try{for(i.s();!(n=i.n()).done;){n.value.classList.remove("scrolled")}}catch(t){i.e(t)}finally{i.f()}}},preParse:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function r(){var n,i;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.documentElement.hasAttribute("theme")){n=t.documentElement.getAttribute("theme");i={};if("system"===n)if(window.matchMedia){n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";document.documentElement.setAttribute("data-theme",n);i.theme=n;cv.data.Model.getInstance().updateFrom("system",i);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(function(t){document.documentElement.setAttribute("data-theme",t.matches?"dark":"light");i.theme=t.matches?"dark":"light";cv.data.Model.getInstance().updateFrom("system",i)}))}else e.error("system theme detection not possible in this browser");else{document.documentElement.setAttribute("data-theme",n);i.theme=n;cv.data.Model.getInstance().updateFrom("system",i)}}return r.abrupt("return",!0);case 2:case"end":return r.stop()}}),r)})))()},createUI:function(t){},observeVisibility:function(){var t,e=new IntersectionObserver((function(t,e){t.forEach((function(t){if(t.isIntersecting&&t.target.hasAttribute("data-src")){t.target.setAttribute("src",t.target.getAttribute("data-src"));t.target.removeAttribute("data-src");e.unobserve(t.target)}}),{root:document.querySelector("body > main")})})),r=_createForOfIteratorHelper(document.querySelectorAll("iframe[data-src], img[data-src]"));try{for(r.s();!(t=r.n()).done;){var n=t.value;e.observe(n)}}catch(t){r.e(t)}finally{r.f()}},translate:function(t,e,r){var n=qx.locale.Manager.getInstance().getLanguage(),i=/locale=([a-z]{2,3})/.exec(document.location.search);i&&(n=i[1]);e&&(this._trKeys={});for(var o=0,a=["name","label","title","format"];o<a.length;o++){var s,c=a[o],u=_createForOfIteratorHelper(t.querySelectorAll("*[".concat(c,'^="tr("]')));try{for(u.s();!(s=u.n()).done;){var l=s.value,f=/^tr\('([^']+)'\)$/.exec(l.getAttribute(c));if(f||r){var p=r?this._trKeys[l.getAttribute(c)]:f[1],h=t.querySelector('cv-translations > language[name="'.concat(n,"\"] > tr[key='").concat(p,"']"));if(h){e&&(this._trKeys[h.textContent.trim()]=p);l.setAttribute(c,h.textContent.trim())}else{l.setAttribute(c,p);this.warn("[".concat(n,'] no translation found for: "').concat(p,'"'))}}else this.warn("attribute content no valid translation string",l.getAttribute(c))}}catch(t){u.e(t)}finally{u.f()}}var _,d=_createForOfIteratorHelper(t.querySelectorAll('*[tr="true"]'));try{for(d.s();!(_=d.n()).done;){var y=_.value,m=r?this._trKeys[y.textContent.trim()]:y.textContent.trim(),v=t.querySelector('cv-translations > language[name="'.concat(n,"\"] > tr[key='").concat(m,"']"));if(v){e&&(this._trKeys[v.textContent.trim()]=m);y.textContent=v.textContent.trim()}else{y.textContent=m;this.warn("[".concat(n,'] no translation found for: "').concat(m,'"'))}}}catch(t){d.e(t)}finally{d.f()}},doScreenSave:function(){cv.Config.configSettings.screensave_page&&this.scrollToPage(cv.Config.configSettings.screensave_page)},getInitialAddresses:function(){return[]},getInitialPageId:function(){var t=document.querySelector("cv-page");return t?t.id:""},addMapping:function(t,e){this.__P_72_3||(this.__P_72_3={});this.__P_72_3[t]=e},removeMapping:function(t){this.__P_72_3&&delete this.__P_72_3[t]},mapValue:function(t,e,r){var n,i=[];if(null!==(n=cv.ui.structure.tile.Controller.MAPPING_PARAM_REGEX.exec(t))){try{i=JSON.parse("[".concat(n[2].replaceAll("'",'"'),"]"))}catch(e){this.error("error parsing parameters from "+t)}t=n[1]}return this.__P_72_3&&Object.prototype.hasOwnProperty.call(this.__P_72_3,t)?this.__P_72_3[t].mapValue(e,r,i):e},addStyling:function(t,e){this.__P_72_4||(this.__P_72_4={});this.__P_72_4[t]=e},removeStyling:function(t){this.__P_72_4&&delete this.__P_72_4[t]},styleValue:function(t,e,r){return this.__P_72_4&&Object.prototype.hasOwnProperty.call(this.__P_72_4,t)?this.__P_72_4[t].mapValue(e,r):""},parseLabel:function(){return""},_onChangeLocale:function(){this.translate(document.body,!1,!0)},enablePullToRefresh:function(){var t,e=0,r=document.createElement("div");r.classList.add("pull-to-refresh");var n=document.createElement("i");n.classList.add("ri-loader-4-fill");r.append(n);document.body.append(r);var i=document,o=function(n){n.touches[0].clientY-e>60&&0===t.scrollTop?r.classList.add("visible"):r.classList.remove("visible")},a=function(){s();if(r.classList.contains("visible")){r.classList.remove("visible");location.reload()}},s=function(){i.removeEventListener("touchmove",o);i.removeEventListener("touchend",a);i.removeEventListener("touchcancel",s)};i.addEventListener("touchstart",(function(r){e=r.touches[0].clientY;if((t=document.querySelector("main"))&&0===t.scrollTop){i.addEventListener("touchmove",o);i.addEventListener("touchend",a);i.addEventListener("touchcancel",s)}}))},isTemplateWidget:function(t){return this._templateWidgets.includes(t)},registerTemplates:function(t){var e=this;null===this._templateWidgets&&(this._templateWidgets=[]);var n,i=_createForOfIteratorHelper(t.querySelectorAll("templates[structure='tile'] > template"));try{var o=function(){var t=n.value,i=qx.lang.String.firstUp(qx.lang.String.camelCase(t.getAttribute("id"))),o=qx.Class.getByName("cv.ui.structure.tile.widgets.".concat(i));o||(o=cv.ui.structure.tile.widgets.TemplateWidget);customElements.define(cv.ui.structure.tile.Controller.PREFIX+t.getAttribute("id"),function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t.getAttribute("id"),o])}_inherits(r,e);return _createClass(r)}(r));e._templateWidgets.push(cv.ui.structure.tile.Controller.PREFIX+t.getAttribute("id"))};for(i.s();!(n=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}},updateSentryScope:function(){if(cv.Config.sentryEnabled&&window.Sentry){Sentry.setTag("ui.structure","tile");Sentry.setTag("ui.design",cv.Config.getDesign())}}},defer:function(t){window.cvTestMode||(cv.Application.structureController=t.getInstance())},destruct:function(){qx.locale.Manager.getInstance().removeListener("changeLocale",this._onChangeLocale,this)}});var e=function(t){"use strict";function e(t){var r;_classCallCheck(this,e);r=_callSuper(this,e);if(t){if(!qx.Class.isSubClassOf(t,cv.ui.structure.tile.elements.AbstractCustomElement))throw Error(t+" must be a subclass of cv.ui.structure.tile.elements.AbstractCustomElement");r._instance=new t(r)}r.hasAttribute("colspan")&&r.classList.add("colspan-"+r.getAttribute("colspan"));r.hasAttribute("rowspan")&&r.classList.add("rowspan-"+r.getAttribute("rowspan"));return r}_inherits(e,t);return _createClass(e,[{key:"getInstance",value:function(){return this._instance}},{key:"connectedCallback",value:function(){this._instance&&this._instance.setConnected(!0)}},{key:"disconnectedCallback",value:function(){this._instance&&this._instance.setConnected(!1)}},{key:"attributeChangedCallback",value:function(t,e,r){t=qx.lang.String.camelCase(t);this._instance&&qx.Class.hasProperty(this._instance.constructor,t)&&this._instance.set(t,r)}}])}(_wrapNativeSuper(HTMLElement));window.QxConnector=e;var r=function(t){"use strict";function e(t,r){var n;_classCallCheck(this,e);n=_callSuper(this,e,[r]);var i=cv.ui.structure.tile.Controller.getInstance(),o=document.getElementById(t);if(o){var a,s=["name","replaces","parent-scope"],c=o.content.cloneNode(!0),u=_createForOfIteratorHelper(o.getAttributeNames());try{for(u.s();!(a=u.n()).done;){var l=a.value;"id"===l||n.hasAttribute(l)||n.setAttribute(l,o.getAttribute(l))}}catch(t){u.e(t)}finally{u.f()}var f,p=_createForOfIteratorHelper(c.querySelectorAll("slot"));try{var h=function(){var e=f.value,r=e.getAttribute("name"),o=e.hasAttribute("replaces")?e.getAttribute("replaces"):"",a=e.hasAttribute("parent-scope")?parseInt(e.getAttribute("parent-scope")):0,u=n.querySelectorAll("[slot='".concat(r,"']"));0===u.length&&"default"===r&&(u=n.querySelectorAll(":scope > *:not([slot])"));for(var l={},p=0,h=e.attributes.length;p<h;p++)s.includes(e.attributes[p].name)||(l[e.attributes[p].name]=e.attributes[p].value);if(u.length>0){Array.from(u).forEach((function(r){var n=r.cloneNode(!0);Object.keys(l).forEach((function(e){n.hasAttribute(e)?"class"===e?n.classList.add(l[e]):qx.log.Logger.debug(i,"["+t+"] attribute",e,"already set, skipping"):n.setAttribute(e,l[e])}));n.removeAttribute("slot");e.parentNode.insertBefore(n,e)}));e.remove();o&&c.querySelectorAll(o).forEach((function(t){t.remove()}))}else{var _=e.parentNode;if(a>0){for(var d=a-1;d>0;){_=_.parentNode;d--}_&&_.remove()}else{e.remove();0===_.children.length&&a>=0&&_.remove()}}};for(p.s();!(f=p.n()).done;)h()}catch(t){p.e(t)}finally{p.f()}var _,d=n.getAttributeNames(),y=_createForOfIteratorHelper(d);try{for(y.s();!(_=y.n()).done;){var m,v=_.value,b=n.getAttribute(v),g="slot-".concat(v),P=c.querySelectorAll("[".concat(g,"]")),C=v,w=_createForOfIteratorHelper(P);try{for(w.s();!(m=w.n()).done;){var O=m.value;if(O.hasAttribute(g)){var S=O.getAttribute(g);if(S.startsWith(":")){var A,x=_createForOfIteratorHelper(S.substring(1).split(","));try{for(x.s();!(A=x.n()).done;){var E=A.value.split("="),T=_slicedToArray(E,2),k=T[0],q=T[1];switch(k){case"target":C=q;break;case"value":break;default:qx.log.Logger.error(n,"unhandled slot-attribute configuration key",k)}}}catch(t){x.e(t)}finally{x.f()}}}O.setAttribute(C,b);O.removeAttribute(g)}}catch(t){w.e(t)}finally{w.f()}P.length>0&&n.removeAttribute(v)}}catch(t){y.e(t)}finally{y.f()}var L,j=_createForOfIteratorHelper(c.querySelectorAll("*"));try{for(j.s();!(L=j.n()).done;)for(var I=L.value,R=0,M=_toConsumableArray(I.attributes);R<M.length;R++){var N=M[R];if(N.name.startsWith("slot-")){var F=N.value,B=N.name.substring(5);if(N.name.endsWith("-mapping")&&I.hasAttribute("slot-mapping"))B="mapping";else if(N.name.endsWith("-styling")&&I.hasAttribute("slot-styling"))B="styling";else if(N.name.endsWith("-format")&&I.hasAttribute("slot-format"))B="format";else if(N.value.startsWith(":")){F="";var D,V=N.value.substring(1).split(","),H=_createForOfIteratorHelper(V);try{for(H.s();!(D=H.n()).done;){var z=D.value.split("="),G=_slicedToArray(z,2),U=G[0],$=G[1];switch(U){case"target":B=$;break;case"value":F=$;break;default:qx.log.Logger.error(n,"unhandled slot-attribute configuration key",U)}}}catch(t){H.e(t)}finally{H.f()}}F&&I.setAttribute(B,F);I.removeAttribute(N.name)}}}catch(t){j.e(t)}finally{j.f()}n.innerHTML="";n.appendChild(c);n.classList.add("cv-widget")}else qx.log.Logger.error(i,"["+t+"] no template found for id",t);return n}_inherits(e,t);return _createClass(e)}(e);cv.ui.structure.tile.Controller.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"qx.core.Object":{require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.AbstractCustomElement",{extend:qx.core.Object,type:"abstract",construct:function(t){this._element=t},properties:{connected:{check:"Boolean",init:!1,apply:"_applyConnected",event:"changeConnected"}},members:{_element:null,_initialized:!1,_applyConnected:function(t){if(t&&!this._initialized){this._init();this._initialized=!0}else{this._disconnected();this._initialized=!1}},_init:function(){},_disconnected:function(){},getElement:function(){return this._element}},destruct:function(){this._element=null}});cv.ui.structure.tile.elements.AbstractCustomElement.$$dbClassInfo=t}();function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{construct:!0,require:!0},"qx.core.Init":{},"cv.Application":{},"cv.util.String":{}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.AbstractComponent",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,type:"abstract",construct:function(t){cv.ui.structure.tile.elements.AbstractCustomElement.constructor.call(this,t);this._preMappingHooks=[]},properties:{value:{apply:"_applyValue",init:null,nullable:!0,event:"changeValue"},styleClass:{check:"String",nullable:!0,apply:"_applyStyleClass",event:"changeStyleClass"},enabled:{check:"Boolean",init:!0,apply:"_applyEnabled"},visibility:{check:["visible","excluded","hidden"],init:"visible",apply:"_applyVisibility",event:"changeVisibility"},widget:{check:"Boolean",init:!1},inPopup:{check:"Boolean",init:!1}},members:{_writeAddresses:null,_headerFooterParent:null,_preMappingHooks:null,_tileElement:null,__P_75_0:null,_checkEnvironment:function(){var t=!1;if("cv-popup"===this._element.parentElement.localName){this._headerFooterParent=this._element.parentElement;t=!0}else{var e=this._getTileParent();if(e){var r=e.parentElement;this._headerFooterParent=r;"cv-popup"===r.localName&&(t=!0)}}this.setInPopup(t)},_getTileParent:function(){if(!this._tileElement){for(var t=this._element,e=0;t&&"cv-tile"!==t.localName;){t=t.parentElement;if(++e>2){t=null;break}}t&&"cv-tile"===t.localName&&(this._tileElement=t)}return this._tileElement},_init:function(){var t=this;this._checkEnvironment();var e=this._element,r=!1,n=[];Array.prototype.forEach.call(e.querySelectorAll(":scope > cv-address"),(function(t){switch(t.hasAttribute("mode")?t.getAttribute("mode"):"readwrite"){case"readwrite":r=!0;n.push(t);break;case"read":r=!0;break;case"write":n.push(t)}}));r||(r=e.querySelectorAll(":scope > cv-address-group").length>0);this._writeAddresses=n;r&&e.addEventListener("stateUpdate",(function(e){t.onStateUpdate(e);e.stopPropagation()}));this.__P_75_0=[];var i=function(e){var r,n=_createForOfIteratorHelper(e.getAttributeNames());try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.startsWith("mobile-")){var o=i.substring(7);t.__P_75_0.push({name:o,mobile:e.getAttribute(i),desktop:e.getAttribute(o),target:e})}}}catch(t){n.e(t)}finally{n.f()}};i(e);this._headerFooterParent&&"cv-widget"===this._headerFooterParent.localName&&i(this._headerFooterParent);this.__P_75_0.length>0&&qx.core.Init.getApplication().addListener("changeMobile",this.__P_75_1,this);document.body.classList.contains("mobile")&&this.__P_75_1()},__P_75_1:function(){var t,e=document.body.classList.contains("mobile"),r=_createForOfIteratorHelper(this.__P_75_0);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.target.setAttribute(n.name,e?n.mobile:n.desktop)}}catch(t){r.e(t)}finally{r.f()}},getElement:function(){return this._element},appendToHeader:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(this._headerFooterParent){var r=this._headerFooterParent.querySelector(":scope > header");if(!r){r=document.createElement("header");this._headerFooterParent.insertBefore(r,this._headerFooterParent.firstElementChild)}var n=r;if(e){(n=r.querySelector("."+e))||(n=document.createElement("div")).classList.add(e);r.appendChild(n)}n.appendChild(t)}},getHeader:function(t){if(this._headerFooterParent){if(!t)return this._headerFooterParent.querySelector(":scope > header");var e=this._headerFooterParent.querySelector(":scope > header");if(e)return e.querySelector(t)}return null},appendToFooter:function(t){if(this._headerFooterParent){var e=this._headerFooterParent.querySelector(":scope > footer");if(!e){e=document.createElement("footer");this._headerFooterParent.appendChild(e)}e.appendChild(t)}},getFooter:function(t){if(this._headerFooterParent){if(!t)return this._headerFooterParent.querySelector(":scope > footer");var e=this._headerFooterParent.querySelector(":scope > footer");if(e)return e.querySelector(t)}return null},registerPreMappingHook:function(t,e){this._preMappingHooks.some((function(e){return e[0]===t}))||this._preMappingHooks.push([t,e||this])},unregisterPreMappingHook:function(t){this._preMappingHooks=this._preMappingHooks.filter((function(e){return e[0]!==t}))},_applyValue:function(t){if(this.isConnected()){this._element.setAttribute("value",t||"");var e,r=t,n=_createForOfIteratorHelper(this._preMappingHooks);try{for(n.s();!(e=n.n()).done;){var i=e.value;r=i[0].call(i[1],r)}}catch(t){n.e(t)}finally{n.f()}if(null!==r){this._element.hasAttribute("mapping")&&this._element.getAttribute("mapping")&&(r=cv.Application.structureController.mapValue(this._element.getAttribute("mapping"),r));this._element.hasAttribute("format")&&this._element.getAttribute("format")&&(r=cv.util.String.sprintf(this._element.getAttribute("format"),r instanceof Date?r.toLocaleString():r))}this._updateValue(r,t);if(this._element.hasAttribute("styling")&&this._element.getAttribute("styling")){var o=cv.Application.structureController.styleValue(this._element.getAttribute("styling"),t);this.setStyleClass(o)}}},_updateValue:function(t,e){},_applyStyleClass:function(t,e){var r=this._element.classList;e&&r.contains(e)&&r.remove(e);t&&r.add(t)},_applyEnabled:function(t){var e=this._element.querySelector(":scope > .blocker");if(!e){(e=document.createElement("div")).classList.add("blocker");this._element.appendChild(e);e.addEventListener("click",(function(t){t.preventDefault();t.stopPropagation()}));e.addEventListener("pointerdown",(function(t){t.preventDefault();t.stopPropagation()}));e.addEventListener("pointerup",(function(t){t.preventDefault();t.stopPropagation()}))}this._element.setAttribute("disabled",!1===t?"true":"false");e.style.display=!0===t?"none":"block"},_applyVisibility:function(t,e){var r=this.isWidget()?this._element.parentElement:this._element;"hidden"===e&&(r.style.opacity="1.0");switch(t){case"visible":r.style.display=null;break;case"hidden":r.style.opacity="0";break;case"excluded":r.style.display="none"}},onStateUpdate:function(t){switch(t.detail.target){case"enabled":this.setEnabled(1===t.detail.state);t.stopPropagation();return!0;case"show-exclude":this.setVisibility(t.detail.state?"visible":"excluded");t.stopPropagation();return!0;case"show-hide":this.setVisibility(t.detail.state?"visible":"hidden");t.stopPropagation();return!0;case"":this.setValue(t.detail.state);t.stopPropagation();return!0}return!1}},destruct:function(){this._writeAddresses=null;this._headerFooterParent=null;qx.core.Init.getApplication().removeListener("changeMobile",this.__P_75_1,this)}});cv.ui.structure.tile.components.AbstractComponent.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.TemplateWidget",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{widget:{refine:!0,init:!0}},members:{_checkEnvironment:function(){this._headerFooterParent=this._element},_getTileParent:function(){this._tileElement||(this._tileElement=this._element.querySelector(":scope > cv-tile"));return this._tileElement}}});cv.ui.structure.tile.widgets.TemplateWidget.$$dbClassInfo=t}();function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"qx.util.Uuid":{},"cv.data.Model":{}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MFullscreen",{properties:{fullscreen:{check:"Boolean",init:!1,apply:"__P_73_0",event:"changeFullscreen"}},members:{__P_73_1:null,__P_73_2:null,__P_73_3:null,getUuid:function(){this.__P_73_1||(this.__P_73_1=qx.util.Uuid.createUuidV4());return this.__P_73_1},getPopupAddress:function(){this.__P_73_2||(this.__P_73_2="state:".concat(this.getUuid(),"-popup"));return this.__P_73_2},__P_73_0:function(t){var e=t?"1":"0";this.__P_73_3.setAttribute("data-value",e);cv.data.Model.getInstance().onUpdate(this.getPopupAddress(),e,"system")},_initFullscreenSwitch:function(){var t=this,e=this.__P_73_3=this._buttonFactory("ri-fullscreen-line",["fullscreen"]);e.setAttribute("data-value","0");e.addEventListener("click",(function(){return t.toggleFullscreen()}));this.appendToHeader(e,"right");var r=document.createElement("cv-address");r.setAttribute("mode","read");r.setAttribute("target","fullscreen-popup");r.setAttribute("backend","system");r.setAttribute("send-mode","always");r.textContent=this.getPopupAddress();this._element.parentElement.appendChild(r);for(var n=this._element;n&&"cv-tile"!==n.nodeName.toLowerCase();)n=n.parentElement;if(n){var i=n.getInstance();i.addListener("closed",(function(){return t.setFullscreen(!1)}));n.addEventListener("stateUpdate",(function(t){i.onStateUpdate(t);t.stopPropagation()}))}},_buttonFactory:function(t,e){var r,n=document.createElement("button");(r=n.classList).add.apply(r,_toConsumableArray(e));if(t){var i=document.createElement("i");i.classList.add(t);n.appendChild(i)}return n}},destruct:function(){this.__P_73_3=null}});cv.ui.structure.tile.MFullscreen.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"qx.event.Registration":{},"cv.util.Tree":{},"qx.event.Timer":{}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MPopup",{construct:function(){this._onPointerDownBounded=this._onPointerDown.bind(this)},statics:{openedPopups:[]},events:{closed:"qx.event.type.Event"},members:{_childPopup:null,_onPointerDownBounded:null,_initPopupChild:function(){var t=this._childPopup=this._element.querySelector(":scope > cv-popup");if(t){qx.event.Registration.addListener(this._element,"tap",this._openPopupChild,this);for(var e,r=t.parentElement;r;){if("cv-group"===r.tagName.toLowerCase())e.classList.add("has-popup");else if("cv-page"===r.tagName.toLowerCase())break;e=r;r=r.parentElement}}},_openPopupChild:function(){var t=this._element.querySelector(":scope > cv-popup:not([open])");t&&t.getInstance().open()},_closePopupChild:function(){var t=this._element.querySelector(":scope > cv-popup[open]");t&&t.getInstance().close()},registerModalPopup:function(){document.addEventListener("pointerup",this._onPointerDownBounded);var t=document.body.querySelector(".modal-popup-blocker");if(!t){(t=document.createElement("div")).classList.add("modal-popup-blocker");document.body.appendChild(t)}t.style.display="block";cv.ui.structure.tile.MPopup.openedPopups.push(this)},unregisterModalPopup:function(){document.removeEventListener("pointerup",this._onPointerDownBounded);var t=cv.ui.structure.tile.MPopup.openedPopups.indexOf(this);cv.ui.structure.tile.MPopup.openedPopups.splice(t,1);var e=document.body.querySelector(".modal-popup-blocker");e&&0===cv.ui.structure.tile.MPopup.openedPopups.length&&(e.style.display="none")},_onPointerDown:function(t){var e=this._headerFooterParent||this._element;if(!cv.util.Tree.isChildOf(t.target,e)){t.preventDefault();t.stopImmediatePropagation();qx.event.Timer.once(this.close,this,100)}}},destruct:function(){qx.event.Registration.removeListener(this._element,"tap",this._openPopupChild,this);this._childPopup=null}});cv.ui.structure.tile.MPopup.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"qx.Class":{construct:!0},"cv.ui.structure.tile.MVisibility":{construct:!0},"qx.event.Timer":{}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MRefresh",{construct:function(){qx.Class.hasMixin(this.constructor,cv.ui.structure.tile.MVisibility)&&this.addListener("changeVisible",this.__P_74_0,this)},properties:{refresh:{check:"Number",init:0,apply:"_applyRefresh"}},members:{_refreshTimer:null,_lastRefresh:null,_applyRefresh:function(t){if(0===t)this._refreshTimer&&this._refreshTimer.stop();else if(this._refreshTimer)this._refreshTimer.restartWith(1e3*t);else{this._refreshTimer=new qx.event.Timer(1e3*t);this._refreshTimer.addListener("interval",this.__P_74_1,this);"function"==typeof this.isVisible?this.isVisible()&&this._refreshTimer.start():this._refreshTimer.start()}},__P_74_0:function(t){if(t.getData())if(this._refreshTimer){this._refreshTimer.start();(!this._lastRefresh||Date.now()-this._lastRefresh>=this._refreshTimer.getInterval())&&this.__P_74_1()}else this._lastRefresh||this.__P_74_1();else this._refreshTimer&&this._refreshTimer.stop()},__P_74_1:function(){if("function"==typeof this.refresh){this.refresh();this._lastRefresh=Date.now()}else this.error("refresh method must be implemented!")}},destruct:function(){this._disposeObjects("_refreshTimer")}});cv.ui.structure.tile.MRefresh.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MVisibility",{construct:function(){this._observeVisibility()},statics:{observer:new IntersectionObserver((function(t,e){t.forEach((function(t){t.target._instance&&t.target._instance.setVisible(t.isIntersecting)}),{root:document.querySelector("body > main")})}))},properties:{visible:{check:"Boolean",init:!1,event:"changeVisible"}},members:{_observeVisibility:function(){this._element?cv.ui.structure.tile.MVisibility.observer.observe(this._element):this.warn("no element to observe defined")}}});cv.ui.structure.tile.MVisibility.$$dbClassInfo=t}();function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MResize",{construct:function(){var t=this;this._observer=new ResizeObserver((function(e,r){var n,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.fireDataEvent("resized",o)}}catch(t){i.e(t)}finally{i.f()}}))},events:{resized:"qx.event.type.Data"},properties:{resizeTarget:{check:"Element",nullable:!0,apply:"_applyResizeTarget"}},members:{_observer:null,_applyResizeTarget:function(t,e){e&&this._observer.unobserve(e);t&&this._observer.observe(t)}},destruct:function(){this._observer.disconnect();this._observer=null}});cv.ui.structure.tile.MResize.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MStringTransforms",{members:{_parseInt:function(t){return"string"==typeof t?parseInt(t,10):t},_parseFloat:function(t){return"string"==typeof t?parseFloat(t):t},_parseBoolean:function(t){return"string"==typeof t?"true"===t:t}}});cv.ui.structure.tile.MStringTransforms.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"qx.event.message.Bus":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Breadcrumbs",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{},members:{_init:function(){qx.event.message.Bus.subscribe("cv.ui.structure.tile.currentPage",this._update,this)},_update:function(){var t,e=this._element.querySelector(":scope > ul");if(!e){e=document.createElement("ul");this._element.appendChild(e)}var r=[],n=document.body.querySelector("cv-page.active"),i=document.body.querySelector("main > cv-page:first-of-type");if(n&&n!==i)for(var o=n;o;){var a=this._createListItem(o.getAttribute("id"),o.getAttribute("name"));r.unshift(a);for(var s=o.parentElement;s;){if("cv-page"===s.localName){o=s;break}s=s.parentElement}if(!s||o===i)break}var c=e.querySelector(":scope > li.start");c||(c=this._createListItem(i.getAttribute("id"),i.getAttribute("name"))).classList.add("start");r.unshift(c);(t=e).replaceChildren.apply(t,r)},_createListItem:function(t,e){var r=document.createElement("li"),n=document.createElement("a");n.setAttribute("href","#"+t);n.textContent=e;r.appendChild(n);return r}},destruct:function(){qx.event.message.Bus.unsubscribe("cv.ui.structure.tile.currentPage",this._update,this)},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"breadcrumbs",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Breadcrumbs.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{construct:!0,require:!0},"qx.event.Timer":{},"cv.Application":{},"cv.ui.structure.tile.elements.Address":{},"cv.Version":{},"qx.locale.Manager":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Button",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,construct:function(t){cv.ui.structure.tile.elements.AbstractCustomElement.constructor.call(this,t);this.__P_76_0=new Map},properties:{type:{check:["button","trigger","push"],init:"button"},on:{check:"Boolean",init:!1,apply:"_applyOn"},onClass:{check:"String",init:"active"},offClass:{check:"String",init:"inactive"},onValue:{check:"String",init:"1"},offValue:{check:"String",init:"0"},styleClass:{check:"String",nullable:!0,apply:"_applyStyleClass"},name:{check:"String",init:"",apply:"_applyName"},progress:{check:"Number",init:-1,apply:"_applyProgress",transform:"_parseInt"}},members:{_writeAddresses:null,__P_76_1:null,__P_76_2:null,__P_76_0:null,_triggerOnValue:null,_parseInt:function(t){var e=parseInt(t);return Number.isNaN(e)?0:e},_init:function(){var t=this,e=this._element;e.hasAttribute("type")&&this.setType(e.getAttribute("type"));e.hasAttribute("name")&&this.setName(e.getAttribute("name"));e.hasAttribute("progress")&&this.setProgress(e.getAttribute("progress"));e.hasAttribute("on-value")&&this.setOnValue(e.getAttribute("on-value"));e.hasAttribute("off-value")&&this.setOffValue(e.getAttribute("off-value"));var r=!1,n=[];Array.prototype.forEach.call(e.querySelectorAll(":scope > cv-address"),(function(t){switch(t.hasAttribute("mode")?t.getAttribute("mode"):"readwrite"){case"readwrite":r=!0;n.push(t);break;case"read":r=!0;break;case"write":n.push(t)}}));this._writeAddresses=n;var i={};if(n.length>0){var o=e;if("true"===e.getAttribute("whole-tile"))for(var a=e.parentElement,s=0;s<=2;){s++;"cv-tile"===(a=a.parentElement).tagName.toLowerCase()&&(o=a).classList.add("clickable")}n.forEach((function(e){switch(e.hasAttribute("on")?e.getAttribute("on"):"click"){case"click":i.click=t.onClicked.bind(t);break;case"up":i.pointerup=t.onPointerUp.bind(t);break;case"down":i.pointerdown=t.onPointerDown.bind(t)}}));Object.getOwnPropertyNames(i).forEach((function(t){return o.addEventListener(t,(function(e){i[t](e)}))}))}e.hasAttribute("doc-link")&&!Object.prototype.hasOwnProperty.call(i,"click")&&e.addEventListener("click",(function(e){t.onClicked(e)}));var c=[];r?e.addEventListener("stateUpdate",(function(e){t.onStateUpdate(e);e.stopPropagation()})):(e.hasAttribute("mapping")||e.hasAttribute("styling"))&&(c=n.filter((function(t){return t.hasAttribute("value")&&!t.hasAttribute("on")})));if(r||1!==c.length){var u=!1,l=!1;n.some((function(t){if(t.hasAttribute("value")&&t.hasAttribute("on")){u||(u="down"===t.getAttribute("on"));l||(l="up"===t.getAttribute("on"))}return l&&u}));l&&u&&this.setType("push")}else{this.setType("trigger");e.hasAttribute("on-value")?this._triggerOnValue=this.getOnValue():this._triggerOnValue=c[0].getAttribute("value");var f=c[0].getAttribute("value");qx.event.Timer.once((function(){t.setOn(f!=t._triggerOnValue)}),this,1e3)}},_initProgress:function(){var t=this._element;this.__P_76_2=100*Math.PI;var e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 100 100");e.setAttribute("type","circle");var r=document.createElementNS("http://www.w3.org/2000/svg","circle");r.classList.add("bar");r.setAttribute("r","49");r.setAttribute("cx","50");r.setAttribute("cy","50");r.setAttribute("stroke-width","2");r.setAttribute("stroke-dasharray",this.__P_76_2+" "+this.__P_76_2);r.setAttribute("stroke-dashoffset",""+this.__P_76_2);e.appendChild(r);t.appendChild(e);t.classList.add("progress")},_applyConnected:function(t){cv.ui.structure.tile.components.Button.superclass.prototype._applyConnected.call(this,t);t&&"trigger"!==this.getType()&&qx.event.Timer.once(this._applyOn,this,1e3)},_applyOn:function(){if(this.isConnected()){var t=this.isOn()?this.getOnValue():this.getOffValue();this._element.setAttribute("value",t||"");var e=t;this._element.hasAttribute("mapping")&&(e=cv.Application.structureController.mapValue(this._element.getAttribute("mapping"),t,this.__P_76_0));var r=this._element.querySelector(".value");r&&"cv-icon"===r.tagName.toLowerCase()?r._instance?r._instance.setId(e):r.textContent=e:this.updateValue(e);var n=this.isOn()?this.getOnClass():this.getOffClass();this._element.hasAttribute("styling")&&(n=cv.Application.structureController.styleValue(this._element.getAttribute("styling"),t,this.__P_76_0));this.setStyleClass(n)}},_applyProgress:function(t){var e=this._element.querySelector(":scope > svg > circle.bar");if(!e){this._initProgress();e=this._element.querySelector(":scope > svg > circle.bar")}if(e){this._element.hasAttribute("progress-mapping")&&(t=cv.Application.structureController.mapValue(this._element.getAttribute("progress-mapping"),t,this.__P_76_0));e.setAttribute("stroke-dashoffset",""+(this.__P_76_2-t/100*this.__P_76_2))}},_applyStyleClass:function(t,e){var r=this._element.classList;e&&r.contains(e)&&r.remove(e);t&&r.add(t)},_applyName:function(t){if(!this.__P_76_1){this.__P_76_1=document.createElement("label");this.__P_76_1.classList.add("button-label");this._element.appendChild(this.__P_76_1)}this.__P_76_1.textContent=t},updateValue:function(t){var e=this._element.querySelector("span.value");e&&(e.innerHTML=t)},onStateUpdate:function(t){var e=t.detail.state==this.getOnValue(),r=t.detail.target||"default";if(t.detail.source instanceof cv.ui.structure.tile.elements.Address){var n=t.detail.source.getElement();n.hasAttribute("value")&&(e=t.detail.state==n.getAttribute("value"))}"default"===r?this.setOn(e):"progress"===r?this.setProgress(t.detail.state):r.startsWith("store:")?this.__P_76_0.set(r.substring(6),t.detail.state):"store"===r&&this.__P_76_0.set(t.detail.targetConfig&&1===t.detail.targetConfig.length?t.detail.targetConfig[0]:t.detail.address,t.detail.state)},onClicked:function(t){var e=this;this.createRipple(t);if(this._element.hasAttribute("doc-link")){var r=this._element.getAttribute("doc-link"),n=cv.Version.VERSION.split(".").slice(0,2).join("."),i=qx.locale.Manager.getInstance().getLanguage();"de"!==i&&(i="en");window.open("https://www.cometvisu.org/CometVisu/".concat(i,"/").concat(n,"/manual/").concat(r));t.stopPropagation()}else{this._writeAddresses||(this._writeAddresses=Array.prototype.filter.call(this._element.querySelectorAll("addresses > cv-address"),(function(t){return!t.hasAttribute("mode")||"read"!==t.getAttribute("mode")})));var o=new CustomEvent("sendState",{detail:{value:this.isOn()?this.getOffValue():this.getOnValue(),source:this}}),a=this._writeAddresses.filter((function(t){return!t.hasAttribute("on")||"click"===t.getAttribute("on")}));if("trigger"===this.getType()){var s=a[0].getAttribute("value")==this._triggerOnValue;this.setOn(s);qx.event.Timer.once((function(){e.setOn(!s)}),null,500)}a.forEach((function(t){return t.dispatchEvent(o)}));t.stopPropagation()}},onPointerDown:function(){var t=this;this._writeAddresses.filter((function(t){return"down"===t.getAttribute("on")&&t.hasAttribute("value")})).forEach((function(e){e.dispatchEvent(new CustomEvent("sendState",{detail:{value:e.getAttribute("value"),source:t}}))}))},onPointerUp:function(){var t=this;this._writeAddresses.filter((function(t){return"up"===t.getAttribute("on")&&t.hasAttribute("value")})).forEach((function(e){e.dispatchEvent(new CustomEvent("sendState",{detail:{value:e.getAttribute("value"),source:t}}))}))},createRipple:function(t){var e=t.currentTarget,r=e.querySelector(":scope .ripple-container");if(!r){(r=document.createElement("div")).classList.add("ripple-container");e.appendChild(r)}var n=document.createElement("span"),i=Math.max(e.clientWidth,e.clientHeight),o=i/2;n.style.width=n.style.height="".concat(i,"px");var a=t.clientX-(e.offsetLeft+o),s=t.clientY-(e.offsetTop+o);if(e===this._element){a-=e.offsetParent.offsetLeft;s-=e.offsetParent.offsetTop}n.style.left="".concat(a,"px");n.style.top="".concat(s,"px");n.classList.add("ripple");r.querySelectorAll(".ripple").forEach((function(t){return t.remove()}));r.appendChild(n)}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"button",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Button.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"cv.data.Model":{},"cv.ui.structure.tile.components.Button":{},"cv.Transform":{},"qx.event.Timer":{},"cv.io.BackendConnections":{},"cv.Application":{},"cv.util.String":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Address",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,members:{__P_92_0:null,__P_92_1:null,_stateUpdateTarget:null,getAddress:function(){return this._element.textContent.trim()},_init:function(){var t=this,e=this._element;this._stateUpdateTarget=e;var r=this.getAddress();if(r){var n=cv.data.Model.getInstance(),i=e.getAttribute("backend");n.addAddress(r,e.getAttribute("id"),i);var o=e.hasAttribute("mode")?e.getAttribute("mode"):"readwrite";if("write"!==o){var a=n.getState(r,i);void 0!==a&&this.fireStateUpdate(r,a);n.addUpdateListener(r,this.fireStateUpdate,this,i);e.hasAttribute("target")&&e.getAttribute("target").startsWith("last-update")&&void 0===a&&this.fireStateUpdate(r,"-")}"read"!==o&&e.addEventListener("sendState",(function(n){var o=null;Object.prototype.hasOwnProperty.call(n.detail,"value")&&(o=n.detail.value);var a=n.detail.source&&n.detail.source instanceof cv.ui.structure.tile.components.Button&&("trigger"===n.detail.source.getType()||"push"===n.detail.source.getType());if(e.hasAttribute("value")){o=e.getAttribute("value");a=!0}if(null!==o){var s=e.getAttribute("transform")||"raw",c=cv.Transform.encodeBusAndRaw({transform:s,selector:t._element.getAttribute("selector"),ignoreError:"true"===t._element.getAttribute("ignore-error"),variantInfo:t._element.getAttribute("variant"),qos:0|(t._element.getAttribute("qos")||0)},o);if(a||!Object.prototype.hasOwnProperty.call(e,"lastSentValue")||c.raw!==e.lastSentValue)if(e.hasAttribute("delay")){var u=parseInt(e.getAttribute("delay"));t.debug("send with delay of ".concat(u,"ms"));qx.event.Timer.once((function(){cv.io.BackendConnections.getClient(i).write(r,c.bus,e);a||(e.lastSentValue=c.raw)}),t,u)}else{cv.io.BackendConnections.getClient(i).write(r,c.bus,e);a||(e.lastSentValue=c.raw)}}}))}},fireStateUpdate:function(t,e){if(this.__P_92_0!==e||"always"===this._element.getAttribute("send-mode")){var r=this._element.getAttribute("transform")||"raw",n=cv.Transform.decode({transform:r,selector:this._element.getAttribute("selector"),ignoreError:"true"===this._element.getAttribute("ignore-error"),variantInfo:this._element.getAttribute("variant"),qos:0|(this._element.getAttribute("qos")||0)},e),i="";if(this._element.hasAttribute("mapping")){i=this._element.getAttribute("mapping");n=cv.Application.structureController.mapValue(i,n)}this._element.hasAttribute("format")&&(n=cv.util.String.sprintf(this._element.getAttribute("format"),n instanceof Date?n.toLocaleString():n));var o=this._element.hasAttribute("target")?this._element.getAttribute("target").split(":"):[],a=o.length>0?o.shift():"",s=new CustomEvent("stateUpdate",{bubbles:!0,cancelable:!0,detail:{address:this.getAddress(),state:n,target:a,targetConfig:o,raw:e,mapping:i,addressValue:this._element.hasAttribute("value")?this._element.getAttribute("value"):null,source:this,variant:this._element.hasAttribute("variant")?this._element.getAttribute("variant"):null}});this.__P_92_1=n;this._stateUpdateTarget.dispatchEvent(s);this.__P_92_0=e;e!==this._element.lastSentValue&&(this._element.lastSentValue=null)}},isRead:function(){return"write"!==this._element.getAttribute("mode")},isWrite:function(){return"read"!==this._element.getAttribute("mode")},getValue:function(){return this.__P_92_1}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"address",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.elements.Address.$$dbClassInfo=t}();function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:A(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",_="executing",d="completed",y={};function m(){}function v(){}function b(){}var g={};u(g,a,(function(){return this}));var P=Object.getPrototypeOf,C=P&&P(P(q([])));C&&C!==r&&n.call(C,a)&&(g=C);var w=b.prototype=m.prototype=Object.create(g);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,r,n){var i=p;return function(o,a){if(i===_)throw Error("Generator is already running");if(i===d){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=_;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?d:h,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=d,n.method="throw",n.arg=u.arg)}}}function x(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function q(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(_typeof(e)+" is not iterable")}return v.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},O(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new S(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(w),u(w,c,"Generator"),u(w,a,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=q,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:q(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function asyncGeneratorStep(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){asyncGeneratorStep(o,n,i,a,s,"next",t)}function s(t){asyncGeneratorStep(o,n,i,a,s,"throw",t)}a(void 0)}))}}!function(){var t=this,e={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MRefresh":{require:!0},"cv.ui.structure.tile.MResize":{require:!0},"cv.ui.structure.tile.MFullscreen":{require:!0},"cv.util.ScriptLoader":{},"qx.util.ResourceManager":{},"qx.log.Logger":{},"qx.event.Timer":{},"qx.locale.Manager":{},"qx.locale.Number":{},"qx.locale.Date":{},"cv.util.String":{},"cv.io.BackendConnections":{},"cv.io.timeseries.FluxSource":{},"cv.ConfigCache":{},"cv.io.timeseries.OpenhabPersistenceSource":{},"cv.io.timeseries.RRDSource":{},"cv.io.timeseries.DemoSource":{},"cv.io.Fetch":{},"cv.core.notifications.Router":{},"qx.util.format.DateFormat":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(e);qx.Class.define("cv.ui.structure.tile.components.Chart",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MRefresh,cv.ui.structure.tile.MResize,cv.ui.structure.tile.MFullscreen],statics:{ChartCounter:0,DEFAULT_ASPECT_RATIO:2.0416666666666665,JS_LOADED:new Promise(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(r,n){var i,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=function(){return"object"===_typeof(window.d3)};e.prev=1;e.next=4;return cv.util.ScriptLoader.includeScript(qx.util.ResourceManager.getInstance().toUri("libs/d3.min.js"));case 4:e.next=11;break;case 6:e.prev=6;e.t0=e.catch(1);qx.log.Logger.error(t,"Error loading D3:",e.t0);n(new Error("Error loading d3 library"));return e.abrupt("return");case 11:if(i())r(!0);else{o=new qx.event.Timer(50);a=0;o.addListener("interval",(function(){a++;i()?r(!0):a>5&&n(new Error("Error loading d3 library"))}))}case 12:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,r){return e.apply(this,arguments)}}()).then((function(){if("de"===qx.locale.Manager.getInstance().getLanguage()){d3.formatDefaultLocale({decimal:qx.locale.Number.getDecimalSeparator().translate().toString(),thousands:qx.locale.Number.getGroupSeparator().translate().toString(),grouping:[3],currency:["€",""]});d3.timeFormatDefaultLocale({dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:[qx.locale.Date.getAmMarker().translate().toString(),qx.locale.Date.getPmMarker().translate().toString()],days:qx.locale.Date.getDayNames("wide",null,"format").map((function(t){return t.translate().toString()})),shortDays:qx.locale.Date.getDayNames("narrow",null,"stand-alone").map((function(t){return t.translate().toString()})),months:qx.locale.Date.getMonthNames("wide").map((function(t){return t.translate().toString()})),shortMonths:qx.locale.Date.getMonthNames("narrow",null,"stand-alone").map((function(t){return t.translate().toString()}))})}})),CONFIG:null},properties:{currentSeries:{check:["hour","day","week","month","year"],init:"day",apply:"_applyCurrentSeries"},currentPeriod:{check:"Number",init:0,apply:"__P_77_0"},startTime:{check:"Number",init:0},endTime:{check:"Number",init:0}},members:{_id:null,_downloadedImage:null,_url:null,_headers:null,_request:null,_width:null,_height:null,_loaded:null,_dataSetConfigs:null,_initializing:null,_navigationEnabled:null,__P_77_1:null,__P_77_2:!1,__P_77_3:null,__P_77_4:null,__P_77_5:null,__P_77_6:null,_dot:null,_svg:null,_tooltip:null,_titleString:null,__P_77_7:null,__P_77_8:null,_chartConf:null,_init:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){var r,n,i,o,a,s,c,u,l,f,p,h,_,d,y,m,v,b,g,P,C;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._checkEnvironment();t._initializing=!0;r=t._element;e.next=5;return cv.ui.structure.tile.components.Chart.JS_LOADED;case 5:t._id=cv.ui.structure.tile.components.Chart.ChartCounter++;r.setAttribute("data-chart-id",t._id.toString());n=t._element.hasAttribute("background")&&"true"===t._element.getAttribute("background");i=t.getHeader("label.title");if(!n&&r.hasAttribute("title")&&!i){(i=document.createElement("label")).classList.add("title");o=document.createElement("span");i.appendChild(o);o.textContent=r.getAttribute("title");t.appendToHeader(i)}i&&(t._titleString=i.textContent.trim());a=[];if(!n&&r.hasAttribute("selection")){s=r.getAttribute("selection");a="none"===s?[]:"all"===s?["hour","day","week","month","year"]:s.split(",").map((function(t){return t.trim().toLowerCase()}))}r.hasAttribute("series")&&t.setCurrentSeries(r.getAttribute("series"));c=t.getCurrentSeries();a.length>0&&!a.includes(c)&&a.push(c);t._navigationEnabled=a.length>0;if(a.length>0){(u=t._buttonFactory("ri-arrow-left-s-line",["prev"])).setAttribute("title",qx.locale.Manager.tr("previous"));u.addEventListener("click",(function(){return t._onSeriesPrev()}));if(!i){(i=document.createElement("label")).classList.add("title");l=document.createElement("span");i.appendChild(l);t.appendToHeader(i)}i.parentElement.insertBefore(u,i);(f=document.createElement("i")).classList.add("ri-arrow-down-s-fill");i.appendChild(f);(p=document.createElement("div")).classList.add("popup","series");_=_createForOfIteratorHelper(a);try{for(_.s();!(d=_.n()).done;){y=d.value;(h=document.createElement("cv-option")).setAttribute("key",y);y===c&&h.setAttribute("selected","selected");h.textContent=t._seriesToShort(y);h.addEventListener("click",(function(e){p.style.display="none";t._onSeriesChange(e.target.getAttribute("key"));e.stopPropagation();e.preventDefault()}));p.appendChild(h)}}catch(t){_.e(t)}finally{_.f()}i.appendChild(p);i.classList.add("clickable");i.addEventListener("click",(function(t){"none"===getComputedStyle(p).getPropertyValue("display")?p.style.display="flex":p.style.display="none";t.stopPropagation();t.preventDefault()}));(u=t._buttonFactory("ri-arrow-right-s-line",["next"])).setAttribute("title",qx.locale.Manager.tr("next"));u.disabled=!0;u.addEventListener("click",(function(){return t._onSeriesNext()}));t.appendToHeader(u)}if(!n&&r.hasAttribute("allow-fullscreen")&&"true"===r.getAttribute("allow-fullscreen")){t._initFullscreenSwitch();document.body.classList.contains("mobile")&&t.addListener("changeFullscreen",(function(){return t._onRendered()}))}r.hasAttribute("refresh")&&t.setRefresh(parseInt(r.getAttribute("refresh")));m=d3.select(t._element).append("svg");v=!1;if(n){v=!0;m.style("opacity",.4)}if(!v){t._tooltip=document.createElement("div");t._tooltip.classList.add("tooltip");t._tooltip.style.display="none";t._element.appendChild(t._tooltip);m.on("pointerenter",(function(e){return t._onPointerEntered(e)}));m.on("pointermove",(function(e){return t._onPointerMoved(e)}));m.on("pointerleave",(function(e){return t._onPointerLeft(e)}))}m.on("touchmove",(function(e){if(t._loaded){var r=e.targetTouches[0].clientY,n=t._element.querySelector(":scope > svg").getBoundingClientRect();r>n.y&&r<n.y+n.height&&e.preventDefault()}}),{passive:!1});b=t._element.hasAttribute("y-format")?t._element.getAttribute("y-format"):"%s";g=null;if(t._element.hasAttribute("x-format")){P=t._element.getAttribute("x-format");g=function(t){return d3.timeFormat(P)(t)}}else g=t.multiTimeFormat([["%H:%M:%S",function(t){return t.getSeconds()}],["%H:%M",function(t){return t.getMinutes()}],["%H",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!==t.getDate()}],["%b %d",function(t){return 1!==t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",function(){return!0}]]);t.__P_77_8={x:function(t){return t.time},y:function(t){return+t.value},z:function(t){return t.key},color:function(e){return e&&t._dataSetConfigs[e].color},title:function(t){return cv.util.String.sprintf(b,t.value)},curve:d3.curveLinear,marginTop:12,marginRight:24,marginBottom:20,marginLeft:24,width:392,height:192,aspectRatio:2.0416666666666665,xType:d3.scaleTime,xFormat:g,yType:d3.scaleLinear,yFormat:void 0,yLabel:void 0,strokeLinecap:void 0,strokeLinejoin:void 0,strokeWidth:1.5,strokeOpacity:void 0,mixBlendMode:"normal",showArea:function(e){return t._dataSetConfigs[e].showArea},showXAxis:!t._element.hasAttribute("show-x-axis")||"true"===t._element.getAttribute("show-x-axis"),showYAxis:!t._element.hasAttribute("show-y-axis")||"true"===t._element.getAttribute("show-y-axis"),xPadding:.1};t._initializing=!1;t.__P_77_9();C=Array.from(t._element.querySelectorAll(":scope > dataset")).map((function(t){return t.getAttribute("src")}));Array.from(r.querySelectorAll(':scope > cv-address:not([mode="write"])')).filter((function(t){return C.includes(t.getAttribute("target"))})).length>0&&r.addEventListener("stateUpdate",(function(e){t.onStateUpdate(e);e.stopPropagation()}));case 34:case"end":return e.stop()}}),e)})))()},onStateUpdate:function(t){var e=this._element.querySelector(':scope > dataset[src="'+t.detail.target+'"]'),r=this._dataSetConfigs?this._dataSetConfigs[t.detail.target]:null;if(e&&r){var n=Date.now();if(r.aggregationInterval){var i=60*r.aggregationInterval*1e3;n=Math.round(n/i)*i}this._renderChart({src:t.detail.target,time:n,value:t.detail.state},!0)}},_onSeriesPrev:function(){this.setCurrentPeriod(this.getCurrentPeriod()+1)},_onSeriesChange:function(t){if(this.getCurrentSeries()!==t){this._initializing=!0;this.resetCurrentPeriod();this._initializing=!1;this._chartConf=null;this.setCurrentSeries(t)}},_onSeriesNext:function(){var t=this.getCurrentPeriod();t>0&&this.setCurrentPeriod(t-1)},refresh:function(){this._loaded=!1;this.__P_77_0();this._loadData()},_refreshData:function(){var t=this.getHeader(".next");t&&(0===this.getCurrentPeriod()?t.setAttribute("disabled","disabled"):t.removeAttribute("disabled"));if(!this._initializing&&this.getStartTime()>0&&this.getEndTime()>0){this._loaded=!1;this._loadData()}this.__P_77_9()},_applyCurrentSeries:function(t){var e=this.getHeader('.popup.series > cv-option[selected="selected"]'),r=!1;e&&(e.getAttribute("key")!==t?e.removeAttribute("selected"):r=!0);if(!r){var n=this.getHeader('.popup.series > cv-option[key="'.concat(t,'"]'));n&&n.setAttribute("selected","selected")}this.__P_77_0()},__P_77_0:function(){var t=this.getCurrentSeries(),e=this.getCurrentPeriod(),r=new Date,n=new Date,i=0;switch(t){case"hour":i=3600;n.setHours(n.getHours()-e,0,0,0);r.setHours(n.getHours()+1,0,0,0);break;case"day":i=86400;n.setDate(n.getDate()-e);n.setHours(0,0,0,0);r.setTime(n.getTime());r.setDate(n.getDate()+1);r.setHours(0,0,0,0);break;case"week":i=604800;n.setDate(n.getDate()-(n.getDay()||7)+1-7*e);n.setHours(0,0,0,0);r.setTime(n.getTime());r.setDate(n.getDate()+7);r.setHours(0,0,0,0);break;case"month":i=2592e3;n.setMonth(n.getMonth()-e);n.setDate(1);n.setHours(0,0,0,0);r.setTime(n.getTime());r.setMonth(n.getMonth()+1,1);r.setHours(0,0,0,0);break;case"year":i=31536e3;n.setFullYear(n.getFullYear()-e);n.setMonth(0,1);n.setHours(0,0,0,0);r.setFullYear(n.getFullYear()+1);r.setMonth(n.getMonth()+1,1);r.setHours(0,0,0,0)}var o=Math.round(n.getTime()/1e3),a=Math.round(r.getTime()/1e3);"true"!==this._element.getAttribute("background")&&this._element.hasAttribute("selection")||(o=a-i);this.setStartTime(o);this.setEndTime(a);this._refreshData()},_loadData:function(){var t=this;if(!(this._loaded&&Date.now()-this._loaded<3e5)){var e=cv.io.BackendConnections.getClient();if(e)if(e.isConnected()){var r,n=this._element.querySelectorAll(":scope > dataset"),i=[];if(!this._dataSetConfigs){this._dataSetConfigs={};var o,a=_createForOfIteratorHelper(n);try{for(a.s();!(o=a.n()).done;){for(var s=o.value,c={showArea:!0,color:"#FF9900",chartType:"line",title:"",curve:"linear",aggregationInterval:0},u=void 0,l=void 0,f=void 0,p=0;p<s.attributes.length;p++){l=(u=s.attributes.item(p)).name.split("-").map((function(t,e){return e>0?"".concat(t.substring(0,1).toUpperCase()).concat(t.substring(1)):t})).join("");"true"===(f=u.value)||"false"===f?f="true"===f:/^\d+$/.test(f)?f=parseInt(f):/^[\d.]+$/.test(f)&&(f=parseFloat(f));c[l]=f}var h=c.src.split("://")[0].toLowerCase();c.type=h;var _=c.src;switch(h){case"flux":c.source=new cv.io.timeseries.FluxSource(c.src);if(c.source.isInline()){var d=s.textContent.trim();_=cv.ConfigCache.hashCode(d).toString();c.source.setQueryTemplate(d)}break;case"openhab":c.source=new cv.io.timeseries.OpenhabPersistenceSource(c.src);break;case"rrd":c.source=new cv.io.timeseries.RRDSource(c.src);break;case"demo":c.source=new cv.io.timeseries.DemoSource(c.src);break;default:this.error("unknown chart data source type "+h)}c.key=_;this._dataSetConfigs[_]=c}}catch(t){a.e(t)}finally{a.f()}}var y=function(){var n=t._dataSetConfigs[m],o=!1,a={ttl:t.getRefresh()};if(n.source){var s=n.source.getRequestConfig(t.getStartTime(),t.getEndTime(),t.getCurrentSeries(),t.getCurrentPeriod());r=s.url;o=s.proxy;a=Object.assign(a,s.options)}if(!r)return 1;t.debug("loading",r);i.push(cv.io.Fetch.cachedFetch(r,a,o,e).then((function(e){t.debug("successfully loaded",r);n.source&&(e=n.source.processResponse(e));t._lastRefresh||(t._lastRefresh=Date.now());return{data:e||[],ts:n}})).catch((function(e){t._onStatusError(n,r,e);return{data:[],ts:n}})))};for(var m in this._dataSetConfigs)y();Promise.all(i).then((function(e){t._onSuccess(e)}))}else e.addListenerOnce("changeConnected",(function(){t._loadData()}))}},_onSuccess:function(t){var e,r=this,n=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(e=i.n()).done;){var o=e.value,a=o.data;if(null!==a){var s,c=o.ts.aggregationInterval>0?60*o.ts.aggregationInterval*1e3:0,u=_createForOfIteratorHelper(a);try{for(u.s();!(s=u.n()).done;){var l=_slicedToArray(s.value,2),f=l[0],p=l[1];n.push({key:o.ts.key,src:o.ts.src,time:c>0?Math.round(f/c)*c:f,value:p})}}catch(t){u.e(t)}finally{u.f()}}}}catch(t){i.e(t)}finally{i.f()}if(this._element.hasAttribute("background")&&"true"===this._element.getAttribute("background")){this.__P_77_8=Object.assign(this.__P_77_8,{marginRight:0,marginBottom:0,marginLeft:0});for(var h=this._element.parentElement;h&&"cv-tile"!==h.localName;)h=h.parentElement;h&&"cv-tile"===h.localName&&(h.style.overflow="hidden")}window.requestAnimationFrame((function(){setTimeout((function(){r._onRendered(n)}),100)}))},_onRendered:function(t,e){var r=this;if(this.__P_77_4){clearTimeout(this.__P_77_4);this.__P_77_4=null}if(this.isVisible()){var n=this._getSize(),i=_slicedToArray(n,2),o=i[0],a=i[1];(o<20||a<10)&&(!e||e<=5)&&(this.__P_77_4=setTimeout((function(){r._onRendered(t,e>0?e+1:1)}),150));if(o<20||a<10)return;this.__P_77_8.width=o;this.__P_77_8.height=a;d3.select(this._element).select("svg").attr("viewBox","0, 0, ".concat(o,", ").concat(a));if(t){this._renderChart(t);this._loaded=Date.now()}}},_getSize:function(){var t=this._element.parentElement,e="true"===this._element.getAttribute("background")?0:8,r=this._element.offsetWidth-e,n=this._element.offsetHeight-e,i=0,o=0;if(r>n&&n>0){i=Math.round(r/1);o=Math.round(n/1)}else o=(i=Math.round(r/1))/cv.ui.structure.tile.components.Chart.DEFAULT_ASPECT_RATIO;!this._element.style.height&&("cv-popup"===t.localName&&"true"===t.getAttribute("fullscreen")||"true"===this._element.getAttribute("allow-fullscreen")&&t.parentElement.classList.contains("fullscreen"))&&(this._element.style.height=o+this.__P_77_8.marginTop+this.__P_77_8.marginBottom+"px");return[i,o]},multiTimeFormat:function(t){return function(e){return d3.timeFormat(function(e){for(var r=0,n=!1,i="%c";!n&&r<t.length;){(n=t[r][1](e))&&(i=t[r][0]);r++}return i}(e))(e)}},_onStatusError:function(t,e,r){cv.core.notifications.Router.dispatchMessage("cv.charts.error",{title:qx.locale.Manager.tr("Communication error"),severity:"urgent",message:qx.locale.Manager.tr("URL: %1<br/><br/>Response:</br>%2",JSON.stringify(e),JSON.stringify(r))});this.error("Chart _onStatusError",t,e,r)},_getSvgElement:function(t,e,r,n){var i=t.select(e+"."+r.join("."));if(i.empty()){i=t.append(e).attr("class",r.join(" "));if(n)for(var o in n)i.attr(o,n[o])}return i},_renderChart:function(t,e){var r,n,i,o,a,s=this,c=this.__P_77_8,u=d3.select(this._element).select("svg");if(e){if(!this._helpers)return;r=this._helpers.X;n=this._helpers.Y;i=this._helpers.Z;o=this._helpers.O;a=this._helpers.T;if(r[r.length-1]===t.time)n[n.length-1]=t.value;else{r.push(t.time);n.push(t.value);i.push(t.key);o.push(t);a.push(void 0===c.title?t.src:null===c.title?null:c.title(t));r.shift();n.shift();i.shift();o.shift();a.shift()}}else{r=d3.map(t,c.x);n=d3.map(t,c.y);i=d3.map(t,c.z);o=d3.map(t,(function(t){return t}));a=void 0===c.title?i:null===c.title?null:d3.map(t,c.title)}var l=d3.extent(r),f=0,p=0;if(this._element.hasAttribute("min")){var h=parseFloat(this._element.getAttribute("min"));isNaN(h)||(f=h)}else(f=d3.min(n))>1&&(f-=1);if(this._element.hasAttribute("max")){var _=parseFloat(this._element.getAttribute("max"));isNaN(_)||(p=_)}else{p=d3.max(n);p+=p>1?1:.1}var d=[f,p],y=new d3.InternSet(i),m=d3.range(r.length).filter((function(t){return y.has(i[t])}));if(c.showYAxis){var v=c.yFormat?c.yFormat(d[1]):d[1].toFixed(p<1?2:1);v.length>=2&&(c.marginLeft=8*v.length)}var b=c.width/80,g=c.height/60,P="true"===this._element.getAttribute("background")?0:2,C=[c.marginLeft+P,c.width-c.marginRight-P];if(!this._chartConf){var w=[c.height-c.marginBottom,c.marginTop];this._chartConf={x:c.xType().range(C),y:c.yType().range(w)};this._chartConf.xAxis=c.showXAxis?d3.axisBottom(this._chartConf.x).ticks(b).tickSizeOuter(0).tickFormat(c.xFormat):void 0;this._chartConf.yAxis=c.showYAxis?d3.axisLeft(this._chartConf.y).ticks(g,c.yFormat):void 0;var O=this._element.hasAttribute("show-grid")?this._element.getAttribute("show-grid"):"xy";if(O.includes("x")){this._chartConf.xGrid=d3.axisBottom(this._chartConf.x).ticks(b).tickSize(-c.height+c.marginBottom+c.marginTop).tickFormat("");this._getSvgElement(u,"g",["grid","x"],{transform:"translate(0,".concat(c.height-c.marginBottom,")")}).call(this._chartConf.xGrid)}if(O.includes("y")){this._chartConf.yGrid=d3.axisLeft(this._chartConf.y).ticks(g).tickSize(-c.width+c.marginRight+c.marginLeft).tickFormat("");this._getSvgElement(u,"g",["grid","y"],{transform:"translate(".concat(c.marginLeft,",0)")}).call(this._chartConf.yGrid)}c.showXAxis&&this._getSvgElement(u,"g",["axis","x"]).attr("transform","translate(0,".concat(c.height-c.marginBottom,")")).call(this._chartConf.xAxis);if(c.showYAxis){var S=this._getSvgElement(u,"g",["axis","y"]).attr("transform","translate(".concat(c.marginLeft,",0)"));c.label&&S.select("text").empty()&&S.append("text").attr("x",-c.marginLeft).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(c.yLabel);S.call(this._chartConf.yAxis).call((function(t){return t.select(".domain").remove()}))}var A,x,E=new Map,T=new Map,k=new Map,q=new Map,L={},j={},I=function(t){switch(s._dataSetConfigs[t].chartType){case"line":var e=m.filter((function(e){return i[e]===t}));E.set(t,e);var r=s._dataSetConfigs[t].curve||"linear";if(!Object.prototype.hasOwnProperty.call(L,r)){var n;switch(r){case"linear":n=d3.curveLinear;break;case"step":n=d3.curveStep;break;case"natural":n=d3.curveNatural}n&&(L[r]=d3.line().curve(n).x((function(t){return s._chartConf.x(s._helpers.X[t])})).y((function(t){return s._chartConf.y(s._helpers.Y[t])})));if("line"===s._dataSetConfigs[t].chartType&&"function"==typeof c.showArea&&c.showArea(t)){T.set(t,e);if(n){var o=s._chartConf.y.range()[0];j[r]=d3.area().curve(n).x((function(t){return s._chartConf.x(s._helpers.X[t])})).y0((function(){return o})).y1((function(t){return s._chartConf.y(s._helpers.Y[t])}))}}}break;case"bar":k.set(t,m.filter((function(e){return i[e]===t})));A||(A=d3.scaleBand().range(s._chartConf.x.range()).padding(c.xPadding));x||(x=d3.scaleBand().padding(.05));break;case"stacked-bar":q.set(t,m.filter((function(e){return i[e]===t})))}};for(var R in this._dataSetConfigs)I(R);this._chartConf.lineGroups=E;this._chartConf.areaGroups=T;this._chartConf.barGroups=k;this._chartConf.stackedBarGroups=q;this._chartConf.lineFunctions=L;this._chartConf.areaFunctions=j;this._chartConf.xBar=A;x&&(this._chartConf.xz=x);this._chartConf.lineGroups.size>0&&(this._chartConf.lineContainer=this._getSvgElement(u,"g",["line"],{fill:"none",stroke:"string"==typeof c.color?c.color:null,"stroke-linecap":c.strokeLinecap,"stroke-linejoin":c.strokeLinejoin,"stroke-width":c.strokeWidth,"stroke-opacity":c.strokeOpacity}));this._chartConf.areaGroups.size>0&&(this._chartConf.areaContainer=this._getSvgElement(u,"g",["area"],{stroke:"none",fill:"string"==typeof c.color?this.__P_77_10(c.color,"30"):null}));this._chartConf.barGroups.size>0&&(this._chartConf.barContainer=this._getSvgElement(u,"g",["bars"]))}this._chartConf.x.domain(l);this._chartConf.y.domain(d);this._helpers={X:r,Y:n,I:m,T:a,Z:i,O:o};this._chartConf.xAxis&&this._getSvgElement(u,"g",["axis","x"]).call(this._chartConf.xAxis);this._chartConf.yAxis&&this._getSvgElement(u,"g",["axis","y"]).call(this._chartConf.yAxis);this._chartConf.xBar&&this._chartConf.xBar.domain(new d3.InternSet(r));if(this._chartConf.xz){this._chartConf.xz.domain(y);this._chartConf.x.range([C[0],C[1]-this._chartConf.xBar.bandwidth()]);this._chartConf.xz.range([0,this._chartConf.xBar.bandwidth()])}var M,N=_createForOfIteratorHelper(this._chartConf.lineGroups.keys());try{var F=function(){var t=M.value,e=m.filter((function(e){return i[e]===t}));s._chartConf.lineGroups.set(t,e)};for(N.s();!(M=N.n()).done;)F()}catch(t){N.e(t)}finally{N.f()}var B,D=_createForOfIteratorHelper(this._chartConf.areaGroups.keys());try{var V=function(){var t=B.value,e=m.filter((function(e){return i[e]===t&&void 0!==n[e]}));s._chartConf.areaGroups.set(t,e)};for(D.s();!(B=D.n()).done;)V()}catch(t){D.e(t)}finally{D.f()}var H,z=_createForOfIteratorHelper(this._chartConf.barGroups.keys());try{var G=function(){var t=H.value,e=m.filter((function(e){return i[e]===t&&void 0!==n[e]}));s._chartConf.barGroups.set(t,e)};for(z.s();!(H=z.n()).done;)G()}catch(t){z.e(t)}finally{z.f()}var U,$=_createForOfIteratorHelper(this._chartConf.stackedBarGroups.keys());try{var W=function(){var t=U.value,e=m.filter((function(e){return i[e]===t&&void 0!==n[e]}));s._chartConf.stackedBarGroups.set(t,e)};for($.s();!(U=$.n()).done;)W()}catch(t){$.e(t)}finally{$.f()}this.__P_77_8=c;this._dot=u.select("g.dot");if(0!==f){var K=this._chartConf.lineContainer||this._chartConf.areaContainer||this._chartConf.barContainer,X=[0,r.length-1],Y=K.select(".zero-line");Y.empty()&&(Y=K.append("line").attr("class","zero-line").attr("stroke","currentColor").attr("stroke-opacity","15%"));if(r.length>0){var Q=this._chartConf.x(r[X[0]]),J=this._chartConf.x(r[r.length-1]),Z=this._chartConf.y(0);Y.attr("x1",Q).attr("x2",J).attr("y1",Z).attr("y2",Z)}}var tt=d3.transition().duration(e?0:500).ease(d3.easeLinear);this._chartConf.lineContainer&&this._chartConf.lineContainer.selectAll("path").data(this._chartConf.lineGroups).join((function(t){return t.append("path").style("mix-blend-mode",c.mixBlendMode).attr("stroke","function"==typeof c.color?function(t){return c.color(t[0])}:null)})).transition(tt).attr("d",(function(t){var e=s._dataSetConfigs[t[0]].curve||"linear";return(s._chartConf.lineFunctions[e]||s._chartConf.lineFunctions.linear)(t[1])}));this._chartConf.areaContainer&&this._chartConf.areaContainer.selectAll("path").data(this._chartConf.areaGroups).join((function(t){return t.append("path").style("mix-blend-mode",c.mixBlendMode).attr("fill","function"==typeof c.color?function(t){return s.__P_77_10(c.color(t[0]),"30")}:null)})).transition(tt).attr("d",(function(t){var e=s._dataSetConfigs[t[0]].curve||"linear";return(s._chartConf.areaFunctions[e]||s._chartConf.areaFunctions.linear)(t[1])}));if(this._chartConf.barContainer){var et=this._chartConf.y.range()[0];this._chartConf.barContainer.selectAll("g").data(this._chartConf.barGroups).join("g").attr("fill","function"==typeof c.color?function(t){return c.color(t[0])}:null).selectAll("rect").data((function(t){return t[1].map((function(e){return{key:t[0],value:e}}))})).join("rect").attr("x",(function(t){return s._chartConf.x(r[t.value])+s._chartConf.xz(t.key)})).attr("y",(function(t){return s._chartConf.y(n[t.value])})).attr("width",this._chartConf.xz.bandwidth()).transition(tt).attr("height",(function(t){return et-s._chartConf.y(n[t.value])}))}var rt,nt=_createForOfIteratorHelper(this._element.querySelectorAll(":scope > h-line").entries());try{var it=function(){var t=_slicedToArray(rt.value,2),e=t[0],i=t[1],o=i.getAttribute("src"),a=null,c=null,u=NaN;if(o){if(s._chartConf.lineGroups.get(o)){a=s._chartConf.lineContainer;c=s._chartConf.lineGroups.get(o)}else if(s._chartConf.areaGroups.get(o)){a=s._chartConf.areaContainer;c=s._chartConf.areaGroups.get(o)}else if(s._chartConf.barGroups.get(o)){a=s._chartConf.barContainer;c=s._chartConf.barGroups.get(o)}if(!c){s.error("no data found for src "+o);return 0}switch(i.getAttribute("value")){case"avg":var l,f=0,p=_createForOfIteratorHelper(c);try{for(p.s();!(l=p.n()).done;){var h=l.value;f+=n[h]}}catch(t){p.e(t)}finally{p.f()}u=f/c.length;break;case"max":u=d3.max(n.filter((function(t,e){return c.includes(e)}),(function(t){return t})));break;case"min":u=d3.min(n.filter((function(t,e){return c.includes(e)}),(function(t){return t})));break;default:s.error("unknown value calculation: "+i.getAttribute("value"))}}else{a=s._chartConf.lineContainer||s._chartConf.areaContainer||s._chartConf.barContainer;u=parseFloat(i.getAttribute("value"));c=[0,r.length-1]}if(!a)return 0;var _=a.select(".line-"+e);if(isNaN(u)&&!_.empty()){_.remove();"true"===i.getAttribute("show-value")&&a.select(".line-value-"+e).remove()}else if(!isNaN(u)){var d=i.getAttribute("color")||"currentColor";_.empty()&&(_=a.append("line").attr("class","line-"+e).attr("stroke",d));var y=s._chartConf.x(r[c[0]]),m=s._chartConf.x(r[r.length-1]),v=s._chartConf.y(u);_.attr("x1",y).attr("x2",m).attr("y1",v).attr("y2",v);if("true"===i.getAttribute("show-value")){var b=i.hasAttribute("format")?i.getAttribute("format"):s._element.hasAttribute("y-format")?s._element.getAttribute("y-format"):"%s",g=a.select(".line-value-"+e);g.empty()&&(g=a.append("text").attr("class","line-value-"+e).attr("fill",i.getAttribute("value-color")||d).attr("font-size","10").attr("text-anchor","start"));g.attr("x",m+2).attr("y",v+5).text(cv.util.String.sprintf(b,u))}}};for(nt.s();!(rt=nt.n()).done;)it()}catch(t){nt.e(t)}finally{nt.f()}u.select("g.dot").empty()&&u.append("g").attr("class","dot").attr("display","none").attr("fill","currentColor").append("circle").attr("r",2.5);this._dot=u.select("g.dot")},_onPointerEntered:function(t){var e=this;this._loaded&&(this.__P_77_1=setTimeout((function(){e.__P_77_11(!0,t);e.__P_77_1=null}),500))},_onPointerLeft:function(t){this.__P_77_1&&clearTimeout(this.__P_77_1);this._loaded&&t.relatedTarget!==this._tooltip&&this.__P_77_11(!1)},__P_77_11:function(t,e){this.__P_77_2=t;if(t){if(this._dot){this._dot.attr("display",null);this._dot.raise()}this._tooltip.style.display="block";this._onPointerMoved(null,!0)}else{this._dot&&this._dot.attr("display","none");var r=d3.select(this._element).select("svg");r.node().value=null;r.dispatch("input",{bubbles:!0});this._tooltip.style.display="none"}},_onPointerMoved:function(t,e){if(this._loaded&&this.__P_77_2){var r=0,n=0;if(t){var i=d3.pointer(t),o=_slicedToArray(i,2);r=o[0];n=o[1]}else{if(!e)return;r=this.__P_77_8.width/2;n=this.__P_77_8.height/2}var a=this._helpers,s=a.X,c=a.Y,u=a.I,l=a.T,f=a.Z,p=a.O,h=this._chartConf,_=h.x,d=h.y,y=h.xz,m=d3.least(u,(function(t){return Math.hypot(_(s[t])-r,d(c[t])-n)})),v=this._element.offsetWidth/this.__P_77_8.width,b=this._element.offsetHeight/this.__P_77_8.height,g=y?y(f[m])+("function"==typeof y.bandwidth?y.bandwidth()/2:0):0;this._dot.attr("transform","translate(".concat(_(s[m])+g,",").concat(d(c[m]),")"));if(l){var P=t&&"mouse"===t.pointerType?16:40,C=this.__P_77_8.xFormat(new Date(s[m])),w=n*b-this._tooltip.offsetHeight;w<0?w+=P+this._tooltip.offsetHeight:w-=P;var O=r*v;O>this._element.offsetWidth/2?O-=this._tooltip.offsetWidth+P:O+=P;var S=f[m],A=this._dataSetConfigs[S]&&this._dataSetConfigs[S].title?this._dataSetConfigs[S].title+": ":"";this._tooltip.innerHTML="".concat(C,"<br/>").concat(A).concat(l[m]);this._tooltip.style.left=O+"px";this._tooltip.style.top=w+"px"}d3.select(this._element).select("svg").property("value",p[m]).dispatch("input",{bubbles:!0})}},__P_77_9:function(){if(this._navigationEnabled){var t=this.getHeader("label.title span");if(t){var e=this._titleString||"";t.textContent=(e?e+" - ":"")+this._shownDateRange()}}},_seriesToShort:function(t){switch(t){case"hour":return qx.locale.Manager.tr("Hour");case"day":return qx.locale.Manager.tr("Day");case"week":return qx.locale.Manager.tr("Week");case"month":return qx.locale.Manager.tr("Month");case"year":return qx.locale.Manager.tr("Year")}return""},_shownDateRange:function(){var t=this.getCurrentSeries(),e=this.getCurrentPeriod(),r=new Date;new qx.util.format.DateFormat;switch(t){case"hour":r.setHours(r.getHours()-e,0,0);return new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat("hmm","h:mm")).format(r);case"day":if(0===e)return qx.locale.Manager.tr("today");if(1===e)return qx.locale.Manager.tr("yesterday");r.setDate(r.getDate()-e);return new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat("MMMd","d. MMM")).format(r);case"week":r.setDate(r.getDate()-7*e);return qx.locale.Manager.trc("CW = calendar week","CW %1",this.getWeekNumber(r));case"month":r.setMonth(r.getMonth()-e);return(r.getFullYear()===(new Date).getFullYear()?new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat("MMM","MMM")):new qx.util.format.DateFormat(qx.locale.Date.getDateTimeFormat("yyMMM","MMM yy"))).format(r);case"year":return r.getFullYear()-e}return""},getWeekNumber:function(t){(t=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+1)/7)},__P_77_10:function(t,e){t.startsWith("var(")&&(t=getComputedStyle(document.documentElement).getPropertyValue(t.substring(4,t.length-1)));return t.startsWith("rgb(")?"rgba("+t.substring(4,t.length-1)+", "+(parseInt(e,16)/255).toFixed(2)+")":t.startsWith("#")&&7===t.length?t+e:t}},destruct:function(){this._chartConf=null;this._helpers=null},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"chart",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Chart.$$dbClassInfo=e}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MResize":{require:!0},"cv.parser.pure.widgets.ColorChooser":{},"cv.ui.structure.pure.ColorChooser":{},"qx.event.Timer":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Color",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MResize,properties:{throttleInterval:{check:"Number",init:250,apply:"_applyThrottleInterval"}},statics:{CC_COUNTER:0},members:{__P_78_0:null,_init:function(){var t=this,e=this._element;e.hasAttribute("throttle-interval")&&this.setThrottleInterval(parseInt(e.getAttribute("throttle-interval")));if("popup"===(e.hasAttribute("mode")?e.getAttribute("mode"):"popup")){var r=e.querySelector(":scope > cv-popup");if(!r){(r=document.createElement("cv-popup")).setAttribute("modal","true");e.hasAttribute("title")&&r.setAttribute("title",e.getAttribute("title"));var n,i={},o=_createForOfIteratorHelper(e.querySelectorAll(":scope > cv-address"));try{for(o.s();!(n=o.n()).done;){var a=n.value,s=a.textContent,c=a.getAttribute("transform"),u=3;switch(a.getAttribute("mode")){case"disable":u=0;break;case"read":u=1;break;case"write":u=2;break;case"readwrite":u=3}var l=cv.parser.pure.widgets.ColorChooser.makeAddressListFn(s,c,u,a.getAttribute("variant"));i[s.trim()]={transform:c,mode:u,variantInfo:l[1]}}}catch(t){o.e(t)}finally{o.f()}cv.ui.structure.tile.components.Color.CC_COUNTER++;var f="id_0_"+cv.ui.structure.tile.components.Color.CC_COUNTER,p={path:f,$$type:"colorchooser",classes:"widget colorchooser",layout:{colspan:1},controls:e.hasAttribute("controls")?e.getAttribute("controls"):"triangle",address:i,throttleInterval:this.getThrottleInterval()};cv.parser.pure.widgets.ColorChooser.parseAttributes(e,p);this.__P_78_0=new cv.ui.structure.pure.ColorChooser(p);this.__P_78_0.addListener("colorChanged",this._onColorChanged,this);this._onColorChanged();r.innerHTML='<div class="widget_container" style="margin-top: 24px; max-width: 100vw; width: 320px; max-height: 100vh; min-height: 320px; align-self: center" id="'.concat(f,'" data-type="colorchooser">').concat(this.__P_78_0.getDomString(),"</div>");e.appendChild(r);e.addEventListener("click",(function(t){var e=t.path||t.composedPath&&t.composedPath();e&&e.indexOf(r)<0&&r.getInstance().open()}));qx.event.Timer.once((function(){t.__P_78_0._onDomReady()}),this,0);this.setResizeTarget(r);this.addListener("resized",(function(){t.__P_78_0.invalidateScreensize()}))}}},_onColorChanged:function(){var t=this.__P_78_0.getColor(),e=t.getComponent("rgb"),r=t.getComponent("v");this.setValue("#".concat(this.__P_78_1(e.r)).concat(this.__P_78_1(e.g)).concat(this.__P_78_1(e.b)).concat(this.__P_78_1(r)))},__P_78_1:function(t){return Math.round(255*t).toString(16).padStart(2,"0")},_updateValue:function(t,e){var r=this._element.querySelector(":scope > .value"),n=t.substring(0,7);if(r){var i=r.tagName.toLowerCase(),o=9===t.length?parseInt(t.substring(7,9),16)/255:1;if("cv-icon"===i){r.style.color=n;r.style.opacity=Math.max(o,.2)}}else this._element.style.backgroundColor=t}},destruct:function(){this._disposeObjects("__P_78_0")},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"color",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Color.$$dbClassInfo=t}();function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"qx.module.util.Function":{construct:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.components.svg.MSvgGrid",{construct:function(){this._cells={};this._isLayoutValid=!0;this.debouncedLayoutAll=qx.module.util.Function.debounce(this._layoutAll.bind(this),100)},properties:{rows:{check:"Number",init:3,event:"changeRows",apply:"_invalidateLayout",transform:"__P_90_0"},columns:{check:"Number",init:3,event:"changeColumns",apply:"_invalidateLayout",transform:"__P_90_0"},outerPadding:{check:"Number",event:"changeOuterPadding",init:4,apply:"_invalidateLayout",transform:"__P_90_0"},spacing:{check:"Number",init:8,event:"changeSpacing",apply:"_invalidateLayout",transform:"__P_90_0"},cellWidth:{check:"Number",init:56,apply:"_invalidateLayout",event:"changeSize",transform:"__P_90_0"},cellHeight:{check:"Number",init:56,apply:"_invalidateLayout",event:"changeSize",transform:"__P_90_0"},viewBox:{check:"String",nullable:!0,event:"changeViewBox"}},members:{_cells:null,_isLayoutValid:null,__P_90_0:function(t){return"string"==typeof t?parseInt(t):t},_invalidateLayout:function(){this._isLayoutValid=!1;this.debouncedLayoutAll()},_layoutAll:function(){this.debug("re-layout all items");for(var t in this._cells){var e=t.split("-").map((function(t){return parseFloat(t)}));this.layout(this._cells[t],e[0],e[1],!0)}this._isLayoutValid=!0},getCells:function(){return this.getRows()*this.getColumns()},layout:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(-1===e||-1===r){var i=this.getNextFreeCell(e,r),o=_slicedToArray(i,2),a=o[0],s=o[1];if(-1===a||-1===s){this.error("no next free cell found, element could not be placed");return}e=a;r=s}var c=e+"-"+r;if(!this._cells[c]||n){for(var u=0,l=Object.keys(this._cells);u<l.length;u++){var f=l[u];f!==c&&this._cells[f]===t&&delete this._cells[f]}var p=this.getOuterPadding()+r*this.getSpacing()+r*this.getCellWidth(),h=this.getOuterPadding()+e*this.getSpacing()+e*this.getCellHeight();t.setAttribute("x","".concat(p));t.setAttribute("y","".concat(h));this._cells[c]=t}else this.error("cell ".concat(e,"/").concat(r," is not empty"))},getNextFreeCell:function(t,e){var r;if(-1===t&&-1===e)for(var n=0;n<this.getRows();n++)for(var i=0;i<this.getColumns();i++){r=n+"-"+i;if(!this._cells[r])return[n,i]}else if(-1===t)for(var o=0;o<this.getRows();o++){r=o+"-"+e;if(!this._cells[r])return[o,e]}else if(-1===e)for(var a=0;a<this.getColumns();a++){r=t+"-"+a;if(!this._cells[r])return[t,e]}else for(var s,c,u=t*this.getColumns()+e;u<this.getCells();u++){r=(s=Math.floor(u/this.getColumns()))+"-"+(c=u%this.getColumns());if(!this._cells[r])return[s,c]}return[t,e]}}});cv.ui.structure.tile.components.svg.MSvgGrid.$$dbClassInfo=t}();function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.components.svg.MSvgGrid":{require:!0},"cv.ui.structure.tile.MResize":{require:!0},"cv.ui.structure.tile.MStringTransforms":{require:!0},"cv.ui.structure.tile.MFullscreen":{require:!0},"qx.event.Registration":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Flow",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.components.svg.MSvgGrid,cv.ui.structure.tile.MResize,cv.ui.structure.tile.MStringTransforms,cv.ui.structure.tile.MFullscreen],properties:{pan:{check:"Boolean",init:!1,transform:"_stringToBool",apply:"_applyPan"},pagination:{check:["none","horizontal","vertical","both"],init:"none",apply:"_applyPagination"},centerX:{check:"Boolean",init:!1,apply:"_applyCenterX",transform:"_parseBoolean"},centerY:{check:"Boolean",init:!1,apply:"_applyCenterY",transform:"_parseBoolean"},fullscreenViewBox:{check:"String",nullable:!0,event:"changeFullscreenViewBox"}},members:{SVG:null,_dragPoint:null,_startPoint:null,_expiredTouchStart:null,_viewBoxBinding:null,_lastBBox:null,_additionalViewBoxUpdate:null,_ready:null,getSvg:function(){if(!this.SVG){this.SVG=document.createElementNS("http://www.w3.org/2000/svg","svg");this._element.appendChild(this.SVG)}return this.SVG},_init:function(){var t=this;cv.ui.structure.tile.components.Flow.superclass.prototype._init.call(this);this.getSvg();this.setResizeTarget(this._element);this._observer.observe(this.SVG);this.addListener("resized",this._updateDimensions,this);for(var e=0,r=["changeRows","changeColumns","changeOuterPadding","changeSpacing"];e<r.length;e++){var n=r[e];this.addListener(n,this._updateCellSize,this)}var i=this.getHeader("label.title"),o=this._element;if(o.hasAttribute("title")&&!i){(i=document.createElement("label")).classList.add("title");var a=document.createElement("span");i.appendChild(a);a.textContent=o.getAttribute("title");this.appendToHeader(i)}if(o.hasAttribute("allow-fullscreen")&&"true"===o.getAttribute("allow-fullscreen")){this._initFullscreenSwitch();this.addListener("changeFullscreen",(function(e){if(e.getData())!t._viewBoxBinding&&t.getFullscreenViewBox()&&(t._viewBoxBinding=t.bind("fullscreenViewBox",t,"viewBox"));else if(t._viewBoxBinding){t.removeBinding(t._viewBoxBinding);t._viewBoxBinding=null;t._element.hasAttribute("view-box")?t.setViewBox(t._element.getAttribute("view-box")):t.resetViewBox()}t._updateDimensions()}))}this.addListener("changeViewBox",this._updateViewBox,this);window.requestAnimationFrame((function(){return t._updateViewBox()}));this.getPan()&&this._applyPan(!0);this._applyPagination(this.getPagination());if(0===o.querySelectorAll(':scope > cv-power-entity:not([type="house"]), :scope > cv-svg-round-value').length){var s=o.querySelector(':scope > cv-power-entity[type="house"]');s&&s.remove()}setTimeout((function(){t._ready=!0;t._center()}),2e3)},_applyCenterX:function(t){t&&this.__P_79_0("row",this.getRows())},_applyCenterY:function(t){t&&this.__P_79_0("column",this.getColumns())},__P_79_0:function(t,e){var r=[];if(e>2)if(e%2>0)r.push(Math.floor(e/2));else{r.push(e/2-1);r.push(e/2)}for(var n=0;n<e;n++)r.includes(n)||("row"===t?this.__P_79_1(this._element.querySelectorAll(':scope > *[row="'.concat(n,'"]'))):this.__P_79_2(this._element.querySelectorAll(':scope > *[column="'.concat(n,'"]'))))},__P_79_1:function(t){if(1===t.length)t[0].setAttribute("column","1");else if(2===t.length){var e=Array.from(t);e.sort((function(t,e){return parseFloat(t.getAttribute("column"))-parseFloat(e.getAttribute("column"))}));e[0].setAttribute("column","0.5");e[1].setAttribute("column","1.5")}},__P_79_2:function(t){if(1===t.length)t[0].setAttribute("row","1");else if(2===t.length){var e=Array.from(t);e.sort((function(t,e){return parseFloat(t.getAttribute("row"))-parseFloat(e.getAttribute("row"))}));e[0].setAttribute("row","0.5");e[1].setAttribute("row","1.5")}},_drag:function(t){t.preventDefault();t.stopImmediatePropagation();var e=this.SVG.getScreenCTM().inverse();this._dragPoint.x=t.clientX;this._dragPoint.y=t.clientY;this._dragPoint=this._dragPoint.matrixTransform(e);this.SVG.viewBox.baseVal.x-=this._dragPoint.x-this._startPoint.x;this.SVG.viewBox.baseVal.y-=this._dragPoint.y-this._startPoint.y},_cancelEvent:function(t){t.preventDefault();t.stopImmediatePropagation()},_startDrag:function(t){"function"!=typeof this.drag&&(this.drag=this._drag.bind(this));this._element.addEventListener("pointermove",this.drag);this._element.addEventListener("touchmove",this._cancelEvent);var e=this.SVG.getScreenCTM().inverse();this._dragPoint.x=t.clientX;this._dragPoint.y=t.clientY;this._startPoint=this._dragPoint.matrixTransform(e)},_endDrag:function(t){this.drag&&this._element.removeEventListener("pointermove",this.drag);this._element.removeEventListener("touchmove",this._cancelEvent)},_touchStart:function(t){if(1===t.touches.length)if(this._expiredTouchStart)if(t.timeStamp<=this._expiredTouchStart){this.resetDrag();this._expiredTouchStart=null}else this._expiredTouchStart=t.timeStamp+400;else this._expiredTouchStart=t.timeStamp+400;t.preventDefault()},_applyPan:function(t){if(this.SVG)if(t){this._dragPoint=this.SVG.createSVGPoint();"function"!=typeof this.startDrag&&(this.startDrag=this._startDrag.bind(this));"function"!=typeof this.endDrag&&(this.endDrag=this._endDrag.bind(this));"function"!=typeof this.resetDrag&&(this.resetDrag=this._updateViewBox.bind(this));"function"!=typeof this.touchStart&&(this.touchStart=this._touchStart.bind(this));this._element.addEventListener("pointerdown",this.startDrag);this._element.addEventListener("pointerup",this.endDrag);this._element.addEventListener("pointerleave",this.endDrag);this._element.addEventListener("pointercancel",this.endDrag);this._element.addEventListener("dblclick",this.resetDrag);this._element.addEventListener("touchstart",this.touchStart)}else{this._element.removeEventListener("pointerdown",this.startDrag);this._element.removeEventListener("pointerup",this.endDrag);this._element.removeEventListener("pointerleave",this.endDrag);this._element.removeEventListener("pointercancel",this.endDrag);this._element.removeEventListener("dblclick",this.resetDrag);this._element.removeEventListener("touchstart",this.touchStart)}},_applyPagination:function(t){var e="both"===t||"vertical"===t,r=[],n=[];if("both"===t||"horizontal"===t){r.push("left");r.push("right")}else{n.push("left");n.push("right")}if(e){r.push("top");r.push("bottom")}else{n.push("top");n.push("bottom")}for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this._element.querySelector("div.pagination.".concat(a));if(!s){(s=document.createElement("div")).classList.add("pagination",a);this._element.appendChild(s)}}for(var c=0,u=n;c<u.length;c++){var l=u[c],f=this._element.querySelector("div.pagination.".concat(l));f&&f.remove()}this._updatePaginationButtons()},_enablePaginationButton:function(t,e,r){var n;switch(e){case"left":n=this._paginateLeft;break;case"right":n=this._paginateRight;break;case"top":n=this._paginateTop;break;case"bottom":n=this._paginateBottom}if(r){t.classList.add("clickable");qx.event.Registration.addListener(t,"tap",n,this)}else{t.classList.contains("clickable")&&t.classList.remove("clickable");qx.event.Registration.removeListener(t,"tap",n,this)}},_updatePaginationButtons:function(){for(var t=this.getViewBox().split(" ").map((function(t){return parseInt(t)})),e=_slicedToArray(t,4),r=e[0],n=e[1],i=e[2],o=e[3],a=0,s=["top","bottom","left","right"];a<s.length;a++){var c=s[a],u=this._element.querySelector("div.pagination.".concat(c));if(u)switch(c){case"left":this._enablePaginationButton(u,c,r-i>=0);break;case"right":this._enablePaginationButton(u,c,r+i<this.getColumns());break;case"top":this._enablePaginationButton(u,c,n-o>=0);break;case"bottom":this._enablePaginationButton(u,c,n+o<this.getRows())}}},_paginateLeft:function(){this._paginate("left")},_paginateRight:function(){this._paginate("right")},_paginateTop:function(){this._paginate("top")},_paginateBottom:function(){this._paginate("bottom")},_paginate:function(t){var e=this.getViewBox().split(" ").map((function(t){return parseInt(t)})),r=_slicedToArray(e,4),n=r[0],i=r[1],o=r[2],a=r[3];switch(t){case"left":n-o>=0&&(n-=o);break;case"right":n+o<this.getColumns()&&(n+=o);break;case"top":i-a>=0&&(i-=a);break;case"bottom":i+a<this.getRows()&&(i+=a)}this._element.setAttribute("view-box","".concat(n," ").concat(i," ").concat(o," ").concat(a))},_updateDimensions:function(t){var e=this;if(t){var r=t.getData();if(r.contentBoxSize&&r.target instanceof SVGElement){this._center(r.contentRect.width,r.contentRect.height);return}}if(this.isFullscreen()){var n=Math.min(screen.availHeight,screen.availWidth);if(n>600){this.setOuterPadding(16);this.setSpacing(32)}else if(n>=400){this.setOuterPadding(16);this.setSpacing(26)}var i=0;if(screen.availHeight>screen.availWidth){var o=this.SVG.getBBox();i=Math.min(screen.availHeight,Math.max(o.height,100*this.getRows()))}else i=screen.availHeight;this._tileElement&&(this._tileElement.style.height="".concat(i,"px"))}else{this._tileElement&&(this._tileElement.style.height="unset");this._element.hasAttribute("outer-padding")?this.setOuterPadding(this._element.getAttribute("outer-padding")):this.resetOuterPadding();this._element.hasAttribute("spacing")?this.setSpacing(this._element.getAttribute("spacing")):this.resetSpacing()}window.requestAnimationFrame((function(){return e._updateCellSize()}))},_updateViewBox:function(){var t=this,e=this.getViewBox();if(e){var r=e.split(" ").map((function(t){return parseInt(t)}));if(4===r.length){this._updatePaginationButtons();var n=2*this.getOuterPadding(),i=this.getCellWidth()*r[0]+(r[0]>1?(r[0]-1)*this.getSpacing():0),o=this.getCellHeight()*r[1]+(r[1]>1?(r[1]-1)*this.getSpacing():0),a=n+this.getCellWidth()*r[2]+(r[2]>1?(r[2]-1)*this.getSpacing():0),s=n+this.getCellHeight()*r[3]+(r[3]>1?(r[3]-1)*this.getSpacing():0);if(this._ready&&"object"===_typeof(window.d3)){d3.select(this._element).select("svg").transition().duration(500).attr("viewBox","".concat(i," ").concat(o," ").concat(a," ").concat(s));setTimeout((function(){return t._center()}),510)}else{this.SVG.setAttribute("viewBox","".concat(i," ").concat(o," ").concat(a," ").concat(s));setTimeout((function(){return t._center()}),10)}}}else this.SVG.removeAttribute("viewBox")},_center:function(t,e){var r=this;if(this.SVG&&this._ready){var n=this.SVG.getBBox();if(this._lastBBox&&this._lastBBox.width===n.width&&this._lastBBox.height===n.height)return;if(!t||!e){var i=this.SVG.hasAttribute("viewBox")?this.SVG.getAttribute("viewBox").split(" ").map((function(t){return parseInt(t)})):[];if(4!==i.length)return;t=i[2];e=i[3]}var o=2*this.getOuterPadding(),a=this.getColumns(),s=this.getRows(),c=this.getViewBox(),u=0,l=2,f=0,p=2;if(c){var h=c.split(" ").map((function(t){return parseInt(t)}));a=h[2]-h[0];s=h[3]-h[1];l=(u=h[0])+h[2]-1;p=(f=h[1])+h[3]-1}var _,d,y,m=3,v=3,b=_createForOfIteratorHelper(this._element.querySelectorAll("*[column]"));try{for(b.s();!(y=b.n()).done;){var g=y.value;u<=(_=parseInt(g.getAttribute("column"))+1)&&l>_&&_>m&&(m=_)}}catch(t){b.e(t)}finally{b.f()}var P,C=_createForOfIteratorHelper(this._element.querySelectorAll("*[row]"));try{for(C.s();!(P=C.n()).done;){var w=P.value;d=parseInt(w.getAttribute("row"))+1;f<=_&&p>d&&d>v&&(v=d)}}catch(t){C.e(t)}finally{C.f()}var O=m>a?a/this.getColumns():1,S=v>s?s/this.getRows():1,A=e-o-n.height*S,x=t-o-n.width*O;A>0||x>0?this.SVG.setAttribute("transform","translate(".concat(Math.max(0,x/2),", ").concat(Math.max(0,A/2),")")):this.SVG.removeAttribute("transform");this._lastBBox=n;window.requestAnimationFrame((function(){return r._center()}))}},_updateCellSize:function(){var t=this;if(0!==this._element.clientWidth&&0!==this._element.clientHeight){var e=this.getColumns(),r=this.getRows(),n=this.getViewBox();if(n){var i=n.split(" ").map((function(t){return parseInt(t)}));e=i[2];r=i[3]}var o=2*this.getOuterPadding(),a=this.getSpacing()/2,s=Math.floor((this._element.clientWidth-o)/e-a),c=Math.floor((this._element.clientHeight-o)/r-a);this.debug("cellWidth",s,"cellHeight",c);var u=this.getCellWidth()!==s||this.getCellHeight()!==c;this.setCellWidth(s);this.setCellHeight(c);u&&window.requestAnimationFrame((function(){t._updateViewBox()}))}},_stringToBool:function(t){return"string"==typeof t?"true"===t:null!=t&&t}},defer:function(t){var e;customElements.define(cv.ui.structure.tile.Controller.PREFIX+"flow",(e=function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector),_defineProperty(e,"observedAttributes",["view-box","fullscreen-view-box","pan","rows","columns","cell-width","cell-height","outer-padding","spacing","pagination","center-x","center-y"]),e))}});cv.ui.structure.tile.components.Flow.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{construct:!0,require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Icon",{extend:cv.ui.structure.tile.components.AbstractComponent,construct:function(t){cv.ui.structure.tile.components.AbstractComponent.constructor.call(this,t);this._idRegex=/^[^\s]+$/},properties:{id:{check:"String",nullable:!0,apply:"_applyId",transform:"_transformId"},color:{check:"String",nullable:!0,apply:"_applyColor"}},members:{__P_80_0:!1,_idRegex:null,_transformId:function(t){if(this._idRegex.test(t))return t;this.error("invalid icon id:",t);return null},_init:function(){cv.ui.structure.tile.components.Icon.superclass.prototype._init.call(this);var t=this._element;if(t.textContent.trim()){this.__P_80_0=!0;this.setId(t.textContent.trim())}else{var e,r=t.classList.values(),n=_createForOfIteratorHelper(r);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.startsWith("ri-")||i.startsWith("knxuf-")){this.setId(i);break}}}catch(t){n.e(t)}finally{n.f()}}this.__P_80_0=!0},_applyId:function(t,e){var r=this._element;if(this.__P_80_0){e&&r.classList.remove(e);if(t){r.classList.add(t);r.textContent&&(r.textContent="")}}},_applyColor:function(t,e){var r=this._element;e&&r.classList.remove(e);t&&(t.startsWith("#")||t.startsWith("rgb")?r.style.color=t:r.classList.add(t))}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"icon",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r,null,[{key:"observedAttributes",get:function(){return["color"]}}])}(QxConnector))}});cv.ui.structure.tile.components.Icon.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MRefresh":{require:!0},"cv.io.rest.Client":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Image",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MRefresh],members:{_downloadedImage:null,_url:null,_headers:null,_request:null,_init:function(){var t=this,e=this._element,r=e.querySelector(":scope > img");if(!r){r=document.createElement("img");e.appendChild(r)}e.addEventListener("click",(function(){return t.refresh()}));var n=e.getAttribute("src"),i=window.location.origin;"/"!==n.substring(0,1)&&"http"!==n.substring(0,4)&&(i+=window.location.pathname);this._url=new URL(n,i);var o=e.hasAttribute("proxy")&&"true"===e.getAttribute("proxy");if(o){this._url=new URL(cv.io.rest.Client.getBaseUrl()+"/proxy",window.location.origin);this._url.searchParams.set("url",e.getAttribute("src"))}this._headers={};if(e.hasAttribute("auth-type"))if(o)this._url.searchParams.set("auth-type",e.getAttribute("auth-type").toLowerCase());else switch(e.getAttribute("auth-type").toLowerCase()){case"basic":this._headers.Authorization="Basic "+window.btoa(e.getAttribute("username")+":"+e.getAttribute("password"));break;case"bearer":this._headers.Authorization="Bearer "+e.getAttribute("username");break;default:this.error("unknown authorization type"+e.getAttribute("auth-type"))}this._loadImage();e.hasAttribute("refresh")&&this.setRefresh(parseInt(e.getAttribute("refresh")))},_loadImage:function(){var t=this,e=this._element.querySelector(":scope > img");if(Object.keys(this._headers).length>0){var r=new XMLHttpRequest;r.responseType="blob";r.open("get",this._url.toString(),!0);Object.keys(this._headers).forEach((function(e){r.setRequestHeader(e,t._headers[e])}));r.onreadystatechange=function(t){if(r.readyState===XMLHttpRequest.DONE&&200===r.status){e.src=URL.createObjectURL(r.response);e.onload=function(){URL.revokeObjectURL(e.src)}}};r.send(null)}else e.src=this._url.toString()},refresh:function(){if(this._element.querySelector(":scope > img")){this._url.searchParams.set("r",""+Math.random());this._loadImage()}},onStateUpdate:function(t){cv.ui.structure.tile.components.Image.superclass.prototype.onStateUpdate.call(this,t)||("refresh"===t.detail.target?t.detail.state&&this.refresh():this.debug("unhandled address target",t.detail.target))}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"image",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Image.$$dbClassInfo=t}();function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:A(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",_="executing",d="completed",y={};function m(){}function v(){}function b(){}var g={};u(g,a,(function(){return this}));var P=Object.getPrototypeOf,C=P&&P(P(q([])));C&&C!==r&&n.call(C,a)&&(g=C);var w=b.prototype=m.prototype=Object.create(g);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,r,n){var i=p;return function(o,a){if(i===_)throw Error("Generator is already running");if(i===d){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=_;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?d:h,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=d,n.method="throw",n.arg=u.arg)}}}function x(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function q(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(_typeof(e)+" is not iterable")}return v.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},O(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new S(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(w),u(w,c,"Generator"),u(w,a,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=q,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:q(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){asyncGeneratorStep(o,n,i,a,s,"next",t)}function s(t){asyncGeneratorStep(o,n,i,a,s,"throw",t)}a(void 0)}))}}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MRefresh":{require:!0},"cv.ui.structure.tile.MFullscreen":{require:!0},"cv.io.Fetch":{},"cv.io.listmodel.Registry":{},"qx.data.Array":{},"qx.util.format.DateFormat":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.List",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MRefresh,cv.ui.structure.tile.MFullscreen],properties:{value:{refine:!0,init:[]}},members:{_target:null,_timer:null,_model:null,_getModel:null,_filterModel:null,_sortModel:null,_limit:null,_modelInstance:null,_init:function(){var t=this;this._checkEnvironment();var e=this._element;this._model=[];var r=!1,n=e.querySelector("model");e.parentElement&&e.parentElement.classList.add("has-list");if(n){n.hasAttribute("filter")&&(this._filterModel=new Function("item","index",'"use strict"; return '+n.getAttribute("filter")));n.hasAttribute("limit")&&(this._limit=parseInt(n.getAttribute("limit")));var i,o=n.querySelectorAll(':scope > cv-address:not([mode="write"])'),a=_createForOfIteratorHelper(e.querySelectorAll(":scope > cv-address"));try{for(a.s();!(i=a.n()).done;){if("read"!==i.value.getAttribute("mode")){e.addEventListener("sendState",(function(t){var r,n=new CustomEvent("sendState",{bubbles:t.bubbles,cancelable:t.cancelable,detail:t.detail}),i=_createForOfIteratorHelper(e.querySelectorAll(":scope > cv-address"));try{for(i.s();!(r=i.n()).done;){r.value.dispatchEvent(n)}}catch(t){i.e(t)}finally{i.f()}}));break}}}catch(t){a.e(t)}finally{a.f()}if(n.hasAttribute("sort-by")){var s=n.getAttribute("sort-by"),c="desc"===n.getAttribute("sort-mode")?-1:1;this._sortModel=function(t,e){var r=t[s],n=e[s];if(r===n)return 0;if(_typeof(r)===_typeof(n))switch(_typeof(r)){case"number":return(r-n)*c;case"boolean":return(r?-1:1)*c;case"string":return r.localeCompare(n)*c;default:return JSON.stringify(r).localeCompare(JSON.stringify(n))*c}else{if(null==r)return 1*c;if(null==n)return-1*c}return 0}}if(n.hasAttribute("src")||n.hasAttribute("config-section"))this._getModel=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var r,i,o,a,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={ttl:t.getRefresh()};for(i=0,o=["self-signed","config-section","auth-type"];i<o.length;i++){a=o[i];n.hasAttribute(a)&&(r[a]=n.getAttribute(a))}e.next=4;return cv.io.Fetch.cachedFetch(n.getAttribute("src"),r,"true"===n.getAttribute("proxy"));case 4:s=e.sent;return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));else if(n.hasAttribute("class")){var u=cv.io.listmodel.Registry.get(n.getAttribute("class"));if(u){var l=this._modelInstance=new u;l.addListener("refresh",(function(){return t.refresh()}));if(n.hasAttribute("parameters")){var f,p={},h=_createForOfIteratorHelper(n.getAttribute("parameters").split(","));try{for(h.s();!(f=h.n()).done;){var _=f.value.split("=").map((function(t){return t.trim()})),d=_slicedToArray(_,2),y=d[0],m=d[1];p[y]=m.startsWith("'")?m.substring(1,m.length-1):m}}catch(t){h.e(t)}finally{h.f()}l.set(p)}this._getModel=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.next=2;return l.refresh();case 2:return t.abrupt("return",l.getModel());case 3:case"end":return t.stop()}}),t)})))}else this.error('clazz "cv.io.listmodel.'.concat(n.getAttribute("class"),'" not found'))}else{var v=n.querySelector(":scope > script"),b=n.querySelectorAll(":scope > cv-data");if(v){this._getModel=new Function('"use strict";let model = []; '+v.innerText.trim()+"; return model");this._model=this._getModel()}else if(o.length>0){this._getModel=this.getValue;r=!0}else{if(!(b.length>0)){this.error("cv-list > model must have at least one read address, src-attribute, cv-data child or a script that fills the model.");return}this._model=[];this._getModel=function(){return t._model};b.forEach((function(e,r){var n,i={index:r},o=_createForOfIteratorHelper(e.attributes);try{for(o.s();!(n=o.n()).done;){var a=n.value;i[a.name]=a.value}}catch(t){o.e(t)}finally{o.f()}t._model.push(i)}))}}o.length>0&&e.addEventListener("stateUpdate",(function(e){return t.onStateUpdate(e)}));if(!r){this.isVisible()&&this.refresh();e.hasAttribute("refresh")&&this.setRefresh(parseInt(e.getAttribute("refresh")))}this._element.addEventListener("click",(function(e){var r=e.target,n={},i=function(t){if(t)for(var e=0;e<t.attributes.length;e++){var r=t.attributes[e];r.name.startsWith("data-")&&(n[r.name.substring(5)]=r.value)}};i(r);for(var o=0,a=r.$$model;r&&(!a||!n.action)&&o<=5&&(r=r.parentElement)!==t._element;){if(r){!a&&r.$$model&&(a=r.$$model);!n.action&&r.hasAttribute("data-action")&&i(r)}o++}n.action&&t._modelInstance&&t._modelInstance.handleEvent(e,n,a)&&e.stopPropagation()}));e.hasAttribute("allow-fullscreen")&&"true"===e.getAttribute("allow-fullscreen")&&this._initFullscreenSwitch()}else this.error("cv-list needs a model")},onStateUpdate:function(t){"refresh"===t.detail.target?this.isVisible()?this.refresh():this._lastRefresh=null:cv.ui.structure.tile.components.List.superclass.prototype.onStateUpdate.call(this,t);t.stopPropagation()},_applyValue:function(){this._lastRefresh=0;this.refresh()},refresh:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){var r,n,i,o,a,s,c,u,l,f,p,h,_;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t._element;n=r.querySelector(":scope > template:not([when])");i=[];"function"==typeof t._getModel&&(i=t._getModel());if(!(i instanceof Promise)){e.next=14;break}e.prev=5;e.next=8;return i;case 8:i=e.sent;e.next=14;break;case 11:e.prev=11;e.t0=e.catch(5);t.error("error refreshing async model:",e.t0);case 14:o=r.querySelector(":scope > ul");if("false"!==n.getAttribute("wrap")){e.next=19;break}o=r;e.next=30;break;case 19:if(!n.hasAttribute("target")){e.next=29;break}e.t1=n.getAttribute("target");e.next="parent"===e.t1?23:26;break;case 23:o=r.parentElement;r.style.display="none";return e.abrupt("break",27);case 26:throw new Error("invalid target: "+n.getAttribute("target"));case 27:e.next=30;break;case 29:if(!o){(o=document.createElement("ul")).classList.add("content");r.appendChild(o)}case 30:t.debug("refreshing with new model length",i.length);if(!(Array.isArray(i)||i instanceof qx.data.Array)){e.next=55;break}"function"==typeof t._filterModel&&(i=i.filter(t._filterModel));"function"==typeof t._sortModel&&i.sort(t._sortModel);t._limit&&(i=i.slice(0,t._limit));if(0!==i.length){e.next=45;break}a=r.querySelector(':scope > template[when="empty"]');for(;o.firstElementChild&&o.firstElementChild.hasAttribute("data-row");)o.removeChild(o.firstElementChild);if(!a||o.querySelector(":scope > .empty-model")){e.next=43;break}(s=a.content.firstElementChild.cloneNode(!0)).classList.add("empty-model");o.appendChild(s);return e.abrupt("return");case 43:e.next=48;break;case 45:(c=o.querySelector(":scope > .empty-model"))&&c.remove();for(l=o.children.length-1;l>=0;l--)(u=o.children[l]).hasAttribute("data-row")&&parseInt(u.getAttribute("data-row"))>=i.length&&o.removeChild(u);case 48:f=document.createElement("template");for(p=i.length;p<t._model.length;p++)(h=o.querySelector(':scope > [data-row="'.concat(p,'"]')))&&h.remove();_=function(e,r){var n=-1;if(e.endsWith("]")){n=parseInt(e.substring(e.indexOf("[")+1,e.length-1));if(isNaN(n)){t.error("error parsing array index from "+e,e.substring(e.indexOf("[")+1,e.length-1));return""}e=e.substring(0,e.indexOf("["))}if(Object.prototype.hasOwnProperty.call(r,e)){var i=r[e];return n>=0&&Array.isArray(i)?i[n]:i}return""};i.forEach((function(e,r){var i=o.querySelector(':scope > [data-row="'.concat(r,'"]')),a=n.innerHTML.replaceAll(/\${([^}]+)}/g,(function(t,n){if("index"===n)return""+r;if(n.includes("||")){var i,o="",a=_createForOfIteratorHelper(n.split("||").map((function(t){return t.trim()})));try{for(a.s();!(i=a.n()).done;){var s=i.value;if(o=_(s,e))return o}}catch(t){a.e(t)}finally{a.f()}}else if(n.includes("|")){var c=n.split("|"),u=_slicedToArray(c,2),l=u[0],f=u[1],p=_(l,e);if(p instanceof Date){return new qx.util.format.DateFormat(f).format(p)}if(p)return p}else if(n.includes(".")){var h=n.split(".",1),d=_slicedToArray(h,1)[0],y=n.substring(d.length+1),m=_(d,e);if(m instanceof Object)try{return new Function("obj","return obj.".concat(y,";"))(m)}catch(t){}}return _(n,e)}));f.innerHTML=a;f.content.firstElementChild.querySelectorAll("[when]").forEach((function(t){var e=t.getAttribute("when").split("=").map((function(t){return t.trim()})),r=_slicedToArray(e,2);r[0]!=r[1]?t.parentElement.removeChild(t):t.removeAttribute("when")}));if(i){i.innerHTML=f.content.firstElementChild.innerHTML;i.setAttribute("data-row",""+r);t._initElement(i,e)}else{f.content.firstElementChild.setAttribute("data-row",""+r);i=f.content.cloneNode(!0);t._initElement(i.firstElementChild,e);o.appendChild(i)}}));t._model=i;e.next=56;break;case 55:t.error("model must be an array",i);case 56:case"end":return e.stop()}}),e,null,[[5,11]])})))()},_initElement:function(t,e){t.$$model=e}},destruct:function(){this._disposeObjects("_modelInstance","_timer");this._model=null;this._filterModel=null;this._sortModel=null;this._target=null},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"list",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.List.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.ListItem",{extend:cv.ui.structure.tile.components.AbstractComponent,members:{_init:function(){var t=this;cv.ui.structure.tile.components.ListItem.superclass.prototype._init.call(this);this._element.fireEvent=function(e,r){var n=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:{value:r,source:t}});t._element.dispatchEvent(n)}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"listitem",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.ListItem.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"qx.event.message.Bus":{},"qx.event.Registration":{},"qx.event.Timer":{},"cv.Application":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Menu",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{model:{check:["pages","menuItems"],apply:"_applyModel"},appearance:{check:["text","icons","dock"],init:"text",apply:"_applyAppearance"},depth:{check:"!isNaN(value) && value >= -1 && value <= 100",init:-1,apply:"_applyDepth"},domReady:{check:"Boolean",init:!1,apply:"_generateMenu"},showLabels:{check:"Boolean",init:!0}},members:{_applyAppearance:function(t,e){var r=document.querySelector("main");"dock"===e&&r.classList.remove("has-dock");"dock"===t&&r.classList.add("has-dock")},_applyDepth:function(){this.isDomReady()&&this._generateMenu()},_onDomAppended:function(){this.setDomReady(!0);qx.event.message.Bus.unsubscribe("setup.dom.append",this._onDomAppended,this)},_applyModel:function(t){var e=this;if(t){var r=document.createElement("ul");this._element.appendChild(r);if("pages"===t){var n=document.createElement("a");n.href="#";n.classList.add("menu");n.onclick=function(t){return e._onHamburgerMenu(t)};var i=document.createElement("i");n.appendChild(i);this._element.appendChild(n);qx.event.message.Bus.subscribe("setup.dom.append",this._onDomAppended,this);qx.event.message.Bus.subscribe("cv.ui.structure.tile.currentPage",this._onPageChange,this);qx.event.Registration.addListener(this._element,"swipe",this._onSwipe,this);i.classList.add("ri-menu-line")}else if("menuItems"===t){var o=document.createElement("i");o.classList.add("ri-more-2-fill");this._element.appendChild(o);this._element.onclick=function(t){return e._onHamburgerMenu(t)};r.classList.add("context-menu");this._generateMenu()}}else this.error("visual-model of type",t,"is not implemented")},_init:function(){var t=this._element,e=t.hasAttribute("model")?t.getAttribute("model"):t.querySelectorAll(":scope > cv-menu-item").length>0?"menuItems":null;if(e){"false"===t.getAttribute("show-labels")&&this.setShowLabels(!1);this.setModel(e)}else this.error("no model defined, menu will be empty")},_generateMenu:function(){var t=this;switch(this.getModel()){case"pages":var e=window.location.hash.substring(1),r=document.querySelector("main");if(r){var n=document.querySelector("cv-page");n&&(r=n.parentElement)}var i=this._element.querySelector(":scope > ul");if(i){i.replaceChildren();this.__P_81_0(i,r,e,0)}break;case"menuItems":var o=this._element.querySelector(":scope > ul");if(o){o.replaceChildren();var a,s=_createForOfIteratorHelper(this._element.querySelectorAll(":scope > cv-menu-item"));try{var c=function(){var e=a.value,r=e.getAttribute("name")||"",n=e.getAttribute("icon")||"",i=document.createElement("li");if(n){var s=document.createElement("i");s.classList.add(n);s.title=r;i.appendChild(s)}if(t.isShowLabels()){var c=document.createTextNode(r);i.appendChild(c)}i.addEventListener("click",(function(t){e.getInstance().onClick(t)}));o.appendChild(i)};for(s.s();!(a=s.n()).done;)c()}catch(t){s.e(t)}finally{s.f()}}}},_onHamburgerMenu:function(t){var e="open";if("pages"===this.getModel()){e="responsive";var r,n=_createForOfIteratorHelper(this._element.querySelectorAll(".details"));try{for(n.s();!(r=n.n()).done;){r.value.setAttribute("open","")}}catch(t){n.e(t)}finally{n.f()}}this._element.classList.toggle(e);t.stopPropagation();if(this._element.classList.contains(e)){qx.event.Registration.addListener(document,"pointerdown",this._onPointerDown,this);qx.event.Registration.addListener(document.body.querySelector(":scope > main"),"scroll",this._closeAll,this)}},_onPointerDown:function(t){var e=t.getTarget();e.classList.contains("menu")||e.parentElement&&e.parentElement.classList.contains("menu")||"cv-menu"===e.nodeName.toLowerCase()||e.parentElement&&"cv-menu"===e.parentElement.nodeName.toLowerCase()||(".summary"!==e.tagName.toLowerCase()&&"p"!==e.tagName.toLowerCase()?qx.event.Timer.once(this._closeAll,this,500):this._closeAll(t.getTarget().parentElement))},_onSwipe:function(t){if("left"===t.getDirection()){var e=this._element.querySelector("li.active + li > a");e&&e.click()}else{var r=this._element.querySelector("li.active");if(r&&r.previousElementSibling&&"li"===r.previousElementSibling.tagName.toLowerCase()){var n=r.previousElementSibling.querySelector(":scope > a");n&&n.click()}}},_closeAll:function(t){if(this._element.classList.contains("open"))this._element.classList.remove("open");else if(this._element.classList.contains("responsive"))this._element.classList.remove("responsive");else{var e,r=_createForOfIteratorHelper(this._element.querySelectorAll(".details[open]"));try{for(r.s();!(e=r.n()).done;){var n=e.value;t&&n===t||n.removeAttribute("open")}}catch(t){r.e(t)}finally{r.f()}}if(0===this._element.querySelectorAll(".details[open]").length){qx.event.Registration.removeListener(document,"pointerdown",this._onPointerDown,this);qx.event.Registration.removeListener(document.body.querySelector(":scope > main"),"scroll",this._closeAll,this)}},_openDetail:function(t){var e=0===this._element.querySelectorAll(".details[open]").length;t.setAttribute("open","");if(e){qx.event.Registration.addListener(document,"pointerdown",this._onPointerDown,this);qx.event.Registration.addListener(document.body.querySelector(":scope > main"),"scroll",this._closeAll,this)}},_closeDetail:function(t){t.removeAttribute("open");if(0===this._element.querySelectorAll(".details[open]").length){qx.event.Registration.removeListener(document,"pointerdown",this._onPointerDown,this);qx.event.Registration.removeListener(document.body.querySelector(":scope > main"),"scroll",this._closeAll,this)}},__P_81_0:function(t,e,r,n){var i=this;if(e){var o,a=e.querySelectorAll(':scope > cv-page:not([menu="false"])'),s=_createForOfIteratorHelper(a.values());try{var c=function(){var e=o.value,a=e.getAttribute("id");if(!a){i.error("page has no id, skipping");return 1}var s=e.getAttribute("name")||"",c=e.getAttribute("icon")||"",u=document.createElement("li"),l=document.createElement("a");l.setAttribute("href","#"+a);l.setAttribute("data-page-id",a);if(c){var f=document.createElement("i");f.classList.add(c);f.title=s;l.appendChild(f)}if(i.isShowLabels()||n>0){var p=document.createTextNode(s);l.appendChild(p)}r===a&&u.classList.add("active");t.appendChild(u);var h=i.getDepth();if((h<0||h>n)&&e.querySelectorAll(':scope > cv-page:not([menu="false"])').length>0){var _=document.createElement("div");_.classList.add("details");var d=document.createElement("div");d.classList.add("summary");l.setAttribute("href","#");l.addEventListener("click",(function(t){cv.Application.structureController.scrollToPage(a);t.stopPropagation();t.preventDefault()}));var y=e.getAttribute("icon")||"";if(e.querySelector(":scope > *:not(cv-page)"))d.appendChild(l);else{var m=document.createElement("p");if(y){var v=document.createElement("i");v.classList.add(y);v.title=s;m.appendChild(v)}i.isShowLabels()&&m.appendChild(document.createTextNode(s));d.appendChild(m);m.addEventListener("click",(function(t){_.hasAttribute("open")?i._closeDetail(_):i._openDetail(_)}))}var b=document.createElement("i");b.classList.add("expander");b.classList.add("ri-arrow-down-s-line");d.appendChild(b);b.addEventListener("click",(function(t){_.hasAttribute("open")?i._closeDetail(_):i._openDetail(_)}));_.appendChild(d);var g=document.createElement("ul");_.appendChild(g);i.__P_81_0(g,e,r,n+1);u.appendChild(_)}else u.appendChild(l)};for(s.s();!(o=s.n()).done;)c()}catch(t){s.e(t)}finally{s.f()}}},_onPageChange:function(t){var e,r=t.getData(),n=_createForOfIteratorHelper(this._element.querySelectorAll("li.active, li.sub-active"));try{for(n.s();!(e=n.n()).done;){var i=e.value;i.classList.remove("active");i.classList.remove("sub-active")}}catch(t){n.e(t)}finally{n.f()}var o,a=_createForOfIteratorHelper(this._element.querySelectorAll('a[data-page-id="'.concat(r.id,'"]')));try{for(a.s();!(o=a.n()).done;)for(var s=o.value.parentElement,c="active";s&&"cv-menu"!==s.tagName.toLowerCase();){if("li"===s.tagName.toLowerCase()){s.classList.add(c);c="sub-active"}s=s.parentElement}}catch(t){a.e(t)}finally{a.f()}}},destruct:function(){qx.event.Registration.removeListener(document,"pointerdown",this._onPointerDown,this);qx.event.message.Bus.unsubscribe("cv.ui.structure.tile.currentPage",this._onPageChange,this)},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"menu",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r,null,[{key:"observedAttributes",get:function(){return["appearance","depth"]}}])}(QxConnector))}});cv.ui.structure.tile.components.Menu.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.elements.Address":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.MenuAction",{extend:cv.ui.structure.tile.components.AbstractComponent,members:{_currentState:null,_init:function(){var t=this;cv.ui.structure.tile.components.MenuAction.superclass.prototype._init.call(this);switch(this._element.getAttribute("action")){case"toggleState":var e,r=!1,n=_createForOfIteratorHelper(this._element.querySelectorAll(":scope > cv-address"));try{for(n.s();!(e=n.n()).done;){var i=e.value;r=!0;"write"!==i.getAttribute("mode")&&this._element.addEventListener("stateUpdate",(function(e){t.onStateUpdate(e);e.stopPropagation()}))}}catch(t){n.e(t)}finally{n.f()}r||this.error('a cv-menu-item with action "toggleState" needs at least one cv-address to read the write the state,');break;case"popup":this._element.querySelector(":scope > cv-popup")||this.error('a cv-menu-item with action "popup" must have a cv-popup as child.')}},onClick:function(t){switch(this._element.getAttribute("action")){case"popup":var e=this._element.querySelector(":scope > cv-popup");e&&e.getInstance().open();t.stopPropagation();break;case"toggleState":var r,n=new CustomEvent("sendState",{detail:{value:!this._currentState,source:this}}),i=_createForOfIteratorHelper(this._element.querySelectorAll(":scope > cv-address"));try{for(i.s();!(r=i.n()).done;){var o=r.value;"read"!==o.getAttribute("mode")&&o.dispatchEvent(n)}}catch(t){i.e(t)}finally{i.f()}t.stopPropagation()}},onStateUpdate:function(t){var e="1"==t.detail.state;if(t.detail.source instanceof cv.ui.structure.tile.elements.Address){var r=t.detail.source.getElement();r.hasAttribute("value")&&(e=t.detail.state==r.getAttribute("value"))}this._currentState=e}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"menu-item",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.MenuAction.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:A(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",_="executing",d="completed",y={};function m(){}function v(){}function b(){}var g={};u(g,a,(function(){return this}));var P=Object.getPrototypeOf,C=P&&P(P(q([])));C&&C!==r&&n.call(C,a)&&(g=C);var w=b.prototype=m.prototype=Object.create(g);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,r,n){var i=p;return function(o,a){if(i===_)throw Error("Generator is already running");if(i===d){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=_;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?d:h,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=d,n.method="throw",n.arg=u.arg)}}}function x(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function q(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(_typeof(e)+" is not iterable")}return v.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:v,configurable:!0}),v.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},O(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new S(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(w),u(w,c,"Generator"),u(w,a,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=q,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:q(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){asyncGeneratorStep(o,n,i,a,s,"next",t)}function s(t){asyncGeneratorStep(o,n,i,a,s,"throw",t)}a(void 0)}))}}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"cv.TemplateEngine":{},"cv.util.ScriptLoader":{},"qx.Part":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Plugin",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,statics:{PL_COUNTER:0},members:{__P_82_0:null,_init:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark((function e(){var r,n,i,o,a,s,c,u,l;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:cv.ui.structure.tile.components.Plugin.superclass.prototype._init.call(t);r="";if(!(r=t._element.hasAttribute("name")?t._element.getAttribute("name"):t._element.firstElementChild.nodeName.toLowerCase())){e.next=21;break}n="plugin-"+r;e.next=7;return t.loadPluginPart(n);case 7:if(!e.sent){e.next=19;break}i=null;e.t0=_regeneratorRuntime().keys(cv.plugins);case 11:if((e.t1=e.t0()).done){e.next=18;break}if((o=e.t1.value).toLowerCase()!==r){e.next=16;break}i=cv.plugins[o];return e.abrupt("break",18);case 16:e.next=11;break;case 18:if(i){cv.ui.structure.tile.components.Plugin.PL_COUNTER++;a="id_9_"+cv.ui.structure.tile.components.Plugin.PL_COUNTER;s=new DOMParser;c=s.parseFromString(t._element.innerHTML,"application/xml");u=i.parse(c.firstElementChild,a,"","text");cv.TemplateEngine.getInstance().setDomFinished(!1);t.__P_82_0=new i(u);t._element.innerHTML='<div class="widget_container" id="'.concat(a,'" data-type="').concat(u.$$type,'">').concat(t.__P_82_0.getDomString(),"</div>");l=cv.util.ScriptLoader.getInstance();window.requestAnimationFrame((function(){l.isFinished()?cv.TemplateEngine.getInstance().setDomFinished(!0):l.addListenerOnce("finished",(function(){cv.TemplateEngine.getInstance().setDomFinished(!0)}))}))}else t.error("no main plugin class found for "+n);case 19:e.next=22;break;case 21:t.error("no plugin name provided!");case 22:case"end":return e.stop()}}),e)})))()},loadPluginPart:function(t){var e=this;return _asyncToGenerator(_regeneratorRuntime().mark((function r(){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n=qx.Part.getInstance().getParts()[t])){r.next=3;break}return r.abrupt("return",new Promise((function(t){n.load((function(){return t(n)}),e)})));case 3:e.error("plugin",t,"does not exist");return r.abrupt("return",Promise.resolve(null));case 5:case"end":return r.stop()}}),r)})))()}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"plugin",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Plugin.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{construct:!0,require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"qx.event.message.Bus":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.RoundProgress",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MVisibility,construct:function(t){cv.ui.structure.tile.components.AbstractComponent.constructor.call(this,t);this.addListener("changeVisible",this._applyVisible,this)},properties:{progress:{check:"Number",apply:"_applyProgress"},text:{check:"String",apply:"_applyText"},type:{check:["circle","semiCircle"],init:"circle"},min:{check:"Number",init:0},max:{check:"Number",init:100}},members:{__P_83_0:null,__P_83_1:null,__P_83_2:null,__P_83_3:null,__P_83_4:null,__P_83_5:null,__P_83_6:null,__P_83_7:null,__P_83_8:null,_queuedFitText:null,_init:function(){var t=this;cv.ui.structure.tile.components.RoundProgress.superclass.prototype._init.call(this);var e=this._element,r=document.querySelector(":root").style,n=e.hasAttribute("radius"),i=this.__P_83_4=e.getAttribute("radius")||parseInt(r.getPropertyValue("--tileCellWidth"))||56,o=e.getAttribute("stroke")||8,a=this.__P_83_3=i-o/2;this.__P_83_1=2*a*Math.PI;if(e.hasAttribute("min")){var s=parseInt(e.getAttribute("min"));isNaN(s)||this.setMin(s)}if(e.hasAttribute("max")){var c=parseInt(e.getAttribute("max"));isNaN(c)||this.setMax(c)}e.hasAttribute("type")&&this.setType(e.getAttribute("type"));var u=this.getType(),l="semiCircle"===u?i:2*i,f="http://www.w3.org/2000/svg",p=document.createElementNS(f,"svg");p.setAttribute("height",l);p.setAttribute("width",""+2*i);p.setAttribute("type",u);if("circle"===u){if(!e.hasAttribute("no-background")){var h=document.createElementNS(f,"circle");h.classList.add("bg");h.setAttribute("r",""+a);h.setAttribute("cx","50%");h.setAttribute("cy","50%");h.setAttribute("fill","transparent");h.setAttribute("stroke-width",o);e.hasAttribute("background-color")&&(h.style.stroke=e.getAttribute("background-color"));p.appendChild(h)}var _=document.createElementNS(f,"circle");_.classList.add("bar");_.setAttribute("r",""+a);_.setAttribute("cx","50%");_.setAttribute("cy","50%");_.setAttribute("stroke-width",o);_.setAttribute("stroke-dasharray","".concat(this.__P_83_1," ").concat(this.__P_83_1));_.setAttribute("stroke-dashoffset",this.__P_83_1);e.hasAttribute("foreground-color")&&(_.style.stroke=e.getAttribute("foreground-color"));p.appendChild(_)}else if("semiCircle"===u){if(!e.hasAttribute("no-background")){var d=document.createElementNS(f,"path");d.classList.add("bg");d.setAttribute("d","M ".concat(o/2," ").concat(i," A ").concat(a," ").concat(a," 0 0 1 ").concat(2*i-o/2," ").concat(i));d.setAttribute("fill","transparent");d.setAttribute("stroke-width",o);e.hasAttribute("background-color")&&(d.style.stroke=e.getAttribute("background-color"));p.appendChild(d)}this.__P_83_2={x:o/2,y:i};var y=document.createElementNS(f,"path");y.classList.add("bar");y.setAttribute("d","M ".concat(o/2," ").concat(i," A ").concat(a," ").concat(a," 0 0 0 ").concat(o/2," ").concat(i));y.setAttribute("fill","transparent");y.setAttribute("stroke-width",o);e.hasAttribute("foreground-color")&&(y.style.stroke=e.getAttribute("foreground-color"));p.appendChild(y)}e.replaceChildren(p,document.createElement("label"));this.__P_83_7=2*i-2*o-24;n||qx.event.message.Bus.subscribe("cv.design.tile.cellWidthChanged",(function(r){t.__P_83_4=r.getData();t.__P_83_3=t.__P_83_4-o/2;t.__P_83_1=2*t.__P_83_3*Math.PI;l="semiCircle"===u?t.__P_83_4:2*t.__P_83_4;var n=e.querySelector(":scope > svg");n.setAttribute("height",""+l);n.setAttribute("width",""+2*t.__P_83_4);if("circle"===u)t._element.querySelectorAll(":scope > svg > circle").forEach((function(e){e.setAttribute("r",""+t.__P_83_3);if(e.classList.contains("bar")){e.setAttribute("stroke-dasharray",t.__P_83_1+" "+t.__P_83_1);e.setAttribute("stroke-dashoffset",""+t.__P_83_1)}}));else if("semiCircle"===u){t.__P_83_2.y=t.__P_83_4;var i=t._element.querySelector(":scope > svg > path.bg");i&&i.setAttribute("d","M ".concat(o/2," ").concat(t.__P_83_4," A ").concat(t.__P_83_3," ").concat(t.__P_83_3," 0 0 1 ").concat(2*t.__P_83_4-o/2," ").concat(t.__P_83_4))}t._applyProgress(t.isPropertyInitialized("progress")?t.getProgress():0)}))},__P_83_9:function(t){var e=t*(Math.PI/180);return{x:this.__P_83_4-this.__P_83_3*Math.cos(e),y:this.__P_83_4-this.__P_83_3*Math.sin(e)}},_applyProgress:function(t){if(this.isConnected()){var e,r,n=t-this.getMin(),i=Math.max(0,Math.min(100,100/(this.getMax()-this.getMin())*n));switch(this.getType()){case"circle":(e=this._element.querySelector(":scope > svg > circle.bar")).setAttribute("stroke-dashoffset",""+this.__P_83_1-i/100*this.__P_83_1);break;case"semiCircle":e=this._element.querySelector(":scope > svg > path.bar");r=this.__P_83_9(1.8*i);e.setAttribute("d",["M",this.__P_83_2.x,this.__P_83_2.y,"A",this.__P_83_3,this.__P_83_3,0,0,1,r.x,r.y].join(" "))}}},_fitText:function(){if(this.__P_83_5&&this.__P_83_5.textContent)if(this.isVisible()){if(!this.__P_83_6){this.__P_83_6=document.createElement("canvas");this.__P_83_10=this.__P_83_6.getContext("2d");var t=window.getComputedStyle(this.__P_83_5);this.__P_83_10.font=t.getPropertyValue("font");this.__P_83_8=t.getPropertyValue("font-size")}var e=this.__P_83_10.measureText(this.__P_83_5.textContent);if(e.width>this.__P_83_7){var r=this.__P_83_7/e.width;this.__P_83_5.style.fontSize=Math.floor(parseInt(this.__P_83_8)*r)+"px"}else this.__P_83_5.style.fontSize=this.__P_83_8;this._queuedFitText=!1}else this._queuedFitText=!0},_applyVisible:function(t){t.getData()&&this._queuedFitText&&this._fitText()},_applyText:function(t){if(this.isConnected()){this.__P_83_5||(this.__P_83_5=this._element.querySelector(":scope > label"));this.__P_83_5.textContent=t;t?this._fitText():this.__P_83_8&&(this.__P_83_5.style.fontSize=this.__P_83_8)}}},destruct:function(){this.__P_83_5=null},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"round-progress",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.RoundProgress.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"qx.event.Registration":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Select",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{show:{check:["icon","label","both"],init:"both",apply:"_applyShow"}},members:{__P_84_0:null,__P_84_1:null,__P_84_2:null,_init:function(){var t=this;cv.ui.structure.tile.components.Select.superclass.prototype._init.call(this);var e=this._element;this.__P_84_0=new Map;var r=this.__P_84_2=document.createElement("div");r.classList.add("popup");e.querySelectorAll(":scope > cv-option").forEach((function(e,n){r.appendChild(e);e.hasAttribute("key")||e.setAttribute("key",""+n);t.__P_84_0.set(e.getAttribute("key"),e)}));var n=this.__P_84_1=document.createElement("span");n.classList.add("value");e.appendChild(n);e.appendChild(r);var i=document.createElement("cv-icon");i.classList.add("dropdown");i.classList.add("ri-arrow-down-s-line");e.appendChild(i);this._writeAddresses.length>0&&e.addEventListener("click",(function(e){return t.onClicked(e)}))},_toggleOptions:function(t){var e=this;if("none"!==getComputedStyle(this.__P_84_2).getPropertyValue("display")||t){this.__P_84_2.style.display="none";qx.event.Registration.removeListener(document.body,"click",this.handleEvent,this,!0)}else{this.__P_84_2.style.display="block";window.requestAnimationFrame((function(){qx.event.Registration.addListener(document.body,"click",e.handleEvent,e,!0)}))}},handleEvent:function(t){t.preventDefault();t.stopPropagation();this._toggleOptions(!0)},onClicked:function(t){for(var e=t.target;e!==t.currentTarget&&"cv-option"!==e.tagName.toLowerCase();)e=e.parentElement;"cv-option"===e.tagName.toLowerCase()&&this._sendSelection(e.getAttribute("key"),!0);this._toggleOptions()},_sendSelection:function(t,e){var r=new CustomEvent("sendState",{detail:{value:t,source:this}});this._writeAddresses.filter((function(t){return!t.hasAttribute("on")||"click"===t.getAttribute("on")})).forEach((function(t){return t.dispatchEvent(r)}));!0===e&&this.setValue(t)},_updateValue:function(t,e){var r=void 0!==t?""+t:"";if(this.__P_84_0.has(r)){this.__P_84_1.innerHTML="";var n=this.__P_84_0.get(r);switch(this.getShow()){case"icon":var i,o=_createForOfIteratorHelper(n.children);try{for(o.s();!(i=o.n()).done;){var a=i.value;"cv-icon"===a.nodeName.toLowerCase()&&this.__P_84_1.appendChild(a.cloneNode())}}catch(t){o.e(t)}finally{o.f()}break;case"label":var s,c=_createForOfIteratorHelper(n.childNodes);try{for(c.s();!(s=c.n()).done;){var u=s.value;(u.nodeType===Node.TEXT_NODE||u.nodeType===Node.ELEMENT_NODE&&"label"===u.nodeName.toLowerCase())&&this.__P_84_1.appendChild(u.cloneNode())}}catch(t){c.e(t)}finally{c.f()}break;case"both":this.__P_84_1.innerHTML=n.innerHTML}}},_applyShow:function(t){this.getValue()&&this._updateValue(this.getValue())}},defer:function(t){var e;customElements.define(cv.ui.structure.tile.Controller.PREFIX+"select",(e=function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector),_defineProperty(e,"observedAttributes",["show"]),e))}});cv.ui.structure.tile.components.Select.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.util.Function":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Slider",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{stepWidth:{check:"Number",init:5,apply:"_applyStepWidth"},min:{check:"Number",init:1,apply:"_applyMin"},max:{check:"Number",init:100,apply:"_applyMax"},showValue:{check:"Boolean",init:!0,apply:"_applyShowValue"},throttleInterval:{check:"Number",init:250,apply:"_applyThrottleInterval"}},members:{__P_85_0:null,__P_85_1:null,_init:function(){var t=this;cv.ui.structure.tile.components.Slider.superclass.prototype._init.call(this);var e=this._element;e.hasAttribute("throttle-interval")?this.setThrottleInterval(parseInt(e.getAttribute("throttle-interval"))):this._applyThrottleInterval(this.getThrottleInterval());var r=e.querySelector(":scope > input");if(!r){(r=document.createElement("input")).classList.add("slider");r.setAttribute("type","range");e.insertBefore(r,e.querySelector(":scope > .up"));r.oninput=function(){return t.__P_85_0.call()}}this.__P_85_1=r;e.hasAttribute("step-width")&&this.setStepWidth(parseInt(e.getAttribute("step-width")));e.hasAttribute("min")&&this.setMin(parseInt(e.getAttribute("min")));e.hasAttribute("max")&&this.setMax(parseInt(e.getAttribute("max")));e.hasAttribute("hide-value")&&"true"===e.getAttribute("hide-value")?this.setShowValue(!1):this._applyShowValue(!0);var n=e.querySelector(":scope > .decrease");n&&n.addEventListener("click",(function(e){return t.onDecrease()}));var i=e.querySelector(":scope > .increase");i&&i.addEventListener("click",(function(e){return t.onIncrease()}))},_applyThrottleInterval:function(t){var e=this;this.__P_85_0=t>0?cv.util.Function.throttle(this.onInput,t,{trailing:!0},this):{call:function(){return e.onInput()},abort:function(){}}},_applyMin:function(t){this._element.querySelector(":scope > input").setAttribute("min",""+t)},_applyMax:function(t){this._element.querySelector(":scope > input").setAttribute("max",""+t)},_applyStepWidth:function(t){this._element.querySelector(":scope > input").setAttribute("step",""+t)},_applyShowValue:function(t){var e=this._element.querySelector(":scope > label.value");if(t&&!e){(e=document.createElement("label")).classList.add("value");e.classList.add("secondary");this._element.insertBefore(e,this._element.firstChild)}},_updateValue:function(t,e){var r=this._element.querySelector(":scope > input");r&&(r.value=e);if(this.isShowValue()){var n=this._element.querySelector(":scope > label.value");n&&(n.innerText=t)}},onInput:function(){this.__P_85_2(this.__P_85_1.value)},onDecrease:function(){var t=this.getValue()-this.getStepWidth();this.__P_85_2(t,"decrease")},onIncrease:function(){var t=this.getValue()+this.getStepWidth();this.__P_85_2(t,"increase")},__P_85_2:function(t,e){var r=new CustomEvent("sendState",{detail:{value:t,source:this}});this._writeAddresses.filter((function(t){return!t.hasAttribute("on")||t.getAttribute("on")===e})).forEach((function(t){return t.dispatchEvent(r)}))}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"slider",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Slider.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Spinner",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{stepWidth:{check:"Number",init:1},mode:{check:["relative","absolute"],init:"absolute"}},members:{_init:function(){var t=this;cv.ui.structure.tile.components.Spinner.superclass.prototype._init.call(this);var e=this._element;e.hasAttribute("step-width")&&this.setStepWidth(parseFloat(e.getAttribute("step-width")));e.hasAttribute("mode")&&this.setMode(e.getAttribute("mode"));var r=e.querySelector(":scope > .value");if(!r){(r=document.createElement("label")).classList.add("value");r.classList.add("primary");e.appendChild(r)}var n=document.createElement("div");n.classList.add("clickable");n.classList.add("left");var i=document.createElement("cv-icon");i.classList.add("ri-arrow-down-s-line");n.addEventListener("click",(function(){return t.onDecrease()}));n.appendChild(i);e.insertBefore(n,r);var o=document.createElement("div");o.classList.add("clickable");o.classList.add("right");var a=document.createElement("cv-icon");a.classList.add("ri-arrow-up-s-line");o.appendChild(a);o.addEventListener("click",(function(){return t.onIncrease()}));e.appendChild(o)},onDecrease:function(){var t="absolute"===this.getMode()?this.getValue()-this.getStepWidth():-1*this.getStepWidth();this.__P_86_0(t,"decrease")},onIncrease:function(){var t="absolute"===this.getMode()?this.getValue()+this.getStepWidth():this.getStepWidth();this.__P_86_0(t,"increase")},_updateValue:function(t){var e=this._element.querySelector(".value");e&&(e.innerHTML=t)},__P_86_0:function(t,e){var r=new CustomEvent("sendState",{detail:{value:t,source:this}});this._writeAddresses.filter((function(t){return!t.hasAttribute("on")||t.getAttribute("on")===e})).forEach((function(t){return t.dispatchEvent(r)}))}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"spinner",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Spinner.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{construct:!0,require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MResize":{require:!0},"qx.util.Function":{},"cv.Application":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Value",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MResize],construct:function(t){cv.ui.structure.tile.components.AbstractComponent.constructor.call(this,t);this.addListener("changeVisible",this._applyVisible,this)},members:{_queuedOverflowDetection:null,_debouncedDetectOverflow:null,_init:function(){cv.ui.structure.tile.components.Value.superclass.prototype._init.call(this);this._debouncedDetectOverflow=qx.util.Function.debounce(this._detectOverflow,20);var t=this._element.querySelector(".value");if(t&&"label"===t.tagName.toLowerCase()){this.setResizeTarget(this._element);this.addListener("resized",this._debouncedDetectOverflow,this)}},_applyVisible:function(t){if(t.getData())this._queuedOverflowDetection&&this._debouncedDetectOverflow();else{var e=this._element.querySelector(".value");e&&e.classList.contains("scroll")&&e.classList.remove("scroll")}},_detectOverflow:function(){var t=this._element.querySelector(".value");if(this.isVisible()){this._queuedOverflowDetection=!1;t.clientWidth>t.parentElement.clientWidth?t.classList.add("scroll"):t.classList.remove("scroll")}else this._queuedOverflowDetection=!0},_updateValue:function(t,e){var r,n=this,i="",o=_createForOfIteratorHelper(this._element.querySelectorAll(".value"));try{var a=function(){var o=r.value;switch(o.tagName.toLowerCase()){case"cv-icon":n._element.hasAttribute("styling")&&(i=cv.Application.structureController.styleValue(n._element.getAttribute("styling"),e,n.__P_87_0));if(o._instance){o._instance.setId(""+t);o._instance.setStyleClass(i)}else window.requestAnimationFrame((function(){if(o._instance){o._instance.setId(""+t);o._instance.setStyleClass(i)}else n.error("id and styleClass could not be applied, custom element not initialized yet!")}));break;case"meter":o.setAttribute("value",e);break;case"cv-round-progress":"string"==typeof e&&(e=parseInt(e));o._instance.setProgress(e);o._instance.setText(""+t);break;case"label":o.innerHTML=t;n._debouncedDetectOverflow()}};for(o.s();!(r=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"value",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.components.Value.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"cv.ui.structure.tile.MStringTransforms":{require:!0},"qx.Class":{},"cv.ui.structure.tile.components.svg.MSvgGrid":{}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.components.svg.MGraphicsElement",{include:cv.ui.structure.tile.MStringTransforms,statics:{DefaultSize:56},properties:{row:{check:"Number",init:0,apply:"_applyPosition",transform:"_parseFloat"},column:{check:"Number",init:0,apply:"_applyPosition",transform:"_parseFloat"},x:{check:"String",nullable:!0,apply:"_applyToSvg"},y:{check:"String",nullable:!0,apply:"_applyToSvg"},rowspan:{check:"Number",init:1,apply:"_updateHeight",transform:"_parseFloat"},colspan:{check:"Number",init:1,apply:"_updateWidth",transform:"_parseFloat"},height:{check:"Number",init:0,apply:"_applySize",event:"heightChanged"},width:{check:"Number",init:0,apply:"_applySize",event:"widthChanged"},title:{check:"String",init:"",apply:"_applyTitle"}},members:{_parentGridLayout:null,_findParentGridLayout:function(){for(var t=null,e=this._element.parentElement;e&&!t;)if(e.nodeName.toLowerCase().startsWith("cv-")&&e._instance&&qx.Class.hasOwnMixin(e._instance.constructor,cv.ui.structure.tile.components.svg.MSvgGrid))t=e._instance;else{if("cv-page"===e.nodeName.toLowerCase())break;e=e.parentElement}this._parentGridLayout=t},_applyToSvg:function(t,e,r){this._svg&&this._svg.setAttribute(r,t)},_updateWidth:function(){if(this._parentGridLayout&&this._svg){var t=this._parentGridLayout.getCellWidth()*this.getColspan()+this._parentGridLayout.getSpacing()*(this.getColspan()-1);this.setWidth(t)}},_updateHeight:function(){if(this._parentGridLayout&&this._svg){var t=this._parentGridLayout.getCellHeight()*this.getRowspan()+this._parentGridLayout.getSpacing()*(this.getRowspan()-1);this.setHeight(t)}},_applyPosition:function(){this._parentGridLayout&&this._svg&&this._parentGridLayout.layout(this._svg,this.getRow(),this.getColumn())},_applySize:function(t,e,r){this._svg&&this._svg.setAttribute(r,"".concat(t))},_applyTitle:function(t,e){if("function"==typeof this._applyTitleOverride)this._applyTitleOverride(t,e);else if(this._target){var r=this._target.querySelector(":scope > title");if(t){if(!r){r=document.createElementNS("http://www.w3.org/2000/svg","title");this._target.appendChild(r)}r.textContent=t}else r&&r.remove()}}}});cv.ui.structure.tile.components.svg.MGraphicsElement.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.Value":{require:!0},"cv.ui.structure.tile.components.svg.MGraphicsElement":{require:!0},"qx.util.Function":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.svg.TextValue",{extend:cv.ui.structure.tile.components.Value,include:cv.ui.structure.tile.components.svg.MGraphicsElement,properties:{icon:{check:"String",nullable:!0,apply:"_applyIcon"},color:{check:"String",init:"var(--primaryText)",apply:"_applyColor"},iconColor:{check:"String",init:"var(--primaryText)",apply:"_applyIconColor"},scale:{check:"Number",init:1,apply:"_applyScale"},offsetY:{check:"Number",init:0,apply:"_applyOffsetY"},offsetX:{check:"Number",init:0,apply:"_applyOffsetX"}},members:{_target:null,_svg:null,_iconSize:null,_iconPosition:null,_debouncedUpdateRSize:null,getSvg:function(){return this._svg},getParentSvg:function(){return this._svg?this._svg.ownerSVGElement:null},_init:function(){cv.ui.structure.tile.components.svg.TextValue.superclass.prototype._init.call(this);var t=this._element;this._findParentGridLayout();var e=this._parentGridLayout?this._parentGridLayout.getSvg():t;this._iconSize=24*this.getScale();this._debouncedUpdateRSize=qx.util.Function.debounce(this._updateSize.bind(this),10);this._parentGridLayout.addListener("changeSize",this._debouncedUpdateRSize,this);var r="http://www.w3.org/2000/svg",n=this._svg=document.createElementNS(r,"svg");n.classList.add("text-value");for(var i=0,o=["x","y"];i<o.length;i++){var a=o[i];t.hasAttribute(a)&&n.setAttribute(a,t.getAttribute(a))}e.appendChild(n);var s=document.createElementNS(r,"g");n.appendChild(s);this._target=s;t.hasAttribute("icon")&&this._applyIcon(this.getIcon());var c=document.createElementNS(r,"text");c.setAttribute("x","0");c.setAttribute("y","32");c.setAttribute("alignment-baseline","central");c.setAttribute("class","value");c.setAttribute("fill",this.getColor());this._target.appendChild(c);this.addListener("heightChanged",this._centerY,this);this.addListener("widthChanged",this._centerX,this);this._updateHeight();this._updateWidth();this._applyPosition();this._applyTitleOverride(this.getTitle())},_updateSize:function(){var t=Math.min(2.5,(Math.min(this._parentGridLayout.getCellWidth(),this._parentGridLayout.getCellHeight())-this._parentGridLayout.getSpacing())/cv.ui.structure.tile.components.svg.MGraphicsElement.DefaultSize);if(0!==t){this.debug("new scale:",t);this.setScale(t)}},_applyScale:function(t){this._target&&this._target.setAttribute("transform","scale(".concat(t,")"));if(this._svg){this.setHeight(cv.ui.structure.tile.components.svg.MGraphicsElement.DefaultSize*t*this.getRowspan());this.setWidth(cv.ui.structure.tile.components.svg.MGraphicsElement.DefaultSize*t*this.getColspan())}},_updateValue:function(t,e){if(this._target){this._target.querySelector(".value").textContent=t;this._debouncedDetectOverflow()}},_centerY:function(){this.setOffsetY(this.getHeight()/2-this._svg.getBBox().height/2)},_centerX:function(){this.setOffsetX(this.getWidth()/2-this._svg.getBBox().width/2)},_applyOffsetY:function(t){var e=this._target.querySelector(".icon-container");e&&e.setAttribute("y","".concat(t));var r=this._target.querySelector("text.value");r&&r.setAttribute("y",""+(t+32));(r=this._target.querySelector("text.title"))&&r.setAttribute("y",""+(t+16))},_applyOffsetX:function(){},_applyTitleOverride:function(t){if(this._target)if(t){var e=this._target.querySelector("text.title");if(!e){(e=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x","0");e.setAttribute("y","16");e.setAttribute("alignment-baseline","central");e.classList.add("title");this._target.appendChild(e)}e.textContent=t}else{var r=this._target.querySelector("text.title");r&&r.remove()}},_applyColor:function(t){if(this._target){var e=this._target.querySelector(".value");t?e.setAttribute("fill",t):e.removeAttribute("fill")}},_applyIconColor:function(t){var e=this._target?this._target.querySelector("cv-icon"):null;e&&(e.style.color=t||"inherit")},_applyIcon:function(t){if(this._target){var e=this._target.querySelector("cv-icon");if(t){if(!e){var r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");r.setAttribute("class","icon-container");r.setAttribute("width",this._iconSize+"px");r.setAttribute("height",this._iconSize+"px");r.style.textAlign="center";(e=document.createElement("cv-icon")).classList.add(t);e.style.fontSize=this._iconSize+"px";this.getIconColor()&&(e.style.color=this.getIconColor());r.appendChild(e);var n=this._target.querySelector(".value");n?this._target.insertBefore(r,n):this._target.appendChild(r)}}else e&&this._target.remove(e)}},_applyStyleClass:function(t,e){var r=this._target.classList;e&&r.contains(e)&&r.remove(e);t&&r.add(t)},_detectOverflow:function(){if(this.isVisible()){var t=this._target.querySelector(".value"),e=0,r=this._svg.getAttribute("width");if(r)e=parseInt(r,10);else{e=this._svg.getBBox().width}this._queuedOverflowDetection=!1;t.clientWidth>e?t.classList.add("scroll"):t.classList.remove("scroll")}else this._queuedOverflowDetection=!0}},defer:function(t){var e;customElements.define(cv.ui.structure.tile.Controller.PREFIX+"svg-text-value",(e=function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector),_defineProperty(e,"observedAttributes",["icon","x","y","row","column","rowspan","colspan","radius","stroke","title"]),e))}});cv.ui.structure.tile.components.svg.TextValue.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.components.energy.MEntity",{properties:{type:{check:["pv","battery","grid","house","charger","heatpump","consumer"],nullable:!0,apply:"_applyType"},foregroundColor:{check:"String",nullable:!0,apply:"_applyForegroundColor"}},members:{_noValue:null,hasNoValue:function(){return this._noValue},preMappingHook:function(t){return Math.abs(t)},_applyForegroundColor:function(t){var e=this._svg?this._svg.querySelector("circle.bar"):null;e&&(e.style.stroke=t)}}});cv.ui.structure.tile.components.energy.MEntity.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.svg.TextValue":{require:!0},"cv.ui.structure.tile.components.energy.MEntity":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.energy.EnergyEntity",{extend:cv.ui.structure.tile.components.svg.TextValue,include:cv.ui.structure.tile.components.energy.MEntity,statics:{typeSettings:{pv:{icon:"knxuf-weather_sun",color:"var(--pvColor)"},battery:{icon:"knxuf-measure_battery_100"},grid:{icon:"knxuf-scene_power_grid"},house:{icon:"knxuf-control_building_empty"},charger:{icon:"knxuf-veh_wallbox",color:"var(--powerConsumeColor)"},heatpump:{icon:"knxuf-sani_earth_source_heat_pump",color:"var(--powerConsumeColor)"},consumer:{icon:"knxuf-measure_smart_meter",color:"var(--powerConsumeColor)"}}},properties:{direction:{check:["incoming","outgoing","none"],init:"none",apply:"_applyDirection"},unit:{check:["Wh","kWh"],init:"kWh",apply:"_applyUnit"}},members:{_autoFormat:null,_applyType:function(t){var e=cv.ui.structure.tile.components.energy.EnergyEntity.typeSettings[t];if(e)for(var r in e)this._element.setAttribute(r,e[r])},_init:function(){cv.ui.structure.tile.components.energy.EnergyEntity.superclass.prototype._init.call(this);var t=this._element;t.hasAttribute("id")&&this._svg.setAttribute("id",t.getAttribute("id"));this._autoFormat=!t.hasAttribute("format");this._applyUnit(this.getUnit());var e=this.getDirection();"none"!==e&&this._applyDirection(e)},_applyUnit:function(t){if(this.isConnected()&&this._autoFormat&&!this._element.hasAttribute("format"))switch(t){case"Wh":this._element.setAttribute("format","%d Wh");break;case"kWh":this._element.setAttribute("format","%.2f kWh");break;default:this._element.removeAttribute("format")}},_applyDirection:function(t){if("none"!==t){switch(this.getType()){case"battery":this.setColor("incoming"===t?"var(--batteryConsumeColor)":"var(--batteryInjectColor)");break;case"grid":this.setColor("incoming"===t?"var(--gridConsumeColor)":"var(--gridInjectColor)")}if(this._target){var e=this._target.querySelector("path.energy-direction");if(!e){(e=document.createElementNS("http://www.w3.org/2000/svg","path")).classList.add("energy-direction");e.setAttribute("d","M 0 0 L 6 4 L 0 8");e.setAttribute("stroke",this.getIconColor());e.setAttribute("stroke-width","1");e.setAttribute("fill","transparent");this._target.appendChild(e)}this.__P_88_0()}}else{this.resetColor();var r=this._target?this._target.querySelector("path.direction"):null;r&&r.remove()}},_applyOffsetY:function(t){cv.ui.structure.tile.components.energy.EnergyEntity.superclass.prototype._applyOffsetY.call(this,t);this.__P_88_0()},_applyScale:function(t){cv.ui.structure.tile.components.energy.EnergyEntity.superclass.prototype._applyScale.call(this,t);this.__P_88_0()},__P_88_0:function(){var t=this._target.querySelector("path.energy-direction");t&&t.setAttribute("transform","translate(28, ".concat(this.getOffsetY()+8,") rotate(").concat("incoming"===this.getDirection()?"90":"-90",", 3, 4)"))}},defer:function(t){var e;customElements.define(cv.ui.structure.tile.Controller.PREFIX+"energy-entity",(e=function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector),_defineProperty(e,"observedAttributes",["icon","type","x","y","row","column","rowspan","colspan","direction","unit","color"]),e))}});cv.ui.structure.tile.components.energy.EnergyEntity.$$dbClassInfo=t}();function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.svg.Connector":{},"cv.ui.structure.tile.components.energy.PowerEntity":{}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.components.energy.MConnectable",{construct:function(){this._connections=[];this._inverseConnections=[]},properties:{connectTo:{check:"String",nullable:!0,apply:"_applyConnectTo"},connectFrom:{check:"String",nullable:!0,apply:"_applyConnectFrom"},connectionPoints:{check:"String",init:"auto",apply:"_applyConnectionPoints"},useConnectionSum:{check:"Boolean",init:!1,apply:"_applyUseConnectionSum"}},members:{_connectorTo:null,_connectorFrom:null,_useConnectionsSumAsValue:null,_connections:null,_inverseConnections:null,addConnection:function(t){if(!this._connections.includes(t)){this._connections.push(t);this.getUseConnectionSum()&&t.addListener("changeValue",this._updateConnectionsSum,this)}},addInverseConnection:function(t){if(!this._inverseConnections.includes(t)){this._inverseConnections.push(t);this.getUseConnectionSum()&&t.addListener("changeValue",this._updateConnectionsSum,this)}},removeConnection:function(t){if(this._connections.includes(t)){this._connections.remove(t);this.getUseConnectionSum()&&t.removeListener("changeValue",this._updateConnectionsSum,this)}},removeInverseConnection:function(t){if(this._inverseConnections.includes(t)){this._inverseConnections.remove(t);this.getUseConnectionSum()&&t.removeListener("changeValue",this._updateConnectionsSum,this)}},_applyUseConnectionSum:function(t){if(t){var e,r=_createForOfIteratorHelper(this._connections);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.removeListener("changeValue",this._updateConnectionsSum,this);n.addListener("changeValue",this._updateConnectionsSum,this)}}catch(t){r.e(t)}finally{r.f()}var i,o=_createForOfIteratorHelper(this._inverseConnections);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.removeListener("changeValue",this._updateConnectionsSum,this);a.addListener("changeValue",this._updateConnectionsSum,this)}}catch(t){o.e(t)}finally{o.f()}}},_updateConnectionsSum:function(){var t,e=0,r=_createForOfIteratorHelper(this._connections);try{for(r.s();!(t=r.n()).done;){e+=t.value.getValue()}}catch(t){r.e(t)}finally{r.f()}var n,i=_createForOfIteratorHelper(this._inverseConnections);try{for(i.s();!(n=i.n()).done;){e-=n.value.getValue()}}catch(t){i.e(t)}finally{i.f()}this.setValue(e)},_updateDirection:function(){for(var t=Math.round(this.getValue()),e=0,r=[this._connectorTo,this._connectorFrom];e<r.length;e++){var n=r[e];n&&(t<0?n.setShowDirection("source"):t>0?n.setShowDirection("target"):n.setShowDirection("none"))}},_applyConnectTo:function(t){if(this._svg&&t){var e=this._element.parentElement.querySelector("#"+t);if(e&&"cv-power-entity"===e.nodeName.toLowerCase())if(this._connectorTo)this._connectorTo.setTarget(e._instance);else{this._connectorTo=this._initConnection(this,e._instance);this._applyConnectionPoints(this.getConnectionPoints());this._updateDirection();e._instance.addConnection(this)}}t?this.registerPreMappingHook(this.preMappingHook,this):this.unregisterPreMappingHook(this.preMappingHook)},_applyConnectFrom:function(t){if(this._svg&&t){var e=this._element.parentElement.querySelector("#"+t);if(e&&"cv-power-entity"===e.nodeName.toLowerCase())if(this._connectorFrom)this._connectorFrom.setSource(e._instance);else{this._connectorFrom=this._initConnection(e._instance,this);this._applyConnectionPoints(this.getConnectionPoints());this._updateDirection();e._instance.addInverseConnection(this)}}},_initConnection:function(t,e){var r=new cv.ui.structure.tile.components.svg.Connector(t,e);if(t.hasNoValue()){var n=e.getElement().getAttribute("id"),i=this._element.parentElement.querySelector("#"+n);i&&i._instance&&i._instance instanceof cv.ui.structure.tile.components.energy.PowerEntity&&!i._instance.hasNoValue()&&i._instance.bind("styleClass",r,"styleClass")}else this.bind("styleClass",r,"styleClass");return r},_applyConnectionPoints:function(t){if(t){var e=[];this._connectorTo&&e.push(this._connectorTo);this._connectorFrom&&e.push(this._connectorFrom);for(var r=0,n=e;r<n.length;r++){var i=n[r];if("auto"===t)i.set({sourceConnectionPoint:"auto",targetConnectionPoint:"auto"});else{var o=t.split("-"),a=_slicedToArray(o,2),s=a[0],c=a[1];i.set({sourceConnectionPoint:s,targetConnectionPoint:c})}}}}},destruct:function(){var t=this.getSource(),e=this.getTarget();e&&e.removeConnection(this);t&&t.removeInverseConnection(this);this._disposeObjects("_connectorTo","_connectorFrom");this._connections.clear();this._inverseConnections.clear()}});cv.ui.structure.tile.components.energy.MConnectable.$$dbClassInfo=t}();function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"qx.core.Object":{construct:!0,require:!0},"qx.util.Function":{construct:!0},"cv.ui.structure.tile.components.energy.PowerEntity":{},"cv.util.Svg":{},"qx.core.ValidationError":{}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.svg.Connector",{extend:qx.core.Object,construct:function(t,e){qx.core.Object.constructor.call(this);this._updatePosition=this.__P_89_0.bind(this);this._debouncedUpdatePosition=qx.util.Function.debounce(this._updatePosition,50);this._sourceObserver=new MutationObserver(this._onMutation.bind(this));this._targetObserver=new MutationObserver(this._onMutation.bind(this));this.setSource(t);this.setTarget(e)},statics:{C:0},properties:{id:{check:"String",nullable:!0},source:{check:"cv.ui.structure.tile.components.energy.PowerEntity",apply:"_applySource",nullable:!0},target:{check:"cv.ui.structure.tile.components.energy.PowerEntity",apply:"_applyTarget",nullable:!0},root:{check:"SVGSVGElement",apply:"_applyRoot",nullable:!0},sourceConnectionPoint:{check:["top","right","bottom","left","auto"],init:"auto",apply:"__P_89_0",validate:"_validateConnectionPoint"},targetConnectionPoint:{check:["top","right","bottom","left","auto"],init:"auto",apply:"__P_89_0",validate:"_validateConnectionPoint"},styleClass:{check:"String",nullable:!0,apply:"_applyStyleClass"},showDirection:{check:["none","source","target","both"],init:"none",apply:"_applyShowDirection"},inverted:{check:"Boolean",init:!1,apply:"_applyShowDirection"}},members:{_path:null,_sourceObserver:null,_targetObserver:null,_applySource:function(t,e){e&&this._sourceObserver.disconnect();if(t){this._init();this._sourceObserver.observe(t.getSvg(),{attributes:!0})}},_applyTarget:function(t,e){e&&this._targetObserver.disconnect();if(t){this._init();this._targetObserver.observe(t.getSvg(),{attributes:!0})}},_init:function(){var t=this,e=this.getSource(),r=this.getTarget();if(e&&r){for(var n=e.getSvg(),i=r.getSvg(),o=n.ownerSVGElement,a=i.ownerSVGElement;o!==a;){var s=!1;if(o.ownerSVGElement){o=o.ownerSVGElement;s=!0}if(a.ownerSVGElement){a=a.ownerSVGElement;s=!0}if(!s)break}var c=o||a;this.setRoot(c);var u="",l=!1;if(n.hasAttribute("id"))u+=n.getAttribute("id");else{u+=n.nodeName;l=!0}u+="-";if(i.hasAttribute("id"))u+=i.getAttribute("id");else{u+=i.nodeName;l=!0}l&&(u+=cv.ui.structure.tile.components.svg.Connector.C++);var f=c.querySelector("#"+u);this.setId(u);if(!f){(f=document.createElementNS("http://www.w3.org/2000/svg","path"))._instance=this;f.setAttribute("id",u);f.setAttribute("stroke","var(--borderColor)");f.setAttribute("fill","transparent");f.setAttribute("stroke-width","2");f.setAttribute("class","connection");c.insertBefore(f,c.firstChild)}this._path=f;setTimeout((function(){t.__P_89_0()}),1e3)}},_onMutation:function(t,e){var r,n=_createForOfIteratorHelper(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;"attributes"!==i.type||"x"!==i.attributeName&&"y"!==i.attributeName||this._debouncedUpdatePosition()}}catch(t){n.e(t)}finally{n.f()}},__P_89_0:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.getSource(),n=this.getTarget();if(r&&n&&this._path){var i=r.getSvg(),o=n.getSvg(),a=cv.util.Svg.getBBox(i),s=cv.util.Svg.getBBox(o),c=0,u=0,l=0,f=0,p=this.getSourceConnectionPoint(),h=this.getTargetConnectionPoint();if("auto"===p||"auto"===h){var _=s.cx-a.cx,d=s.cy-a.cy,y=Math.sqrt(Math.pow(_,2)+Math.pow(d,2));if(0===y){e||setTimeout((function(){t._updatePosition(!0)}),1e3);return}var m=r.getRadius()/y,v=n.getRadius()/y,b=a.cy+d*m,g=s.cy-d*v,P=a.cx+_*m,C=s.cx-_*v;this.debug(this.getId(),"(".concat(P,", ").concat(b,") -> (").concat(C,", ").concat(g,")"));if("auto"===p){c=P;u=b}if("auto"===h){l=C;f=g}}switch(p){case"bottom":c=a.cx;u=a.y+a.height;break;case"top":c=a.cx;u=a.y;break;case"right":c=a.x+a.width;u=a.cy;break;case"left":c=a.x;u=a.cy}switch(h){case"bottom":l=s.cx;f=s.y+s.height;break;case"top":l=s.cx;f=s.y;break;case"right":l=s.x+s.width;f=s.cy;break;case"left":l=s.x;f=s.cy}if(c>l){this.setInverted(!0);this.drawPath(this._path,l,f,c,u)}else{this.setInverted(!1);this.drawPath(this._path,c,u,l,f)}}},drawPath:function(t,e,r,n,i){t.setAttribute("d","M".concat(e," ").concat(r," L ").concat(n," ").concat(i))},_applyRoot:function(t,e){e&&e.removeEventListener("resize",this._updatePosition);if(t){t.addEventListener("resize",this._updatePosition);this._initArrowMarkers(t)}},_applyStyleClass:function(t,e){if(this._path){e&&this._path.classList.remove(e);t&&this._path.classList.add(t);this._applyShowDirection()}},_applyShowDirection:function(){var t=this.getShowDirection(),e="";if("none"===t){this._path.removeAttribute("marker-start");this._path.removeAttribute("marker-end")}else if("both"===t){e=this.__P_89_1();this._path.setAttribute("marker-start","url(#".concat(e,")"));this._path.setAttribute("marker-end","url(#".concat(e,")"))}else if("source"===t&&!this.isInverted()||"target"===t&&this.isInverted()){e=this.__P_89_1();this._path.setAttribute("marker-start","url(#".concat(e,")"));this._path.removeAttribute("marker-end")}else if("target"===t&&!this.isInverted()||"source"===t&&this.isInverted()){e=this.__P_89_1();this._path.removeAttribute("marker-start");this._path.setAttribute("marker-end","url(#".concat(e,")"))}},__P_89_1:function(){var t="arrow",e=this.getStyleClass();if(e){var r="".concat(t,"-").concat(e),n=this.getRoot();try{if(!n.querySelector("#".concat(r))){var i=n.querySelector("#".concat(t)).cloneNode(!0);i.removeAttribute("fill");i.setAttribute("class","connection "+e);i.setAttribute("id",r);n.querySelector("defs").appendChild(i)}}catch(t){this.log.error("error getting arrow:",t.errorMessage)}return r}return t},_validateConnectionPoint:function(t){if(!["top","right","bottom","left","auto"].includes(t))throw new qx.core.ValidationError("Validation Error: ",t+" is no valid connection point.")},_initArrowMarkers:function(t){var e=t.querySelector("defs"),r="http://www.w3.org/2000/svg";if(!e){e=document.createElementNS(r,"defs");t.appendChild(e)}var n=e.querySelector("#h-arrow-path");if(!n){(n=document.createElementNS(r,"path")).setAttribute("id","h-arrow-path");n.setAttribute("d","M 0 0 L 10 5 L 0 10 z");e.appendChild(n)}var i=e.querySelector("#arrow");if(!i){(i=document.createElementNS(r,"marker")).setAttribute("id","arrow");i.setAttribute("viewBox","0 0 10 10");i.setAttribute("refX","10");i.setAttribute("refY","5");i.setAttribute("markerWidth","5");i.setAttribute("markerHeight","5");i.setAttribute("markerUnits","strokeWidth");i.setAttribute("fill","var(--borderColor)");i.setAttribute("orient","auto-start-reverse");var o=document.createElementNS(r,"use");o.setAttribute("href","#h-arrow-path");i.appendChild(o);e.appendChild(i)}}},destruct:function(){this._path=null;this._sourceObserver.disconnect();this._sourceObserver=null;this._targetObserver.disconnect();this._targetObserver=null}});cv.ui.structure.tile.components.svg.Connector.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.Value":{require:!0},"cv.ui.structure.tile.components.svg.MGraphicsElement":{require:!0},"qx.util.Function":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.svg.RoundValue",{extend:cv.ui.structure.tile.components.Value,include:cv.ui.structure.tile.components.svg.MGraphicsElement,properties:{progress:{check:"Number",apply:"_applyProgress"},min:{check:"Number",init:0},max:{check:"Number",init:100},showProgress:{check:"Boolean",init:!1,apply:"_applyShowProgress"},icon:{check:"String",nullable:!0,apply:"_applyIcon"},radius:{check:"Number",init:30,apply:"_applyRadius",transform:"_parseInt"},stroke:{check:"Number",init:2,apply:"_applyStroke",transform:"_parseFloat"},amount:{check:"Number",init:0,apply:"_applyAmount"}},members:{_target:null,_svg:null,__P_91_0:null,_radius:null,_iconSize:null,_iconOffset:null,_fixedRadius:null,getSvg:function(){return this._svg},getParentSvg:function(){return this._svg?this._svg.ownerSVGElement:null},_init:function(){var t=this;cv.ui.structure.tile.components.svg.RoundValue.superclass.prototype._init.call(this);var e=this._element;this._fixedRadius=e.hasAttribute("radius");var r=this.getRadius(),n=this.getStroke();this._findParentGridLayout();if(this._parentGridLayout&&!this._fixedRadius){this._debouncedUpdateRadius=qx.util.Function.debounce(this._updateRadius.bind(this),10);this._parentGridLayout.addListener("changeSize",this._debouncedUpdateRadius,this)}var i=this._parentGridLayout?this._parentGridLayout.getSvg():e,o="http://www.w3.org/2000/svg",a=this._svg=document.createElementNS(o,"svg");this.setHeight(2*r);this.setWidth(2*r);a.setAttribute("type","circle");for(var s=0,c=["x","y"];s<c.length;s++){var u=c[s];e.hasAttribute(u)&&a.setAttribute(u,e.getAttribute(u))}i.appendChild(a);var l=document.createElementNS(o,"g");l.classList.add("round-value");l.setAttribute("fill","transparent");l.setAttribute("stroke-width",n);a.appendChild(l);this._target=l;this._applyRadius(r);if(!e.hasAttribute("no-background")){var f=document.createElementNS(o,"circle");f.classList.add("bg");this.__P_91_0&&f.setAttribute("r",""+this.__P_91_0);f.setAttribute("cx","50%");f.setAttribute("cy","50%");e.hasAttribute("background-color")&&(f.style.stroke=e.getAttribute("background-color"));this._target.appendChild(f)}this.setShowProgress(e.querySelectorAll(':scope > cv-address[target="progress"], :scope > cv-address-group[target="progress"]').length>0);e.hasAttribute("icon")&&this._applyIcon(this.getIcon());if(e.hasAttribute("min")){var p=parseInt(e.getAttribute("min"));isNaN(p)||this.setMin(p)}if(e.hasAttribute("max")){var h=parseInt(e.getAttribute("max"));isNaN(h)||this.setMax(h)}var _=document.createElementNS(o,"text");_.setAttribute("text-anchor","middle");_.setAttribute("alignment-baseline","central");_.setAttribute("x","50%");_.setAttribute("y","70%");_.setAttribute("class","value");_.setAttribute("fill","var(--primaryText)");_.style.fontSize="".concat(this._iconSize-4,"px");this._target.appendChild(_);this._updateHeight();this._updateWidth();var d=e.querySelector(':scope > cv-address-group[operator="+"]');d?d._instance?d._instance.bind("nonZeroValues",this,"amount"):window.requestAnimationFrame((function(){d._instance.bind("nonZeroValues",t,"amount")})):this.setAmount(e.querySelectorAll(":scope > cv-address:not([target])").length);this._applyPosition();this._applyTitle(this.getTitle())},_updateRadius:function(){if(this._parentGridLayout){var t=Math.floor(Math.min(this._parentGridLayout.getCellWidth(),this._parentGridLayout.getCellHeight())/2);this.getRadius()!==t&&this._element.setAttribute("radius",""+t)}},_applyAmount:function(t){var e=this._target.querySelector("text.amount"),r=!1;if(t>1){if(!e){(e=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("text-anchor","right");e.setAttribute("alignment-baseline","central");e.setAttribute("fill","var(--primaryText)");e.classList.add("amount");e.style.fontSize="".concat(this._iconSize-5,"px");this._target.appendChild(e);this.__P_91_1()}if(5!==this._iconOffset){this._iconOffset=5;r=!0}e.textContent=t+"x"}else if(e){e.remove();if(0!==this._iconOffset){this._iconOffset=0;r=!0}}r&&this.__P_91_2()},__P_91_1:function(){var t=this._target.querySelector("text.amount");if(t){var e=this.getRadius(),r=this._iconSize/2,n=.8*e-r,i=.85*e-r;t.setAttribute("x","".concat(n));t.setAttribute("y","".concat(i))}},__P_91_2:function(){var t=this._target.querySelector("cv-icon");t&&(t.style.fontSize=this._iconSize+"px");var e=this._target.querySelector("foreignObject.icon-container");if(e){var r=this.getRadius(),n=this._iconSize/2,i=r-n+this._iconOffset,o=.6*r-n;e.setAttribute("x","".concat(i));e.setAttribute("y","".concat(o));e.setAttribute("width",this._iconSize+"");e.setAttribute("height",this._iconSize+"")}},_applyRadius:function(t){this._updateNormalizedRadius();this._iconSize=Math.round(t/2);if(this._target){this.__P_91_2();var e=this._target.querySelector(".value");e&&(e.style.fontSize="".concat(this._iconSize-4,"px"));this.__P_91_1()}if(this._svg){this.setHeight(2*t);this.setWidth(2*t)}},_applyStroke:function(t){this._updateNormalizedRadius();this._target&&this._target.setAttribute("stroke-width",t)},_updateNormalizedRadius:function(){if(this._target){var t=this.getRadius()-this.getStroke()/2;if(this.__P_91_0!==t){this.__P_91_0=t;var e=this._target.querySelector("circle.bg");e&&e.setAttribute("r",""+this.__P_91_0);var r=this._target.querySelector("circle.bar");r&&r.setAttribute("r",""+this.__P_91_0)}}},_updateValue:function(t,e){if(this._target){var r=this._target.querySelector(".value");if(r){r.textContent=t;this._debouncedDetectOverflow()}}},_applyShowProgress:function(t){if(t){var e=this._target.querySelector("circle.bar");this._target.classList.add("shows-progress");if(!e){(e=document.createElementNS("http://www.w3.org/2000/svg","circle")).classList.add("bar");e.setAttribute("r",""+this.__P_91_0);e.setAttribute("cx","50%");e.setAttribute("cy","50%");e.setAttribute("pathLength","100");e.setAttribute("stroke-dashoffset","25");e.setAttribute("stroke-dasharray","0 100");this._element.hasAttribute("foreground-color")&&(e.style.stroke=this._element.getAttribute("foreground-color"));this._target.appendChild(e)}}else{var r=this._target.querySelector("circle.bar");r&&this._target.removeChild(r);this._target.classList.remove("shows-progress")}},_applyIcon:function(t){if(this._target){var e=this._target.querySelector("cv-icon");if(t){if(!e){var r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");r.setAttribute("class","icon-container");r.style.textAlign="center";(e=document.createElement("cv-icon")).classList.add(t);e.style.fontSize=this._iconSize+"px";r.appendChild(e);this._target.appendChild(r);this.__P_91_2()}}else e&&this._target.remove(e)}},_applyProgress:function(t){if(this.isConnected()){var e=t-this.getMin(),r=Math.max(0,Math.min(100,100/(this.getMax()-this.getMin())*e)),n=this._target.querySelector(":scope > title");if(!n){n=document.createElementNS("http://www.w3.org/2000/svg","title");this._target.appendChild(n)}n.textContent=r+"%";this._target.querySelector("circle.bar").setAttribute("stroke-dasharray","".concat(r," ").concat(100-r))}},_applyStyleClass:function(t,e){var r=this._target.classList;e&&r.contains(e)&&r.remove(e);t&&r.add(t)},_detectOverflow:function(){if(this.isVisible()){var t=this._target.querySelector(".value"),e=this._target.querySelector("circle.bg").getBBox();this._queuedOverflowDetection=!1;t.clientWidth>e.width?t.classList.add("scroll"):t.classList.remove("scroll")}else this._queuedOverflowDetection=!0},onStateUpdate:function(t){if("progress"===t.detail.target){this.setProgress(t.detail.state);t.stopPropagation();return!0}return cv.ui.structure.tile.components.svg.RoundValue.superclass.prototype.onStateUpdate.call(this,t)}},defer:function(t){var e;customElements.define(cv.ui.structure.tile.Controller.PREFIX+"svg-round-value",(e=function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector),_defineProperty(e,"observedAttributes",["icon","x","y","row","column","rowspan","colspan","radius","stroke","title"]),e))}});cv.ui.structure.tile.components.svg.RoundValue.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.svg.RoundValue":{require:!0},"cv.ui.structure.tile.components.energy.MEntity":{require:!0},"cv.ui.structure.tile.components.energy.MConnectable":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.energy.PowerEntity",{extend:cv.ui.structure.tile.components.svg.RoundValue,include:[cv.ui.structure.tile.components.energy.MEntity,cv.ui.structure.tile.components.energy.MConnectable],statics:{typeSettings:{pv:{icon:"knxuf-weather_sun",styling:"tile-pv-power"},battery:{icon:"knxuf-measure_battery_100",styling:"tile-battery-power","foreground-color":"var(--batteryConsumeColor)"},grid:{icon:"knxuf-scene_power_grid",styling:"tile-grid-power"},house:{icon:"knxuf-control_building_empty"},charger:{icon:"knxuf-veh_wallbox"},heatpump:{icon:"knxuf-sani_earth_source_heat_pump"},consumer:{icon:"knxuf-measure_smart_meter"}}},members:{_applyType:function(t){var e=cv.ui.structure.tile.components.energy.PowerEntity.typeSettings[t];if(e)for(var r in e)this._element.setAttribute(r,e[r])},_init:function(){var t=this;cv.ui.structure.tile.components.energy.PowerEntity.superclass.prototype._init.call(this);var e=this._element;e.hasAttribute("id")&&this._svg.setAttribute("id",e.getAttribute("id"));e.hasAttribute("mapping")||e.setAttribute("mapping","tile-kilo-watts");this._noValue=0===e.querySelectorAll(":scope > cv-address, :scope > cv-address-group").length;this.setUseConnectionSum(this._noValue&&"house"===this.getType());if(this._noValue&&"house"!==this.getType()){var r,n=_createForOfIteratorHelper(this._svg.querySelectorAll("circle, text:not(.icon)"));try{for(n.s();!(r=n.n()).done;){r.value.remove()}}catch(t){n.e(t)}finally{n.f()}this._iconSize=32;var i=this._svg.querySelector("text.icon");i&&(i.style.fontSize=this._iconSize+"px")}window.requestAnimationFrame((function(){t._applyConnectTo(t.getConnectTo());t._applyConnectFrom(t.getConnectFrom())}));this.addListener("changeValue",this._updateDirection,this)}},defer:function(t){var e;customElements.define(cv.ui.structure.tile.Controller.PREFIX+"power-entity",(e=function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector),_defineProperty(e,"observedAttributes",["icon","type","stroke","radius","x","y","row","column","rowspan","colspan","foreground-color","connect-to","connect-from","connection-points","title"]),e))}});cv.ui.structure.tile.components.energy.PowerEntity.$$dbClassInfo=t}();function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.Address":{construct:!0,require:!0},"cv.ui.structure.tile.MStringTransforms":{require:!0},"qx.util.Function":{construct:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.AddressGroup",{extend:cv.ui.structure.tile.elements.Address,include:cv.ui.structure.tile.MStringTransforms,construct:function(t){cv.ui.structure.tile.elements.Address.constructor.call(this,t);t.hasAttribute("id")||t.setAttribute("id","address-group_".concat(cv.ui.structure.tile.elements.AddressGroup.C++));this.debouncedCalc=qx.util.Function.debounce(this._updateCalculation.bind(this),10)},statics:{C:0},events:{changeValue:"qx.event.type.Data"},properties:{operator:{check:["+","-","/","*"],init:"+",apply:"_updateCalculation"},round:{check:"Boolean",init:!1,transform:"_parseBoolean"},factor:{check:"Number",init:1,transform:"_parseFloat"},valid:{check:"Boolean",init:!0,apply:"_applyValid"},nonZeroValues:{check:"Number",init:0,event:"changeNonZeroValues"}},members:{_i:null,_values:null,__P_93_0:null,setValue:function(t){if(this.__P_93_0!==t){var e=this.__P_93_0;this.__P_93_0=t;this.fireDataEvent("changeValue",t,e);this._applyValue(t)}},getValue:function(){return this.__P_93_0},resetValue:function(){this.__P_93_0=null},getAddress:function(){return this._element.getAttribute("id")},_init:function(){var t=this,e=this._element;this._values=new Array(e.children.length).fill(0);this._stateUpdateTarget=e.parentElement;e.addEventListener("stateUpdate",(function(e){t.onStateUpdate(e);e.stopPropagation()}))},_applyValue:function(t){if(this.isConnected()){this._element.setAttribute("data-value",""+t);this.fireStateUpdate(this.getAddress(),t)}},_applyValid:function(t){this._element.setAttribute("data-valid",""+t)},_updateCalculation:function(){if(this.isConnected()){var t=0;if(this._values.length>0){this.setNonZeroValues(this._values.filter((function(t){return 0!==t})).length);switch(this.getOperator()){case"+":t=this._values.reduce((function(t,e){return t+e}),t);break;case"-":t=this._values[0];for(var e=1;e<this._values.length;e++)t-=this._values[e];break;case"*":t=this._values.reduce((function(t,e){return t*e}),t);break;case"/":t=this._values[0];for(var r=1;r<this._values.length;r++)t/=this._values[r]}}var n=!isNaN(t)&&isFinite(t);this.setValid(n);if(n){t*=this.getFactor();this.isRound()&&(t=Math.round(t));this.setValue(t)}else this.resetValue()}},onStateUpdate:function(t){var e=Array.prototype.indexOf.call(this._element.children,t.detail.source.getElement());if(e>=0){var r=t.detail.state;"string"==typeof r&&(r=parseFloat(r));if("number"==typeof r){this._values[e]=r;this.debouncedCalc()}else this.error("update value is not a number",_typeof(r),"calculation not possible")}}},defer:function(t){var e;customElements.define(cv.ui.structure.tile.Controller.PREFIX+"address-group",(e=function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector),_defineProperty(e,"observedAttributes",["round","operator","factor"]),e))}});cv.ui.structure.tile.elements.AddressGroup.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"cv.io.BackendConnections":{},"cv.data.Model":{},"cv.Config":{},"qx.log.Logger":{},"qx.locale.Manager":{},"cv.core.notifications.Router":{},"cv.TemplateEngine":{},"qx.event.message.Bus":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Backend",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,members:{_name:null,__P_94_0:null,_init:function(){var t=this,e=this._element,r=e.getAttribute("type");if(r&&r.startsWith("class:")){var n=r.split(":").pop();if(!cv.io.BackendConnections.isRegistered(n)){cv.io.BackendConnections.addClassLoadedListener(n,(function(){t._init()}));return}r=n}var i,o=e.hasAttribute("uri")?e.getAttribute("uri"):"";if(o)try{i=new URL(o,window.location.origin+window.location.pathname)}catch(t){this.error("Error parsing uri: "+o)}if(r){var a=null;e.hasAttribute("username")?a={username:e.getAttribute("username"),password:e.getAttribute("password")||""}:i&&i.username&&(a={username:i.username,password:i.password});var s,c=cv.data.Model.getInstance(),u=i?i.toString():null;switch(r){case"knxd":s="backendKnxdUrl";break;case"openhab":s="backendOpenHABUrl";break;case"mqtt":s="backendMQTTUrl"}s&&(cv.Config.URL[s]?u=cv.Config.URL[s]:!u&&cv.Config.server[s]&&(u=cv.Config.server[s]));var l=r;if(e.hasAttribute("name"))l=e.getAttribute("name");else if(cv.io.BackendConnections.hasClient("main")){if("config"===cv.io.BackendConnections.getClient("main").configuredIn){qx.log.Logger.warn(this,'there is already a backend registered with name "main" and type '.concat(r," skipping this one"));return}}else l="main";qx.log.Logger.debug(this,"init backend",l);if(cv.io.BackendConnections.hasClient(l)){var f={topic:"cv.config.error",title:qx.locale.Manager.tr("Config error"),message:qx.locale.Manager.tr('There already exists a backend named: "%1"',l),severity:"urgent",unique:!0,deletable:!0};cv.core.notifications.Router.dispatchMessage(f.topic,f);return}var p=cv.io.BackendConnections.addBackendClient(l,r,u,"config");this._client=p;this._name=l;this.__P_94_0=[];p.update=function(t){return c.updateFrom(l,t)};var h,_=_createForOfIteratorHelper(e.querySelectorAll(":scope > cv-resource"));try{for(_.s();!(h=_.n()).done;){var d=h.value;p.setResourcePath(d.getAttribute("name"),d.textContent.trim())}}catch(t){_.e(t)}finally{_.f()}p.login(!0,a,(function(){t.debug(l,"connected");e.hasAttribute("default")&&"true"===e.getAttribute("default")&&c.setDefaultBackendName(l);var r=function(){var e,r=_createForOfIteratorHelper(t.__P_94_0);try{for(r.s();!(e=r.n()).done;){var n=_slicedToArray(e.value,2),i=n[0],o=n[1];t.debug(l,"apply update",i,o);c.onUpdate(i,o,l)}}catch(t){r.e(t)}finally{r.f()}cv.io.BackendConnections.startInitialRequest(l)};cv.TemplateEngine.getInstance().isDomFinished()?r():qx.event.message.Bus.subscribe("setup.dom.finished",(function(){r()}),t)}))}else this.error("<cv-backend> must have a type attribute")},_disconnected:function(){if(this._client){var t=cv.data.Model.getInstance();this._element.hasAttribute("default")&&"true"===this._element.getAttribute("default")&&t.resetDefaultBackendName();this._client.terminate();cv.io.BackendConnections.removeClient(this._client);this._client.dispose();this._client=null}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"backend",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.elements.Backend.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"qx.io.request.Xhr":{},"cv.Config":{},"cv.Application":{},"qx.util.Request":{},"qx.locale.Manager":{},"cv.core.notifications.Router":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Loader",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,members:{_init:function(){var t,e=this._element,r=e.getAttribute("type"),n=e.getAttribute("src");if(n){switch(r){case"css":(t=document.createElement("link")).setAttribute("type","text/css");t.setAttribute("rel","stylesheet");t.setAttribute("href",n);break;case"js":(t=document.createElement("script")).setAttribute("type","text/javascript");t.setAttribute("src",n);break;case"templates":this.loadXml(n,r)}t&&e.appendChild(t)}},loadXml:function(t){var e=this,r=new qx.io.request.Xhr(t);r.set({accept:"application/xml",cache:!cv.Config.forceReload});r.addListenerOnce("success",(function(t){var e,r=t.getTarget().getResponse(),n=r,i=cv.Application.structureController.getRenderTarget();if(!n.documentElement.xmlns){var o=t.getTarget().getResponseText();o=o.replace("<templates",'<templates xmlns="http://www.w3.org/1999/xhtml"');n=(new DOMParser).parseFromString(o,"text/xml")}for(;e=n.documentElement.firstElementChild;)i.appendChild(e);cv.Application.structureController.registerTemplates(r)}));r.addListener("statusError",(function(t){var n=t.getTarget().getTransport().status;qx.util.Request.isSuccessful(n)?e.handleError(n,null):e.handleError("filenotfound",r.getUrl())}));r.send()},handleError:function(t,e){var r,n=qx.locale.Manager.tr("File Error!").translate().toString(),i="";switch(t){case"parsererror":i=qx.locale.Manager.tr("Invalid XML file!");break;case"filenotfound":i=qx.locale.Manager.tr("404: File not found, %1.",e).translate().toString();break;default:i=qx.locale.Manager.tr('Unhandled error of type "%1"',t).translate().toString();i+=e?": "+e:"."}var o={topic:"cv.error",title:n,message:i};r;cv.core.notifications.Router.dispatchMessage(o.topic,o);this.error(this,i.toString())}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"loader",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.elements.Loader.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{construct:!0,require:!0},"cv.Application":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Mapping",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,construct:function(t){cv.ui.structure.tile.elements.AbstractCustomElement.constructor.call(this,t);this.__P_95_0={}},members:{__P_95_0:null,_applyConnected:function(t,e,r){cv.ui.structure.tile.elements.Mapping.superclass.prototype._applyConnected.call(this,t,e,r);this._element.tagName.toLowerCase().endsWith("mapping")&&(t?cv.Application.structureController.addMapping(this._element.getAttribute("name"),this):cv.Application.structureController.removeMapping(this._element.getAttribute("name")))},mapValue:function(t,e,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Object.prototype.hasOwnProperty.call(this.__P_95_0,t))return this.__P_95_0[t];var o=i?"":""+t,a=this._element.querySelector(':scope > entry[value="'+t+'"]'),s=this._element.hasAttribute("type")?this._element.getAttribute("type"):"string";if(a){o=this._convert(a.innerHTML.trim(),s);this.__P_95_0[t]=o;return o}var c=this._element.querySelector(":scope > formula");if(c){if(!c._formula){var u=c.textContent;c._formula=new Function("x","store","params","let y;"+u+"; return y;")}return o=this._convert(c._formula(t,e,r),s)}var l=this._element.querySelectorAll(":scope > entry"),f=null;Array.from(l).some((function(e){var r=!1,i=e.hasAttribute("default")&&"true"===e.getAttribute("default");if(e.hasAttribute("value")){var a=e.getAttribute("value");if(a===(t||"NULL")||"*"===a){o=n._convert(e.innerHTML.trim(),s);r=!0}i&&(f=n._convert(a,s))}else if(e.hasAttribute("range-min")){var c=parseFloat(e.getAttribute("range-min")),u=e.hasAttribute("range-max")?parseFloat(e.getAttribute("range-max")):Number.POSITIVE_INFINITY,l=parseFloat(t);if(c<=l&&l<=u){o=n._convert(e.innerHTML.trim(),s);r=!0}i&&(f=c)}return r}))||null===f||(o=this.mapValue(f));this.__P_95_0[t]=o;return o},_convert:function(t,e){switch(e.toLowerCase()){case"boolean":return"true"===t;case"integer":return parseInt(t);case"float":return parseFloat(t);default:return t}}},destruct:function(){this.__P_95_0=null},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"mapping",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.elements.Mapping.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"cv.core.notifications.Router":{},"cv.ui.NotificationCenter":{},"cv.data.Model":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.StateNotification",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,members:{_init:function(){var t={},e=this._element,r=cv.core.notifications.Router.getTarget(e.getAttribute("target"))||cv.ui.NotificationCenter.getInstance(),n=e.querySelector("cv-addresses"),i={target:r,severity:e.getAttribute("severity"),skipInitial:"false"!==e.getAttribute("skip-initial"),deletable:"false"!==e.getAttribute("deletable"),unique:"true"===e.getAttribute("unique"),valueMapping:n.getAttribute("value-mapping"),addressMapping:n.getAttribute("address-mapping"),enabled:!e.hasAttribute("enabled")||"true"===e.getAttribute("enabled")};if(e.hasAttribute("id")){i.id=e.getAttribute("id");var o=cv.data.Model.getInstance();o.addUpdateListener("notification:".concat(i.id,":enabled"),this._onStateUpdate,this,"system");o.addUpdateListener("notification:".concat(i.id,":severity"),this._onStateUpdate,this,"system");o.onUpdate("notification:".concat(i.id,":enabled"),i.enabled,"system");o.onUpdate("notification:".concat(i.id,":severity"),i.severity,"system")}var a=e.getAttribute("name");a&&(i.topic="cv.state."+a);var s=e.getAttribute("icon");if(s){i.icon=s;var c=e.getAttribute("icon-classes");c&&(i.iconClasses=c)}var u=e.querySelector("cv-title-template");u&&(i.titleTemplate=u.innerHTML);var l=e.querySelector("cv-message-template");l&&(i.messageTemplate=l.innerHTML);var f,p=e.querySelector("cv-condition").textContent;"true"===p?p=!0:"false"===p&&(p=!1);i.condition=p;var h,_=_createForOfIteratorHelper(n.querySelectorAll(":scope > cv-address"));try{for(_.s();!(h=_.n()).done;){var d=h.value;f=d.textContent.trim();Object.prototype.hasOwnProperty.call(t,f)||(t[f]=[]);var y=Object.assign({},i),m=3;switch(d.getAttribute("mode")){case"disable":m=0;break;case"read":m=1;break;case"write":m=2;break;case"readwrite":m=3}y.addressConfig={transform:d.getAttribute("transform"),mode:m,selector:d.getAttribute("selector"),ignoreError:"true"===d.getAttribute("ignore-error"),qos:0|(d.getAttribute("qos")||0),retain:"true"===d.getAttribute("retain"),variantInfo:d.getAttribute("variant")};t[f].push(y)}}catch(t){_.e(t)}finally{_.f()}cv.core.notifications.Router.getInstance().registerStateUpdateHandler(t)},_onStateUpdate:function(t,e,r,n){var i=t.split(":"),o=_slicedToArray(i,3),a=o[1],s=o[2],c=cv.core.notifications.Router.getInstance();"enabled"===s?c.enableStateUpdateHandler(a,1==e):"severity"===s&&c.changeStateUpdateHandlerSeverity(a,e)}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"state-notification",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.elements.StateNotification.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.Mapping":{require:!0},"cv.Application":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Styling",{extend:cv.ui.structure.tile.elements.Mapping,members:{_applyConnected:function(t,e,r){cv.ui.structure.tile.elements.Styling.superclass.prototype._applyConnected.call(this,t,e,r);t?cv.Application.structureController.addStyling(this._element.getAttribute("name"),this):cv.Application.structureController.removeStyling(this._element.getAttribute("name"))},mapValue:function(t,e,r){return cv.ui.structure.tile.elements.Styling.superclass.prototype.mapValue.call(this,t,e,r,!0)}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"styling",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.elements.Styling.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"qx.event.Registration":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Group",{extend:cv.ui.structure.tile.components.AbstractComponent,members:{_init:function(){cv.ui.structure.tile.widgets.Group.superclass.prototype._init.call(this);var t=this._element,e=null,r=null;if(t.hasAttribute("name")||t.hasAttribute("icon")){if(!(r=t.querySelector(":scope > summary"))){r=document.createElement("summary");t.insertBefore(r,t.firstChild)}if(t.hasAttribute("name")){if(!(e=t.querySelector(":scope > summary > label.title"))){(e=document.createElement("label")).classList.add("title");r.insertBefore(e,r.firstChild)}e.classList.add("last-of-title");e.textContent=t.getAttribute("name")}if(t.hasAttribute("icon")){var n=t.querySelector(":scope > summary > cv-icon.title");if(!n){(n=document.createElement("cv-icon")).classList.add("title");r.insertBefore(n,r.firstChild)}e||n.classList.add("last-of-title");n.classList.add(t.getAttribute("icon"))}}!t.querySelector(":scope > *:not(summary)")?t.classList.add("empty"):r&&qx.event.Registration.addListener(r,"click",this._toggleOpen,this)},_toggleOpen:function(){this._element.hasAttribute("open")?this._element.removeAttribute("open"):this._element.setAttribute("open","true")},onStateUpdate:function(t){if(!cv.ui.structure.tile.widgets.Group.superclass.prototype.onStateUpdate.call(this,t))if("summary"===t.detail.target){var e=this._element.querySelector(":scope > summary > label.value");if(!e){(e=document.createElement("label")).classList.add("value");this._element.querySelector(":scope > summary").appendChild(e)}e.textContent=t.detail.state}else this.debug("unhandled address target",t.detail.target)}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"group",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.widgets.Group.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)},_wrapNativeSuper(t)}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var i=new(t.bind.apply(t,n));return r&&_setPrototypeOf(i,r.prototype),i}function _isNativeFunction(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.core.Environment":{defer:"load",require:!0},"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"qx.bom.client.Browser":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}},environment:{provided:[],required:{"browser.name":{className:"qx.bom.client.Browser"}}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Page",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{visibility:{refine:!0,init:"excluded"}},members:{_supportsContentVisibility:null,_visibleDisplayMode:null,_init:function(){var t=qx.core.Environment.get("browser.name");if(t.includes("firefox")||t.includes("safari")){this._element.classList.add("no-content-visibility");this._supportsContentVisibility=!1}else this._supportsContentVisibility=!0},_applyVisibility:function(t){switch(t){case"visible":this._supportsContentVisibility?this._element.style.contentVisibility="visible":this._visibleDisplayMode&&(this._element.style.display=this._visibleDisplayMode||"initial");break;case"hidden":case"excluded":if(this._supportsContentVisibility)this._element.style.contentVisibility="hidden";else{this._visibleDisplayMode=getComputedStyle(this._element).getPropertyValue("display");this._element.style.display="none"}}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"page",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector));customElements.define(cv.ui.structure.tile.Controller.PREFIX+"row",function(t){"use strict";function e(){var t;_classCallCheck(this,e);(t=_callSuper(this,e)).hasAttribute("colspan")&&t.classList.add("colspan-"+t.getAttribute("colspan"));t.hasAttribute("rowspan")&&t.classList.add("rowspan-"+t.getAttribute("rowspan"));return t}_inherits(e,t);return _createClass(e)}(_wrapNativeSuper(HTMLElement)))}});cv.ui.structure.tile.widgets.Page.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MPopup":{require:!0},"qx.event.Timer":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Popup",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MPopup,statics:{openedPopups:[]},members:{_closeButton:null,_init:function(){var t=this;cv.ui.structure.tile.widgets.Popup.superclass.prototype._init.call(this);var e=this._element;if(!e.hasAttribute("closeable")||"true"===e.getAttribute("closeable")){this._closeButton=document.createElement("button");this._closeButton.classList.add("close");var r=document.createElement("i");r.classList.add("ri-close-line");this._closeButton.appendChild(r);e.insertBefore(this._closeButton,e.firstChild);this._closeButton.addEventListener("click",(function(){return t.close()}))}e.addEventListener("close",(function(e){t.close()}));if(e.hasAttribute("title")){var n=document.createElement("header");e.insertBefore(n,e.firstChild);var i=document.createElement("h2");i.textContent=e.getAttribute("title");n.appendChild(i)}if(e.hasAttribute("auto-close-timeout")){var o=parseInt(e.getAttribute("auto-close-timeout"));if(isNaN(o))this.error("invalid auto-close-timeout value:",e.getAttribute("auto-close-timeout"));else{this._autoCloseTimer=new qx.event.Timer(1e3*o);this._autoCloseTimer.addListener("interval",(function(){t._autoCloseTimer.stop();t.close()}))}}},open:function(){var t=this._element;if(!t.hasAttribute("open")){t.setAttribute("open","");t.hasAttribute("modal")&&"true"===t.getAttribute("modal")&&this.registerModalPopup();this._autoCloseTimer&&this._autoCloseTimer.start()}},close:function(){var t=this._element;if(t){t.removeAttribute("open");t.hasAttribute("modal")&&"true"===t.getAttribute("modal")&&this.unregisterModalPopup();this._autoCloseTimer&&this._autoCloseTimer.stop();t.dispatchEvent(new CustomEvent("closed"))}},onStateUpdate:function(t){if(!cv.ui.structure.tile.widgets.Popup.superclass.prototype.onStateUpdate.call(this,t))switch(t.detail.target){case"open":t.detail.addressValue?t.detail.addressValue==t.detail.state&&this.open():t.detail.state&&this.open();break;case"open-close":t.detail.state?this.open():this.close();break;case"close":t.detail.state||this.close();break;default:this.debug("unhandled address target",t.detail.target)}}},destruct:function(){this._disposeObjects("_autoCloseTimer");if(this._closeButton){this._closeButton.remove();this._closeButton=null}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"popup",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.widgets.Popup.$$dbClassInfo=t}();function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MPopup":{require:!0},"qx.util.format.DateFormat":{},"qx.locale.Date":{},"qx.event.Timer":{},"qx.util.TimerManager":{},"qx.locale.Manager":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Tile",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MPopup,properties:{backgroundImage:{check:"String",nullable:!0,apply:"_applyBackgroundImage"},popup:{check:"Boolean",init:!1,apply:"_applyPopup"},outdated:{check:"Boolean",init:!1,apply:"_applyOutdated"},checkOutdated:{check:"Boolean",init:!1,apply:"_applyCheckOutdated"},outdatedMessage:{check:"String",nullable:!0,apply:"_applyOutdatedMessage"}},events:{fullscreenChanged:"qx.event.type.Data"},members:{_fullScreenMode:null,_dateFormat:null,_checkOutdatedTimerId:null,_lastUpdate:null,_maxAge:null,_hideTimer:null,_checkEnvironment:function(){cv.ui.structure.tile.widgets.Tile.superclass.prototype._checkEnvironment.call(this);var t=this._element.parentElement,e="cv-widget"===t.localName||!!document.getElementById(t.localName.substring(3));this.setWidget(e)},_init:function(){var t=this;cv.ui.structure.tile.widgets.Tile.superclass.prototype._init.call(this);this._dateFormat=new qx.util.format.DateFormat(qx.locale.Date.getDateFormat("medium")+" "+qx.locale.Date.getTimeFormat("medium"));this._initPopupChild();this._element.hasAttribute("background-image")&&this.setBackgroundImage(this._element.getAttribute("background-image"));this._childPopup&&this._childPopup.addEventListener("closed",(function(){t.resetPopup()}));this._element.querySelector(":scope > label.title")&&this._element.classList.add("has-title");this._hideTimer=new qx.event.Timer(5e3);this._hideTimer.addListener("interval",(function(){var e=t._element.querySelector(":scope > .outdated-value");"none"!==e.style.display&&(e.style.display="none");t._hideTimer.stop()}))},_applyBackgroundImage:function(t){if(t){this._element.style.backgroundImage="url(".concat(t,")");var e=this._element.querySelector(":scope > div.overlay");if(!e){(e=document.createElement("div")).classList.add("overlay");this._element.insertBefore(e,this._element.firstChild)}this._element.classList.add("has-bg-image")}else{this._element.style.backgroundImage="";this._element.classList.remove("has-bg-image")}},_applyOutdated:function(t){var e=this,r=this._element.querySelector(":scope > .outdated");if(t){this._element.classList.add("outdated");if(!r){(r=document.createElement("div")).classList.add("outdated");r.textContent="!";this._element.insertBefore(r,this._element.firstElementChild);r.addEventListener("pointerdown",(function(t){t.stopImmediatePropagation()}));r.addEventListener("click",(function(t){var n=e._element.querySelector(":scope > .outdated-value");if(n)n.style.display="block";else{(n=document.createElement("div")).classList.add("outdated-value");n.textContent=e.getOutdatedMessage();e._element.appendChild(n);e._element.insertBefore(n,r.nextElementSibling);n.addEventListener("pointerdown",(function(t){t.stopImmediatePropagation();n.style.display="none"}))}e._hideTimer.start()}))}r.style.display="block"}else{this._element.classList.remove("outdated");r&&(r.style.display="none")}},_applyOutdatedMessage:function(t){this._element.setAttribute("title",t);var e=this._element.querySelector(":scope > .outdated-value");e&&(e.textContent=t)},_applyCheckOutdated:function(t){var e=qx.util.TimerManager.getInstance();if(t)this._checkOutdatedTimerId=e.start(this.checkOutdated,5e3,this);else if(this._checkOutdatedTimerId){e.stop(this._checkOutdatedTimerId);this._checkOutdatedTimerId=null}},checkOutdated:function(){if(this._lastUpdate instanceof Date)if(isNaN(this._lastUpdate.getTime())){this.setOutdated(!0);this.setOutdatedMessage(qx.locale.Manager.tr("Last update: unknown"))}else{var t=Math.floor((Date.now()-this._lastUpdate.getTime())/1e3);this.setOutdated(t>this._maxAge);this.setOutdatedMessage(qx.locale.Manager.tr("Last update: %1",this._dateFormat.format(this._lastUpdate)))}else if("-"===this._lastUpdate){this.setOutdated(!0);this.setOutdatedMessage(qx.locale.Manager.tr("Last update: unknown"))}else{this.error("last-update value must be a Date object, but is of type:",_typeof(this._lastUpdate),this._lastUpdate);this.resetOutdatedMessage()}},open:function(){var t=this;if(this._childPopup)this._openPopupChild();else if(this._headerFooterParent){var e=this._headerFooterParent,r=e.querySelector(":scope > button.close");if(!r){(r=document.createElement("button")).classList.add("close");var n=document.createElement("i");n.classList.add("ri-close-line");r.appendChild(n);e.appendChild(r);r.addEventListener("click",(function(){return t.setPopup(!1)}))}r.style.display="block";e.classList.add("popup");if(this._fullScreenMode){e.classList.add("fullscreen");this.fireDataEvent("fullscreenChanged",!0)}this.registerModalPopup()}},close:function(t){t||this.setPopup(!1);if(this._childPopup)this._closePopupChild();else if(this._headerFooterParent){this._headerFooterParent.classList.remove("popup");if(this._fullScreenMode){this._headerFooterParent.classList.remove("fullscreen");this.fireDataEvent("fullscreenChanged",!0)}var e=this._headerFooterParent.querySelector(":scope > button.close");e&&(e.style.display="none");this.unregisterModalPopup()}this._autoCloseTimer&&this._autoCloseTimer.stop();this.fireEvent("closed")},_applyPopup:function(t){t?this.open():this.close(!0)},onStateUpdate:function(t){if(!cv.ui.structure.tile.widgets.Tile.superclass.prototype.onStateUpdate.call(this,t))switch(t.detail.target){case"background-image":this.setBackgroundImage(t.detail.state);break;case"popup":case"fullscreen-popup":this._fullScreenMode="fullscreen-popup"===t.detail.target;if(t.detail.addressValue){if(t.detail.addressValue==t.detail.state){this.setPopup(!0);if(!this._autoCloseTimer){this._autoCloseTimer=new qx.event.Timer(18e4);this._autoCloseTimer.addListener("interval",this.close,this)}this._autoCloseTimer.restart()}}else this.setPopup(1==t.detail.state);break;case"last-update":this._maxAge=t.detail.targetConfig&&t.detail.targetConfig.length>0?parseInt(t.detail.targetConfig.shift()):Number.POSITIVE_INFINITY;this._lastUpdate=t.detail.state;this.checkOutdated();break;default:this.debug("unhandled address target",t.detail.target)}},destruct:function(){this._disposeObjects("_dateFormat");if(this._checkOutdatedTimerId){qx.util.TimerManager.getInstance().stop(this._checkOutdatedTimerId);this._checkOutdatedTimerId=null}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"tile",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.widgets.Tile.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{construct:!0,require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MRefresh":{require:!0},"cv.io.rest.Client":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Web",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MRefresh],construct:function(t){cv.ui.structure.tile.components.AbstractComponent.constructor.call(this,t);this.addListener("changeVisible",this._loadContent,this)},members:{_url:null,_init:function(){var t=this._element,e=t.querySelector(":scope > iframe");if(!e){(e=document.createElement("iframe")).setAttribute("width","100%");e.setAttribute("height","100%");t.appendChild(e)}var r=t.getAttribute("src");if(r){var n=window.location.origin;"/"!==r.substring(0,1)&&"http"!==r.substring(0,4)&&(n+=window.location.pathname);this._url=new URL(r,n);this._loadContent();t.hasAttribute("refresh")&&this.setRefresh(parseInt(t.getAttribute("refresh")))}var i=t.hasAttribute("proxy")&&"true"===t.getAttribute("proxy");if(i){this._url=new URL(cv.io.rest.Client.getBaseUrl()+"/proxy",window.location.origin);this._url.searchParams.set("url",t.getAttribute("src"))}this._headers={};t.hasAttribute("auth-type")&&i&&this._url.searchParams.set("auth-type",t.getAttribute("auth-type").toLowerCase())},_loadContent:function(){if(this.isVisible()&&this._url){this._element.querySelector(":scope > iframe").src=this._url.toString()}},refresh:function(){if(this._element.querySelector(":scope > iframe")){this._url.searchParams.set("r",""+Math.random());this._loadContent()}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"web",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.widgets.Web.$$dbClassInfo=t}();function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _callSuper(t,e,r){return e=_getPrototypeOf(e),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(e,r||[],_getPrototypeOf(t).constructor):e.apply(t,r))}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.WidgetPair",{extend:cv.ui.structure.tile.components.AbstractComponent,defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"widget-pair",function(e){"use strict";function r(){_classCallCheck(this,r);return _callSuper(this,r,[t])}_inherits(r,e);return _createClass(r)}(QxConnector))}});cv.ui.structure.tile.widgets.WidgetPair.$$dbClassInfo=t}();qx.$$packageData[2]={locales:{},resources:{},translations:{en:{},de:{previous:"zurück",next:"vor","Communication error":"Kommunikationsfehler","URL: %1<br/><br/>Response:</br>%2":"URL: %1<br/><br/>Antwort:</br>%2",Hour:"Stunde",Day:"Tag",Week:"Woche",Month:"Monat",Year:"Jahr",today:"heute",yesterday:"gestern","CW %1":"KW %1","Config error":"Konfigurationsfehler",'There already exists a backend named: "%1"':'Es existiert bereits ein Backend mit dem Namen: "%1"',"File Error!":"Dateifehler!","Invalid XML file!":"Ungültige XML Datei!","404: File not found, %1.":"404: Datei nicht gefunden, %1.",'Unhandled error of type "%1"':'Unbekannter Fehler vom Typ "%1"',"Last update: unknown":"Letzte Aktualisierung: unbekannt","Last update: %1":"Letzte Aktualisierung: %1"}}};
//# sourceMappingURL=package-2.js.map