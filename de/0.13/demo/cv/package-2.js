function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}});return _setPrototypeOf(r,t)})(t)}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));r&&_setPrototypeOf(o,r.prototype);return o}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function asyncGeneratorStep(t,e,r,n,o,i,s){try{var c=t[i](s),a=c.value}catch(t){r(t);return}c.done?e(a):Promise.resolve(a).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function s(t){asyncGeneratorStep(i,n,o,s,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,s,c,"throw",t)}s(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();s=t.done;return t},e:function(t){c=!0;i=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);return"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"qx.core.Object":{construct:!0,require:!0},"cv.ui.structure.IController":{require:!0},"qx.bom.Stylesheet":{construct:!0},"qx.util.ResourceManager":{construct:!0},"cv.Config":{construct:!0},"qx.log.Logger":{defer:"runtime"},"qx.bom.History":{},"qx.event.message.Bus":{},"cv.io.BackendConnections":{},"qx.io.request.Xhr":{},"cv.TemplateEngine":{},"qx.util.Request":{},"cv.data.Model":{},"qx.locale.Manager":{},"cv.Application":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.Controller",{extend:qx.core.Object,type:"singleton",implement:cv.ui.structure.IController,construct:function(){qx.core.Object.constructor.call(this);this.__P_70_0="";qx.bom.Stylesheet.includeFile(qx.util.ResourceManager.getInstance().toUri("designs/tile-globals.scss").replace(".scss",".css")+(!0===cv.Config.forceReload?"?"+Date.now():""))},statics:{PREFIX:"cv-",__P_70_1:{},__P_70_2:{},register:function(t,e){this.__P_70_1[t]=e},onComponentCreated:function(t){var e=t.tagName.toLowerCase();if(Object.prototype.hasOwnProperty.call(this,e)){var r=this.__P_70_1[e];Object.prototype.hasOwnProperty.call(this,e)||(this.__P_70_2[e]=[]);this.__P_70_2[e].push(new r(t))}else qx.log.Logger.error(this,"no QxClass registered for custom element "+e)}},properties:{renderTarget:{check:"Element",init:document.body},namespace:{check:"String",init:""}},members:{__P_70_0:null,__P_70_3:null,__P_70_4:null,getHtmlStructure:function(){return this.__P_70_0},supports:function(t,e){return!1},initLayout:function(){},__P_70_5:function(){document.location.hash?this.scrollToPage(document.location.hash.substring(1)):this.scrollToPage(this.getInitialPageId())},onHistoryRequest:function(t){t&&this.scrollToPage(t)},scrollToPage:function(t,e){if(t){var r=document.querySelector("#"+t);if(r){if(!r.classList.contains("active")){var n,o=_createForOfIteratorHelper(document.querySelectorAll("cv-page.active"));try{for(o.s();!(n=o.n()).done;){n.value.classList.remove("active")}}catch(t){o.e(t)}finally{o.f()}var i,s=_createForOfIteratorHelper(document.querySelectorAll("cv-page.sub-active"));try{for(s.s();!(i=s.n()).done;){i.value.classList.remove("sub-active")}}catch(t){s.e(t)}finally{s.f()}r.classList.add("active");for(var c=r.parentElement;c&&"main"!==c.nodeName.toLowerCase();){"cv-page"===c.nodeName.toLowerCase()&&c.classList.add("sub-active");c=c.parentElement}if(void 0===e){var a=r.getAttribute("name"),u="CometVisu";a&&(u=a+" - "+u);qx.bom.History.getInstance().addToHistory(t,u)}qx.event.message.Bus.dispatchByName("cv.ui.structure.tile.currentPage",r)}}else this.warn("no page with id",t,"found")}},parseBackendSettings:function(t){var e=this;if(0===t.querySelectorAll("cv-backend").length){cv.io.BackendConnections.initBackendClient().login(!0,cv.Config.configSettings.credentials,function(){e.debug("logged in");cv.io.BackendConnections.startInitialRequest()})}return!1},parseSettings:function(t){var e=this;document.body.classList.add("loading-structure");var r=cv.Config.configSettings,n=t.documentElement;r.bindClickToWidget="true"===n.getAttribute("bind_click_to_widget");this.translate(t);if(!cv.Config.cacheUsed){var o=qx.util.ResourceManager.getInstance().toUri("structures/tile/templates.xml"),i=new qx.io.request.Xhr(o);i.set({accept:"application/xml",cache:!cv.Config.forceReload});i.addListenerOnce("success",function(t){var r,o=t.getTarget().getResponse(),i=e.getRenderTarget();e.debug("creating pages");e.registerTemplates(o);if(!o.documentElement.xmlns){var s=t.getTarget().getResponseText();s=s.replace("<templates",'<templates xmlns="http://www.w3.org/1999/xhtml"');o=(new DOMParser).parseFromString(s,"text/xml")}for(;r=o.documentElement.firstElementChild;)i.appendChild(r);for(;r=n.firstElementChild;)i.appendChild(r);document.body.classList.remove("loading-structure");e.debug("finalizing");qx.event.message.Bus.dispatchByName("setup.dom.append");e.debug("pages created");e.__P_70_5();e.debug("setup.dom.finished");qx.event.message.Bus.dispatchByName("setup.dom.finished.before");cv.TemplateEngine.getInstance().setDomFinished(!0)});i.addListener("statusError",function(t){var e=t.getTarget().getTransport().status;qx.util.Request.isSuccessful(e)||this.error("filenotfound",o);document.body.classList.remove("loading-structure")},this);i.send()}},registerTemplates:function(t){t.querySelectorAll("templates[structure='tile'] > template").forEach(function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+t.getAttribute("id"),function(r){"use strict";_inherits(o,e);var n=_createSuper(o);function o(){_classCallCheck(this,o);return n.call(this,t.getAttribute("id"))}return o}())})},preParse:function(t){var e=this;return _asyncToGenerator(regeneratorRuntime.mark(function r(){var n,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.documentElement.hasAttribute("theme")){n=t.documentElement.getAttribute("theme");o={};if("system"===n)if(window.matchMedia){n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";document.documentElement.setAttribute("data-theme",n);o.theme=n;cv.data.Model.getInstance().updateFrom("system",o);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(t){document.documentElement.setAttribute("data-theme",t.matches?"dark":"light");o.theme=t.matches?"dark":"light";cv.data.Model.getInstance().updateFrom("system",o)})}else e.error("system theme detection not possible in this browser");else{document.documentElement.setAttribute("data-theme",n);o.theme=n;cv.data.Model.getInstance().updateFrom("system",o)}}return r.abrupt("return",!0);case 2:case"end":return r.stop()}},r)}))()},createUI:function(t){},translate:function(t){for(var e=0,r=["name","label"];e<r.length;e++){var n,o=r[e],i=_createForOfIteratorHelper(t.querySelectorAll("*[".concat(o,'^="tr("]')));try{for(i.s();!(n=i.n()).done;){var s=n.value,c=/^tr\('([^']+)'\)$/.exec(s.getAttribute(o));if(c){var a=c[1],u=t.querySelector('cv-translations > language[name="'.concat(qx.locale.Manager.getInstance().getLanguage(),"\"] > tr[key='").concat(a,"']"));if(u)s.setAttribute(o,u.textContent.trim());else{s.setAttribute(o,a);this.warn("[".concat(qx.locale.Manager.getInstance().getLanguage(),'] no translation found for: "').concat(a,'"'))}}else this.warn("attribute content no valid translation string",s.getAttribute(o))}}catch(t){i.e(t)}finally{i.f()}}var l,f=_createForOfIteratorHelper(t.querySelectorAll('*[tr="true"]'));try{for(f.s();!(l=f.n()).done;){var p=l.value,_=p.textContent.trim(),d=t.querySelector('cv-translations > language[name="'.concat(qx.locale.Manager.getInstance().getLanguage(),"\"] > tr[key='").concat(_,"']"));d?p.textContent=d.textContent.trim():this.warn("[".concat(qx.locale.Manager.getInstance().getLanguage(),'] no translation found for: "').concat(_,'"'))}}catch(t){f.e(t)}finally{f.f()}},doScreenSave:function(){cv.Config.configSettings.screensave_page&&this.scrollToPage(cv.Config.configSettings.screensave_page)},getInitialAddresses:function(){return[]},getInitialPageId:function(){var t=document.querySelector("cv-page");return t?t.id:""},addMapping:function(t,e){this.__P_70_3||(this.__P_70_3={});this.__P_70_3[t]=e},removeMapping:function(t){this.__P_70_3&&delete this.__P_70_3[t]},mapValue:function(t,e,r){return this.__P_70_3&&Object.prototype.hasOwnProperty.call(this.__P_70_3,t)?this.__P_70_3[t].mapValue(e,r):e},addStyling:function(t,e){this.__P_70_4||(this.__P_70_4={});this.__P_70_4[t]=e},removeStyling:function(t){this.__P_70_4&&delete this.__P_70_4[t]},styleValue:function(t,e,r){return this.__P_70_4&&Object.prototype.hasOwnProperty.call(this.__P_70_4,t)?this.__P_70_4[t].mapValue(e,r):e}},defer:function(t){window.cvTestMode||(cv.Application.structureController=t.getInstance())}});var e=function(t){"use strict";_inherits(r,t);var e=_createSuper(r);function r(t){var n;_classCallCheck(this,r);n=e.call(this);var o=cv.ui.structure.tile.Controller.getInstance(),i=document.getElementById(t);if(i){var s,c=["name","replaces","parent-scope"],a=i.content.cloneNode(!0),u=_createForOfIteratorHelper(a.querySelectorAll("slot"));try{var l=function(){for(var e=s.value,r=e.getAttribute("name"),i=e.hasAttribute("replaces")?e.getAttribute("replaces"):"",u=e.hasAttribute("parent-scope")?parseInt(e.getAttribute("parent-scope")):0,l=n.querySelectorAll("[slot='".concat(r,"']")),f={},p=0,_=e.attributes.length;p<_;p++)c.includes(e.attributes[p].name)||(f[e.attributes[p].name]=e.attributes[p].value);if(l.length>0){Array.from(l).forEach(function(r){var n=r.cloneNode(!0);Object.keys(f).forEach(function(e){n.hasAttribute(e)?"class"===e?n.classList.add(f[e]):qx.log.Logger.debug(o,"["+t+"] attribute",e,"already set, skipping"):n.setAttribute(e,f[e])});n.removeAttribute("slot");e.parentNode.insertBefore(n,e)});e.remove();i&&a.querySelectorAll(i).forEach(function(t){t.remove()})}else{qx.log.Logger.debug(o,"["+t+"] no content for slot",r," removing");var d=e.parentNode;if(u>0){for(var h=u-1;h>0;){d=d.parentNode;h--}d&&d.remove()}else{e.remove();0===d.children.length&&d.remove()}}};for(u.s();!(s=u.n()).done;)l()}catch(t){u.e(t)}finally{u.f()}n.getAttributeNames().forEach(function(t){var e=n.getAttribute(t),r=a.querySelectorAll("[slot-"+t+"]"),o=t;t.endsWith("-mapping")?o="mapping":t.endsWith("-styling")?o="styling":t.endsWith("-format")&&(o="format");r.forEach(function(r){if(o!==t&&r.hasAttribute("slot-"+t)){r.setAttribute(t,e||r.getAttribute("slot-"+t));r.removeAttribute("slot-"+t)}else{r.setAttribute(o,e||r.getAttribute("slot-"+o));r.removeAttribute("slot-"+o)}});r.length>0&&n.removeAttribute(t)});a.querySelectorAll("*").forEach(function(t){_toConsumableArray(t.attributes).forEach(function(e){if(e.name.startsWith("slot-")){var r=e.name.substring(5);e.name.endsWith("-mapping")&&t.hasAttribute("slot-mapping")?r="mapping":e.name.endsWith("-styling")&&t.hasAttribute("slot-styling")?r="styling":e.name.endsWith("-format")&&t.hasAttribute("slot-format")&&(r="format");e.value&&t.setAttribute(r,e.value);t.removeAttribute(e.name)}})});n.innerHTML="";n.appendChild(a)}else qx.log.Logger.error(o,"["+t+"] no template found for id",t);return n}return r}(_wrapNativeSuper(HTMLElement));cv.ui.structure.tile.Controller.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"qx.event.Registration":{},"cv.util.Tree":{}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MPopup",{statics:{openedPopups:[]},events:{closed:"qx.event.type.Event"},members:{_childPopup:null,_initPopupChild:function(){var t=this._childPopup=this._element.querySelector(":scope > cv-popup");if(t){qx.event.Registration.addListener(this._element,"tap",this._openPopupChild,this);for(var e,r=t.parentElement;r;){if("cv-group"===r.tagName.toLowerCase())e.classList.add("has-popup");else if("cv-page"===r.tagName.toLowerCase())break;e=r;r=r.parentElement}}},_openPopupChild:function(){var t=this._element.querySelector(":scope > cv-popup:not([open])");t&&t.getInstance().open()},_closePopupChild:function(){var t=this._element.querySelector(":scope > cv-popup[open]");t&&t.getInstance().close()},registerModalPopup:function(){qx.event.Registration.addListener(document,"pointerdown",this._onPointerDown,this);var t=document.body.querySelector(".modal-popup-blocker");if(!t){(t=document.createElement("div")).classList.add("modal-popup-blocker");document.body.appendChild(t)}t.style.display="block";cv.ui.structure.tile.MPopup.openedPopups.push(this)},unregisterModalPopup:function(){qx.event.Registration.removeListener(document,"pointerdown",this._onPointerDown,this);var t=cv.ui.structure.tile.MPopup.openedPopups.indexOf(this);cv.ui.structure.tile.MPopup.openedPopups.splice(t,1);var e=document.body.querySelector(".modal-popup-blocker");e&&0===cv.ui.structure.tile.MPopup.openedPopups.length&&(e.style.display="none")},_onPointerDown:function(t){if(!cv.util.Tree.isChildOf(t.getTarget(),this._element)){this.close();t.preventDefault()}}},destruct:function(){qx.event.Registration.removeListener(this._element,"tap",this._openPopupChild,this);this._childPopup=null}});cv.ui.structure.tile.MPopup.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0},"qx.event.Timer":{}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MRefresh",{properties:{refresh:{check:"Number",init:0,apply:"_applyRefresh"}},members:{_refreshTimer:null,_lastRefresh:null,_applyRefresh:function(t){if(0===t)this._refreshTimer&&this._refreshTimer.stop();else if(this._refreshTimer)this._refreshTimer.restartWith(1e3*t);else{this._refreshTimer=new qx.event.Timer(1e3*t);this._refreshTimer.addListener("interval",this.__P_71_0,this);"function"==typeof this.isVisible?this.isVisible()&&this._refreshTimer.start():this._refreshTimer.start()}},_applyVisible:function(t){if(t)if(this._refreshTimer){this._refreshTimer.start();(!this._lastRefresh||Date.now()-this._lastRefresh>=this._refreshTimer.getInterval())&&this.__P_71_0()}else this._lastRefresh||this.__P_71_0();else this._refreshTimer&&this._refreshTimer.stop()},__P_71_0:function(){if("function"==typeof this.refresh){this.refresh();this._lastRefresh=Date.now()}else this.error("refresh method must be implemented!")}},destruct:function(){this._disposeObjects("_refreshTimer")}});cv.ui.structure.tile.MRefresh.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MResize",{construct:function(){var t=this;this._observer=new ResizeObserver(function(e,r){var n=t.getResizeTarget();e.some(function(e){if(e.target===n){t.fireDataEvent("resized",e);return!0}return!1})})},events:{resized:"qx.event.type.Data"},properties:{resizeTarget:{check:"Element",nullable:!0,apply:"_applyResizeTarget"}},members:{_observer:null,_applyResizeTarget:function(t,e){e&&this._observer.unobserve(e);t&&this._observer.observe(t)}},destruct:function(){this._observer.disconnect();this._observer=null}});cv.ui.structure.tile.MResize.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Mixin":{usage:"dynamic",require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Mixin.define("cv.ui.structure.tile.MVisibility",{construct:function(){this._observeVisibility()},statics:{observer:new IntersectionObserver(function(t,e){t.forEach(function(t){t.target._instance&&t.target._instance.setVisible(t.intersectionRatio>0)})})},properties:{visible:{check:"Boolean",init:!1,apply:"_applyVisible"}},members:{_observeVisibility:function(){this._element?cv.ui.structure.tile.MVisibility.observer.observe(this._element):this.warn("no element to observe defined")}}});cv.ui.structure.tile.MVisibility.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){e&&_defineProperties(t.prototype,e);r&&_defineProperties(t,r);return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}});return _setPrototypeOf(r,t)})(t)}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));r&&_setPrototypeOf(o,r.prototype);return o}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"qx.core.Object":{require:!0}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.AbstractCustomElement",{extend:qx.core.Object,type:"abstract",construct:function(t){this._element=t},properties:{connected:{check:"Boolean",init:!1,apply:"_applyConnected",event:"changeConnected"}},members:{_element:null,_initialized:!1,_applyConnected:function(t){if(t&&!this._initialized){this._init();this._initialized=!0}else{this._disconnected();this._initialized=!1}},_init:function(){},_disconnected:function(){},getElement:function(){return this._element}},destruct:function(){this._element=null}});var e=function(t){"use strict";_inherits(r,t);var e=_createSuper(r);function r(t){var n;_classCallCheck(this,r);n=e.call(this);if(!qx.Class.isSubClassOf(t,cv.ui.structure.tile.elements.AbstractCustomElement))throw Error(t+" must be a subclass of cv.ui.structure.tile.elements.AbstractCustomElement");n._instance=new t(_assertThisInitialized(n));n.hasAttribute("colspan")&&n.classList.add("colspan-"+n.getAttribute("colspan"));n.hasAttribute("rowspan")&&n.classList.add("rowspan-"+n.getAttribute("rowspan"));return n}_createClass(r,[{key:"getInstance",value:function(){return this._instance}},{key:"connectedCallback",value:function(){this._instance&&this._instance.setConnected(!0)}},{key:"disconnectedCallback",value:function(){this._instance&&this._instance.setConnected(!1)}},{key:"attributeChangedCallback",value:function(t,e,r){this._instance&&qx.Class.hasProperty(this._instance.constructor,t)&&this._instance.set(t,r)}}]);return r}(_wrapNativeSuper(HTMLElement));window.QxConnector=e;cv.ui.structure.tile.elements.AbstractCustomElement.$$dbClassInfo=t}();!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"cv.Application":{},"cv.util.String":{}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.AbstractComponent",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,type:"abstract",properties:{value:{apply:"_applyValue",init:null},styleClass:{check:"String",nullable:!0,apply:"_applyStyleClass"},enabled:{check:"Boolean",init:!0,apply:"_applyEnabled"},visibility:{check:["visible","excluded","hidden"],init:"visible",apply:"_applyVisibility",event:"changeVisibility"}},members:{_writeAddresses:null,_visibleDisplayMode:null,_init:function(){var t=this,e=this._element,r=!1,n=[];Array.prototype.forEach.call(e.querySelectorAll(":scope > cv-address"),function(t){switch(t.hasAttribute("mode")?t.getAttribute("mode"):"readwrite"){case"readwrite":r=!0;n.push(t);break;case"read":r=!0;break;case"write":n.push(t)}});this._writeAddresses=n;r&&e.addEventListener("stateUpdate",function(e){t.onStateUpdate(e);e.stopPropagation()})},_applyValue:function(t){if(this.isConnected()){this._element.setAttribute("value",t||"");var e=t;this._element.hasAttribute("mapping")&&(e=cv.Application.structureController.mapValue(this._element.getAttribute("mapping"),t));this._element.hasAttribute("format")&&(e=cv.util.String.sprintf(this._element.getAttribute("format"),e instanceof Date?e.toLocaleString():e));this._updateValue(e,t);if(this._element.hasAttribute("styling")){var r=cv.Application.structureController.styleValue(this._element.getAttribute("styling"),t);this.setStyleClass(r)}}},_updateValue:function(t,e){},_applyStyleClass:function(t,e){var r=this._element.classList;if(e)if(r.contains(e))r.replace(e,t);else{r.add(t);r.remove(e)}else t&&r.add(t)},_applyEnabled:function(t){var e=this._element.querySelector(":scope > .blocker");if(!e){(e=document.createElement("div")).classList.add("blocker");this._element.appendChild(e);e.addEventListener("click",function(t){t.preventDefault();t.stopPropagation()});e.addEventListener("pointerdown",function(t){t.preventDefault();t.stopPropagation()});e.addEventListener("pointerup",function(t){t.preventDefault();t.stopPropagation()})}this._element.setAttribute("disabled",!1===t?"true":"false");e.style.display=!0===t?"none":"block"},_applyVisibility:function(t,e){"hidden"===e&&(this._element.style.opacity="1.0");switch(t){case"visible":this._visibleDisplayMode&&(this._element.style.display=this._visibleDisplayMode||"initial");break;case"hidden":this._element.style.opacity="0";break;case"excluded":this._visibleDisplayMode=getComputedStyle(this._element).getPropertyValue("display");this._element.style.display="none"}},onStateUpdate:function(t){switch(t.detail.target){case"enabled":this.setEnabled(t.detail.state);t.stopPropagation();return!0;case"show-exclude":this.setVisibility(t.detail.state?"visible":"excluded");t.stopPropagation();return!0;case"show-hide":this.setVisibility(t.detail.state?"visible":"hidden");t.stopPropagation();return!0;case"":this.setValue(t.detail.state);t.stopPropagation();return!0}return!1}}});cv.ui.structure.tile.components.AbstractComponent.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{construct:!0,require:!0},"qx.event.Timer":{},"cv.Application":{},"cv.ui.structure.tile.elements.Address":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Button",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,construct:function(t){cv.ui.structure.tile.elements.AbstractCustomElement.constructor.call(this,t);this.__P_72_0=new Map},properties:{type:{check:["button","trigger","push"],init:"button"},on:{check:"Boolean",init:!1,apply:"_applyOn"},onClass:{check:"String",init:"active"},offClass:{check:"String",init:"inactive"},onValue:{check:"String",init:"1"},offValue:{check:"String",init:"0"},styleClass:{check:"String",nullable:!0,apply:"_applyStyleClass"},name:{check:"String",init:"",apply:"_applyName"},progress:{check:"Number",init:-1,apply:"_applyProgress",transform:"_parseInt"}},members:{_writeAddresses:null,__P_72_1:null,__P_72_2:null,__P_72_0:null,_parseInt:function(t){var e=parseInt(t);return Number.isNaN(e)?0:e},_init:function(){var t=this,e=this._element;e.hasAttribute("type")&&this.setType(e.getAttribute("type"));e.hasAttribute("name")&&this.setName(e.getAttribute("name"));e.hasAttribute("progress")&&this.setProgress(e.getAttribute("progress"));e.hasAttribute("on-value")&&this.setOnValue(e.getAttribute("on-value"));e.hasAttribute("off-value")&&this.setOffValue(e.getAttribute("off-value"));var r=!1,n=[];Array.prototype.forEach.call(e.querySelectorAll(":scope > cv-address"),function(t){switch(t.hasAttribute("mode")?t.getAttribute("mode"):"readwrite"){case"readwrite":r=!0;n.push(t);break;case"read":r=!0;break;case"write":n.push(t)}});this._writeAddresses=n;if(n.length>0){var o={},i=e;if("true"===e.getAttribute("whole-tile"))for(var s=e.parentElement,c=0;c<=2;){s=s.parentElement;c++;"cv-tile"===s.tagName.toLowerCase()&&(i=s).classList.add("clickable")}n.forEach(function(e){switch(e.hasAttribute("on")?e.getAttribute("on"):"click"){case"click":o.click=t.onClicked.bind(t);break;case"up":o.pointerup=t.onPointerUp.bind(t);break;case"down":o.pointerdown=t.onPointerDown.bind(t)}});Object.getOwnPropertyNames(o).forEach(function(t){return i.addEventListener(t,function(e){o[t](e)})})}if(r)e.addEventListener("stateUpdate",function(e){t.onStateUpdate(e);e.stopPropagation()});else if(e.hasAttribute("mapping")||e.hasAttribute("styling")){var a=n.filter(function(t){return t.hasAttribute("value")&&!t.hasAttribute("on")});if(1===a.length){var u=a[0].getAttribute("value");qx.event.Timer.once(function(){t.setOn(u==t.getOnValue())},this,1e3)}}if(r||1!==n.filter(function(t){return t.hasAttribute("value")&&!t.hasAttribute("on")}).length){var l=!1,f=!1;n.some(function(t){if(t.hasAttribute("value")&&t.hasAttribute("on")){l||(l="down"===t.getAttribute("on"));f||(f="up"===t.getAttribute("on"))}return f&&l});f&&l&&this.setType("push")}else this.setType("trigger")},_initProgress:function(){var t=this._element;this.__P_72_2=100*Math.PI;var e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 100 100");e.setAttribute("type","circle");var r=document.createElementNS("http://www.w3.org/2000/svg","circle");r.classList.add("bar");r.setAttribute("r","49");r.setAttribute("cx","50");r.setAttribute("cy","50");r.setAttribute("stroke-width","2");r.setAttribute("stroke-dasharray",this.__P_72_2+" "+this.__P_72_2);r.setAttribute("stroke-dashoffset",""+this.__P_72_2);e.appendChild(r);t.appendChild(e);t.classList.add("progress")},_applyConnected:function(t){cv.ui.structure.tile.components.Button.superclass.prototype._applyConnected.call(this,t);t&&"trigger"!==this.getType()&&qx.event.Timer.once(this._applyOn,this,1e3)},_applyOn:function(){if(this.isConnected()){var t=this.isOn()?this.getOnValue():this.getOffValue();this._element.setAttribute("value",t||"");var e=t;this._element.hasAttribute("mapping")&&(e=cv.Application.structureController.mapValue(this._element.getAttribute("mapping"),t,this.__P_72_0));var r=this._element.querySelector(".value");r&&"cv-icon"===r.tagName.toLowerCase()?r._instance?r._instance.setId(e):r.textContent=e:this.updateValue(e);var n=this.isOn()?this.getOnClass():this.getOffClass();this._element.hasAttribute("styling")&&(n=cv.Application.structureController.styleValue(this._element.getAttribute("styling"),t,this.__P_72_0));this.setStyleClass(n)}},_applyProgress:function(t){var e=this._element.querySelector(":scope > svg > circle.bar");if(!e){this._initProgress();e=this._element.querySelector(":scope > svg > circle.bar")}if(e){this._element.hasAttribute("progress-mapping")&&(t=cv.Application.structureController.mapValue(this._element.getAttribute("progress-mapping"),t,this.__P_72_0));e.setAttribute("stroke-dashoffset",""+(this.__P_72_2-t/100*this.__P_72_2))}},_applyStyleClass:function(t,e){var r=this._element.classList;if(e)if(r.contains(e))r.replace(e,t);else{r.add(t);r.remove(e)}else t&&r.add(t)},_applyName:function(t){if(!this.__P_72_1){this.__P_72_1=document.createElement("label");this.__P_72_1.classList.add("button-label");this._element.appendChild(this.__P_72_1)}this.__P_72_1.textContent=t},updateValue:function(t){var e=this._element.querySelector("span.value");e&&(e.innerHTML=t)},onStateUpdate:function(t){var e=t.detail.state==this.getOnValue(),r=t.detail.target||"default";if(t.detail.source instanceof cv.ui.structure.tile.elements.Address){var n=t.detail.source.getElement();n.hasAttribute("value")&&(e=t.detail.state==n.getAttribute("value"))}"default"===r?this.setOn(e):"progress"===r?this.setProgress(t.detail.state):r.startsWith("store:")&&this.__P_72_0.set(r.substring(6),t.detail.state)},onClicked:function(t){var e=this;this.createRipple(t);this._writeAddresses||(this._writeAddresses=Array.prototype.filter.call(this._element.querySelectorAll("addresses > cv-address"),function(t){return!t.hasAttribute("mode")||"read"!==t.getAttribute("mode")}));var r=new CustomEvent("sendState",{detail:{value:this.isOn()?this.getOffValue():this.getOnValue(),source:this}});if("trigger"===this.getType()){this.setOn(!0);qx.event.Timer.once(function(){e.setOn(!1)},null,250)}this._writeAddresses.filter(function(t){return!t.hasAttribute("on")||"click"===t.getAttribute("on")}).forEach(function(t){return t.dispatchEvent(r)});t.stopPropagation()},onPointerDown:function(){var t=this;this._writeAddresses.filter(function(t){return"down"===t.getAttribute("on")&&t.hasAttribute("value")}).forEach(function(e){e.dispatchEvent(new CustomEvent("sendState",{detail:{value:e.getAttribute("value"),source:t}}))})},onPointerUp:function(){var t=this;this._writeAddresses.filter(function(t){return"up"===t.getAttribute("on")&&t.hasAttribute("value")}).forEach(function(e){e.dispatchEvent(new CustomEvent("sendState",{detail:{value:e.getAttribute("value"),source:t}}))})},createRipple:function(t){var e=t.currentTarget,r=e.querySelector(":scope .ripple-container");if(!r){(r=document.createElement("div")).classList.add("ripple-container");e.appendChild(r)}var n=document.createElement("span"),o=Math.max(e.clientWidth,e.clientHeight),i=o/2;n.style.width=n.style.height="".concat(o,"px");var s=t.clientX-(e.offsetLeft+i),c=t.clientY-(e.offsetTop+i);if(e===this._element){s-=e.offsetParent.offsetLeft;c-=e.offsetParent.offsetTop}n.style.left="".concat(s,"px");n.style.top="".concat(c,"px");n.classList.add("ripple");r.querySelectorAll(".ripple").forEach(function(t){return t.remove()});r.appendChild(n)}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"button",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Button.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"cv.data.Model":{},"cv.ui.structure.tile.components.Button":{},"cv.Transform":{},"qx.event.Timer":{},"cv.io.BackendConnections":{},"cv.Application":{},"cv.util.String":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Address",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,members:{__P_81_0:null,__P_81_1:null,_init:function(){var t=this,e=this._element,r=e.textContent.trim();if(r){var n=cv.data.Model.getInstance(),o=e.getAttribute("backend");n.addAddress(r,e.getAttribute("id"),o);var i=e.hasAttribute("mode")?e.getAttribute("mode"):"readwrite";if("write"!==i){var s=n.getState(r,o);void 0!==s&&this.fireStateUpdate(r,s);n.addUpdateListener(r,this.fireStateUpdate,this,o)}"read"!==i&&e.addEventListener("sendState",function(r){var n=null;Object.prototype.hasOwnProperty.call(r.detail,"value")&&(n=r.detail.value);e.hasAttribute("value")&&(n=e.getAttribute("value"));var i=r.detail.source&&r.detail.source instanceof cv.ui.structure.tile.components.Button&&("trigger"===r.detail.source.getType()||"push"===r.detail.source.getType());if(null!==n){var s=e.getAttribute("transform")||"raw",c=cv.Transform.encodeBusAndRaw({transform:s},n);if(i||!Object.prototype.hasOwnProperty.call(e,"lastSentValue")||c.raw!==e.lastSentValue)if(e.hasAttribute("delay")){var a=parseInt(e.getAttribute("delay"));t.debug("send with delay of ".concat(a,"ms"));qx.event.Timer.once(function(){cv.io.BackendConnections.getClient(o).write(e.textContent,c.bus,e);i||(e.lastSentValue=c.raw)},t,a)}else{cv.io.BackendConnections.getClient(o).write(e.textContent,c.bus,e);i||(e.lastSentValue=c.raw)}}})}},fireStateUpdate:function(t,e){if(this.__P_81_0!==e||"always"===this._element.getAttribute("send-mode")){var r=this._element.getAttribute("transform")||"raw",n=cv.Transform.decode({transform:r},e),o="";if(this._element.hasAttribute("mapping")){o=this._element.getAttribute("mapping");n=cv.Application.structureController.mapValue(o,n)}this._element.hasAttribute("format")&&(n=cv.util.String.sprintf(this._element.getAttribute("format"),n instanceof Date?n.toLocaleString():n));var i=new CustomEvent("stateUpdate",{bubbles:!0,cancelable:!0,detail:{address:this._element.textContent.trim(),state:n,target:this._element.getAttribute("target")||"",raw:e,mapping:o,addressValue:this._element.hasAttribute("value")?this._element.getAttribute("value"):null,source:this,variant:this._element.hasAttribute("variant")?this._element.getAttribute("variant"):null}});this.__P_81_1=n;this._element.dispatchEvent(i);this.__P_81_0=e;e!==this._element.lastSentValue&&(this._element.lastSentValue=null)}},getValue:function(){return this.__P_81_1}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"address",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.elements.Address.$$dbClassInfo=t}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,o=!1,i=void 0;try{for(var s,c=t[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){r.push(s.value);if(e&&r.length===e)break}}catch(t){o=!0;i=t}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();s=t.done;return t},e:function(t){c=!0;i=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);return"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function asyncGeneratorStep(t,e,r,n,o,i,s){try{var c=t[i](s),a=c.value}catch(t){r(t);return}c.done?e(a):Promise.resolve(a).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function s(t){asyncGeneratorStep(i,n,o,s,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,s,c,"throw",t)}s(void 0)})}}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.util.ScriptLoader":{},"qx.util.ResourceManager":{},"qx.event.Timer":{},"qx.locale.Manager":{},"cv.io.BackendConnections":{},"cv.io.Fetch":{},"cv.util.String":{},"cv.core.notifications.Router":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Chart",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MVisibility,statics:{JS_LOADED:new Promise(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r){var n,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=function(){return"object"===_typeof(window.d3)};t.next=3;return cv.util.ScriptLoader.includeScript(qx.util.ResourceManager.getInstance().toUri("libs/d3.min.js"));case 3:if(n())e(!0);else{o=new qx.event.Timer(50);i=0;o.addListener("interval",function(){i++;n()?e(!0):i>5&&r(new Error("Error loaded d3 library"))})}case 4:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}()).then(function(){if("de"===qx.locale.Manager.getInstance().getLanguage()){d3.formatDefaultLocale({decimal:",",thousands:".",grouping:[3],currency:["€",""]});d3.timeFormatDefaultLocale({dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]})}}),CONFIG:null},properties:{type:{check:["axis-mixed","bar","line","scatter","pie","percentage"],init:"line"}},members:{_downloadedImage:null,_url:null,_headers:null,_request:null,_chart:null,_width:null,_height:null,_loaded:null,_dataSetConfigs:null,_init:function(){var t=this;return _asyncToGenerator(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(r=t._element).hasAttribute("type")&&t.setType(r.getAttribute("type"));e.next=4;return cv.ui.structure.tile.components.Chart.JS_LOADED;case 4:t.isVisible()&&t._loadData();case 5:case"end":return e.stop()}},e)}))()},_applyVisible:function(t){t&&"object"===_typeof(window.d3)&&this._loadData()},_loadData:function(){var t=this;if(!(this._loaded&&Date.now()-this._loaded<3e5)){var e,r=cv.io.BackendConnections.getClient(),n=this._element.querySelectorAll(":scope > dataset"),o=[];this._dataSetConfigs={};var i,s=_createForOfIteratorHelper(n);try{var c=function(){for(var n=i.value,s={showArea:!0,color:"#FF9900",type:n.getAttribute("type")||"line",start:"end-1day",end:"now",xFormat:t._element.getAttribute("x-format")||"%H:%M",xTicks:d3.timeHour.every(4)},c=void 0,a=void 0,u=void 0,l=0;l<n.attributes.length;l++){a=(c=n.attributes.item(l)).name.split("-").map(function(t,e){return e>0?"".concat(t.substring(0,1).toUpperCase()).concat(t.substring(1)):t}).join("");u=c.value;if("series"===a)switch(u){case"hour":s.xTicks=d3.timeMinute.every(5);s.start="end-1"+u;break;case"day":s.xTicks=d3.timeHour.every(4);s.start="end-1"+u;break;case"week":s.xTicks=d3.timeDay.every(1);s.start="end-1"+u;break;case"month":s.xTicks=d3.timeDay.every(5);s.start="end-1"+u;break;case"year":s.xTicks=d3.timeDay.every(31);s.start="end-1"+u}else{"true"===u||"false"===u?u="true"===u:/^\d+$/.test(u)?u=parseInt(u):/^[\d.]+$/.test(u)&&(u=parseFloat(u));s[a]=u}}var f=new Date;f.setTime(f.getTime()-864e5);if(!(e=r.getResourcePath("charts",{src:s.src,start:s.start,end:s.end})))return"continue";t._dataSetConfigs[s.src]=s;o.push(cv.io.Fetch.fetch(e,null,!1,r).then(function(t){r.hasCustomChartsDataProcessor(t)&&(t=r.processChartsData(t,s));return{data:t,ts:s}}).catch(function(r){t._onStatusError(s,e,r)}))};for(s.s();!(i=s.n()).done;)c()}catch(t){s.e(t)}finally{s.f()}Promise.all(o).then(function(e){t._onSuccess(e)})}},_onSuccess:function(t){var e=this;if(this.isVisible()){var r,n=[],o=_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){var i=r.value,s=i.data;if(null!==s){var c,a=_createForOfIteratorHelper(s);try{for(a.s();!(c=a.n()).done;){var u=_slicedToArray(c.value,2),l=u[0],f=u[1];n.push({src:i.ts.src,time:l,value:f})}}catch(t){a.e(t)}finally{a.f()}}}}catch(t){o.e(t)}finally{o.f()}var p=d3.min(n,function(t){return+t.value}),_=d3.max(n,function(t){return+t.value})+1;p>1&&(p-=1);var d=this._element.hasAttribute("y-format")?this._element.getAttribute("y-format"):"%s";this._chart=this._lineChart(n,{x:function(t){return t.time},y:function(t){return t.value},z:function(t){return t.src},color:function(t){return t&&e._dataSetConfigs[t].color},title:function(t){return cv.util.String.sprintf(d,t.value)},xDomain:d3.extent(n,function(t){return t.time}),yDomain:[p,_],showArea:function(t){return e._dataSetConfigs[t].showArea},mixBlendMode:"normal",xFormat:this.multiTimeFormat([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%H:%M",function(t){return t.getMinutes()}],["%H",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!==t.getDate()}],["%b %d",function(t){return 1!==t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",function(){return!0}]])});this._loaded=Date.now()}},multiTimeFormat:function(t){return function(e){return d3.timeFormat(function(e){for(var r=0,n=!1,o="%c";!n&&r<t.length;){(n=t[r][1](e))&&(o=t[r][0]);r++}return o}(e))(e)}},_onStatusError:function(t,e,r){cv.core.notifications.Router.dispatchMessage("cv.charts.error",{title:qx.locale.Manager.tr("Communication error"),severity:"urgent",message:qx.locale.Manager.tr("URL: %1<br/><br/>Response:</br>%2",JSON.stringify(e),r)});this.error("Chart _onStatusError",t,e,r)},_lineChart:function(t,e){cv.ui.structure.tile.components.Chart.CONFIG||(cv.ui.structure.tile.components.Chart.CONFIG={x:function(t){return t[0]},y:function(t){return t[1]},z:function(){return 1},title:void 0,defined:void 0,curve:d3.curveLinear,marginTop:24,marginRight:24,marginBottom:24,marginLeft:30,width:392,height:192,xType:d3.scaleTime,xDomain:void 0,xRange:void 0,xFormat:void 0,yType:d3.scaleLinear,yDomain:void 0,yRange:void 0,yFormat:void 0,yLabel:void 0,zDomain:void 0,color:"currentColor",strokeLinecap:void 0,strokeLinejoin:void 0,strokeWidth:1.5,strokeOpacity:void 0,mixBlendMode:"multiply",showArea:void 0,xPadding:.1});var r=Object.assign({},cv.ui.structure.tile.components.Chart.CONFIG,e);r.xRange=[r.marginLeft,r.width-r.marginRight];r.yRange=[r.height-r.marginBottom,r.marginTop];var n=d3.map(t,r.x),o=d3.map(t,r.y),i=d3.map(t,r.z),s=d3.map(t,function(t){return t});void 0===r.defined&&(r.defined=function(t,e){return!isNaN(n[e])&&!isNaN(o[e])});void 0===r.xDomain&&(r.xDomain=d3.extent(n));void 0===r.yDomain&&(r.yDomain=[0,d3.max(o,function(t){return"string"==typeof t?+t:t})]);void 0===r.zDomain&&(r.zDomain=i);r.zDomain=new d3.InternSet(r.zDomain);var c,a=d3.range(n.length).filter(function(t){return r.zDomain.has(i[t])}),u=r.xType(r.xDomain,r.xRange),l=r.yType(r.yDomain,r.yRange),f=d3.axisBottom(u).ticks(r.width/80).tickSizeOuter(0).tickFormat(r.xFormat),p=d3.axisLeft(l).ticks(r.height/60,r.yFormat),_=void 0===r.title?i:null===r.title?null:d3.map(t,r.title);d3.select(this._element).select("svg").remove();var d=d3.select(this._element).append("svg").attr("width",r.width).attr("height",r.height).attr("viewBox",[0,0,r.width,r.height]).attr("style","max-width: 100%; height: auto; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").on("pointerenter",function(){O.attr("display",null)}).on("pointermove",function(t){var e=d3.pointer(t),r=_slicedToArray(e,2),i=r[0],c=r[1],f=d3.least(a,function(t){return Math.hypot(u(n[t])-i,l(o[t])-c)});O.attr("transform","translate(".concat(u(n[f]),",").concat(l(o[f]),")"));_&&O.select("text").text(_[f]);d.property("value",s[f]).dispatch("input",{bubbles:!0})}).on("pointerleave",function(){O.attr("display","none");d.node().value=null;d.dispatch("input",{bubbles:!0})}).on("touchmove",function(t){var e=t.targetTouches[0].clientY;if(c){var r=c.node().getBoundingClientRect();e>r.y&&e<r.y+r.height&&t.preventDefault()}},{passive:!1});d.append("g").attr("transform","translate(0,".concat(r.height-r.marginBottom,")")).call(f);d.append("g").attr("transform","translate(".concat(r.marginLeft,",0)")).call(p).call(function(t){return t.select(".domain").remove()}).call(function(t){return t.append("text").attr("x",-r.marginLeft).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(r.yLabel)});var h,y=new Map,m=new Map,b=new Map,v=_createForOfIteratorHelper(a);try{for(v.s();!(h=v.n()).done;){var g=h.value,C=i[g];if("function"==typeof r.showArea&&r.showArea(C)){m.has(C)||m.set(C,[]);m.get(C).push(g)}switch(this._dataSetConfigs[C].type){case"line":y.has(C)||y.set(C,[]);y.get(C).push(g);break;case"bar":b.has(C)||b.set(C,[]);b.get(C).push(g)}}}catch(t){v.e(t)}finally{v.f()}if(y.size>0){var P=d3.line().curve(r.curve).x(function(t){return u(n[t])}).y(function(t){return l(o[t])});c=d.append("g").attr("fill","none").attr("stroke","string"==typeof r.color?r.color:null).attr("stroke-linecap",r.strokeLinecap).attr("stroke-linejoin",r.strokeLinejoin).attr("stroke-width",r.strokeWidth).attr("stroke-opacity",r.strokeOpacity).selectAll("path").data(y).join("path").style("mix-blend-mode",r.mixBlendMode).attr("stroke","function"==typeof r.color?function(t){return r.color(t[0])}:null).attr("d",function(t){return P(t[1])})}if(m.size>0){var w=d3.area().curve(r.curve).x(function(t){return u(n[t])}).y0(function(){return r.yRange[0]}).y1(function(t){return l(o[t])});d.append("g").attr("stroke","none").attr("fill","string"==typeof r.color?r.color+"30":null).selectAll("path").data(m).join("path").style("mix-blend-mode",r.mixBlendMode).attr("fill","function"==typeof r.color?function(t){return r.color(t[0])+"30"}:null).attr("d",function(t){return w(t[1])})}if(b.size>0){var S=d3.scaleBand().domain(n).range(r.xRange).padding(r.xPadding);d.append("g").selectAll("g").data(b).join("g").attr("fill","function"==typeof r.color?function(t){return r.color(t[0])+"30"}:null).selectAll("rect").data(function(t){return t[1].map(function(e){return{key:t[0],value:e}})}).join("rect").attr("x",function(t){return S(n[t.value])}).attr("y",function(t){return l(o[t.value])}).attr("height",function(t){return r.yRange[0]-l(o[t.value])}).attr("width",S.bandwidth())}var O=d.append("g").attr("display","none").attr("fill","currentColor");O.append("circle").attr("r",2.5);O.append("text").attr("font-family","sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("y",-8);return Object.assign(d.node(),{value:null})}},destruct:function(){this._chart=null},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"chart",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Chart.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.util.Function":{},"qx.util.ColorUtil":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Color",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{throttleInterval:{check:"Number",init:250,apply:"_applyThrottleInterval"}},members:{__P_73_0:null,_init:function(){var t=this;cv.ui.structure.tile.components.Color.superclass.prototype._init.call(this);var e=this._element;e.hasAttribute("throttle-interval")?this.setThrottleInterval(parseInt(e.getAttribute("throttle-interval"))):this._applyThrottleInterval(this.getThrottleInterval());var r=e.querySelector(":scope > input");if(!r){(r=document.createElement("input")).setAttribute("type","color");e.appendChild(r);r.oninput=function(){return t.__P_73_1.call()}}this.__P_73_0=r},_applyThrottleInterval:function(t){var e=this;this.__P_73_1=t>0?cv.util.Function.throttle(this.onInput,t,{trailing:!0},this):{call:function(){return e.onInput()},abort:function(){}}},onInput:function(){this.__P_73_2(this.__P_73_0.value)},_updateValue:function(t,e){var r=this._element.querySelector(":scope > .value"),n=t.substring(0,7);if(r){var o=r.tagName.toLowerCase(),i=9===t.length?parseInt(t.substring(7,9),16)/255:1;switch(o){case"cv-icon":r.style.color=n;r.style.opacity=Math.max(i,.05)}}this._element.querySelector(":scope > input").value=n;r||(this._element.style.backgroundColor=t)},onStateUpdate:function(t){var e=!1;t.detail.target&&(e=cv.ui.structure.tile.components.Color.superclass.prototype.onStateUpdate.call(this,t));if(!e){var r,n=t.detail.state,o="";switch(t.detail.variant){case"hsv":r=qx.util.ColorUtil.hsbToRgb([n.get("h"),n.get("s"),100]);o=Math.round(n.get("v")/100*255).toString(16).padStart(2,"0");this.setValue("#".concat(r[0].toString(16).padStart(2,"0")).concat(r[1].toString(16).padStart(2,"0")).concat(r[2].toString(16).padStart(2,"0")).concat(o))}}},__P_73_2:function(t){var e=qx.util.ColorUtil.rgbToHsb([parseInt(t.substring(1,3),16),parseInt(t.substring(3,5),16),parseInt(t.substring(5,7),16)]),r=new Map([["h",e[0]],["s",e[1]],["v",e[2]]]),n=new CustomEvent("sendState",{detail:{value:r,source:this}});this._writeAddresses.filter(function(t){return"hsv"===t.getAttribute("variant")}).forEach(function(t){return t.dispatchEvent(n)})}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"color",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Color.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){e&&_defineProperties(t.prototype,e);r&&_defineProperties(t,r);return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();s=t.done;return t},e:function(t){c=!0;i=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);return"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{construct:!0,require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Icon",{extend:cv.ui.structure.tile.components.AbstractComponent,construct:function(t){cv.ui.structure.tile.components.AbstractComponent.constructor.call(this,t);this._idRegex=/^[^\s]+$/},properties:{id:{check:"String",nullable:!0,apply:"_applyId",transform:"_transformId"},color:{check:"String",nullable:!0,apply:"_applyColor"}},members:{__P_74_0:!1,_idRegex:null,_transformId:function(t){if(this._idRegex.test(t))return t;this.error("invalid icon id:",t);return null},_init:function(){cv.ui.structure.tile.components.Icon.superclass.prototype._init.call(this);var t=this._element;if(t.textContent.trim()){this.__P_74_0=!0;this.setId(t.textContent.trim())}else{var e,r=t.classList.values(),n=_createForOfIteratorHelper(r);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.startsWith("ri-")||o.startsWith("knxuf-")){this.setId(o);break}}}catch(t){n.e(t)}finally{n.f()}}this.__P_74_0=!0},_applyId:function(t,e){var r=this._element;if(this.__P_74_0){e&&r.classList.remove(e);if(t){r.classList.add(t);r.textContent&&(r.textContent="")}}},_applyColor:function(t,e){var r=this._element;e&&r.classList.remove(e);t&&r.classList.add(t)}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"icon",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}_createClass(n,null,[{key:"observedAttributes",get:function(){return["color"]}}]);return n}(QxConnector))}});cv.ui.structure.tile.components.Icon.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MRefresh":{require:!0},"cv.io.rest.Client":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Image",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MRefresh],members:{_downloadedImage:null,_url:null,_headers:null,_request:null,_init:function(){var t=this,e=this._element,r=e.querySelector(":scope > img");if(!r){r=document.createElement("img");e.appendChild(r)}e.addEventListener("click",function(){return t.refresh()});var n=e.getAttribute("src"),o=window.location.origin;"/"!==n.substring(0,1)&&"http"!==n.substring(0,4)&&(o+=window.location.pathname);this._url=new URL(n,o);var i=e.hasAttribute("proxy")&&"true"===e.getAttribute("proxy");if(i){this._url=new URL(cv.io.rest.Client.getBaseUrl()+"/proxy",window.location.origin);this._url.searchParams.set("url",e.getAttribute("src"))}this._headers={};if(e.hasAttribute("auth-type"))switch(e.getAttribute("auth-type").toLowerCase()){case"basic":i?this._url.searchParams.set("authorization","Basic "+window.btoa(e.getAttribute("username")+":"+e.getAttribute("password"))):this._headers.Authorization="Basic "+window.btoa(e.getAttribute("username")+":"+e.getAttribute("password"))}this._loadImage();e.hasAttribute("refresh")&&this.setRefresh(parseInt(e.getAttribute("refresh")))},_loadImage:function(){var t=this,e=this._element.querySelector(":scope > img");if(Object.keys(this._headers).length>0){var r=new XMLHttpRequest;r.responseType="blob";r.open("get",this._url.toString(),!0);Object.keys(this._headers).forEach(function(e){r.setRequestHeader(e,t._headers[e])});r.onreadystatechange=function(t){if(r.readyState===XMLHttpRequest.DONE&&200===r.status){e.src=URL.createObjectURL(r.response);e.onload=function(){URL.revokeObjectURL(e.src)}}};r.send(null)}else e.src=this._url.toString()},refresh:function(){if(this._element.querySelector(":scope > img")){this._url.searchParams.set("r",""+Math.random());this._loadImage()}},onStateUpdate:function(t){cv.ui.structure.tile.components.Image.superclass.prototype.onStateUpdate.call(this,t)||("refresh"===t.detail.target?t.detail.state&&this.refresh():this.debug("unhandled address target",t.detail.target))}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"image",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Image.$$dbClassInfo=t}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();s=t.done;return t},e:function(t){c=!0;i=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);return"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function asyncGeneratorStep(t,e,r,n,o,i,s){try{var c=t[i](s),a=c.value}catch(t){r(t);return}c.done?e(a):Promise.resolve(a).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function s(t){asyncGeneratorStep(i,n,o,s,c,"next",t)}function c(t){asyncGeneratorStep(i,n,o,s,c,"throw",t)}s(void 0)})}}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MRefresh":{require:!0},"cv.io.Fetch":{},"qx.data.Array":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.List",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MRefresh],properties:{value:{refine:!0,init:[]}},members:{_target:null,_timer:null,_model:null,_getModel:null,_filterModel:null,_sortModel:null,_limit:null,_init:function(){var t=this,e=this._element;this._model=[];var r=!1,n=e.querySelector("model");if(n){n.hasAttribute("filter")&&(this._filterModel=new Function("item","index",'"use strict"; return '+n.getAttribute("filter")));n.hasAttribute("limit")&&(this._limit=parseInt(n.getAttribute("limit")));var o=n.querySelectorAll(':scope > cv-address:not([mode="write"])');if(n.hasAttribute("sort-by")){var i=n.getAttribute("sort-by"),s="desc"===n.getAttribute("sort-mode")?-1:1;this._sortModel=function(t,e){var r=t[i],n=e[i];if(r===n)return 0;if(_typeof(r)===_typeof(n))switch(_typeof(r)){case"number":return(r-n)*s;case"boolean":return(r?-1:1)*s;case"string":return r.localeCompare(n)*s;default:return JSON.stringify(r).localeCompare(JSON.stringify(n))*s}else{if(void 0===r||null===r)return 1*s;if(void 0===n||null===n)return-1*s}return 0}}if(n.hasAttribute("src"))this._getModel=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.next=2;return cv.io.Fetch.fetch(n.getAttribute("src"),null,"true"===n.getAttribute("proxy"));case 2:e=t.sent;return t.abrupt("return",e);case 4:case"end":return t.stop()}},t)}));else{var c=n.querySelector(":scope > script"),a=n.querySelectorAll(":scope > cv-data");if(c){this._getModel=new Function('"use strict";let model = []; '+c.innerText.trim()+"; return model");this._model=this._getModel()}else if(o.length>0){this._getModel=this.getValue;r=!0}else{if(!(a.length>0)){this.error("cv-list > model must have at least one read address, src-attribute, cv-data child or a script that fills the model.");return}this._model=[];this._getModel=function(){return t._model};a.forEach(function(e,r){var n,o={index:r},i=_createForOfIteratorHelper(e.attributes);try{for(i.s();!(n=i.n()).done;){var s=n.value;o[s.name]=s.value}}catch(t){i.e(t)}finally{i.f()}t._model.push(o)})}}o.length>0&&e.addEventListener("stateUpdate",function(e){return t.onStateUpdate(e)});if(!r){this.isVisible()&&this.refresh();e.hasAttribute("refresh")&&this.setRefresh(parseInt(e.getAttribute("refresh")))}}else this.error("cv-list needs a model")},onStateUpdate:function(t){"refresh"===t.detail.target?this.isVisible()?this.refresh():this._lastRefresh=null:cv.ui.structure.tile.components.List.superclass.prototype.onStateUpdate.call(this,t);t.stopPropagation()},_applyValue:function(){this._lastRefresh=0;this.refresh()},refresh:function(){var t=this;return _asyncToGenerator(regeneratorRuntime.mark(function e(){var r,n,o,i,s,c,a,u,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t._element;n=r.querySelector(":scope > template:not([when])");o=[];"function"==typeof t._getModel&&(o=t._getModel());if(!(o instanceof Promise)){e.next=8;break}e.next=7;return o;case 7:o=e.sent;case 8:i=r.querySelector(":scope > ul");if("false"!==n.getAttribute("wrap")){e.next=13;break}i=r;e.next=24;break;case 13:if(!n.hasAttribute("target")){e.next=23;break}e.t0=n.getAttribute("target");e.next="parent"===e.t0?17:20;break;case 17:i=r.parentElement;r.style.display="none";return e.abrupt("break",21);case 20:throw new Error("invalid target: "+n.getAttribute("target"));case 21:e.next=24;break;case 23:if(!i){(i=document.createElement("ul")).classList.add("content");r.appendChild(i)}case 24:t.debug("refreshing with new model length",o.length);if(!(Array.isArray(o)||o instanceof qx.data.Array)){e.next=47;break}"function"==typeof t._filterModel&&(o=o.filter(t._filterModel));"function"==typeof t._sortModel&&o.sort(t._sortModel);t._limit&&(o=o.slice(0,t._limit));if(0!==o.length){e.next=39;break}if(!(s=r.querySelector(':scope > template[when="empty"]'))||i.querySelector(":scope > .empty-model")){e.next=37;break}for(;i.firstChild&&i.hasAttribute("data-row");)i.removeChild(i.lastChild);(c=s.content.firstElementChild.cloneNode(!0)).classList.add("empty-model");i.appendChild(c);return e.abrupt("return");case 37:e.next=41;break;case 39:(a=i.querySelector(":scope > .empty-model"))&&a.remove();case 41:u=document.createElement("template");for(l=o.length;l<t._model.length;l++)(f=i.querySelector(':scope > [data-row="'.concat(l,'"]')))&&f.remove();o.forEach(function(t,e){var r=i.querySelector(':scope > [data-row="'.concat(e,'"]')),o=n.innerHTML.replaceAll(/\${([^}\[]+)\[?(\d+)?\]?}/g,function(r,n,o){if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];return o&&Array.isArray(i)?i[parseInt(o)]:i}return"index"===n?""+e:""});u.innerHTML=o;if(r){r.innerHTML=u.content.firstElementChild.innerHTML;r.setAttribute("data-row",""+e)}else{u.content.firstElementChild.setAttribute("data-row",""+e);i.appendChild(u.content.cloneNode(!0))}});t._model=o;e.next=48;break;case 47:t.error("model must be an array",o);case 48:case"end":return e.stop()}},e)}))()}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"list",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.List.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.ListItem",{extend:cv.ui.structure.tile.components.AbstractComponent,defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"listitem",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.ListItem.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){e&&_defineProperties(t.prototype,e);r&&_defineProperties(t,r);return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();s=t.done;return t},e:function(t){c=!0;i=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);return"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"qx.event.message.Bus":{},"qx.event.Registration":{},"qx.event.Timer":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Menu",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{appearance:{check:["text","icons","dock"],init:"text",apply:"_applyAppearance"},depth:{check:"!isNaN(value) && value >= -1 && value <= 100",init:-1,apply:"_applyDepth"},domReady:{check:"Boolean",init:!1,apply:"_generateMenu"},showLabels:{check:"Boolean",init:!0}},members:{_applyAppearance:function(t,e){var r=document.querySelector("main");"dock"===e&&r.classList.remove("has-dock");"dock"===t&&r.classList.add("has-dock")},_applyDepth:function(){this.isDomReady()&&this._generateMenu()},_onDomAppended:function(){this.setDomReady(!0);qx.event.message.Bus.unsubscribe("setup.dom.append",this._onDomAppended,this)},_init:function(){var t=this,e=this._element,r=e.getAttribute("model");if(r){"false"===e.getAttribute("show-labels")&&this.setShowLabels(!1);if("pages"===r){qx.event.message.Bus.subscribe("setup.dom.append",this._onDomAppended,this);var n=document.createElement("ul");e.appendChild(n);var o=document.createElement("a");o.href="#";o.classList.add("menu");o.onclick=function(){return t._onHamburgerMenu()};var i=document.createElement("i");i.classList.add("ri-menu-line");o.appendChild(i);e.appendChild(o);qx.event.message.Bus.subscribe("cv.ui.structure.tile.currentPage",this._onPageChange,this);qx.event.Registration.addListener(document,"pointerdown",this._onPointerDown,this);qx.event.Registration.addListener(this._element,"swipe",this._onSwipe,this)}else this.error("visual-model of type",r,"is not implemented")}else this.error("no model defined, menu will be empty")},_generateMenu:function(){var t=window.location.hash.substring(1),e=document.querySelector("main");if(e){var r=document.querySelector("cv-page");r&&(e=r.parentElement)}var n=this._element.querySelector(":scope > ul");if(n){n.replaceChildren();this.__P_75_0(n,e,t,0)}},_onHamburgerMenu:function(){this._element.classList.toggle("responsive");var t,e=_createForOfIteratorHelper(this._element.querySelectorAll("details"));try{for(e.s();!(t=e.n()).done;){t.value.setAttribute("open","")}}catch(t){e.e(t)}finally{e.f()}},_onPointerDown:function(t){var e=t.getTarget();e.classList.contains("menu")||e.parentElement&&e.parentElement.classList.contains("menu")||("summary"!==e.tagName.toLowerCase()&&"p"!==e.tagName.toLowerCase()?qx.event.Timer.once(this._closeAll,this,100):this._closeAll(t.getTarget().parentElement))},_onSwipe:function(t){if("left"===t.getDirection()){var e=this._element.querySelector("li.active + li > a");e&&e.click()}else{var r=this._element.querySelector("li.active");if(r&&r.previousElementSibling&&"li"===r.previousElementSibling.tagName.toLowerCase()){var n=r.previousElementSibling.querySelector(":scope > a");n&&n.click()}}},_closeAll:function(t){if(this._element.classList.contains("responsive"))this._element.classList.remove("responsive");else{var e,r=_createForOfIteratorHelper(this._element.querySelectorAll("details[open]"));try{for(r.s();!(e=r.n()).done;){var n=e.value;t&&n===t||n.removeAttribute("open")}}catch(t){r.e(t)}finally{r.f()}}},__P_75_0:function(t,e,r,n){var o=this;if(e){var i,s=e.querySelectorAll(':scope > cv-page:not([menu="false"])'),c=_createForOfIteratorHelper(s.values());try{for(c.s();!(i=c.n()).done;){var a=i.value,u=a.getAttribute("id");if(u){var l=a.getAttribute("name")||"",f=a.getAttribute("icon")||"",p=document.createElement("li"),_=document.createElement("a");_.setAttribute("href","#"+u);if(f){var d=document.createElement("i");d.classList.add(f);d.title=l;_.appendChild(d)}if(this.isShowLabels()){var h=document.createTextNode(l);_.appendChild(h)}r===u&&p.classList.add("active");t.appendChild(p);var y=this.getDepth();(y<0||y>n)&&a.querySelectorAll(':scope > cv-page:not([menu="false"])').length>0?function(){var t=document.createElement("div");t.classList.add("details");var e=document.createElement("div");e.classList.add("summary");e.addEventListener("click",function(e){t.hasAttribute("open")?t.removeAttribute("open"):t.setAttribute("open","")});_.addEventListener("click",function(t){("touch"!==t.pointerType||t.currentTarget.clientWidth-t.offsetX>=8)&&t.stopPropagation()});var i=a.getAttribute("icon")||"";if(a.querySelector(":scope > *:not(cv-page)"))e.appendChild(_);else{var s=document.createElement("p");if(i){var c=document.createElement("i");c.classList.add(i);c.title=l;s.appendChild(c)}o.isShowLabels()&&s.appendChild(document.createTextNode(l));e.appendChild(s)}t.appendChild(e);var u=document.createElement("ul");t.appendChild(u);o.__P_75_0(u,a,r,n++);p.appendChild(t)}():p.appendChild(_)}else this.error("page has no id, skipping")}}catch(t){c.e(t)}finally{c.f()}}},_onPageChange:function(t){var e,r=t.getData(),n=_createForOfIteratorHelper(this._element.querySelectorAll("li.active, li.sub-active"));try{for(n.s();!(e=n.n()).done;){var o=e.value;o.classList.remove("active");o.classList.remove("sub-active")}}catch(t){n.e(t)}finally{n.f()}var i,s=_createForOfIteratorHelper(this._element.querySelectorAll('a[href="#'.concat(r.id,'"]')));try{for(s.s();!(i=s.n()).done;)for(var c=i.value.parentElement,a="active";c&&"cv-menu"!==c.tagName.toLowerCase();){if("li"===c.tagName.toLowerCase()){c.classList.add(a);a="sub-active"}c=c.parentElement}}catch(t){s.e(t)}finally{s.f()}}},destruct:function(){qx.event.Registration.removeListener(document,"pointerdown",this._onPointerDown,this);qx.event.message.Bus.unsubscribe("cv.ui.structure.tile.currentPage",this._onPageChange,this)},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"menu",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}_createClass(n,null,[{key:"observedAttributes",get:function(){return["appearance","depth"]}}]);return n}(QxConnector))}});cv.ui.structure.tile.components.Menu.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"qx.event.message.Bus":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.RoundProgress",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MVisibility,properties:{progress:{check:"Number",apply:"_applyProgress"},text:{check:"String",apply:"_applyText"},type:{check:["circle","semiCircle"],init:"circle"},min:{check:"Number",init:0},max:{check:"Number",init:100}},members:{__P_76_0:null,__P_76_1:null,__P_76_2:null,__P_76_3:null,__P_76_4:null,__P_76_5:null,__P_76_6:null,__P_76_7:null,__P_76_8:null,_queuedFitText:null,_init:function(){var t=this;cv.ui.structure.tile.components.RoundProgress.superclass.prototype._init.call(this);var e=this._element,r=document.querySelector(":root").style,n=e.hasAttribute("radius"),o=this.__P_76_4=e.getAttribute("radius")||parseInt(r.getPropertyValue("--tileCellWidth"))||56,i=e.getAttribute("stroke")||8,s=this.__P_76_3=o-i/2;this.__P_76_1=2*s*Math.PI;if(e.hasAttribute("min")){var c=parseInt(e.getAttribute("min"));isNaN(c)||this.setMin(c)}if(e.hasAttribute("max")){var a=parseInt(e.getAttribute("max"));isNaN(a)||this.setMax(a)}e.hasAttribute("type")&&this.setType(e.getAttribute("type"));var u=this.getType(),l="semiCircle"===u?o:2*o,f='<svg height="'.concat(l,'" width="').concat(2*o,'" type="').concat(u,'">');if("circle"===u){e.hasAttribute("no-background")||(f+='<circle class="bg" \n                r="'.concat(s,'" \n                cx="50%" \n                cy="50%" \n                fill="transparent" \n                stroke-width="').concat(i,'"/>'));f+='<circle class="bar" \n              r="'.concat(s,'" \n              cx="50%" \n              cy="50%" \n              stroke-width="').concat(i,'" \n              stroke-dasharray="').concat(this.__P_76_1," ").concat(this.__P_76_1,'" \n              stroke-dashoffset="').concat(this.__P_76_1,'"/>')}else if("semiCircle"===u){e.hasAttribute("no-background")||(f+='<path class="bg" d="M '.concat(i/2," ").concat(o," A ").concat(s," ").concat(s," 0 0 1 ").concat(2*o-i/2," ").concat(o,'" fill="transparent" stroke-width="').concat(i,'"/>'));this.__P_76_2={x:i/2,y:o};f+='<path class="bar" d="M '.concat(i/2," ").concat(o," A ").concat(s," ").concat(s," 0 0 0 ").concat(i/2," ").concat(o,'" fill="transparent" stroke-width="').concat(i,'"/>')}f+="</svg><label></label>";e.innerHTML=f;this.__P_76_7=2*o-2*i-24;n||qx.event.message.Bus.subscribe("cv.design.tile.cellWidthChanged",function(r){t.__P_76_4=r.getData();t.__P_76_3=t.__P_76_4-i/2;t.__P_76_1=2*t.__P_76_3*Math.PI;l="semiCircle"===u?t.__P_76_4:2*t.__P_76_4;var n=e.querySelector(":scope > svg");n.setAttribute("height",""+l);n.setAttribute("width",""+2*t.__P_76_4);if("circle"===u)t._element.querySelectorAll(":scope > svg > circle").forEach(function(e){e.setAttribute("r",""+t.__P_76_3);if(e.classList.contains("bar")){e.setAttribute("stroke-dasharray",t.__P_76_1+" "+t.__P_76_1);e.setAttribute("stroke-dashoffset",""+t.__P_76_1)}});else if("semiCircle"===u){t.__P_76_2.y=t.__P_76_4;var o=t._element.querySelector(":scope > svg > path.bg");o&&o.setAttribute("d","M ".concat(i/2," ").concat(t.__P_76_4," A ").concat(t.__P_76_3," ").concat(t.__P_76_3," 0 0 1 ").concat(2*t.__P_76_4-i/2," ").concat(t.__P_76_4))}t._applyProgress(t.isPropertyInitialized("progress")?t.getProgress():0)})},__P_76_9:function(t){var e=t*(Math.PI/180);return{x:this.__P_76_4-this.__P_76_3*Math.cos(e),y:this.__P_76_4-this.__P_76_3*Math.sin(e)}},_applyProgress:function(t){if(this.isConnected()){var e,r,n=t-this.getMin(),o=Math.max(0,Math.min(100,100/(this.getMax()-this.getMin())*n));switch(this.getType()){case"circle":(e=this._element.querySelector(":scope > svg > circle.bar")).setAttribute("stroke-dashoffset",""+this.__P_76_1-o/100*this.__P_76_1);break;case"semiCircle":e=this._element.querySelector(":scope > svg > path.bar");r=this.__P_76_9(1.8*o);e.setAttribute("d",["M",this.__P_76_2.x,this.__P_76_2.y,"A",this.__P_76_3,this.__P_76_3,0,0,1,r.x,r.y].join(" "))}}},_fitText:function(){if(this.__P_76_5&&this.__P_76_5.textContent)if(this.isVisible()){if(!this.__P_76_6){this.__P_76_6=document.createElement("canvas");this.__P_76_10=this.__P_76_6.getContext("2d");var t=window.getComputedStyle(this.__P_76_5);this.__P_76_10.font=t.getPropertyValue("font");this.__P_76_8=t.getPropertyValue("font-size")}var e=this.__P_76_10.measureText(this.__P_76_5.textContent);if(e.width>this.__P_76_7){var r=this.__P_76_7/e.width;this.__P_76_5.style.fontSize=Math.floor(parseInt(this.__P_76_8)*r)+"px"}else this.__P_76_5.style.fontSize=this.__P_76_8;this._queuedFitText=!1}else this._queuedFitText=!0},_applyVisible:function(t){t&&this._queuedFitText&&this._fitText()},_applyText:function(t){if(this.isConnected()){this.__P_76_5||(this.__P_76_5=this._element.querySelector(":scope > label"));this.__P_76_5.textContent=t;t?this._fitText():this.__P_76_8&&(this.__P_76_5.style.fontSize=this.__P_76_8)}}},destruct:function(){this.__P_76_5=null},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"round-progress",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.RoundProgress.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();s=t.done;return t},e:function(t){c=!0;i=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);return"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Select",{extend:cv.ui.structure.tile.components.AbstractComponent,members:{__P_77_0:null,__P_77_1:null,__P_77_2:null,_init:function(){var t=this;cv.ui.structure.tile.components.Select.superclass.prototype._init.call(this);var e=this._element;this.__P_77_0=new Map;var r=this.__P_77_2=document.createElement("div");r.classList.add("popup");e.querySelectorAll(":scope > cv-option").forEach(function(e,n){r.appendChild(e);e.hasAttribute("key")||e.setAttribute("key",""+n);t.__P_77_0.set(e.getAttribute("key"),e)});var n=this.__P_77_1=document.createElement("span");n.classList.add("value");e.appendChild(n);e.appendChild(r);var o=document.createElement("cv-icon");o.classList.add("dropdown");o.classList.add("ri-arrow-down-s-line");e.appendChild(o);this._writeAddresses.length>0&&e.addEventListener("click",function(e){return t.onClicked(e)})},onClicked:function(t){var e,r=getComputedStyle(this.__P_77_2),n=_createForOfIteratorHelper(t.path);try{for(n.s();!(e=n.n()).done;){var o=e.value;if("cv-option"===o.tagName.toLowerCase()){this._sendSelection(o.getAttribute("key"),!0);break}if(o===t.currentTarget)break}}catch(t){n.e(t)}finally{n.f()}"none"===r.getPropertyValue("display")?this.__P_77_2.style.display="block":this.__P_77_2.style.display="none"},_sendSelection:function(t,e){var r=new CustomEvent("sendState",{detail:{value:t,source:this}});this._writeAddresses.filter(function(t){return!t.hasAttribute("on")||"click"===t.getAttribute("on")}).forEach(function(t){return t.dispatchEvent(r)});!0===e&&this.setValue(t)},_updateValue:function(t,e){if(this.__P_77_0.has(t)){this.__P_77_1.innerHTML="";var r=this.__P_77_0.get(t);if(r.children.length>0){var n,o=_createForOfIteratorHelper(r.children);try{for(o.s();!(n=o.n()).done;){var i=n.value;this.__P_77_1.appendChild(i.cloneNode())}}catch(t){o.e(t)}finally{o.f()}}else this.__P_77_1.innerHTML=r.innerHTML}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"select",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Select.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.util.Function":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Slider",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{stepWidth:{check:"Number",init:5},min:{check:"Number",init:1,apply:"_applyMin"},max:{check:"Number",init:100,apply:"_applyMax"},showValue:{check:"Boolean",init:!0,apply:"_applyShowValue"},throttleInterval:{check:"Number",init:250,apply:"_applyThrottleInterval"}},members:{__P_78_0:null,__P_78_1:null,_init:function(){var t=this;cv.ui.structure.tile.components.Slider.superclass.prototype._init.call(this);var e=this._element;e.hasAttribute("throttle-interval")?this.setThrottleInterval(parseInt(e.getAttribute("throttle-interval"))):this._applyThrottleInterval(this.getThrottleInterval());var r=e.querySelector(":scope > input");if(!r){(r=document.createElement("input")).classList.add("slider");r.setAttribute("type","range");e.insertBefore(r,e.querySelector(":scope > .up"));r.oninput=function(){return t.__P_78_0.call()}}this.__P_78_1=r;e.hasAttribute("step-width")&&this.setStepWidth(parseInt(e.getAttribute("step-width")));e.hasAttribute("min")&&this.setMin(parseInt(e.getAttribute("min")));e.hasAttribute("max")&&this.setMax(parseInt(e.getAttribute("max")));e.hasAttribute("hide-value")&&"true"===e.getAttribute("hide-value")?this.setShowValue(!1):this._applyShowValue(!0);var n=e.querySelector(":scope > .decrease");n&&n.addEventListener("click",function(e){return t.onDecrease()});var o=e.querySelector(":scope > .increase");o&&o.addEventListener("click",function(e){return t.onIncrease()})},_applyThrottleInterval:function(t){var e=this;this.__P_78_0=t>0?cv.util.Function.throttle(this.onInput,t,{trailing:!0},this):{call:function(){return e.onInput()},abort:function(){}}},_applyMin:function(t){this._element.querySelector(":scope > input").setAttribute("min",""+t)},_applyMax:function(t){this._element.querySelector(":scope > input").setAttribute("max",""+t)},_applyShowValue:function(t){var e=this._element.querySelector(":scope > label.value");if(t&&!e){(e=document.createElement("label")).classList.add("value");e.classList.add("secondary");this._element.insertBefore(e,this._element.firstChild)}},_updateValue:function(t,e){var r=this._element.querySelector(":scope > input");r&&(r.value=e);if(this.isShowValue()){var n=this._element.querySelector(":scope > label.value");n&&(n.innerText=t)}},onInput:function(){this.__P_78_2(this.__P_78_1.value)},onDecrease:function(){var t=this.getValue()-this.getStepWidth();this.__P_78_2(t,"decrease")},onIncrease:function(){var t=this.getValue()+this.getStepWidth();this.__P_78_2(t,"increase")},__P_78_2:function(t,e){var r=new CustomEvent("sendState",{detail:{value:t,source:this}});this._writeAddresses.filter(function(t){return!t.hasAttribute("on")||t.getAttribute("on")===e}).forEach(function(t){return t.dispatchEvent(r)})}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"slider",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Slider.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Spinner",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{stepWidth:{check:"Number",init:1},mode:{check:["relative","absolute"],init:"absolute"}},members:{_init:function(){var t=this;cv.ui.structure.tile.components.Spinner.superclass.prototype._init.call(this);var e=this._element;e.hasAttribute("step-width")&&this.setStepWidth(parseFloat(e.getAttribute("step-width")));e.hasAttribute("mode")&&this.setMode(e.getAttribute("mode"));var r=e.querySelector(":scope > .value");if(!r){(r=document.createElement("label")).classList.add("value");r.classList.add("primary");e.appendChild(r)}var n=document.createElement("div");n.classList.add("clickable");n.classList.add("left");var o=document.createElement("cv-icon");o.classList.add("ri-arrow-down-s-line");n.addEventListener("click",function(){return t.onDecrease()});n.appendChild(o);e.insertBefore(n,r);var i=document.createElement("div");i.classList.add("clickable");i.classList.add("right");var s=document.createElement("cv-icon");s.classList.add("ri-arrow-up-s-line");i.appendChild(s);i.addEventListener("click",function(){return t.onIncrease()});e.appendChild(i)},onDecrease:function(){var t="absolute"===this.getMode()?this.getValue()-this.getStepWidth():-1*this.getStepWidth();this.__P_79_0(t,"decrease")},onIncrease:function(){var t="absolute"===this.getMode()?this.getValue()+this.getStepWidth():this.getStepWidth();this.__P_79_0(t,"increase")},_updateValue:function(t){var e=this._element.querySelector(".value");e&&(e.innerHTML=t)},__P_79_0:function(t,e){var r=new CustomEvent("sendState",{detail:{value:t,source:this}});this._writeAddresses.filter(function(t){return!t.hasAttribute("on")||t.getAttribute("on")===e}).forEach(function(t){return t.dispatchEvent(r)})}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"spinner",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Spinner.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MVisibility":{require:!0},"cv.ui.structure.tile.MResize":{require:!0},"qx.util.Function":{},"cv.Application":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.components.Value",{extend:cv.ui.structure.tile.components.AbstractComponent,include:[cv.ui.structure.tile.MVisibility,cv.ui.structure.tile.MResize],members:{_queuedOverflowDetection:null,_debouncedDetectOverflow:null,_init:function(){cv.ui.structure.tile.components.Value.superclass.prototype._init.call(this);this._debouncedDetectOverflow=qx.util.Function.debounce(this._detectOverflow,20);var t=this._element.querySelector(".value");if(t&&"label"===t.tagName.toLowerCase()){this.setResizeTarget(this._element);this.addListener("resized",this._debouncedDetectOverflow,this)}},_applyVisible:function(t){if(t)this._queuedOverflowDetection&&this._debouncedDetectOverflow();else{var e=this._element.querySelector(".value");e&&e.classList.contains("scroll")&&e.classList.remove("scroll")}},_detectOverflow:function(){var t=this._element.querySelector(".value");if(this.isVisible()){this._queuedOverflowDetection=!1;t.clientWidth>t.parentElement.clientWidth?t.classList.add("scroll"):t.classList.remove("scroll")}else this._queuedOverflowDetection=!0},_updateValue:function(t,e){var r=this._element.querySelector(".value"),n="";if(r){switch(r.tagName.toLowerCase()){case"cv-icon":r._instance.setId(t);this._element.hasAttribute("styling")&&(n=cv.Application.structureController.styleValue(this._element.getAttribute("styling"),e,this.__P_80_0));r._instance.setStyleClass(n);break;case"meter":r.setAttribute("value",t);r.innerHTML=""+t;break;case"cv-round-progress":"string"==typeof e&&(e=parseInt(e));r._instance.setProgress(e);r._instance.setText(""+t);break;case"label":r.innerHTML=t;this._debouncedDetectOverflow()}}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"value",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.components.Value.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,o=!1,i=void 0;try{for(var s,c=t[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){r.push(s.value);if(e&&r.length===e)break}}catch(t){o=!0;i=t}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();s=t.done;return t},e:function(t){c=!0;i=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);return"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"cv.data.Model":{},"cv.Config":{},"cv.io.BackendConnections":{},"qx.log.Logger":{},"qx.locale.Manager":{},"cv.core.notifications.Router":{},"cv.TemplateEngine":{},"qx.event.message.Bus":{},"cv.Transform":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Backend",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,members:{_name:null,__P_82_0:null,_init:function(){var t,e=this,r=this._element,n=r.getAttribute("type"),o=r.hasAttribute("uri")?r.getAttribute("uri"):"";if(o)try{t=new URL(o,window.location.origin+window.location.pathname)}catch(t){this.error("Error parsing uri: "+o)}if(n){var i=null;r.hasAttribute("username")?i={username:r.getAttribute("username"),password:r.getAttribute("password")||""}:t&&t.username&&(i={username:t.username,password:t.password});var s,c=cv.data.Model.getInstance(),a=t?t.toString():null;switch(n){case"knxd":s="backendKnxdUrl";break;case"openhab":s="backendOpenHABUrl";break;case"mqtt":s="backendMQTTUrl"}s&&(cv.Config.URL[s]?a=cv.Config.URL[s]:!a&&cv.Config.server[s]&&(a=cv.Config.server[s]));var u=n;if(r.hasAttribute("name"))u=r.getAttribute("name");else if(cv.io.BackendConnections.hasClient("main")){if("config"===cv.io.BackendConnections.getClient("main").configuredIn){qx.log.Logger.warn(this,'there is already a backend registered with name "main" and type '.concat(n," skipping this one"));return}}else u="main";qx.log.Logger.debug(this,"init backend",u);if(cv.io.BackendConnections.hasClient(u)){var l={topic:"cv.config.error",title:qx.locale.Manager.tr("Config error"),message:qx.locale.Manager.tr('There already exists a backend named: "%1"',u),severity:"urgent",unique:!0,deletable:!0};cv.core.notifications.Router.dispatchMessage(l.topic,l);return}var f=cv.io.BackendConnections.addBackendClient(u,n,a,"config");this._client=f;this._name=u;this.__P_82_0=[];f.update=function(t){return c.updateFrom(u,t)};f.login(!0,i,function(){e.debug(u,"connected");r.hasAttribute("default")&&"true"===r.getAttribute("default")&&c.setDefaultBackendName(u);var t=function(){var t,r=_createForOfIteratorHelper(e.__P_82_0);try{for(r.s();!(t=r.n()).done;){var n=_slicedToArray(t.value,2),o=n[0],i=n[1];e.debug(u,"apply update",o,i);c.onUpdate(o,i,u)}}catch(t){r.e(t)}finally{r.f()}var s=c.getAddresses(u);e.debug(u,"subscribing to",s.length,"addresses");0!==s.length&&f.subscribe(s)};cv.TemplateEngine.getInstance().isDomFinished()?t():qx.event.message.Bus.subscribe("setup.dom.finished",function(){t()},e)});var p,_=_createForOfIteratorHelper(r.querySelectorAll(":scope > cv-data"));try{for(_.s();!(p=_.n()).done;){var d=p.value;if(d.hasAttribute("address")){var h=d.textContent.trim();if(d.hasAttribute("transform")){var y=d.getAttribute("transform");h=cv.Transform.encodeBusAndRaw({transform:y},h).bus}this.__P_82_0.push([d.getAttribute("address"),h])}}}catch(t){_.e(t)}finally{_.f()}}else this.error("<cv-backend> must have a type attribute")},_disconnected:function(){if(this._client){var t=cv.data.Model.getInstance();this._element.hasAttribute("default")&&"true"===this._element.getAttribute("default")&&t.resetDefaultBackendName();this._client.terminate();cv.io.BackendConnections.removeClient(this._client);this._client.dispose();this._client=null}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"backend",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.elements.Backend.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{require:!0},"qx.io.request.Xhr":{},"cv.Config":{},"cv.Application":{},"qx.util.Request":{},"qx.locale.Manager":{},"cv.core.notifications.Router":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Loader",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,members:{_init:function(){var t,e=this._element,r=e.getAttribute("type"),n=e.getAttribute("src");if(n){switch(r){case"css":(t=document.createElement("link")).setAttribute("type","text/css");t.setAttribute("rel","stylesheet");t.setAttribute("href",n);break;case"js":(t=document.createElement("script")).setAttribute("type","text/javascript");t.setAttribute("src",n);break;case"templates":this.loadXml(n,r)}t&&e.appendChild(t)}},loadXml:function(t){var e=new qx.io.request.Xhr(t);e.set({accept:"application/xml",cache:!cv.Config.forceReload});e.addListenerOnce("success",function(t){var e,r=t.getTarget().getResponse(),n=r,o=cv.Application.structureController.getRenderTarget();if(!n.documentElement.xmlns){var i=t.getTarget().getResponseText();i=i.replace("<templates",'<templates xmlns="http://www.w3.org/1999/xhtml"');n=(new DOMParser).parseFromString(i,"text/xml")}for(;e=n.documentElement.firstElementChild;)o.appendChild(e);cv.Application.structureController.registerTemplates(r)});e.addListener("statusError",function(t){var r=t.getTarget().getTransport().status;qx.util.Request.isSuccessful(r)?this.handleError(r,null):this.handleError("filenotfound",e.getUrl())},this);e.send()},handleError:function(t,e){var r=qx.locale.Manager.tr("File Error!").translate().toString(),n="";switch(t){case"parsererror":n=qx.locale.Manager.tr("Invalid XML file!");break;case"filenotfound":n=qx.locale.Manager.tr("404: File not found, %1.",e).translate().toString();break;default:n=qx.locale.Manager.tr('Unhandled error of type "%1"',t).translate().toString();n+=e?": "+e:"."}var o={topic:"cv.error",title:r,message:n};void 0;cv.core.notifications.Router.dispatchMessage(o.topic,o);this.error(this,n.toString())}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"loader",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.elements.Loader.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.AbstractCustomElement":{construct:!0,require:!0},"cv.Application":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Mapping",{extend:cv.ui.structure.tile.elements.AbstractCustomElement,construct:function(t){cv.ui.structure.tile.elements.AbstractCustomElement.constructor.call(this,t);this.__P_83_0={}},members:{__P_83_0:null,_applyConnected:function(t,e,r){cv.ui.structure.tile.elements.Mapping.superclass.prototype._applyConnected.call(this,t,e,r);this._element.tagName.toLowerCase().endsWith("mapping")&&(t?cv.Application.structureController.addMapping(this._element.getAttribute("name"),this):cv.Application.structureController.removeMapping(this._element.getAttribute("name")))},mapValue:function(t,e){var r=this;if(Object.prototype.hasOwnProperty.call(this.__P_83_0,t))return this.__P_83_0[t];var n=""+t,o=this._element.querySelector(':scope > entry[value="'+t+'"]'),i=this._element.hasAttribute("type")?this._element.getAttribute("type"):"string";if(o){n=this._convert(o.innerHTML.trim(),i);this.__P_83_0[t]=n;return n}var s=this._element.querySelector(":scope > formula");if(s){if(!s._formula){var c=s.textContent;s._formula=new Function("x","store","let y;"+c+"; return y;")}return n=this._convert(s._formula(t,e),i)}var a=this._element.querySelectorAll(":scope > entry"),u=null;Array.from(a).some(function(e){var o=!1,s=e.hasAttribute("default")&&"true"===e.getAttribute("default");if(e.hasAttribute("value")){var c=e.getAttribute("value");if(c===(t||"NULL")||"*"===c){n=r._convert(e.innerHTML.trim(),i);o=!0}s&&(u=r._convert(c,i))}else if(e.hasAttribute("range-min")){var a=parseFloat(e.getAttribute("range-min")),l=e.hasAttribute("range-max")?parseFloat(e.getAttribute("range-max")):Number.POSITIVE_INFINITY,f=parseFloat(t);if(a<=f&&f<=l){n=r._convert(e.innerHTML.trim(),i);o=!0}s&&(u=a)}return o})||null===u||(n=this.mapValue(u));this.__P_83_0[t]=n;return n},_convert:function(t,e){switch(e.toLowerCase()){case"boolean":return"true"===t;case"integer":return parseInt(t);case"float":return parseFloat(t);default:return t}}},destruct:function(){this.__P_83_0=null},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"mapping",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.elements.Mapping.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.elements.Mapping":{require:!0},"cv.Application":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.elements.Styling",{extend:cv.ui.structure.tile.elements.Mapping,members:{_applyConnected:function(t,e,r){cv.ui.structure.tile.elements.Styling.superclass.prototype._applyConnected.call(this,t,e,r);t?cv.Application.structureController.addStyling(this._element.getAttribute("name"),this):cv.Application.structureController.removeStyling(this._element.getAttribute("name"))}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"styling",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.elements.Styling.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"qx.event.Registration":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Group",{extend:cv.ui.structure.tile.components.AbstractComponent,members:{_init:function(){cv.ui.structure.tile.widgets.Group.superclass.prototype._init.call(this);var t=this._element,e=null,r=null;if(t.hasAttribute("name")||t.hasAttribute("icon")){if(!(r=t.querySelector(":scope > summary"))){r=document.createElement("summary");t.insertBefore(r,t.firstChild)}if(t.hasAttribute("name")){if(!(e=t.querySelector(":scope > summary > label.title"))){(e=document.createElement("label")).classList.add("title");r.insertBefore(e,r.firstChild)}e.classList.add("last-of-title");e.textContent=t.getAttribute("name")}if(t.hasAttribute("icon")){var n=t.querySelector(":scope > summary > cv-icon.title");if(!n){(n=document.createElement("cv-icon")).classList.add("title");r.insertBefore(n,r.firstChild)}e||n.classList.add("last-of-title");n.classList.add(t.getAttribute("icon"))}}!t.querySelector(":scope > *:not(summary)")?t.classList.add("empty"):r&&qx.event.Registration.addListener(r,"click",this._toggleOpen,this)},_toggleOpen:function(){this._element.hasAttribute("open")?this._element.removeAttribute("open"):this._element.setAttribute("open","true")},onStateUpdate:function(t){if(!cv.ui.structure.tile.widgets.Group.superclass.prototype.onStateUpdate.call(this,t))if("summary"===t.detail.target){var e=this._element.querySelector(":scope > summary > label.value");if(!e){(e=document.createElement("label")).classList.add("value");this._element.querySelector(":scope > summary").appendChild(e)}e.textContent=t.detail.state}else this.debug("unhandled address target",t.detail.target)}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"group",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.widgets.Group.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}});return _setPrototypeOf(r,t)})(t)}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));r&&_setPrototypeOf(o,r.prototype);return o}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Page",{extend:cv.ui.structure.tile.components.AbstractComponent,properties:{visibility:{refine:!0,init:"excluded"}},members:{_supportsContentVisibility:null,_init:function(){if("undefined"!=typeof InstallTrigger){this._element.classList.add("no-content-visibility");this._supportsContentVisibility=!1}else this._supportsContentVisibility=!0},_applyVisibility:function(t){switch(t){case"visible":this._supportsContentVisibility?this._element.style.contentVisibility="visible":this._visibleDisplayMode&&(this._element.style.display=this._visibleDisplayMode||"initial");break;case"hidden":case"excluded":if(this._supportsContentVisibility)this._element.style.contentVisibility="hidden";else{this._visibleDisplayMode=getComputedStyle(this._element).getPropertyValue("display");this._element.style.display="none"}}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"page",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector));customElements.define(cv.ui.structure.tile.Controller.PREFIX+"row",function(t){"use strict";_inherits(r,t);var e=_createSuper(r);function r(){var t;_classCallCheck(this,r);(t=e.call(this)).hasAttribute("colspan")&&t.classList.add("colspan-"+t.getAttribute("colspan"));t.hasAttribute("rowspan")&&t.classList.add("rowspan-"+t.getAttribute("rowspan"));return t}return r}(_wrapNativeSuper(HTMLElement)))}});cv.ui.structure.tile.widgets.Page.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MPopup":{require:!0},"qx.event.Timer":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Popup",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MPopup,statics:{openedPopups:[]},members:{_init:function(){var t=this;cv.ui.structure.tile.widgets.Popup.superclass.prototype._init.call(this);var e=this._element;if(!e.hasAttribute("closeable")||"true"===e.getAttribute("closeable")){this._closeButton=document.createElement("button");this._closeButton.classList.add("close");var r=document.createElement("i");r.classList.add("ri-close-line");this._closeButton.appendChild(r);e.insertBefore(this._closeButton,e.firstChild);this._closeButton.addEventListener("click",function(){return t.close()})}if(e.hasAttribute("auto-close-timeout")){var n=parseInt(e.getAttribute("auto-close-timeout"));if(isNaN(n))this.error("invalid auto-close-timeout value:",e.getAttribute("auto-close-timeout"));else{this._autoCloseTimer=new qx.event.Timer(1e3*n);this._autoCloseTimer.addListener("interval",function(){t._autoCloseTimer.stop();t.close()})}}},open:function(){var t=this._element;if(!t.hasAttribute("open")){t.setAttribute("open","");t.hasAttribute("modal")&&"true"===t.getAttribute("modal")&&this.registerModalPopup();this._autoCloseTimer&&this._autoCloseTimer.start()}},close:function(){var t=this._element;if(t){t.removeAttribute("open");t.hasAttribute("modal")&&"true"===t.getAttribute("modal")&&this.unregisterModalPopup();this._autoCloseTimer&&this._autoCloseTimer.stop();t.dispatchEvent(new CustomEvent("closed"))}},onStateUpdate:function(t){if(!cv.ui.structure.tile.widgets.Popup.superclass.prototype.onStateUpdate.call(this,t))switch(t.detail.target){case"open":t.detail.state&&this.open();break;case"open-close":t.detail.state?this.open():this.close();break;case"close":t.detail.state||this.close();break;default:this.debug("unhandled address target",t.detail.target)}}},destruct:function(){this._disposeObjects("_autoCloseTimer");if(this._closeButton){this._closeButton.remove();this._closeButton=null}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"popup",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.widgets.Popup.$$dbClassInfo=t}();function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){var t={dependsOn:{"qx.Class":{usage:"dynamic",require:!0},"cv.ui.structure.tile.components.AbstractComponent":{require:!0},"cv.ui.structure.tile.MPopup":{require:!0},"qx.event.Timer":{},"cv.ui.structure.tile.Controller":{defer:"runtime"}}};qx.Bootstrap.executePendingDefers(t);qx.Class.define("cv.ui.structure.tile.widgets.Tile",{extend:cv.ui.structure.tile.components.AbstractComponent,include:cv.ui.structure.tile.MPopup,properties:{backgroundImage:{check:"String",nullable:!0,apply:"_applyBackgroundImage"},popup:{check:"Boolean",init:!1,apply:"_applyPopup"}},members:{_init:function(){var t=this;cv.ui.structure.tile.widgets.Tile.superclass.prototype._init.call(this);this._initPopupChild();this._element.hasAttribute("background-image")&&this.setBackgroundImage(this._element.getAttribute("background-image"));this._childPopup&&this._childPopup.addEventListener("closed",function(){t.resetPopup()})},_applyBackgroundImage:function(t){if(t){this._element.style.backgroundImage="url(".concat(t,")");var e=this._element.querySelector(":scope > div.overlay");if(!e){(e=document.createElement("div")).classList.add("overlay");this._element.insertBefore(e,this._element.firstChild)}this._element.classList.add("has-bg-image")}else{this._element.style.backgroundImage="";this._element.classList.remove("has-bg-image")}},open:function(){var t=this;if(this._childPopup)this._openPopupChild();else{var e=this._element.querySelector(":scope > button.close");if(!e){(e=document.createElement("button")).classList.add("close");var r=document.createElement("i");r.classList.add("ri-close-line");e.appendChild(r);this._element.appendChild(e);e.addEventListener("click",function(){return t.setPopup(!1)})}e.style.display="block";this._element.classList.add("popup");this.registerModalPopup()}},close:function(t){t||this.setPopup(!1);if(this._childPopup)this._closePopupChild();else{this._element.classList.remove("popup");var e=this._element.querySelector(":scope > button.close");e&&(e.style.display="none");this.unregisterModalPopup()}this._autoCloseTimer&&this._autoCloseTimer.stop()},_applyPopup:function(t){t?this.open():this.close(!0)},onStateUpdate:function(t){if(!cv.ui.structure.tile.widgets.Tile.superclass.prototype.onStateUpdate.call(this,t))switch(t.detail.target){case"background-image":this.setBackgroundImage(t.detail.state);break;case"popup":if(t.detail.addressValue){if(t.detail.addressValue==t.detail.state){this.setPopup(!0);if(!this._autoCloseTimer){this._autoCloseTimer=new qx.event.Timer(18e4);this._autoCloseTimer.addListener("interval",this.close,this)}this._autoCloseTimer.restart()}}else this.setPopup(1==t.detail.state);break;default:this.debug("unhandled address target",t.detail.target)}}},defer:function(t){customElements.define(cv.ui.structure.tile.Controller.PREFIX+"tile",function(e){"use strict";_inherits(n,e);var r=_createSuper(n);function n(){_classCallCheck(this,n);return r.call(this,t)}return n}(QxConnector))}});cv.ui.structure.tile.widgets.Tile.$$dbClassInfo=t}();qx.$$packageData[2]={locales:{},resources:{},translations:{en:{},de:{"Communication error":"Kommunikationsfehler","URL: %1<br/><br/>Response:</br>%2":"URL: %1<br/><br/>Antwort:</br>%2","Config error":"Konfigurationsfehler",'There already exists a backend named: "%1"':'Es existiert bereits ein Backend mit dem Namen: "%1"',"File Error!":"Dateifehler!","Invalid XML file!":"Ungültige XML Datei!","404: File not found, %1.":"404: Datei nicht gefunden, %1.",'Unhandled error of type "%1"':'Unbekannter Fehler vom Typ "%1"'}}};
//# sourceMappingURL=package-2.js.map