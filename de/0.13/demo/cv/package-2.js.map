{"version":3,"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/Controller.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/MPopup.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/MRefresh.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/MResize.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/MVisibility.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/AbstractCustomElement.js","compiled/build/transpiled/cv/ui/structure/tile/elements/AbstractCustomElement.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/AbstractComponent.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Button.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Address.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Chart.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Color.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Icon.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/List.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/ListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Menu.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/RoundProgress.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Select.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Slider.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Spinner.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/components/Value.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Backend.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Loader.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Mapping.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/elements/Styling.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/widgets/Group.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/widgets/Page.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/widgets/Popup.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/structure/tile/widgets/Tile.js"],"names":["qx","Class","define","extend","core","Object","type","implement","cv","ui","structure","IController","construct","constructor","call","this","__P_70_0","bom","Stylesheet","includeFile","util","ResourceManager","getInstance","toUri","replace","Config","forceReload","Date","now","statics","PREFIX","__P_70_1","__P_70_2","register","webComponentName","qxClass","onComponentCreated","element","name","tagName","toLowerCase","QxClass","log","Logger","error","properties","renderTarget","check","init","document","body","namespace","members","__P_70_3","__P_70_4","getHtmlStructure","supports","feature","subfeature","initLayout","__P_70_5","location","hash","scrollToPage","substring","getInitialPageId","onHistoryRequest","anchor","pageId","skipHistory","page","classList","contains","_step","_iterator","_createForOfIteratorHelper","querySelectorAll","s","n","done","value","remove","err","e","f","_step2","_iterator2","parentElement","nodeName","add","headline","getAttribute","pageTitle","warn","parseBackendSettings","xml","_this","io","BackendConnections","initBackendClient","login","configSettings","credentials","debug","parseSettings","config","_this2","settings","configElement","documentElement","bindClickToWidget","translate","templates","ajaxRequest","request","Xhr","set","accept","cache","addListenerOnce","content","getTarget","getResponse","text","getResponseText","DOMParser","parseFromString","target","appendChild","child","TemplateEngine","setDomFinished","addListener","status","getTransport","send","registerTemplates","forEach","template","customElements","tile","Controller","_TemplatedElement","TemplatedElement","_classCallCheck","_class","preParse","_this3","theme","data","regeneratorRuntime","wrap","_context","prev","next","hasAttribute","window","matchMedia","matches","setAttribute","Model","updateFrom","addEventListener","stop","_callee","createUI","doc","_i","_arr","length","_step3","attr","_iterator3","trNameElement","match","exec","translation","querySelector","concat","locale","Manager","getLanguage","key","textContent","trim","_step4","_iterator4","trTextElement","_translation","_key","doScreenSave","screensave_page","getInitialAddresses","firstPage","id","addMapping","mapping","removeMapping","mapValue","mappingName","store","prototype","hasOwnProperty","addStyling","styling","removeStyling","styleValue","stylingName","defer","cvTestMode","Application","structureController","_this4","controller","getElementById","templateId","_step5","slotAttributes","cloneNode","_loop","slot","slotName","replacementSelector","slotParentScope","parseInt","includes","attributes","i","attrs","Array","from","slotContents","slotContent","newNode","keys","attrName","removeAttribute","parentNode","insertBefore","replaced","_i2","_iterator5","targetName","endsWith","elem","_toConsumableArray","startsWith","Bootstrap","executePendingDefers","$$dbClassInfo","Mixin","openedPopups","events","closed","_childPopup","_initPopupChild","popup","_element","event","Registration","_openPopupChild","last","parent","open","_closePopupChild","close","registerModalPopup","_onPointerDown","blocker","createElement","style","display","MPopup","push","unregisterModalPopup","removeListener","index","indexOf","splice","ev","Tree","isChildOf","preventDefault","destruct","refresh","apply","_refreshTimer","_lastRefresh","_applyRefresh","restartWith","Timer","__P_71_0","isVisible","start","_applyVisible","getInterval","_disposeObjects","MRefresh","_observer","ResizeObserver","entries","observer","getResizeTarget","some","entry","fireDataEvent","resized","resizeTarget","nullable","_applyResizeTarget","oldElement","unobserve","observe","disconnect","MResize","_observeVisibility","IntersectionObserver","_instance","setVisible","intersectionRatio","visible","MVisibility","connected","_initialized","_applyConnected","_init","_disconnected","getElement","QxConnector","_HTMLElement","_super","isSubClassOf","elements","AbstractCustomElement","Error","_assertThisInitialized","setConnected","oldValue","newValue","hasProperty","HTMLElement","styleClass","enabled","visibility","_writeAddresses","_visibleDisplayMode","hasReadAddress","writeAddresses","address","onStateUpdate","stopPropagation","_applyValue","isConnected","mappedValue","String","sprintf","toLocaleString","_updateValue","setStyleClass","_applyStyleClass","classes","_applyEnabled","_applyVisibility","opacity","getComputedStyle","getPropertyValue","detail","setEnabled","state","setVisibility","setValue","components","AbstractComponent","__P_72_0","Map","on","onClass","offClass","onValue","offValue","progress","transform","__P_72_1","__P_72_2","_parseInt","val","intVal","Number","isNaN","setType","setName","setProgress","setOnValue","setOffValue","eventSource","level","addr","click","onClicked","bind","pointerup","onPointerUp","pointerdown","onPointerDown","getOwnPropertyNames","eventName","triggerAddresses","filter","once","setOn","getOnValue","hasDown","hasUp","_initProgress","Math","PI","svg","createElementNS","circle","Button","superclass","getType","_applyOn","isOn","getOffValue","setId","updateValue","getOnClass","getOffClass","_applyProgress","valueElement","_applyName","innerHTML","source","Address","addressElement","createRipple","CustomEvent","dispatchEvent","button","currentTarget","container","diameter","max","clientWidth","clientHeight","radius","width","height","x","clientX","offsetLeft","y","clientY","offsetTop","offsetParent","left","top","ripple","_QxConnector","_inherits","_createSuper","__P_81_0","__P_81_1","model","backendName","addAddress","mode","getState","undefined","fireStateUpdate","addUpdateListener","allowDuplicates","encoding","encodedValue","Transform","encodeBusAndRaw","raw","lastSentValue","delay","getClient","write","bus","transformedState","decode","bubbles","cancelable","addressValue","variant","getValue","Clazz","include","JS_LOADED","Promise","_ref","_asyncToGenerator","mark","resolve","reject","timer","counter","_typeof","d3","ScriptLoader","includeScript","_x","_x2","arguments","then","formatDefaultLocale","decimal","thousands","grouping","currency","timeFormatDefaultLocale","dateTime","date","time","periods","days","shortDays","months","shortMonths","CONFIG","_downloadedImage","_url","_headers","_request","_chart","_width","_height","_loaded","_dataSetConfigs","_callee2","_context2","Chart","_loadData","url","client","dataSets","promises","dataSet","ts","showArea","color","end","xFormat","xTicks","timeHour","every","item","split","map","part","toUpperCase","join","timeMinute","timeDay","test","parseFloat","setTime","getTime","getResourcePath","src","Fetch","fetch","hasCustomChartsDataProcessor","processChartsData","_onStatusError","all","responses","_onSuccess","chartData","tsdata","_step3$value","_slicedToArray","minVal","min","d","maxVal","format","_lineChart","z","title","xDomain","extent","yDomain","mixBlendMode","multiTimeFormat","getMilliseconds","getSeconds","getMinutes","getHours","getDay","getDate","getMonth","formatsArray","timeFormat","found","fmt","multiFormat","notifications","Router","dispatchMessage","tr","severity","message","JSON","stringify","c","defined","curve","curveLinear","marginTop","marginRight","marginBottom","marginLeft","xType","scaleTime","xRange","yType","scaleLinear","yRange","yFormat","yLabel","zDomain","strokeLinecap","strokeLinejoin","strokeWidth","strokeOpacity","xPadding","assign","X","Y","Z","O","InternSet","linePath","I","range","has","xScale","yScale","xAxis","axisBottom","ticks","tickSizeOuter","tickFormat","yAxis","axisLeft","T","select","append","dot","_d3$pointer","pointer","_d3$pointer2","xm","ym","least","hypot","property","dispatch","node","targetTouches","pathRect","getBoundingClientRect","passive","g","lineGroups","areaGroups","barGroups","get","size","line","selectAll","p","area","y0","y1","xBarScale","scaleBand","domain","padding","bandwidth","throttleInterval","__P_73_0","Color","setThrottleInterval","_applyThrottleInterval","getThrottleInterval","input","oninput","__P_73_1","Function","throttle","onInput","trailing","abort","__P_73_2","rgb","alpha","backgroundColor","handled","ColorUtil","hsbToRgb","round","toString","padStart","hsvArray","rgbToHsb","hsv","_idRegex","__P_74_0","_transformId","Icon","it","values","_applyId","_applyColor","_createClass","img","base","origin","pathname","URL","useProxy","rest","Client","getBaseUrl","searchParams","btoa","_loadImage","setRefresh","XMLHttpRequest","responseType","setRequestHeader","onreadystatechange","readyState","DONE","createObjectURL","response","onload","revokeObjectURL","random","Image","refine","_target","_timer","_model","_getModel","_filterModel","_sortModel","_limit","refreshOnUpdate","readAddresses","sortBy","sortModifier","right","leftVal","rightVal","localeCompare","res","sent","abrupt","script","innerText","a","List","newModel","whenEmptyTemplate","emptyModel","emptyElem","itemTemplate","t0","isArray","sort","slice","firstElementChild","removeChild","html","replaceAll","p1","p2","ListItem","appearance","depth","domReady","showLabels","_applyAppearance","main","_applyDepth","isDomReady","_generateMenu","_onDomAppended","setDomReady","Bus","unsubscribe","setShowLabels","subscribe","rootList","ham","href","onclick","_onHamburgerMenu","icon","_onPageChange","_onSwipe","currentPage","replaceChildren","__P_75_0","toggle","_closeAll","getDirection","current","previousElementSibling","except","parentList","currentLevel","pages","pageName","pageIcon","li","isShowLabels","createTextNode","getDepth","details","summary","pointerType","offsetX","subList","pageElement","getData","link","activeName","Menu","__P_76_0","__P_76_1","__P_76_2","__P_76_3","__P_76_4","__P_76_5","__P_76_6","__P_76_7","__P_76_8","_queuedFitText","RoundProgress","hasFixedRadius","normalizedRadius","setMin","setMax","code","bg","isPropertyInitialized","getProgress","__P_76_9","angle","angleRad","cos","sin","valueInRange","getMin","percent","getMax","_fitText","__P_76_10","getContext","compStyle","font","metrics","measureText","factor","fontSize","floor","_applyText","__P_77_0","__P_77_1","__P_77_2","Select","option","handle","path","_sendSelection","predictive","children","stepWidth","showValue","__P_78_0","__P_78_1","Slider","setStepWidth","setShowValue","_applyShowValue","decreaseElement","onDecrease","increaseElement","onIncrease","_applyMin","_applyMax","valueLabel","firstChild","isShowValue","__P_78_2","getStepWidth","Spinner","setMode","decrease","decreaseIcon","increase","increaseIcon","getMode","__P_79_0","_queuedOverflowDetection","_debouncedDetectOverflow","Value","debounce","_detectOverflow","setResizeTarget","__P_80_0","setText","_name","__P_82_0","uri","uriString","username","password","backendUrlConfigKey","backendUrl","server","hasClient","configuredIn","notification","topic","unique","deletable","addBackendClient","_client","update","setDefaultBackendName","doSubscribe","_step$value","onUpdate","addressesToSubscribe","getAddresses","isDomFinished","resetDefaultBackendName","terminate","removeClient","dispose","Backend","loaderElement","loadXml","htmlContent","getRenderTarget","xmlns","Request","isSuccessful","handleError","getUrl","textStatus","additionalErrorInfo","actions","Loader","__P_83_0","Mapping","exactMatch","_convert","formula","_formula","defaultValue","isDefaultValue","rangeMin","rangeMax","POSITIVE_INFINITY","floatValue","Styling","widgets","Group","label","_toggleOpen","_supportsContentVisibility","InstallTrigger","contentVisibility","_class2","_super2","_wrapNativeSuper","Page","Popup","_closeButton","timeoutSeconds","_autoCloseTimer","backgroundImage","Tile","setBackgroundImage","resetPopup","_applyBackgroundImage","overlay","closeButton","setPopup","keepState","_applyPopup","restart"],"mappings":"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","sourcesContent":["/* Controller.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Controller for the 'tile' structure.\n *\n * This structure is based on web-components and does not need a parser to work.\n * The config file is directly attached to the document body.\n * The widgets in this structure register a customElement and the browser automatically creates instances\n * of this widgets once the customElement is added to the body.\n *\n * The basic structure is a set of pages that contain a list of tiles.\n * Each tile contains a grid of 3 rows and 3 columns. The components can be added to a cell of that grid\n * but also can spread over more then one cell by using row-/column spanning.\n *\n * This structure provides some tiles with a pre-defined content, e.g. a <cv-switch> which\n * contains of a button in the middle of the tile and a primary- and secondary label in the third row.\n *\n * Those pre-defined tiles are provided by a <template> (@see https://developer.mozilla.org/de/docs/Web/HTML/Element/template}\n * User are able to define own templates for re-usable tiles if they need one that this structure does not provide.\n *\n * @asset(structures/tile/*)\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.Controller', {\n  extend: qx.core.Object,\n  type: 'singleton',\n  implement: cv.ui.structure.IController,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__HTML_STRUCT = '';\n    qx.bom.Stylesheet.includeFile(qx.util.ResourceManager.getInstance().toUri('designs/tile-globals.scss').replace('.scss', '.css') + (cv.Config.forceReload === true ? '?'+Date.now() : ''));\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    // prefix for all custom components uses/provided by this structure\n    PREFIX: 'cv-',\n    __MAP: {},\n    __I: {},\n    register(webComponentName, qxClass) {\n      this.__MAP[webComponentName] = qxClass;\n    },\n\n    onComponentCreated(element) {\n      const name = element.tagName.toLowerCase();\n      if (Object.prototype.hasOwnProperty.call(this, name)) {\n        const QxClass = this.__MAP[name];\n        if (!Object.prototype.hasOwnProperty.call(this, name)) {\n          this.__I[name] = [];\n        }\n        this.__I[name].push(new QxClass(element));\n      } else {\n        qx.log.Logger.error(this, 'no QxClass registered for custom element ' + name);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    /**\n     * The target this structure should be inserted into\n     */\n    renderTarget: {\n      check: 'Element',\n      init: document.body\n    },\n\n    /**\n     * Namespace for path ids\n     */\n    namespace: {\n      check: 'String',\n      init: ''\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __HTML_STRUCT: null,\n    __mappings: null,\n    __stylings: null,\n\n    getHtmlStructure() {\n      return this.__HTML_STRUCT;\n    },\n\n    supports(feature, subfeature) {\n      return false;\n    },\n\n    initLayout() {\n    },\n\n    __gotoStartPage() {\n      // open first page\n      if (!document.location.hash) {\n        this.scrollToPage(this.getInitialPageId());\n      } else {\n        this.scrollToPage(document.location.hash.substring(1));\n      }\n    },\n\n    onHistoryRequest(anchor) {\n      if (anchor) {\n        this.scrollToPage(anchor);\n      }\n    },\n\n    scrollToPage(pageId, skipHistory) {\n      if (!pageId) {\n        return;\n      }\n      const page = document.querySelector('#' + pageId);\n      if (page) {\n        if (!page.classList.contains('active')) {\n          for (let oldPage of document.querySelectorAll('cv-page.active')) {\n            oldPage.classList.remove('active');\n          }\n          for (let oldPage of document.querySelectorAll('cv-page.sub-active')) {\n            oldPage.classList.remove('sub-active');\n          }\n          page.classList.add('active');\n          // mark parent pages that there is a active subpage\n          let parentElement = page.parentElement;\n          while (parentElement && parentElement.nodeName.toLowerCase() !== 'main') {\n            if (parentElement.nodeName.toLowerCase() === 'cv-page') {\n              parentElement.classList.add('sub-active');\n            }\n            parentElement = parentElement.parentElement;\n          }\n\n          if (skipHistory === undefined) {\n            const headline = page.getAttribute('name');\n            let pageTitle = 'CometVisu';\n            if (headline) {\n              pageTitle = headline + ' - '+pageTitle;\n            }\n            qx.bom.History.getInstance().addToHistory(pageId, pageTitle);\n          }\n          qx.event.message.Bus.dispatchByName('cv.ui.structure.tile.currentPage', page);\n        }\n      } else {\n        this.warn('no page with id', pageId, 'found');\n      }\n    },\n\n    // not needed, backend parse/init themselves\n    parseBackendSettings(xml) {\n      if (xml.querySelectorAll('cv-backend').length === 0) {\n        // no backends defined, use the default one;\n        const client = cv.io.BackendConnections.initBackendClient();\n        client.login(true, cv.Config.configSettings.credentials, () => {\n          this.debug('logged in');\n          cv.io.BackendConnections.startInitialRequest();\n        });\n      }\n      return false;\n    },\n\n    /**\n     * Parses structure specific settings\n     * @param config {XMLDocument} loaded config\n     */\n    parseSettings(config) {\n      document.body.classList.add('loading-structure');\n      const settings = cv.Config.configSettings;\n      const configElement = config.documentElement;\n      settings.bindClickToWidget = configElement.getAttribute('bind_click_to_widget') === 'true';\n      this.translate(config);\n\n      if (!cv.Config.cacheUsed) {\n        const templates = qx.util.ResourceManager.getInstance().toUri('structures/tile/templates.xml');\n        const ajaxRequest = new qx.io.request.Xhr(templates);\n        ajaxRequest.set({\n          accept: 'application/xml',\n          cache: !cv.Config.forceReload\n        });\n        ajaxRequest.addListenerOnce('success', e => {\n          let content = e.getTarget().getResponse();\n          const target = this.getRenderTarget();\n          this.debug('creating pages');\n          // register custom elements for templates in this document\n          this.registerTemplates(content);\n          let child;\n          // we need the documents to be in HTML namespace\n          if (!content.documentElement.xmlns) {\n            let text = e.getTarget().getResponseText();\n            text = text.replace('<templates', '<templates xmlns=\"http://www.w3.org/1999/xhtml\"');\n            const parser = new DOMParser();\n            content = parser.parseFromString(text, 'text/xml');\n          }\n          while ((child = content.documentElement.firstElementChild)) {\n            target.appendChild(child);\n          }\n\n          while ((child = configElement.firstElementChild)) {\n            target.appendChild(child);\n          }\n          document.body.classList.remove('loading-structure');\n          this.debug('finalizing');\n          qx.event.message.Bus.dispatchByName('setup.dom.append');\n          this.debug('pages created');\n          this.__gotoStartPage();\n          this.debug('setup.dom.finished');\n          qx.event.message.Bus.dispatchByName('setup.dom.finished.before');\n          cv.TemplateEngine.getInstance().setDomFinished(true);\n        });\n        ajaxRequest.addListener('statusError', function (e) {\n          const status = e.getTarget().getTransport().status;\n          if (!qx.util.Request.isSuccessful(status)) {\n            this.error('filenotfound', templates);\n          }\n          document.body.classList.remove('loading-structure');\n        }, this);\n\n        ajaxRequest.send();\n      }\n    },\n\n    /**\n     * Registers customElements for all templates in the given xml that are direct children of a <templates structure=\"tile\"> element\n     * @param xml {XMLDocument}\n     */\n    registerTemplates(xml) {\n      xml.querySelectorAll('templates[structure=\\'tile\\'] > template').forEach(template => {\n        customElements.define(cv.ui.structure.tile.Controller.PREFIX + template.getAttribute('id'), class extends TemplatedElement {\n          constructor() {\n            super(template.getAttribute('id'));\n          }\n        });\n      });\n    },\n\n    /**\n     * Pre parsing hook, do everything here that is needed before the real parsing process can start\n     * @param xml {XMLDocument}\n     */\n    async preParse(xml) {\n      if (xml.documentElement.hasAttribute('theme')) {\n        let theme = xml.documentElement.getAttribute('theme');\n        const data = {};\n        if (theme === 'system') {\n          if (window.matchMedia) {\n            theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n            document.documentElement.setAttribute('data-theme', theme);\n            data['theme'] = theme;\n            cv.data.Model.getInstance().updateFrom('system', data);\n            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {\n              document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');\n              data['theme'] = e.matches ? 'dark' : 'light';\n              cv.data.Model.getInstance().updateFrom('system', data);\n            });\n          } else {\n            this.error('system theme detection not possible in this browser');\n          }\n        } else {\n          document.documentElement.setAttribute('data-theme', theme);\n          data['theme'] = theme;\n          cv.data.Model.getInstance().updateFrom('system', data);\n        }\n      }\n      return true;\n    },\n\n    /**\n     * Generate the UI code from the config file\n     * @param config {Object} loaded config file usually an XMLDocument but other structures might use different formats\n     */\n    createUI(config) {\n    },\n\n    translate(doc) {\n      for (const attr of ['name', 'label']) {\n        for (const trNameElement of doc.querySelectorAll(`*[${attr}^=\"tr(\"]`)) {\n          const match = /^tr\\('([^']+)'\\)$/.exec(trNameElement.getAttribute(attr));\n          if (!match) {\n            this.warn('attribute content no valid translation string', trNameElement.getAttribute(attr));\n            continue;\n          }\n          const key = match[1];\n          const translation = doc.querySelector(`cv-translations > language[name=\"${qx.locale.Manager.getInstance().getLanguage()}\"] > tr[key='${key}']`);\n          if (translation) {\n            trNameElement.setAttribute(attr, translation.textContent.trim());\n          } else {\n            trNameElement.setAttribute(attr, key);\n            this.warn(`[${qx.locale.Manager.getInstance().getLanguage()}] no translation found for: \"${key}\"`);\n          }\n        }\n      }\n      for (const trTextElement of doc.querySelectorAll('*[tr=\"true\"]')) {\n        const key = trTextElement.textContent.trim();\n        const translation = doc.querySelector(`cv-translations > language[name=\"${qx.locale.Manager.getInstance().getLanguage()}\"] > tr[key='${key}']`);\n        if (translation) {\n          trTextElement.textContent = translation.textContent.trim();\n        } else {\n          this.warn(`[${qx.locale.Manager.getInstance().getLanguage()}] no translation found for: \"${key}\"`);\n        }\n      }\n    },\n\n    /**\n     * Handle fired event from screensaver\n     * @return {Array<string>} Array with addresses\n     */\n    doScreenSave() {\n      if (cv.Config.configSettings.screensave_page) {\n        this.scrollToPage(cv.Config.configSettings.screensave_page);\n      }\n    },\n\n    /**\n     * Return the addresses needed to update all states on the initially loaded page\n     */\n    getInitialAddresses() {\n      return [];\n    },\n\n    /**\n     * Returns the widget id of the page item initially loaded\n     * @returns {String} widget path like 'id_'...\n     */\n    getInitialPageId() {\n      const firstPage = document.querySelector('cv-page');\n      return firstPage ? firstPage.id : '';\n    },\n\n    /**\n     *\n     * @param name {String} mapping name\n     * @param mapping {cv.ui.structure.tile.elements.Mapping}\n     */\n    addMapping(name, mapping) {\n      if (!this.__mappings) {\n        this.__mappings = {};\n      }\n      this.__mappings[name] = mapping;\n    },\n\n    removeMapping(name) {\n      if (this.__mappings) {\n        delete this.__mappings[name];\n      }\n    },\n\n    mapValue(mappingName, value, store) {\n      if (this.__mappings && Object.prototype.hasOwnProperty.call(this.__mappings, mappingName)) {\n        return this.__mappings[mappingName].mapValue(value, store);\n      }\n      return value;\n    },\n\n    /**\n     * @param name {String} styling name\n     * @param styling {cv.ui.structure.tile.elements.Styling}\n     */\n    addStyling(name, styling) {\n      if (!this.__stylings) {\n        this.__stylings = {};\n      }\n      this.__stylings[name] = styling;\n    },\n\n    removeStyling(name) {\n      if (this.__stylings) {\n        delete this.__stylings[name];\n      }\n    },\n\n    styleValue(stylingName, value, store) {\n      if (this.__stylings && Object.prototype.hasOwnProperty.call(this.__stylings, stylingName)) {\n        return this.__stylings[stylingName].mapValue(value, store);\n      }\n      return value;\n    }\n  },\n  defer: function (statics) {\n    if (!window.cvTestMode) {\n      // do not apply ourselves automatically in test mode\n      cv.Application.structureController = statics.getInstance();\n    }\n  }\n});\n\nclass TemplatedElement extends HTMLElement {\n  constructor(templateId) {\n    super();\n    const controller = cv.ui.structure.tile.Controller.getInstance();\n    let template = document.getElementById(templateId);\n    if (template) {\n      const slotAttributes = ['name', 'replaces', 'parent-scope'];\n      const content = template.content.cloneNode(true);\n      // move slots into template\n      for (let slot of content.querySelectorAll('slot')) {\n        const slotName = slot.getAttribute('name');\n        const replacementSelector = slot.hasAttribute('replaces') ? slot.getAttribute('replaces') : '';\n        const slotParentScope = slot.hasAttribute('parent-scope') ? parseInt(slot.getAttribute('parent-scope')) : 0;\n        let slotContents = this.querySelectorAll(`[slot='${slotName}']`);\n        const attrs = {};\n        for (let i = 0, l = slot.attributes.length; i < l; i++) {\n          if (!slotAttributes.includes(slot.attributes[i].name)) {\n            attrs[slot.attributes[i].name] = slot.attributes[i].value;\n          }\n        }\n        if (slotContents.length > 0) {\n          Array.from(slotContents).forEach(slotContent => {\n            const newNode = slotContent.cloneNode(true);\n            Object.keys(attrs).forEach(attrName => {\n              if (newNode.hasAttribute(attrName)) {\n                if (attrName === 'class') {\n                  // append it\n                  newNode.classList.add(attrs[attrName]);\n                } else {\n                  qx.log.Logger.debug(controller, '['+templateId+'] attribute', attrName, 'already set, skipping');\n                }\n              } else {\n                newNode.setAttribute(attrName, attrs[attrName]);\n              }\n            });\n            newNode.removeAttribute('slot');\n            slot.parentNode.insertBefore(newNode, slot);\n          });\n          slot.remove();\n          if (replacementSelector) {\n            content.querySelectorAll(replacementSelector).forEach(replaced => {\n              replaced.remove();\n            });\n          }\n        } else {\n          qx.log.Logger.debug(controller, '['+templateId+'] no content for slot', slotName, ' removing');\n\n          let parentNode = slot.parentNode;\n          if (slotParentScope > 0) {\n            // got slotParentScope elements up and remove that one\n            let i = slotParentScope-1;\n            while (i > 0) {\n              parentNode = parentNode.parentNode;\n              i--;\n            }\n            if (parentNode) {\n              parentNode.remove();\n            }\n          } else {\n            slot.remove();\n            if (parentNode.children.length === 0) {\n              // also remove slots parent when it has no content\n              parentNode.remove();\n            }\n          }\n        }\n      }\n      // transfer attribute slots\n      const attributes = this.getAttributeNames();\n      attributes.forEach(name => {\n        let value = this.getAttribute(name);\n        const targets = content.querySelectorAll('[slot-'+name+']');\n        let targetName = name;\n        // allow names like percent-mapping that should also be mapped to a certain elements 'mapping' attribute\n        if (name.endsWith('-mapping')) {\n          targetName = 'mapping';\n        } else if (name.endsWith('-styling')) {\n          targetName = 'styling';\n        } else if (name.endsWith('-format')) {\n          targetName = 'format';\n        }\n        targets.forEach(target => {\n          if (targetName !== name && target.hasAttribute('slot-' + name)) {\n            target.setAttribute(name, value || target.getAttribute('slot-'+name));\n            target.removeAttribute('slot-'+name);\n          } else {\n            target.setAttribute(targetName, value || target.getAttribute('slot-'+targetName));\n            target.removeAttribute('slot-'+targetName);\n          }\n        });\n        if (targets.length > 0) {\n          this.removeAttribute(name);\n        }\n      });\n      content.querySelectorAll('*')\n        .forEach(elem => {\n          [...elem.attributes].forEach(attr => {\n            if (attr.name.startsWith('slot-')) {\n              let targetName = attr.name.substring(5);\n              // only e.g. map slot-progress-mapping to mapping if we have no slot-mapping attribute\n              if (attr.name.endsWith('-mapping') && elem.hasAttribute('slot-mapping')) {\n                targetName = 'mapping';\n              } else if (attr.name.endsWith('-styling') && elem.hasAttribute('slot-styling')) {\n                targetName = 'styling';\n              } else if (attr.name.endsWith('-format') && elem.hasAttribute('slot-format')) {\n                targetName = 'format';\n              }\n              if (attr.value) {\n                elem.setAttribute(targetName, attr.value);\n              }\n              elem.removeAttribute(attr.name);\n            }\n          });\n        });\n      \n      // clear content\n      this.innerHTML = '';\n      this.appendChild(content);\n    } else {\n      qx.log.Logger.error(controller, '['+templateId+'] no template found for id', templateId);\n    }\n  }\n}\n","/* MPopup.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Handles cv-popup children and some general popup tasks, like global registration and close on click outside, modal blocker etc.\n */\nqx.Mixin.define('cv.ui.structure.tile.MPopup', {\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    openedPopups: []\n  },\n\n  events: {\n    closed: 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _childPopup: null,\n\n    _initPopupChild() {\n      const popup = this._childPopup = this._element.querySelector(':scope > cv-popup');\n      if (popup) {\n        qx.event.Registration.addListener(this._element, 'tap', this._openPopupChild, this);\n        // we need to tell the parent widget that is inside a group that wen have a popup here\n        let parent = popup.parentElement;\n        let last;\n        while (parent) {\n          if (parent.tagName.toLowerCase() === 'cv-group') {\n            last.classList.add('has-popup');\n          } else if (parent.tagName.toLowerCase() === 'cv-page') {\n            break;\n          }\n          last = parent;\n          parent = parent.parentElement;\n        }\n      }\n    },\n\n    _openPopupChild() {\n      const popup = this._element.querySelector(':scope > cv-popup:not([open])');\n      if (popup) {\n        popup.getInstance().open();\n      }\n    },\n\n    _closePopupChild() {\n      const popup = this._element.querySelector(':scope > cv-popup[open]');\n      if (popup) {\n        popup.getInstance().close();\n      }\n    },\n\n    registerModalPopup() {\n      qx.event.Registration.addListener(document, 'pointerdown', this._onPointerDown, this);\n      let blocker = document.body.querySelector('.modal-popup-blocker');\n      if (!blocker) {\n        blocker = document.createElement('div');\n        blocker.classList.add('modal-popup-blocker');\n        document.body.appendChild(blocker);\n      }\n      blocker.style.display = 'block';\n      cv.ui.structure.tile.MPopup.openedPopups.push(this);\n    },\n\n    unregisterModalPopup() {\n      qx.event.Registration.removeListener(document, 'pointerdown', this._onPointerDown, this);\n      const index = cv.ui.structure.tile.MPopup.openedPopups.indexOf(this);\n      cv.ui.structure.tile.MPopup.openedPopups.splice(index, 1);\n      let blocker = document.body.querySelector('.modal-popup-blocker');\n      if (blocker && cv.ui.structure.tile.MPopup.openedPopups.length === 0) {\n        blocker.style.display = 'none';\n      }\n    },\n\n    _onPointerDown(ev) {\n      if (!cv.util.Tree.isChildOf(ev.getTarget(), this._element)) {\n        // clicked outside -> close\n        this.close();\n        ev.preventDefault();\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.Registration.removeListener(this._element, 'tap', this._openPopupChild, this);\n    this._childPopup = null;\n  }\n});\n","/* MRefresh.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Adds a refresh attribute that triggers a 'refresh' method which must be implemented by classes including this mixin.\n */\nqx.Mixin.define('cv.ui.structure.tile.MRefresh', {\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    refresh: {\n      check: 'Number',\n      init: 0,\n      apply: '_applyRefresh'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _refreshTimer: null,\n    _lastRefresh: null,\n\n    _applyRefresh(value) {\n        if (value === 0) {\n          if (this._refreshTimer) {\n            this._refreshTimer.stop();\n          }\n        } else if (!this._refreshTimer) {\n          this._refreshTimer = new qx.event.Timer(value * 1000);\n          this._refreshTimer.addListener('interval', this.__doRefresh, this);\n          if (typeof this.isVisible === 'function') {\n            if (this.isVisible()) {\n              this._refreshTimer.start();\n            }\n          } else {\n            this._refreshTimer.start();\n          }\n        } else {\n          this._refreshTimer.restartWith(value * 1000);\n        }\n    },\n\n    _applyVisible(isVisible) {\n      if (isVisible) {\n        if (this._refreshTimer) {\n          this._refreshTimer.start();\n          if (!this._lastRefresh || (Date.now() - this._lastRefresh) >= this._refreshTimer.getInterval()) {\n            // last execution time too old, refresh now\n            this.__doRefresh();\n          }\n        } else if (!this._lastRefresh) {\n          // refresh once when the item becomes visible\n          this.__doRefresh();\n        }\n      } else if (this._refreshTimer) {\n        this._refreshTimer.stop();\n      }\n    },\n\n    __doRefresh() {\n      if (typeof this.refresh === 'function') {\n        this.refresh();\n        this._lastRefresh = Date.now();\n      } else {\n        this.error('refresh method must be implemented!');\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_refreshTimer');\n  }\n});\n","/* MResize.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Detects dom elements resizing\n * @ignore(ResizeObserver)\n */\nqx.Mixin.define('cv.ui.structure.tile.MResize', {\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this._observer = new ResizeObserver((entries, observer) => {\n      const element = this.getResizeTarget();\n      entries.some(entry => {\n        if (entry.target === element) {\n          this.fireDataEvent('resized', entry);\n          return true;\n        }\n        return false;\n      });\n    });\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    resized: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    resizeTarget: {\n      check: 'Element',\n      nullable: true,\n      apply: '_applyResizeTarget'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {ResizeObserver}\n     */\n    _observer: null,\n\n    _applyResizeTarget(element, oldElement) {\n      if (oldElement) {\n        this._observer.unobserve(oldElement);\n      }\n      if (element) {\n        this._observer.observe(element);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._observer.disconnect();\n    this._observer = null;\n  }\n});\n","/* MVisibility.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Detects dom elements visibility\n * @ignore(IntersectionObserver)\n */\nqx.Mixin.define('cv.ui.structure.tile.MVisibility', {\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this._observeVisibility();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    observer: new IntersectionObserver((entries, observer) => {\n      entries.forEach(entry => {\n        if (entry.target._instance) {\n          entry.target._instance.setVisible(entry.intersectionRatio > 0);\n        }\n      });\n    })\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    visible: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyVisible'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _observeVisibility() {\n      if (this._element) {\n        cv.ui.structure.tile.MVisibility.observer.observe(this._element);\n      } else {\n        this.warn('no element to observe defined');\n      }\n    }\n  }\n});\n","/* AbstractCustomElement.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.ui.structure.tile.elements.AbstractCustomElement', {\n  extend: qx.core.Object,\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (element) {\n    this._element = element;\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    connected: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyConnected',\n      event: 'changeConnected'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {HTMLElement}\n     */\n    _element: null,\n\n    _initialized: false,\n\n    _applyConnected(value) {\n      if (value && !this._initialized) {\n        this._init();\n        this._initialized = true;\n      } else {\n        this._disconnected();\n        this._initialized = false;\n      }\n    },\n    _init() {},\n\n    _disconnected() {},\n\n    getElement() {\n      return this._element;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._element = null;\n  }\n});\n\n// eslint-disable-next-line no-unused-vars\nclass QxConnector extends HTMLElement {\n  constructor(QxClass) {\n    super();\n    if (qx.Class.isSubClassOf(QxClass, cv.ui.structure.tile.elements.AbstractCustomElement)) {\n      this._instance = new QxClass(this);\n    } else {\n      throw Error(QxClass + ' must be a subclass of cv.ui.structure.tile.elements.AbstractCustomElement');\n    }\n    if (this.hasAttribute('colspan')) {\n      this.classList.add('colspan-' + this.getAttribute('colspan'));\n    }\n    if (this.hasAttribute('rowspan')) {\n      this.classList.add('rowspan-' + this.getAttribute('rowspan'));\n    }\n  }\n\n  getInstance() {\n    return this._instance;\n  }\n\n  connectedCallback() {\n    if (this._instance) {\n      this._instance.setConnected(true);\n    }\n  }\n\n  disconnectedCallback() {\n    if (this._instance) {\n      this._instance.setConnected(false);\n    }\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (this._instance && qx.Class.hasProperty(this._instance.constructor, name)) {\n      this._instance.set(name, newValue);\n    }\n  }\n}\n\nwindow.QxConnector = QxConnector;\n",null,"/* AbstractComponent.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Base class for all components.\n */\nqx.Class.define('cv.ui.structure.tile.components.AbstractComponent', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    value: {\n      apply: '_applyValue',\n      init: null\n    },\n    styleClass: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyStyleClass'\n    },\n    enabled: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyEnabled'\n    },\n    visibility: {\n      check: ['visible', 'excluded', 'hidden'],\n      init: 'visible',\n      apply: '_applyVisibility',\n      event: 'changeVisibility'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _writeAddresses: null,\n    _visibleDisplayMode: null,\n\n    _init() {\n      const element = this._element;\n      let hasReadAddress = false;\n      const writeAddresses = [];\n      Array.prototype.forEach.call(element.querySelectorAll(':scope > cv-address'), address => {\n        const mode = address.hasAttribute('mode') ? address.getAttribute('mode') : 'readwrite';\n        switch (mode) {\n          case 'readwrite':\n            hasReadAddress = true;\n            writeAddresses.push(address);\n            break;\n          case 'read':\n            hasReadAddress = true;\n            break;\n          case 'write':\n            writeAddresses.push(address);\n            break;\n        }\n      });\n\n      this._writeAddresses = writeAddresses;\n\n      if (hasReadAddress) {\n        element.addEventListener('stateUpdate', ev => {\n          this.onStateUpdate(ev);\n          // cancel event here\n          ev.stopPropagation();\n        });\n      }\n    },\n\n    // property apply\n    _applyValue(value) {\n      if (this.isConnected()) {\n        this._element.setAttribute('value', value || '');\n        let mappedValue = value;\n        if (this._element.hasAttribute('mapping')) {\n          mappedValue = cv.Application.structureController.mapValue(this._element.getAttribute('mapping'), value);\n        }\n        if (this._element.hasAttribute('format')) {\n          mappedValue = cv.util.String.sprintf(this._element.getAttribute('format'), mappedValue instanceof Date ? mappedValue.toLocaleString() : mappedValue);\n        }\n        this._updateValue(mappedValue, value);\n        if (this._element.hasAttribute('styling')) {\n          let styleClass = cv.Application.structureController.styleValue(this._element.getAttribute('styling'), value);\n          this.setStyleClass(styleClass);\n        }\n      }\n    },\n\n    // needs to be implemented by inheriting classes\n    _updateValue(mappedValue, value) {\n    },\n\n    // property apply\n    _applyStyleClass(value, oldValue) {\n      const classes = this._element.classList;\n      if (oldValue) {\n        if (classes.contains(oldValue)) {\n          classes.replace(oldValue, value);\n        } else {\n          classes.add(value);\n          classes.remove(oldValue);\n        }\n      } else if (value) {\n        classes.add(value);\n      }\n    },\n\n    _applyEnabled(value) {\n      let blocker = this._element.querySelector(':scope > .blocker');\n      if (!blocker) {\n        blocker = document.createElement('div');\n        blocker.classList.add('blocker');\n        this._element.appendChild(blocker);\n        blocker.addEventListener('click', ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n        });\n        blocker.addEventListener('pointerdown', ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n        });\n        blocker.addEventListener('pointerup', ev => {\n          ev.preventDefault();\n          ev.stopPropagation();\n        });\n      }\n      this._element.setAttribute('disabled', value === false ? 'true' : 'false');\n      blocker.style.display = value === true ? 'none' : 'block';\n    },\n\n    _applyVisibility(value, oldValue) {\n      if (oldValue === 'hidden') {\n        this._element.style.opacity = '1.0';\n      }\n      switch (value) {\n        case 'visible':\n          if (this._visibleDisplayMode) {\n            this._element.style.display = this._visibleDisplayMode || 'initial';\n          }\n          break;\n\n        case 'hidden':\n          this._element.style.opacity = '0';\n          break;\n\n        case 'excluded':\n          this._visibleDisplayMode = getComputedStyle(this._element).getPropertyValue('display');\n          this._element.style.display = 'none';\n          break;\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     * @return {Boolean} true of the update has been handled\n     */\n    onStateUpdate(ev) {\n      switch (ev.detail.target) {\n        case 'enabled':\n          this.setEnabled(ev.detail.state);\n          ev.stopPropagation();\n          return true;\n        case 'show-exclude':\n          this.setVisibility(ev.detail.state ? 'visible' : 'excluded');\n          ev.stopPropagation();\n          return true;\n        case 'show-hide':\n          this.setVisibility(ev.detail.state ? 'visible' : 'hidden');\n          ev.stopPropagation();\n          return true;\n        case '':\n          this.setValue(ev.detail.state);\n          ev.stopPropagation();\n          return true;\n      }\n      return false;\n    }\n  }\n});\n","/* Button.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.components.Button', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (element) {\n    this.base(arguments, element);\n    this.__store = new Map();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: ['button', 'trigger', 'push'],\n      init: 'button'\n    },\n    on: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyOn'\n    },\n    onClass: {\n      check: 'String',\n      init: 'active'\n    },\n    offClass: {\n      check: 'String',\n      init: 'inactive'\n    },\n    onValue: {\n      check: 'String',\n      init: '1'\n    },\n    offValue: {\n      check: 'String',\n      init: '0'\n    },\n    styleClass: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyStyleClass'\n    },\n    name: {\n      check: 'String',\n      init: '',\n      apply: '_applyName'\n    },\n    progress: {\n      check: 'Number',\n      init: -1,\n      apply: '_applyProgress',\n      transform: '_parseInt'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _writeAddresses: null,\n    __textLabel: null,\n    __circumference: null,\n    /**\n     * @var {Map} value store for addresses to be able to use them e.g. in mapping formulas\n     */\n    __store: null,\n\n    _parseInt(val) {\n      const intVal = parseInt(val);\n      return Number.isNaN(intVal) ? 0 : intVal;\n    },\n\n    _init() {\n      const element = this._element;\n      if (element.hasAttribute('type')) {\n        this.setType(element.getAttribute('type'));\n      }\n      if (element.hasAttribute('name')) {\n        this.setName(element.getAttribute('name'));\n      }\n      if (element.hasAttribute('progress')) {\n        this.setProgress(element.getAttribute('progress'));\n      }\n      if (element.hasAttribute('on-value')) {\n        this.setOnValue(element.getAttribute('on-value'));\n      }\n      if (element.hasAttribute('off-value')) {\n        this.setOffValue(element.getAttribute('off-value'));\n      }\n      let hasReadAddress = false;\n      let writeAddresses = [];\n      Array.prototype.forEach.call(element.querySelectorAll(':scope > cv-address'), address => {\n        const mode = address.hasAttribute('mode') ? address.getAttribute('mode') : 'readwrite';\n        switch (mode) {\n          case 'readwrite':\n            hasReadAddress = true;\n            writeAddresses.push(address);\n            break;\n          case 'read':\n            hasReadAddress = true;\n            break;\n          case 'write':\n            writeAddresses.push(address);\n            break;\n        }\n      });\n      this._writeAddresses = writeAddresses;\n\n      if (writeAddresses.length > 0) {\n        const events = {};\n        let eventSource = element;\n        if (element.getAttribute('whole-tile') === 'true') {\n          // find parent tile and use it as event source\n          let parent = element.parentElement;\n          let level = 0;\n          while (level <= 2) {\n            parent = parent.parentElement;\n            level++;\n            if (parent.tagName.toLowerCase() === 'cv-tile') {\n              eventSource = parent;\n              eventSource.classList.add('clickable');\n            }\n          }\n        }\n        writeAddresses.forEach(addr => {\n          let event = addr.hasAttribute('on') ? addr.getAttribute('on') : 'click';\n          switch (event) {\n            case 'click':\n              events.click = this.onClicked.bind(this);\n              break;\n            case 'up':\n              events.pointerup = this.onPointerUp.bind(this);\n              break;\n            case 'down':\n              events.pointerdown = this.onPointerDown.bind(this);\n              break;\n          }\n        });\n        Object.getOwnPropertyNames(events).forEach(eventName => eventSource.addEventListener(eventName, ev => {\n          events[eventName](ev);\n        }));\n      }\n      if (hasReadAddress) {\n        element.addEventListener('stateUpdate', ev => {\n          this.onStateUpdate(ev);\n          // cancel event here\n          ev.stopPropagation();\n        });\n      } else if (element.hasAttribute('mapping') || element.hasAttribute('styling')) {\n        // apply the trigger state\n        const triggerAddresses = writeAddresses.filter(addr => addr.hasAttribute('value') && !addr.hasAttribute('on'));\n        if (triggerAddresses.length === 1) {\n          const value = triggerAddresses[0].getAttribute('value');\n          qx.event.Timer.once(() => {\n            // using == comparisons to make sure that e.g. 1 equals \"1\"\n            // noinspection EqualityComparisonWithCoercionJS\n            this.setOn(value == this.getOnValue());\n          }, this, 1000);\n        }\n      }\n\n      // detect button type\n      if (!hasReadAddress && writeAddresses.filter(addr => addr.hasAttribute('value') && !addr.hasAttribute('on')).length === 1) {\n        // only one write address with a fixed value and no special event => simple trigger\n        this.setType('trigger');\n      } else {\n        let hasDown = false;\n        let hasUp = false;\n        writeAddresses.some(addr => {\n          if (addr.hasAttribute('value') && addr.hasAttribute('on')) {\n            if (!hasDown) {\n              hasDown = addr.getAttribute('on') === 'down';\n            }\n            if (!hasUp) {\n              hasUp = addr.getAttribute('on') === 'up';\n            }\n          }\n          return hasUp && hasDown;\n        });\n        if (hasUp && hasDown) {\n          // has an address for up and one for down event with a fixed value -> pushbutton\n          this.setType('push');\n        }\n      }\n    },\n\n    _initProgress() {\n      const element = this._element;\n      this.__circumference = 100 * Math.PI;\n      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      svg.setAttribute('viewBox', '0 0 100 100');\n      svg.setAttribute('type', 'circle');\n      const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n      circle.classList.add('bar');\n      circle.setAttribute('r', '49');\n      circle.setAttribute('cx', '50');\n      circle.setAttribute('cy', '50');\n      circle.setAttribute('stroke-width', '2');\n      circle.setAttribute('stroke-dasharray', this.__circumference + ' ' + this.__circumference);\n      circle.setAttribute('stroke-dashoffset', '' + this.__circumference);\n      svg.appendChild(circle);\n      element.appendChild(svg);\n      // make sure that we do not override the progress bar by state appearance\n      element.classList.add('progress');\n    },\n\n    _applyConnected(value) {\n      this.base(arguments, value);\n      if (value) {\n        if (this.getType() !== 'trigger') {\n          // delay this because we need the mappings to be ready\n          qx.event.Timer.once(this._applyOn, this, 1000);\n        }\n      }\n    },\n    _applyOn() {\n      if (this.isConnected()) {\n        let value = this.isOn() ? this.getOnValue() : this.getOffValue();\n        this._element.setAttribute('value', value || '');\n        let mappedValue = value;\n        if (this._element.hasAttribute('mapping')) {\n          mappedValue = cv.Application.structureController.mapValue(this._element.getAttribute('mapping'), value, this.__store);\n        }\n        const target = this._element.querySelector('.value');\n        if (target && target.tagName.toLowerCase() === 'cv-icon') {\n          if (target._instance) {\n            target._instance.setId(mappedValue);\n          } else {\n            target.textContent = mappedValue;\n          }\n        } else {\n          this.updateValue(mappedValue);\n        }\n        let styleClass = this.isOn() ? this.getOnClass() : this.getOffClass();\n        if (this._element.hasAttribute('styling')) {\n          styleClass = cv.Application.structureController.styleValue(this._element.getAttribute('styling'), value, this.__store);\n        }\n        this.setStyleClass(styleClass);\n      }\n    },\n\n    _applyProgress(value) {\n      let valueElement = this._element.querySelector(':scope > svg > circle.bar');\n      if (!valueElement) {\n        this._initProgress();\n        valueElement = this._element.querySelector(':scope > svg > circle.bar');\n      }\n      if (valueElement) {\n        if (this._element.hasAttribute('progress-mapping')) {\n          value = cv.Application.structureController.mapValue(this._element.getAttribute('progress-mapping'), value, this.__store);\n        }\n        valueElement.setAttribute('stroke-dashoffset', '' + (this.__circumference - value / 100 * this.__circumference));\n      }\n    },\n\n    _applyStyleClass(value, oldValue) {\n      const classes = this._element.classList;\n      if (oldValue) {\n        if (classes.contains(oldValue)) {\n          classes.replace(oldValue, value);\n        } else {\n          classes.add(value);\n          classes.remove(oldValue);\n        }\n      } else if (value) {\n        classes.add(value);\n      }\n    },\n\n    _applyName(value) {\n      if (!this.__textLabel) {\n        this.__textLabel = document.createElement('label');\n        this.__textLabel.classList.add('button-label');\n        this._element.appendChild(this.__textLabel);\n      }\n      this.__textLabel.textContent = value;\n    },\n\n    updateValue(value) {\n      const elem = this._element.querySelector('span.value');\n      if (elem) {\n        elem.innerHTML = value;\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      // using == comparisons to make sure that e.g. 1 equals \"1\"\n      // noinspection EqualityComparisonWithCoercionJS\n      let value = ev.detail.state == this.getOnValue();\n      let target = ev.detail.target || 'default';\n      if (ev.detail.source instanceof cv.ui.structure.tile.elements.Address) {\n        const addressElement = ev.detail.source.getElement();\n        if (addressElement.hasAttribute('value')) {\n          // noinspection EqualityComparisonWithCoercionJS\n          value = ev.detail.state == addressElement.getAttribute('value');\n        }\n      }\n      if (target === 'default') {\n        this.setOn(value);\n      } else if (target === 'progress') {\n        this.setProgress(ev.detail.state);\n      } else if (target.startsWith('store:')) {\n        this.__store.set(target.substring(6), ev.detail.state);\n      }\n    },\n\n    onClicked(event) {\n      this.createRipple(event);\n      if (!this._writeAddresses) {\n        this._writeAddresses = Array.prototype.filter.call(this._element.querySelectorAll('addresses > cv-address'),\n          address => !address.hasAttribute('mode') || address.getAttribute('mode') !== 'read');\n      }\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: this.isOn() ? this.getOffValue() : this.getOnValue(),\n          source: this\n        }\n      });\n      if (this.getType() === 'trigger') {\n        // simulate feedback\n        this.setOn(true);\n        qx.event.Timer.once(() => {\n          this.setOn(false);\n        }, null, 250);\n      }\n      this._writeAddresses.filter(addr => !addr.hasAttribute('on') || addr.getAttribute('on') === 'click').forEach(address => address.dispatchEvent(ev));\n      event.stopPropagation();\n    },\n\n    onPointerDown() {\n      this._writeAddresses.filter(addr => addr.getAttribute('on') === 'down' && addr.hasAttribute('value')).forEach(address => {\n        address.dispatchEvent(new CustomEvent('sendState', {\n          detail: {\n            value: address.getAttribute('value'),\n            source: this\n          }\n        }));\n      });\n    },\n\n    onPointerUp() {\n      this._writeAddresses.filter(addr => addr.getAttribute('on') === 'up' && addr.hasAttribute('value')).forEach(address => {\n        address.dispatchEvent(new CustomEvent('sendState', {\n          detail: {\n            value: address.getAttribute('value'),\n            source: this\n          }\n        }));\n      });\n    },\n\n    createRipple(event) {\n      const button = event.currentTarget;\n      let container = button.querySelector(':scope .ripple-container');\n      if (!container) {\n        container = document.createElement('div');\n        container.classList.add('ripple-container');\n        button.appendChild(container);\n      }\n      const circle = document.createElement('span');\n      const diameter = Math.max(button.clientWidth, button.clientHeight);\n      const radius = diameter / 2;\n      circle.style.width = circle.style.height = `${diameter}px`;\n      let x = event.clientX - (button.offsetLeft + radius);\n      let y = event.clientY - (button.offsetTop + radius);\n      if (button === this._element) {\n        x -= button.offsetParent.offsetLeft;\n        y -= button.offsetParent.offsetTop;\n      }\n      circle.style.left = `${x}px`;\n      circle.style.top = `${y}px`;\n      circle.classList.add('ripple');\n      // remove old ones\n      container.querySelectorAll('.ripple').forEach(ripple => ripple.remove());\n      container.appendChild(circle);\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'button', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Address.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Address element that connect a widget/component to the backend.\n *\n *  @author Tobias Bräutigam\n *  @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.elements.Address', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __lastValue: null,\n    __transformedValue: null,\n\n    _init() {\n      const element = this._element;\n      const address = element.textContent.trim();\n      if (address) {\n        const model = cv.data.Model.getInstance();\n        const backendName = element.getAttribute('backend');\n        model.addAddress(address, element.getAttribute('id'), backendName);\n        const mode = element.hasAttribute('mode') ? element.getAttribute('mode') : 'readwrite';\n        if (mode !== 'write') {\n          // subscribe\n          // this is a read address register for updates\n          const state = model.getState(address, backendName);\n          if (state !== undefined) {\n            this.fireStateUpdate(address, state);\n          }\n          //add listener\n          model.addUpdateListener(address, this.fireStateUpdate, this, backendName);\n        }\n        if (mode !== 'read') {\n          // listen for sendState events\n          element.addEventListener('sendState', ev => {\n            let value = null;\n            if (Object.prototype.hasOwnProperty.call(ev.detail, 'value')) {\n              value = ev.detail.value;\n            }\n            if (element.hasAttribute('value')) {\n              // address has a fixed value that must be sent\n              value = element.getAttribute('value');\n            }\n            const allowDuplicates = ev.detail.source &&\n              ev.detail.source instanceof cv.ui.structure.tile.components.Button &&\n              (ev.detail.source.getType() === 'trigger' || ev.detail.source.getType() === 'push');\n            if (value !== null) {\n              const encoding = element.getAttribute('transform') || 'raw';\n              const encodedValue = cv.Transform.encodeBusAndRaw({transform: encoding}, value);\n              // noinspection EqualityComparisonWithCoercionJS\n              if (allowDuplicates ||\n                !Object.prototype.hasOwnProperty.call(element, 'lastSentValue') ||\n                encodedValue.raw !== element.lastSentValue) {\n                if (element.hasAttribute('delay')) {\n                  const delay = parseInt(element.getAttribute('delay'));\n                  this.debug(`send with delay of ${delay}ms`);\n                  qx.event.Timer.once(() => {\n                    cv.io.BackendConnections.getClient(backendName).write(element.textContent, encodedValue.bus, element);\n                    if (!allowDuplicates) {\n                      element.lastSentValue = encodedValue.raw;\n                    }\n                  }, this, delay);\n                } else {\n                  cv.io.BackendConnections.getClient(backendName).write(element.textContent, encodedValue.bus, element);\n                  if (!allowDuplicates) {\n                    element.lastSentValue = encodedValue.raw;\n                  }\n                }\n              }\n            }\n          });\n        }\n      }\n    },\n\n    /**\n     * Creates a 'stateUpdate' event with the transformed value and dispatches it to the <cv-address>-Element.\n     * @param address {String} address\n     * @param state {variant} state to send\n     */\n    fireStateUpdate(address, state) {\n      if (this.__lastValue !== state || this._element.getAttribute('send-mode') === 'always') {\n        let transform = this._element.getAttribute('transform') || 'raw';\n        let transformedState = cv.Transform.decode({transform: transform}, state);\n        let mapping = '';\n        if (this._element.hasAttribute('mapping')) {\n          mapping = this._element.getAttribute('mapping');\n          transformedState = cv.Application.structureController.mapValue(mapping, transformedState);\n        }\n        if (this._element.hasAttribute('format')) {\n          transformedState = cv.util.String.sprintf(this._element.getAttribute('format'), transformedState instanceof Date ? transformedState.toLocaleString() : transformedState);\n        }\n        const ev = new CustomEvent('stateUpdate', {\n          bubbles: true,\n          cancelable: true,\n          detail: {\n            address: this._element.textContent.trim(),\n            state: transformedState,\n            target: this._element.getAttribute('target') || '',\n            raw: state,\n            mapping: mapping,\n            addressValue: this._element.hasAttribute('value') ? this._element.getAttribute('value') : null,\n            source: this,\n            variant: this._element.hasAttribute('variant') ? this._element.getAttribute('variant') : null\n          }\n        });\n        this.__transformedValue = transformedState;\n        //console.log(ev.detail);\n        this._element.dispatchEvent(ev);\n        this.__lastValue = state;\n        // reset lastSentValue\n        if (state !== this._element.lastSentValue) {\n          this._element.lastSentValue = null;\n        }\n      }\n    },\n\n    getValue() {\n      return this.__transformedValue;\n    }\n  },\n\n  defer(Clazz) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'address', class extends QxConnector {\n      constructor() {\n        super(Clazz);\n      }\n    });\n  }\n});\n","/* Chart.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/* eslint-disable arrow-body-style */\n/**\n * Shows an chart.\n * @asset(libs/d3.min.js)\n * @ignore(d3)\n */\nqx.Class.define('cv.ui.structure.tile.components.Chart', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: cv.ui.structure.tile.MVisibility,\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    JS_LOADED: new Promise(async (resolve, reject) => {\n      const check = () => typeof window.d3 === 'object';\n      await cv.util.ScriptLoader.includeScript(qx.util.ResourceManager.getInstance().toUri('libs/d3.min.js'));\n      if (!check()) {\n        const timer = new qx.event.Timer(50);\n        let counter = 0;\n        timer.addListener('interval', () => {\n          counter++;\n          if (check()) {\n            resolve(true);\n          } else if (counter > 5) {\n            reject(new Error('Error loaded d3 library'));\n          }\n        });\n      } else {\n        resolve(true);\n      }\n    }).then(() => {\n      if (qx.locale.Manager.getInstance().getLanguage() === 'de') {\n        // localize\n        d3.formatDefaultLocale({\n          'decimal': ',',\n          'thousands': '.',\n          'grouping': [3],\n          'currency': ['€', '']\n        });\n\n        d3.timeFormatDefaultLocale({\n          'dateTime': '%A, der %e. %B %Y, %X',\n          'date': '%d.%m.%Y',\n          'time': '%H:%M:%S',\n          'periods': ['AM', 'PM'],\n          'days': ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],\n          'shortDays': ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],\n          'months': ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],\n          'shortMonths': ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez']\n        });\n      }\n    }),\n\n    CONFIG: null\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: ['axis-mixed', 'bar', 'line', 'scatter', 'pie', 'percentage'],\n      init: 'line'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _downloadedImage: null,\n    _url: null,\n    _headers: null,\n    _request: null,\n    _chart: null,\n    _width: null,\n    _height: null,\n    _loaded: null,\n    _dataSetConfigs: null,\n\n    async _init() {\n      const element = this._element;\n      if (element.hasAttribute('type')) {\n        this.setType(element.getAttribute('type'));\n      }\n      await cv.ui.structure.tile.components.Chart.JS_LOADED;\n      if (this.isVisible()) {\n        this._loadData();\n      }\n    },\n\n    _applyVisible(value) {\n      if (value && typeof window.d3 === 'object') {\n        this._loadData();\n      }\n    },\n\n    _loadData() {\n      if (this._loaded && (Date.now() - this._loaded) < 300000) {\n        // don't reload within 5 minutes\n        return;\n      }\n      const client = cv.io.BackendConnections.getClient();\n      let url;\n      const dataSets = this._element.querySelectorAll(':scope > dataset');\n      const promises = [];\n      this._dataSetConfigs = {};\n      for (let dataSet of dataSets) {\n        let ts = {\n          showArea: true,\n          color: '#FF9900',\n          type: dataSet.getAttribute('type') || 'line',\n          start: 'end-1day',\n          end: 'now',\n          xFormat: this._element.getAttribute('x-format') || '%H:%M',\n          xTicks: d3.timeHour.every(4)\n        };\n        let attr;\n        let name;\n        let value;\n        for (let i = 0; i < dataSet.attributes.length; i++) {\n          attr = dataSet.attributes.item(i);\n          // CamelCase attribute names\n          name = attr.name.split('-')\n            .map((part, i) => {\n              if (i > 0) {\n                return `${part.substring(0, 1).toUpperCase()}${part.substring(1)}`;\n              }\n              return part;\n            })\n            .join('');\n          value = attr.value;\n          if (name === 'series') {\n            switch (value) {\n              case 'hour':\n                ts.xTicks = d3.timeMinute.every(5);\n                ts.start = 'end-1' + value;\n                break;\n\n              case 'day':\n                ts.xTicks = d3.timeHour.every(4);\n                ts.start = 'end-1' + value;\n                break;\n\n              case 'week':\n                ts.xTicks = d3.timeDay.every(1);\n                ts.start = 'end-1' + value;\n                break;\n\n              case 'month':\n                ts.xTicks = d3.timeDay.every(5);\n                ts.start = 'end-1' + value;\n                break;\n\n              case 'year':\n                ts.xTicks = d3.timeDay.every(31);\n                ts.start = 'end-1' + value;\n                break;\n            }\n          } else {\n            if (value === 'true' || value === 'false') {\n              value = value === 'true';\n            } else if (/^\\d+$/.test(value)) {\n              value = parseInt(value);\n            } else if (/^[\\d.]+$/.test(value)) {\n              value = parseFloat(value);\n            }\n            ts[name] = value;\n          }\n        }\n        let start = new Date();\n        start.setTime(start.getTime() - 60 * 60 * 24 * 1000);\n        url = client.getResourcePath('charts', {\n          src: ts.src,\n          start: ts.start,\n          end: ts.end\n        });\n        if (!url) {\n          continue;\n        }\n        this._dataSetConfigs[ts.src] = ts;\n        promises.push(cv.io.Fetch.fetch(url, null, false, client).then(data => {\n          if (client.hasCustomChartsDataProcessor(data)) {\n            data = client.processChartsData(data, ts);\n          }\n          return {\n            data: data,\n            ts: ts\n          };\n        }).catch(err => {\n          this._onStatusError(ts, url, err);\n        }));\n      }\n      Promise.all(promises).then(responses => {\n        this._onSuccess(responses);\n      });\n    },\n\n    _onSuccess: function(data) {\n      if (!this.isVisible()) {\n        return;\n      }\n      let chartData = [];\n\n      for (let entry of data) {\n        let tsdata = entry.data;\n        if (tsdata !== null) {\n          for (let [time, value] of tsdata) {\n            chartData.push({\n              src: entry.ts.src,\n              time,\n              value\n            });\n          }\n        }\n      }\n      let minVal = d3.min(chartData, d => +d.value);\n      let maxVal = d3.max(chartData, d => +d.value) + 1;\n      if (minVal > 1.0) {\n        minVal -= 1;\n      }\n\n      const format = this._element.hasAttribute('y-format') ? this._element.getAttribute('y-format') : '%s';\n\n      this._chart = this._lineChart(chartData, {\n        x: d => d.time,\n        y: d => d.value,\n        z: d => d.src,\n        color: d => {\n          return d && this._dataSetConfigs[d].color;\n        },\n        title: d => {\n          return cv.util.String.sprintf(format, d.value);\n        },\n        //yLabel: ts.unit,\n        xDomain: d3.extent(chartData, d => d.time),\n        yDomain: [minVal, maxVal],\n        showArea: d => {\n          return this._dataSetConfigs[d].showArea;\n        },\n        mixBlendMode: 'normal',\n        xFormat: this.multiTimeFormat([\n          ['.%L', function (d) {\n            return d.getMilliseconds();\n          }],\n          [':%S', function (d) {\n            return d.getSeconds();\n          }],\n          ['%H:%M', function (d) {\n            return d.getMinutes();\n          }],\n          ['%H', function (d) {\n            return d.getHours();\n          }],\n          ['%a %d', function (d) {\n            return d.getDay() && d.getDate() !== 1;\n          }],\n          ['%b %d', function (d) {\n            return d.getDate() !== 1;\n          }],\n          ['%B', function (d) {\n            return d.getMonth();\n          }],\n          ['%Y', function () {\n            return true;\n          }]\n        ])\n      });\n      this._loaded = Date.now();\n    },\n\n    multiTimeFormat(formatsArray) {\n      /**\n * @param date\n */\nfunction multiFormat(date) {\n        let i = 0;\n        let found = false;\n        let fmt = '%c';\n        while (!found && i < formatsArray.length) {\n          found = formatsArray[i][1](date);\n          if (found) {\n            fmt = formatsArray[i][0];\n          }\n          i++;\n        }\n        return fmt;\n      }\n      return date => d3.timeFormat(multiFormat(date))(date);\n    },\n\n    _onStatusError: function(ts, key, err) {\n      cv.core.notifications.Router.dispatchMessage('cv.charts.error', {\n        title: qx.locale.Manager.tr('Communication error'),\n        severity: 'urgent',\n        message: qx.locale.Manager.tr('URL: %1<br/><br/>Response:</br>%2', JSON.stringify(key), err)\n      });\n      this.error('Chart _onStatusError', ts, key, err);\n    },\n\n    /**\n     * Copyright 2021 Observable, Inc.\n     * Released under the ISC license.\n     * https://observablehq.com/@d3/multi-line-chart\n     *\n     * @param data\n     * @param c\n     * @private\n     */\n    _lineChart: function(data, c) {\n      if (!cv.ui.structure.tile.components.Chart.CONFIG) {\n        cv.ui.structure.tile.components.Chart.CONFIG = {\n          x: d => d[0], // given d in data, returns the (temporal) x-value\n          y: d => d[1], // given d in data, returns the (quantitative) y-value\n          z: () => 1, // given d in data, returns the (categorical) z-value\n          title: undefined, // given d in data, returns the title text\n          defined: undefined, // for gaps in data\n          curve: d3.curveLinear, // method of interpolation between points\n          marginTop: 24, // top margin, in pixels\n          marginRight: 24, // right margin, in pixels\n          marginBottom: 24, // bottom margin, in pixels\n          marginLeft: 30, // left margin, in pixels\n          width: 392, // outer width, in pixels\n          height: 192, // outer height, in pixels\n          xType: d3.scaleTime, // type of x-scale\n          xDomain: undefined, // [xmin, xmax]\n          xRange: undefined, // [left, right]\n          xFormat: undefined, // a format specifier string for the x-axis\n          yType: d3.scaleLinear, // type of y-scale\n          yDomain: undefined, // [ymin, ymax]\n          yRange: undefined, // [bottom, top]\n          yFormat: undefined, // a format specifier string for the y-axis\n          yLabel: undefined, // a label for the y-axis\n          zDomain: undefined, // array of z-values\n          color: 'currentColor', // stroke color of line, as a constant or a function of *z*\n          strokeLinecap: undefined, // stroke line cap of line\n          strokeLinejoin: undefined, // stroke line join of line\n          strokeWidth: 1.5, // stroke width of line\n          strokeOpacity: undefined, // stroke opacity of line\n          mixBlendMode: 'multiply', // blend mode of lines\n          showArea: undefined, // show area below the line,\n          xPadding: 0.1 // amount of x-range to reserve to separate bars\n        };\n      }\n      const config = Object.assign({}, cv.ui.structure.tile.components.Chart.CONFIG, c);\n      config.xRange = [config.marginLeft, config.width - config.marginRight]; // [left, right]\n      config.yRange = [config.height - config.marginBottom, config.marginTop]; // [bottom, top]\n\n      // Compute values.\n      const X = d3.map(data, config.x);\n      const Y = d3.map(data, config.y);\n      const Z = d3.map(data, config.z);\n      const O = d3.map(data, d => d);\n      if (config.defined === undefined) {\n        config.defined = (d, i) => !isNaN(X[i]) && !isNaN(Y[i]);\n      }\n      //const D = d3.map(data, config.defined);\n\n      // Compute default domains, and unique the z-domain.\n      if (config.xDomain === undefined) {\n        config.xDomain = d3.extent(X);\n      }\n      if (config.yDomain === undefined) {\n        config.yDomain = [0, d3.max(Y, d => typeof d === 'string' ? +d : d)];\n      }\n      if (config.zDomain === undefined) {\n        config.zDomain = Z;\n      }\n      config.zDomain = new d3.InternSet(config.zDomain);\n\n      // Omit any data not present in the z-domain.\n      const I = d3.range(X.length).filter(i => config.zDomain.has(Z[i]));\n\n      // Construct scales and axes.\n      const xScale = config.xType(config.xDomain, config.xRange);\n      const yScale = config.yType(config.yDomain, config.yRange);\n      const xAxis = d3.axisBottom(xScale).ticks(config.width / 80).tickSizeOuter(0).tickFormat(config.xFormat);\n      const yAxis = d3.axisLeft(yScale).ticks(config.height / 60, config.yFormat);\n\n      // Compute titles.\n      const T = config.title === undefined ? Z : config.title === null ? null : d3.map(data, config.title);\n\n      d3.select(this._element).select('svg').remove();\n\n      let linePath;\n\n      const pointerMoved = event => {\n        const [xm, ym] = d3.pointer(event);\n        const i = d3.least(I, i => Math.hypot(xScale(X[i]) - xm, yScale(Y[i]) - ym)); // closest point\n        dot.attr('transform', `translate(${xScale(X[i])},${yScale(Y[i])})`);\n        if (T) {\n          dot.select('text').text(T[i]);\n        }\n        svg.property('value', O[i]).dispatch('input', {bubbles: true});\n      };\n\n      const pointerEntered = () => {\n        dot.attr('display', null);\n      };\n\n      const pointerLeft = () => {\n        dot.attr('display', 'none');\n        svg.node().value = null;\n        svg.dispatch('input', {bubbles: true});\n      };\n\n      const svg = d3.select(this._element)\n        .append('svg')\n        .attr('width', config.width)\n        .attr('height', config.height)\n        .attr('viewBox', [0, 0, config.width, config.height])\n        .attr('style', 'max-width: 100%; height: auto; height: intrinsic;')\n        .style('-webkit-tap-highlight-color', 'transparent')\n        .on('pointerenter', pointerEntered)\n        .on('pointermove', pointerMoved)\n        .on('pointerleave', pointerLeft)\n        .on('touchmove', event => {\n          let y = event.targetTouches[0].clientY;\n          if (linePath) {\n            const pathRect = linePath.node().getBoundingClientRect();\n            if (y > pathRect.y && y < (pathRect.y + pathRect.height)) {\n              event.preventDefault();\n            }\n          }\n        }, { passive: false });\n\n      svg.append('g')\n        .attr('transform', `translate(0,${config.height - config.marginBottom})`)\n        .call(xAxis);\n\n      svg.append('g')\n        .attr('transform', `translate(${config.marginLeft},0)`)\n        .call(yAxis)\n        .call(g => g.select('.domain').remove())\n        .call(g => g.append('text')\n          .attr('x', -config.marginLeft)\n          .attr('y', 10)\n          .attr('fill', 'currentColor')\n          .attr('text-anchor', 'start')\n          .text(config.yLabel));\n\n      const lineGroups = new Map();\n      const areaGroups = new Map();\n      const barGroups = new Map();\n      for (let i of I) {\n        const key = Z[i];\n        if (typeof config.showArea === 'function' && config.showArea(key)) {\n          if (!areaGroups.has(key)) {\n            areaGroups.set(key, []);\n          }\n          areaGroups.get(key).push(i);\n        }\n        switch (this._dataSetConfigs[key].type) {\n          case 'line':\n            if (!lineGroups.has(key)) {\n              lineGroups.set(key, []);\n            }\n            lineGroups.get(key).push(i);\n            break;\n\n          case 'bar':\n            if (!barGroups.has(key)) {\n              barGroups.set(key, []);\n            }\n            barGroups.get(key).push(i);\n            break;\n        }\n      }\n\n      if (lineGroups.size > 0) {\n        // Construct a line generator.\n        const line = d3.line()\n          //.defined(i => D[i])\n          .curve(config.curve)\n          .x(i => xScale(X[i]))\n          .y(i => yScale(Y[i]));\n\n        linePath = svg.append('g')\n          .attr('fill', 'none')\n          .attr('stroke', typeof config.color === 'string' ? config.color : null)\n          .attr('stroke-linecap', config.strokeLinecap)\n          .attr('stroke-linejoin', config.strokeLinejoin)\n          .attr('stroke-width', config.strokeWidth)\n          .attr('stroke-opacity', config.strokeOpacity)\n          .selectAll('path')\n          .data(lineGroups)\n          .join('path')\n          .style('mix-blend-mode', config.mixBlendMode)\n          .attr('stroke', typeof config.color === 'function' ? p => config.color(p[0]) : null)\n          .attr('d', d => line(d[1]));\n      }\n\n      // Add the area\n      if (areaGroups.size > 0) {\n        const area = d3.area()\n          //.defined(i => D[i])\n          .curve(config.curve)\n          .x(i => xScale(X[i]))\n          .y0(() => config.yRange[0])\n          .y1(i => yScale(Y[i]));\n\n        svg.append('g')\n          .attr('stroke', 'none')\n          .attr('fill', typeof config.color === 'string' ? config.color + '30' : null)\n          .selectAll('path')\n          .data(areaGroups)\n          .join('path')\n          .style('mix-blend-mode', config.mixBlendMode)\n          .attr('fill', typeof config.color === 'function' ? p => config.color(p[0]) + '30' : null)\n          .attr('d', d => area(d[1]));\n      }\n\n      if (barGroups.size > 0) {\n        const xBarScale = d3.scaleBand().domain(X).range(config.xRange).padding(config.xPadding);\n        svg.append('g')\n          .selectAll('g')\n          .data(barGroups)\n          .join('g')\n            .attr('fill', typeof config.color === 'function' ? d => config.color(d[0]) + '30' : null)\n          .selectAll('rect')\n          .data(d => {\n            return d[1].map(val => {\n              return {\n                key: d[0],\n                value: val\n              };\n            });\n          })\n          .join('rect')\n            .attr('x', d => xBarScale(X[d.value]))\n            .attr('y', d => yScale(Y[d.value]))\n            .attr('height', d => config.yRange[0] - yScale(Y[d.value]))\n            .attr('width', xBarScale.bandwidth());\n      }\n\n      const dot = svg.append('g')\n        .attr('display', 'none')\n        .attr('fill', 'currentColor');\n\n      dot.append('circle')\n        .attr('r', 2.5);\n\n      dot.append('text')\n        .attr('font-family', 'sans-serif')\n        .attr('font-size', 10)\n        .attr('text-anchor', 'middle')\n        .attr('y', -8);\n\n      return Object.assign(svg.node(), {value: null});\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._chart = null;\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'chart', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Color.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows a html color input\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.components.Color', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    throttleInterval: {\n      check: 'Number',\n      init: 250,\n      apply: '_applyThrottleInterval'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __input: null,\n\n    _init() {\n      this.base(arguments);\n      const element = this._element;\n      if (element.hasAttribute('throttle-interval')) {\n        this.setThrottleInterval(parseInt(element.getAttribute('throttle-interval')));\n      } else {\n        this._applyThrottleInterval(this.getThrottleInterval());\n      }\n\n      // init components\n      let input = element.querySelector(':scope > input');\n      if (!input) {\n        input = document.createElement('input');\n        input.setAttribute('type', 'color');\n        element.appendChild(input);\n        input.oninput = () => this.__throttled.call();\n      }\n      this.__input = input;\n    },\n\n    _applyThrottleInterval(value) {\n      if (value > 0) {\n        this.__throttled = cv.util.Function.throttle(this.onInput, value, { trailing: true }, this);\n      } else {\n        // no throttling, direct call\n        this.__throttled = {\n          call: () => this.onInput(),\n          abort: () => {}\n        };\n      }\n    },\n\n    onInput() {\n      this.__sendValue(this.__input.value);\n    },\n\n    _updateValue(mappedValue, value) {\n      let target = this._element.querySelector(':scope > .value');\n      const rgb = mappedValue.substring(0, 7);\n      if (target) {\n        const tagName = target.tagName.toLowerCase();\n        const alpha = mappedValue.length === 9 ? parseInt(mappedValue.substring(7, 9), 16)/255 : 1.0;\n\n        switch (tagName) {\n          case 'cv-icon':\n            target.style.color = rgb;\n            target.style.opacity = Math.max(alpha, 0.05); // do not blend it out totally\n            break;\n        }\n      }\n      const input = this._element.querySelector(':scope > input');\n      input.value = rgb; // this input can't handle the alpha value\n      if (!target) {\n        // only if we do not have another value handler\n        this._element.style.backgroundColor = mappedValue;\n      }\n    },\n\n    onStateUpdate(ev) {\n      let handled = false;\n      if (ev.detail.target) {\n        handled = this.base(arguments, ev);\n      }\n      if (!handled) {\n        const value = ev.detail.state;\n        let rgb;\n        let alpha = '';\n        switch (ev.detail.variant) {\n          case 'hsv':\n            rgb = qx.util.ColorUtil.hsbToRgb([value.get('h'), value.get('s'), 100]);\n            alpha = Math.round(value.get('v')/100 * 255).toString(16).padStart(2, '0');\n            this.setValue(`#${rgb[0].toString(16).padStart(2, '0')}${rgb[1].toString(16).padStart(2, '0')}${rgb[2].toString(16).padStart(2, '0')}${alpha}`);\n            break;\n        }\n      }\n    },\n\n    __sendValue(value) {\n      const hsvArray = qx.util.ColorUtil.rgbToHsb([\n        parseInt(value.substring(1, 3), 16),\n        parseInt(value.substring(3, 5), 16),\n        parseInt(value.substring(5, 7), 16)\n      ]);\n      const hsv = new Map([\n        ['h', hsvArray[0]],\n        ['s', hsvArray[1]],\n        ['v', hsvArray[2]]\n      ]);\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: hsv,\n          source: this\n        }\n      });\n      this._writeAddresses.filter(addr => addr.getAttribute('variant') === 'hsv').forEach(address => address.dispatchEvent(ev));\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'color', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Icon.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n *\n */\nqx.Class.define('cv.ui.structure.tile.components.Icon', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (element) {\n    this.base(arguments, element);\n    this._idRegex = /^[^\\s]+$/;\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    id: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyId',\n      // the id is used as 'class' property and therefore must not have spaces\n      transform: '_transformId'\n    },\n\n    color: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyColor'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __initialized: false,\n    _idRegex: null,\n\n    _transformId(value) {\n      if (this._idRegex.test(value)) {\n        return value;\n      }\n      this.error('invalid icon id:', value);\n      return null;\n    },\n\n    _init() {\n      this.base(arguments);\n      const element = this._element;\n      if (element.textContent.trim()) {\n        this.__initialized = true;\n        this.setId(element.textContent.trim());\n      } else {\n        const it = element.classList.values();\n        for (let name of it) {\n          if (name.startsWith('ri-') || name.startsWith('knxuf-')) {\n            this.setId(name);\n            break;\n          }\n        }\n      }\n      this.__initialized = true;\n    },\n\n    _applyId(value, oldValue) {\n      const element = this._element;\n      if (this.__initialized) {\n        if (oldValue) {\n          element.classList.remove(oldValue);\n        }\n        if (value) {\n          // default is an icon font that uses CSS classes\n          element.classList.add(value);\n          if (element.textContent) {\n            element.textContent = '';\n          }\n        }\n      }\n    },\n\n    _applyColor(value, oldValue) {\n      const element = this._element;\n      if (oldValue) {\n        element.classList.remove(oldValue);\n      }\n      if (value) {\n        element.classList.add(value);\n      }\n    }\n  },\n\n  defer(Clazz) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'icon', class extends QxConnector {\n      constructor() {\n        super(Clazz);\n      }\n\n      static get observedAttributes() {\n        return ['color'];\n      }\n    });\n  }\n});\n","/* Image.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows an image.\n *\n * HINT: Proxy mode needs an PHP environment with php-curl installed.\n */\nqx.Class.define('cv.ui.structure.tile.components.Image', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: [cv.ui.structure.tile.MVisibility, cv.ui.structure.tile.MRefresh],\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _downloadedImage: null,\n    _url: null,\n    _headers: null,\n    _request: null,\n\n    _init() {\n      const element = this._element;\n      let img = element.querySelector(':scope > img');\n      if (!img) {\n        img = document.createElement('img');\n        element.appendChild(img);\n      }\n      element.addEventListener('click', () => this.refresh());\n      let src = element.getAttribute('src');\n      let base = window.location.origin;\n      if (src.substring(0, 1) !== '/' && src.substring(0, 4) !== 'http') {\n        // relative url\n        base += window.location.pathname;\n      }\n      this._url = new URL(src, base);\n      const useProxy = element.hasAttribute('proxy') && element.getAttribute('proxy') === 'true';\n      if (useProxy) {\n        this._url = new URL(cv.io.rest.Client.getBaseUrl() + '/proxy', window.location.origin);\n        this._url.searchParams.set('url', element.getAttribute('src'));\n      }\n      this._headers = {};\n      if (element.hasAttribute('auth-type')) {\n        switch (element.getAttribute('auth-type').toLowerCase()) {\n          case 'basic':\n            if (useProxy) {\n              this._url.searchParams.set('authorization', 'Basic ' + window.btoa(element.getAttribute('username') + ':' + element.getAttribute('password')));\n            } else {\n              this._headers['Authorization'] = 'Basic ' + window.btoa(element.getAttribute('username') + ':' + element.getAttribute('password'));\n            }\n            break;\n        }\n      }\n      this._loadImage();\n      if (element.hasAttribute('refresh')) {\n        this.setRefresh(parseInt(element.getAttribute('refresh')));\n      }\n    },\n\n    _loadImage() {\n      let img = this._element.querySelector(':scope > img');\n      if (Object.keys(this._headers).length > 0) {\n        let request = new XMLHttpRequest();\n        request.responseType = 'blob';\n        request.open('get', this._url.toString(), true);\n        Object.keys(this._headers).forEach(name => {\n          request.setRequestHeader(name, this._headers[name]);\n        });\n        request.onreadystatechange = e => {\n          if (request.readyState === XMLHttpRequest.DONE && request.status === 200) {\n            img.src = URL.createObjectURL(request.response);\n            img.onload = () => {\n              URL.revokeObjectURL(img.src);\n            };\n          }\n        };\n        request.send(null);\n      } else {\n        img.src = this._url.toString();\n      }\n    },\n\n    refresh() {\n      let img = this._element.querySelector(':scope > img');\n      if (img) {\n        this._url.searchParams.set('r', '' + Math.random());\n        this._loadImage();\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from a cv-address component\n     */\n    onStateUpdate(ev) {\n      if (!this.base(arguments, ev)) {\n        if (ev.detail.target === 'refresh') {\n          if (ev.detail.state) {\n            this.refresh();\n          }\n        } else {\n          this.debug('unhandled address target', ev.detail.target);\n        }\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'image', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* List.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Generates a list of items. A &lt;template&gt;-element defines the content of the list-items and a model is used to\n * generate those items and apply the models content to the list-items.\n * It allows custom Javascript code in a &lt;script&gt;-Element to fill the model or address-Elements as model source.\n * The model can be refreshed in a time defined interval, which is set by the 'refresh' attribute.\n *\n * @widgetexample <settings>\n *    <caption>Example list</caption>\n *    <screenshot name=\"list_simple\"/>\n *  </settings>\n    <cv-list refresh=\"10\">\n      <model>\n        <script><![CDATA[\n         for (let i = 0; i < Math.round(Math.random()*10); i++) {\n           model.push({\n             label: 'This is list item no ' + i,\n             subLabel: 'Sublabel number ' + i\n           })\n         }\n         ]]>\n         </script>\n       </model>\n       <template>\n         <li>\n           <label class=\"primary\">${label}</label>\n           <label class=\"secondary\">${subLabel}</label>\n         </li>\n       </template>\n       <template when=\"empty\">\n         <li>\n           <label class=\"primary\">Model is empty!</label>\n         </li>\n       </template>\n   </cv-list>\n */\nqx.Class.define('cv.ui.structure.tile.components.List', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: [cv.ui.structure.tile.MVisibility, cv.ui.structure.tile.MRefresh],\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    value: {\n      refine: true,\n      init: []\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _target: null,\n    _timer: null,\n    _model: null,\n    _getModel: null,\n    _filterModel: null,\n    _sortModel: null,\n    _limit: null,\n\n    _init() {\n      const element = this._element;\n      this._model = [];\n      let refreshOnUpdate = false;\n      const model = element.querySelector('model');\n      if (!model) {\n        this.error('cv-list needs a model');\n        return;\n      }\n      if (model.hasAttribute('filter')) {\n        this._filterModel = new Function('item', 'index', '\"use strict\"; return ' + model.getAttribute('filter'));\n      }\n      if (model.hasAttribute('limit')) {\n        this._limit = parseInt(model.getAttribute('limit'));\n      }\n      const readAddresses = model.querySelectorAll(':scope > cv-address:not([mode=\"write\"])');\n      if (model.hasAttribute('sort-by')) {\n        const sortBy = model.getAttribute('sort-by');\n        // reverse order in 'desc' sort mode\n        const sortModifier = model.getAttribute('sort-mode') === 'desc' ? -1 : 1;\n        this._sortModel = (left, right) => {\n          const leftVal = left[sortBy];\n          const rightVal = right[sortBy];\n          if (leftVal === rightVal) {\n            return 0;\n          } else if (typeof leftVal === typeof rightVal) {\n            switch (typeof leftVal) {\n              case 'number':\n                return (leftVal - rightVal) * sortModifier;\n\n              case 'boolean':\n                return (leftVal ? -1 : 1) * sortModifier;\n\n              case 'string':\n                return leftVal.localeCompare(rightVal) * sortModifier;\n\n              default:\n                return JSON.stringify(leftVal).localeCompare(JSON.stringify(rightVal)) * sortModifier;\n            }\n          } else if (leftVal === undefined || leftVal === null) {\n            return 1 * sortModifier;\n          } else if (rightVal === undefined || rightVal === null) {\n            return -1 * sortModifier;\n          }\n          return 0;\n        };\n      }\n      if (model.hasAttribute('src')) {\n        // fetch from url\n        this._getModel = async () => {\n          const res = await cv.io.Fetch.fetch(model.getAttribute('src'), null, model.getAttribute('proxy') === 'true');\n          return res;\n        };\n      } else {\n        const script = model.querySelector(':scope > script');\n        const data = model.querySelectorAll(':scope > cv-data');\n        if (script) {\n          this._getModel = new Function('\"use strict\";let model = []; ' + script.innerText.trim() + '; return model');\n          this._model = this._getModel();\n        } else if (readAddresses.length > 0) {\n          // model has an address that triggers a refresh on update, so we just have to read the model from the updated value\n          this._getModel = this.getValue;\n          refreshOnUpdate = true;\n        } else if (data.length > 0) {\n          this._model = [];\n          this._getModel = () => this._model;\n          data.forEach((elem, i) => {\n            const d = {\n              index: i\n            };\n            for (const a of elem.attributes) {\n              d[a.name] = a.value;\n            }\n            this._model.push(d);\n          });\n        } else {\n          this.error('cv-list > model must have at least one read address, src-attribute, cv-data child or a script that fills the model.');\n          return;\n        }\n      }\n      if (readAddresses.length > 0) {\n        element.addEventListener('stateUpdate', ev => this.onStateUpdate(ev));\n      }\n      if (!refreshOnUpdate) {\n        if (this.isVisible()) {\n          // only load when visible\n          this.refresh();\n        }\n        if (element.hasAttribute('refresh')) {\n          this.setRefresh(parseInt(element.getAttribute('refresh')));\n        }\n      }\n    },\n\n    onStateUpdate(ev) {\n      if (ev.detail.target === 'refresh') {\n        if (this.isVisible()) {\n          // only load when visible\n          this.refresh();\n        } else {\n          // reset lastRefresh to that the refresh get called when this item gets visible\n          this._lastRefresh = null;\n        }\n      } else {\n        this.base(arguments, ev);\n      }\n      // cancel event here\n      ev.stopPropagation();\n    },\n\n    _applyValue() {\n      // reset last refresh, because with new data its obsolete\n      this._lastRefresh = 0;\n      this.refresh();\n    },\n\n    async refresh() {\n      const element = this._element;\n      const template = element.querySelector(':scope > template:not([when])');\n      let newModel = [];\n      if (typeof this._getModel === 'function') {\n        newModel = this._getModel();\n      }\n      if (newModel instanceof Promise) {\n        newModel = await newModel;\n      }\n      let target = element.querySelector(':scope > ul');\n      if (template.getAttribute('wrap') === 'false') {\n        target = element;\n      } else if (template.hasAttribute('target')) {\n        switch (template.getAttribute('target')) {\n          case 'parent':\n            target = element.parentElement;\n            // we do not need the list to be visible then\n            element.style.display = 'none';\n            break;\n          default:\n            throw new Error('invalid target: ' + template.getAttribute('target'));\n        }\n      } else if (!target) {\n        target = document.createElement('ul');\n        target.classList.add('content');\n        element.appendChild(target);\n      }\n      this.debug('refreshing with new model length', newModel.length);\n      if (Array.isArray(newModel) || newModel instanceof qx.data.Array) {\n        if (typeof this._filterModel === 'function') {\n          newModel = newModel.filter(this._filterModel);\n        }\n        if (typeof this._sortModel === 'function') {\n          newModel.sort(this._sortModel);\n        }\n        if (this._limit) {\n          newModel = newModel.slice(0, this._limit);\n        }\n        if (newModel.length === 0) {\n          const whenEmptyTemplate = element.querySelector(':scope > template[when=\"empty\"]');\n          if (whenEmptyTemplate && !target.querySelector(':scope > .empty-model')) {\n            while (target.firstElementChild && target.firstElementChild.hasAttribute('data-row')) {\n              target.removeChild(target.firstElementChild);\n            }\n            const emptyModel = whenEmptyTemplate.content.firstElementChild.cloneNode(true);\n            emptyModel.classList.add('empty-model');\n            target.appendChild(emptyModel);\n            return;\n          }\n        } else {\n          const emptyElem = target.querySelector(':scope > .empty-model');\n          if (emptyElem) {\n            emptyElem.remove();\n          }\n        }\n        const itemTemplate = document.createElement('template');\n        // remove entries we do not need anymore\n        for (let i = newModel.length; i < this._model.length; i++) {\n          const elem = target.querySelector(`:scope > [data-row=\"${i}\"]`);\n          if (elem) {\n            elem.remove();\n          }\n        }\n\n        newModel.forEach((entry, i) => {\n          const elem = target.querySelector(`:scope > [data-row=\"${i}\"]`);\n          const html = template.innerHTML.replaceAll(/\\${([^}\\[]+)\\[?(\\d+)?\\]?}/g, (match, p1, p2) => {\n            if (Object.prototype.hasOwnProperty.call(entry, p1)) {\n              let val = entry[p1];\n              if (p2 && Array.isArray(val)) {\n                return val[parseInt(p2)];\n              }\n              return val;\n            } else if (p1 === 'index') {\n              return '' + i;\n            }\n            return '';\n          });\n          itemTemplate.innerHTML = html;\n          if (elem) {\n            // update existing\n            elem.innerHTML = itemTemplate.content.firstElementChild.innerHTML;\n            elem.setAttribute('data-row', ''+i);\n          } else {\n            // append new child\n            itemTemplate.content.firstElementChild.setAttribute('data-row', ''+i);\n            target.appendChild(itemTemplate.content.cloneNode(true));\n          }\n        });\n        this._model = newModel;\n      } else {\n        this.error('model must be an array', newModel);\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'list', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* ListItem.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows an item in a list.\n */\nqx.Class.define('cv.ui.structure.tile.components.ListItem', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'listitem', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Menu.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Generates a menu of a model, currently only the pages model is implemented.\n *\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.components.Menu', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      check: ['text', 'icons', 'dock'],\n      init: 'text',\n      apply: '_applyAppearance'\n    },\n    depth: {\n      check: '!isNaN(value) && value >= -1 && value <= 100',\n      init: -1,\n      apply: '_applyDepth'\n    },\n    domReady: {\n      check: 'Boolean',\n      init: false,\n      apply: '_generateMenu'\n    },\n    showLabels: {\n      check: 'Boolean',\n      init: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _applyAppearance(value, oldValue) {\n      const main = document.querySelector('main');\n      if (oldValue === 'dock') {\n        main.classList.remove('has-dock');\n      }\n      if (value === 'dock') {\n        main.classList.add('has-dock');\n      }\n    },\n\n    _applyDepth() {\n      if (this.isDomReady()) {\n        this._generateMenu();\n      }\n    },\n\n    _onDomAppended() {\n      this.setDomReady(true);\n      qx.event.message.Bus.unsubscribe('setup.dom.append', this._onDomAppended, this);\n    },\n\n    _init() {\n      const element = this._element;\n      const model = element.getAttribute('model');\n      if (!model) {\n        this.error('no model defined, menu will be empty');\n        return;\n      }\n      if (element.getAttribute('show-labels') === 'false') {\n        this.setShowLabels(false);\n      }\n      if (model === 'pages') {\n        qx.event.message.Bus.subscribe('setup.dom.append', this._onDomAppended, this);\n        const rootList = document.createElement('ul');\n        element.appendChild(rootList);\n\n        // add hamburger menu\n        const ham = document.createElement('a');\n        ham.href = '#';\n        ham.classList.add('menu');\n        ham.onclick = () => this._onHamburgerMenu();\n        const icon = document.createElement('i');\n        icon.classList.add('ri-menu-line');\n        ham.appendChild(icon);\n        element.appendChild(ham);\n\n        qx.event.message.Bus.subscribe('cv.ui.structure.tile.currentPage', this._onPageChange, this);\n        // add some general listeners to close\n        qx.event.Registration.addListener(document, 'pointerdown', this._onPointerDown, this);\n        qx.event.Registration.addListener(this._element, 'swipe', this._onSwipe, this);\n      } else {\n        this.error('visual-model of type', model, 'is not implemented');\n      }\n    },\n\n    _generateMenu() {\n      const currentPage = window.location.hash.substring(1);\n      let parentElement = document.querySelector('main');\n      if (parentElement) {\n        const firstPage = document.querySelector('cv-page');\n        if (firstPage) {\n          parentElement = firstPage.parentElement;\n        }\n      }\n      const rootList = this._element.querySelector(':scope > ul');\n      if (rootList) {\n        rootList.replaceChildren();\n        this.__generatePagesModel(rootList, parentElement, currentPage, 0);\n      }\n    },\n\n    _onHamburgerMenu() {\n      this._element.classList.toggle('responsive');\n      for (let detail of this._element.querySelectorAll('details')) {\n        detail.setAttribute('open', '');\n      }\n    },\n\n    /**\n     * @param ev {qx.event.type.Event}\n     * @private\n     */\n    _onPointerDown(ev) {\n      const target = ev.getTarget();\n      if (target.classList.contains('menu') || (target.parentElement && target.parentElement.classList.contains('menu'))) {\n        // clicked in hamburger menu, do nothing\n      } else if (target.tagName.toLowerCase() !== 'summary' && target.tagName.toLowerCase() !== 'p') {\n        // defer closing because it would prevent the link clicks and page selection\n        qx.event.Timer.once(this._closeAll, this, 100);\n      } else {\n        // close others\n        this._closeAll(ev.getTarget().parentElement);\n      }\n    },\n\n    _onSwipe(ev) {\n      if (ev.getDirection() === 'left') {\n        // goto next if there is one\n        const next = this._element.querySelector('li.active + li > a');\n        if (next) {\n          next.click();\n        }\n      } else {\n        const current = this._element.querySelector('li.active');\n        if (current && current.previousElementSibling && current.previousElementSibling.tagName.toLowerCase() === 'li') {\n          const prev = current.previousElementSibling.querySelector(':scope > a');\n          if (prev) {\n            prev.click();\n          }\n        }\n      }\n    },\n\n    /**\n     * Close all open sub-menus\n     * @param except {Element?} do not close this one\n     * @private\n     */\n    _closeAll(except) {\n      if (this._element.classList.contains('responsive')) {\n        this._element.classList.remove('responsive');\n      } else {\n        for (let detail of this._element.querySelectorAll('details[open]')) {\n          if (!except || detail !== except) {\n            detail.removeAttribute('open');\n          }\n        }\n      }\n    },\n\n\n    __generatePagesModel(parentList, parentElement, currentPage, currentLevel) {\n      if (!parentElement) {\n        return;\n      }\n      let pages = parentElement.querySelectorAll(':scope > cv-page:not([menu=\"false\"])');\n      for (let page of pages.values()) {\n        const pageId = page.getAttribute('id');\n        if (!pageId) {\n          this.error('page has no id, skipping');\n          continue;\n        }\n        const pageName = page.getAttribute('name') || '';\n        const pageIcon = page.getAttribute('icon') || '';\n        const li = document.createElement('li');\n        const a = document.createElement('a');\n        a.setAttribute('href', '#' + pageId);\n        if (pageIcon) {\n          const i = document.createElement('i');\n          i.classList.add(pageIcon);\n          i.title = pageName;\n          a.appendChild(i);\n        }\n        if (this.isShowLabels()) {\n          const text = document.createTextNode(pageName);\n          a.appendChild(text);\n        }\n        if (currentPage === pageId) {\n          li.classList.add('active');\n        }\n        parentList.appendChild(li);\n        const depth = this.getDepth();\n        if ((depth < 0 || depth > currentLevel) && page.querySelectorAll(':scope > cv-page:not([menu=\"false\"])').length > 0) {\n          const details = document.createElement('div');\n          details.classList.add('details');\n          const summary = document.createElement('div');\n          summary.classList.add('summary');\n          summary.addEventListener('click', ev => {\n            if (details.hasAttribute('open')) {\n              details.removeAttribute('open');\n            } else {\n              details.setAttribute('open', '');\n            }\n          });\n          a.addEventListener('click', ev => {\n            // only stop propagation if we are not close to the right border\n            if (ev.pointerType !== 'touch' || (ev.currentTarget.clientWidth - ev.offsetX) >= 8) {\n              ev.stopPropagation();\n            }\n          });\n          const pageIcon = page.getAttribute('icon') || '';\n          if (page.querySelector(':scope > *:not(cv-page)')) {\n            // only add this as link, when this page has real content\n            summary.appendChild(a);\n          } else {\n            const p = document.createElement('p');\n            if (pageIcon) {\n              const i = document.createElement('i');\n              i.classList.add(pageIcon);\n              i.title = pageName;\n              p.appendChild(i);\n            }\n            if (this.isShowLabels()) {\n              p.appendChild(document.createTextNode(pageName));\n            }\n            summary.appendChild(p);\n          }\n          details.appendChild(summary);\n          const subList = document.createElement('ul');\n          details.appendChild(subList);\n          this.__generatePagesModel(subList, page, currentPage, currentLevel++);\n          li.appendChild(details);\n        } else {\n          li.appendChild(a);\n        }\n      }\n    },\n\n    _onPageChange(ev) {\n      const pageElement = ev.getData();\n      // unset all currently active\n      for (let link of this._element.querySelectorAll('li.active, li.sub-active')) {\n        link.classList.remove('active');\n        link.classList.remove('sub-active');\n      }\n      // find link to current page\n      for (let link of this._element.querySelectorAll(`a[href=\"#${pageElement.id}\"]`)) {\n        // activate all parents\n        let parent = link.parentElement;\n        let activeName = 'active';\n        while (parent && parent.tagName.toLowerCase() !== 'cv-menu') {\n          if (parent.tagName.toLowerCase() === 'li') {\n            parent.classList.add(activeName);\n            // all other parents have a sub-menu active\n            activeName = 'sub-active';\n          }\n          parent = parent.parentElement;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.Registration.removeListener(document, 'pointerdown', this._onPointerDown, this);\n    qx.event.message.Bus.unsubscribe('cv.ui.structure.tile.currentPage', this._onPageChange, this);\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'menu', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n      static get observedAttributes() {\n        return ['appearance', 'depth'];\n      }\n    });\n  }\n});\n","/* RoundProgress.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows a round progress bar (partially filled circle).\n * This component must be used inside a cv-value component, it is not meant to be used standalone.\n *\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.components.RoundProgress', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: cv.ui.structure.tile.MVisibility,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    progress: {\n      check: 'Number',\n      apply: '_applyProgress'\n    },\n    text: {\n      check: 'String',\n      apply: '_applyText'\n    },\n    type: {\n      check: ['circle', 'semiCircle'],\n      init: 'circle'\n    },\n    min: {\n      check: 'Number',\n      init: 0\n    },\n    max: {\n      check: 'Number',\n      init: 100\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __writeAddresses: null,\n    __circumference: null,\n    __start: null,\n    __normalizedRadius: null,\n    __radius: null,\n    __label: null,\n    __canvas: null,\n    __availableLabelWidth: null,\n    __defaultLabelFontSize: null,\n    _queuedFitText: null,\n\n    _init() {\n      this.base(arguments);\n      const element = this._element;\n      const style = document.querySelector(':root').style;\n      const hasFixedRadius = element.hasAttribute('radius');\n      const radius = this.__radius = element.getAttribute('radius') || parseInt(style.getPropertyValue('--tileCellWidth')) || 56;\n      const strokeWidth = element.getAttribute('stroke') || 8;\n      const normalizedRadius = this.__normalizedRadius = radius - strokeWidth / 2;\n      this.__circumference = normalizedRadius * 2 * Math.PI;\n\n      if (element.hasAttribute('min')) {\n        const min = parseInt(element.getAttribute('min'));\n        if (!isNaN(min)) {\n          this.setMin(min);\n        }\n      }\n\n      if (element.hasAttribute('max')) {\n        const max = parseInt(element.getAttribute('max'));\n        if (!isNaN(max)) {\n          this.setMax(max);\n        }\n      }\n\n      if (element.hasAttribute('type')) {\n        this.setType(element.getAttribute('type'));\n      }\n      const type = this.getType();\n      let height = type === 'semiCircle' ? radius : radius * 2;\n      let code = `<svg height=\"${height}\" width=\"${radius * 2}\" type=\"${type}\">`;\n      if (type === 'circle') {\n        if (!element.hasAttribute('no-background')) {\n          code += `<circle class=\"bg\" \n                r=\"${normalizedRadius}\" \n                cx=\"50%\" \n                cy=\"50%\" \n                fill=\"transparent\" \n                stroke-width=\"${strokeWidth}\"/>`;\n        }\n        code += `<circle class=\"bar\" \n              r=\"${normalizedRadius}\" \n              cx=\"50%\" \n              cy=\"50%\" \n              stroke-width=\"${strokeWidth}\" \n              stroke-dasharray=\"${this.__circumference} ${this.__circumference}\" \n              stroke-dashoffset=\"${this.__circumference}\"/>`;\n      } else if (type === 'semiCircle') {\n        if (!element.hasAttribute('no-background')) {\n          code += `<path class=\"bg\" d=\"M ${strokeWidth / 2} ${radius} A ${normalizedRadius} ${normalizedRadius} 0 0 1 ${radius * 2 - strokeWidth / 2} ${radius}\" fill=\"transparent\" stroke-width=\"${strokeWidth}\"/>`;\n        }\n        this.__start = {\n          x: strokeWidth / 2,\n          y: radius\n        };\n        code += `<path class=\"bar\" d=\"M ${strokeWidth / 2} ${radius} A ${normalizedRadius} ${normalizedRadius} 0 0 0 ${strokeWidth / 2} ${radius}\" fill=\"transparent\" stroke-width=\"${strokeWidth}\"/>`;\n      }\n      code += '</svg><label></label>';\n      element.innerHTML = code;\n\n      this.__availableLabelWidth = radius * 2 - strokeWidth * 2 - 24;\n\n      if (!hasFixedRadius) {\n        qx.event.message.Bus.subscribe('cv.design.tile.cellWidthChanged', ev => {\n          this.__radius = ev.getData();\n          this.__normalizedRadius = this.__radius - strokeWidth / 2;\n          this.__circumference = this.__normalizedRadius * 2 * Math.PI;\n          height = type === 'semiCircle' ? this.__radius : this.__radius * 2;\n          const svg = element.querySelector(':scope > svg');\n          svg.setAttribute('height', '' + height);\n          svg.setAttribute('width', '' + this.__radius * 2);\n          if (type === 'circle') {\n            this._element.querySelectorAll(':scope > svg > circle').forEach(circle => {\n              circle.setAttribute('r', '' + this.__normalizedRadius);\n              if (circle.classList.contains('bar')) {\n                circle.setAttribute('stroke-dasharray', this.__circumference + ' ' + this.__circumference);\n                circle.setAttribute('stroke-dashoffset', '' + this.__circumference);\n              }\n            });\n          } else if (type === 'semiCircle') {\n            this.__start.y = this.__radius;\n            const bg = this._element.querySelector(':scope > svg > path.bg');\n            if (bg) {\n              bg.setAttribute('d', `M ${strokeWidth / 2} ${this.__radius} A ${this.__normalizedRadius} ${this.__normalizedRadius} 0 0 1 ${this.__radius * 2 - strokeWidth / 2} ${this.__radius}`);\n            }\n          }\n          this._applyProgress(this.isPropertyInitialized('progress') ? this.getProgress() : 0);\n        });\n      }\n    },\n\n    __convert(angle) {\n      const angleRad = angle * (Math.PI / 180.0);\n      return {\n        x: this.__radius - (this.__normalizedRadius * Math.cos(angleRad)),\n        y: this.__radius - (this.__normalizedRadius * Math.sin(angleRad))\n      };\n    },\n\n    _applyProgress(value) {\n      if (this.isConnected()) {\n        let valueElement;\n        let end;\n        let valueInRange = value - this.getMin();\n        let percent = Math.max(0, Math.min(100, (100 / (this.getMax() - this.getMin())) * valueInRange));\n        switch (this.getType()) {\n          case 'circle':\n            valueElement = this._element.querySelector(':scope > svg > circle.bar');\n            valueElement.setAttribute('stroke-dashoffset', '' + this.__circumference - percent / 100 * this.__circumference);\n            break;\n\n          case 'semiCircle':\n            valueElement = this._element.querySelector(':scope > svg > path.bar');\n            end = this.__convert(180/100 * percent);\n            valueElement.setAttribute('d', [\n              'M', this.__start.x, this.__start.y,\n              'A', this.__normalizedRadius, this.__normalizedRadius, 0, 0, 1, end.x, end.y\n            ].join(' '));\n            break;\n        }\n      }\n    },\n\n    _fitText() {\n      if (this.__label && this.__label.textContent) {\n        if (this.isVisible()) {\n          if (!this.__canvas) {\n            this.__canvas = document.createElement('canvas');\n            this.__context = this.__canvas.getContext('2d');\n            const compStyle = window.getComputedStyle(this.__label);\n            this.__context.font = compStyle.getPropertyValue('font');\n            this.__defaultLabelFontSize = compStyle.getPropertyValue('font-size');\n          }\n          const metrics = this.__context.measureText(this.__label.textContent);\n          if (metrics.width > this.__availableLabelWidth) {\n            // adjust font-size\n            const factor = this.__availableLabelWidth / metrics.width;\n            this.__label.style.fontSize = Math.floor(parseInt(this.__defaultLabelFontSize) * factor) + 'px';\n          } else {\n            this.__label.style.fontSize = this.__defaultLabelFontSize;\n          }\n          this._queuedFitText = false;\n        } else {\n          this._queuedFitText = true;\n        }\n      }\n    },\n\n    _applyVisible(visible) {\n      if (visible && this._queuedFitText) {\n        this._fitText();\n      }\n    },\n\n\n    _applyText(value) {\n      if (this.isConnected()) {\n        if (!this.__label) {\n          this.__label = this._element.querySelector(':scope > label');\n        }\n        this.__label.textContent = value;\n        if (!value) {\n          // empty text, just reset to default font size\n          if (this.__defaultLabelFontSize) {\n            this.__label.style.fontSize = this.__defaultLabelFontSize;\n          }\n        } else {\n          this._fitText();\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__label = null;\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'round-progress', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Select.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Allows the selection of one element out of a list of <cv-option> elements\n */\nqx.Class.define('cv.ui.structure.tile.components.Select', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __options: null,\n    __value: null,\n    __popup: null,\n\n    _init() {\n      this.base(arguments);\n      const element = this._element;\n      this.__options = new Map();\n\n      const popup = this.__popup = document.createElement('div');\n      popup.classList.add('popup');\n      element.querySelectorAll(':scope > cv-option').forEach((option, i) => {\n        popup.appendChild(option);\n        if (!option.hasAttribute('key')) {\n          option.setAttribute('key', '' + i);\n        }\n        this.__options.set(option.getAttribute('key'), option);\n      });\n      const value = this.__value = document.createElement('span');\n      value.classList.add('value');\n      element.appendChild(value);\n      element.appendChild(popup);\n      const handle = document.createElement('cv-icon');\n      handle.classList.add('dropdown');\n      handle.classList.add('ri-arrow-down-s-line');\n      element.appendChild(handle);\n\n      if (this._writeAddresses.length > 0) {\n        element.addEventListener('click', ev => this.onClicked(ev));\n      }\n    },\n\n    onClicked(ev) {\n      const style = getComputedStyle(this.__popup);\n      for (let target of ev.path) {\n        if (target.tagName.toLowerCase() === 'cv-option') {\n          // select this option\n          this._sendSelection(target.getAttribute('key'), true);\n          break;\n        }\n        if (target === ev.currentTarget) {\n          break;\n        }\n      }\n      // open popup\n      if (style.getPropertyValue('display') === 'none') {\n        this.__popup.style.display = 'block';\n      } else {\n        this.__popup.style.display ='none';\n      }\n    },\n\n    _sendSelection(key, predictive) {\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: key,\n          source: this\n        }\n      });\n      this._writeAddresses.filter(addr => !addr.hasAttribute('on') || addr.getAttribute('on') === 'click').forEach(address => address.dispatchEvent(ev));\n      if (predictive === true) {\n        this.setValue(key);\n      }\n    },\n\n    _updateValue(mappedValue, value) {\n      if (this.__options.has(mappedValue)) {\n        this.__value.innerHTML = '';\n        const current = this.__options.get(mappedValue);\n        if (current.children.length > 0) {\n          // if we have non text children, we only use them (only icons no text)\n          for (const child of current.children) {\n            this.__value.appendChild(child.cloneNode());\n          }\n        } else {\n          this.__value.innerHTML = current.innerHTML;\n        }\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'select', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Slider.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows a range slider.\n */\nqx.Class.define('cv.ui.structure.tile.components.Slider', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    stepWidth: {\n      check: 'Number',\n      init: 5\n    },\n    min: {\n      check: 'Number',\n      init: 1,\n      apply: '_applyMin'\n    },\n    max: {\n      check: 'Number',\n      init: 100,\n      apply: '_applyMax'\n    },\n    showValue: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowValue'\n    },\n    throttleInterval: {\n      check: 'Number',\n      init: 250,\n      apply: '_applyThrottleInterval'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __throttled: null,\n    __input: null,\n\n    _init() {\n      this.base(arguments);\n      const element = this._element;\n      if (element.hasAttribute('throttle-interval')) {\n        this.setThrottleInterval(parseInt(element.getAttribute('throttle-interval')));\n      } else {\n        this._applyThrottleInterval(this.getThrottleInterval());\n      }\n\n      // init components\n      let input = element.querySelector(':scope > input');\n      if (!input) {\n        input = document.createElement('input');\n        input.classList.add('slider');\n        input.setAttribute('type', 'range');\n        element.insertBefore(input, element.querySelector(':scope > .up'));\n        input.oninput = () => this.__throttled.call();\n      }\n      this.__input = input;\n      if (element.hasAttribute('step-width')) {\n        this.setStepWidth(parseInt(element.getAttribute('step-width')));\n      }\n      if (element.hasAttribute('min')) {\n        this.setMin(parseInt(element.getAttribute('min')));\n      }\n      if (element.hasAttribute('max')) {\n        this.setMax(parseInt(element.getAttribute('max')));\n      }\n      if (element.hasAttribute('hide-value') && element.getAttribute('hide-value') === 'true') {\n        this.setShowValue(false);\n      } else {\n        this._applyShowValue(true);\n      }\n\n      const decreaseElement = element.querySelector(':scope > .decrease');\n      if (decreaseElement) {\n        decreaseElement.addEventListener('click', ev => this.onDecrease());\n      }\n      const increaseElement = element.querySelector(':scope > .increase');\n      if (increaseElement) {\n        increaseElement.addEventListener('click', ev => this.onIncrease());\n      }\n    },\n\n    _applyThrottleInterval(value) {\n      if (value > 0) {\n        this.__throttled = cv.util.Function.throttle(this.onInput, value, { trailing: true }, this);\n      } else {\n        // no throttling, direct call\n        this.__throttled = {\n          call: () => this.onInput(),\n          abort: () => {}\n        };\n      }\n    },\n\n    _applyMin(value) {\n      const input = this._element.querySelector(':scope > input');\n      input.setAttribute('min', '' + value);\n    },\n\n    _applyMax(value) {\n      const input = this._element.querySelector(':scope > input');\n      input.setAttribute('max', '' + value);\n    },\n\n    _applyShowValue(value) {\n      let valueLabel = this._element.querySelector(':scope > label.value');\n      if (value) {\n        if (!valueLabel) {\n          valueLabel = document.createElement('label');\n          valueLabel.classList.add('value');\n          valueLabel.classList.add('secondary');\n          this._element.insertBefore(valueLabel, this._element.firstChild);\n        }\n      }\n    },\n\n    _updateValue(mappedValue, value) {\n      const target = this._element.querySelector(':scope > input');\n      if (target) {\n        target.value = value;\n      }\n      if (this.isShowValue()) {\n        let valueLabel = this._element.querySelector(':scope > label.value');\n        if (valueLabel) {\n          valueLabel.innerText = mappedValue;\n        }\n      }\n    },\n\n    onInput() {\n      this.__sendValue(this.__input.value);\n    },\n\n    onDecrease() {\n      const value = this.getValue() - this.getStepWidth();\n      this.__sendValue(value, 'decrease');\n    },\n\n    onIncrease() {\n      const value = this.getValue() + this.getStepWidth();\n      this.__sendValue(value, 'increase');\n    },\n\n    __sendValue(value, on) {\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: value,\n          source: this\n        }\n      });\n      this._writeAddresses.filter(addr => !addr.hasAttribute('on') || addr.getAttribute('on') === on).forEach(address => address.dispatchEvent(ev));\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'slider', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Spinner.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows a number value that can be increased and decreased by a defined step width.\n */\nqx.Class.define('cv.ui.structure.tile.components.Spinner', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    stepWidth: {\n      check: 'Number',\n      init: 1.0\n    },\n    mode: {\n      check: ['relative', 'absolute'],\n      init: 'absolute'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _init() {\n      this.base(arguments);\n      const element = this._element;\n      if (element.hasAttribute('step-width')) {\n        this.setStepWidth(parseFloat(element.getAttribute('step-width')));\n      }\n      if (element.hasAttribute('mode')) {\n        this.setMode(element.getAttribute('mode'));\n      }\n      // init components\n      let valueElement = element.querySelector(':scope > .value');\n      if (!valueElement) {\n        valueElement = document.createElement('label');\n        valueElement.classList.add('value');\n        valueElement.classList.add('primary');\n        element.appendChild(valueElement);\n      }\n      // add increase / decrease buttons\n      const decrease = document.createElement('div');\n      decrease.classList.add('clickable');\n      decrease.classList.add('left');\n      const decreaseIcon = document.createElement('cv-icon');\n      decreaseIcon.classList.add('ri-arrow-down-s-line');\n      decrease.addEventListener('click', () => this.onDecrease());\n      decrease.appendChild(decreaseIcon);\n      element.insertBefore(decrease, valueElement);\n\n      const increase = document.createElement('div');\n      increase.classList.add('clickable');\n      increase.classList.add('right');\n      const increaseIcon = document.createElement('cv-icon');\n      increaseIcon.classList.add('ri-arrow-up-s-line');\n      increase.appendChild(increaseIcon);\n      increase.addEventListener('click', () => this.onIncrease());\n      element.appendChild(increase);\n    },\n\n    onDecrease() {\n      const value = this.getMode() === 'absolute' ? this.getValue() - this.getStepWidth() : this.getStepWidth() * -1;\n      this.__sendValue(value, 'decrease');\n    },\n\n    onIncrease() {\n      const value = this.getMode() === 'absolute' ? this.getValue() + this.getStepWidth() : this.getStepWidth();\n      this.__sendValue(value, 'increase');\n    },\n\n    _updateValue(mappedValue) {\n      const target = this._element.querySelector('.value');\n      if (target) {\n        target.innerHTML = mappedValue;\n      }\n    },\n\n    __sendValue(value, on) {\n      const ev = new CustomEvent('sendState', {\n        detail: {\n          value: value,\n          source: this\n        }\n      });\n      this._writeAddresses.filter(addr => !addr.hasAttribute('on') || addr.getAttribute('on') === on).forEach(address => address.dispatchEvent(ev));\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'spinner', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Value.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows a value from the backend, as label or image/icon\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.components.Value', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: [cv.ui.structure.tile.MVisibility, cv.ui.structure.tile.MResize],\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _queuedOverflowDetection: null,\n    _debouncedDetectOverflow: null,\n\n    _init() {\n      this.base(arguments);\n      this._debouncedDetectOverflow = qx.util.Function.debounce(this._detectOverflow, 20);\n      const target = this._element.querySelector('.value');\n      if (target && target.tagName.toLowerCase() === 'label') {\n        // check for overflowing text, when labels parent gets resized\n        this.setResizeTarget(this._element);\n        this.addListener('resized', this._debouncedDetectOverflow, this);\n      }\n    },\n\n    _applyVisible(visible) {\n      if (visible) {\n        if (this._queuedOverflowDetection) {\n          this._debouncedDetectOverflow();\n        }\n      } else {\n        const target = this._element.querySelector('.value');\n        if (target && target.classList.contains('scroll')) {\n          target.classList.remove('scroll');\n        }\n      }\n    },\n\n    _detectOverflow() {\n      const target = this._element.querySelector('.value');\n      if (this.isVisible()) {\n        this._queuedOverflowDetection = false;\n        if (target.clientWidth > target.parentElement.clientWidth) {\n          target.classList.add('scroll');\n        } else {\n          target.classList.remove('scroll');\n        }\n      } else {\n        this._queuedOverflowDetection = true;\n      }\n    },\n\n    _updateValue(mappedValue, value) {\n      const target = this._element.querySelector('.value');\n      let styleClass = '';\n      if (target) {\n        const tagName = target.tagName.toLowerCase();\n        switch (tagName) {\n          case 'cv-icon':\n            target._instance.setId(mappedValue);\n            if (this._element.hasAttribute('styling')) {\n              styleClass = cv.Application.structureController.styleValue(this._element.getAttribute('styling'), value, this.__store);\n            }\n            target._instance.setStyleClass(styleClass);\n            break;\n          case 'meter':\n            target.setAttribute('value', mappedValue);\n            target.innerHTML = '' + mappedValue;\n            break;\n          case 'cv-round-progress':\n            if (typeof value === 'string') {\n              value = parseInt(value);\n            }\n            target._instance.setProgress(value);\n            target._instance.setText('' + mappedValue);\n            break;\n          case 'label':\n            target.innerHTML = mappedValue;\n            this._debouncedDetectOverflow();\n            break;\n        }\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'value', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Backend.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * <cv-backend> Custom element to define a backend connection\n */\nqx.Class.define('cv.ui.structure.tile.elements.Backend', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _name: null,\n    __applyValues: null,\n\n    _init() {\n      const element = this._element;\n      const type = element.getAttribute('type');\n      const uriString = element.hasAttribute('uri') ? element.getAttribute('uri') : '';\n      let uri;\n      if (uriString) {\n        try {\n          uri = new URL(uriString, window.location.origin + window.location.pathname);\n        } catch (e) {\n          this.error('Error parsing uri: ' + uriString);\n        }\n      }\n\n      if (type) {\n        let credentials = null;\n        if (element.hasAttribute('username')) {\n          credentials = {\n            username: element.getAttribute('username'),\n            password: element.getAttribute('password') || ''\n          };\n        } else if (uri && uri.username) {\n          credentials = {\n            username: uri.username,\n            password: uri.password\n          };\n        }\n        const model = cv.data.Model.getInstance();\n        let backendUrl = uri ? uri.toString() : null;\n        let backendUrlConfigKey;\n        switch (type) {\n          case 'knxd':\n            backendUrlConfigKey = 'backendKnxdUrl';\n            break;\n          case 'openhab':\n            backendUrlConfigKey = 'backendOpenHABUrl';\n            break;\n          case 'mqtt':\n            backendUrlConfigKey = 'backendMQTTUrl';\n            break;\n        }\n        if (backendUrlConfigKey) {\n          // override by URL settings\n          if (cv.Config.URL[backendUrlConfigKey]) {\n            backendUrl = cv.Config.URL[backendUrlConfigKey]\n          } else if (!backendUrl && cv.Config.server[backendUrlConfigKey]) {\n            backendUrl = cv.Config.server[backendUrlConfigKey]\n          }\n        }\n        let name = type;\n        if (element.hasAttribute('name')) {\n          name = element.getAttribute('name');\n        } else if (!cv.io.BackendConnections.hasClient('main')) {\n          // we need one main backend\n          name = 'main';\n        } else if (cv.io.BackendConnections.getClient('main').configuredIn === 'config') {\n          qx.log.Logger.warn(this, `there is already a backend registered with name \"main\" and type ${type} skipping this one`);\n          return;\n        }\n        qx.log.Logger.debug(this, 'init backend', name);\n        if (cv.io.BackendConnections.hasClient(name)) {\n          const notification = {\n            topic: 'cv.config.error',\n            title: qx.locale.Manager.tr('Config error'),\n            message:  qx.locale.Manager.tr('There already exists a backend named: \"%1\"', name),\n            severity: 'urgent',\n            unique: true,\n            deletable: true\n          };\n          cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n          return;\n        }\n        const client = cv.io.BackendConnections.addBackendClient(name, type, backendUrl, 'config');\n        this._client = client;\n        this._name = name;\n        this.__applyValues = [];\n        client.update = data => model.updateFrom(name, data); // override clients update function\n        client.login(true, credentials, () => {\n          this.debug(name, 'connected');\n          if (element.hasAttribute('default') && element.getAttribute('default') === 'true') {\n            model.setDefaultBackendName(name);\n          }\n          const doSubscribe = () => {\n            for (const [address, value] of this.__applyValues) {\n              this.debug(name, 'apply update', address, value);\n              model.onUpdate(address, value, name);\n            }\n            const addressesToSubscribe = model.getAddresses(name);\n            this.debug(name, 'subscribing to', addressesToSubscribe.length, 'addresses');\n            if (addressesToSubscribe.length !== 0) {\n              client.subscribe(addressesToSubscribe);\n            }\n          };\n          if (cv.TemplateEngine.getInstance().isDomFinished()) {\n            doSubscribe();\n          } else {\n            qx.event.message.Bus.subscribe('setup.dom.finished', function () {\n              doSubscribe();\n            }, this);\n          }\n        });\n\n\n        for (const data of element.querySelectorAll(':scope > cv-data')) {\n          if (data.hasAttribute('address')) {\n            let value = data.textContent.trim();\n            if (data.hasAttribute('transform')) {\n              const encoding = data.getAttribute('transform');\n              const encodedValue = cv.Transform.encodeBusAndRaw({transform: encoding}, value);\n              value = encodedValue.bus;\n            }\n            this.__applyValues.push([data.getAttribute('address'), value]);\n          }\n        }\n      } else {\n        this.error('<cv-backend> must have a type attribute');\n      }\n    },\n\n    _disconnected() {\n      if (this._client) {\n        const model = cv.data.Model.getInstance();\n        if (this._element.hasAttribute('default') && this._element.getAttribute('default') === 'true') {\n          model.resetDefaultBackendName();\n        }\n        this._client.terminate();\n        cv.io.BackendConnections.removeClient(this._client);\n        this._client.dispose();\n        this._client = null;\n      }\n    }\n  },\n\n  defer(Clazz) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'backend', class extends QxConnector {\n      constructor() {\n        super(Clazz);\n      }\n    });\n  }\n});\n","/* Loader.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Loads external content like CSS/JS files, config-content or a template file.\n *\n *  @author Tobias Bräutigam\n *  @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.elements.Loader', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _init() {\n      const element = this._element;\n      const type = element.getAttribute('type');\n      const src = element.getAttribute('src');\n      let loaderElement;\n      if (src) {\n        switch (type) {\n          case 'css':\n            loaderElement = document.createElement('link');\n            loaderElement.setAttribute('type', 'text/css');\n            loaderElement.setAttribute('rel', 'stylesheet');\n            loaderElement.setAttribute('href', src);\n            break;\n\n          case 'js':\n            loaderElement = document.createElement('script');\n            loaderElement.setAttribute('type', 'text/javascript');\n            loaderElement.setAttribute('src', src);\n            break;\n\n          case 'templates':\n            this.loadXml(src, type);\n            break;\n        }\n\n        if (loaderElement) {\n          element.appendChild(loaderElement);\n        }\n      }\n    },\n\n    loadXml(uri) {\n      const ajaxRequest = new qx.io.request.Xhr(uri);\n      ajaxRequest.set({\n        accept: 'application/xml',\n        cache: !cv.Config.forceReload\n      });\n      ajaxRequest.addListenerOnce('success', function (e) {\n        let content = e.getTarget().getResponse();\n        let htmlContent = content;\n        const target = cv.Application.structureController.getRenderTarget();\n        // we need the documents to be in HTML namespace\n        if (!htmlContent.documentElement.xmlns) {\n          let text = e.getTarget().getResponseText();\n          text = text.replace('<templates', '<templates xmlns=\"http://www.w3.org/1999/xhtml\"');\n          const parser = new DOMParser();\n          htmlContent = parser.parseFromString(text, 'text/xml');\n        }\n        let child;\n        while ((child = htmlContent.documentElement.firstElementChild)) {\n          target.appendChild(child);\n        }\n        // register custom elements for templates in this document\n        cv.Application.structureController.registerTemplates(content);\n      });\n      ajaxRequest.addListener('statusError', function (e) {\n        const status = e.getTarget().getTransport().status;\n        if (!qx.util.Request.isSuccessful(status)) {\n          this.handleError('filenotfound', ajaxRequest.getUrl());\n        } else {\n          this.handleError(status, null);\n        }\n      }, this);\n\n      ajaxRequest.send();\n    },\n\n    handleError(textStatus, additionalErrorInfo) {\n      const title = qx.locale.Manager.tr('File Error!').translate().toString();\n      let message = '';\n      let actions;\n      switch (textStatus) {\n        case 'parsererror':\n          message = qx.locale.Manager.tr('Invalid XML file!');\n          break;\n        case 'filenotfound':\n          message = qx.locale.Manager.tr('404: File not found, %1.', additionalErrorInfo).translate().toString();\n          break;\n        default:\n          message = qx.locale.Manager.tr('Unhandled error of type \"%1\"', textStatus).translate().toString();\n          if (additionalErrorInfo) {\n            message += ': ' + additionalErrorInfo;\n          } else {\n            message += '.';\n          }\n      }\n      const notification = {\n        topic: 'cv.error',\n        title: title,\n        message: message\n      };\n      if (actions) {\n        notification.actions = actions;\n      }\n      cv.core.notifications.Router.dispatchMessage(notification.topic, notification);\n      this.error(this, message.toString());\n    }\n  },\n\n  defer(Clazz) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'loader', class extends QxConnector {\n      constructor() {\n        super(Clazz);\n      }\n    });\n  }\n});\n","/* Mapping.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Mapping maps a value to another value that can be used to show e.g. the current state.\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.elements.Mapping', {\n  extend: cv.ui.structure.tile.elements.AbstractCustomElement,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (element) {\n    this.base(arguments, element);\n    this.__cache = {};\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __cache: null,\n\n    _applyConnected(value, oldValue, name) {\n      this.base(arguments, value, oldValue, name);\n      // avoid adding styling elements here as they inherit this method but call the super method too\n      if (this._element.tagName.toLowerCase().endsWith('mapping')) {\n        if (value) {\n          cv.Application.structureController.addMapping(this._element.getAttribute('name'), this);\n        } else {\n          cv.Application.structureController.removeMapping(this._element.getAttribute('name'));\n        }\n      }\n    },\n\n    /**\n     *\n     * @param val {variant}\n     * @param store {Map<string, variant>?} optional stored values from other addresses\n     * @return {string|*|string}\n     */\n    mapValue(val, store) {\n      if (Object.prototype.hasOwnProperty.call(this.__cache, val)) {\n        return this.__cache[val];\n      }\n      let mappedValue = '' + val;\n      const exactMatch = this._element.querySelector(':scope > entry[value=\"'+val+'\"]');\n      let type = this._element.hasAttribute('type') ? this._element.getAttribute('type') : 'string';\n      if (exactMatch) {\n        mappedValue = this._convert(exactMatch.innerHTML.trim(), type);\n        this.__cache[val] = mappedValue;\n        return mappedValue;\n      }\n      const formula = this._element.querySelector(':scope > formula');\n      if (formula) {\n        if (!formula._formula) {\n          let content = formula.textContent;\n          formula._formula = new Function('x', 'store', 'let y;' + content + '; return y;');\n        }\n        mappedValue = this._convert(formula._formula(val, store), type);\n        return mappedValue;\n      }\n      const entries = this._element.querySelectorAll(':scope > entry');\n      let defaultValue = null;\n\n      const mapped = Array.from(entries).some(entry => {\n        let matches = false;\n        let isDefaultValue = entry.hasAttribute('default') && entry.getAttribute('default') === 'true';\n        if (entry.hasAttribute('value')) {\n          const value = entry.getAttribute('value');\n          if (value === (val ? val : 'NULL') || value === '*') {\n            mappedValue = this._convert(entry.innerHTML.trim(), type);\n            matches = true;\n          }\n          if (isDefaultValue) {\n            defaultValue = this._convert(value, type);\n          }\n        } else if (entry.hasAttribute('range-min')) {\n          const rangeMin = parseFloat(entry.getAttribute('range-min'));\n          const rangeMax = entry.hasAttribute('range-max') ? parseFloat(entry.getAttribute('range-max')) : Number.POSITIVE_INFINITY;\n          const floatValue = parseFloat(val);\n          if (rangeMin <= floatValue && floatValue <= rangeMax) {\n            mappedValue = this._convert(entry.innerHTML.trim(), type);\n            matches = true;\n          }\n          if (isDefaultValue) {\n            defaultValue = rangeMin;\n          }\n        }\n        return matches;\n      });\n      if (!mapped && defaultValue !== null) {\n        mappedValue = this.mapValue(defaultValue);\n      }\n      this.__cache[val] = mappedValue;\n      return mappedValue;\n    },\n\n    _convert(value, type) {\n      switch (type.toLowerCase()) {\n        case 'boolean':\n          return value === 'true';\n        case 'integer':\n          return parseInt(value);\n        case 'float':\n          return parseFloat(value);\n        default:\n          return value;\n      }\n    }\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__cache = null;\n  },\n\n  defer(Clazz) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'mapping', class extends QxConnector {\n      constructor() {\n        super(Clazz);\n      }\n    });\n  }\n});\n","/* Styling.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Styling maps a value to another value that can be used to style a component\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.elements.Styling', {\n  extend: cv.ui.structure.tile.elements.Mapping,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyConnected(value, oldValue, name) {\n      this.base(arguments, value, oldValue, name);\n      if (value) {\n        cv.Application.structureController.addStyling(this._element.getAttribute('name'), this);\n      } else {\n        cv.Application.structureController.removeStyling(this._element.getAttribute('name'));\n      }\n    }\n  },\n  defer(Clazz) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'styling', class extends QxConnector {\n      constructor() {\n        super(Clazz);\n      }\n    });\n  }\n});\n","/* Group.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Creates a group of widgets that can be hidden (works like the <detail> HTML Element)\n *\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.widgets.Group', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    _init() {\n      this.base(arguments);\n      const element = this._element;\n      let label = null;\n      let summary = null;\n      const needsSummary = element.hasAttribute('name') || element.hasAttribute('icon');\n      if (needsSummary) {\n        summary = element.querySelector(':scope > summary');\n        if (!summary) {\n          summary = document.createElement('summary');\n          element.insertBefore(summary, element.firstChild);\n        }\n        if (element.hasAttribute('name')) {\n          label = element.querySelector(':scope > summary > label.title');\n          if (!label) {\n            label = document.createElement('label');\n            label.classList.add('title');\n            summary.insertBefore(label, summary.firstChild);\n          }\n          label.classList.add('last-of-title');\n          label.textContent = element.getAttribute('name');\n        }\n        if (element.hasAttribute('icon')) {\n          let icon = element.querySelector(':scope > summary > cv-icon.title');\n          if (!icon) {\n            icon = document.createElement('cv-icon');\n            icon.classList.add('title');\n            summary.insertBefore(icon, summary.firstChild);\n          }\n          if (!label) {\n            icon.classList.add('last-of-title');\n          }\n          icon.classList.add(element.getAttribute('icon'));\n        }\n      }\n      const empty = !element.querySelector(':scope > *:not(summary)');\n      if (empty) {\n        element.classList.add('empty');\n      } else if (summary) {\n        qx.event.Registration.addListener(summary, 'click', this._toggleOpen, this);\n      }\n    },\n\n    _toggleOpen() {\n      if (this._element.hasAttribute('open')) {\n        this._element.removeAttribute('open');\n      } else {\n        this._element.setAttribute('open', 'true');\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from a cv-address component\n     */\n    onStateUpdate(ev) {\n      if (!this.base(arguments, ev)) {\n        if (ev.detail.target === 'summary') {\n          let target = this._element.querySelector(':scope > summary > label.value');\n          if (!target) {\n            target = document.createElement('label');\n            target.classList.add('value');\n            const summary = this._element.querySelector(':scope > summary');\n            summary.appendChild(target);\n          }\n          target.textContent = ev.detail.state;\n        } else {\n          this.debug('unhandled address target', ev.detail.target);\n        }\n      }\n    }\n  },\n\n  defer: function(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'group', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Page.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Creates a new sub page and adds a corresponding link to the current page.\n *\n * @ignore(InstallTrigger)\n * @author Tobias Bräutigam\n * @since 2021\n */\nqx.Class.define('cv.ui.structure.tile.widgets.Page', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    visibility: {\n      refine: true,\n      init: 'excluded'\n    }\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n    _supportsContentVisibility: null,\n\n    _init() {\n      if (typeof InstallTrigger !== 'undefined') {\n        // firefox does not support content-visibility CSS property\n        // see: https://developer.mozilla.org/en-US/docs/Web/CSS/content-visibility\n        this._element.classList.add('no-content-visibility');\n        this._supportsContentVisibility = false;\n      } else {\n        this._supportsContentVisibility = true;\n      }\n    },\n\n    _applyVisibility(value) {\n      switch (value) {\n        case 'visible':\n          if (this._supportsContentVisibility) {\n            this._element.style.contentVisibility = 'visible';\n          } else if (this._visibleDisplayMode) {\n            this._element.style.display = this._visibleDisplayMode || 'initial';\n          }\n          break;\n\n        case 'hidden':\n        case 'excluded':\n          if (this._supportsContentVisibility) {\n            this._element.style.contentVisibility = 'hidden';\n          } else {\n            this._visibleDisplayMode = getComputedStyle(this._element).getPropertyValue('display');\n            this._element.style.display = 'none';\n          }\n          break;\n      }\n    }\n  },\n\n  defer: function(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'page', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'row', class extends HTMLElement {\n      constructor() {\n        super();\n        if (this.hasAttribute('colspan')) {\n          this.classList.add('colspan-' + this.getAttribute('colspan'));\n        }\n        if (this.hasAttribute('rowspan')) {\n          this.classList.add('rowspan-' + this.getAttribute('rowspan'));\n        }\n      }\n    });\n  }\n});\n","/* Popup.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Creates a popup that contains arbitrary content and can be opened as an overlay over the current UI.\n *\n * @author Tobias Bräutigam\n * @since 2022\n */\nqx.Class.define('cv.ui.structure.tile.widgets.Popup', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: cv.ui.structure.tile.MPopup,\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    openedPopups: []\n  },\n\n  /*\n   ******************************************************\n   MEMBERS\n   ******************************************************\n   */\n  members: {\n\n    _init() {\n      this.base(arguments);\n      const popup = this._element;\n      const closeable = !popup.hasAttribute('closeable') || popup.getAttribute('closeable') === 'true';\n      if (closeable) {\n        this._closeButton = document.createElement('button');\n        this._closeButton.classList.add('close');\n        const icon = document.createElement('i');\n        icon.classList.add('ri-close-line');\n        this._closeButton.appendChild(icon);\n        popup.insertBefore(this._closeButton, popup.firstChild);\n        this._closeButton.addEventListener('click', () => this.close());\n      }\n      if (popup.hasAttribute('auto-close-timeout')) {\n        const timeoutSeconds = parseInt(popup.getAttribute('auto-close-timeout'));\n        if (!isNaN(timeoutSeconds)) {\n          this._autoCloseTimer = new qx.event.Timer(timeoutSeconds * 1000);\n          this._autoCloseTimer.addListener('interval', () => {\n            this._autoCloseTimer.stop();\n            this.close();\n          });\n        } else {\n          this.error('invalid auto-close-timeout value:', popup.getAttribute('auto-close-timeout'));\n        }\n      }\n    },\n\n    open() {\n      const popup = this._element;\n      if (!popup.hasAttribute('open')) {\n        popup.setAttribute('open', '');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.registerModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.start();\n        }\n      }\n    },\n\n    close() {\n      const popup = this._element;\n      if (popup) {\n        popup.removeAttribute('open');\n        if (popup.hasAttribute('modal') && popup.getAttribute('modal') === 'true') {\n          this.unregisterModalPopup();\n        }\n        if (this._autoCloseTimer) {\n          this._autoCloseTimer.stop();\n        }\n        popup.dispatchEvent(new CustomEvent('closed'));\n      }\n    },\n\n\n    /**\n     * Handles the incoming data from the backend for this widget.\n     * The popup handles the special address-targets:\n     *  - open: opens the popup when the address value is 'true' or 1 => no auto closing\n     *  - close: closes the popup when the address value is 'false' or 0 => no auto opening\n     *  - open-close: the upper both combined => popup visibility fully dependent on the address value, auto-opening + auto-closing\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from an cv-address component\n     */\n    onStateUpdate(ev) {\n      if (!this.base(arguments, ev)) {\n        switch (ev.detail.target) {\n          case 'open':\n            if (ev.detail.state) {\n              this.open();\n            }\n            break;\n\n          case 'open-close':\n            if (ev.detail.state) {\n              this.open();\n            } else {\n              this.close();\n            }\n            break;\n\n          case 'close':\n            if (!ev.detail.state) {\n              this.close();\n            }\n            break;\n\n          default:\n            this.debug('unhandled address target', ev.detail.target);\n            break;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_autoCloseTimer');\n    if (this._closeButton) {\n      this._closeButton.remove();\n      this._closeButton = null;\n    }\n  },\n\n  defer: function(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'popup', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n","/* Tile.js \n * \n * copyright (c) 2010-2022, Christian Mayer and the CometVisu contributers.\n * \n * This program is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the Free\n * Software Foundation; either version 3 of the License, or (at your option)\n * any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n * more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA\n */\n\n/**\n * Shows a tile\n */\nqx.Class.define('cv.ui.structure.tile.widgets.Tile', {\n  extend: cv.ui.structure.tile.components.AbstractComponent,\n  include: cv.ui.structure.tile.MPopup,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    backgroundImage: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyBackgroundImage'\n    },\n\n    /**\n     * Turn this tile into a popup\n     */\n    popup: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyPopup'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _init() {\n      this.base(arguments);\n      this._initPopupChild();\n      if (this._element.hasAttribute('background-image')) {\n        this.setBackgroundImage(this._element.getAttribute('background-image'));\n      }\n      if (this._childPopup) {\n        this._childPopup.addEventListener('closed', () => {\n          this.resetPopup();\n        });\n      }\n    },\n\n    _applyBackgroundImage(value) {\n      if (value) {\n        this._element.style.backgroundImage = `url(${value})`;\n        let overlay = this._element.querySelector(':scope > div.overlay');\n        if (!overlay) {\n          overlay = document.createElement('div');\n          overlay.classList.add('overlay');\n          this._element.insertBefore(overlay, this._element.firstChild);\n        }\n        this._element.classList.add('has-bg-image');\n      } else {\n        this._element.style.backgroundImage = '';\n        this._element.classList.remove('has-bg-image');\n      }\n    },\n\n    open() {\n      if (this._childPopup) {\n        this._openPopupChild();\n      } else {\n        let closeButton = this._element.querySelector(':scope > button.close');\n        if (!closeButton) {\n          closeButton = document.createElement('button');\n          closeButton.classList.add('close');\n          const icon = document.createElement('i');\n          icon.classList.add('ri-close-line');\n          closeButton.appendChild(icon);\n          this._element.appendChild(closeButton);\n          closeButton.addEventListener('click', () => this.setPopup(false));\n        }\n        closeButton.style.display = 'block';\n        this._element.classList.add('popup');\n        this.registerModalPopup();\n      }\n    },\n\n    close(keepState) {\n      if (!keepState) {\n        this.setPopup(false);\n      }\n      if (this._childPopup) {\n        this._closePopupChild();\n      } else {\n        this._element.classList.remove('popup');\n        let closeButton = this._element.querySelector(':scope > button.close');\n        if (closeButton) {\n          closeButton.style.display = 'none';\n        }\n        this.unregisterModalPopup();\n      }\n      if (this._autoCloseTimer) {\n        this._autoCloseTimer.stop();\n      }\n    },\n\n    _applyPopup(value) {\n      if (value) {\n        this.open();\n      } else {\n        this.close(true);\n      }\n    },\n\n    /**\n     * Handles the incoming data from the backend for this widget\n     *\n     * @param ev {CustomEvent} stateUpdate event fired from a cv-address component\n     */\n    onStateUpdate(ev) {\n      if (!this.base(arguments, ev)) {\n        switch (ev.detail.target) {\n          case 'background-image':\n            this.setBackgroundImage(ev.detail.state);\n            break;\n\n          case 'popup':\n            if (ev.detail.addressValue) {\n              // only open when the sent value equals the fixed value\n              // noinspection EqualityComparisonWithCoercionJS\n              if (ev.detail.addressValue == ev.detail.state) {\n                this.setPopup(true);\n                // this is not closing by address, so we set a close timeout to 3 minutes\n                if (!this._autoCloseTimer) {\n                  this._autoCloseTimer = new qx.event.Timer(180 * 1000);\n                  this._autoCloseTimer.addListener('interval', this.close, this);\n                }\n                this._autoCloseTimer.restart();\n              }\n            } else {\n              // open / close depending on value\n              // noinspection EqualityComparisonWithCoercionJS\n              this.setPopup(ev.detail.state == 1);\n            }\n            break;\n\n          default:\n            this.debug('unhandled address target', ev.detail.target);\n        }\n      }\n    }\n  },\n\n  defer(QxClass) {\n    customElements.define(cv.ui.structure.tile.Controller.PREFIX + 'tile', class extends QxConnector {\n      constructor() {\n        super(QxClass);\n      }\n    });\n  }\n});\n"]}