{"version":3,"sources":["/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/IActionHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/MFileEventHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/IFileEventHandler.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/Main.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/FileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/BackupFolder.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/ActionDispatcher.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/snackbar/Controller.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Preferences.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileHandlerRegistry.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/IEditor.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/AbstractEditor.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/core/GlobalState.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/OpenFile.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/CompareFiles.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/control/FileController.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/Prompt.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/MenuBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/upload/UploadMgr.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/upload/MDragUpload.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/FileSystem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/ToolBar.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/FileTabItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/BigAlert.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Message.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/snackbar/Message.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/AbstractViewer.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Folder.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/Icons.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/Start.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Source.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Tree.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Diff.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/Worker.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/FileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/GlobalFileItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/VirtualFsItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/FileListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/core/IconAtom.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/completion/Config.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/Schema.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/completion/CometVisu.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/ElementChange.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/tree/VirtualElementItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/contextmenu/ConfigElement.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ElementForm.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Base.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/MAnnotation.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Element.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/XmlElement.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/editor/data/Provider.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/dialog/ValidationError.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/config/Section.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SectionListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/viewer/SvgIcon.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/basic/Image.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/SourceCodeField.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/Option.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/VirtualSelectBox.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/CheckBox.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/ElementFormRenderer.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/DocumentationMapping.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/SimpleType.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Choice.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Sequence.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Group.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Any.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/schema/Attribute.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/model/config/Option.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/form/OptionListItem.js","/home/runner/work/CometVisu/CometVisu/source/class/cv/ui/manager/basic/Icon.js"],"names":["qx","Interface","define","members","canHandleAction","actionName","handleAction","data","configureButton","actionId","button","unConfigureButton","cv","ui","manager","IActionHandler","$$dbClassInfo","Bootstrap","executePendingDefers","Mixin","construct","this","_disableFileEvents","event","message","Bus","subscribe","_handleFileEvent","destruct","unsubscribe","control","MFileEventHandler","ev","IFileEventHandler","Class","extend","core","Object","type","include","implement","constructor","call","iconfont","material","Load","model","BackupFolder","getInstance","_checkEnvironment","initOpenFiles","Array","__P_23_0","ActionDispatcher","setMain","__P_23_1","_draw","_onManagerEvent","tooltip","Manager","statics","ROOT","properties","openFiles","check","deferredInit","writeableFolder","init","currentFolder","nullable","apply","currentSelection","deleteableSelection","renameableSelection","visible","__P_23_2","__P_23_3","_pane","_tree","_stack","_oldCommandGroup","_managerCommands","_mainContent","_openFilesController","_hiddenConfigFakeFile","_applyVisible","value","Init","getApplication","getCommandManager","setActive","bom","element","Style","set","__P_23_4","io","rest","Client","getFsClient","checkEnvironmentSync","err","res","snackbar","Controller","error","forEach","env","refreshActions","entity","state","locale","tr","FileItem","setReadable","setWriteable","widget","getFocusedWidget","resetFocusedWidget","setFocusedWidget","getCurrentSelection","isWriteable","actions","getCurrentFolder","push","includes","closeFile","closeCurrentFile","setVisible","_onCreate","readSync","path","file","getFullPath","isConfigFile","_onDelete","_showAbout","warn","getData","action","getOpenFiles","copy","some","openFile","getFile","isRelated","resetCurrentFolder","refresh","__P_23_5","name","demoFolder","getChildren","child","getName","startsWith","substr","handler","handlerOptions","_onChangeTreeSelection","Preferences","isQuickPreview","mode","__P_23_6","node","getType","setCurrentFolder","getParent","setCurrentSelection","resetCurrentSelection","setEditing","_applyCurrentFolder","old","removeRelatedBindings","bind","resetWriteableFolder","_applyCurrentSelection","converter","resetDeleteableSelection","_onChangeFileSelection","sel","getSelection","length","editorConfig","getItem","handlerId","getHandlerId","FileHandlerRegistry","getFileHandlerById","getFileHandler","instance","Clazz","isReady","setFile","addListenerOnce","indexOf","add","editor","AbstractEditor","setHandlerOptions","getHandlerOptions","setSelection","GlobalState","setOpenedFocusedFile","resetOpenedFocusedFile","preview","handlerType","handlerConf","isExternal","info","classname","isOpen","of","OpenFile","resetHandlerOptions","isPermanent","setItem","setPermanent","getTarget","setModelSelection","force","f","isCloseable","isModified","resetPermanent","selectionIndex","remove","currentHandler","hasInterface","IEditor","resetFile","resetSelection","replace","CompareFiles","fileHandlerConf","clear","filter","destroy","window","monaco","oldModel","getModel","getUri","dispose","isTemporary","qxl","dialog","Dialog","confirm","confirmed","resetModified","dispatchByName","selected","_onCloseFile","dom","Element","create","id","style","insertEnd","document","body","theme","Meta","setTheme","Dark","group","command","Group","Command","renameCommand","getActive","item","FileController","_onChangeStackSelection","page","toArray","find","__P_23_7","callback","context","caption","prompt","Prompt","show","content","folder","existsMessage","handlePrompt","filename","match","exec","readable","writeable","loaded","modified","temporary","parentFolder","createSync","getBusTopic","source","addChild","sortElements","__P_23_8","elem","nodeType","getAttribute","parentNode","domRoot","root","Inline","getContentElement","getDomElement","addEventListener","target","preventDefault","setRoot","setLayout","layout","Canvas","bottom","left","resize","bounds","getBounds","setLayoutProperties","Math","round","width","setMaxHeight","height","addListener","innerHeight","main","container","Composite","Dock","edge","menuBar","MenuBar","uploadButton","getButton","uploadManager","upload","UploadMgr","splitpane","Pane","rootFolder","fakeIconFile","getIconFile","overrideIcon","open","fakeChildren","icon","dark","Images","getIcon","tree","FileSystem","leftContainer","VBox","leftBar","ToolBar","reload","buttonConfig","getButtonConfiguration","args","flex","list","form","List","setAppearance","controller","setDelegate","createItem","FileTabItem","bindItem","index","bindDefaultProperties","bindProperty","Stack","startOpenFile","setCloseable","dialogConf","modal","minWidth","min","Viewport","getWidth","maxHeight","getHeight","concat","Version","VERSION","DATE","REV","LIBRARY_VERSION","BigAlert","_disposeObjects","application","util","DeferredCall","resetRoot","schedule","removeChild","Main","$$instance","marshal","MEventBubbling","parent","initChildren","setFakeChildren","endsWith","__P_41_0","setName","setParent","_onChangeLocale","_fakeIconFile","_acceptedFiles",".","media","test","getConfigName","hasChildren","fake","getHiddenConfigFile","displayName","getAcceptedFiles","loading","children","hash","editing","special","valid","hasWarnings","transform","mounted","trash","inTrash","__P_41_1","__P_41_2","_toLowerCase","toLowerCase","isFake","_applyName","getDisplayName","setDisplayName","getPath","getParentFolder","_onOpen","isLoaded","load","_maintainIcon","isOverrideIcon","setIcon","isTrash","isMounted","_applyHasChildren","unload","setLoaded","setLoading","removeAll","oldParent","_onGet","prototype","hasOwnProperty","nodeChildren","getFakeChildren","append","_onError","isLoading","getServerPath","LibraryManager","get","sort","a","b","localeCompare","openPath","parts","lang","Type","isArray","split","relPath","shift","setOpen","translate","_onFilesSystemMessage","getBackupFiles","files","pathparts","pop","join","suffix","fileRegex","RegExp","backupFile","date","Date","parseInt","substring","_onAction","focusedWidget","updateBarButtons","actionHandler","config","keys","setEnabled","general","hasHandler","_applyFocusedWidget","_getHandler","getMain","Widget","_setLayout","initMessages","_onMessage","_listController","getMessages","getChildControl","_initDelegate","msg","Message","title","_typeof","statusText","sticky","appearance","refine","messages","_onCloseMessage","exclude","_createChildControlImpl","_add","base","_restorePreferences","defaultConfigEditor","quickPreview","expertMode","startViewMode","_skipSaving","_savePreferences","store","Storage","getLocal","Serializer","toNativeObject","report","Record","record","STORAGE","setPreferences","preferences","noSave","__P_30_0","__P_30_1","registerFileHandler","viewer","Image","SUPPORTED_FILES","Config","Icons","Folder","Start","Source","Tree","Diff","_onChangesDefaultConfigEditor","selector","clazz","options","assign","isClass","instanceOf","selectorId","priority","isRegExp","regex","toString","isFunction","isString","fullPath","fileName","handlers","defaultHandler","key","noTemporaryFiles","noReadOnlyFiles","__P_30_2","hasFileHandler","setDefault","getDefaultConfigEditor","DEFAULT_FOR","getAllFileHandlers","map","removeListener","external","ready","TITLE","save","getCurrentContent","_initClient","_nativePasteSupported","queryCommandSupported","CLIPBOARD","_handledActions","_client","_applyHandlerOptions","_loadFile","_onChange","getContent","setContent","_loadFromFs","resetContent","XMLDocument","XMLSerializer","serializeToString","_applyContent","_handleSaveResponse","_onSaved","overrideHash","getHash","Function","curry","updateSync","resetTemporary","showErrors","errorList","showDecorations","decorators","openedFocusedFile","_applyFile","setHandlerId","permanent","closeable","__P_42_0","_maintainPermanent","handlerClass","getByName","ICON","removeBinding","resetIcon","original","setOriginalFile","setModifiedFile","originalFile","modifiedFile","getOriginalFile","getModifiedFile","_applyModifiedFile","isInTrash","__P_29_0","rename","newName","newPath","moveSync","src","resetEditing","move","restore","__P_29_1","targetFileName","targetFile","delete","__P_29_2","deleteSync","download","createElement","setAttribute","getBaseUrl","display","appendChild","click","validate","__P_29_3","d","alert","Worker","validateConfig","then","close","setValid","jumpToError","trn","_createWidgetContent","_textField","setLiveUpdate","menubar","_commandGroup","__P_24_0","__P_24_1","__P_24_2","_createChildControl","Spacer","editorGroup","RadioGroup","new-file","menu","enabled","new-folder","separator","new-config-file","com","zenesis","UploadMenuButton","save-as","hidden","quit","undo","redo","cut","paste","source-editor","RadioButton","xml-editor","quick-preview","CheckBox","expert-mode","help","about","maintainButtons","prefs","getModelSelection","setDefaultConfigEditor","__P_24_3","buttonName","preferenceName","merge","buttonConf","label","ButtonClass","Button","setValue","Error","Separator","onAfterCreate","basic","Label","Menu","uploadUrl","_init","LAST_ID","multiple","_updateUploadUrl","getFolder","url","setUploadUrl","evt","getFilename","setParam","isForce","progressListenerId","uploadedSize","debug","getSize","stateListenerId","getStatus","forceUpload","getResponse","Json","parse","e","removeListenerById","_getUniqueFileId","setForce","newFile","File","getBrowserObject","getId","size","uploadWidget","getUploadWidget","getUploadHandler","_addFile","getAutoUpload","beginUploads","uploadFile","bomFile","fileSize","setSize","setUploadWidget","UploadButton","replaceFile","replacedFile","setFolder","setDroppable","_applyStartDragListeners","_getLayout","Grow","__P_52_0","uploadMode","uploadHint","onHtml5Drop","getFiles","isAccepted","hasDroppableFile","i","l","dataTransfer","items","kind","getAsFile","__P_52_2","_boundOnStop","setUserBounds","top","_createMDragUploadChildControlImpl","setZIndex","setBackgroundColor","dropBox","Atom","getUploadHint","iconPosition","rich","center","setWrap","setAnonymous","_onStopDragging","setUploadMode","removeEventListener","_isDroppable","MDragUpload","_applyDragListeners","uploadable","_onDrop","lid","__P_52_1","hasChildControl","isVisible","setRootFolder","_onEnableTree","MIMETYPES","text/xml","application/xml","text/javascript","application/x-httpd-php","text/css","image/png","image/svg+xml","text/plain","getMimetypeFromSuffix","mime","mimetype","events","changeSelection","selectedNode","__P_49_0","__P_49_1","__P_49_2","_replacementManager","openPaths","getOpenNodes","_applyRootFolder","setModel","setHideRoot","_applySelectedNode","contextMenu","contextmenu","GlobalFileItem","configure","setContextMenu","_onDblTapTreeSelection","getSelectedNode","stop","fireDataEvent","setSelectedNode","Timer","once","resetContextMenu","resetSelectedNode","_onFsItemRightClick","VirtualFsItem","VirtualTree","selectionMode","showTopLevelOpenCloseIcons","bindPropertyReverse","toolbar","showOnly","__P_26_0","_menuBar","_menuButtonConfig","_uploadManager","__P_26_1","newButton","fileController","createPart","Part","marginLeft","MenuButton","_createButton","addWidget","deleteSelection","setToolTipText","checkConfig","fireEvent","doNotUseCommand","_applyFolder","resetFolder","__P_26_2","IModel","HBox","_onPointerOver","_onPointerOut","dereference","_forwardStates","focused","hovered","dragover","addState","_transformFilename","removeState","_applyPermanent","setFont","_applyCloseable","setVisibility","_applyModel","_applyIcon","setSource","_applyLabel","getLabel","labelValue","resetToolTipText","_onClose","_addAt","Alert","_hbox","_applyImage","_image","scale","addAt","_createDialogContainer","hbox","scroll","Scroll","Document","getRoot","image","getImage","_message","setRich","setWidth","setAllowStretchX","buttonPane","_createButtonPane","okButton","_createOkButton","_onAppear","timeout","_timer","_applyType","setDecorator","getAppearance","_applyTimeout","getTimeout","wrap","_scaleImage","AbstractViewer","getImageData","ResourceManager","aspectRatio","ImageLoader","setLabel","resetLabel","availableHeight","paddingY","paddingX","connectToWindow","_windowRef","_source","_reloading","_applyConnectToWindow","setExternal","configName","Uri","getAbsolute","hint","ref","isConnectToWindow","onbeforeunload","iframe","resetSource","_this","getDocument","location","href","openPage","contentWindow","otherEngine","TemplateEngine","pageId","getPageIdByPath","scrollToPage","setHighlightWidget","widgetId","setHighlightedWidget","_this2","embed","Iframe","font","focus","backgroundColor","IMultiSelection","IModelSelection","MMultiSelectionHandling","MRemoteChildrenHandling","MModelSelection","noToolbar","_isImageRegex","initModel","_newItem","_debouncedOnFilter","debounce","_onFilter","addItem","removeItem","permanentFilter","showTextFilter","labelConverter","disableScrolling","viewMode","_controller","SELECTION_MANAGER","selection","ScrollArea","_defaultLabelConverter","getViewMode","_getDelegate","getLabelConverter","FileListItem","configureItem","_onDblTap","setShowFileActions","getCurrentTarget","getSpecial","openAtPointer","getBubbles","stopPropagation","resetModel","getValue","getPermanentFilter","resetParent","_applyShowTextFilter","filterString","filterFunction","filtered","getChildrenContainer","_onAddChild","_onRemoveChild","_onFileEvent","_applyDisableScrolling","scrollContainer","TextField","placeholder","liveUpdate","margin","isShowTextFilter","Flow","isDisableScrolling","IconAtom","IconConfig","DB","entry","_configRegex","selectedItem","_ignoreSelectionChanges","_previewButton","_listButton","_radioGroup","_loadRoot","found","_onChangeSelection","setSelectedItem","_applySelectedItem","_onToggleExpand","getUserData","getVisibility","_onChangeViewMode","getStartViewMode","part","listButton","setUserData","toolTipText","previewButton","setStartViewMode","__P_25_0","folderWidget","specialFiles","unshift","fakeFolder","_basePath","origin","pathname","droppable","focusable","effectAllowed","dropEffect","FocusHandler","setUseTabNavigation","_initWorker","_currentDecorations","COUNTER","MONACO_EXTENSION_REGEX","languages","extensions","getLanguages","ext","sourcePath","loader","DynamicScriptLoader","require","paths","vs","vs/nls","availableLanguages","*","getLanguage","noCacheSuffix","random","schema","qxLib","__P_32_0","typescript","javascriptDefaults","addExtraLib","completionProvider","completion","Schema","cvCompletionProvider","CometVisu","registerCompletionItemProvider","getProvider","log","Logger","start","_editor","_workerWrapper","_configClient","_onDidChangeContentGuard","setEditor","_getDefaultModelOptions","tabSize","indentSize","insertSpaces","domElement","suggestOnTriggerCharacters","folding","autoIndent","automaticLayout","dragAndDrop","formatOnPaste","formatOnType","renderValidationDecorations","minimap","baseVersion","xhr","request","Xhr","toUri","method","accept","json","jsonDefaults","setDiagnosticsOptions","allowComments","schemas","uri","fileMatch","send","onDidChangeModelContent","_onContentChanged","trigger","getValueInRange","_paste","op","identifier","major","minor","range","text","forceMoveMarkers","executeEdits","isSupported","getConfigClient","JSON","stringify","section","isValid","getHasWarnings","__P_32_1","saveSync","status","newModel","xml","isXmlDocument","documentElement","outerHTML","createModel","_getLanguage","onDidChangeDecorations","errors","warnings","getModelMarkers","owner","getLanguageId","resource","marker","severity","MarkerSeverity","Warning","setHasWarnings","updateOptions","readOnly","_processHandlerOptions","upgradeVersion","_this$_upgradeConfig","_upgradeConfig","_this$_upgradeConfig2","_slicedToArray","_convertToString","ConfigUpgrader","upgrade","contentChanged","fileType","typeExt","markers","firstErrorLine","line","startLineNumber","endLineNumber","startColumn","endColumn","setModelMarkers","getScrollTop","revealLineInCenter","deltaDecorations","_schema","onLoaded","setReady","__P_33_0","__P_33_1","setPreviewState","structureChanges","hasChildrenModified","initUnDos","initReDos","__P_33_2","_onElementKeyUp","_maintainPreviewVisibility","Allowed","NONE","BEFORE","AFTER","INSIDE","FIRST_CHILD","expert","clipboard","unDos","reDos","autoRefreshPreview","previewState","showPreview","dragging","__P_33_3","__P_33_4","__P_33_5","isPreviewSynced","getPreviewState","setShowPreview","noPreview","_applyShowPreview","clearLayoutProperties","updateLayoutProperties","noStretch","previewConfig","_updatePreview","_onCut","_onCopy","_onPaste","_showHelp","getUnDos","getTitle","getReDos","isDeletable","addUndo","elementChange","ElementChange","clearUnDosReDos","clearReDos","_applyClipboard","navigator","writeText","getNode","resetPreviewState","_this3","isShowPreview","ok","noSync","notOk","_onEdit","toggleExpert","right","_onSearch","getKeyIdentifier","_showNextResult","_showPreviousResult","openMode","itemHeight","Environment","_initDragDrop","VirtualElementItem","_onContextMenuAction","_onContextMenu","setDraggable","setMarginLeft","getSelected","decoration","Decorator","widthTop","styleTop","colorTop","setHeight","setOpacity","ConfigElement","setSelected","setElement","added","resetSelected","openByQuerySelector","edit","_this4","Promise","resolve","reject","result","querySelector","__P_33_6","rootNode","from","querySelectorAll","el","tagName","hasAttribute","firstMatch","$$widget","openNodeAndParents","current","ancestors","parentElement","p","draggedXmlElement","dragTarget","getDragTarget","setDragging","isEditable","addAction","addType","addData","addButton","accepted","_this5","getCurrentAction","supportsType","addNew","indicator","isAncestor","layerContent","getPane","getLayers","getContentLocation","getDocumentTop","lastElem","elementFromPoint","getWidgetByElement","isAnonymous","getLayoutParent","parentSchemaElement","getSchemaElement","allowedElements","getAllowedElements","addable","getAddableChildren","areChildrenSortable","acc","allowedSorting","getAllowedElementsSorting","elementName","__P_33_7","isChildElementAllowed","_allowedSorting","getFirstLevelElementSorting","targetPosition","undefined","firstChildPosition","expandTimer","lastTreeItem","treeContainer","onDrag","position","cursor","getManager","getCursor","DragDropCursor","_native","pointerType","hasState","origElem","getDocumentLeft","orig","skipDetection","origCoords","leftPos","_getChildren","getPaddingLeft","lastCoords","setDomPosition","openNode","getAction","resetAction","console","assert","setAction","onDrop","clone","moveAfter","insertAfter","moveBefore","insertBefore","moveInside","insertChild","onDragEnd","resetUserData","resetDragging","_this6","sorting","minPosition","maxPosition","targetIndex","sibling","_targetIndex","_found","_i","_sibling","firstChild","ElementForm","allowCancel","formData","validation","required","promise","_document","ownerDocument","isElement","createComment","createTextNode","createCDATASection","schemaElement","getSchemaElementForElementName","requiredChildren","getRequiredElements","sortChildNodes","childName","isTextContentRequired","xmlElement","XmlElement","getEditor","isShowEditButton","targetName","depth","currentPosition","_depth","__P_33_8","_this7","provider","Provider","getLive","userInputAllowed","__P_33_9","attribute","docs","getDocumentation","def","getDefaultValue","isOptional","validator","ListItem","isValueValid","ValidationError","getTypeString","enums","getEnumeration","isNew","_this8","getShowEditButton","typeElement","Node","ELEMENT_NODE","allowed","getAllowedAttributes","getExpert","getAppinfo","parser","DOMParser","attrName","nodeName","lines","autoSize","innerHTML","parseFromString","getElementsByTagName","TEXT_NODE","COMMENT_NODE","CDATA_SECTION_NODE","getTextContent","isTextNode","convertTextNodeType","newNodeName","formDialog","maxWidth","setAttributes","execCommand","setClipboard","clipboardElement","getClipboard","resetClipboard","updateModified","previewIndex","$$removed","splice","setModified","addSeparator","addSpacer","_applySelected","_updateHighlightWidget","getWidgetPath","_this9","initialValidation","validateXmlConfig","__P_33_10","_file","hide","_this10","_document2","fromString","getElementNode","setEditable","getWriteable","setContentPaddingBottom","isAutoRefreshPreview","reset","_this11","previewFile","fast","_prettify","level","singleton","tabs","fill","textContent","trim","String","escape","output","attributes","childNodes","onlyOneTextChild","_i2","onSaved","_disposeArray","originalContent","modifiedContent","editable","_applyEditable","createDiffEditor","getEditable","getOriginalContent","getModifiedContent","originalModel","modifiedModel","getModifiedEditor","setOriginalContent","_err","upgradedContent","changes","setModifiedContent","changesText","yesButtonLabel","noButtonLabel","resetEditable","resetOriginalContent","resetModifiedContent","_model","__P_31_0","_onModelValueChange","sectionName","Section","optionKey","addOption","__P_31_1","_onDeleteSection","sectionListItem","optionKeys","getOptions","option","getKey","setEnableInlineFind","SectionListItem","_files","_worker","FileWorker","code","features","postMessage","topic","setHash","currentHash","terminate","noCompare","_noCompare","_dateFormat","format","DateFormat","getDateFormat","_timeFormat","getTimeFormat","active","_selectedNode","_renameDialog","isFolder","isBackup","visibility","compareMenu","backups","getTime","backupEntry","groupButton","_onCompareWith","openWithMenu","availableHandlers","_onOpenWith","setFilename","controlName","_noNew","sep","isActive","compareWith","_onRename","_onDownload","_onRestore","_onValidate","_onClone","VirtualTreeItem","_applyEditing","field","_applyTemporary","_applyStatus","getRelatedTarget","__P_51_0","_onKeypress","setDesktop","_maintainFileActions","setUploadHint","showFileActions","themeable","gap","inheritable","acceptUpload","_applyViewMode","handled","firstUp","__P_37_0","isShowFileActions","editorConf","viewerConf","openButton","editButton","sizeHint","getSizeHint","padding","setPadding","_maintainFileTypePosition","iconBounds","prop","zIndex","anonymous","textAlign","textColor","Tap","getNativeEvent","capture","releaseCapture","_handleIcon","getShow","_showChildControl","_excludeChildControl","SvgIcon","__P_34_0","_dataProvider","__P_34_1","getLastOpenedTag","tags","closingTags","tagPosition","lastIndexOf","tag","openedTag","contentSearch","currentAttribute","attrMatch","filteredElementSearch","isAttributeSearch","isContentSearch","findElements","maxDepth","currentDepth","inMeta","cache","isItemAvailable","itemName","maxOccurs","count","getElementString","indent","prefix","insertText","allowedAttributes","getOwnPropertyNames","attr","requiredElements","allowedContent","getAllowedContent","_text","_grouping","elemName","getAvailableElements","usedItems","availableItems","childElem","max","CompletionItemKind","Field","detail","documentation","getAvailableAttributes","usedChildTags","attrs","Property","triggerCharacters","provideCompletionItems","vmap","textUntilPosition","lineNumber","column","completeText","metaEndPos","textMeta","mappingNames","stylingNames","templates","templatesStart","rawTemplate","nameMatch","variables","vregex","lastOpenedTag","openedTags","openedAttributes","cleanedText","lastChild","lastElementChild","lastFound","searchedElement","getDesigns","sugg","suggestions","getTransforms","getPlugins","getIcons","getInfluxDBs","getInfluxDBFields","EnumMember","variableName","Variable","mappingName","stylingName","getNamedItem","getInfluxDBTags","getInfluxDBValues","getAddresses","getRrds","typeFilter","getMediaFiles","currentItem","Value","__filename","__P_43_0","__P_43_1","__P_43_2","_cacheXSD","__P_43_3","schemaFile","__P_43_4","__P_43_5","__P_43_6","_widgetNames","ajaxRequest","_parseXSD","getReferencedNode","refName","getTypeNode","typeNode","getTextNodeSchemaElement","tmpXML","getCommentNodeSchemaElement","getSchemaDOM","getWidgetNames","_disposeMap","TEMPLATES","getTemplates","filterText","insertTextRules","CompletionItemInsertTextRule","InsertAsSnippet","KeepWhitespace","Struct","Method","setTitle","setChanges","setChangeType","changeType","change","getElement","success","isDisposed","getChangeType","getChanges","moveTo","oldIndex","sortable","touch","__P_50_0","_applyDragging","menuButton","getMenu","_applySortable","_addWidgets","addClass","alignY","setShow","addLabel","_remove","buttons","_applyEditor","_maintainClipboardButtons","_applyElement","isChildAllowedAtPosition","Number","POSITIVE_INFINITY","__P_28_0","Form","labelColumnWidth","useBlocker","blockerOpacity","blockerColor","__P_36_0","__P_36_1","_rootListenerId","_applyFormData","firstWidget","inverse","_formController","removeAllBindings","_form","getValidationManager","_formContainer","modelData","_iterator","_createForOfIteratorHelper","_step","s","n","done","mappedKey","replaceAll","p1","toUpperCase","setQxObjectId","addOwnedQxObject","_onFormReady","atom","_iterator2","_step2","_loop","fieldData","formElement","addGroupHeader","TextArea","setMinimalLineHeight","setAutoSize","setMinHeight","maxLength","setMaxLength","SourceCodeField","language","DateField","dateFormat","setDateFormat","PasswordField","ComboBox","parseComboOptions","listItem","groupName","groupItem","setPlaceholder","VirtualComboBox","iconPath","labelPath","Option","getHints","parseVComboOptions","hints","groupModel","setType","SelectBox","VirtualSelectBox","iconOptions","orientation","radioButton","setTriState","Spinner","setMinimum","setMaximum","step","setSingleStep","fractionsDigits","fd","nf","NumberFormat","setMinimumFractionDigits","setMaximumFractionDigits","setNumberFormat","addTarget","selectables","getSelectables","selectable","setRequired","Validate","charAt","regExp","errorMessage","AsyncValidator","proxy","eval","invalidMessage","validationFunc","validatorObj","__P_36_2","isObject","func","view","ElementFormRenderer","getLayout","setColumnFlex","setColumnMaxWidth","getLabelColumnWidth","spacingX","setAllowGrowX","_handleOk","getCallback","getContext","resetCallback","setNode","setSchema","_bounds","_allowedElements","_sortedContent","_subGroupings","elementsHaveOrder","subGroupings","_regexCache","isElementAllowed","_Object$entries","entries","_Object$entries$_i","grouping","subRequiredElements","myAllowedElements","_i3","_Object$entries2","_Object$entries2$_i","sortNumber","getRegex","nocapture","hasMultiLevelBounds","getBoundsForElementName","regexFromString","input","modifiers","Base","__P_47_0","__P_47_1","__P_47_2","__P_47_3","__P_47_4","xpath","texts","doc","nsResolver","createNSResolver","iterator","evaluate","XPathResult","UNORDERED_NODE_ITERATOR_TYPE","thisNode","iterateNext","appInfo","_toConsumableArray","_type","getSchema","_documentation","_documentation2","createDocumentationWebLinks","contents","reference","DocumentationMapping","MAP","_base","MAnnotation","getElementName","aSortvalue","bSortvalue","aSortvaluesList","bSortvaluesList","defaultValue","mixed","__P_46_0","__P_46_1","__P_46_2","__P_46_3","setDefaultValue","setMixed","SimpleType","tmpDOMGrouping","Choice","Sequence","Any","sub","subElement","aGroup","attributeGroup","Attribute","getElementsHaveOrder","excludeComment","textOnly","isMixed","getChildBounds","isTextContentAllowed","regexString","boundsMin","boundsMax","getChildrenRegex","_node","initName","setSchemaElement","_maintainStatus","_initialAttributes","Map","deletable","showEditButton","_schemaElement","_initialChildNames","_initialTextContent","__P_44_0","__P_44_1","setStatus","_applyValid","resetInvalidMessage","newType","getText","oldNode","newTextNode","replaceChild","IconHandler","getIconSource","_updateShowEditButton","updateDeletable","setShowEditButton","existing","setDeletable","_existing","skipUndo","_move","targetParent","targetChildren","newParent","newIndex","stillAllowed","countExisting","childBounds","textNodes","otherNodes","previousSibling","findPositionForChild","newChild","internalOperation","previousChild","before","$$added","_validateTextContent","recursive","nodeValue","setInvalidMessage","_applyTextContent","_updateDisplayName","setText","changed","newValue","oldValue","setTextContent","removeAttribute","_oldValue","_changed","isRequired","parentChanges","newNode","_oldValue2","parentChange","_applySchemaElement","_applyModified","hasChildNodes","childNode","_syncChildNodes","childSchemaElement","_child","setSortable","_child2","_child3","getInvalidMessage","appendInvalidMessage","_updateChildrenDeletableFlags","errorMsg","initial","currentChildNames","_currentChildNames","_step$value","names","widgets","ids","c","cloneNode","__P_35_0","getDataProviderClient","address","#text","grouped","rrd","influx","measurement","live","plugin","pages","design","ga","_id$split","_id$split2","conf","_len","arguments","_key","_getFromCache","cacheId","__P_35_1","_addToCache","__P_35_2","designName","rpc","rpcContext","converterContext","cached","handleResponse","__P_35_3","getClient","authorize","client","hasProvider","getProviderUrl","getProviderConvertFunction","_parseDpResponseForEditor","_parseDpResponseForMonaco","__P_35_4","withMeasurement","auth","__P_35_5","x","__P_35_6","fsClient","useCache","transforms","Transform","registry","suggestion","lname","plugins","qxParts","PartLoader","getParts","partName","pluginName","icons","iconHandler","iconName","_content","_errors","highlight","colorizeElement","vbox","prologue","labelOptions","allowGrowX","errorBox","errorScroll","decorator","errorLabels","errorId","has","codeSnippet","startIndex","endIndex","minIndent","search","trimRight","headline","closeButton","proceedButton","openSourceButton","initOptions","grid","Grid","setColumnAlign","_originalName","_originalOptions","nameField","__P_39_0","__P_39_1","emptyOption","_onDeleteOption","resetKey","resetValue","removed","_onAddOption","row","setNullValueTitle","setAllowNull","OptionListItem","__P_53_0","__P_53_1","setAttributeNS","_createContentElement","svgElem","svg","__P_27_0","forceRatio","allowScaleUp","allowShrinkX","allowShrinkY","allowGrowY","loadingFailed","aborted","PLACEHOLDER_IMAGE","__P_27_1","__P_27_2","__P_27_3","__P_27_4","__P_27_5","__P_27_6","_onChangeTheme","_styleSource","__P_27_7","_getContentHint","_applyDecorator","getSource","AliasManager","getChild","__P_27_8","_applyTextColor","__P_27_9","setStyle","Color","removeStyle","_applyPadding","setStyles","getPaddingTop","renderLayout","getPaddingRight","getPaddingBottom","_applyEnabled","_applySource","abort","_applyScale","__P_27_10","isPng","getScale","__P_27_11","html","connectWidget","overflowX","overflowY","boxSizing","setScale","wrapper","$$disposed","__P_27_13","repeat","tagNameHint","Decoration","getTagName","contentEl","__P_27_14","isFontUri","__P_27_15","color","getTextColor","highResolutionSource","findHighResolutionSource","imageWidth","getImageWidth","imageHeight","getImageHeight","backgroundSize","__P_27_16","__P_27_17","__P_27_18","__P_27_12","AnimationFrame","rId","select","mshtml","alphaImageLoader","isFont","isSvg","__P_27_19","default","elementToAdd","currentContentElement","styles","currentStyles","getAllStyles","backgroundImage","insets","getInsets","getStyle","newEl","setSelectable","getSelectable","isIncluded","removeAt","getNodeName","currentEl","flush","currentDomEl","newDomEl","getListeners","listenerData","self","$$hash","getEnabled","disabled","Font","__P_27_20","_applyDimension","isFailed","__P_27_21","useMarkup","sparts","fontSource","fontStyles","getStyles","fromCharCode","charCode","getDecorator","hasGradient","getStartColor","getEndColor","hasBackground","getBackgroundImage","getAttributes","decoratorStyle","combinedStyles","backgroundPosition","backgroundRepeat","getBackgroundRepeat","imageInfo","failed","_recalc","queue","Layout","originalWidth","originalHeight","getMaxWidth","getMaxHeight","getMinWidth","minHeight","getMinHeight","ratio","getForceRatio","isAllowScaleUp","disconnectWidget","IStringForm","IForm","MForm","changeValue","__P_40_0","__P_40_1","_hasBeenEdited","_autoSize","isAutoSize","contentHeight","getLineCount","_setAreaHeight","_onContentChange","getFocusElement","setHints","setCenter","_onExecute","isTriState","toggleValue","_applyValue","FormRenderer","addItems","_createHeader","_row","colSpan","_createHBoxForRadioGroup","_createWidgetForRadioGroup","_createLabel","audio","break","colorchooser","designtoggle","diagram","flavour","gauge","imagetrigger","infoaction","infotrigger","install-no-pakets","mapping","multitrigger","pagejump","powerspectrum","pushbutton","rgb","slide","speech","strftime","styling","switch","system-voraussetzungen","toggle","urltrigger","video","visu-config-details","web","__P_48_0","__P_48_1","__P_48_2","__P_48_3","optional","baseType","setOptional","__P_48_4","setBaseType","subnode","subNode","_subnode","patternNode","enumerationNode","getBaseType","boolValid","branchIndices","isRootBranch","j","branches","elementRegexes","_Object$values","values","sortnumber","namesWithSorting","mySortnumber","subSortedElements","subObject","elementBounds","sequenceBounds","resultBounds","isNaN","tmpBounds","mySortNumber","getAttributeName","description","__P_45_0","__P_45_1","setKey","_applyChange","keyField","valueField","keyTitleField","valueTitleField","__P_38_0","Icon"],"mappings":"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","sourcesContent":["/**\n * All Widgets that need to handle actions from the managers action event, need to implement this interface.\n */\nqx.Interface.define('cv.ui.manager.IActionHandler', {\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * Checks if the action handle can process the action.\n     * @param actionName {String} action name\n     */\n    canHandleAction: function(actionName) {},\n\n    /**\n     * Executes the action handling.\n     * @param actionName {String} action name\n     * @param data {var} action payload\n     */\n    handleAction: function (actionName, data) {},\n\n    /**\n     * The ActionHandler can configure the menubutton itself, e.g. disable it, when that action is currently not possible\n     * or change the button text / tooltip text etc.\n     * @param actionId {String} ID of the action that button triggers\n     * @param button {Widget} the button that should be configured\n     */\n    configureButton: function (actionId, button) {},\n\n    /**\n     * Undo all changes that have been applied to the button in configureButton\n     * @param actionId {String} ID of the action that button triggers\n     * @param button {Widget}\n     */\n    unConfigureButton: function (actionId, button) {}\n  }\n});\n","/**\n * Mixin for all classes that have to handle event on the 'cv.manager.file' topic.\n * Those classes need to implement the cv.ui.manager.control.IFileEventHandler interface.\n */\nqx.Mixin.define('cv.ui.manager.control.MFileEventHandler', {\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    if (qx.core.Environment.get('qx.debug')) {\n      qx.core.Assert.assertInterface(this, cv.ui.manager.control.IFileEventHandler);\n    }\n    if (!this._disableFileEvents) {\n      qx.event.message.Bus.subscribe('cv.manager.file', this._handleFileEvent, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _disableFileEvents: false\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.file', this._handleFileEvent, this);\n  }\n});\n","/**\n *\n */\nqx.Interface.define('cv.ui.manager.control.IFileEventHandler', {\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _handleFileEvent: function (ev) {}\n  }\n});\n","/**\n * Main class of the CometVisu file manager.\n * @author Tobias Brutigam\n * @since 0.12.0\n *\n * @asset(manager/*)\n */\nqx.Class.define('cv.ui.manager.Main', {\n  extend: qx.core.Object,\n  type: 'singleton',\n  include: [\n    cv.ui.manager.control.MFileEventHandler\n  ],\n  implement: [cv.ui.manager.IActionHandler, cv.ui.manager.control.IFileEventHandler],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    iconfont.material.Load;\n    cv.ui.manager.model.BackupFolder.getInstance();\n    this._checkEnvironment();\n    this.initOpenFiles(new qx.data.Array());\n    this.__actionDispatcher = cv.ui.manager.control.ActionDispatcher.getInstance();\n    this.__actionDispatcher.setMain(this);\n\n    this.__initCommands();\n    this._draw();\n\n    qx.event.message.Bus.subscribe('cv.manager.*', this._onManagerEvent, this);\n\n    // Initialize tooltip manager\n    qx.ui.tooltip.Manager.getInstance();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    ROOT: null\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    openFiles: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    /**\n     * Current selected folder (if a file is selected its parent folder) is writeable.\n     */\n    writeableFolder: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeWriteableFolder'\n    },\n\n    currentFolder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyCurrentFolder',\n      event: 'changeCurrentFolder'\n    },\n\n    currentSelection: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyCurrentSelection',\n      event: 'changeCurrentSelection'\n    },\n\n    deleteableSelection: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDeleteableSelection'\n    },\n\n    renameableSelection: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeRenameableSelection'\n    },\n\n    visible: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeVisible',\n      apply: '_applyVisible'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __previewFileIndex: null,\n    __root: null,\n    _pane: null,\n    _tree: null,\n    _stack: null,\n    _oldCommandGroup: null,\n    _managerCommands: null,\n    _mainContent: null,\n    _openFilesController: null,\n    _hiddenConfigFakeFile: null,\n    __actionDispatcher: null,\n\n    _applyVisible: function (value) {\n      const manager = qx.core.Init.getApplication().getCommandManager();\n      if (value) {\n        manager.setActive(this._managerCommands);\n        qx.bom.element.Style.set(this.__getRoot(), 'display', 'block');\n      } else {\n        manager.setActive(this._oldCommandGroup);\n        qx.bom.element.Style.set(this.__getRoot(), 'display', 'none');\n      }\n    },\n\n    _checkEnvironment: function () {\n      cv.io.rest.Client.getFsClient().checkEnvironmentSync(function (err, res) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else if (res) {\n          res.forEach(function (env) {\n            let refreshActions = false;\n            switch (env.entity) {\n              case '.':\n                // config folder must be writeable\n                if ((env.state & 1) === 0) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder does not exists'));\n                } else if ((env.state & 2) === 0) {\n                  cv.ui.manager.model.FileItem.ROOT.setReadable(false);\n                  refreshActions = true;\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder is not readable'));\n                } else if ((env.state & 4) === 0) {\n                  cv.ui.manager.model.FileItem.ROOT.setWriteable(false);\n                  refreshActions = true;\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('config folder is not writeable'));\n                }\n                if (refreshActions) {\n                  const widget = this.__actionDispatcher.getFocusedWidget();\n                  this.__actionDispatcher.resetFocusedWidget();\n                  this.__actionDispatcher.setFocusedWidget(widget);\n                }\n                break;\n\n              case 'backup':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('backup folder is not writeable'));\n                }\n                break;\n\n              case 'media':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('media folder is not writeable'));\n                }\n                break;\n\n              case 'hidden.php':\n                if ((env.state & 4) === 0 && (env.state & 1) === 1) {\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Hidden configuration file (hidden.php) not writeable'));\n                }\n                break;\n            }\n          }, this);\n        }\n      }, this);\n    },\n\n    canHandleAction: function (actionName) {\n      if (actionName === 'delete' && this.getCurrentSelection() && !this.getCurrentSelection().isWriteable()) {\n        // needs a writeable file\n        return false;\n      }\n      let actions = ['close', 'quit', 'about'];\n      const currentFolder = this.getCurrentFolder();\n      if (currentFolder.isWriteable()) {\n        actions.push('new-file');\n        actions.push('new-folder');\n        actions.push('delete');\n        actions.push('upload');\n        actions.push('clone');\n      }\n      if (cv.ui.manager.model.FileItem.ROOT.isWriteable()) {\n        actions.push('new-config-file');\n      }\n      return actions.includes(actionName);\n    },\n\n    handleAction: function (actionName, data) {\n      switch (actionName) {\n        case 'close':\n          if (!data) {\n            this.closeCurrentFile();\n          } else {\n            this.closeFile(data);\n          }\n          break;\n\n        case 'quit':\n          this.setVisible(false);\n          break;\n\n        case 'new-file':\n          this._onCreate('file', null, data);\n          break;\n\n        case 'new-config-file':\n          cv.io.rest.Client.getFsClient().readSync({path: '.templates/visu_config.xml'}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Cannot load config template'));\n            } else {\n              this._onCreate('config', res, cv.ui.manager.model.FileItem.ROOT);\n            }\n          }, this);\n          break;\n\n        case 'clone':\n          cv.io.rest.Client.getFsClient().readSync({path: data.file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Cannot load file content'));\n            } else if (data.file.isConfigFile()) {\n                // config files need to be cloned in the root folder\n                this._onCreate('config', res, cv.ui.manager.model.FileItem.ROOT);\n              } else {\n                this._onCreate('file', res);\n              }\n          }, this);\n          break;\n\n        case 'new-folder':\n          this._onCreate('dir', null, data);\n          break;\n\n        case 'delete':\n          this._onDelete(data);\n          break;\n\n        case 'upload':\n          // nothing to to, this is handled in another way\n          break;\n\n        case 'about':\n          this._showAbout();\n          break;\n\n        default:\n          this.warn(actionName + ' handling is not implemented yet!');\n          break;\n      }\n    },\n\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _handleFileEvent: function (ev) {\n      const data = ev.getData();\n      if (data.action === 'deleted') {\n        // check if file is currently opened and close it\n        const openFiles = this.getOpenFiles().copy();\n        openFiles.some(function (openFile) {\n          if (openFile.getFile().isRelated(data.path)) {\n            this.closeFile(openFile);\n          }\n          return false;\n        }, this);\n        if (this.getCurrentFolder() && this.getCurrentFolder().getFullPath() === data.path) {\n          this.resetCurrentFolder();\n        }\n      } else {\n        this.warn('unhandled file event', data.action);\n      }\n      this._tree.refresh();\n    },\n\n    __findConfigFile: function (name) {\n      let file = null;\n      let demoFolder = null;\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(child => {\n        if (child.getName() === 'demo') {\n          demoFolder = child;\n        } else if (child.getName() === name) {\n          file = child;\n          return true;\n        }\n        return false;\n      });\n      if (!file && demoFolder) {\n        if (name.startsWith('demo/')) {\n          name = name.substr(5);\n        }\n        // check demo configs\n        demoFolder.getChildren().some(child => {\n          if (child.getName() === name) {\n            file = child;\n            return true;\n          }\n          return false;\n        });\n      }\n      return file;\n    },\n\n    _onManagerEvent: function (ev) {\n      let data = ev.getData();\n      switch (ev.getName()) {\n        case 'cv.manager.compareFiles':\n          this.openFile(data, false);\n          break;\n\n        case 'cv.manager.openWith':\n          if (typeof data.file === 'string') {\n            // this can only by a file in the root dir (a config)\n            data.file = this.__findConfigFile(data.file);\n          }\n          this.openFile(data.file || this.getCurrentSelection(), false, data.handler, null, data.handlerOptions);\n          break;\n\n        case 'cv.manager.open':\n          if (typeof data === 'string') {\n            // this can only by a file in the root dir (a config)\n            data = this.__findConfigFile(data);\n          }\n          this.openFile(data || this.getCurrentSelection(), false);\n          break;\n      }\n    },\n\n    /**\n     * open selected file in preview mode\n     * @param ev\n     * @private\n     */\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if ((cv.ui.manager.model.Preferences.getInstance().isQuickPreview() && data.mode === 'tap') || data.mode === 'dbltap') {\n        this.__openSelectedFile(data.node, data.mode);\n      }\n      const node = data.node;\n      if (node) {\n        if (data.node.getType() === 'file') {\n          this.setCurrentFolder(data.node.getParent());\n        } else {\n          this.setCurrentFolder(node);\n        }\n        this.setCurrentSelection(node);\n      } else {\n        this.resetCurrentFolder();\n        this.resetCurrentSelection();\n      }\n    },\n\n    __openSelectedFile: function (node, mode) {\n      if (node) {\n        if (node.getType() === 'file') {\n          this.openFile(node, mode === 'tap');\n        } else if (mode === 'dbltap') {\n          // edit folder name on dbltap\n          node.setEditing(true);\n        }\n      }\n    },\n\n    _applyCurrentFolder: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('writeable', this, 'writeableFolder');\n      } else {\n        this.resetWriteableFolder();\n      }\n    },\n\n    _applyCurrentSelection: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('writeable', this, 'deleteableSelection');\n        value.bind('inTrash', this, 'renameableSelection', {\n          converter: function (value) {\n            return !value;\n          }\n        });\n      } else {\n        this.resetDeleteableSelection();\n      }\n    },\n\n    _onChangeFileSelection: function () {\n      const sel = this._openFilesController.getSelection();\n      if (sel.length > 0) {\n        const openFile = sel.getItem(0);\n        const file = openFile.getFile();\n        let editorConfig;\n        const handlerId = openFile.getHandlerId();\n        if (handlerId) {\n          editorConfig = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n        } else {\n          editorConfig = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n        }\n        if (!editorConfig.instance) {\n          editorConfig.instance = new editorConfig.Clazz();\n        }\n        if (!editorConfig.instance.isReady()) {\n          editorConfig.instance.addListenerOnce('changeReady', () => {\n            editorConfig.instance.setFile(file);\n          }, this);\n        } else {\n          editorConfig.instance.setFile(file);\n        }\n        if (this._stack.indexOf(editorConfig.instance) < 0) {\n          this._stack.add(editorConfig.instance);\n        }\n        if (editorConfig.instance instanceof cv.ui.manager.editor.AbstractEditor) {\n          editorConfig.instance.setHandlerOptions(openFile.getHandlerOptions());\n        }\n        this._stack.setSelection([editorConfig.instance]);\n        this.__actionDispatcher.setFocusedWidget(editorConfig.instance);\n\n        cv.ui.manager.core.GlobalState.getInstance().setOpenedFocusedFile(file);\n      } else {\n        cv.ui.manager.core.GlobalState.getInstance().resetOpenedFocusedFile();\n      }\n    },\n\n    /**\n     * @param file {cv.ui.manager.model.FileItem} the file to open\n     * @param preview {Boolean} open the file in preview mode\n     * @param handlerId {String} use this handler to open the file (classname as string)\n     * @param handlerType {String} use a special handler type, e.g. 'edit' if you want to open the file with an editor and not a viewer\n     * @param handlerOptions\n     */\n    openFile: function (file, preview, handlerId, handlerType, handlerOptions) {\n      const openFiles = this.getOpenFiles();\n      let openFile;\n      let handlerConf;\n      if (!handlerId) {\n        handlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, handlerType);\n\n        if (!handlerConf) {\n          // no handler\n          cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('Cannot open file: \"%1\"', file.getName()));\n          return;\n        } \n          handlerId = handlerConf.Clazz.classname;\n      } else {\n        // check if this handler opens the file in a external frame that is not connected to the manager\n        handlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandlerById(handlerId);\n        if (!handlerConf.instance) {\n          handlerConf.instance = new handlerConf.Clazz();\n        }\n        if (handlerConf.instance.isExternal()) {\n          handlerConf.instance.setFile(file);\n          return;\n        }\n      }\n      const isOpen = openFiles.some(function (of) {\n        if (of.getFile() === file && handlerId === of.getHandlerId()) {\n          openFile = of;\n          return true;\n        }\n        return false;\n      });\n      if (!openFile) {\n        openFile = new cv.ui.manager.model.OpenFile(file, handlerId);\n      }\n      if (handlerOptions) {\n        openFile.setHandlerOptions(handlerOptions);\n      } else {\n        openFile.resetHandlerOptions();\n      }\n      if (preview === true) {\n        if (!openFile.isPermanent()) {\n          if (this.__previewFileIndex !== null && openFiles.getItem(this.__previewFileIndex) && !openFiles.getItem(this.__previewFileIndex).isPermanent()) {\n            openFiles.setItem(this.__previewFileIndex, openFile);\n          } else {\n            this.__previewFileIndex = openFiles.length;\n            openFiles.push(openFile);\n          }\n          // do not 'downgrade' the permanent state\n          openFile.setPermanent(false);\n        }\n      } else {\n        if (!isOpen && (this.__previewFileIndex === null || openFiles.indexOf(openFile) !== this.__previewFileIndex)) {\n          openFiles.push(openFile);\n        }\n        openFile.setPermanent(true);\n        this.__previewFileIndex = null;\n      }\n      this._openFilesController.getTarget().setModelSelection([openFile]);\n    },\n\n    closeFile: function (openFile, force) {\n      if (openFile instanceof cv.ui.manager.model.FileItem) {\n        // find the opened file\n        const found = this.getOpenFiles().some(function (f) {\n          if (f.getFile().getFullPath() === openFile.getFullPath()) {\n            openFile = f;\n            return true;\n          }\n          return false;\n        });\n        if (!found) {\n          return;\n        }\n      }\n      if (!openFile || !openFile.isCloseable()) {\n        return;\n      }\n      const file = openFile.getFile();\n\n      // check if this file is modified\n      if (file.isModified() && !force) {\n        // check if temporary\n        let message = qx.locale.Manager.tr('This file has unsaved changes that will be lost when you close it. Do you really want to close the file?');\n        if (file.isTemporary()) {\n          message = qx.locale.Manager.tr('This file has not been saved on the backend yet. It will be lost when you close it. Do you really want to close the file?');\n        }\n        qxl.dialog.Dialog.confirm(message, function (confirmed) {\n          if (confirmed) {\n            file.resetModified();\n            this.closeFile(openFile, true);\n            if (file.isTemporary()) {\n              qx.event.message.Bus.dispatchByName('cv.manager.file', {\n                action: 'deleted',\n                path: file.getFullPath()\n              });\n            }\n          }\n        }, this, qx.locale.Manager.tr('Unsaved changes'));\n        return;\n      }\n      if (openFile instanceof cv.ui.manager.model.OpenFile) {\n        openFile.resetPermanent();\n      }\n      const currentSelection = this._openFilesController.getSelection();\n      let selectionIndex = -1;\n      const openFiles = this.getOpenFiles();\n      if (currentSelection.length > 0 && currentSelection.getItem(0) === openFile) {\n        // we need to select another file after this one got closed\n        selectionIndex = openFiles.indexOf(openFile);\n      }\n      openFiles.remove(openFile);\n      const currentHandler = this._stack.getSelection()[0];\n      if (qx.Class.hasInterface(currentHandler.constructor, cv.ui.manager.editor.IEditor)) {\n        // reset the handlers file\n        currentHandler.resetFile();\n      }\n      if (this.getOpenFiles().length === 0) {\n        this._stack.resetSelection();\n        this.__actionDispatcher.resetFocusedWidget();\n        this.__previewFileIndex = null;\n      }\n      if (selectionIndex > 0) {\n        this._openFilesController.getSelection().replace(openFiles.getItem(selectionIndex - 1));\n      } else if (selectionIndex === 0 && openFiles.length > 0) {\n        this._openFilesController.getSelection().replace(openFiles.getItem(0));\n      }\n\n      if (file instanceof cv.ui.manager.model.CompareFiles) {\n        const fileHandlerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n        fileHandlerConf.instance.clear();\n        if (openFiles.filter(function (openFile) {\n          return openFile.getFile() instanceof cv.ui.manager.model.CompareFiles;\n        }).length === 0) {\n          fileHandlerConf.instance.destroy();\n          fileHandlerConf.instance = null;\n        }\n      } else if (window.monaco && openFile.getHandlerId() === 'cv.ui.manager.editor.Source') {\n        // close textmodel in monaco editor if exists\n        const oldModel = window.monaco.editor.getModel(file.getUri());\n        if (oldModel) {\n          oldModel.dispose();\n        }\n      }\n    },\n\n    closeCurrentFile: function () {\n      const selected = this._openFilesController.getSelection().length > 0 ? this._openFilesController.getSelection().getItem(0) : null;\n      if (selected) {\n        this.closeFile(selected);\n      }\n    },\n\n    _onCloseFile: function (ev) {\n      this.closeFile(ev.getData());\n    },\n\n    __getRoot: function () {\n      if (!this.__root) {\n        this.__root = qx.dom.Element.create('div', {\n          id: 'manager',\n          style: 'position: absolute; top: 0; left: 0; right: 0; bottom: 0;'\n        });\n        qx.dom.Element.insertEnd(this.__root, document.body);\n        qx.theme.manager.Meta.getInstance().setTheme(cv.theme.Dark);\n      }\n      return this.__root;\n    },\n\n    __initCommands: function () {\n      const group = this._managerCommands = new qx.ui.command.Group();\n      group.add('save', new qx.ui.command.Command('Ctrl+S'));\n      group.add('save-as', new qx.ui.command.Command('Ctrl+Shift+S'));\n      // this command will close the browser window, thats not what we want\n      // group.add('close', new qx.ui.command.Command('Ctrl+W'));\n      group.add('new-file', new qx.ui.command.Command('Ctrl+N'));\n      group.add('new-folder', new qx.ui.command.Command('Ctrl+Shift+N'));\n      group.add('quit', new qx.ui.command.Command('Ctrl+Q'));\n      // group.add('delete', new qx.ui.command.Command('Ctrl+Del'));\n\n      const renameCommand = new qx.ui.command.Command('F2');\n      group.add('rename', renameCommand);\n      this.bind('renameableSelection', renameCommand, 'enabled');\n\n      group.add('undo', new qx.ui.command.Command('Ctrl+Z'));\n      group.add('redo', new qx.ui.command.Command('Ctrl+Y'));\n\n      // edit commands (adding cut/copy/paste command will deactivate the native browser functions)\n      // and as we cannot simulate pasting from clipboard, we do not use them here\n      group.add('cut', new qx.ui.command.Command('Ctrl+X'));\n      group.add('copy', new qx.ui.command.Command('Ctrl+C'));\n      group.add('paste', new qx.ui.command.Command('Ctrl+V'));\n\n      group.add('help', new qx.ui.command.Command('F1'));\n\n      const manager = qx.core.Init.getApplication().getCommandManager();\n      this._oldCommandGroup = manager.getActive();\n      manager.add(group);\n      manager.setActive(group);\n    },\n\n    _onDelete: function (file) {\n      const item = file || this.getCurrentSelection();\n      if (item) {\n        cv.ui.manager.control.FileController.getInstance().delete(item);\n      }\n    },\n\n    _onChangeStackSelection: function (ev) {\n      const selection = ev.getData();\n      const openFiles = [];\n      // sync tab selection with currently visible page\n      selection.forEach(function(page) {\n        const openFile = this.getOpenFiles().toArray().find(function (openFile) {\n          return openFile.getFile() === page.getFile() && openFile.getHandlerId() === page.classname;\n        });\n        if (openFile) {\n          openFiles.push(openFile);\n        }\n      }, this);\n\n      this._openFilesController.getSelection().replace(openFiles);\n    },\n\n    __getFileNamePrompt: function (message, callback, context, value, caption) {\n      const prompt = new cv.ui.manager.dialog.Prompt({\n        message: message,\n        callback: callback || null,\n        context: context || null,\n        value: value || null,\n        caption: caption || '',\n        filter: /[\\w\\d_\\-\\.\\s]/\n      });\n      prompt.show();\n      return prompt;\n    },\n\n    _onCreate: function (type, content, folder) {\n      const currentFolder = folder || this.getCurrentFolder();\n      if (!currentFolder) {\n        return;\n      }\n      let message;\n      let existsMessage;\n      if (type === 'config') {\n        message = qx.locale.Manager.tr('Please enter the name of the new configuration (without \"visu_config_\" at the beginning and \".xml\" at the end)');\n        existsMessage = qx.locale.Manager.tr('A configuration with this name already exists.');\n      } else if (type === 'file') {\n        message = qx.locale.Manager.tr('Please enter the file name.');\n        existsMessage = qx.locale.Manager.tr('A file with this name already exists.');\n      } else {\n        message = qx.locale.Manager.tr('Please enter the folder name.');\n        existsMessage = qx.locale.Manager.tr('A folder with this name already exists.');\n      }\n      const handlePrompt = function (name) {\n        if (!name) {\n          // canceled\n          return;\n        }\n        let filename = name;\n        // add visu_config_..-xml\n        if (type === 'config') {\n          const match = /visu[_-]config[_-]([\\w\\d_-]+)(\\.xml)?/.exec(name);\n          if (match) {\n            name = match[1];\n          }\n          filename = 'visu_config_' + name + '.xml';\n        }\n        // check if name does not exist\n        const exists = currentFolder.getChildren().some(function (child) {\n          return (child.getName() === filename && child.getType() === type);\n        }, this);\n\n        if (exists) {\n          cv.ui.manager.snackbar.Controller.error(existsMessage);\n          this.__getFileNamePrompt(message, handlePrompt, this, name);\n        } else {\n          const item = new cv.ui.manager.model.FileItem(filename, currentFolder.getFullPath(), currentFolder);\n          item.set({\n            type: type === 'config' ? 'file' : type,\n            readable: true,\n            writeable: true,\n            loaded: true,\n            modified: true,\n            temporary: true,\n            parentFolder: currentFolder.getFullPath(),\n            content: content || ''\n          });\n          if (type === 'dir') {\n            // create directory directly\n            cv.io.rest.Client.getFsClient().createSync({\n              path: item.getFullPath(),\n              type: type\n            }, null, function (err) {\n              if (err) {\n                cv.ui.manager.snackbar.Controller.error(err);\n              } else {\n                cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('Folder has been created'));\n                item.set({\n                  modified: false,\n                  temporary: false\n                });\n                qx.event.message.Bus.dispatchByName(item.getBusTopic(), {\n                  type: 'created',\n                  file: item,\n                  data: '',\n                  source: this\n                });\n              }\n            }, this);\n          }\n          currentFolder.addChild(item);\n          currentFolder.sortElements();\n          this._tree.refresh();\n          this._tree.setSelection(item);\n          // do not open new folders\n          if (type !== 'dir') {\n            // open the file in an editor\n            this.openFile(item, false, null, 'edit');\n          }\n        }\n      };\n\n      this.__getFileNamePrompt(message, handlePrompt, this);\n    },\n\n    /**\n     * Finds next droppable parent of the given element. Maybe the element itself as well.\n     *\n     * Looks for the attribute <code>qxDroppable</code> with the value <code>on</code>.\n     *\n     * @param elem {Element} The element to query\n     * @return {Element} The next parent element which is droppable. May also be <code>null</code>\n     */\n    __findDroppable : function (elem) {\n      while (elem && elem.nodeType === 1) {\n        if (elem.getAttribute('qxDroppable') === 'on') {\n          return elem;\n        }\n\n        elem = elem.parentNode;\n      }\n\n      return null;\n    },\n\n    // overridden\n    _draw: function () {\n      const domRoot = this.__getRoot();\n      const root = new qx.ui.root.Inline(domRoot, true, true);\n      this.bind('visible', root, 'visibility', {\n        converter: function (visible) {\n          return visible ? 'visible' : 'excluded';\n        }\n      });\n      root.addListenerOnce('appear', function () {\n        // disable file drop\n        const element = root.getContentElement().getDomElement();\n        element.addEventListener('drop', function (ev) {\n          const target = this.__findDroppable(ev.target);\n          if (!target) {\n            ev.preventDefault();\n          }\n        }.bind(this));\n        element.addEventListener('dragover', function (ev) {\n          const target = this.__findDroppable(ev.target);\n          if (!target) {\n            ev.preventDefault();\n          }\n        }.bind(this));\n      }, this);\n      qx.core.Init.getApplication().setRoot(root);\n      root.setLayout(new qx.ui.layout.Canvas());\n\n      const snackbar = cv.ui.manager.snackbar.Controller.getInstance();\n      root.add(snackbar, {\n        bottom: 10,\n        left: 200\n      });\n\n      /**\n       *\n       */\n      function resize() {\n        const bounds = root.getBounds();\n        snackbar.setLayoutProperties({\n          bottom: 10,\n          left: Math.round(bounds.width / 2) - 150\n        });\n        snackbar.setMaxHeight(bounds.height - 40);\n      }\n      root.addListener('resize', resize, this);\n      root.addListener('appear', resize, this);\n      window.addEventListener('resize', function () {\n        // sync window height with manager height\n        domRoot.style.height = window.innerHeight + 'px';\n      });\n\n      const main = new qx.ui.container.Composite(new qx.ui.layout.Dock());\n      root.add(main, {edge: 0});\n      // menu on top\n      const menuBar = cv.ui.manager.MenuBar.getInstance();\n      main.add(menuBar, {edge: 'north'});\n\n      const uploadButton = menuBar.getButton('upload');\n      const uploadManager = new cv.ui.manager.upload.UploadMgr(uploadButton);\n      this.bind('currentFolder', uploadManager, 'folder');\n\n      this._pane = new qx.ui.splitpane.Pane();\n      main.add(this._pane, {edge: 'center'});\n\n      const rootFolder = cv.ui.manager.model.FileItem.ROOT = new cv.ui.manager.model.FileItem('.');\n      const fakeIconFile = cv.ui.manager.model.FileItem.getIconFile();\n      // TODO: needs to be verified by the backend\n      rootFolder.set({\n        overrideIcon: true,\n        writeable: true,\n        readable: true,\n        open: true,\n        fakeChildren: [fakeIconFile],\n        icon: cv.theme.dark.Images.getIcon('home', 18)\n      });\n      this.setCurrentFolder(rootFolder);\n      this._tree = new cv.ui.manager.tree.FileSystem(rootFolder);\n      this._tree.addListener('changeSelection', this._onChangeTreeSelection, this);\n\n      // left container\n      const leftContainer = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n\n      // left toolbar\n      const leftBar = new cv.ui.manager.ToolBar(uploadManager);\n      this.bind('currentFolder', leftBar, 'folder');\n      this.bind('currentSelection', leftBar, 'file');\n      leftBar.addListener('reload', this._tree.reload, this._tree);\n\n      // globally bind writeable folder to command for new files\n      const buttonConfig = menuBar.getButtonConfiguration();\n      this.bind('writeableFolder', buttonConfig['new-file'].args[2], 'enabled');\n      this.bind('writeableFolder', buttonConfig['new-folder'].args[2], 'enabled');\n      // this.bind('deleteableSelection', buttonConfig['delete'].args[2], 'enabled');\n\n      leftContainer.add(leftBar);\n      leftContainer.add(this._tree, {flex: 1});\n      this._pane.add(leftContainer, 0);\n      cv.ui.manager.model.Preferences.getInstance().bind('expertMode', leftContainer, 'visibility', {\n        converter: function (value) {\n          return value ? 'visible' : 'excluded';\n        }\n      });\n\n      this._mainContent = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n\n      // tab list\n      const list = new qx.ui.form.List(true);\n      list.setAppearance('open-files-tabs');\n      this._openFilesController = new qx.data.controller.List(this.getOpenFiles(), list, 'file.name');\n      this._openFilesController.setDelegate({\n        createItem: function () {\n          const item = new cv.ui.manager.form.FileTabItem();\n          item.addListener('close', this._onCloseFile, this);\n          return item;\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindDefaultProperties(item, index);\n          controller.bindProperty('file.permanent', 'permanent', null, item, index);\n          controller.bindProperty('file.modified', 'modified', null, item, index);\n          controller.bindProperty('icon', 'icon', null, item, index);\n          controller.bindProperty('closeable', 'closeable', null, item, index);\n        }\n      });\n      list.addListener('changeSelection', this._onChangeFileSelection, this);\n      this._mainContent.add(list);\n\n      this._stack = new qx.ui.container.Stack();\n      this._stack.addListener('changeSelection', this._onChangeStackSelection, this);\n      this._mainContent.add(this._stack, {flex: 1});\n      this._pane.add(this._mainContent, 1);\n\n      const startOpenFile = new cv.ui.manager.model.OpenFile(rootFolder, 'cv.ui.manager.Start');\n      startOpenFile.setCloseable(false);\n      this.getOpenFiles().push(startOpenFile);\n      list.setModelSelection([startOpenFile]);\n    },\n\n    _showAbout: function () {\n      const dialogConf = {\n        caption: qx.locale.Manager.tr('About'),\n        modal: true,\n        minWidth: Math.min(500, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: `\n<div class=\"about-cv\">\n <img src=\"resource/icons/comet_icon_128x128_ff8000.png\" width=\"128\" height=\"128\"/>\n <h2>CometVisu ${cv.Version.VERSION}</h2>\n <div class=\"info\">\n   <label for=\"date\">${qx.locale.Manager.tr('Build date')}: </label><span id=\"date\">${cv.Version.DATE}</span><br/>\n   <label for=\"build\">${qx.locale.Manager.tr('Build revision')}: </label><span id=\"build\">${cv.Version.REV}</span><br/>\n   <label for=\"lib-version\">${qx.locale.Manager.tr('Library version')}: </label><span id=\"lib-version\">${cv.Version.LIBRARY_VERSION}</span>\n </div>\n</div>`};\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects(\n      '_pane', '_tree', '_stack', '_mainContent', '_openFilesController'\n    );\n    // restore former command group\n    const application = qx.core.Init.getApplication();\n    const manager = application.getCommandManager();\n    manager.setActive(this._oldCommandGroup);\n    this._oldCommandGroup = null;\n\n    // defer the reset to let the dispose queue to be emptied before removing the root\n    new qx.util.DeferredCall(function () {\n      application.resetRoot();\n    }).schedule();\n\n    document.body.removeChild(this.__root);\n    this.__root = null;\n    this.__actionDispatcher = null;\n\n    qx.event.message.Bus.unsubscribe('cv.manager.*', this._onManagerEvent, this);\n\n    // destroy the singleton instance\n    delete cv.ui.manager.Main.$$instance;\n  }\n});\n","/**\n * Represents an entry in the filesystem (file or folder).\n */\nqx.Class.define('cv.ui.manager.model.FileItem', {\n  extend: qx.core.Object,\n  include: [\n    qx.data.marshal.MEventBubbling,\n    cv.ui.manager.control.MFileEventHandler\n  ],\n  implement: [cv.ui.manager.control.IFileEventHandler],\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name, path, parent, fakeChildren) {\n    this.base(arguments);\n    this.initChildren(new qx.data.Array());\n    if (fakeChildren) {\n      this.setFakeChildren(fakeChildren);\n    }\n    if (path) {\n      if (!path.endsWith('/')) {\n        path += '/';\n      }\n      this.__path = path;\n    }\n    if (name) {\n      this.setName(name);\n    }\n    if (parent) {\n      this.setParent(parent);\n    }\n    if (qx.core.Environment.get('qx.dynlocale')) {\n      qx.locale.Manager.getInstance().addListener('changeLocale', this._onChangeLocale, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    ROOT: null,\n    _fakeIconFile: null,\n    _hiddenConfigFakeFile: null,\n    _acceptedFiles: {\n      '.': '*.xml',\n      'media': '*.js,*.jpg,*.gif,*.png,*.conf,*.svg,*.md,*.rst,*,css,*.txt'\n    },\n\n    isConfigFile: function (path) {\n      return /visu_config.*\\.xml/.test(path);\n    },\n\n    getConfigName: function (filename) {\n      const match = /visu_config_?([^.]+)\\.xml/.exec(filename);\n      if (match) {\n        return match[1];\n      }\n      return null;\n    },\n\n    getIconFile: function () {\n      if (!this._fakeIconFile) {\n        this._fakeIconFile = new cv.ui.manager.model.FileItem('CometVisu-Icons', '', cv.ui.manager.model.FileItem.ROOT).set({\n          type: 'file',\n          overrideIcon: true,\n          writeable: false,\n          readable: true,\n          open: true,\n          loaded: true,\n          hasChildren: false,\n          fake: true,\n          icon: cv.theme.dark.Images.getIcon('icons', 18)\n        });\n      }\n      return this._fakeIconFile;\n    },\n\n    getHiddenConfigFile: function () {\n      if (!this._hiddenConfigFakeFile) {\n        this._hiddenConfigFakeFile = new cv.ui.manager.model.FileItem('hidden.php', '', cv.ui.manager.model.FileItem.ROOT).set({\n          hasChildren: false,\n          loaded: true,\n          readable: true,\n          writeable: true,\n          overrideIcon: true,\n          icon: cv.theme.dark.Images.getIcon('hidden-config', 15),\n          type: 'file',\n          fake: true,\n          displayName: qx.locale.Manager.tr('Hidden configuration')\n        });\n      }\n      return this._hiddenConfigFakeFile;\n    },\n\n    getAcceptedFiles: function (folder) {\n      return this._acceptedFiles[folder.getFullPath()];\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    open : {\n      check : 'Boolean',\n      event : 'changeOpen',\n      apply : '_onOpen',\n      init : false\n    },\n\n    loaded : {\n      check : 'Boolean',\n      event : 'changeLoaded',\n      init : false\n    },\n\n    loading : {\n      check : 'Boolean',\n      event : 'changeLoading',\n      init : false\n    },\n\n    parent : {\n      event : 'changeParent',\n      init : null\n    },\n\n    children : {\n      check : 'qx.data.Array',\n      event : 'changeChildren',\n      apply: '_applyEventPropagation',\n      deferredInit : true\n    },\n\n    fakeChildren: {\n      check: 'Array',\n      nullable: true\n    },\n\n    displayName: {\n      check: 'String',\n      init: '',\n      event: 'changeDisplayName'\n    },\n\n    /**\n     * Fake items only exist in the client not in the backend\n     */\n    fake: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeFake'\n    },\n\n    overrideIcon: {\n      check: 'Boolean',\n      init: false\n    },\n\n    icon: {\n      check: 'String',\n      nullable: true,\n      event: 'changeIcon'\n    },\n\n    hash: {\n      check: 'Number',\n      nullable: true\n    },\n\n    editing: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeEditing'\n    },\n\n    /**\n     * A special configuration option for mulitple purposes, e.g. creating a fake FileItem with a special\n     * behaviour like an \"Add new File\" used in writeable Folders.\n     */\n    special: {\n      check: 'String',\n      nullable: true,\n      event: 'changeSpecial'\n    },\n\n    /**\n     * Temporary file are not save in the backend yet\n     */\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTemporary'\n    },\n\n    /**\n     * Validation result for this files content (e.g. config file validation)\n     */\n    valid: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeValid'\n    },\n\n    /**\n     * The validation of this files content found some warnings\n     */\n    hasWarnings: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeHasWarnings'\n    },\n\n    /**\n     * Temporary content to show, e.g. for new files, when there is no 'real' file with content yet to request from the backend\n     * this content should be shown\n     */\n    content: {\n      check: 'String',\n      nullable: true\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    },\n\n    // Backend properties\n\n    hasChildren : {\n      check : 'Boolean',\n      event : 'changeHasChildren',\n      apply : '_applyHasChildren',\n      init : false\n    },\n\n    name : {\n      check : 'String',\n      event : 'changeName',\n      init : '',\n      apply: '_applyName'\n    },\n\n    type: {\n      check: ['dir', 'file'],\n      transform: '_toLowerCase',\n      nullable: true,\n      apply: '_maintainIcon'\n    },\n\n    parentFolder: {\n      check: 'String',\n      nullable: true\n    },\n\n    readable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadable'\n    },\n\n    writeable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeWriteable'\n    },\n\n    mounted: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeMounted'\n    },\n\n    trash: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTrash'\n    },\n\n    inTrash: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeInTrash'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __path: null,\n    __fullPath: null,\n    __onLoadCallback: null,\n\n    _toLowerCase: function (name) {\n      return name.toLowerCase();\n    },\n\n    isRelated: function (path) {\n      return this.getFullPath() === path;\n    },\n\n    _handleFileEvent: function (ev) {\n      if (this.isFake()) {\n        return;\n      }\n      const data = ev.getData();\n      switch (data.action) {\n        case 'moved':\n          this.reload();\n          break;\n\n        case 'added':\n          if (this.getType() === 'dir' && data.path.startsWith(this.getFullPath())) {\n            this.reload();\n          }\n          break;\n\n        case 'deleted':\n          if (data.path === this.getFullPath()) {\n            // this item has been deleted\n            this.dispose();\n          } else if (this.getType() === 'dir' && data.path.startsWith(this.getFullPath())) {\n            // delete child\n            const children = this.getChildren();\n            children.some(function (child) {\n              if (child.getFullPath() === data.path) {\n                children.remove(child);\n                this.removeRelatedBindings(child);\n                return true;\n              }\n              return false;\n            }, this);\n          }\n          break;\n      }\n    },\n\n    _applyName: function (value, old) {\n      this.__fullPath = null;\n      if (value && (this.getDisplayName() === null || this.getDisplayName() === old)) {\n        // use name as default display name\n        this.setDisplayName(value);\n      }\n    },\n\n    getPath: function () {\n      if (!this.__path) {\n        let parentFolder = this.getParentFolder();\n        if (!parentFolder) {\n          parentFolder = '';\n        } else if (!parentFolder.endsWith('/')) {\n          parentFolder += '/';\n        }\n        this.__path = parentFolder;\n      }\n      return this.__path;\n    },\n\n    _onOpen : function(value) {\n      if (!this.isLoaded() && value) {\n        this.load();\n      }\n      this._maintainIcon();\n    },\n\n    _maintainIcon: function () {\n      if (!this.isOverrideIcon()) {\n        if (this.getType() === 'file') {\n          this.setIcon(cv.theme.dark.Images.getIcon('file', 18));\n        } else if (this.isTrash()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('trash', 18));\n        } else if (this.isOpen()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('folder-open', 18));\n        } else if (this.isMounted()) {\n          this.setIcon(cv.theme.dark.Images.getIcon('mounted-folder', 18));\n        } else {\n          this.setIcon(cv.theme.dark.Images.getIcon('folder', 18));\n        }\n      }\n    },\n\n    isConfigFile: function () {\n      return cv.ui.manager.model.FileItem.isConfigFile(this.getName());\n    },\n\n    _applyHasChildren: function (value) {\n      if (value === true && this.getChildren().length === 0) {\n        // add dummy child\n        this.getChildren().push(new cv.ui.manager.model.FileItem(''));\n      }\n    },\n\n    unload: function() {\n      this.setLoaded(false);\n      this.setLoading(false);\n      this.getChildren().removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n    },\n\n    reload : function(callback, context) {\n      this.unload();\n      return this.load(callback, context);\n    },\n\n    addChild: function (child) {\n      const oldParent = child.getParent();\n      if (oldParent !== this) {\n        oldParent.getChildren().remove(child);\n        oldParent.removeRelatedBindings(child);\n      }\n      child.setParent(this);\n      if (child.getType() !== 'dir' || !child.isMounted()) {\n        // inherit the mounted state from the parent folder\n        this.bind('mounted', child, 'mounted');\n      }\n      this.getChildren().push(child);\n    },\n\n    _onGet: function (data) {\n      const children = this.getChildren();\n      children.removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n      if (data) {\n        data.forEach(function (node) {\n          const child = new cv.ui.manager.model.FileItem(null, null, this);\n          if (Object.prototype.hasOwnProperty.call(node, 'children')) {\n            const nodeChildren = node.children;\n            delete node.children;\n            if (nodeChildren.length > 0) {\n              child.getChildren().replace(nodeChildren);\n              child.setLoaded(true);\n            }\n          }\n          child.set(node);\n          children.push(child);\n        }, this);\n      }\n      if (this.getFakeChildren()) {\n        children.append(this.getFakeChildren());\n      }\n      this.sortElements();\n\n      this.setLoaded(true);\n      if (this.__onLoadCallback) {\n        this.__onLoadCallback();\n      }\n      this.setLoading(false);\n    },\n\n    _onError: function (err) {\n      this.error(err);\n      cv.ui.manager.snackbar.Controller.error(err);\n      this.getChildren().removeAll().forEach(function (child) {\n        this.removeRelatedBindings(child);\n      }, this);\n      this.setLoaded(true);\n      if (this.__onLoadCallback) {\n        this.__onLoadCallback();\n      }\n      this.setLoading(false);\n    },\n\n    load: function(callback, context) {\n      // If currently loading, delay ready\n      if (this.getType() === 'file') {\n        // nothing to load\n        this.setLoaded(true);\n        return;\n      } else if (this.isFake()) {\n        this.setLoaded(true);\n        if (this.getFakeChildren()) {\n          this.getChildren().append(this.getFakeChildren());\n        }\n        return;\n      }\n      if (this.isLoading()) {\n        if (callback) {\n          this.addListenerOnce('changeLoading', callback, context);\n        }\n      } else if (this.isLoaded()) {\n        // If not done yet, resolve the child elements of this container\n        if (callback) {\n          callback.apply(context);\n        }\n      } else {\n        this.setLoading(true);\n        if (callback) {\n          this.__onLoadCallback = callback.bind(context || this);\n        }\n        cv.io.rest.Client.getFsClient().readSync({path: this.getFullPath()}, function (err, res) {\n          if (err) {\n            this._onError(err);\n          } else {\n            this._onGet(res);\n          }\n        }, this);\n      }\n    },\n\n    /**\n     * Returns the complete path needed for the REST API  to identify this file\n     * @returns {null}\n     */\n    getFullPath: function () {\n      if (!this.__fullPath) {\n        this.__fullPath = this.getPath() + this.getName();\n      }\n      return this.__fullPath;\n    },\n\n    getBusTopic: function () {\n      return 'cv.manager.fs.' + this.getFullPath().replace(/\\//g, '.');\n    },\n\n    /**\n     * Returns a fake URI that can be used to identify the file.\n     * Used by monaco editor as model URI.\n     * @returns {Uri}\n     */\n    getUri: function () {\n      return 'cv://' + this.getFullPath();\n    },\n\n    /**\n     * Returns the path to this file for requests over HTTP (not the REST API)\n     *\n     * Note: Please be aware that this path does not work if the file is in a mounted folder\n     * like the demo configs. The backend handles those mounts transparently to the client. But\n     * because of that the client does not know the real path to the file.\n     *\n     * @returns {string}\n     */\n    getServerPath: function () {\n      if (!this.isMounted()) {\n        return qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/config/' + this.getFullPath();\n      }\n      return qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/' + this.getFullPath();\n    },\n\n    /**\n     *  Sort entries: folders first, files then\n     */\n    sortElements: function () {\n      const sortF = function (a, b) {\n        if (a.getType() === 'dir') {\n          if (b.getType() === 'dir') {\n            if (a.isTrash()) {\n              return 1;\n            } else if (b.isTrash()) {\n              return -1;\n            }\n            return a.getName().localeCompare(b.getName());\n          }\n          return -1;\n        } else if (b.getType() === 'dir') {\n          return 1;\n        }\n        return a.getName().localeCompare(b.getName());\n      };\n      this.getChildren().sort(sortF);\n    },\n\n    openPath: function (path) {\n      const parts = qx.lang.Type.isArray(path) ? path : path.split('/');\n      const relPath = parts.shift();\n      this.getChildren().some(function (child) {\n        if (child.getName() === relPath) {\n          child.load(function () {\n            child.setOpen(true);\n            if (parts.length > 0) {\n              child.openPath(parts);\n            }\n          }, this);\n          return true;\n        }\n        return false;\n      }, this);\n    },\n\n    _onChangeLocale : qx.core.Environment.select('qx.dynlocale', {\n      'true': function () {\n        const content = this.getDisplayName();\n        if (content && content.translate) {\n          this.setDisplayName(content.translate());\n        }\n      },\n\n      'false' : null\n    })\n  },\n  \n  /*\n  ***********************************************\n    DESTRUCTOR  \n  ***********************************************\n  */\n  destruct: function () {\n    this.__fullPath = null;\n  } \n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.BackupFolder', {\n  extend: cv.ui.manager.model.FileItem,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments, 'backup');\n    this.load();\n    qx.event.message.Bus.subscribe('cv.manager.fs.*', this._onFilesSystemMessage, this);\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _onFilesSystemMessage: function (ev) {\n      if (/^cv\\.manager\\.fs\\.visu_config.*\\.xml$/.test(ev.getName())) {\n        // Fs event on config file\n        const data = ev.getData();\n        if (['contentChanged', 'fsContentChanged'].includes(data.type)) {\n          // config file has been changed or restored, refresh the backups\n          this.reload();\n        }\n      }\n    },\n\n    /**\n     * Returns the list of existing backup files for the given file.\n     * @param file {cv.ui.manager.model.FileItem}\n     */\n    getBackupFiles: function (file) {\n      const files = [];\n      if (file.getType() === 'file') {\n        const pathparts = file.getFullPath().split('/');\n        pathparts.pop();\n        const path = pathparts.join('\\/');\n        const parts = file.getName().split('.');\n        const suffix = parts.pop();\n        const filename = parts.join('.');\n        const fileRegex = new RegExp(path + filename + '-([\\\\d]{14})\\\\.' + suffix);\n        this.getChildren().forEach(function (backupFile) {\n          const match = fileRegex.exec(backupFile.getFullPath().replace('backup/', ''));\n          if (match) {\n            files.push({\n              date: new Date(\n                parseInt(match[1].substring(0, 4)),\n                parseInt(match[1].substring(4, 6))-1,\n                parseInt(match[1].substring(6, 8)),\n                parseInt(match[1].substring(8, 10)),\n                parseInt(match[1].substring(10, 12)),\n                parseInt(match[1].substring(12, 14))\n              ),\n              file: backupFile\n            });\n          }\n        }, this);\n      }\n      return files;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.fs.*', this._onFilesSystemMessage, this);\n  }\n});\n","/**\n * The ActionDispatcher listens to the events in the 'cv.manager.action' topic and\n * dispatched those events to the currently relevant handler (e.g. the save event to the opened editor).\n */\nqx.Class.define('cv.ui.manager.control.ActionDispatcher', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    qx.event.message.Bus.subscribe('cv.manager.action.*', this._onAction, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    focusedWidget: {\n      check: 'cv.ui.manager.IActionHandler',\n      nullable: true,\n      apply: '_applyFocusedWidget'\n    },\n\n    main: {\n      check: 'cv.ui.manager.Main',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    updateBarButtons: function () {\n      const actionHandler = this.getFocusedWidget();\n      const menuBar = cv.ui.manager.MenuBar.getInstance();\n      const config = menuBar.getButtonConfiguration();\n      let button;\n      Object.keys(config).forEach(function (actionId) {\n        button = menuBar.getButton(actionId);\n        if (button) {\n          button.setEnabled(config[actionId].general || this.hasHandler(actionId));\n          if (actionHandler) {\n            actionHandler.configureButton(actionId, button);\n          }\n        }\n      }, this);\n    },\n\n    _applyFocusedWidget: function (value, old) {\n      if (old) {\n        const menuBar = cv.ui.manager.MenuBar.getInstance();\n        const config = menuBar.getButtonConfiguration();\n        let button;\n        Object.keys(config).forEach(function (actionId) {\n          button = menuBar.getButton(actionId);\n          if (button) {\n            old.unConfigureButton(actionId, button);\n          }\n        }, this);\n      }\n      this.updateBarButtons();\n    },\n\n    /**\n     * Check if there is an existing handler for the given actionName.\n     * @param actionName\n     * @return {Boolean}\n     */\n    hasHandler: function (actionName) {\n      return !!this._getHandler(actionName);\n    },\n\n    _getHandler: function (actionName) {\n      const handler = this.getFocusedWidget();\n      const main = this.getMain();\n      if (handler && handler.canHandleAction(actionName)) {\n        return handler;\n      } else if (main && main.canHandleAction(actionName)) {\n        return main;\n      }\n      return null;\n    },\n\n    _onAction: function (ev) {\n      const topic = ev.getName();\n      const actionName = topic.split('.').pop();\n      const handler = this._getHandler(actionName);\n      if (handler) {\n        handler.handleAction(actionName, ev.getData());\n      } else {\n        this.warn('no action handler found for action: ' + actionName);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.subscribe('cv.manager.action.*', this._onAction, this);\n  }\n});\n","/**\n * Main view component responsible for showing a list of snackbar messages.\n */\nqx.Class.define('cv.ui.manager.snackbar.Controller', {\n  extend: qx.ui.core.Widget,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.VBox(8));\n    this.initMessages(new qx.data.Array());\n    qx.event.message.Bus.subscribe('cv.manager.msg.snackbar', this._onMessage, this);\n    this._listController = new qx.data.controller.List(this.getMessages(), this.getChildControl('list'));\n    this._initDelegate();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    info: function (message) {\n      const msg = new cv.ui.manager.model.Message();\n      msg.set({\n        title: message\n      });\n      qx.event.message.Bus.dispatchByName('cv.manager.msg.snackbar', msg);\n    },\n\n    error: function (message) {\n      const msg = new cv.ui.manager.model.Message();\n      if (typeof message === 'object' && Object.prototype.hasOwnProperty.call(message, 'statusText')) {\n        message = message.statusText;\n      }\n      msg.set({\n        title: message,\n        type: 'error',\n        sticky: true\n      });\n      qx.event.message.Bus.dispatchByName('cv.manager.msg.snackbar', msg);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-snackbar'\n    },\n\n    messages: {\n      check: 'qx.data.Array',\n      deferredInit: true,\n      event: 'changeMessages'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n\n    _onMessage: function (ev) {\n      const msg = ev.getData();\n      if (msg instanceof cv.ui.manager.model.Message) {\n        this.getMessages().push(msg);\n        this.show();\n      }\n    },\n\n    _onCloseMessage: function (ev) {\n      const msg = ev.getData();\n      this.getMessages().remove(msg);\n      if (this.getMessages().length === 0) {\n        this.exclude();\n      }\n    },\n\n    _initDelegate: function () {\n      this._listController.setDelegate({\n        createItem: function () {\n          const item = new cv.ui.manager.snackbar.Message();\n          item.addListener('close', this._onCloseMessage, this);\n          return item;\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n        }\n      });\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'list':\n           control = new qx.ui.form.List();\n           this._add(control, {flex: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.msg.snackbar', this._onMessage, this);\n    this._disposeObjects('_listController');\n  }\n});\n","/**\n * User preferences.\n */\nqx.Class.define('cv.ui.manager.model.Preferences', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._restorePreferences();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    defaultConfigEditor: {\n      check: ['source', 'xml'],\n      init: 'source',\n      event: 'changeDefaultConfigEditor',\n      apply: '_savePreferences'\n    },\n\n    quickPreview: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeQuickPreview',\n      apply: '_savePreferences'\n    },\n\n    /**\n     * In export mode the manager looks and behaves like a file explorer.\n     */\n    expertMode: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeExpertMode',\n      apply: '_savePreferences'\n    },\n\n    /**\n     * View mode of the start page\n     */\n    startViewMode: {\n      check: ['list', 'preview'],\n      init: 'preview',\n      event: 'changeStartViewMode',\n      apply: '_savePreferences'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _skipSaving: false,\n\n    _savePreferences: function () {\n      if (!this._skipSaving) {\n        const store = qx.bom.Storage.getLocal();\n        const data = qx.util.Serializer.toNativeObject(this);\n        store.setItem('preferences', data);\n        cv.report.Record.record(cv.report.Record.STORAGE, 'preferences', data);\n      }\n    },\n\n    _restorePreferences: function () {\n      const store = qx.bom.Storage.getLocal();\n      this.set(store.getItem('preferences'));\n    },\n\n    setPreferences: function (preferences, noSave) {\n      if (noSave) {\n        this._skipSaving = true;\n      }\n      this.set(preferences);\n      this._skipSaving = false;\n    }\n  }\n});\n","/**\n * Central registry for all available file editors/viewers.\n */\nqx.Class.define('cv.ui.manager.control.FileHandlerRegistry', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__registry = {};\n    this.__defaults = [];\n\n    // register viewers\n    this.registerFileHandler(new RegExp('\\\\.(' + cv.ui.manager.viewer.Image.SUPPORTED_FILES.join('|') + ')$', 'i'), cv.ui.manager.viewer.Image, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Config.SUPPORTED_FILES, cv.ui.manager.viewer.Config, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Icons.SUPPORTED_FILES, cv.ui.manager.viewer.Icons, {type: 'view'});\n    this.registerFileHandler(cv.ui.manager.viewer.Folder.SUPPORTED_FILES, cv.ui.manager.viewer.Folder, {type: 'view'});\n    this.registerFileHandler(null, cv.ui.manager.Start, {type: 'view'});\n\n    // register the basic editors\n    this.registerFileHandler(cv.ui.manager.editor.Source.SUPPORTED_FILES, cv.ui.manager.editor.Source, {type: 'edit'});\n    this.registerFileHandler(cv.ui.manager.editor.Tree.SUPPORTED_FILES, cv.ui.manager.editor.Tree, {\n      preview: false,\n      type: 'edit'\n    });\n    this.registerFileHandler(cv.ui.manager.model.CompareFiles, cv.ui.manager.editor.Diff, {type: 'view'});\n\n    this.registerFileHandler('hidden.php', cv.ui.manager.editor.Config, {type: 'edit'});\n\n    cv.ui.manager.model.Preferences.getInstance().addListener('changeDefaultConfigEditor', this._onChangesDefaultConfigEditor, this);\n    this._onChangesDefaultConfigEditor();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __registry: null,\n    __defaults: null,\n\n    /**\n     * Registers an editor for a specific file, that is identified by the given selector.\n     * @param selector {String|RegExp|Class|Function|null} filename-/path or regular expression. If null this is a special handler that must be loaded manually (like cv.ui.manager.Start)\n     * @param clazz {qx.ui.core.Widget} widget class that handles those type of files\n     * @param options {Map?} additional options to store in the registry\n     */\n    registerFileHandler: function (selector, clazz, options) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertTrue(qx.Interface.classImplements(clazz, cv.ui.manager.editor.IEditor));\n      }\n      const config = Object.assign({\n        Clazz: clazz,\n        instance: null\n      }, options || {});\n      if (qx.Class.isClass(selector)) {\n        config.instanceOf = selector;\n        config.selectorId = 'instanceOf:' + selector.classname;\n        // highest priority\n        config.priority = 0;\n      } else if (qx.lang.Type.isRegExp(selector)) {\n        config.regex = selector;\n        config.selectorId = 'regex:' + selector.toString();\n        config.priority = 4;\n      } else if (qx.lang.Type.isFunction(selector)) {\n        config.selectorId = 'function:' + selector.name;\n        config.priority = 3;\n        config.function = selector;\n      } else if (qx.lang.Type.isString(selector)) {\n        // simple file matcher\n        if (selector.includes('/')) {\n          config.fullPath = selector;\n          config.selectorId = 'fullPath:' + selector;\n          config.priority = 1;\n        } else {\n          config.fileName = selector;\n          config.selectorId = 'fileName:' + selector;\n          config.priority = 2;\n        }\n      } else {\n        config.selectorId = 'none';\n        config.priority = 10;\n      }\n      this.__registry[clazz.classname] = config;\n    },\n\n    getFileHandler: function (file, type) {\n      const handlers = [];\n      if (!(file instanceof cv.ui.manager.model.CompareFiles)) {\n        // check if there is a default first\n        let defaultHandler;\n        Object.keys(this.__defaults).some(function (key) {\n          if (this.__defaults[key].regex.test(file.getFullPath()) &&\n            (!file.isTemporary() || !this.__defaults[key].noTemporaryFiles) &&\n            (file.isWriteable() || !this.__defaults[key].noReadOnlyFiles)\n          ) {\n            if (type) {\n              const config = this.getFileHandlerById(this.__defaults[key].clazz.classname);\n              if (config.type === type) {\n                defaultHandler = config;\n              }\n            } else {\n              defaultHandler = this.getFileHandlerById(this.__defaults[key].clazz.classname);\n            }\n          }\n          return !!defaultHandler;\n        }, this);\n        if (defaultHandler) {\n          return defaultHandler;\n        }\n      }\n\n      Object.keys(this.__registry).forEach(function (classname) {\n        const config = this.__registry[classname];\n        if (this.__canHandle(config, file) && (!type || config.type === type)) {\n          handlers.push(config);\n        }\n      }, this);\n      if (handlers.length === 0) {\n        if (!file.isFake() && file.getDisplayName().split('.').length === 1) {\n          // file without file ending => use the source code editor\n          return this.getFileHandlerById('cv.ui.manager.editor.Source');\n        }\n        // no editors found\n        return null;\n      } else if (handlers.length === 1) {\n        return handlers[0];\n      } \n        // sort by selector priority (instance, fullpath, filename, regex)\n        handlers.sort(function (a, b) {\n          return a.priority - b.priority;\n        });\n        // no default handler, just take the first one\n        return handlers[0];\n    },\n\n    getFileHandlerById: function (handlerId) {\n      return this.__registry[handlerId];\n    },\n\n    hasFileHandler: function (file, type) {\n      return Object.keys(this.__registry).some(function (classname) {\n        const config = this.__registry[classname];\n        return this.__canHandle(config, file) && (!type || config.type === type);\n      }, this);\n    },\n\n    /**\n     * Mark the handler with the given classname as default for the selector-id and all others with the same selector id not,\n     * @param selector {RegExp}\n     * @param clazz {qx.Class}\n     * @param noTemporaryFiles {Boolean} flag to prevent this default editor from being used to open temporary files.\n     * @param noReadOnlyFiles {Boolean} fleag to prevent this default editor from being used to open file that are not writeable\n     */\n    setDefault: function (selector, clazz, noTemporaryFiles, noReadOnlyFiles) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertRegExp(selector);\n        qx.core.Assert.assertTrue(qx.Class.isClass(clazz));\n      }\n      this.__defaults[selector.toString()] = {\n        regex: selector,\n        clazz: clazz,\n        noTemporaryFiles: noTemporaryFiles,\n        noReadOnlyFiles: noReadOnlyFiles\n      };\n    },\n\n    _onChangesDefaultConfigEditor: function () {\n      switch (cv.ui.manager.model.Preferences.getInstance().getDefaultConfigEditor()) {\n        case 'source':\n          this.setDefault(cv.ui.manager.editor.Source.DEFAULT_FOR, cv.ui.manager.editor.Source);\n          break;\n\n        case 'xml':\n          this.setDefault(cv.ui.manager.editor.Tree.SUPPORTED_FILES, cv.ui.manager.editor.Tree);\n          break;\n      }\n    },\n\n    __canHandle: function(config, file) {\n      if (config.noTemporaryFiles === true && file.isTemporary()) {\n        return false;\n      } else if (config.noReadOnlyFiles === true && !file.isWriteable()) {\n          return false;\n      } else if (config.fileName && file.getName() === config.fileName) {\n        return true;\n      } else if (config.fullPath && file.getFullPath() === config.fullPath) {\n        return true;\n      } else if (config.regex && config.regex.test(file.getFullPath().toLowerCase())) {\n        return true;\n      } else if (config.instanceOf && file instanceof config.instanceOf) {\n        return true;\n      } else if (config.function && config.function(file)) {\n        return true;\n      }\n      return false;\n    },\n\n    getAllFileHandlers: function (file, type) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertTrue(file instanceof cv.ui.manager.model.FileItem || file instanceof cv.ui.manager.model.CompareFiles);\n      }\n      return Object.keys(this.__registry).filter(function (key) {\n        return this.__canHandle(this.__registry[key], file) && (!type || this.__registry[key].type === type);\n      }, this).map(function (key) {\n        return this.__registry[key];\n      }, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    // cleanup handler instances\n    Object.keys(this.__registry).forEach(function (regex) {\n      if (this.__registry[regex].instance) {\n        this.__registry[regex].instance.dispose();\n        this.__registry[regex].instance = null;\n      }\n    }, this);\n\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeDefaultConfigEditor', this._onChangesDefaultConfigEditor, this);\n  }\n});\n","/**\n * Interface all file editors must implement.\n */\nqx.Interface.define('cv.ui.manager.editor.IEditor', {\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_loadFile'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * If the handler needs some time to initialize before it can accept a file, this should be set false until the handler is ready\n     */\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: ''\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    save: function () {},\n\n    getCurrentContent: function () {}\n  }\n});\n","/**\n * Abstract base class for all editors.\n */\nqx.Class.define('cv.ui.manager.editor.AbstractEditor', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._initClient();\n    this._nativePasteSupported = document.queryCommandSupported('paste');\n  },\n\n  /*\n ***********************************************\n   PROPERTIES\n ***********************************************\n */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      apply: '_loadFile',\n      event: 'changeFile'\n    },\n\n    content: {\n      nullable: true,\n      event: 'changeContent',\n      apply: '_applyContent'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true,\n      apply: '_applyHandlerOptions'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    // fake clipboard data when native clipboard is not supported\n    CLIPBOARD: null\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _handledActions: null,\n    _nativePasteSupported: false,\n\n    canHandleAction: function (actionName) {\n      if (actionName === 'save' && this.getFile() && !this.getFile().isWriteable()) {\n        return false;\n      }\n      return this._handledActions && this._handledActions.includes(actionName);\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'save':\n            this.save();\n            break;\n        }\n      }\n    },\n\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getFsClient();\n    },\n\n    _applyHandlerOptions: function () {},\n\n    _loadFile: function (file, old) {\n      if (old) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (file && file.getType() === 'file') {\n        if (file.getContent() !== null) {\n          this.setContent(file.getContent());\n        } else {\n          this._loadFromFs();\n        }\n        qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n      } else {\n        this.resetContent();\n      }\n    },\n\n    _loadFromFs: function () {\n      this._client.readSync({path: this.getFile().getFullPath()}, function (err, res) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          if (res instanceof XMLDocument) {\n            res = new XMLSerializer().serializeToString(res);\n          }\n          this.setContent(res);\n        }\n      }, this);\n    },\n\n    _onChange: function (ev) {\n      const data = ev.getData();\n      if (data.type === 'fsContentChanged' && data.source !== this) {\n        this.setContent(data.data);\n      }\n    },\n\n    // must be overridden by inheriting classes\n    _applyContent: function() {},\n\n    // must be overridden by inheriting classes\n    getCurrentContent: function () {},\n\n    _handleSaveResponse: function (type, err) {\n      if (err) {\n        cv.ui.manager.snackbar.Controller.error(err);\n      } else {\n        const file = this.getFile();\n        const message = type === 'created' ? this.tr('File has been created') : this.tr('File has been saved');\n        cv.ui.manager.snackbar.Controller.info(message);\n        this._onSaved();\n        qx.event.message.Bus.dispatchByName(file.getBusTopic(), {\n          type: type,\n          file: file,\n          data: this.getCurrentContent(),\n          source: this\n        });\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      const file = this.getFile();\n      if (file.isModified()) {\n        if (file.isTemporary()) {\n          this._client.createSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash(),\n            type: 'file'\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'created'), this);\n        } else {\n          this._client.updateSync({\n            path: file.getFullPath(),\n            hash: overrideHash || file.getHash()\n          }, this.getCurrentContent(), callback || qx.lang.Function.curry(this._handleSaveResponse, 'contentChanged'), this);\n        }\n      }\n    },\n\n    _onSaved: function () {\n      const file = this.getFile();\n      file.resetModified();\n      file.resetTemporary();\n    },\n\n    showErrors: function (path, errorList) {},\n    showDecorations: function (path, decorators) {}\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    if (this._client) {\n      this._client = null;\n    }\n  }\n});\n","/**\n * Global singleton that hold some states that are relevant for many parts of the manager.\n */\nqx.Class.define('cv.ui.manager.core.GlobalState', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    openedFocusedFile: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      event: 'changeOpenedFocusedFile',\n      apply: '_applyFile'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyFile: function () {\n      cv.ui.manager.control.ActionDispatcher.getInstance().updateBarButtons();\n    }\n  }\n});\n","/**\n * Data model for currently opened files, a combination of cv.ui.manager.model.FileItem and a certain FileHandler.\n */\nqx.Class.define('cv.ui.manager.model.OpenFile', {\n  extend: qx.core.Object,\n\n\n    /*\n    ***********************************************\n      CONSTRUCTOR\n    ***********************************************\n    */\n    construct: function (file, handlerId) {\n      this.base(arguments);\n      if (file) {\n        this.setFile(file);\n      }\n      if (handlerId) {\n        this.setHandlerId(handlerId);\n      }\n    },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem || cv.ui.manager.model.CompareFiles',\n      nullable: true,\n      event: 'changeFile',\n      apply: '_applyFile'\n    },\n\n    handlerId: {\n      check: '!!qx.Class.getByName(value)',\n      nullable: true,\n      apply: '_maintainIcon'\n    },\n\n    handlerOptions: {\n      check: 'Map',\n      nullable: true\n    },\n\n    /**\n     * The opening state: permanent false behaves like a quick preview, where\n     * the current file content is replaces by the next selected file on single click.\n     * In permanent mode a new tab will be created, which content will not be replaced.\n     */\n    permanent: {\n      check: 'Boolean',\n      init: false,\n      event: 'changePermanent'\n    },\n\n    /**\n     * Icon to show in e.g. the File-Tab\n     */\n    icon: {\n      check: 'String',\n      init: '',\n      event: 'changeIcon'\n    },\n\n    closeable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeCloseable'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __ibid: null,\n\n    _applyFile: function (value, old) {\n      if (old) {\n        old.removeListener('changeModified', this._maintainPermanent, this);\n        old.removeRelatedBindings(this);\n        this.__ibid = null;\n      }\n      if (value) {\n        value.addListener('changeModified', this._maintainPermanent, this);\n      }\n      this._maintainIcon();\n    },\n\n    _maintainIcon: function () {\n      // use the handlers icon is there is one, otherwise the file items icon\n      const file = this.getFile();\n      if (this.getHandlerId() && file) {\n        const handlerClass = qx.Class.getByName(this.getHandlerId());\n        if (handlerClass && handlerClass.ICON) {\n          this.setIcon(handlerClass.ICON);\n          if (this.__ibid) {\n            file.removeBinding(this.__ibid);\n            this.__ibid = null;\n          }\n        } else {\n          this.__ibid = file.bind('icon', this, 'icon');\n        }\n      } else {\n        this.resetIcon();\n      }\n    },\n\n    _maintainPermanent: function () {\n      if (this.getFile().isModified() && !this.isPermanent()) {\n        // change to permanent once we have a modification\n        this.setPermanent(true);\n      }\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.CompareFiles', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (original, modified) {\n    this.base(arguments);\n    this.setOriginalFile(original);\n    this.setModifiedFile(modified);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    originalFile: {\n      check: 'cv.ui.manager.model.FileItem',\n      event: 'changeOriginal'\n    },\n    modifiedFile: {\n      check: 'cv.ui.manager.model.FileItem',\n      event: 'changeModifiedFile',\n      apply: '_applyModifiedFile'\n    },\n\n    permanent: {\n      check: 'Boolean',\n      init: true\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName'\n    },\n\n    type: {\n      check: 'String',\n      init: 'file'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    isRelated: function (path) {\n      return this.getOriginalFile().getFullPath() === path || this.getModifiedFile().getFullPath() === path;\n    },\n\n    isConfigFile: function () {\n      return this.getModifiedFile().isConfigFile();\n    },\n\n    getFullPath: function () {\n      return this.getOriginalFile().getFullPath();\n    },\n\n    _applyModifiedFile: function () {\n      this.setName(qx.locale.Manager.tr('Diff: %1', this.getModifiedFile().getName()));\n    },\n\n    getParent: function () {\n      return this.getModifiedFile().getParent();\n    },\n\n    isWriteable: function () {\n      return this.getModifiedFile().isWriteable();\n    },\n\n    isTrash: function () {\n      return this.getModifiedFile().isTrash();\n    },\n\n    isInTrash: function () {\n      return this.getModifiedFile().isInTrash();\n    },\n\n    isFake: function () {\n      return this.getModifiedFile().isFake();\n    },\n\n    isTemporary: function () {\n      return this.getModifiedFile().isTemporary() || this.getOriginalFile().isTemporary();\n    },\n\n    isMounted: function () {\n      return this.getModifiedFile().isMounted() || this.getOriginalFile().isMounted();\n    },\n\n    /**\n     * Returns a fake URI that can be used to identify the file.\n     * Used by monaco editor as model URI.\n     * @returns {Uri}\n     */\n    getUri: function () {\n      return 'cv://' + this.getOriginalFile().getFullPath() + '+' + this.getModifiedFile().getFullPath();\n    }\n  }\n});\n","/**\n * The FileController is responsible for all file operations, like config check, move, replace, delete etc.\n */\nqx.Class.define('cv.ui.manager.control.FileController', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__fsClient = cv.io.rest.Client.getFsClient();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __fsClient: null,\n\n    rename: function (file, newName) {\n      let newPath = file.getPath() || '';\n      if (newPath.length > 0 && !newPath.endsWith('/')) {\n        newPath += '/';\n      }\n      newPath += newName;\n      if (file.isTemporary()) {\n        // create new item\n        this.__fsClient.createSync({path: newPath, type: file.getType()}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been created', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been created', file.getDisplayName())\n            );\n            file.resetTemporary();\n            file.resetModified();\n            file.setName(newName);\n            file.reload();\n          }\n        }, this);\n      } else if (file.getFullPath() !== newPath) {\n        this.__fsClient.moveSync({src: file.getFullPath(), target: newPath}, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(err);\n          } else {\n            cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been renamed', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been renamed', file.getDisplayName())\n            );\n            file.setName(newName);\n            file.resetModified();\n            file.reload();\n          }\n          file.resetEditing();\n        }, this);\n      }\n    },\n\n    /**\n     * Move file to another path\n     * @param file {cv.ui.manager.model.FileItem} file to move\n     * @param target {String} new path of the file\n     */\n    move: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been moved', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been moved', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'moved',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    /**\n     * Restore file from trash by moving it out of the trash to the old path\n     * @param file {cv.ui.manager.model.FileItem} file to restore\n     */\n    restore: function (file) {\n      if (file.isInTrash()) {\n        const target = file.getFullPath().replace('.trash/', '');\n        this.__moveFile(file, target);\n      } else if (file.getType() === 'file' && !file.isTemporary()) {\n        const match = /^\\/?backup\\/visu_config(.*)-[0-9]{14}\\.xml$/.exec(file.getFullPath());\n        if (match) {\n          // find the existing target config to restore\n          const targetFileName = 'visu_config' + match[1] + '.xml';\n\n          // find the target file\n          const parentFolder = file.getParent().getParent();\n          let targetFile = null;\n          parentFolder.getChildren().some(function(child) {\n            if (child.getFullPath() === targetFileName) {\n              targetFile = child;\n              return true;\n            }\n            return false;\n          });\n\n          // load the backup content\n          this.__fsClient.readSync({path: file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else if (targetFile) {\n                this.__fsClient.updateSync({\n                  path: targetFile.getFullPath(),\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                    targetFile.resetModified();\n                    targetFile.resetTemporary();\n                    qx.event.message.Bus.dispatchByName(targetFile.getBusTopic(), {\n                      type: 'fsContentChanged',\n                      data: res,\n                      source: this\n                    });\n                  }\n                }, this);\n              } else {\n                // target file does not exist copy to a new file\n                this.__fsClient.createSync({\n                  path: targetFileName,\n                  hash: 'ignore'\n                }, res, function (err) {\n                  if (err) {\n                    cv.ui.manager.snackbar.Controller.error(err);\n                  } else {\n                    cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has been restored', file.getName()));\n                  }\n                }, this);\n              }\n          }, this);\n        }\n      }\n    },\n\n    __moveFile: function (file, target) {\n      this.__fsClient.moveSync({src: file.getFullPath(), target: target}, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n        } else {\n          cv.ui.manager.snackbar.Controller.info(file.getType() === 'file'\n            ? qx.locale.Manager.tr('File \"%1\" has been restored', file.getDisplayName())\n            : qx.locale.Manager.tr('Folder \"%1\" has been restored', file.getDisplayName())\n          );\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'restored',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    'delete': function(file, callback, context) {\n      if (file.isTemporary()) {\n        // new file, no need to call the backend\n        if (callback) {\n          callback.apply(context, true);\n        }\n      } else if (file) {\n        let message;\n        if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Do you really want to clear the trash?');\n          } else if (file.isInTrash()) {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\" from the trash?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\" from the trash?', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('Do you really want to delete file \"%1\"?', file.getDisplayName())\n              : qx.locale.Manager.tr('Do you really want to delete folder \"%1\"?', file.getDisplayName());\n          }\n          qxl.dialog.Dialog.confirm(message, function (confirmed) {\n            if (confirmed) {\n              this.__doDelete(file, callback, context);\n            } else if (callback) {\n              callback.apply(context, false);\n            }\n          }, this, qx.locale.Manager.tr('Confirm deletion'));\n        }\n    },\n\n    __doDelete: function (file, callback, context) {\n      this.__fsClient.deleteSync({path: file.getFullPath(), force: file.isTrash()}, null, function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(err);\n          if (callback) {\n            callback.apply(context, false);\n          }\n        } else {\n          let message;\n          if (file.isTrash()) {\n            message = qx.locale.Manager.tr('Trash has been cleared');\n          } else if (file.isInTrash()) {\n            message = this.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been removed from trash', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been removed from trash', file.getDisplayName());\n          } else {\n            message = file.getType() === 'file'\n              ? qx.locale.Manager.tr('File \"%1\" has been deleted', file.getDisplayName())\n              : qx.locale.Manager.tr('Folder \"%1\" has been deleted', file.getDisplayName());\n          }\n          cv.ui.manager.snackbar.Controller.info(message);\n          if (callback) {\n            callback.apply(context, true);\n          }\n          qx.event.message.Bus.dispatchByName('cv.manager.file', {\n            action: 'deleted',\n            path: file.getFullPath()\n          });\n        }\n      }, this);\n    },\n\n    download: function (file) {\n      if (file.getType() === 'file') {\n        const element = document.createElement('a');\n        element.setAttribute('href', cv.io.rest.Client.getBaseUrl() + '/fs?download=true&path=' + file.getFullPath());\n        element.style.display = 'none';\n        document.body.appendChild(element);\n        element.click();\n        document.body.removeChild(element);\n      }\n    },\n\n    validate: function (file) {\n      if (qx.core.Environment.get('qx.debug')) {\n        qx.core.Assert.assertInstance(file, cv.ui.manager.model.FileItem);\n      }\n      if (file.isConfigFile()) {\n        this.__validateConfig(file);\n      } else {\n        this.info('no validation available for file: ' + file.getFullPath());\n      }\n    },\n\n    __validateConfig: function (file) {\n      const d = qxl.dialog.Dialog.alert(qx.locale.Manager.tr('Validating %1', file.getFullPath()));\n      cv.ui.manager.editor.Worker.getInstance().validateConfig(file).then(function (res) {\n        d.close();\n        if (res === true) {\n          file.setValid(true);\n          cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('%1 has no errors!', file.getFullPath()));\n        } else {\n          file.setValid(false);\n          qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n            file: file,\n            handler: 'cv.ui.manager.editor.Source',\n            handlerOptions: {\n              jumpToError: true\n            }\n          });\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.trn(\n            '%1 error found in %2!',\n            '%1 errors found in %2!',\n            res.length,\n            res.length,\n            file.getFullPath())\n          );\n        }\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__fsClient = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.dialog.Prompt', {\n  extend: qxl.dialog.Prompt,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _createWidgetContent: function() {\n      this.base(arguments);\n      this._textField.setLiveUpdate(true);\n    }\n  }\n});\n","/**\n * Main toolbar on top.\n */\nqx.Class.define('cv.ui.manager.MenuBar', {\n  extend: qx.ui.menubar.MenuBar,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this.__buttons = {};\n\n    this._draw();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _commandGroup: null,\n    __buttons: null,\n    __defaultButtonConfiguration: null,\n    __buttonConfiguration: null,\n\n    _draw: function () {\n      this._createChildControl('file');\n      this._createChildControl('edit');\n      this._createChildControl('preferences');\n      this.add(new qx.ui.core.Spacer(), {flex: 1});\n\n      this._createChildControl('title');\n      this.add(new qx.ui.core.Spacer(), {flex: 1});\n      this._createChildControl('help');\n\n      const editorGroup = new qx.ui.form.RadioGroup();\n\n      this.__defaultButtonConfiguration = {\n        'new-file': {\n          menu: 'new-menu',\n          args: [this.tr('New file'), cv.theme.dark.Images.getIcon('new-file', 18), this._commandGroup.get('new-file')],\n          enabled: true\n        },\n        'new-folder': {\n          menu: 'new-menu',\n          args: [this.tr('New folder'), cv.theme.dark.Images.getIcon('new-folder', 18), this._commandGroup.get('new-folder')],\n          enabled: true,\n          separator: 'after'\n        },\n        'new-config-file': {\n          menu: 'new-menu',\n          args: [this.tr('New config file')],\n          enabled: true\n        },\n        'upload': {\n          menu: 'file-menu',\n          clazz: com.zenesis.qx.upload.UploadMenuButton,\n          args: [this.tr('Upload file'), cv.theme.dark.Images.getIcon('upload', 18)],\n          enabled: true,\n          separator: 'before'\n        },\n        'save': {\n          menu: 'file-menu',\n          args: [this.tr('Save'), cv.theme.dark.Images.getIcon('save', 18), this._commandGroup.get('save')],\n          enabled: false,\n          separator: 'before'\n        },\n        'save-as': {\n          menu: 'file-menu',\n          args: [this.tr('Save as...'), null, this._commandGroup.get('save-as')],\n          enabled: false\n        },\n        'delete': {\n          args: [this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18), this._commandGroup.get('delete')],\n          enabled: false,\n          hidden: true\n        },\n        'quit': {\n          menu: 'file-menu',\n          args: [this.tr('Quit'), cv.theme.dark.Images.getIcon('quit', 18), this._commandGroup.get('quit')],\n          enabled: true,\n          separator: 'before'\n        },\n        // edit menu basics\n        'undo': {\n          menu: 'edit-menu',\n          args: [this.tr('Undo'), cv.theme.dark.Images.getIcon('undo', 18), this._commandGroup.get('undo')],\n          enabled: true\n        },\n        'redo': {\n          menu: 'edit-menu',\n          args: [this.tr('Redo'), cv.theme.dark.Images.getIcon('redo', 18), this._commandGroup.get('redo')],\n          enabled: true\n        },\n        'cut': {\n          menu: 'edit-menu',\n          args: [this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18), this._commandGroup.get('cut')],\n          enabled: false,\n          separator: 'before'\n        },\n        'copy': {\n          menu: 'edit-menu',\n          args: [this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18), this._commandGroup.get('copy')],\n          enabled: false\n        },\n        'paste': {\n          menu: 'edit-menu',\n          args: [this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18), this._commandGroup.get('paste')],\n          enabled: false\n        },\n        // preferences\n        'source-editor': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.RadioButton,\n          args: [this.tr('Use text editor')],\n          general: true,\n          enabled: true,\n          properties: {\n            model: 'source',\n            group: editorGroup\n          }\n        },\n        'xml-editor': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.RadioButton,\n          args: [this.tr('Use xml editor')],\n          general: true,\n          enabled: true,\n          properties: {\n            model: 'xml',\n            group: editorGroup\n          }\n        },\n        'quick-preview': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.CheckBox,\n          args: [this.tr('Enable quick preview')],\n          general: true,\n          enabled: true,\n          separator: 'before'\n        },\n        'expert-mode': {\n          menu: 'preferences-menu',\n          clazz: qx.ui.menu.CheckBox,\n          args: [this.tr('Expert mode')],\n          general: true,\n          enabled: true\n        },\n        'help': {\n          menu: 'help-menu',\n          args: [this.tr('Help'), cv.theme.dark.Images.getIcon('help', 18), this._commandGroup.get('help')],\n          enabled: false\n        },\n        'about': {\n          menu: 'help-menu',\n          args: [this.tr('About')],\n          enabled: false\n        }\n      };\n      this.maintainButtons();\n\n      const prefs = cv.ui.manager.model.Preferences.getInstance();\n\n      prefs.bind('defaultConfigEditor', editorGroup, 'modelSelection', {\n        converter: function (value) {\n          return [value];\n        }\n      });\n      editorGroup.getModelSelection().addListener('change', function () {\n        prefs.setDefaultConfigEditor(editorGroup.getModelSelection().getItem(0));\n      }, this);\n\n      this.__bindToPreference('quick-preview', 'quickPreview');\n      this.__bindToPreference('expert-mode', 'expertMode');\n    },\n\n    __bindToPreference: function (buttonName, preferenceName) {\n      const button = this.getButton(buttonName);\n      const prefs = cv.ui.manager.model.Preferences.getInstance();\n      prefs.bind(preferenceName, button, 'value');\n      button.bind('value', prefs, preferenceName);\n    },\n\n    maintainButtons: function (config) {\n      if (!config) {\n        config = this.__defaultButtonConfiguration;\n      } else {\n        config = Object.merge(this.__defaultButtonConfiguration, config);\n        this.__buttonConfiguration = config;\n      }\n      Object.keys(config).forEach(function (id) {\n        let button;\n        const buttonConf = config[id];\n        if (!Object.prototype.hasOwnProperty.call(this.__buttons, id)) {\n          // create button\n          const label = buttonConf.args[0];\n          const icon = buttonConf.args[1];\n          const command = buttonConf.args[2];\n          const ButtonClass = buttonConf.clazz || qx.ui.menu.Button;\n          if (qx.lang.Type.isString(command) || !command) {\n            // no command connected\n            button = new ButtonClass(label, icon);\n            if (command) {\n              // just add the string as shortcut hint\n              button.getChildControl('shortcut').setValue(command);\n            }\n          } else {\n            button = new ButtonClass(label, icon, command);\n            if (qx.core.Environment.get('qx.command.bindEnabled')) {\n              button.bind('enabled', command, 'enabled');\n            }\n          }\n          button.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.' + id);\n          }, this);\n          if (!buttonConf.hidden) {\n            const menu = this.getChildControl(buttonConf.menu);\n            if (!menu) {\n              throw new Error('no menu named ' + buttonConf.menu + ' found!');\n            }\n            if (buttonConf.separator === 'before') {\n              menu.add(new qx.ui.menu.Separator());\n            }\n            menu.add(button);\n            if (buttonConf.separator === 'after') {\n              menu.add(new qx.ui.menu.Separator());\n            }\n          }\n          this.__buttons[id] = button;\n\n          if (Object.prototype.hasOwnProperty.call(buttonConf, 'onAfterCreate')) {\n            buttonConf.onAfterCreate(button);\n          }\n        } else {\n          button = this.__buttons[id];\n        }\n        button.setEnabled(buttonConf.enabled);\n        if (buttonConf.properties) {\n          button.set(buttonConf.properties);\n        }\n      }, this);\n    },\n\n    getButton: function (id) {\n      return this.__buttons[id];\n    },\n\n    getButtonConfiguration: function () {\n      return this.__buttonConfiguration || this.__defaultButtonConfiguration;\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'title':\n           control = new qx.ui.basic.Label(this.tr('CometVisu Manager'));\n           this.add(control);\n           break;\n\n         case 'file':\n           control = new qx.ui.menubar.Button(this.tr('File'), null, this.getChildControl('file-menu'));\n           this.add(control);\n           break;\n\n         case 'edit':\n           control = new qx.ui.menubar.Button(this.tr('Edit'), null, this.getChildControl('edit-menu'));\n           this.add(control);\n           break;\n\n         case 'help':\n           control = new qx.ui.menubar.Button(this.tr('Help'), null, this.getChildControl('help-menu'));\n           this.add(control);\n           break;\n\n         case 'about':\n           control = new qx.ui.menubar.Button(this.tr('About'), null, this.getChildControl('help-menu'));\n           this.add(control);\n           break;\n\n         case 'new':\n           control = new qx.ui.menu.Button(this.tr('New'), null, null, this.getChildControl('new-menu'));\n           break;\n\n         case 'preferences':\n           control = new qx.ui.menubar.Button(this.tr('Preferences'), null, this.getChildControl('preferences-menu'));\n           this.add(control);\n           break;\n\n         case 'new-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'file-menu':\n           control = new qx.ui.menu.Menu();\n           control.add(this.getChildControl('new'));\n           break;\n\n         case 'edit-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'preferences-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'help-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n  }\n});\n","/**\n * Extend {com.zenesis.qx.upload.UploadMgr} to allow files to e uploaded via HTML5 drop\n */\nqx.Class.define('cv.ui.manager.upload.UploadMgr', {\n  extend : com.zenesis.qx.upload.UploadMgr,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (widget, uploadUrl) {\n    this.base(arguments, widget, uploadUrl);\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    LAST_ID: 0\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    multiple: {\n      refine: true,\n      init: false\n    },\n\n    folder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_updateUploadUrl'\n    },\n\n    filename: {\n      check: 'String',\n      nullable: true\n    },\n\n    force: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  members : {\n\n    _updateUploadUrl: function () {\n      const folder = this.getFolder();\n      const path = folder ? folder.getFullPath() : '.';\n      const url = cv.io.rest.Client.getBaseUrl() + '/fs?type=file&path=' + path;\n      this.setUploadUrl(url);\n    },\n\n    _init: function () {\n      this.addListener('addFile', function(evt) {\n        const file = evt.getData();\n        const filename = this.getFilename();\n        if (filename) {\n          file.setParam('filename', filename);\n        }\n        if (this.isForce()) {\n          file.setParam('force', true);\n        }\n        const progressListenerId = file.addListener('changeProgress', function (evt) {\n          const file = evt.getTarget();\n          const uploadedSize = evt.getData();\n\n          this.debug('Upload ' + file.getFilename() + ': ' +\n            uploadedSize + ' / ' + file.getSize() + ' - ' +\n            Math.round(uploadedSize / file.getSize() * 100) + '%');\n        }, this);\n\n        const stateListenerId = file.addListener('changeState', function (evt) {\n          const state = evt.getData();\n          const file = evt.getTarget();\n\n          if (state === 'uploading') {\n            this.debug(file.getFilename() + ' (Uploading...)');\n          } else if (state === 'uploaded') {\n            this.debug(file.getFilename() + ' (Complete)');\n            if (file.getStatus() !== 200) {\n              // something went wrong\n              switch (file.getStatus()) {\n                case 406:\n                  if (this.isForce()) {\n                    cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Replacing the file failed.'));\n                  } else {\n                    qxl.dialog.Dialog.confirm(qx.locale.Manager.tr('This file already exists, do you want to replace it?'), function (confirmed) {\n                      if (confirmed) {\n                        this.forceUpload(file);\n                      }\n                    }, this, qx.locale.Manager.tr('File already exists'));\n                  }\n                  break;\n\n                case 403:\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Uploading this file is not allowed here.'));\n                  break;\n\n                default: {\n                  let err = file.getResponse();\n                  try {\n                    err = qx.lang.Json.parse(err).message;\n                  } catch (e) {\n                  }\n                  this.error(err);\n                  cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('File upload stopped with an error: %1', err));\n                  break;\n                }\n              }\n            } else {\n              cv.ui.manager.snackbar.Controller.info(qx.locale.Manager.tr('File has been uploaded'));\n              qx.event.message.Bus.dispatchByName('cv.manager.file', {\n                action: 'uploaded',\n                path: this.getFolder().getFullPath() + '/' + file.getFilename()\n              });\n            }\n          } else if (state === 'cancelled') {\n            this.debug(file.getFilename() + ' (Cancelled)');\n          }\n          // Remove the listeners\n          if (state === 'uploaded' || state === 'cancelled') {\n            file.removeListenerById(progressListenerId);\n            file.removeListenerById(stateListenerId);\n          }\n        }, this);\n      }, this);\n    },\n\n    /**\n     * Allocates a unique ID\n     *\n     * @return {Number}\n     */\n    _getUniqueFileId: function() {\n      return ++cv.ui.manager.upload.UploadMgr.LAST_ID;\n    },\n\n    /**\n     * Re-upload a file in forced mode\n     * @param file {com.zenesis.qx.upload.File}\n     */\n    forceUpload: function (file) {\n      this.setForce(true);\n      const newFile = new com.zenesis.qx.upload.File(file.getBrowserObject(), file.getFilename(), file.getId());\n      newFile.set({\n        size: file.getSize(),\n        uploadWidget: file.getUploadWidget()\n      });\n      newFile.setParam('force', true);\n      this.getUploadHandler()._addFile(newFile);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    },\n\n    /**\n     * Upload file directly to the backend\n     *\n     * @param bomFile {File}\n     */\n    uploadFile: function(bomFile) {\n      const id = 'upload-' + this._getUniqueFileId();\n      const filename = typeof bomFile.name !== 'undefined' ? bomFile.name : bomFile.fileName;\n      const file = new com.zenesis.qx.upload.File(bomFile, filename, id);\n      const fileSize = typeof bomFile.size !== 'undefined' ? bomFile.size : bomFile.fileSize;\n      file.setSize(fileSize);\n      if (this.isForce()) {\n        file.setParam('force', true);\n      }\n      file.setUploadWidget(new com.zenesis.qx.upload.UploadButton());\n\n      this.getUploadHandler()._addFile(file);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    },\n\n    /**\n     * Replace content of existing file with the upload\n     * @param bomFile {File}\n     * @param replacedFile {cv.ui.manager.model.FileItem}\n     */\n    replaceFile: function(bomFile, replacedFile) {\n      this.setFolder(replacedFile.getParent());\n      const id = 'upload-' + this._getUniqueFileId();\n      const filename = replacedFile.getName();\n      const file = new com.zenesis.qx.upload.File(bomFile, filename, id);\n      file.setParam('force', true);\n      file.setParam('filename', filename);\n      const fileSize = typeof bomFile.size !== 'undefined' ? bomFile.size : bomFile.fileSize;\n      file.setSize(fileSize);\n      file.setUploadWidget(new com.zenesis.qx.upload.UploadButton());\n\n      this.getUploadHandler()._addFile(file);\n      if (this.getAutoUpload()) {\n        this.getUploadHandler().beginUploads();\n      }\n    }\n  }\n});\n","/**\n * Add upload via drag&drop feature to this widget. The including widget must have a\n * \"upload-dropbox\" childcontrol or add\n *  <pre class=\"javascript\">\n *   if (!control) {\n        control = this._createMDragUploadChildControlImpl(id);\n      }\n *   </pre>\n *   to their own _createChildControlImpl method\n */\nqx.Mixin.define('cv.ui.manager.upload.MDragUpload', {\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n  construct : function() {\n    this.setDroppable(true);\n    if (this.getBounds()) {\n      this._applyStartDragListeners();\n    } else {\n      this.addListenerOnce('appear', function() {\n        this._applyStartDragListeners();\n      }, this);\n    }\n    const layout = this._getLayout();\n    if (!(layout instanceof qx.ui.layout.Grow) && !(layout instanceof qx.ui.layout.Canvas)) {\n      this.addListener('resize', this.__syncBounds, this);\n    }\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n  properties : {\n    uploadMode: {\n      check: 'Boolean',\n      init: false,\n      apply: '__applyUploadMode'\n    },\n\n    uploadHint: {\n      check: 'String',\n      init: ''\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Handles HTML5 drop events (dropping external files on dom element)\n     * @param ev {Event}\n     */\n    onHtml5Drop : function (ev) {\n      ev.preventDefault();\n      this.getFiles(ev).forEach(this.uploadFile, this);\n    },\n\n    /**\n     * Uploads the dropped file to the correct folder:\n     * - config files to the resources/config folder\n     * - accepted media files to the resources/config/media folder\n     * @param file {File}\n     * @param replaceFile {cv.ui.manager.model.FileItem?} optional, if set this files content gets replaced with the uploaded ones\n     */\n    uploadFile: function (file, replaceFile) {\n      const isConfig = cv.ui.manager.model.FileItem.isConfigFile(file.name);\n\n      let folder;\n      if (isConfig) {\n        // upload to root folder\n        folder = new cv.ui.manager.model.FileItem('.');\n      } else if (cv.ui.manager.tree.FileSystem.isAccepted(file.type)) {\n        // upload to media folder\n        folder = new cv.ui.manager.model.FileItem('media');\n      }\n      if (folder) {\n        folder.set({\n          type: 'dir'\n        });\n        const manager = new cv.ui.manager.upload.UploadMgr();\n        if (replaceFile) {\n          manager.replaceFile(file, replaceFile);\n        } else {\n          manager.setFolder(folder);\n          manager.uploadFile(file);\n        }\n      }\n    },\n\n    hasDroppableFile: function (ev) {\n      return this.getFiles(ev).length > 0;\n    },\n\n    /**\n     * Extracts acceptable files from event\n     * @param ev {Event}\n     * @private\n     */\n    getFiles: function (ev) {\n      const files = [];\n      let i;\n      let l;\n      let file;\n\n      if (ev.dataTransfer.items) {\n        // Use DataTransferItemList interface to access the file(s)\n        for (i = 0, l = ev.dataTransfer.items.length; i < l; i++) {\n          // If dropped items aren't files, reject them\n          const item = ev.dataTransfer.items[i];\n          if (item.kind === 'file' && cv.ui.manager.tree.FileSystem.isAccepted(item.type)) {\n            file = item.getAsFile();\n            files.push(file);\n          }\n        }\n      } else {\n        for (i = 0, l = ev.dataTransfer.files.length; i < l; i++) {\n          file = ev.dataTransfer.files[i];\n          if (cv.ui.manager.tree.FileSystem.isAccepted(file.type)) {\n            files.push(file);\n          }\n        }\n      }\n      return files;\n    }\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n  members : {\n    __hasEmptyInfo: null,\n    _boundOnStop: null,\n\n    __syncBounds: function () {\n      const bounds = this.getBounds();\n      this.getChildControl('upload-overlay').setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n      this.getChildControl('upload-dropbox').setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n    },\n\n    // overridden\n    _createMDragUploadChildControlImpl: function(id) {\n      let control;\n      const bounds = this.getBounds();\n      const layout = this._getLayout();\n\n      switch (id) {\n        case 'upload-overlay':\n          control = new qx.ui.container.Composite();\n          control.setZIndex(1000000);\n          control.exclude();\n          if (layout instanceof qx.ui.layout.Canvas) {\n            this._add(control, {edge: 0});\n          } else if (!(this._getLayout() instanceof qx.ui.layout.Grow) && bounds) {\n            control.setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n          }\n          this._add(control);\n          this.getChildControl('upload-dropbox').bind('visibility', control, 'visibility');\n          break;\n\n        case 'upload-dropbox': {\n          control = new qx.ui.container.Composite(new qx.ui.layout.Grow());\n          control.setBackgroundColor('rgba(32, 32, 32, 0.9)');\n          control.setZIndex(1000);\n          const dropBox = new qx.ui.basic.Atom(this.getUploadHint(), cv.theme.dark.Images.getIcon('upload', 32));\n          dropBox.set({\n            iconPosition: 'top',\n            rich: true,\n            center: true\n          });\n          // control.bind('width', dropBox, 'maxWidth');\n          dropBox.getChildControl('label').setWrap(true);\n          control.setAnonymous(true);\n          control.add(dropBox);\n          control.exclude();\n          if (layout instanceof qx.ui.layout.Canvas) {\n            this._add(control, {edge: 0});\n          } else if (!(this._getLayout() instanceof qx.ui.layout.Grow) && bounds) {\n            control.setUserBounds(bounds.left, bounds.top, bounds.width, bounds.height);\n          }\n          this._add(control);\n          break;\n        }\n      }\n      return control;\n    },\n\n    _onStopDragging: function(ev) {\n      ev.preventDefault();\n      this.setUploadMode(false);\n      document.removeEventListener('dragend', this._boundOnStop, false);\n    },\n\n    /**\n     * Apply dragover/-leave listeners to the dashboard to recognize File uploads via Drag&Drop\n     */\n    _applyStartDragListeners: function() {\n      // add the start listener to this widget\n      this.getContentElement().getDomElement().addEventListener('dragenter', function(ev) {\n        // ev.preventDefault();\n        if (this._isDroppable) {\n          if (this._isDroppable(ev.dataTransfer.items)) {\n            // we have something to drop\n            this.setUploadMode(true);\n          }\n        } else if (cv.ui.manager.upload.MDragUpload.hasDroppableFile(ev)) {\n          // we have something to drop\n          this.setUploadMode(true);\n        }\n      }.bind(this), false);\n      if (this.getChildControl('upload-overlay').getBounds()) {\n        this._applyDragListeners();\n      } else {\n        this.getChildControl('upload-overlay').addListenerOnce('appear', function() {\n          this._applyDragListeners();\n        }, this);\n      }\n    },\n\n    /**\n     * Apply dragover/-leave listeners to the dashboard to recognize File uploads via Drag&Drop\n     */\n    _applyDragListeners: function() {\n      const element = this.getChildControl('upload-overlay').getContentElement().getDomElement();\n      if (!element) {\n        const lid = this.getChildControl('upload-overlay').addListener('visibility', function (ev) {\n          if (ev.getData() === 'visible') {\n            this._applyDragListeners();\n            this.getChildControl('upload-overlay').removeListenerById(lid);\n          }\n        }, this);\n        return;\n      }\n      element.addEventListener('dragexit', function() {\n        this.setUploadMode(false);\n      }.bind(this), false);\n\n      element.addEventListener('dragover', function (ev) {\n        ev.preventDefault();\n        let uploadable = false;\n        if (this._isDroppable) {\n          uploadable = this._isDroppable(ev.dataTransfer.items);\n        } else if (cv.ui.manager.upload.MDragUpload.hasDroppableFile(ev)) {\n          uploadable = true;\n        }\n        this.setUploadMode(uploadable);\n      }.bind(this), false);\n\n      this._boundOnStop = this._onStopDragging.bind(this);\n\n      element.addEventListener('dragleave', this._boundOnStop, false);\n      element.addEventListener('dragend', function() {\n        this.setUploadMode(false);\n      }.bind(this), false);\n\n      document.addEventListener('dragend', this._boundOnStop, false);\n\n      if (this._onDrop) {\n        element.addEventListener('drop', this._onDrop.bind(this), false);\n      } else {\n        element.addEventListener('drop', function (ev) {\n          cv.ui.manager.upload.MDragUpload.onHtml5Drop(ev);\n          this._onStopDragging(ev);\n        }.bind(this), false);\n      }\n    },\n\n    // property apply\n    __applyUploadMode: function(value) {\n      if (value === true) {\n        this.getChildControl('upload-dropbox').show();\n        if (this.hasChildControl('empty-info') && this.getChildControl('empty-info').isVisible()) {\n          this.getChildControl('empty-info').exclude();\n          this.__hasEmptyInfo = true;\n        } else {\n          this.__hasEmptyInfo = false;\n        }\n      } else {\n        this.getChildControl('upload-dropbox').exclude();\n        if (this.__hasEmptyInfo === true) {\n          this.getChildControl('empty-info').show();\n        }\n      }\n    }\n  }\n});\n","/**\n * Shows filesystem content in a tree.\n */\nqx.Class.define('cv.ui.manager.tree.FileSystem', {\n  extend: qx.ui.core.Widget,\n  include: [\n    cv.ui.manager.upload.MDragUpload\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (rootFolder) {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this.setRootFolder(rootFolder);\n\n    qx.event.message.Bus.subscribe('cv.manager.tree.enable', this._onEnableTree, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    MIMETYPES: {\n      'text/xml': 'xml',\n      'application/xml': 'xml',\n      'text/javascript': 'js',\n      'application/x-httpd-php': 'php',\n      'text/css': 'css',\n      'image/png': 'png',\n      'image/svg+xml': 'svg',\n      'text/plain': ''\n    },\n\n    getMimetypeFromSuffix: function (suffix) {\n      return Object.keys(this.MIMETYPES).find(function (mime) {\n        return this.MIMETYPES[mime] === suffix;\n      }, this);\n    },\n\n    isAccepted: function (mimetype) {\n      return Object.prototype.hasOwnProperty.call(this.MIMETYPES, mimetype);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'changeSelection': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    // appearance: {\n    //   refine: true,\n    //   init: 'cv-filesystem'\n    // },\n\n    rootFolder: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_applyRootFolder'\n    },\n\n    selectedNode: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_applySelectedNode',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __selectionTimer: null,\n    __doubleTapWaitingTime: 500,\n    __ignoreSelectionChange: false,\n    _replacementManager: null,\n\n    reload: function () {\n      const tree = this.getChildControl('tree');\n      const openPaths = tree.getOpenNodes().map(function (node) {\n        return node.getFullPath();\n      });\n      const root = tree.getModel();\n      root.reload(function () {\n        this.getChildControl('tree').refresh();\n        root.setOpen(true);\n        openPaths.forEach(this.openPath, this);\n      }, this);\n    },\n\n    openPath: function (path) {\n      const root = this.getChildControl('tree').getModel();\n      if (path === '.') {\n        root.setOpen(true);\n      } else {\n        root.setOpen(true);\n        root.openPath(path);\n      }\n    },\n\n    refresh: function () {\n      this.getChildControl('tree').refresh();\n    },\n\n    _applyRootFolder: function (value) {\n      if (value) {\n        const tree = this.getChildControl('tree');\n        tree.setModel(value);\n        value.load(function () {\n          tree.setHideRoot(true);\n        }, this);\n      }\n    },\n\n    _applySelectedNode: function (value) {\n      const tree = this.getChildControl('tree');\n      const contextMenu = cv.ui.manager.contextmenu.GlobalFileItem.getInstance();\n      contextMenu.configure(value);\n      if (value) {\n        tree.setContextMenu(contextMenu);\n      }\n    },\n\n    setSelection : function (node) {\n      this.getChildControl('tree').getSelection().replace([node]);\n    },\n\n    _onDblTapTreeSelection: function () {\n      const sel = this.getSelectedNode();\n      if (sel) {\n        if (this.__selectionTimer) {\n          this.__selectionTimer.stop();\n        }\n        // only files show a different behaviour when double-clicked (permanent vs. preview mode)\n        if (sel.getType() === 'file') {\n          this.fireDataEvent('changeSelection', {\n            'node': sel,\n            'mode': 'dbltap'\n          });\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function () {\n      if (this.__selectionTimer) {\n        this.__selectionTimer.stop();\n      }\n      if (this.__ignoreSelectionChange === true) {\n        return;\n      }\n      const tree = this.getChildControl('tree');\n      const sel = tree.getSelection();\n      if (sel.length > 0) {\n        const node = sel.getItem(0);\n        this.setSelectedNode(node);\n        // wait for double tap\n        if (node.getType() === 'file') {\n          this.__selectionTimer = qx.event.Timer.once(function () {\n            this.fireDataEvent('changeSelection', {\n              'node': this.getSelectedNode(),\n              'mode': 'tap'\n            });\n            this.__selectionTimer = null;\n          }, this, this.__doubleTapWaitingTime);\n        } else {\n          this.fireDataEvent('changeSelection', {\n            'node': node,\n            'mode': 'tap'\n          });\n        }\n      } else {\n        tree.resetContextMenu();\n        this.resetSelectedNode();\n      }\n    },\n\n    _onFsItemRightClick: function (ev) {\n      const tree = this.getChildControl('tree');\n      const widget = ev.getTarget();\n      if (widget instanceof cv.ui.manager.tree.VirtualFsItem) {\n        const node = widget.getModel();\n        if (node) {\n          this.__ignoreSelectionChange = true;\n          tree.getSelection().replace([node]);\n          this.setSelectedNode(node);\n          this.fireDataEvent('changeSelection', {\n            'node': node,\n            'mode': 'contextmenu'\n          });\n          this.__ignoreSelectionChange = false;\n        }\n      }\n    },\n\n    /**\n     * Handle message on 'cv.manager.tree.enable' topic.\n     * @param ev {Event}\n     * @protected\n     */\n    _onEnableTree: function (ev) {\n      this.getChildControl('tree').setEnabled(ev.getData());\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'name', 'children');\n           control.set({\n             selectionMode: 'single',\n             minWidth: 250,\n             showTopLevelOpenCloseIcons: true\n           });\n           cv.ui.manager.model.Preferences.getInstance().bind('quickPreview', control, 'openMode', {\n             converter: function (value) {\n               return value ? 'tap' : 'dbltap';\n             }\n           });\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualFsItem();\n               item.addListener('dbltap', this._onDblTapTreeSelection, this);\n               item.addListener('contextmenu', this._onFsItemRightClick, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem : function(controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('readable', 'enabled', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('editing', 'editing', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this._add(control);\n           break;\n       }\n\n       if (!control) {\n         control = this._createMDragUploadChildControlImpl(id);\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    qx.event.message.Bus.unsubscribe('cv.manager.tree.enable', this._onEnableTree, this);\n\n    this._disposeObjects('_dateFormat', '_timeFormat', '_replacementManager');\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.ToolBar', {\n  extend: qx.ui.toolbar.ToolBar,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (uploadManager, showOnly) {\n    this.base(arguments);\n\n    if (showOnly) {\n      this.__showOnly = showOnly;\n    }\n\n    this._menuBar = cv.ui.manager.MenuBar.getInstance();\n    this._menuButtonConfig = this._menuBar.getButtonConfiguration();\n    this._uploadManager = uploadManager;\n\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'reload': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-toolbar'\n    },\n\n    folder: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFolder',\n      event: 'changeFolder'\n    },\n\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFile',\n      event: 'changeFile'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _menuButtonConfig: null,\n    _uploadManager: null,\n    _menuBar: null,\n    __showOnly: null,\n\n    __show: function (name) {\n      return this.__showOnly === null || this.__showOnly.includes(name);\n    },\n\n    _init: function () {\n      if (!this._uploadManager) {\n        this._uploadManager = new cv.ui.manager.upload.UploadMgr();\n      }\n\n      const fileController = cv.ui.manager.control.FileController.getInstance();\n\n      const createPart = new qx.ui.toolbar.Part();\n      createPart.set({\n        marginLeft: 0\n      });\n      this.add(createPart);\n      let newButton;\n\n      if (this.__show('new-menu')) {\n        newButton = new qx.ui.toolbar.MenuButton(null,\n          cv.theme.dark.Images.getIcon('new-file', 15),\n          this._menuBar.getChildControl('new-menu')\n        );\n        this.bind('folder.writeable', newButton, 'enabled');\n        createPart.add(newButton);\n      } else {\n        if (this.__show('new-config-file')) {\n          newButton = this._createButton('new-config-file', cv.theme.dark.Images.getIcon('new-file', 15));\n          this.bind('folder.writeable', newButton, 'enabled');\n          this.bind('folder', newButton, 'visibility', {\n            converter: function (folder) {\n              return folder === cv.ui.manager.model.FileItem.ROOT ? 'visible' : 'excluded';\n            }\n          });\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-config-file', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        } else if (this.__show('new-file')) {\n          newButton = this._createButton('new-file', null, true);\n          this.bind('folder.writeable', newButton, 'enabled');\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-file', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        }\n        if (this.__show('new-folder')) {\n          newButton = this._createButton('new-folder', cv.theme.dark.Images.getIcon('new-folder', 15), true);\n          this.bind('folder.writeable', newButton, 'enabled');\n          newButton.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.action.new-folder', this.getFolder());\n          }, this);\n          createPart.add(newButton);\n        }\n      }\n\n      if (this.__show('upload')) {\n        const upload = this._createButton('upload');\n        this._uploadManager.addWidget(upload);\n        this.bind('folder.writeable', upload, 'enabled');\n        createPart.add(upload);\n      }\n\n      if (this.__show('delete')) {\n        const deleteSelection = this._createButton('delete');\n        deleteSelection.addListener('execute', function () {\n          fileController.delete(this.getFile());\n        }, this);\n        this.bind('file', deleteSelection, 'enabled', {\n          converter: function (file) {\n            return !!file && file.isWriteable() && !file.isFake();\n          }\n        });\n        this.add(deleteSelection);\n      }\n\n      if (this.__show('download')) {\n        const download = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('download', 15));\n        download.setAppearance('cv-toolbar-button');\n        download.setToolTipText(qx.locale.Manager.tr('Download'));\n        download.addListener('execute', function () {\n          fileController.download(this.getFile());\n        }, this);\n        // download button is only enabled when a file is selected\n        this.bind('file', download, 'enabled', {\n          converter: function (file) {\n            return !!file && file.getType() === 'file' && !file.isFake();\n          }\n        });\n        createPart.add(download);\n      }\n\n      if (this.__show('validate')) {\n        // config check\n        const checkConfig = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('validate', 15));\n        checkConfig.setAppearance('cv-toolbar-button');\n        checkConfig.setToolTipText(qx.locale.Manager.tr('Validate'));\n        checkConfig.addListener('execute', function () {\n          fileController.validate(this.getFile());\n        }, this);\n\n        // validate button is only enabled when a file is selected\n        this.bind('file', checkConfig, 'enabled', {\n          converter: function (file) {\n            return !!file && file.isConfigFile();\n          }\n        });\n        this.add(checkConfig);\n      }\n\n      if (this.__show('reload')) {\n        const reload = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 15));\n        reload.setAppearance('cv-toolbar-button');\n        reload.setToolTipText(qx.locale.Manager.tr('Reload'));\n        reload.addListener('execute', function () {\n          this.fireEvent('reload');\n        }, this);\n        this.add(new qx.ui.core.Spacer(), {flex: 1});\n        this.add(reload);\n      }\n    },\n\n    _createButton: function (name, icon, doNotUseCommand) {\n      const args = this._menuButtonConfig[name].args;\n      const button = new qx.ui.toolbar.Button(null, icon || args[1].replace(/\\/[0-9]+$/, '/15'), !doNotUseCommand ? args[2] : null);\n      button.setAppearance('cv-toolbar-button');\n      button.setToolTipText(args[0]);\n      return button;\n    },\n\n    _applyFile: function () {\n\n    },\n\n    _applyFolder: function (value) {\n      if (this._uploadManager) {\n        if (value) {\n          this._uploadManager.setFolder(value);\n        } else {\n          this._uploadManager.resetFolder();\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._menuButtonConfig = null;\n    this._uploadManager = null;\n    this.__menuBar = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.FileTabItem', {\n  extend: qx.ui.core.Widget,\n  implement : [qx.ui.form.IModel],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox());\n    this._createChildControl('icon');\n    this._createChildControl('label');\n    this._createChildControl('close');\n\n    this.addListener('pointerover', this._onPointerOver, this);\n    this.addListener('pointerout', this._onPointerOut, this);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'close': 'qx.event.type.Data',\n\n    /** (Fired by {@link qx.ui.form.List}) */\n    'action' : 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'open-file-item'\n    },\n\n    model: {\n      nullable: true,\n      event: 'changeModel',\n      apply: '_applyModel',\n      dereference: true\n    },\n\n    label: {\n      check: 'String',\n      nullable: true,\n      transform: '_transformFilename',\n      event: 'changeLabel',\n      apply: '_applyLabel'\n    },\n\n    icon: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyIcon'\n    },\n\n    permanent: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyPermanent'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyLabel'\n    },\n\n    closeable: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyCloseable'\n    },\n\n    writeable:{\n      check: 'Boolean',\n      init: true,\n      apply: '_applyLabel'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates :\n      {\n        focused : true,\n        hovered : true,\n        selected : true,\n        dragover : true\n      },\n\n\n    /**\n     * Event handler for the pointer over event.\n     */\n    _onPointerOver : function() {\n      this.addState('hovered');\n    },\n\n    _transformFilename: function(name) {\n      if (name === '.') {\n        return '';\n      }\n      return name;\n    },\n\n    /**\n     * Event handler for the pointer out event.\n     */\n    _onPointerOut : function() {\n      this.removeState('hovered');\n    },\n\n    _applyPermanent: function (value) {\n      this.setFont(value ? 'default' : 'italic');\n    },\n\n    _applyCloseable: function (value) {\n      this.getChildControl('close').setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    _applyModel: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        value.bind('file.writeable', this, 'writeable');\n      }\n    },\n\n    _applyIcon: function (value) {\n      const control = this.getChildControl('icon');\n      control.setSource(value);\n      if (value) {\n        control.show();\n      } else {\n        control.exclude();\n      }\n    },\n\n    _applyLabel: function () {\n      const label = this.getChildControl('label');\n      const value = this.getLabel();\n      if (value) {\n        let labelValue = this.getLabel();\n        // special treatment for hidden.php which is marked as fake, but has a special editor, so it has to be marked as not writeable\n        if (!this.isWriteable() && (!this.getModel().getFile().isFake() || this.getModel().getFile().getName() === 'hidden.php')) {\n          labelValue += ' !';\n          this.setToolTipText(this.tr('This file is not writeable'));\n        } else {\n          this.resetToolTipText();\n        }\n        if (this.isModified()) {\n          labelValue += ' *';\n        }\n        label.setValue(labelValue);\n        label.show();\n      } else {\n        label.exclude();\n        this.resetToolTipText();\n      }\n    },\n\n    _onClose: function () {\n      if (this.isCloseable()) {\n        this.fireDataEvent('close', this.getModel());\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new qx.ui.basic.Image();\n           control.setAppearance('open-file-item/icon');\n           control.setAnonymous(true);\n           control.exclude();\n           this._addAt(control, 0);\n           break;\n\n         case 'label':\n           control = new qx.ui.basic.Label();\n           control.setAppearance('open-file-item/label');\n           control.setAnonymous(true);\n           this._addAt(control, 1);\n           break;\n\n         case 'close':\n           control = new qx.ui.basic.Image('decoration/tabview/close.gif');\n           control.setAppearance('open-file-item/close');\n           if (this.isCloseable()) {\n             control.addListener('tap', this._onClose, this);\n           } else {\n             control.exclude();\n           }\n           this._addAt(control, 2);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.removeListener('pointerover', this._onPointerOver, this);\n    this.removeListener('pointerout', this._onPointerOut, this);\n  }\n});\n","/**\n * A dialog that alerts the user to something.\n *\n */\nqx.Class.define('cv.ui.manager.dialog.BigAlert', {\n  extend: qxl.dialog.Alert,\n  members: {\n    _hbox: null,\n\n    _applyImage: function(value, old) {\n      if (!this._image) {\n        this._image = new qx.ui.basic.Image().set({\n          scale: true,\n          height: 32,\n          width: 32\n        });\n        this._hbox.addAt(this._image, 0);\n      }\n      this._image.setSource(value);\n      this._image.setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    /**\n     * Create the main content of the widget\n     */\n    _createWidgetContent: function() {\n      let container = this._createDialogContainer();\n      this.add(container);\n      let hbox = this._hbox = new qx.ui.container.Composite(new qx.ui.layout.HBox(10));\n      let scroll = new qx.ui.container.Scroll(hbox);\n      scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      }, this);\n      container.add(scroll);\n      hbox.bind('width', scroll, 'width');\n      hbox.bind('height', scroll, 'height');\n      const image = this.getImage();\n      if (image) {\n        this._image = new qx.ui.basic.Image(image).set({\n          scale: true,\n          height: 32,\n          width: 32\n        });\n        hbox.add(this._image);\n      }\n      this._message = new qx.ui.basic.Label();\n      this._message.setRich(true);\n      this._message.setWidth(200);\n      this._message.setAllowStretchX(true);\n      hbox.addAt(this._message, 1, {\n        flex: 1\n      });\n      let buttonPane = this._createButtonPane();\n      let okButton = this._createOkButton();\n      buttonPane.add(okButton);\n      container.add(buttonPane);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_hbox');\n  }\n});\n","/**\n * Model for Messages shown in Snackbar/Dialog (usually error, warnings or info messages).\n */\nqx.Class.define('cv.ui.manager.model.Message', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    title: {\n      check: 'String',\n      init: '',\n      event: 'changeTitle'\n    },\n\n    content: {\n      check: 'String',\n      init: '',\n      event: 'changeContent'\n    },\n\n    type: {\n      check: ['alert', 'hint', 'warning', 'error'],\n      nullable: true,\n      event: 'changeType'\n    },\n\n    sticky: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeSticky'\n    }\n  }\n});\n","/**\n * View component that shows a snackbar message.\n */\nqx.Class.define('cv.ui.manager.snackbar.Message', {\n  extend: qx.ui.core.Widget,\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox(8));\n    this.addListener('appear', this._onAppear, this);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'close': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-snackbar-msg'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.Message',\n      nullable: true,\n      apply: '_applyModel'\n    },\n\n    timeout: {\n      check: 'Number',\n      init: 5000,\n      apply: '_applyTimeout'\n    },\n\n    type: {\n      check: ['alert', 'hint', 'warning', 'error'],\n      nullable: true,\n      apply: '_applyType'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _timer: null,\n\n    _applyModel: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n        old.removeRelatedBindings(this.getChildControl('content'));\n      }\n      if (value) {\n        value.bind('title', this.getChildControl('content'), 'value');\n        value.bind('type', this, 'type');\n        value.bind('sticky', this, 'timeout', {\n          converter: function (value) {\n            return value ? 0 : 5000;\n          }\n        });\n        this.getChildControl('close');\n      }\n    },\n\n    _applyType: function (value) {\n      if (value) {\n        this.setDecorator(this.getAppearance() + '-' + value);\n      } else {\n        this.setDecorator(this.getAppearance());\n      }\n    },\n\n    _applyTimeout: function (value) {\n      if (this._timer) {\n        this._timer.stop();\n        if (value === 0) {\n          this._timer = null;\n        }\n      }\n    },\n\n    _onAppear: function () {\n      const timeout = this.getTimeout();\n      if (this._timer) {\n        this._timer.stop();\n      }\n      if (timeout > 0) {\n        this._timer = qx.event.Timer.once(this.close, this, timeout);\n      }\n    },\n\n    close: function () {\n      this.fireDataEvent('close', this.getModel());\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new qx.ui.basic.Image();\n           this._addAt(control, 0);\n           break;\n\n         case 'content':\n           control = new qx.ui.basic.Label();\n           control.set({\n             rich: true,\n             wrap: true\n           });\n           this._addAt(control, 1, {flex: 1});\n           break;\n\n         case 'close':\n           control = new qx.ui.basic.Image(cv.theme.dark.Images.getIcon('close', 15));\n           control.addListener('tap', this.close, this);\n           this._addAt(control, 2);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_timer');\n  }\n});\n","/**\n * Abstract base class for all widgets that can display file items.\n */\nqx.Class.define('cv.ui.manager.viewer.AbstractViewer', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applyFile',\n      event: 'changeFile'\n    },\n\n    /**\n     * External viewers just open the file in a new frame but to not show a new tab in the manager for the opened file\n     */\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    canHandleAction: function () {\n      return false;\n    },\n    handleAction: function () {},\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n    save: function () {},\n    getCurrentContent: function () {},\n\n    _applyFile: function (file, old) {\n      // show icon for file type\n    },\n\n    // overridden\n    _createChildControlImpl : function (id) {\n      let control;\n\n      switch (id) {\n        case 'scroll':\n          control = new qx.ui.container.Scroll();\n          this._add(control);\n          break;\n\n        case 'image':\n          control = new qx.ui.basic.Atom();\n          this.getChildControl('scroll').add(control);\n          control.getChildControl('icon').addListener('resize', this._scaleImage, this);\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  }\n});\n","// noinspection JSClosureCompilerSyntax\n/**\n * Show images.\n */\nqx.Class.define('cv.ui.manager.viewer.Image', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n\n  /*\n    ***********************************************\n      PROPERTIES\n    ***********************************************\n    */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'image-viewer'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: ['jpg', 'jpeg', 'png', 'gif', 'svg'],\n    TITLE: qx.locale.Manager.tr('Show image'),\n    ICON: cv.theme.dark.Images.getIcon('image', 18),\n\n    /**\n     * Returns size information for images\n     * @param source {String} path to image\n     * @returns {{width: *, aspectRatio: number, height: *}}\n     */\n    getImageData: function (source) {\n      let data = qx.util.ResourceManager.getInstance().getData(source);\n      if (data) {\n        return {\n          width: data[0],\n          height: data[1],\n          aspectRatio: data[0] / data[1]\n        };\n      } \n        data = qx.io.ImageLoader.getSize(source);\n        if (data && data.width && data.height) {\n          return Object.assign({\n            aspectRatio: data.width / data.height\n          }, data);\n        }\n      \n      return null;\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyFile: function (file) {\n      const control = this.getChildControl('image');\n      if (file) {\n        control.setIcon(file.getServerPath());\n        control.setLabel(file.getFullPath());\n        if (!cv.ui.manager.viewer.Image.getImageData(file.getServerPath())) {\n          control.getChildControl('icon').addListenerOnce('loaded', this._scaleImage, this);\n        } else {\n          this._scaleImage();\n        }\n        this.addListener('resize', this._scaleImage, this);\n      } else {\n        control.resetIcon();\n        control.resetLabel();\n        this.removeListener('resize', this._scaleImage, this);\n      }\n    },\n\n    _scaleImage: function () {\n      const bounds = this.getBounds();\n      if (!bounds) {\n        this.addListenerOnce('appear', this._scaleImage, this);\n        return;\n      }\n      const file = this.getFile();\n      if (!file) {\n        return;\n      }\n      const icon = this.getChildControl('image').getChildControl('icon');\n      const data = cv.ui.manager.viewer.Image.getImageData(file.getServerPath());\n      const paddingX = 10;\n      const paddingY = 20;\n      const availableHeight = bounds.height - paddingY * 2;\n      let width = bounds.width - paddingX * 2;\n      let height = Math.round(1 / data.aspectRatio * width);\n      if (height > availableHeight) {\n        height = availableHeight;\n        width = Math.round(data.aspectRatio * availableHeight);\n      }\n      icon.set({\n        width: width,\n        height: height,\n        scale: true\n      });\n    }\n  }\n});\n","/**\n * Show rendered configs.\n */\nqx.Class.define('cv.ui.manager.viewer.Config', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n  },\n\n  /*\n    ***********************************************\n      PROPERTIES\n    ***********************************************\n    */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'config-viewer'\n    },\n\n    target: {\n      check: ['iframe', 'window'],\n      init: 'window'\n    },\n\n    external: {\n      refine: true,\n      init: true\n    },\n\n    connectToWindow: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyConnectToWindow'\n    }\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Config viewer'),\n    ICON: cv.theme.dark.Images.getIcon('preview', 18)\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _windowRef: null,\n    _source: null,\n    _reloading: false,\n\n    _applyConnectToWindow: function (value) {\n      this.setExternal(!value);\n    },\n\n    _applyFile: function (file, old) {\n      if (old && old.isConfigFile()) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (file) {\n        if (file.isConfigFile()) {\n          const configName = cv.ui.manager.model.FileItem.getConfigName(file.getFullPath());\n          let url = qx.util.Uri.getAbsolute(qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/..') + '?config=' + (configName || '');\n          if (this.getTarget() === 'iframe') {\n            url += '&preview=1&libraryCheck=false';\n            const control = this.getChildControl('iframe');\n            this._source = url;\n            this.getChildControl('loading').show();\n            control.setSource(url);\n            control.show();\n            const hint = this.getChildControl('hint', true);\n            if (hint && hint.isVisible()) {\n              hint.exclude();\n            }\n          } else {\n            this._source = url;\n            let ref = window.open(url, configName);\n            if (this.isConnectToWindow()) {\n              this._windowRef = ref;\n              this._windowRef.onbeforeunload = this._onClose.bind(this);\n              const hint = this.getChildControl('hint');\n              hint.show();\n              const iframe = this.getChildControl('iframe', true);\n              if (iframe && iframe.isVisible()) {\n                iframe.exclude();\n              }\n            } else {\n              // no connection close this immediately\n              this._onClose();\n              return;\n            }\n          }\n          qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n        } else {\n          cv.ui.manager.snackbar.Controller.error(this.tr('%1 is no configuration file', file.getFullPath()));\n          this._source = null;\n        }\n      } else {\n        if (this.hasChildControl('iframe')) {\n          this.getChildControl('iframe').resetSource();\n          this.getChildControl('iframe').exclude();\n        }\n        if (this.hasChildControl('hint')) {\n          this.getChildControl('hint').exclude();\n        }\n        if (this._windowRef) {\n          this._windowRef.close();\n        }\n      }\n    },\n\n    _onChange: function (ev) {\n      const data = ev.getData();\n      if (data.type === 'contentChanged') {\n        if (this.hasChildControl('iframe')) {\n          const iframe = this.getChildControl('iframe');\n          const href = iframe.getDocument().location.href;\n          // use href to get the anchor to keep the currently opened page on reload\n          const url = href.startsWith(this._source) ? iframe.getDocument().location.href : this._source;\n          if (url && url !== 'about:blank') {\n            this._reloading = true;\n            this.getChildControl('loading').show();\n            iframe.addListenerOnce('load', () => {\n              this._reloading = false;\n              iframe.setSource(url);\n            }, this);\n          }\n          iframe.setSource('about:blank');\n        } else if (this._windowRef) {\n          this._windowRef.reload();\n        }\n      }\n    },\n\n    _onClose: function () {\n      if (this._windowRef) {\n        qx.event.message.Bus.dispatchByName('cv.manager.action.close', this.getFile());\n        this._windowRef = null;\n      }\n      this.resetFile();\n    },\n\n    openPage: function (page, path) {\n      if (this.hasChildControl('iframe')) {\n        const element = this.getChildControl('iframe').getContentElement().getDomElement();\n        if (element && element.contentWindow.cv) {\n          const otherEngine = element.contentWindow.cv.TemplateEngine.getInstance();\n          const pageId = path ? otherEngine.getPageIdByPath(page, path) : page;\n          otherEngine.scrollToPage(pageId, 0);\n        }\n      }\n    },\n\n    setHighlightWidget: function (widgetId) {\n      if (this.hasChildControl('iframe')) {\n        const element = this.getChildControl('iframe').getContentElement().getDomElement();\n        if (element && element.contentWindow.cv) {\n          const otherEngine = element.contentWindow.cv.TemplateEngine.getInstance();\n          otherEngine.setHighlightedWidget(widgetId);\n        }\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'iframe':\n           control = new qx.ui.embed.Iframe();\n           control.exclude();\n           control.addListener('load', () => {\n             if (this.hasChildControl('loading') && !this._reloading) {\n               this.getChildControl('loading').exclude();\n             }\n           }, this);\n           this.getChildControl('scroll').add(control);\n           break;\n\n         case 'hint':\n           control = new qx.ui.basic.Atom(this.tr('This configuration has been opened in another window. When you close this file, the window will also be closed. Click here top jump the the window.'));\n           control.set({\n             center: true,\n             font: 'title'\n           });\n           control.addListener('tap', function () {\n             if (this._windowRef) {\n               this._windowRef.focus();\n             }\n           }, this);\n           this.getChildControl('scroll').add(control);\n           break;\n\n         case 'loading':\n           control = new qx.ui.basic.Atom(this.tr('Loading...'), cv.theme.dark.Images.getIcon('reload', 64));\n           control.set({\n             center: true,\n             font: 'title',\n             iconPosition: 'top',\n             backgroundColor: 'rgba(0,0,0,0.2)'\n           });\n           control.addListener('appear', () => {\n             qx.event.Timer.once(() => {\n               control.exclude();\n             }, this, 5000);\n           });\n           control.exclude();\n           this._add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._windowRef = null;\n  }\n});\n","/**\n * Displays folder content in an explorer like view.\n */\nqx.Class.define('cv.ui.manager.viewer.Folder', {\n  extend: cv.ui.manager.viewer.AbstractViewer,\n  implement: [\n    qx.ui.core.IMultiSelection,\n    qx.ui.form.IModelSelection\n  ],\n  include: [\n    qx.ui.core.MMultiSelectionHandling,\n    qx.ui.core.MRemoteChildrenHandling,\n    qx.ui.form.MModelSelection,\n    cv.ui.manager.control.MFileEventHandler\n  ],\n\n  /*\n ***********************************************\n   CONSTRUCTOR\n ***********************************************\n */\n  construct: function (noToolbar) {\n    this.base(arguments);\n    cv.ui.manager.model.Preferences.getInstance().bind('startViewMode', this, 'viewMode');\n    this._isImageRegex = new RegExp('\\\\.(' + cv.ui.manager.viewer.Image.SUPPORTED_FILES.join('|') + ')$', 'i');\n    this.initModel(new qx.data.Array());\n    this._setLayout(new qx.ui.layout.VBox(8));\n\n    this._newItem = new cv.ui.manager.model.FileItem('new', 'new', null).set({\n      fake: true,\n      type: 'file',\n      loaded: true,\n      icon: cv.theme.dark.Images.getIcon('upload'),\n      displayName: this.tr('Upload file'),\n      special: 'add-file'\n    });\n\n    this._debouncedOnFilter = qx.util.Function.debounce(this._onFilter, 500, false);\n    if (!noToolbar) {\n      this._createChildControl('toolbar');\n    }\n    this._createChildControl('filter');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: function isDir(item) {\n      // noinspection JSConstructorReturnsPrimitive\n      return item.getType() === 'dir';\n    },\n    TITLE: qx.locale.Manager.tr('Show folder'),\n    ICON: cv.theme.dark.Images.getIcon('folder', 18)\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /**\n     * This event is fired after a list item was added to the list. The\n     * {@link qx.event.type.Data#getData} method of the event returns the\n     * added item.\n     */\n    addItem : 'qx.event.type.Data',\n\n    /**\n     * This event is fired after a list item has been removed from the list.\n     * The {@link qx.event.type.Data#getData} method of the event returns the\n     * removed item.\n     */\n    removeItem : 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    model: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    permanentFilter: {\n      check: 'Function',\n      nullable: true,\n      apply: '_onFilter'\n    },\n\n    showTextFilter: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowTextFilter'\n    },\n\n    labelConverter: {\n      check: 'Function',\n      nullable: true\n    },\n\n    disableScrolling: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDisableScrolling'\n    },\n\n    viewMode: {\n      check: ['list', 'preview'],\n      init: 'list',\n      event: 'changeViewMode'\n    }\n  },\n\n  /*\n ***********************************************\n   MEMBERS\n ***********************************************\n */\n  members: {\n    _controller: null,\n    _isImageRegex: null,\n    _newItem: null,\n\n    /** @type {Class} Pointer to the selection manager to use */\n    SELECTION_MANAGER : qx.ui.core.selection.ScrollArea,\n\n    _defaultLabelConverter: function (name) {\n      if (this.getViewMode() === 'list') {\n        // do not remove file type in list mode\n        return name;\n      }\n      const parts = name.split('.');\n      if (parts.length > 1) {\n        parts.pop();\n      }\n      return parts.join('.');\n    },\n\n    _getDelegate: function () {\n      const labelConverter = this.getLabelConverter();\n      const converter = {\n        converter: labelConverter ? labelConverter : this._defaultLabelConverter.bind(this)\n      };\n      return {\n        createItem: function () {\n          return new cv.ui.manager.form.FileListItem();\n        },\n\n        configureItem: function (item) {\n          item.addListener('dbltap', this._onDblTap, this);\n          item.addListener('contextmenu', this._onFsItemRightClick, this);\n          item.addListener('action', this._onFsItemRightClick, this);\n          item.setShowFileActions(true);\n          this.bind('viewMode', item, 'viewMode');\n        }.bind(this),\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'model', null, item, index);\n          controller.bindProperty('displayName', 'label', converter, item, index);\n          controller.bindProperty('icon', 'icon', {\n            converter: function (source, file) {\n              if (file.getType() === 'file' && this._isImageRegex.test(file.getName())) {\n                // use the image as icon\n                return file.getServerPath();\n              } \n                if (!source) {\n                  return null;\n                }\n                // remove size from icon source\n              const parts = source.split('/');\n              if (parts.length === 3) {\n                  parts.pop();\n                }\n                return parts.join('/');\n            }.bind(this)\n          }, item, index);\n        }.bind(this)\n      };\n    },\n\n    _onFsItemRightClick: function (ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        ev.preventDefault();\n        if (ev.getBubbles()) {\n          ev.stopPropagation();\n        }\n        return;\n      }\n      const menu = cv.ui.manager.contextmenu.GlobalFileItem.getInstance();\n      menu.configure(file);\n      ev.getCurrentTarget().setContextMenu(menu);\n      menu.openAtPointer(ev);\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onDblTap: function (ev) {\n      const file = ev.getCurrentTarget().getModel();\n      if (file.getSpecial() === 'add-file') {\n        // Select file for upload\n\n      } else {\n        qx.event.message.Bus.dispatchByName('cv.manager.open', file);\n      }\n    },\n\n    _applyFile: function (file, old) {\n      if (old) {\n        old.removeRelatedBindings(this);\n        this.resetModel();\n      }\n      if (file) {\n        const container = this.getChildControl('list');\n        if (!this._controller) {\n          this._controller = new qx.data.controller.List(null, container);\n          this._controller.setDelegate(this._getDelegate());\n        }\n        file.bind('children', this, 'model');\n        const model = this.getModel();\n        this._newItem.setParent(file);\n        model.addListener('change', function () {\n          if (this.getChildControl('filter').getValue() || this.getPermanentFilter()) {\n            this._onFilter();\n          } else {\n            this._controller.setModel(model);\n          }\n        }, this);\n        this._controller.setModel(model);\n        file.load();\n      } else {\n        if (this._controller) {\n          this._controller.resetModel();\n        }\n        this._newItem.resetParent();\n      }\n    },\n\n    _handleFileEvent: function (ev) {\n      const folder = this.getFile();\n      const data = ev.getData();\n      switch (data.action) {\n        case 'moved':\n          folder.reload();\n          break;\n\n        case 'added':\n        case 'uploaded':\n        case 'created':\n          if (data.path.startsWith(folder.getFullPath())) {\n            folder.reload();\n          }\n          break;\n\n        case 'deleted': {\n          let children;\n          if (folder) {\n            if (data.path === folder.getFullPath()) {\n              // this item has been deleted\n              this.dispose();\n            } else if (data.path.startsWith(folder.getFullPath())) {\n              // delete child\n              children = folder.getChildren();\n              children.some(function (child) {\n                if (child.getFullPath() === data.path) {\n                  children.remove(child);\n                  this.removeRelatedBindings(child);\n                  return true;\n                }\n                return false;\n              }, this);\n            }\n          }\n          children = this.getModel();\n          children.some(function (child) {\n            if (child.getFullPath() === data.path) {\n              children.remove(child);\n              this.removeRelatedBindings(child);\n              return true;\n            }\n            return false;\n          }, this);\n          break;\n        }\n      }\n    },\n\n    _applyShowTextFilter: function (value) {\n      this.getChildControl('filter').setVisibility(value ? 'visible' : 'excluded');\n    },\n\n    _onFilter: function () {\n      if (this._controller) {\n        const filterString = this.getChildControl('filter').getValue();\n        const filterFunction = this.getPermanentFilter();\n        const filtered = this.getModel().filter(function (file) {\n          return (!filterFunction || filterFunction(file)) && (!filterString || file.getName().includes(filterString));\n        });\n        this._controller.setModel(filtered);\n      }\n    },\n\n    getChildrenContainer: function () {\n      return this.getChildControl('list');\n    },\n\n    /**\n     * Handle child widget adds on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onAddChild : function(e) {\n      this.fireDataEvent('addItem', e.getData());\n    },\n\n    /**\n     * Handle child widget removes on the content pane\n     *\n     * @param e {qx.event.type.Data} the event instance\n     */\n    _onRemoveChild : function(e) {\n      this.fireDataEvent('removeItem', e.getData());\n    },\n\n    _onFileEvent: function (ev) {\n      const data = ev.getData();\n      switch (data.action) {\n        case 'deleted':\n          break;\n      }\n    },\n\n    _applyDisableScrolling: function (value) {\n      if (value) {\n        this.getChildControl('scroll').exclude();\n        this._addAt(this.getChildControl('list'), 1, {flex: 1});\n      } else {\n        const scrollContainer = this.getChildControl('scroll');\n        scrollContainer.show();\n        scrollContainer.add(this.getChildControl('list'));\n        this._addAt(scrollContainer, 1, {flex: 1});\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n        case 'toolbar':\n          control = new cv.ui.manager.ToolBar(null, ['new-file', 'new-folder', 'upload', 'reload']);\n          this.bind('file', control, 'folder');\n          control.addListener('reload', function () {\n            this.getFile().reload();\n          }, this);\n          this._addAt(control, 0);\n          break;\n\n        case 'filter':\n          control = new qx.ui.form.TextField();\n          control.set({\n            placeholder: this.tr('Filter by name...'),\n            liveUpdate: true,\n            margin: 8\n          });\n          if (!this.isShowTextFilter()) {\n            control.exclude();\n          }\n          control.addListener('changeValue', this._debouncedOnFilter, this);\n          this._addAt(control, 1);\n          break;\n\n        case 'scroll':\n          control = new qx.ui.container.Scroll();\n          this._addAt(control, 2, {flex: 1});\n          break;\n\n        case 'list':\n          control = new qx.ui.container.Composite(new qx.ui.layout.Flow(8, 8));\n\n          // Used to fire item add/remove events\n          control.addListener('addChildWidget', this._onAddChild, this);\n          control.addListener('removeChildWidget', this._onRemoveChild, this);\n          if (this.isDisableScrolling()) {\n            this._addAt(control, 1, {flex: 1});\n          } else {\n            this.getChildControl('scroll').add(control);\n          }\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_controller');\n    this._isImageRegex = null;\n    cv.ui.manager.model.Preferences.getInstance().removeRelatedBindings(this);\n  }\n});\n","/**\n * Shows the available icons.\n */\nqx.Class.define('cv.ui.manager.viewer.Icons', {\n  extend: cv.ui.manager.viewer.Folder,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this._disableFileEvents = true;\n    this.base(arguments, true);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^CometVisu-Icons$/i,\n    TITLE: qx.locale.Manager.tr('Show icons'),\n    ICON: cv.theme.dark.Images.getIcon('icons', 18)\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _getDelegate: function () {\n      return {\n        createItem: function () {\n          return new cv.ui.manager.core.IconAtom();\n        },\n\n        bindItem: function (controller, item, index) {\n          controller.bindProperty('', 'label', null, item, index);\n        }\n      };\n    },\n\n    _onFilter: function () {\n      const filterString = this.getChildControl('filter').getValue();\n      const filtered = this.getModel().filter(function (name) {\n        return name.includes(filterString);\n      });\n      this._controller.setModel(filtered);\n    },\n\n    _applyFile: function(file, old) {\n      if (file) {\n        const container = this.getChildControl('list');\n        if (!this._controller) {\n          this._controller = new qx.data.controller.List(null, container);\n          this._controller.setDelegate(this._getDelegate());\n        }\n        const model = this.getModel();\n        // as the file is just a fake file, we do not really care about it\n        Object.keys(cv.IconConfig.DB).filter(function (name) {\n          const entry = cv.IconConfig.DB[name];\n          return entry['*'] && entry['*']['*'] && qx.lang.Type.isFunction(entry['*']['*']['*']);\n        }).forEach(function (name) {\n          model.push(name);\n        }, this);\n        if (this.getChildControl('filter').getValue() || this.getPermanentFilter()) {\n          this._onFilter();\n        } else {\n          this._controller.setModel(model);\n        }\n      } else if (this._controller) {\n          this._controller.resetModel();\n        }\n    }\n  }\n});\n","/**\n * Simple view that provides all of the file-related features of the old editor in an easy to use way.\n */\nqx.Class.define('cv.ui.manager.Start', {\n  extend: qx.ui.core.Widget,\n  implement: [\n    cv.ui.manager.editor.IEditor,\n    cv.ui.manager.IActionHandler\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.VBox());\n    this._configRegex = /^visu_config_?([^.]+)?\\.xml$/;\n    [ 'toolbar', 'configs-title', 'configs-toolbar', 'configs',\n      'demo-configs-title', 'demo-configs',\n      'media-title', 'media-toolbar', 'media',\n      'misc-title', 'misc'\n    ].forEach(this._createChildControl, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    file: {\n      check: 'cv.ui.manager.model.FileItem',\n      apply: '_loadRoot',\n      event: 'changeFile'\n    },\n    appearance: {\n      refine: true,\n      init: 'cv-start'\n    },\n\n    selectedItem: {\n      check: 'cv.ui.manager.model.FileItem',\n      nullable: true,\n      apply: '_applySelectedItem'\n    },\n    external: {\n      check: 'Boolean',\n      init: false\n    },\n    ready: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeReady'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _configRegex: null,\n    _ignoreSelectionChanges: false,\n    _previewButton: null,\n    _listButton: null,\n    _radioGroup: null,\n\n    save: function () {},\n    getCurrentContent: function () {},\n    canHandleAction: function () {\n      return false;\n    },\n    handleAction: function () {},\n    configureButton: function (button) {},\n    unConfigureButton: function (button) {},\n\n    _loadRoot: function (value) {\n      this.getChildControl('configs').setFile(value);\n      let found = 0;\n\n      value.load(function () {\n        value.getChildren().some(function (file) {\n          if (file.getName() === 'media') {\n            this.getChildControl('media').setFile(file);\n            this.getChildControl('media-toolbar').setFolder(file);\n            found++;\n          } else if (file.getName() === 'demo') {\n            this.getChildControl('demo-configs').setFile(file);\n            found++;\n          }\n          return found === 2;\n        }, this);\n      }, this);\n    },\n\n    _onChangeSelection: function (ev) {\n      if (this._ignoreSelectionChanges === false) {\n        const list = ev.getTarget();\n        const selection = ev.getData();\n        this._ignoreSelectionChanges = true;\n\n        // unselect the other lists\n        ['configs', 'demo-configs', 'media'].forEach(function (name) {\n          const control = this.getChildControl(name);\n          if (control !== list) {\n            control.resetSelection();\n          }\n        }, this);\n        this._ignoreSelectionChanges = false;\n        if (selection.length > 0) {\n          this.setSelectedItem(selection[0].getModel());\n        }\n      }\n    },\n\n    _applySelectedItem: function () {\n    },\n\n    _onToggleExpand: function (ev) {\n      const control = this.getChildControl(ev.getTarget().getUserData('control'));\n      if (control.getVisibility() === 'visible') {\n        control.exclude();\n        ev.getTarget().setIcon(cv.theme.dark.Images.getIcon('drop-down', 18));\n      } else {\n        control.show();\n        ev.getTarget().setIcon(cv.theme.dark.Images.getIcon('drop-up', 18));\n      }\n    },\n\n    _onChangeViewMode: function () {\n      switch (cv.ui.manager.model.Preferences.getInstance().getStartViewMode()) {\n        case 'list':\n          this._radioGroup.setSelection([this._listButton]);\n          break;\n\n        case 'preview':\n          this._radioGroup.setSelection([this._previewButton]);\n          break;\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'scroll-container':\n           control = new qx.ui.container.Scroll();\n           this._add(control, {flex: 1});\n           break;\n\n         case 'content':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox(8));\n           this.getChildControl('scroll-container').add(control);\n           break;\n\n         case 'toolbar': {\n           control = new qx.ui.toolbar.ToolBar();\n           const part = new qx.ui.toolbar.Part();\n           const listButton = this._listButton = new qx.ui.toolbar.RadioButton('', cv.theme.dark.Images.getIcon('listViewMode', 22));\n           listButton.setUserData('mode', 'list');\n           listButton.set({\n             show: 'icon',\n             toolTipText: this.tr('List mode')\n           });\n           const previewButton = this._previewButton = new qx.ui.toolbar.RadioButton('', cv.theme.dark.Images.getIcon('previewMode', 22));\n           previewButton.setUserData('mode', 'preview');\n           previewButton.set({\n             show: 'icon',\n             toolTipText: this.tr('Preview mode')\n           });\n           part.add(listButton);\n           part.add(previewButton);\n           control.add(part);\n           this._radioGroup = new qx.ui.form.RadioGroup(listButton, previewButton);\n           this._onChangeViewMode();\n           this._radioGroup.addListener('changeSelection', function (ev) {\n             const selection = ev.getData()[0];\n             cv.ui.manager.model.Preferences.getInstance().setStartViewMode(selection.getUserData('mode'));\n           }, this);\n           cv.ui.manager.model.Preferences.getInstance().addListener('changeStartViewMode', this._onChangeViewMode, this);\n\n           this._add(control);\n           break;\n         }\n\n         case 'configs-title':\n           control = new qx.ui.basic.Atom(this.tr('Configurations'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'configs');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('configs-header').add(control);\n           break;\n\n         case 'configs-header':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           control.getContentElement().setAttribute('data-section', 'configs');\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'configs-toolbar':\n           control = new cv.ui.manager.ToolBar(null, ['new-config-file', 'upload', 'reload']);\n           control.setFolder(cv.ui.manager.model.FileItem.ROOT);\n           control.addListener('reload', function () {\n             cv.ui.manager.model.FileItem.ROOT.reload();\n           }, this);\n           this.getChildControl('configs-header').add(control);\n           break;\n\n         case 'configs':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             permanentFilter: function (file) {\n               const match = this._configRegex.exec(file.getName());\n               return !!match && (!match[1] || !match[1].endsWith('temp'));\n             }.bind(this),\n             labelConverter: function (name, file) {\n               if (file.isFake()) {\n                 return name;\n               }\n               const configName = cv.ui.manager.model.FileItem.getConfigName(name);\n               return configName ? configName : '<Default>';\n             },\n             file: cv.ui.manager.model.FileItem.ROOT,\n             disableScrolling: true\n           });\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'demo-configs-title':\n           control = new qx.ui.basic.Atom(this.tr('Demo configurations'), cv.theme.dark.Images.getIcon('drop-down', 18));\n           control.setUserData('control', 'demo-configs');\n           control.getContentElement().setAttribute('data-section', 'demo');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'demo-configs':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             permanentFilter: function (file) {\n               return this._configRegex.test(file.getName());\n             }.bind(this),\n             labelConverter: function (name) {\n               const configName = cv.ui.manager.model.FileItem.getConfigName(name);\n               return configName ? configName : '<Default>';\n             },\n             disableScrolling: true\n           });\n           control.exclude();\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'media-title':\n           control = new qx.ui.basic.Atom(this.tr('Media files'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'media');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('media-header').add(control);\n           break;\n\n         case 'media-header':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           control.getContentElement().setAttribute('data-section', 'media');\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'media-toolbar':\n           control = new cv.ui.manager.ToolBar(null, ['new-file', 'upload', 'reload']);\n           control.addListener('reload', function () {\n             control.getFolder().reload();\n           }, this);\n           this.getChildControl('media-header').add(control);\n           break;\n\n         case 'media':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             disableScrolling: true\n           });\n           control.addListener('changeSelection', this._onChangeSelection, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'misc-title':\n           control = new qx.ui.basic.Atom(this.tr('Miscellaneous'), cv.theme.dark.Images.getIcon('drop-up', 18));\n           control.setUserData('control', 'misc');\n           control.getContentElement().setAttribute('data-section', 'misc');\n           control.addListener('tap', this._onToggleExpand, this);\n           this.getChildControl('content').add(control);\n           break;\n\n         case 'misc':\n           control = new cv.ui.manager.viewer.Folder(true);\n           control.set({\n             showTextFilter: false,\n             disableScrolling: true\n           });\n           this.__initMiscFolder(control);\n           this.getChildControl('content').add(control, {flex: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    __initMiscFolder: function (folderWidget) {\n      if (!cv.ui.manager.model.FileItem.ROOT.isLoaded()) {\n        cv.ui.manager.model.FileItem.ROOT.addListenerOnce('changeLoaded', function () {\n          this.__initMiscFolder(folderWidget);\n        }, this);\n        return;\n      }\n      // find the real 'hidden.php' in the root folder\n      const specialFiles = [cv.ui.manager.model.FileItem.getIconFile()];\n      cv.ui.manager.model.FileItem.ROOT.getChildren().some(function (file) {\n        if (file.getFullPath() === 'hidden.php') {\n          // set some special flags needed to configure the special hidden configuration file\n          file.set({\n            overrideIcon: true,\n            icon: cv.theme.dark.Images.getIcon('hidden-config', 15),\n            displayName: qx.locale.Manager.tr('Hidden configuration'),\n            fake: true\n          });\n          specialFiles.unshift(file);\n          return true;\n        }\n        return false;\n      });\n      const fakeFolder = new cv.ui.manager.model.FileItem('fake', 'fake', cv.ui.manager.model.FileItem.ROOT, specialFiles).set({\n        fake: true,\n        type: 'dir',\n        loaded: true\n      });\n      folderWidget.setFile(fakeFolder);\n      folderWidget.addListener('changeSelection', this._onChangeSelection, this);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._configRegex = null;\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeStartViewMode', this._onChangeViewMode, this);\n    this._disposeObjects('_previewButton', '_listButton', '_radioGroup');\n  }\n});\n","/**\n * Monaco Texteditor integration\n */\nqx.Class.define('cv.ui.manager.editor.Source', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo'];\n    this._basePath = window.location.origin + window.location.pathname + qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/config/';\n    this.getContentElement().setAttribute('contentEditable', 'true');\n    this.set({\n      droppable: false,\n      focusable: true\n    });\n    this.addListener('dragover', function (ev) {\n      ev.preventDefault();\n      ev.dataTransfer.effectAllowed = 'none';\n      ev.dataTransfer.dropEffect = 'none';\n    });\n    this.addListener('drop', function (ev) {\n      ev.preventDefault();\n    });\n    this.addListener('appear', function () {\n      qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(false);\n    });\n    this.addListener('disappear', function () {\n      qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(true);\n    });\n    this._draw();\n    this._initWorker();\n    this._currentDecorations = [];\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: qx.locale.Manager.tr('Texteditor'),\n    COUNTER: 0,\n    MONACO_EXTENSION_REGEX: null,\n    SUPPORTED_FILES: function (file) {\n      let filename = typeof file === 'string' ? file : file.getFullPath().toLowerCase();\n      if (window.monaco && window.monaco.languages) {\n        if (!cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX) {\n          // monaco has already been loaded, we can use its languages configuration to check if this file is supported\n          const extensions = [];\n          monaco.languages.getLanguages().forEach(function (lang) {\n            lang.extensions.forEach(function (ext) {\n              ext = ext.replace(/\\./g, '\\\\.');\n              if (extensions.indexOf(ext) ===-1) {\n                extensions.push(ext);\n              }\n            });\n          });\n          cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX = new RegExp('(' + extensions.join('|') + ')$');\n        }\n        return cv.ui.manager.editor.Source.MONACO_EXTENSION_REGEX.test(filename);\n      } \n        return /\\.(xml|html|php|css|js|svg|json|md|yaml|conf|ts|rst|py|txt)$/i.test(filename);\n    },\n    DEFAULT_FOR: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    ICON: cv.theme.dark.Images.getIcon('text', 18),\n\n    load: function (callback, context) {\n      const version = qx.core.Environment.get('qx.debug') ? 'dev' : 'min';\n      const sourcePath = qx.util.Uri.getAbsolute(qx.util.LibraryManager.getInstance().get('cv', 'resourceUri') + '/..');\n      const loader = new qx.util.DynamicScriptLoader([\n        sourcePath + 'node_modules/monaco-editor/' + version + '/vs/loader.js',\n        'manager/xml.js'\n      ]);\n      loader.addListener('ready', function () {\n        window.require.config({\n          paths: {\n            'vs': sourcePath + 'node_modules/monaco-editor/' + version + '/vs'\n          }\n        });\n        window.require.config({\n          'vs/nls' : {\n            availableLanguages: {\n              '*': qx.locale.Manager.getInstance().getLanguage() !== 'en' ? qx.locale.Manager.getInstance().getLanguage() : ''\n            }\n          }\n        });\n        const noCacheSuffix = '?' + Math.random();\n        window.require([\n          'xml!./resource/visu_config.xsd' + noCacheSuffix,\n          'xml!*./resource/manager/completion-libs/qooxdoo.d.ts', // the xml loader can load any file by adding * before the path,\n          'vs/editor/editor.main'\n        ], function (schema, qxLib) {\n          this.__schema = schema;\n          callback.apply(context);\n          window.monaco.languages.typescript.javascriptDefaults.addExtraLib(qxLib, 'qooxdoo.d.ts');\n          const completionProvider = new cv.ui.manager.editor.completion.Config(cv.ui.manager.model.Schema.getInstance('visu_config.xsd'));\n          const cvCompletionProvider = new cv.ui.manager.editor.completion.CometVisu();\n          window.monaco.languages.registerCompletionItemProvider('xml', completionProvider.getProvider());\n          window.monaco.languages.registerCompletionItemProvider('javascript', cvCompletionProvider.getProvider());\n        }.bind(this));\n      }, this);\n      loader.addListener('failed', function (ev) {\n        qx.log.Logger.error(this, ev.getData());\n      }, this);\n      loader.start();\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __schema: null,\n    _editor: null,\n    _basePath: null,\n    _workerWrapper: null,\n    _currentDecorations: null,\n    _configClient: null,\n    _onDidChangeContentGuard: 0,\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n      this._workerWrapper.setEditor(this);\n    },\n\n    _getDefaultModelOptions: function () {\n      return {\n        tabSize: 2,\n        indentSize: 2,\n        insertSpaces: true\n      };\n    },\n\n    _draw: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._draw, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', this._draw, this);\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: true\n            },\n            theme: 'vs-dark'\n          });\n          const baseVersion = cv.Version.VERSION.split('-')[0];\n          const xhr = new qx.io.request.Xhr(qx.util.ResourceManager.getInstance().toUri('hidden-schema.json'));\n          xhr.set({\n            method: 'GET',\n            accept: 'application/json'\n          });\n          xhr.addListenerOnce('success', function (e) {\n            const req = e.getTarget();\n            const schema = req.getResponse();\n            window.monaco.languages.json.jsonDefaults.setDiagnosticsOptions({\n              validate: true,\n              allowComments: true,\n              schemas: [{\n                uri: 'https://www.cometvisu.org/CometVisu/schemas/' + baseVersion + '/hidden-schema.json',\n                fileMatch: ['hidden.php'],\n                schema: schema\n              }]\n            });\n          }, this);\n          xhr.send();\n\n          if (this.getFile()) {\n            this._loadFile(this.getFile());\n          }\n          this._editor.onDidChangeModelContent(this._onContentChanged.bind(this));\n        }\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'cut':\n            this._editor.trigger('external', 'editor.action.clipboardCutAction');\n            if (!this._nativePasteSupported) {\n              // we have no access to the native clipboard for pasting, so we need to save the value to copy somewhere else\n              // and implement the pasting manually\n              cv.ui.manager.editor.AbstractEditor.CLIPBOARD = this._editor.getModel().getValueInRange(this._editor.getSelection());\n            }\n            break;\n          case 'copy':\n            this._editor.trigger('external', 'editor.action.clipboardCopyAction');\n            if (!this._nativePasteSupported) {\n              // we have no access to the native clipboard for pasting, so we need to save the value to copy somewhere else\n              // and implement the pasting manually\n              cv.ui.manager.editor.AbstractEditor.CLIPBOARD = this._editor.getModel().getValueInRange(this._editor.getSelection());\n            }\n            break;\n          case 'paste':\n            if (this._nativePasteSupported) {\n              this._editor.trigger('external', 'editor.action.clipboardPasteAction');\n            } else {\n              this._paste();\n            }\n            break;\n          case 'undo':\n          case 'redo':\n            this._editor.trigger('external', actionName);\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    /**\n     * Manual paste into source editor is used when the native paste is not supported by the browser.\n     * This is the case when the cometvisu is not running is a safe environment (no https / localhost)\n     * @private\n     */\n    _paste: function () {\n      if (cv.ui.manager.editor.AbstractEditor.CLIPBOARD) {\n        const selection = this._editor.getSelection();\n        const id = {major: 1, minor: 1};\n        const op = {\n          identifier: id,\n          range: selection,\n          text: cv.ui.manager.editor.AbstractEditor.CLIPBOARD,\n          forceMoveMarkers: true\n        };\n        this._editor.executeEdits('clipboard', [op]);\n      }\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (this._editor) {\n        if (file && file.getType() === 'file' && this.isSupported(file)) {\n          this.base(arguments, file, old);\n        } else {\n          this.base(arguments, null, old);\n        }\n      }\n    },\n\n    _loadFromFs: function () {\n      if (this.getFile().getName() === 'hidden.php') {\n        if (!this._configClient) {\n          this._configClient = cv.io.rest.Client.getConfigClient();\n          this._configClient.addListener('getSuccess', function (ev) {\n            this.setContent(JSON.stringify(ev.getData(), null, 2));\n          }, this);\n          this._configClient.addListener('updateSuccess', this._onSaved, this);\n        }\n        this._configClient.get({section: '*', key: '*'});\n      } else {\n        this.base(arguments);\n      }\n    },\n\n    save: function (callback, overrideHash) {\n      if (this.getFile().getName() === 'hidden.php') {\n        if (!this.getFile().isValid()) {\n          cv.ui.manager.snackbar.Controller.error(this.tr('Hidden config is invalid, please correct the errors'));\n        } else if (this.getFile().getHasWarnings()) {\n          // ask user if he really want to save a file with warnings\n          qxl.dialog.Dialog.confirm(this.tr('Hidden config content has some warnings! It is recommended to fix the warnings before saving. Save anyways?'), function (confirmed) {\n            if (confirmed) {\n              this.__saveHiddenConfig();\n            }\n          }, this, qx.locale.Manager.tr('Confirm saving with warnings'));\n        } else {\n          this.__saveHiddenConfig();\n        }\n      } else {\n        this.base(arguments, callback, overrideHash);\n      }\n    },\n\n    __saveHiddenConfig: function () {\n      this._configClient.saveSync(null, JSON.parse(this.getCurrentContent()), function (err) {\n        if (err) {\n          cv.ui.manager.snackbar.Controller.error(this.tr('Saving hidden config failed with error %1 (%2)', err.status, err.statusText));\n        } else {\n          cv.ui.manager.snackbar.Controller.info(this.tr('Hidden config has been saved'));\n          this._onSaved();\n        }\n      }, this);\n    },\n\n    _applyContent: function(value) {\n      const file = this.getFile();\n      if (!file) {\n        return;\n      }\n      const model = this._editor.getModel();\n      if (this._workerWrapper) {\n        this._workerWrapper.open(file, value);\n      }\n      const id = monaco.Uri.parse(file.getUri());\n      let newModel = window.monaco.editor.getModel(id);\n      if (!newModel) {\n        // create new model\n        if (qx.xml.Document.isXmlDocument(value)) {\n          value = value.documentElement.outerHTML;\n        } else if (typeof value === 'object') {\n          value = JSON.stringify(value, null, 2);\n        }\n        newModel = window.monaco.editor.createModel(value, this._getLanguage(file), id);\n        newModel.onDidChangeDecorations(function (ev) {\n          let errors = false;\n          let warnings = false;\n          monaco.editor.getModelMarkers({\n            owner: newModel.getLanguageId(),\n            resource: id\n          }).some(function (marker) {\n            if (marker.severity === monaco.MarkerSeverity.Warning) {\n              warnings = true;\n            } else if (marker.severity === monaco.MarkerSeverity.Error) {\n              errors = true;\n            }\n            return warnings && errors;\n          }, this);\n          file.setValid(!errors);\n          file.setHasWarnings(warnings);\n        });\n      }\n\n      if (model !== newModel) {\n        newModel.updateOptions(this._getDefaultModelOptions());\n        this._editor.setModel(newModel);\n      } else {\n        this._editor.setValue(value);\n      }\n      this._editor.updateOptions({ readOnly: !file.isWriteable() });\n      this._processHandlerOptions(value);\n    },\n\n    _processHandlerOptions: function (content) {\n      const handlerOptions = this.getHandlerOptions() || {};\n      if (Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true && content) {\n        const [err, res] = this._upgradeConfig(content);\n        if (err) {\n          this.error(err);\n        } else {\n          this._editor.setValue(this._convertToString(res));\n        }\n      }\n    },\n\n    _convertToString: function (xml) {\n      return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n' + xml.documentElement.outerHTML;\n    },\n\n    _upgradeConfig: function (content) {\n      if (this.getFile()) {\n        if (this.getFile().isWriteable()) {\n          const upgrader = new cv.util.ConfigUpgrader();\n          return upgrader.upgrade(content);\n        }\n        cv.ui.manager.snackbar.Controller.error(this.tr('\"%1\" is not writable. Upgrading not possible.', this.getFile().getFullPath()));\n      }\n      return [null, '', []];\n    },\n\n    getCurrentContent: function () {\n      return this._editor.getValue();\n    },\n\n    _onContentChanged: function () {\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), this._editor.getValue());\n      }\n    },\n\n    isSupported: function (file) {\n      const parts = file.getName().split('.');\n      const fileType = parts.length > 1 ? parts.pop() : 'txt';\n      const typeExt = '.' + fileType;\n      return monaco.languages.getLanguages().some(function (lang) {\n        return lang.id === fileType || lang.extensions.indexOf(typeExt) >= 0;\n      });\n    },\n\n    showErrors: function (path, errorList) {\n      const markers = [];\n      const model = this._editor.getModel();\n      if (!model) {\n        return;\n      }\n      let firstErrorLine = -1;\n      /**\n       * @param line\n       */\n      function check(line) {\n        if (firstErrorLine < 0 || firstErrorLine > line) {\n          firstErrorLine = line;\n        }\n      }\n      if (errorList) {\n        errorList.forEach(function (error) {\n          check(error.line);\n          markers.push({\n            severity: window.monaco.MarkerSeverity.Error,\n            startLineNumber: error.line,\n            endLineNumber: error.line,\n            message: error.message,\n            startColumn: error.startColumn,\n            endColumn: error.endColumn\n          });\n        });\n      }\n      if (this.getFile().getFullPath() === path) {\n        window.monaco.editor.setModelMarkers(model, model.getLanguageId(), markers);\n        const options = this.getHandlerOptions();\n        if (options && options.jumpToError) {\n          // jump too first error (only when we are at the beginning\n          if (this._editor.getScrollTop() === 0) {\n            this._editor.revealLineInCenter(firstErrorLine);\n          }\n        }\n      } else {\n        // TODO: save errors for later\n      }\n    },\n\n    showDecorations: function (path, decorators) {\n      if (this.getFile().getFullPath() === path) {\n        this._editor.deltaDecorations(this._currentDecorations[path], decorators);\n      }\n      this._currentDecorations[path] = decorators;\n    },\n\n    _getLanguage: function (file) {\n      if (file.getName() === 'hidden.php') {\n        // override this setting as we are loading the hidden config from its REST endpoint as JSON\n        return 'json';\n      }\n      let type = file.getName().split('.').pop();\n      switch (type) {\n        case 'svg':\n          return 'xml';\n        case 'js':\n          return 'javascript';\n        case 'md':\n          return 'markdown';\n        default: {\n          if (!type) {\n            return 'txt';\n          }\n          // check if monaco knows this ending, otherwise fallback to plaintext\n          const typeExt = '.' + type;\n          const found = monaco.languages.getLanguages().some(function (lang) {\n            return lang.id === type || lang.extensions.indexOf(typeExt) >= 0;\n          });\n          if (!found) {\n            type = 'txt';\n          }\n          return type;\n        }\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._workerWrapper = null;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n    this._configClient = null;\n    qx.ui.core.FocusHandler.getInstance().setUseTabNavigation(true);\n  }\n});\n","/**\n * New XML-Editor base on a node tree\n */\nqx.Class.define('cv.ui.manager.editor.Tree', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n    this._handledActions = ['save', 'cut', 'copy', 'paste', 'undo', 'redo', 'help'];\n    this._initWorker();\n\n    // init schema\n    this._schema = cv.ui.manager.model.Schema.getInstance('visu_config.xsd');\n    this._schema.onLoaded(function () {\n      this.setReady(true);\n      this._draw();\n    }, this);\n    this.__modifiedElements = [];\n    this.__modifiedPreviewElements = new qx.data.Array();\n    this.__modifiedPreviewElements.addListener('changeLength', ev => {\n      if (ev.getData() === 0) {\n        this.setPreviewState('synced');\n      } else {\n        const structureChanges = this.__modifiedPreviewElements.some(element => element.hasChildrenModified());\n        this.setPreviewState(structureChanges ? 'structureChanged' : 'changed');\n      }\n    }, this);\n    this.initUnDos(new qx.data.Array());\n    this.initReDos(new qx.data.Array());\n    this.__buttonListeners = {};\n    qx.core.Init.getApplication().getRoot().addListener('keyup', this._onElementKeyUp, this);\n    this.addListener('resize', this._maintainPreviewVisibility, this);\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    SUPPORTED_FILES: /^(demo|\\.)?\\/?visu_config.*\\.xml/,\n    TITLE: qx.locale.Manager.tr('Xml-editor'),\n    ICON: cv.theme.dark.Images.getIcon('xml', 18),\n\n    Allowed: {\n      NONE: 0,\n      BEFORE: 1,\n      AFTER: 2,\n      INSIDE: 4,\n      FIRST_CHILD: 8 // Is allowed to added as first child\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'tree-editor'\n    },\n    // show expert level settings\n    expert: {\n      check: 'Boolean',\n      init: false\n    },\n\n    ready: {\n      refine: true,\n      init: false\n    },\n\n    selected: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeSelected',\n      apply: '_applySelected'\n    },\n\n    clipboard: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      event: 'changeClipboard',\n      apply: '_applyClipboard'\n    },\n\n    unDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    reDos: {\n      check: 'qx.data.Array',\n      deferredInit: true\n    },\n\n    autoRefreshPreview: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * Content and shown preview are equal\n     */\n    previewState: {\n      check: ['synced', 'changed', 'structureChanged'],\n      init: 'synced',\n      event: 'previewStateChanged',\n      apply: '_updateHighlightWidget'\n    },\n\n    showPreview: {\n      check: 'Boolean',\n      init: true,\n      apply: '_applyShowPreview',\n      event: 'showPreviewChanged'\n    },\n    /**\n     * true while the user is dragging something\n     */\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _schema: null,\n    __modifiedElements: null,\n    __modifiedPreviewElements: null,\n    _workerWrapper: null,\n    __editing: false,\n    __buttonListeners: null,\n    __searchResults: null,\n    __searchResultIndex: 0,\n\n    isPreviewSynced: function () {\n      return this.getPreviewState() === 'synced';\n    },\n\n    _applyHandlerOptions: function () {\n      this._maintainPreviewVisibility();\n    },\n\n    _maintainPreviewVisibility: function () {\n      const handlerOptions = this.getHandlerOptions();\n      this.setShowPreview(qx.bom.Viewport.getWidth() > 800 && (!handlerOptions || !handlerOptions.noPreview));\n    },\n\n    _applyShowPreview: function (value) {\n      this.getChildControl('right').setVisibility(value ? 'visible' : 'excluded');\n      if (value) {\n        this.getChildControl('left').clearLayoutProperties();\n        this.getChildControl('left').updateLayoutProperties();\n      } else {\n        const handlerOptions = this.getHandlerOptions();\n        if (!handlerOptions || !handlerOptions.noStretch) {\n          this.getChildControl('left').setLayoutProperties({flex: 1});\n        }\n      }\n      const file = this.getFile();\n      if (value && file) {\n        const preview = this.getChildControl('preview');\n        if (file.isWriteable()) {\n          if (!preview.getFile()) {\n            const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', this.getFile().getParent());\n            preview.setFile(previewConfig);\n          }\n        } else {\n          // this file is not writable, we can use the real one for preview\n          preview.setFile(file);\n        }\n        this._updatePreview();\n      }\n    },\n\n    handleAction: function (actionName) {\n      if (this.canHandleAction(actionName)) {\n        switch (actionName) {\n          case 'undo':\n            if (!this.__editing) {\n              this.undo();\n            }\n            break;\n\n          case 'redo':\n            if (!this.__editing) {\n              this.redo();\n            }\n            break;\n\n          case 'cut':\n            this._onCut();\n            break;\n\n          case 'copy':\n            this._onCopy();\n            break;\n\n          case 'paste':\n            this._onPaste();\n            break;\n\n          case 'help':\n            if (!this.__editing) {\n              this._showHelp();\n            }\n            break;\n\n          default:\n            this.base(arguments, actionName);\n            break;\n        }\n      }\n    },\n\n    configureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          this.__buttonListeners[actionId] = this.getUnDos().addListener('changeLength', () => {\n            const length = this.getUnDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getUnDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getUnDos().length > 0);\n          break;\n\n        case 'redo':\n          this.__buttonListeners[actionId] = this.getReDos().addListener('changeLength', () => {\n            const length = this.getReDos().length;\n            if (length > 0) {\n              button.setEnabled(true);\n              button.setToolTipText(this.tr('Undo: %1', this.getReDos().getItem(length - 1).getTitle()));\n            } else {\n              button.setEnabled(false);\n              button.resetToolTipText();\n            }\n          }, this);\n          button.setEnabled(this.getReDos().length > 0);\n          break;\n\n        case 'cut':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return value ? !value.isDeletable() : false;\n            }\n          });\n          break;\n\n        case 'copy':\n          this.bind('selected', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n\n        case 'paste':\n          this.bind('clipboard', button, 'enabled', {\n            converter: function (value) {\n              return !!value;\n            }\n          });\n          break;\n      }\n    },\n    unConfigureButton: function (actionId, button) {\n      switch (actionId) {\n        case 'undo':\n          if (this.__buttonListeners[actionId]) {\n            this.getUnDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'redo':\n          if (this.__buttonListeners[actionId]) {\n            this.getReDos().removeListenerById(this.__buttonListeners[actionId]);\n            delete this.__buttonListeners[actionId];\n          }\n          button.setEnabled(false);\n          break;\n\n        case 'paste':\n        case 'cut':\n        case 'copy':\n          this.removeRelatedBindings(button);\n          break;\n      }\n    },\n\n    addUndo: function (elementChange) {\n      if (elementChange instanceof cv.ui.manager.model.ElementChange) {\n        this.getUnDos().push(elementChange);\n      }\n    },\n\n    undo: function () {\n      const unDos = this.getUnDos();\n      if (unDos.length > 0) {\n        const elementChange = unDos.pop();\n        if (elementChange.undo()) {\n          this.getReDos().push(elementChange);\n        } else {\n          this.error('could not undo ' + elementChange.getTitle());\n          unDos.push(elementChange);\n        }\n      }\n    },\n\n    redo: function () {\n      const reDos = this.getReDos();\n      if (reDos.length > 0) {\n        const elementChange = reDos.pop();\n        if (elementChange.redo()) {\n          this.getUnDos().push(elementChange);\n        } else {\n          this.error('could not redo ' + elementChange.getTitle());\n          reDos.push(elementChange);\n        }\n      }\n    },\n\n    clearUnDosReDos: function () {\n      this.getUnDos().removeAll().forEach(elem => elem.dispose());\n      this.clearReDos();\n    },\n\n    clearReDos: function () {\n      this.getReDos().removeAll().forEach(elem => elem.dispose());\n    },\n\n    _applyClipboard: function (value) {\n      try {\n        if (value) {\n          navigator.clipboard.writeText(value.getNode().outerHTML);\n        } else {\n          navigator.clipboard.writeText('');\n        }\n      } catch (e) {\n        // clipboard api is only available in secure environment, otherwise we have to do it ourself\n        cv.ui.manager.editor.AbstractEditor.CLIPBOARD = value ? value.getNode().outerHTML : '';\n      }\n    },\n\n    _initWorker: function () {\n      this._workerWrapper = cv.ui.manager.editor.Worker.getInstance();\n    },\n\n    showErrors: function (path, errorList) {\n    },\n    showDecorations: function (path, decorators) {\n    },\n\n    _loadFile: function (file, old) {\n      if (old && this._workerWrapper) {\n        this._workerWrapper.close(old);\n      }\n      if (file && file.getType() === 'file' && this.isSupported(file)) {\n        this.base(arguments, file, old);\n      } else {\n        this.base(arguments, null, old);\n        if (this.hasChildControl('preview')) {\n          this.getChildControl('preview').resetFile();\n        }\n        this.resetPreviewState();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'splitpane':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this._add(control);\n           break;\n\n         case 'left':\n           control = new qx.ui.container.Composite(new qx.ui.layout.Canvas());\n           this.getChildControl('splitpane').addAt(control, 0);\n           break;\n\n         case 'right':\n           control = new qx.ui.container.Composite(new qx.ui.layout.VBox());\n           if (!this.isShowPreview()) {\n             control.exclude();\n           }\n           this.getChildControl('splitpane').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview':\n           control = new cv.ui.manager.viewer.Config();\n           control.set({\n             target: 'iframe',\n             minWidth: 600\n           });\n           this.getChildControl('right').addAt(control, 1, {flex: 1});\n           break;\n\n         case 'preview-sync-hint': {\n           const ok = this.tr('Preview shows the current state of the edited configuration.');\n           const noSync = this.tr('Preview is out of sync. Click here to refresh.');\n           const notOk = this.tr('Preview is out of sync. Highlighting of the currently selected tree element is deactivated until you refresh the preview. Click here to refresh.');\n           control = new qx.ui.basic.Atom(ok, cv.theme.dark.Images.getIcon('valid', 16));\n           control.setRich(true);\n           control.getChildControl('label').setWrap(true);\n           control.addListener('tap', () => {\n             if (!this.isPreviewSynced() && this.isShowPreview()) {\n               this._updatePreview();\n             }\n           }, this);\n           this.getChildControl('right').addAt(control, 0);\n           this.addListener('previewStateChanged', ev => {\n             switch (ev.getData()) {\n               case 'synced':\n                 control.set({\n                   label: ok,\n                   icon: cv.theme.dark.Images.getIcon('valid', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n\n               case 'changed':\n                 control.set({\n                   label: noSync,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').removeState('error');\n                 control.getChildControl('icon').addState('warning');\n                 break;\n\n               case 'structureChanged':\n                 control.set({\n                   label: notOk,\n                   icon: cv.theme.dark.Images.getIcon('out-of-sync', 16)\n                 });\n                 control.getChildControl('icon').addState('error');\n                 control.getChildControl('icon').removeState('warning');\n                 break;\n             }\n           }, this);\n           break;\n         }\n\n         case 'edit-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('edit', 24));\n           control.setEnabled(false);\n           control.addListener('execute', this._onEdit, this);\n           this.bind('file.writeable', control, 'icon', {\n             converter: function (value) {\n               return value ? cv.theme.dark.Images.getIcon('edit', 16) : cv.theme.dark.Images.getIcon('view', 16);\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('delete', 16));\n           control.setEnabled(false);\n           control.addListener('execute', this._onDelete, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toggle-expert':\n           control = new qx.ui.toolbar.CheckBox(this.tr('Expertview'),\n             cv.theme.dark.Images.getIcon('expert', 16));\n           control.addListener('execute', function () {\n             this.toggleExpert();\n           }, this);\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'refresh-preview':\n           control = new qx.ui.toolbar.Button(null, cv.theme.dark.Images.getIcon('reload', 16));\n           control.setToolTipText(this.tr('Reload preview'));\n           control.addListener('execute', this._updatePreview, this);\n           this.bind('showPreview', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'hidden';\n             }\n           });\n           this.bind('previewState', control, 'enabled', {\n             converter: function (value) {\n               return value !== 'synced';\n             }\n           });\n           this.getChildControl('toolbar').add(control);\n           break;\n\n         case 'toolbar':\n           control = new qx.ui.toolbar.ToolBar();\n           this.getChildControl('left').add(control, {\n             top: 0,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar-container':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox());\n           this.getChildControl('left').add(control, {\n             top: 36,\n             left: 0,\n             right: 0\n           });\n           break;\n\n         case 'searchbar':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             placeholder: this.tr('Search...'),\n             margin: 8\n           });\n           control.addListener('changeValue', qx.util.Function.debounce(this._onSearch, 250), this);\n           control.addListener('keyup', function (ev) {\n             switch (ev.getKeyIdentifier()) {\n               case 'Enter':\n               case 'Down':\n                 this._showNextResult();\n                 break;\n               case 'Up':\n                 this._showPreviousResult();\n                 break;\n             }\n             ev.stopPropagation();\n           }, this);\n           this.getChildControl('searchbar-container').add(control, {flex: 1});\n           break;\n\n         case 'tree':\n           control = new qx.ui.tree.VirtualTree(null, 'displayName', 'children');\n           control.set({\n             selectionMode: 'single',\n             width: 350,\n             openMode: 'none',\n             itemHeight: qx.core.Environment.get('device.touch') ? 40 : 20\n           });\n           this.bind('file.writeable', control, 'droppable');\n           this.bind('file.writeable', control, 'draggable');\n           this._initDragDrop(control);\n           control.setDelegate({\n             createItem: function () {\n               const item = new cv.ui.manager.tree.VirtualElementItem();\n               if (!qx.core.Environment.get('device.touch')) {\n                 item.addListener('contextmenu', this._onContextMenu, this);\n               } else {\n                 item.addListener('action', this._onContextMenuAction, this);\n               }\n               item.addListener('dbltap', this._onEdit, this);\n               return item;\n             }.bind(this),\n\n             // Bind properties from the item to the tree-widget and vice versa\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               controller.bindProperty('displayName', 'label', null, item, index);\n               controller.bindProperty('name', 'name', null, item, index);\n               controller.bindPropertyReverse('open', 'open', null, item, index);\n               controller.bindProperty('open', 'open', null, item, index);\n               controller.bindProperty('showEditButton', 'editable', null, item, index);\n               controller.bindProperty('sortable', 'sortable', null, item, index);\n               controller.bindProperty('icon', 'icon', null, item, index);\n               controller.bindProperty('status', 'status', null, item, index);\n               controller.bindProperty('invalidMessage', 'toolTipText', null, item, index);\n               controller.bindProperty('dragging', 'dragging', null, item, index);\n             }\n           });\n           control.getSelection().addListener('change', this._onChangeTreeSelection, this);\n           this.getChildControl('left').add(control, {\n             top: 72,\n             left: 0,\n             right: 0,\n             bottom: 0\n           });\n           break;\n\n         case 'add-button':\n           control = new qx.ui.basic.Atom(null, cv.theme.dark.Images.getIcon('add', 32));\n           control.setDraggable(true);\n           control.setMarginLeft(-16);\n           control.setZIndex(20);\n           this.addListener('changeDragging', ev => {\n             control.setLayoutProperties({\n               bottom: 16,\n               left: ev.getData() ? -1000 : '50%'\n             });\n           }, this);\n           control.setAppearance('round-button');\n           control.addListener('pointerover', () => control.addState('hovered'));\n           control.addListener('pointerout', () => control.removeState('hovered'));\n           control.addListener('tap', () => {\n             if (this.getSelected()) {\n               this._onCreate(this.getSelected(), 'inside');\n             } else {\n               qxl.dialog.Dialog.alert(this.tr('Please create a new Element either by dragging this button to the place where the new element should be inserted or by selecting an element and pressing this button to insert a new child to this element.'));\n             }\n           }, this);\n           this.getChildControl('left').add(control, {\n             bottom: 16,\n             left: '50%'\n           });\n           break;\n\n         case 'drag-indicator':\n           // Create drag indicator\n           control = new qx.ui.core.Widget();\n           control.setDecorator(new qx.ui.decoration.Decorator().set({\n             widthTop: 1,\n             styleTop: 'solid',\n             colorTop: 'white'\n           }));\n           control.setHeight(0);\n           control.setOpacity(0.5);\n           control.setZIndex(100);\n           control.setDroppable(true);\n           control.setLayoutProperties({left: -1000, top: -1000});\n           qx.core.Init.getApplication().getRoot().add(control);\n           break;\n\n         case 'context-menu':\n           control = new cv.ui.manager.contextmenu.ConfigElement(this);\n           control.addListener('action', this._onContextMenuAction, this);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    _onContextMenu: function (ev) {\n      const target = ev.getCurrentTarget();\n      if (target instanceof cv.ui.manager.tree.VirtualElementItem) {\n        const element = target.getModel();\n        this.getChildControl('tree').getSelection().replace([element]);\n        this.setSelected(element);\n        const menu = this.getChildControl('context-menu');\n        menu.setElement(element);\n        menu.openAtPointer(ev);\n      }\n\n      // Do not show native menu\n      // don't open any other contextmenus\n      if (ev.getBubbles()) {\n        ev.stop();\n      }\n    },\n\n    _onContextMenuAction: function (ev) {\n      const data = ev.getData();\n      if (this.canHandleAction(data.action)) {\n        this.handleAction(data.action);\n      } else {\n        switch (data.action) {\n          case 'view':\n          case 'edit':\n            this._onEdit(null, data.element);\n            break;\n\n          case 'delete':\n            this._onDelete(null, data.element);\n            break;\n\n          case 'create':\n            // add a new child\n            this._onCreate(data.element, 'inside');\n            break;\n\n          default:\n            this.error('unhandled context menu action', data.action);\n            break;\n        }\n      }\n    },\n\n    _onChangeTreeSelection: function (ev) {\n      const data = ev.getData();\n      if (data.added.length === 1) {\n        this.setSelected(data.added[0]);\n      } else {\n        this.resetSelected();\n      }\n    },\n\n\n    openByQuerySelector: function (selector, edit) {\n      return new Promise((resolve, reject) => {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        const result = rootNode.querySelector(selector);\n        if (result) {\n          this.__searchResults = [result];\n          this.__searchResultIndex = 0;\n          this.__showSearchResult();\n          if (edit) {\n            this._onEdit();\n          }\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n    },\n\n    _onSearch: function (ev) {\n      const value = ev.getData();\n      this.__searchResults = [];\n      this.__searchResultIndex = 0;\n      if (value.length > 2) {\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        this.__searchResults = Array.from(rootNode.querySelectorAll('*')).filter(function (el) {\n          return el.tagName.startsWith(value) || el.hasAttribute('name') && el.getAttribute('name').startsWith(value);\n        });\n        this.__showSearchResult();\n      }\n    },\n\n    _showNextResult: function () {\n      if (this.__searchResults && this.__searchResults.length > this.__searchResultIndex + 1) {\n        this.__searchResultIndex++;\n        this.__showSearchResult();\n      }\n    },\n\n    _showPreviousResult: function () {\n      if (this.__searchResults && this.__searchResultIndex > 0) {\n        this.__searchResultIndex--;\n        this.__showSearchResult();\n      }\n    },\n\n    __showSearchResult: function () {\n      if (this.__searchResults.length > this.__searchResultIndex) {\n        // find and open the first result and save the rest for traversal (with keyboard arrows\n        const firstMatch = this.__searchResults[this.__searchResultIndex];\n        const tree = this.getChildControl('tree');\n        if (firstMatch.$$widget) {\n          tree.openNodeAndParents(firstMatch.$$widget);\n          tree.getSelection().replace([firstMatch.$$widget]);\n        } else {\n          let current = firstMatch;\n          const ancestors = [];\n          // lookup the path until we find the first one with a widget\n          while (current && !current.$$widget) {\n            current = current.parentElement;\n            if (current) {\n              ancestors.push(current);\n            }\n          }\n          if (current && current.$$widget) {\n            current.$$widget.load();\n            // now git down the path of found ancestors and load them all\n            for (let i = ancestors.length-1; i >= 0; i--) {\n              const p = ancestors[i].$$widget;\n              if (p) {\n                p.load();\n              }\n            }\n            if (firstMatch.$$widget) {\n              tree.openNodeAndParents(firstMatch.$$widget);\n              tree.getSelection().replace([firstMatch.$$widget]);\n            }\n          }\n        }\n      }\n    },\n\n    _initDragDrop: function (control) {\n      let draggedXmlElement;\n      control.addListener('dragstart', function (ev) {\n        const dragTarget = ev.getDragTarget();\n        let element;\n        if (dragTarget instanceof cv.ui.manager.tree.VirtualElementItem) {\n          element = dragTarget.getModel();\n          element.setDragging(true);\n          if (!element.isEditable() || !element.isDeletable()) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return;\n          }\n          ev.addAction('copy');\n          if (element.isDeletable()) {\n            ev.addAction('move');\n          }\n          ev.addType('cv/tree-element');\n          ev.addData('cv/tree-element', element);\n          draggedXmlElement = element;\n        }\n        this.setDragging(true);\n      }, this);\n\n      const addButton = this.getChildControl('add-button');\n      addButton.addListener('dragstart', function (ev) {\n        ev.addAction('copy');\n        ev.addType('cv/new-tree-element');\n        this.setDragging(true);\n      }, this);\n\n      const Allowed = cv.ui.manager.editor.Tree.Allowed;\n      const accepted = {\n        mode: 0,\n        target: null\n      };\n\n      control.addListener('dragover', function (ev) {\n        // add ist a custom action that cannot be detected, so we only check if its supported\n        let action = ev.getCurrentAction();\n        let element;\n        if (ev.supportsType('cv/tree-element')) {\n          element = ev.getData('cv/tree-element');\n        }\n        const addNew = action === 'copy' && !element && ev.supportsType('cv/new-tree-element');\n        let target = ev.getTarget();\n        if (target === indicator) {\n          // no change when we are dragging over the indicator\n          this.debug('dragging over indicator');\n          return;\n        }\n        if (action !== 'copy' && target && target instanceof cv.ui.manager.tree.VirtualElementItem) {\n          if (target.getModel() === element) {\n            // cannot drop on myself\n            this.debug('dropping on same element forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          } else if (element && element.isAncestor(target.getModel())) {\n            // cannot move into myself\n            this.debug('moving inside own subtree forbidden');\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            return;\n          }\n        }\n        if (target === control) {\n          const layerContent = control.getPane().getLayers()[0].getContentLocation();\n          if (layerContent && (ev.getDocumentTop() - layerContent.bottom <= 20)) {\n            // when we are not more than 10px away from the last tree element we use that one, otherwise dropping is forbidden\n            const lastElem = document.elementFromPoint(Math.round((layerContent.left + layerContent.right) / 2), layerContent.bottom - 20);\n            target = qx.ui.core.Widget.getWidgetByElement(lastElem);\n            if (target) {\n              while (target.isAnonymous()) {\n                target = target.getLayoutParent();\n              }\n            }\n          } else {\n            target = null;\n          }\n          if (!target || target === control) {\n            accepted.mode = Allowed.NONE;\n            ev.preventDefault();\n            this.debug('drop target not found');\n            return;\n          }\n        }\n        if (!addNew && !element) {\n          // not for us\n          this.debug('drop not allowed here, no drag element');\n          accepted.mode = Allowed.NONE;\n          ev.preventDefault();\n          return;\n        }\n        const model = target.getModel();\n        const parent = model.getParent();\n        accepted.target = model;\n\n        if (parent) {\n          const parentSchemaElement = parent.getSchemaElement();\n          if (addNew) {\n            const allowedElements = parentSchemaElement.getAllowedElements();\n            if (Object.keys(allowedElements).length > 0) {\n              // check if there could be added more children\n              const addable = parent.getAddableChildren();\n              if (addable.length > 0) {\n                // check if a child could be added at this position\n                if (parentSchemaElement.areChildrenSortable()) {\n                  // children can be put anywhere\n                  // so this is allowed anywhere\n                  accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n                } else {\n                  let acc = Allowed.NONE;\n                  const allowedSorting = parentSchemaElement.getAllowedElementsSorting();\n                  addable.some(elementName => {\n                    acc |= this.__getAllowedPositions(allowedSorting, elementName, model.getName());\n                    if ((acc & Allowed.BEFORE) && (acc & Allowed.AFTER)) {\n                      // we cannot find more\n                      return true;\n                    }\n                    return false;\n                  });\n                  accepted.mode = acc;\n                }\n              }\n            } else {\n              ev.preventDefault();\n              // not children allowed here\n              accepted.mode = Allowed.NONE;\n              this.debug('no children allowed here');\n            }\n          } else if (!parentSchemaElement.isChildElementAllowed(element.getName())) {\n              // not allowed on this level\n              accepted.mode = Allowed.NONE;\n              this.debug('not allowed as child element of', parent.getName());\n            } else if (parentSchemaElement.areChildrenSortable()) {\n              // children can be put anywhere\n              // so this is allowed anywhere\n              accepted.mode = Allowed.BEFORE | Allowed.AFTER;\n            } else {\n              // check position\n              accepted.mode = this.__getAllowedPositions(parentSchemaElement.getAllowedElementsSorting(), element.getName(), model.getName());\n            }\n        } else {\n          accepted.mode = Allowed.NONE;\n        }\n        let lookInside;\n        if (addNew) {\n          lookInside = Object.keys(model.getSchemaElement().getAllowedElements(true)).length > 0;\n        } else {\n          lookInside = model.getSchemaElement().isChildElementAllowed(element.getName());\n        }\n        if (lookInside) {\n          // allowed inside\n          accepted.mode |= Allowed.INSIDE;\n          if (model.getSchemaElement().areChildrenSortable()) {\n            accepted.mode |= Allowed.FIRST_CHILD;\n          } else {\n            const allowedSorting = model.getSchemaElement().getFirstLevelElementSorting();\n            if (allowedSorting) {\n              if (element) {\n                let targetPosition = allowedSorting[element.getName()];\n                if (targetPosition !== undefined) {\n                  if (targetPosition === 0 || model.getChildren().length === 0) {\n                    accepted.mode |= Allowed.FIRST_CHILD;\n                  } else {\n                    // check if we can add it before the current first child\n                    const firstChild = model.getChildren().getItem(0);\n                    const maxPosition = allowedSorting[firstChild.getName()];\n                    if (maxPosition >= targetPosition) {\n                      accepted.mode |= Allowed.FIRST_CHILD;\n                    }\n                  }\n                }\n              } else if (model.getChildren().length > 0) {\n                const firstChild = model.getChildren().getItem(0);\n                let firstChildPosition = allowedSorting[firstChild.getName()];\n                if (firstChildPosition !== undefined && firstChildPosition > 0) {\n                  // first child is not on position 0\n                  accepted.mode |= Allowed.FIRST_CHILD;\n                }\n              } else if (Object.keys(allowedSorting).length > 0) {\n                // target is empty, but children are allowed\n                accepted.mode |= Allowed.FIRST_CHILD;\n              }\n            }\n          }\n        }\n        if (accepted.mode === Allowed.NONE) {\n          ev.preventDefault();\n          this.debug('dropping not accepted here');\n        }\n      }, this);\n\n      const indicator = this.getChildControl('drag-indicator');\n\n      let expandTimer;\n\n      control.addListener('dragleave', function (ev) {\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n      }, this);\n\n      let lastTreeItem;\n      const treeContainer = control.getPane();\n\n      const onDrag = function (ev) {\n        let left = -1000;\n        let top = -1000;\n        let position = '';\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (ev._native.pointerType === 'touch') {\n          if (!cursor.hasState('touch')) {\n            cursor.addState('touch');\n          }\n        }\n\n        if (accepted.mode !== Allowed.NONE) {\n          const origElem = document.elementFromPoint(ev.getDocumentLeft(), ev.getDocumentTop());\n          let orig = qx.ui.core.Widget.getWidgetByElement(origElem);\n          let skipDetection = false;\n          if (!orig) {\n            return;\n          }\n          while (orig.isAnonymous()) {\n            orig = orig.getLayoutParent();\n          }\n\n          const origCoords = orig.getContentLocation();\n          let leftPos = origCoords.left;\n          if (orig instanceof cv.ui.manager.tree.VirtualElementItem) {\n            const spacer = orig._getChildren()[0];\n            leftPos = spacer.getWidth() + orig.getPaddingLeft();\n            indicator.setWidth(orig.getBounds().width - leftPos);\n            if (accepted.target && orig.getModel() !== accepted.target) {\n              skipDetection = true;\n            }\n            lastTreeItem = orig;\n          } else if (orig !== indicator) {\n            if (orig === treeContainer) {\n              const lastCoords = lastTreeItem.getContentLocation();\n              const distance = ev.getDocumentTop() - lastCoords.bottom;\n              if (distance <= 20 && accepted.mode & Allowed.AFTER) {\n                const spacer = lastTreeItem._getChildren()[0];\n                left = spacer.getWidth() + lastTreeItem.getPaddingLeft();\n                top = lastCoords.bottom;\n                position = 'after';\n              }\n              skipDetection = true;\n            } else {\n              skipDetection = true;\n            }\n          } else {\n            // on drag indicator, do nothing here\n            return;\n          }\n          if (!skipDetection) {\n            if ((ev.getDocumentTop() - origCoords.top) <= 5) {\n              // above\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n              // check if this item is allowed here\n              if (accepted.mode & Allowed.BEFORE) {\n                left = leftPos;\n                top = origCoords.top;\n                position = 'before';\n              } else if (accepted.mode & Allowed.INSIDE) {\n                left = -1000;\n                top = -1000;\n                position = 'inside';\n              }\n            } else if ((origCoords.bottom - ev.getDocumentTop()) <= 5) {\n              // below\n              if (accepted.target && !accepted.target.isOpen()) {\n                if (accepted.mode & Allowed.AFTER) {\n                  left = leftPos;\n                  top = origCoords.bottom;\n                  position = 'after';\n                } else if (accepted.mode & Allowed.INSIDE) {\n                  left = -1000;\n                  top = -1000;\n                  position = 'inside';\n                }\n              } else {\n                // when an element is opened this position is not after this element. but before its first child\n                // eslint-disable-next-line no-lonely-if\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  left = leftPos + 19;\n                  indicator.setWidth(indicator.getWidth() - 19);\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                } else {\n                  this.debug('not allowed as first child');\n                }\n              }\n              if (expandTimer) {\n                expandTimer.stop();\n                expandTimer = null;\n              }\n            } else {\n              // inside\n              // eslint-disable-next-line no-lonely-if\n              if (accepted.target && accepted.target.isOpen()) {\n                // treat dropping on an opened node as \"first-child\" position\n                if (accepted.mode & Allowed.FIRST_CHILD) {\n                  if (indicator.getUserData('position') !== 'first-child') {\n                    left = leftPos + 19;\n                    indicator.setWidth(indicator.getWidth() - 19);\n                  }\n                  top = origCoords.bottom;\n                  position = 'first-child';\n                }\n              } else {\n                indicator.setDomPosition(-1000, -1000);\n                if (accepted.mode & Allowed.INSIDE) {\n                  position = 'inside';\n                }\n                if (!expandTimer) {\n                  expandTimer = qx.event.Timer.once(function () {\n                    if (accepted.target) {\n                      control.openNode(accepted.target);\n                    }\n                  }, this, 1000);\n                }\n              }\n            }\n          }\n        }\n        indicator.setDomPosition(left, top);\n        indicator.setUserData('position', position);\n        if (!position && cursor.getAction()) {\n          indicator.setUserData('action', ev.getCurrentAction());\n          cursor.resetAction();\n          // eslint-disable-next-line no-console\n          console.assert(left < 0);\n          // eslint-disable-next-line no-console\n          console.assert(top < 0);\n        } else if (position && !cursor.getAction() && cursor.getAction() !== indicator.getUserData('action')) {\n          cursor.setAction(indicator.getUserData('action'));\n          indicator.setUserData('action', null);\n        }\n      };\n      control.addListener('drag', onDrag, this);\n      addButton.addListener('drag', onDrag, this);\n\n      const onDrop = function (ev) {\n        let action = ev.getCurrentAction();\n        let element = ev.supportsType('cv/tree-element') ? ev.getData('cv/tree-element') : null;\n        if (action === 'copy') {\n          if (element) {\n            element = element.clone();\n          } else {\n            action = 'add';\n          }\n        }\n        const elementName = element ? element.getDisplayName() : 'new';\n        const target = accepted.target;\n        if (action === 'move' && element === target) {\n          // cannot move before/after/inside myself\n          return;\n        }\n        switch (indicator.getUserData('position')) {\n          case 'after':\n            if (accepted.mode & Allowed.AFTER) {\n              this.debug(action, elementName, 'after', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertAfter(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied after \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n          case 'before':\n            if (accepted.mode & Allowed.BEFORE) {\n              this.debug(action, elementName, 'before', target.getDisplayName());\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied before \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', action, elementName, 'after', target.getDisplayName());\n            }\n            break;\n\n          case 'first-child':\n            if (accepted.mode & Allowed.FIRST_CHILD) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as first child');\n              switch (action) {\n                case 'move':\n                  if (element.moveBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (element.insertBefore(target.getChildren().getItem(0))) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\" as first child', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName() + ' as first child');\n            }\n            break;\n\n          case 'inside':\n            if (accepted.mode & Allowed.INSIDE) {\n              this.debug(action, elementName, 'into', target.getDisplayName(), 'as child');\n              switch (action) {\n                case 'move':\n                  if (element.moveInside(target)) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been moved into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'copy':\n                  if (target.insertChild(element, -1, false, 'added')) {\n                    cv.ui.manager.snackbar.Controller.info(this.tr('\"%1\" has been copied into \"%2\"', elementName, target.getDisplayName()));\n                  }\n                  break;\n\n                case 'add':\n                  this._onCreate(target, indicator.getUserData('position'));\n                  break;\n              }\n            } else {\n              this.debug('NOT ALLOWED', elementName, 'into', target.getDisplayName(), 'as child');\n            }\n            break;\n        }\n      }.bind(this);\n\n      control.addListener('drop', onDrop, this);\n      indicator.addListener('drop', onDrop, this);\n\n      const onDragEnd = function(ev) {\n        // Move indicator away\n        indicator.setDomPosition(-1000, -1000);\n        indicator.resetUserData();\n        if (expandTimer) {\n          expandTimer.stop();\n          expandTimer = null;\n        }\n        if (draggedXmlElement) {\n          draggedXmlElement.resetDragging();\n          draggedXmlElement = null;\n        }\n        accepted.target = null;\n        accepted.mode = 0;\n        let cursor = ev.getManager().getCursor();\n        if (!cursor) {\n          cursor = qx.ui.core.DragDropCursor.getInstance();\n        }\n        if (cursor.hasState('touch')) {\n          cursor.removeState('touch');\n        }\n        this.setDragging(false);\n      };\n      control.addListener('dragend', onDragEnd, this);\n      addButton.addListener('dragend', onDragEnd, this);\n    },\n\n    /**\n     * Create a new element an insert if after target\n     *\n     * @param target {cv.ui.manager.model.XmlElement} target element\n     * @param position {String} one of \"after\", \"before\" or \"inside\"\n     * @param elementName {String?} if not set a selection of possible elements at that position will be shown\n     * @private\n     */\n    _onCreate: function (target, position, elementName) {\n      const parent = position === 'inside' || position === 'first-child' ? target : target.getParent();\n      const parentSchemaElement = parent.getSchemaElement();\n      let addable = parent.getAddableChildren(false);\n      if (addable.length > 0) {\n        // check if a child could be added at this position\n        const children = parent.getChildren();\n        // only check if we already have children, because otherwise we can add any child even in ordered sequences\n        if (!parentSchemaElement.areChildrenSortable() && position !== 'inside' && children.length > 0) {\n          // we only care about the first level here\n          const sorting = parentSchemaElement.getFirstLevelElementSorting();\n          let minPosition = 0;\n          let maxPosition = 0;\n          if (position === 'before') {\n            maxPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex > 0) {\n              let found = false;\n              // find the first real element before that is not from the same type\n              for (let i = targetIndex-1; i >= 0; i--) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  minPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                minPosition = maxPosition;\n              }\n            }\n          } else if (position === 'after') {\n            minPosition = sorting[target.getName()];\n            const targetIndex = children.indexOf(target);\n            if (targetIndex < children.length - 1) {\n              // find the first real element after that is not from the same type\n              let found = false;\n              for (let i = targetIndex; i < children.length; i++) {\n                const sibling = children.getItem(i);\n                if (!sibling.getName().startsWith('#') && sibling.getName() !== target.getName()) {\n                  maxPosition = sorting[sibling.getName()];\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) {\n                // only siblings of the same type\n                maxPosition = minPosition;\n              }\n            } else {\n              // we want to append ot to the end\n              maxPosition = minPosition + 1;\n            }\n          } else if (position === 'first-child') {\n            // add before first child\n            const firstChild = children.getItem(0);\n            maxPosition = sorting[firstChild.getName()];\n          }\n          addable = addable.filter(name => Object.prototype.hasOwnProperty.call(sorting, name) && sorting[name] <= maxPosition && sorting[name] >= minPosition);\n        }\n      }\n      if (addable.length > 0) {\n        this.__editing = true;\n        let typeChooserForm;\n        if (addable.length > 1) {\n          // user has to select a type\n          typeChooserForm = new cv.ui.manager.form.ElementForm({\n            allowCancel: true,\n            context: this,\n            message: this.tr('<p style=\\'font-weight:bold\\'>Choose element</p><p>Several possible element can be created at this position, please select one to proceed.</p>'),\n            formData: {\n              type: {\n                type: 'SelectBox',\n                label: this.tr('Choose element'),\n                help: this.tr('Please choose the element you want to add here.'),\n                options: addable.sort((a, b) => {\n                  if (a.startsWith('#') && !b.startsWith('#')) {\n                    return 1;\n                  } else if (!a.startsWith('#') && b.startsWith('#')) {\n                    return -1;\n                  }\n                  return a.localeCompare(b);\n                }).map(name => ({label: name, value: name})),\n                validation: {\n                  required: true\n                }\n              }\n            }\n          }).show().promise();\n        } else {\n          typeChooserForm = Promise.resolve({type: addable[0]});\n        }\n        typeChooserForm.then(result => {\n          if (result) {\n            const type = result.type;\n            // create new element, open the edit dialog and insert it\n            const document = target.getNode().ownerDocument;\n            let element;\n            let isElement = false;\n            switch (type) {\n              case '#comment':\n                element = document.createComment('');\n                break;\n\n              case '#text':\n                element = document.createTextNode('');\n                break;\n\n              case '#cdata-section':\n                element = document.createCDATASection('');\n                break;\n\n              default:\n                element = document.createElement(type);\n                isElement = true;\n                break;\n            }\n            const schemaElement = parentSchemaElement.getSchemaElementForElementName(type);\n\n            const initChildren = function (element, schemaElement) {\n              const requiredChildren = schemaElement.getRequiredElements();\n              if (requiredChildren.length > 1) {\n                if (!schemaElement.areChildrenSortable()) {\n                  // a special order 1s required\n                  const allowedSorting = schemaElement.getAllowedElementsSorting();\n                  requiredChildren.sort(cv.ui.manager.model.schema.Element.sortChildNodes(allowedSorting));\n                }\n              }\n              requiredChildren.forEach(childName => {\n                const child = document.createElement(childName);\n                element.appendChild(child);\n                // do this recursively\n                initChildren(child, schemaElement.getSchemaElementForElementName(childName));\n              });\n              if (schemaElement.isTextContentRequired()) {\n                const child = document.createTextNode('-');\n                element.appendChild(child);\n              }\n            };\n            if (isElement) {\n              initChildren(element, schemaElement);\n            }\n\n            const xmlElement = new cv.ui.manager.model.XmlElement(element, schemaElement, target.getEditor(), parent);\n            // load the \"empty\" element to init the modification comparison\n            xmlElement.load();\n            let res = Promise.resolve(true);\n            if (xmlElement.isShowEditButton()) {\n              // only show edit dialog when we actually have something to edit\n              res = this._onEdit(null, xmlElement, true);\n            }\n            res.then(data => {\n              if (data) {\n                // finally insert the new node\n                switch (position) {\n                  case 'before':\n                    xmlElement.insertBefore(target);\n                    break;\n\n                  case 'after':\n                    xmlElement.insertAfter(target);\n                    break;\n\n                  case 'inside':\n                    target.insertChild(xmlElement, -1, false, 'added');\n                    break;\n\n                  case 'first-child':\n                    target.insertChild(xmlElement, 0, false, 'added');\n                    break;\n                }\n                this.getChildControl('tree').openNodeAndParents(xmlElement);\n                this.getChildControl('tree').setSelection([xmlElement]);\n              }\n            }, this).catch(err => this.error(err));\n          }\n        });\n      }\n    },\n\n    __getAllowedPositions: function (allowedSorting, elementName, targetName, depth) {\n      if (allowedSorting) {\n        let currentPosition = allowedSorting[elementName];\n        if (typeof currentPosition === 'string') {\n          currentPosition = currentPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          currentPosition = [currentPosition];\n        }\n        let targetPosition = allowedSorting[targetName];\n        if (typeof targetPosition === 'string') {\n          targetPosition = targetPosition.split('.').map(i => /^\\d+$/.test(i) ? parseInt(i) : i);\n        } else {\n          targetPosition = [targetPosition];\n        }\n        const depth = Math.min(depth || 1, currentPosition.length, targetPosition.length);\n        for (let i = 0; i < depth; i++) {\n          if (currentPosition[i] === targetPosition[i]) {\n            // no special position\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE | cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] - 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.AFTER;\n          } else if (currentPosition[i] + 1 === targetPosition[i]) {\n            return cv.ui.manager.editor.Tree.Allowed.BEFORE;\n          }\n        }\n      }\n      return cv.ui.manager.editor.Tree.Allowed.NONE;\n    },\n\n    __checkProvider: function (id, formData, element) {\n      const provider = cv.ui.manager.editor.data.Provider.get(id);\n      if (provider) {\n        if (typeof provider.getLive === 'function') {\n          formData.options = provider.getLive(element);\n        } else if (provider.data) {\n          formData.options = provider.data;\n        } else {\n          this.error('misconfigured provider found for ' + id);\n        }\n        formData.type = provider.userInputAllowed ? 'VirtualComboBox' : 'VirtualSelectBox';\n      } else if (['mapping', 'styling'].includes(id.split('@').pop())) {\n        const type = id.split('@').pop();\n        // these are directly filled from data inside the currently used config\n        const tree = this.getChildControl('tree');\n        const rootNode = tree.getModel().getNode();\n        formData.type = 'SelectBox';\n        formData.options = [];\n        rootNode.querySelectorAll('meta > ' + type + 's > ' + type).forEach(element => {\n          const name = element.getAttribute('name');\n          formData.options.push({label: name, value: name});\n        });\n      }\n      if (formData.type.endsWith('SelectBox')) {\n        // not allowed here\n        delete formData.placeholder;\n        if (!formData.validation.required) {\n          if (formData.options instanceof Promise) {\n            formData.options.then(res => {\n              if (Array.isArray(res)) {\n                res.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n              }\n            }).catch(() => {}); // ignore error here, will be handled somewhere else\n          } else {\n            formData.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n          }\n        }\n      }\n    },\n\n    __getAttributeFormDefinition: function (element, attribute) {\n      const docs = attribute.getDocumentation();\n      const def = {\n        type: 'TextField',\n        label: attribute.getName(),\n        placeholder: ' - ' + this.tr('not set') + ' - ',\n        help: docs.join('<br/>'),\n        enabled: element.isEditable(),\n        value: element.getAttribute(attribute.getName()) || attribute.getDefaultValue(),\n        validation: {\n          required: !attribute.isOptional(),\n          validator: function (value) {\n            if (value instanceof qx.ui.form.ListItem) {\n              value = value.getModel().getValue();\n            }\n            if (!attribute.isValueValid(value)) {\n              throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n            }\n          }\n        }\n      };\n      switch (attribute.getTypeString()) {\n        case 'boolean':\n          def.type = 'CheckBox';\n          def.value = def.value === '' || def.value === null || def.value === undefined ? null : def.value === 'true';\n          delete def.placeholder;\n          break;\n\n        case 'string': {\n          const enums = attribute.getEnumeration();\n          if (enums.length > 0) {\n            def.type = 'SelectBox';\n            delete def.placeholder;\n            def.options = [];\n            enums.forEach(name => {\n              def.options.push({label: name, value: name});\n            });\n            if (attribute.isOptional()) {\n              // allow empty value\n              def.options.unshift({label: ' - ' + this.tr('not set') + ' - ', value: ''});\n            }\n          } else {\n            // check if we have a dataprovider for this\n            this.__checkProvider(element.getName() + '@' + attribute.getName(), def, element.getNode());\n          }\n          break;\n        }\n      }\n      return def;\n    },\n\n    _onEdit: function (ev, element, isNew) {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        return null;\n      }\n      let title;\n      let caption;\n      if (!element) {\n        if (this.getSelected()) {\n          element = this.getSelected();\n        } else {\n          return null;\n        }\n      }\n      if (!element.getShowEditButton()) {\n        return null;\n      }\n      element.load();\n      const formData = {};\n      const typeElement = element.getSchemaElement();\n      if (isNew) {\n        title = this.tr('Create new %1 element', element.getName());\n        caption = this.tr('Please edit the attributes of the new %1 element, that will be added to the chosen position.', element.getName());\n      } else {\n        title = this.tr('Edit element attributes');\n        caption = element.isEditable() ? this.tr('Edit %1', element.getName()) : this.tr('Show %1', element.getName());\n      }\n      if (element.getNode().nodeType === Node.ELEMENT_NODE) {\n        const allowed = typeElement.getAllowedAttributes();\n        Object.keys(allowed).forEach(name => {\n          const attribute = allowed[name];\n          if (!this.getExpert()) {\n            const appInfo = attribute.getAppinfo();\n            if (appInfo.includes('level:expert')) {\n              // do not this this attribute\n              return;\n            }\n          }\n          formData[name] = this.__getAttributeFormDefinition(element, attribute);\n        });\n        if (typeElement.isChildElementAllowed('*')) {\n          const parser = new DOMParser();\n          const attrName = element.getNode().nodeName === 'custom' ? '#innerHTML' : '#outerHTML';\n          if (isNew) {\n            title = this.tr('Create new %1 element', element.getName());\n            caption = this.tr('Please edit the content of the new %1 element, that will be added to the chosen position.', element.getName());\n          } else {\n            title = attrName === '#outerHTML' ? this.tr('Edit element and content') : this.tr('Edit element content');\n          }\n          formData[attrName] = {\n            type: 'TextArea',\n            label: '',\n            lines: 5,\n            autoSize: true,\n            width: Math.min(qx.bom.Viewport.getWidth(), 500),\n            enabled: element.isEditable(),\n            value: attrName === '#outerHTML' ? element.getNode().outerHTML : element.getNode().innerHTML,\n            validation: {\n              validator: function (value) {\n                if (value) {\n                  const dom = parser.parseFromString(value, 'text/xml');\n                  if (dom.getElementsByTagName('parsererror').length > 0) {\n                    throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n                  }\n                }\n              }\n            }\n          };\n        }\n      } else if (element.getNode().nodeType === Node.TEXT_NODE || element.getNode().nodeType === Node.COMMENT_NODE || element.getNode().nodeType === Node.CDATA_SECTION_NODE) {\n        title = this.tr('Edit text content', element.getName());\n        caption = '';\n        let nodeName = element.getNode().nodeName;\n        // only in text-only mode we can add text editing to the form\n        const docs = typeElement.getDocumentation();\n        formData[nodeName] = {\n          type: 'TextArea',\n          label: '',\n          lines: 1,\n          autoSize: true,\n          width: Math.min(qx.bom.Viewport.getWidth(), 500),\n          placeholder: this.tr('not set'),\n          help: docs.join('<br/>'),\n          enabled: element.isEditable(),\n          value: element.getTextContent(),\n          validation: {\n            validator: function (value) {\n              if (value instanceof qx.ui.form.ListItem) {\n                value = value.getModel().getValue();\n              }\n              if (!typeElement.isValueValid(value)) {\n                throw new qx.core.ValidationError(qx.locale.Manager.tr('This is not a valid value.'));\n              }\n            }\n          }\n        };\n        if (element.isTextNode() && element.getParent().getName() === 'status') {\n          const type = element.getParent().getAttribute('type');\n          if ((type === 'html' || type === 'xml') && element.getNode().nodeType === Node.TEXT_NODE) {\n            element.convertTextNodeType(Node.CDATA_SECTION_NODE);\n            const newNodeName = element.getNode().nodeName;\n            formData[newNodeName] = formData[nodeName];\n            delete formData[nodeName];\n            nodeName = newNodeName;\n          }\n          // Due to a bug that swallowed whitespaces in the monaco editor from time to time this is disabled for now\n\n          // special handling for status content: check of source editor supports the type and use it instead of a plain TextArea\n          /*if (type && cv.ui.manager.editor.Source.SUPPORTED_FILES(\"test.\" + type)) {\n            formData[nodeName].type = \"SourceEditor\";\n            formData[nodeName].language = type;\n            formData[nodeName].width = Math.min(qx.bom.Viewport.getWidth(), 800);\n            delete formData[nodeName].placeholder;\n          }*/\n        }\n        this.__checkProvider(element.getParent().getName() + '@' + element.getName(), formData[nodeName], element.getNode());\n      }\n      this.__editing = true;\n\n      const formDialog = new cv.ui.manager.form.ElementForm({\n        allowCancel: true,\n        context: this,\n        caption:  title,\n        message: caption,\n        formData: formData,\n        minWidth: Math.min(qx.bom.Viewport.getWidth(), 400),\n        maxWidth: qx.bom.Viewport.getWidth()\n      }).show();\n      return formDialog.promise().then(data => {\n        if (data && element.isEditable()) {\n          // save changes\n          element.setAttributes(data);\n          this.clearReDos();\n          if (!Object.prototype.hasOwnProperty.call(data, '#outerHTML') && !Object.prototype.hasOwnProperty.call(data, '#innerHTML')) {\n            element.validate();\n          }\n        }\n        this.__editing = false;\n        formDialog.destroy();\n        return data;\n      });\n    },\n\n    _onDelete: function (ev, element) {\n      if (!element) {\n        element = this.getSelected();\n      }\n      if (element && element.isDeletable()) {\n        element.remove();\n        this.clearReDos();\n        return element;\n      }\n      return null;\n    },\n\n    _onCut: function () {\n      if (this.__editing) {\n        document.execCommand('cut');\n      } else {\n        const element = this._onDelete();\n        if (element) {\n          this.setClipboard(element);\n        }\n      }\n    },\n\n    _onCopy: function () {\n      if (this.__editing) {\n        document.execCommand('copy');\n      } else {\n        const element = this.getSelected();\n        if (element) {\n          const copy = element.clone();\n          this.setClipboard(copy);\n        }\n      }\n    },\n\n    _onPaste: function () {\n      const target = this.getSelected();\n      const clipboardElement = this.getClipboard();\n      if (target && clipboardElement) {\n        if (target.insertChild(clipboardElement, -1, false, 'added')) {\n          // this was successful, clean the clipboard\n          this.resetClipboard();\n        }\n      }\n    },\n\n    /**\n     * Maintain global modification state.\n     * This method is called by a single cv.ui.manager.model.XmlElement when it has changed its modified state.\n     * @param element {cv.ui.manager.model.XmlElement}\n     */\n    updateModified: function (element) {\n      const index = this.__modifiedElements.indexOf(element);\n      const previewIndex = this.__modifiedPreviewElements.indexOf(element);\n      if (element.$$removed) {\n        // we dont care about elements that have been removed (its the parent that has changed then by loosing a child)\n        if (index >= 0) {\n          this.__modifiedElements.splice(index, 1);\n        }\n        if (previewIndex >= 0) {\n          this.__modifiedPreviewElements.splice(index, 1);\n        }\n      } else if (element.isModified()) {\n          if (index === -1) {\n            this.__modifiedElements.push(element);\n          }\n          if (previewIndex === -1) {\n            this.__modifiedPreviewElements.push(element);\n          }\n        } else {\n          if (index >= 0) {\n            this.__modifiedElements.splice(index, 1);\n          }\n          if (previewIndex >= 0) {\n            this.__modifiedPreviewElements.splice(index, 1);\n          }\n        }\n      this.getFile().setModified(this.__modifiedElements.length > 0);\n      this._onContentChanged();\n    },\n\n    _draw: function () {\n      const toolbar = this.getChildControl('toolbar');\n      this._createChildControl('searchbar');\n      if (!this.hasChildControl('add-button')) {\n        this._createChildControl('add-button');\n      }\n      toolbar.addSeparator();\n      this._createChildControl('edit-button');\n      this._createChildControl('delete-button');\n      toolbar.addSeparator();\n      this._createChildControl('toggle-expert');\n      toolbar.addSpacer();\n      this._createChildControl('refresh-preview');\n\n      if (!this.hasChildControl('tree')) {\n        this._createChildControl('tree');\n      }\n      if (!this.hasChildControl('right')) {\n        this._createChildControl('right');\n      }\n      if (!this.hasChildControl('preview-sync-hint')) {\n        this._createChildControl('preview-sync-hint');\n      }\n      if (!this.hasChildControl('preview')) {\n        this._createChildControl('preview');\n      }\n    },\n\n    _applySelected: function (value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n      }\n      if (value) {\n        this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n        if (this.getFile().isWriteable()) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n        }\n      } else {\n        this.getChildControl('edit-button').setEnabled(false);\n        this.getChildControl('delete-button').setEnabled(false);\n      }\n      this._updateHighlightWidget();\n    },\n\n    _updateHighlightWidget: function () {\n      const selected = this.getSelected();\n      if (this.isShowPreview()) {\n        const preview = this.getChildControl('preview');\n        if (this.getPreviewState() !== 'structureChanged' && selected) {\n          // get page path for this node\n          let path = [];\n          let node = selected.getNode();\n          while (node && node.nodeName !== 'pages') {\n            if (node.nodeName === 'page') {\n              path.unshift(node.getAttribute('name'));\n            }\n            node = node.parentNode;\n          }\n          if (path.length > 0) {\n            preview.openPage(path.pop(), path.join('/'));\n          }\n          preview.setHighlightWidget(selected.getWidgetPath());\n        } else {\n          preview.setHighlightWidget(null);\n        }\n      }\n    },\n\n    _onElementKeyUp: function(ev) {\n      if (this.getSelected() && this.isVisible()) {\n        if (ev.getKeyIdentifier() === 'Enter') {\n          if (!this.__editing) {\n            this._onEdit();\n          }\n        }\n      }\n    },\n\n    _applyContent: function(value) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      this._updatePreview(null, null, true);\n      if (value && file) {\n        if (this._workerWrapper) {\n          this._workerWrapper.open(file, value, null, {\n            validate: false,\n            initialValidation: true,\n            modified: false\n          });\n          this._workerWrapper.validateXmlConfig(value).then(res => {\n            if (res === true) {\n              this.info(file.getPath() + ' is a valid config file');\n              this.__loadContent(value);\n            } else {\n              const dialog = new cv.ui.manager.dialog.ValidationError(file, value, res);\n              dialog.addListener('action', ev => {\n                switch (ev.getData()) {\n                  case 'proceed':\n                    this.__loadContent(value, res);\n                    break;\n\n                  case 'open-source': {\n                    const file = this.getFile();\n                    cv.ui.manager.Main.getInstance().closeFile(file);\n                    qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n                      file: file.getFullPath(),\n                      handler: 'cv.ui.manager.editor.Source',\n                      handlerOptions: {\n                        jumpToError: true\n                      }\n                    });\n                    break;\n                  }\n\n                  case 'cancel':\n                    // close this editor\n                    cv.ui.manager.Main.getInstance().closeFile(this.getFile());\n                    break;\n                }\n                dialog.hide();\n                dialog.destroy();\n              }, this);\n              dialog.show();\n            }\n          });\n        }\n      } else {\n        tree.resetModel();\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setEnabled(false);\n        }\n      }\n    },\n\n    __loadContent: function (value, errors) {\n      const tree = this.getChildControl('tree');\n      const file = this.getFile();\n      if (file) {\n        const document = qx.xml.Document.fromString(value);\n        const schemaElement = this._schema.getElementNode(document.documentElement.nodeName);\n        const rootNode = new cv.ui.manager.model.XmlElement(document.documentElement, schemaElement, this);\n        rootNode.setEditable(file.getWriteable());\n        rootNode.load();\n        tree.setModel(rootNode);\n        if (this.hasChildControl('add-button')) {\n          this.getChildControl('add-button').setVisibility(file.getWriteable() ? 'visible' : 'excluded');\n          // extra space fr add-button\n          tree.setContentPaddingBottom(file.getWriteable() ? 80 : 0);\n        }\n        if (this.isShowPreview()) {\n          const preview = this.getChildControl('preview');\n          if (file.isWriteable()) {\n            if (!preview.getFile()) {\n              const previewConfig = new cv.ui.manager.model.FileItem('visu_config_previewtemp.xml', '/', file.getParent());\n              preview.setFile(previewConfig);\n            }\n          } else {\n            preview.setFile(file);\n          }\n          this._updatePreview(null, value);\n          if (!preview.isVisible()) {\n            preview.show();\n          }\n        }\n        if (file.isTemporary()) {\n          this._onContentChanged();\n        }\n        if (errors) {\n          errors.forEach(error => {\n            if (error.path && error.path.startsWith('/pages')) {\n              let current = rootNode;\n              let parts = error.path.substr(1).split('/');\n              while (parts.length > 0) {\n                let part = parts.shift();\n                let match = /^([^[]+)\\[(\\d+)\\]$/.exec(part);\n                if (match) {\n                  current = current.getChildren().getItem(parseInt(match[2]));\n                  if (current) {\n                    try {\n                      // this can always lead to a loading error, because the element is invalid\n                      current.load();\n                    } catch (e) {\n                      this.error('Error loading ' + current.getName() + ': ' + e.toString());\n                      current = null;\n                      break;\n                    }\n                  } else {\n                    break;\n                  }\n                } else {\n                  this.error('patch segment format error: ' + part);\n                  current = null;\n                  break;\n                }\n              }\n              if (current) {\n                current.setValid(false);\n                current.validate(false);\n                tree.openNodeAndParents(current);\n              }\n            }\n          });\n        }\n      }\n    },\n\n    _onContentChanged: function () {\n      const content = this.getCurrentContent();\n      if (this._workerWrapper) {\n        this._workerWrapper.contentChanged(this.getFile(), content);\n      }\n      if (this.isAutoRefreshPreview() && this.isShowPreview()) {\n        this._updatePreview(null, content);\n      }\n    },\n\n    _updatePreview: function (ev, content, reset) {\n      const previewFile = this.getChildControl('preview').getFile();\n      if (previewFile) {\n        if (!content && !reset) {\n          content = this.getCurrentContent(true);\n        } else if (reset === true) {\n          this.getChildControl('preview').hide();\n          return;\n        }\n        this.getChildControl('preview').show();\n        this._client.updateSync({\n          path: previewFile.getFullPath(),\n          hash: 'ignore'\n        }, content, () => {\n          qx.event.message.Bus.dispatchByName(previewFile.getBusTopic(), {\n            type: 'contentChanged',\n            file: previewFile,\n            data: content,\n            source: this\n          });\n          this.__modifiedPreviewElements.removeAll();\n          this.resetPreviewState();\n        }, this);\n      }\n    },\n\n    getCurrentContent: function (fast) {\n      const tree = this.getChildControl('tree');\n      if (tree.getModel()) {\n        const rootNode = tree.getModel().getNode();\n        if (fast) {\n          return new XMLSerializer().serializeToString(rootNode.ownerDocument);\n        } \n          // prettify content\n          return '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n' + this._prettify(rootNode, 0);\n      } \n        return null;\n    },\n\n    _prettify: function (node, level, singleton) {\n      let tabs = Array(level + 1).fill('').join('\\t');\n      let newLine = '\\n';\n      if (node.nodeType === Node.TEXT_NODE) {\n        if (node.textContent.trim()) {\n          return (singleton ? '' : tabs) + qx.xml.String.escape(node.textContent.trim()) + (singleton ? '' : newLine);\n        } \n          return '';\n      }\n      if (node.nodeType === Node.COMMENT_NODE) {\n        return (singleton ? '' : tabs) + `<!--${node.textContent}--> ${(singleton ? '' : newLine)}`;\n      } else if (node.nodeType === Node.CDATA_SECTION_NODE) {\n        return (singleton ? '' : tabs) + `<![CDATA[${node.textContent}]]> ${(singleton ? '' : newLine)}`;\n      }\n      if (!node.tagName) {\n        return this._prettify(node.firstChild, level);\n      }\n      let output = tabs + `<${node.tagName}`; // >\\n\n      for (let i = 0; i < node.attributes.length; i++) {\n        output += ` ${node.attributes[i].name}=\"${node.attributes[i].value}\"`;\n      }\n      if (node.childNodes.length === 0) {\n        return output + ' />' + newLine;\n      } \n        output += '>';\n      \n      let onlyOneTextChild = ((node.childNodes.length === 1) && (node.childNodes[0].nodeType === 3));\n      if (!onlyOneTextChild) {\n        output += newLine;\n      }\n      for (let i = 0; i < node.childNodes.length; i++) {\n        output += this._prettify(node.childNodes[i], level + 1, onlyOneTextChild);\n      }\n      return output + (onlyOneTextChild ? '' : tabs) + `</${node.tagName}>` + newLine;\n    },\n\n    _onSaved: function () {\n      this.base(arguments);\n      this.__modifiedElements.forEach(elem => elem.onSaved());\n      this.__modifiedElements = [];\n      this.clearUnDosReDos();\n    },\n\n    isSupported: function (file) {\n      return cv.ui.manager.editor.Tree.SUPPORTED_FILES.test(file.getName());\n    },\n\n    _showHelp: function () {\n      const focusedWidget = qx.ui.core.FocusHandler.getInstance().getFocusedWidget();\n      const dialogConf = {\n        caption: this.tr('Help'),\n        modal: true,\n        image: 'qxl.dialog.icon.info',\n        minWidth: Math.min(600, qx.bom.Viewport.getWidth()),\n        maxHeight: qx.bom.Viewport.getHeight(),\n        message: ''\n      };\n      if (focusedWidget === this.getChildControl('searchbar')) {\n        dialogConf.message = this.tr('<h3>Search for elements</h3>\\\n<p>You can search for element names (tag names or content of name attribute) by typing a search value here. \\\nAll elements whose tag name or name-attribute start with the search term will be found</p>\\\n<p>Search will start automatically when the search term is at least 2 characters long.</p>\\\n<p>The first found element will be opened and selected in the element tree. You can jump to the next \\\nfound element with \\'Enter\\' or the \\'Down\\' key. Accordingly you can jump the the previous found element \\\nwith the \\'Up\\' key.</p>');\n      } else {\n        // show general help\n        dialogConf.message = this.tr('<h3>CometVisu XML-Editor - a brief introduction</h3>\\\n<p>The CometVisu XMl-Editor shows the content of a CometVisu config file in a tree-like structure. \\\nYou can traverse through the tree by opening/closing elements with a click on the expand icon.</p>\\\n<p>The Xml-Editor will make sure that you do not create an invalid configuration file. \\\nIf you experience a change that has not been accepted / or is not allowed that is most likely due to avoid an invalid configuration.</p>\\\n<h4>Editing attributes</h4>\\\n<p>The elements attributes can be edited by double clicking on it or selecting an element and clicking on the \\'edit\\'-button in the toolbar \\\nabove the tree of by right-clicking on the element and the \\'edit\\'-button in the context menu</p>\\\n<h4>Editing elements</h4>\\\n<p>The elements in the tree support re-ordering via drag & drop. You can also cut/copy or paste them. \\\nYou can add new elements by starting a drag in the round + button on the bottom of the tree, or \\\nby right clicking on an element and choosing the \\'add child\\'-button.</p>\\\n<p>You can delete elements by the delete buttons in the toolbar</p>\\\n<h4>Expert view</h4>\\\n<p>Some attributes are hidden in the editing dialog, because they provide access to settings that usually \\\nare not needed that often. You can access these attributes by toggling to the \\'Expertview\\'-button \\\nin the toolbar directly above the tree.</p>\\\n<h4>Config preview</h4>\\\n<p>An preview of the edited config file is shown on the right part of the screen. The preview will not automatically \\\nrefresh after you have changed something. You can refresh is manually by clicking the most right button in the toolbar.</p>');\n      }\n      new cv.ui.manager.dialog.BigAlert(dialogConf).show();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._schema = null;\n    this._workerWrapper = null;\n    this._disposeArray('__modifiedElements', '__modifiedPreviewElements');\n    qx.core.Init.getApplication().getRoot().removeListener('keyup', this._onElementKeyUp, this);\n  }\n});\n","/**\n * Monaco Texteditor for file content comparison\n */\nqx.Class.define('cv.ui.manager.editor.Diff', {\n  extend: cv.ui.manager.editor.Source,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    // this._handledActions = [];\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    COUNTER: 0,\n    TITLE: qx.locale.Manager.tr('File compare'),\n    ICON: cv.theme.dark.Images.getIcon('compare', 18)\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    originalContent: {\n      check: 'String',\n      init: '',\n      apply: '_applyContent'\n    },\n\n    modifiedContent: {\n      check: 'String',\n      init: '',\n      apply: '_applyContent'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyEditable'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyEditable: function(value) {\n      if (this._editor) {\n        this._editor.updateOptions({readOnly: !value});\n      }\n    },\n\n    // overridden, worker is a singleton and not usable for the diff editor\n    _initWorker: function () {},\n\n    _draw: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._draw, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', this._draw, this);\n        } else {\n          this._editor = window.monaco.editor.createDiffEditor(domElement, {\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            theme: 'vs-dark',\n            readOnly: !this.getEditable()\n          });\n          if (this.getFile()) {\n            this._loadFile(this.getFile());\n          }\n        }\n      }\n    },\n\n    _applyContent: function () {\n      const original = this.getOriginalContent();\n      const modified = this.getModifiedContent();\n      if (original && modified) {\n        const file = this.getFile();\n        const originalFile = file instanceof cv.ui.manager.model.CompareFiles ? file.getOriginalFile() : file;\n        const modifiedFile = file instanceof cv.ui.manager.model.CompareFiles ? file.getModifiedFile() : file;\n        const originalModel = window.monaco.editor.createModel(original, this._getLanguage(originalFile));\n        originalModel.updateOptions(this._getDefaultModelOptions());\n        const modifiedModel = window.monaco.editor.createModel(modified, this._getLanguage(modifiedFile));\n        modifiedModel.updateOptions(this._getDefaultModelOptions());\n        this._editor.setModel({\n          original: originalModel,\n          modified: modifiedModel\n        });\n      }\n    },\n\n    getCurrentContent: function () {\n      return this._editor.getModifiedEditor().getValue();\n    },\n\n    clear: function () {\n      this._editor.getModel().original.dispose();\n      this._editor.getModel().modified.dispose();\n    },\n\n    save: function (callback) {\n      const handlerOptions = this.getHandlerOptions();\n      if (this.getFile() instanceof cv.ui.manager.model.FileItem && Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true) {\n        this.base(arguments, callback, 'ignore');\n      }\n    },\n\n    _loadFile: function (file, old) {\n      if (old && old instanceof cv.ui.manager.model.FileItem) {\n        qx.event.message.Bus.unsubscribe(old.getBusTopic(), this._onChange, this);\n      }\n      if (this._editor) {\n        const handlerOptions = this.getHandlerOptions();\n        if (file && file instanceof cv.ui.manager.model.FileItem && Object.prototype.hasOwnProperty.call(handlerOptions, 'upgradeVersion') && handlerOptions.upgradeVersion === true) {\n          if (!file.isWriteable()) {\n            cv.ui.manager.snackbar.Controller.error(this.tr('\"%1\" is not writable. Upgrading not possible.', this.getFile().getFullPath()));\n            cv.ui.manager.Main.getInstance().closeFile(file);\n            return;\n          }\n          qx.event.message.Bus.subscribe(file.getBusTopic(), this._onChange, this);\n          this.setEditable(file.isWriteable());\n          this._client.readSync({path: file.getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setOriginalContent(res);\n              const [err, upgradedContent, changes] = this._upgradeConfig(res);\n              if (err) {\n                qxl.dialog.Dialog.error(err);\n                qx.event.message.Bus.dispatchByName('cv.manager.action.close');\n              } else {\n                this.setModifiedContent(this._convertToString(upgradedContent));\n                let changesText = changes.length > 0\n                  ? '<div>' + qx.locale.Manager.tr('The following changes have been made') + '</div>' +\n                  '<ul><li>'+changes.join('</li><li>')+ '</li></ul>' +\n                  '<div>' + qx.locale.Manager.tr('You can check the changes in the editor. The left side shows the content before the upgrade and the right side shows the content after the upgrade.') + '</div>'\n                  : '<div><strong>' + qx.locale.Manager.tr('No changes have been made') + '</strong></div>';\n\n                let msg = '<h3>' + qx.locale.Manager.tr('Config file has been upgraded to the current library version.').translate().toString() + '</h3>' + changesText +\n                  '<div>' + qx.locale.Manager.tr('Click \"Apply\" if you want to save the changes and reload the browser.') + '</div>' +\n                  '<div>' + qx.locale.Manager.tr('Click \"Check\" if you want to check the changes. You have to save the changes and reload your browser yourself in this case.') + '</div>';\n                const d = qxl.dialog.Dialog.confirm(msg, function (ok) {\n                  if (ok) {\n                    this.save(function () {\n                      window.location.reload();\n                    });\n                  }\n                }, this, qx.locale.Manager.tr('Upgrade successful'));\n                d.set({\n                  width: Math.min(qx.bom.Viewport.getWidth(), 600),\n                  yesButtonLabel: qx.locale.Manager.tr('Apply'),\n                  noButtonLabel: qx.locale.Manager.tr('Check')\n                });\n                file.setModified(true);\n              }\n            }\n          }, this);\n        } else if (file && file instanceof cv.ui.manager.model.CompareFiles && this.isSupported(file.getModifiedFile())) {\n          this.resetEditable();\n          this._client.readSync({path: file.getModifiedFile().getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setModifiedContent(res);\n            }\n          }, this);\n\n          this._client.readSync({path: file.getOriginalFile().getFullPath()}, function (err, res) {\n            if (err) {\n              cv.ui.manager.snackbar.Controller.error(err);\n            } else {\n              this.setOriginalContent(res);\n            }\n          }, this);\n        } else {\n          this.resetOriginalContent();\n          this.resetModifiedContent();\n        }\n      }\n    }\n  }\n});\n","/**\n * Editor for the (hidden) configuration.\n */\nqx.Class.define('cv.ui.manager.editor.Config', {\n  extend: cv.ui.manager.editor.AbstractEditor,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._handledActions = ['save'];\n    this._setLayout(new qx.ui.layout.VBox(8));\n    this._createChildControl('list');\n    this._createChildControl('add-section');\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    TITLE: qx.locale.Manager.tr('Hidden configuration')\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _model: null,\n    _listController: null,\n    __initialSectionCount: 0,\n\n    _initClient: function () {\n      this._client = cv.io.rest.Client.getConfigClient();\n      this._client.addListener('getSuccess', this._onModelValueChange, this);\n      this._client.addListener('updateSuccess', this._onSaved, this);\n    },\n\n    _loadFile: function (file) {\n      if (file) {\n        this._client.get({section: '*', key: '*'});\n      }\n    },\n\n    _onModelValueChange: function (ev) {\n      if (this.getFile()) {\n        this.setContent(ev.getData());\n      }\n    },\n\n    // overridden\n    _applyContent: function(value) {\n      const model = this._listController.getModel();\n      model.removeAll();\n\n      this.__initialSectionCount = Object.keys(value).length;\n\n      Object.keys(value).forEach(function (sectionName) {\n        const section = new cv.ui.manager.model.config.Section(sectionName);\n        Object.keys(value[sectionName]).forEach(function (optionKey) {\n          section.addOption(optionKey, value[sectionName][optionKey]);\n        }, this);\n        model.push(section);\n      }, this);\n\n      this.__checkForModification();\n    },\n\n    // overridden\n    getCurrentContent: function () {\n      return this.getContent();\n    },\n\n    _onDeleteSection: function (ev) {\n      if (this.getFile() && this.getFile().isWriteable()) {\n        const section = ev.getData();\n        const model = this._listController.getModel();\n        model.remove(section);\n        this.__checkForModification();\n      }\n    },\n\n    // compare current controller model with the loaded config content\n    __checkForModification: function () {\n      const file = this.getFile();\n      if (this.__initialSectionCount !== this._listController.getModel().length) {\n        file.setModified(true);\n        return;\n      }\n      const modified = this.getChildControl('list').getChildren().some(function (sectionListItem) {\n        return sectionListItem.isModified();\n      }, this);\n      file.setModified(modified);\n    },\n\n    save: function () {\n      if (!this.getFile() || !this.getFile().isWriteable()) {\n        cv.ui.manager.snackbar.Controller.info(this.tr('Hidden configuration file (hidden.php) not writeable'));\n        return;\n      }\n      // check for duplicate section names of keys\n      const model = this._listController.getModel();\n      const keys = [];\n      let valid = true;\n      model.forEach(function (section) {\n        const key = section.getName();\n        if (!keys.includes(key)) {\n          keys.push(key);\n        } else {\n          valid = false;\n          cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section name duplicate: \"%1\".', key));\n        }\n        // check for key duplicates in this sections options\n        const optionKeys = [];\n        section.getOptions().forEach(function (option) {\n          const optionKey = option.getKey();\n          if (!optionKeys.includes(optionKey)) {\n            optionKeys.push(optionKey);\n          } else {\n            valid = false;\n            cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Option key duplicate: \"%1\" in section \"%2\".', optionKey, key));\n          }\n        }, this);\n      }, this);\n\n      if (valid) {\n        const data = {};\n        this._listController.getModel().forEach(function (section) {\n          const options = {};\n          section.getOptions().forEach(function (option) {\n            options[option.getKey()] = option.getValue();\n          });\n          data[section.getName()] = options;\n        }, this);\n        this._client.saveSync(null, data, function (err) {\n          if (err) {\n            cv.ui.manager.snackbar.Controller.error(this.tr('Saving hidden config failed with error %1 (%2)', err.status, err.statusText));\n          } else {\n            cv.ui.manager.snackbar.Controller.info(this.tr('Hidden config has been saved'));\n            this._onSaved();\n          }\n        }, this);\n      } else {\n        cv.ui.manager.snackbar.Controller.error(qx.locale.Manager.tr('Section is invalid and has not been saved.'));\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(new qx.data.Array(), control);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.SectionListItem();\n             },\n\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteSection, this);\n               item.addListener('changeModified', this.__checkForModification, this);\n             }.bind(this),\n\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n               this.bind('file.writeable', item, 'readOnly', {\n                 converter: function (value) {\n                   return !value;\n                 }\n               });\n             }.bind(this)\n           });\n           this._add(control, {flex: 1});\n           break;\n\n         case 'buttons':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox(8));\n           this._add(control);\n           break;\n\n         case 'add-section':\n           control = new qx.ui.form.Button(this.tr('Add section'));\n           control.addListener('execute', function () {\n             this._listController.getModel().push(new cv.ui.manager.model.config.Section(''));\n             this.__checkForModification();\n           }, this);\n           this.bind('file.writeable', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'visible' : 'excluded';\n             }\n           });\n           this.getChildControl('buttons').add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_model', '_listController');\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.editor.Worker', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._files = {};\n    // create WebWorker\n    this._worker = cv.data.FileWorker.getInstance();\n    this._worker.addListener('message', this._onMessage, this);\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    editor: {\n      check: 'cv.ui.manager.editor.AbstractEditor',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _worker: null,\n    _files: null,\n\n    open: function (file, code, schema, features) {\n      this._worker.postMessage(['openFile', {\n        path: file.getFullPath(),\n        code: qx.xml.Document.isXmlDocument(code) ? code.documentElement.outerHTML : code,\n        schema: schema\n      }, features]);\n      this._files[file.getFullPath()] = file;\n    },\n\n    close: function (file) {\n      this._worker.postMessage(['closeFile', {\n        path: file.getFullPath()\n      }]);\n      delete this._files[file.getFullPath()];\n    },\n\n    contentChanged: function (file, content) {\n      this._worker.postMessage(['contentChange', {\n        path: file.getFullPath(),\n        code: content\n      }]);\n    },\n\n    validateConfig: function (file) {\n      if (file.isConfigFile()) {\n        return this._worker.validateConfig(file.getServerPath());\n      }\n      qx.log.Logger.error(this, file.getFullPath() + ' is no configuration file');\n      return true;\n    },\n\n    validateXmlConfig: function (content) {\n      return this._worker.validateXmlConfig(content);\n    },\n\n    _onMessage: function (e) {\n      let topic = e.getData().topic;\n      let data = e.getData().data;\n      let path = e.getData().path;\n      let file = this._files[path];\n      if (!file && topic !== 'validationResult') {\n        qx.log.Logger.error(this, 'no file found for path ' + path + ' ignoring worker message for topic ' + topic);\n        return;\n      }\n      let editor = this.getEditor();\n      switch (topic) {\n        case 'modified':\n          // new files are always modified, to not override that state\n          if (!file.isTemporary()) {\n            file.setModified(data.modified);\n          }\n          file.setHash(data.currentHash);\n          break;\n\n        case 'hash':\n          file.setHash(data);\n          break;\n\n        case 'errors':\n          file.setValid(!data || data.length === 0);\n          if (editor) {\n            editor.showErrors(path, data);\n          }\n          break;\n\n        case 'decorations':\n          if (editor) {\n            editor.showDecorations(path, data);\n          }\n          break;\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._worker.terminate();\n    this._worker = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.contextmenu.FileItem', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (file, noCompare) {\n    this.base(arguments);\n    this._noCompare = noCompare === true;\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n    this._dateFormat = new qx.util.format.DateFormat(qx.locale.Date.getDateFormat('medium'));\n    this._timeFormat = new qx.util.format.DateFormat(qx.locale.Date.getTimeFormat('medium'));\n\n    if (file) {\n      this.configure(file);\n    }\n\n    // only react to events when this menu is visible\n    this.addListener('appear', function () {\n      this.setActive(true);\n    });\n    this.addListener('disappear', function () {\n      this.setActive(false);\n    });\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-file-contextmenu'\n    },\n    \n    /* This flag enables the event handling for this menu */\n    active: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _commandGroup: null,\n    _selectedNode: null,\n    _dateFormat: null,\n    _timeFormat: null,\n    _renameDialog: null,\n    _noCompare: false,\n\n    configure: function (file) {\n      this._selectedNode = file;\n      if (file) {\n        const isFolder = file.getType() === 'dir';\n        const folder = isFolder ? file : file.getParent();\n        let isBackup = false;\n        if (folder && folder.getFullPath().startsWith('backup') || file.getFullPath().startsWith('backup')) {\n          isBackup = true;\n        }\n        if (!isFolder) {\n          this.getChildControl('new-file-button').exclude();\n          this.getChildControl('new-folder-button').exclude();\n        } else {\n          this.getChildControl('new-file-button').set({\n            enabled: folder && !isBackup ? folder.isWriteable() : false,\n            visibility: 'visible'\n          });\n          this.getChildControl('new-folder-button').set({\n            enabled: folder && !isBackup ? folder.isWriteable() : false,\n            visibility: 'visible'\n          });\n        }\n        this.getChildControl('clone-file-button').setVisibility(file.isConfigFile() && !isBackup ? 'visible' : 'excluded');\n        this.getChildControl('delete-button').setLabel(file.isTrash()\n          ? this.tr('Clear')\n          : this.tr('Delete'));\n\n        // create compare menu\n        if (!this._noCompare) {\n          const compareMenu = this.getChildControl('compare-menu');\n          compareMenu.removeAll();\n          if (!isBackup) {\n            this.getChildControl('compare-with-button').show();\n            const backups = cv.ui.manager.model.BackupFolder.getInstance().getBackupFiles(file);\n            this.getChildControl('compare-with-button').setEnabled(backups.length > 0);\n            backups.sort(function (a, b) {\n              return b.date.getTime() - a.date.getTime();\n            });\n            let group = null;\n            backups.forEach(function (backupEntry) {\n              const date = this._dateFormat.format(backupEntry.date);\n              if (group !== date) {\n                if (group !== null) {\n                  compareMenu.add(new qx.ui.menu.Separator());\n                }\n                const groupButton = new qx.ui.menu.Button(date);\n                groupButton.setEnabled(false);\n                compareMenu.add(groupButton);\n                group = date;\n              }\n              const button = new qx.ui.menu.Button(this.tr('Backup from %1', this._timeFormat.format(backupEntry.date)));\n              button.setUserData('file', backupEntry.file);\n              button.addListener('execute', this._onCompareWith, this);\n              compareMenu.add(button);\n            }, this);\n          } else {\n            this.getChildControl('compare-with-button').exclude();\n          }\n        }\n\n        const defaultHandler = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file);\n\n        // open with menu\n        const openWithMenu = this.getChildControl('open-with-menu');\n        openWithMenu.removeAll();\n        if (!isBackup) {\n          this.getChildControl('open-with-button').show();\n          const availableHandlers = cv.ui.manager.control.FileHandlerRegistry.getInstance().getAllFileHandlers(file);\n\n          // this menu only makes sense when there is more than one option to select from\n          this.getChildControl('open-with-button').setEnabled(availableHandlers.length > 1);\n          availableHandlers.sort(function (a, b) {\n            return a.Clazz.constructor.TITLE.toString().localeCompare(b.Clazz.constructor.TITLE.toString());\n          });\n          availableHandlers.forEach(function (handlerConf) {\n            const button = new qx.ui.menu.Button(handlerConf.Clazz.constructor.TITLE, handlerConf.Clazz.constructor.ICON);\n            button.setAppearance('open-with-button');\n            if (defaultHandler.Clazz.classname === handlerConf.Clazz.classname) {\n              button.addState('default');\n            }\n            button.setUserData('handlerId', handlerConf.Clazz.classname);\n            button.addListener('execute', this._onOpenWith, this);\n            openWithMenu.add(button);\n          }, this);\n        } else {\n          this.getChildControl('open-with-button').exclude();\n        }\n\n        // validate button\n        this.getChildControl('validate-config-button').setVisibility(file.isConfigFile() && !file.isMounted() && !isBackup ? 'visible' : 'excluded');\n\n        // replacement button\n        if (!isFolder && !isBackup) {\n          this.getChildControl('replace-button').show();\n          this._replacementManager.setFilename(file.getName());\n          this._replacementManager.setFolder(file.getParent());\n        } else {\n          this.getChildControl('replace-button').exclude();\n        }\n        // buttons that need write access\n        ['delete-button', 'replace-button', 'rename-button'].forEach(function (controlName) {\n          this.getChildControl(controlName).setEnabled(!file.isFake() && file.isWriteable() && (!isBackup || controlName === 'delete-button'));\n        }, this);\n        this.getChildControl('download-button').setEnabled(!file.isFake() && file.getType() === 'file');\n        this.getChildControl('restore-button').setVisibility(file.isInTrash() || isBackup ? 'visible' : 'excluded');\n      } else {\n        this.getChildControl('delete-button').set({\n          label: this.tr('Delete'),\n          enabled: false\n        });\n        this.getChildControl('replace-button').exclude();\n        this.getChildControl('download-button').setEnabled(false);\n        this.getChildControl('restore-button').exclude();\n      }\n    },\n\n    _init: function () {\n      if (!this._noNew) {\n        this.add(this.getChildControl('new-file-button'));\n      }\n      this.add(this.getChildControl('clone-file-button'));\n      if (!this._noNew) {\n        this.add(this.getChildControl('new-folder-button'));\n      }\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('open-button'));\n      this.add(this.getChildControl('open-with-button'));\n      if (!this._noCompare) {\n        this.add(this.getChildControl('compare-with-button'));\n      }\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('rename-button'));\n      this.add(this.getChildControl('delete-button'));\n      this.add(this.getChildControl('restore-button'));\n      this.add(new qx.ui.menu.Separator());\n      this.add(this.getChildControl('download-button'));\n      let sep = new qx.ui.menu.Separator();\n      let button = this.getChildControl('replace-button');\n      this.add(sep);\n      this.add(button);\n      button.bind('visibility', sep, 'visibility');\n      sep = new qx.ui.menu.Separator();\n      button = this.getChildControl('validate-config-button');\n      button.bind('visibility', sep, 'visibility');\n      this.add(sep);\n      this.add(button);\n    },\n\n    _onCompareWith: function (ev) {\n      if (this.isActive()) {\n        const compareWith = ev.getTarget().getUserData('file');\n        qx.event.message.Bus.dispatchByName('cv.manager.compareFiles',\n          new cv.ui.manager.model.CompareFiles(compareWith, this._selectedNode)\n        );\n      }\n    },\n\n    _onOpenWith: function (ev) {\n      if (this.isActive()) {\n        const handlerId = ev.getTarget().getUserData('handlerId');\n        qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n          file: this._selectedNode,\n          handler: handlerId\n        });\n      }\n    },\n\n    _onRename: function () {\n      if (this._selectedNode && this.isActive()) {\n        if (!this._renameDialog) {\n          this._renameDialog = new cv.ui.manager.dialog.Prompt({\n            message: this.tr('New name'),\n            callback: function (name) {\n              if (name && name !== this._selectedNode.getName()) {\n                cv.ui.manager.control.FileController.getInstance().rename(this._selectedNode, name);\n              }\n            },\n            context: this,\n            value: this._selectedNode.getName(),\n            caption: this.tr('Rename file'),\n            filter: /[\\w\\d_\\-\\.\\s]/\n          });\n        }\n        this._renameDialog.show();\n      }\n    },\n\n    _onDownload: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().download(this._selectedNode);\n      }\n    },\n\n    _onRestore: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().restore(this._selectedNode);\n      }\n    },\n\n    _onValidate: function () {\n      if (this._selectedNode && this.isActive()) {\n        cv.ui.manager.control.FileController.getInstance().validate(this._selectedNode);\n      }\n    },\n\n    _onClone: function () {\n      if (this._selectedNode && this.isActive()) {\n        qx.event.message.Bus.dispatchByName('cv.manager.action.clone', {\n          file: this._selectedNode\n        });\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'new-file-button':\n           control = new qx.ui.menu.Button(this.tr('New file'), cv.theme.dark.Images.getIcon('new-file', 18));\n           control.addListener('execute', function () {\n             if (this._selectedNode.isConfigFile()) {\n               qx.event.message.Bus.dispatchByName('cv.manager.action.new-config-file', this._selectedNode.getParent());\n             } else {\n               qx.event.message.Bus.dispatchByName('cv.manager.action.new-file', this._selectedNode.getType() === 'dir' ? this._selectedNode : this._selectedNode.getParent());\n             }\n           }, this);\n           break;\n\n         case 'clone-file-button':\n           control = new qx.ui.menu.Button(this.tr('Clone file'), cv.theme.dark.Images.getIcon('clone-file', 18));\n           control.exclude();\n           control.addListener('execute', this._onClone, this);\n           break;\n\n         case 'new-folder-button':\n           control = new qx.ui.menu.Button(this.tr('New folder'), cv.theme.dark.Images.getIcon('new-folder', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.action.new-folder', this._selectedNode.getType() === 'dir' ? this._selectedNode : this._selectedNode.getParent());\n           }, this);\n           break;\n\n         case 'rename-button':\n           control = new qx.ui.menu.Button(this.tr('Rename'), cv.theme.dark.Images.getIcon('rename', 18));\n           control.addListener('execute', this._onRename, this);\n           break;\n\n         case 'delete-button':\n           control = new qx.ui.menu.Button(this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.action.delete', this._selectedNode);\n           }, this);\n           break;\n\n         case 'download-button':\n           control = new qx.ui.menu.Button(this.tr('Download'), cv.theme.dark.Images.getIcon('download', 18));\n           control.addListener('execute', this._onDownload, this);\n           break;\n\n         case 'open-button':\n           control = new qx.ui.menu.Button(this.tr('Open'), cv.theme.dark.Images.getIcon('open', 18));\n           control.addListener('execute', function () {\n             qx.event.message.Bus.dispatchByName('cv.manager.open', this._selectedNode);\n           }, this);\n           break;\n\n         case 'restore-button':\n           control = new qx.ui.menu.Button(this.tr('Restore'), cv.theme.dark.Images.getIcon('trash', 18));\n           control.exclude();\n           control.addListener('execute', this._onRestore, this);\n           break;\n\n         case 'validate-config-button':\n           control = new qx.ui.menu.Button(this.tr('Validate'), cv.theme.dark.Images.getIcon('validate', 18));\n           control.exclude();\n           control.addListener('execute', this._onValidate, this);\n           break;\n\n         case 'replace-button':\n           control = new com.zenesis.qx.upload.UploadMenuButton(this.tr('Replace'), cv.theme.dark.Images.getIcon('upload', 18));\n           control.exclude();\n           this._replacementManager = new cv.ui.manager.upload.UploadMgr();\n           this._replacementManager.setForce(true);\n           this._replacementManager.addWidget(control);\n           break;\n\n         case 'compare-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'compare-with-button':\n           control = new qx.ui.menu.Button(this.tr('Compare with...'), cv.theme.dark.Images.getIcon('compare', 18), null, this.getChildControl('compare-menu'));\n           break;\n\n         case 'open-with-button':\n           control = new qx.ui.menu.Button(this.tr('Open with...'), cv.theme.dark.Images.getIcon('open-with', 18), null, this.getChildControl('open-with-menu'));\n           break;\n\n         case 'open-with-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n    this._renameDialog = null;\n    this._disposeObjects('_dateFormat', '_timeFormat');\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.contextmenu.GlobalFileItem', {\n  extend: cv.ui.manager.contextmenu.FileItem,\n  type: 'singleton'\n});\n","/**\n * Widget for filesystem items in a virtual tree.\n */\nqx.Class.define('cv.ui.manager.tree.VirtualFsItem', {\n  extend: qx.ui.tree.VirtualTreeItem,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'fs-tree-item'\n    },\n\n    editing: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyEditing'\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName'\n    },\n\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyTemporary'\n    },\n\n    status: {\n      check: ['valid', 'error'],\n      nullable: true,\n      apply: '_applyStatus'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    _applyEditing: function (value, old) {\n      if (value !== old) {\n        const field = this.getChildControl('edit');\n        if (value) {\n          field.setValue(this.getLabel());\n          field.show();\n          qx.event.message.Bus.dispatchByName('cv.manager.tree.enable', false);\n        } else {\n          qx.event.message.Bus.dispatchByName('cv.manager.tree.enable', true);\n          field.exclude();\n          // save new name\n          if (field.getValue() !== this.getName()) {\n            cv.ui.manager.control.FileController.getInstance().rename(this.getModel(), field.getValue());\n          }\n        }\n      }\n    },\n    _applyTemporary: function (value) {\n      if (value) {\n        this.addState('temporary');\n      } else {\n        this.removeState('temporary');\n      }\n    },\n\n    // overridden\n    _applyModel : function(value, old) {\n      this.base(arguments, value, old);\n      if (old) {\n        old.removeRelatedBindings(this);\n      }\n      if (value) {\n        if (value.isTrash()) {\n          this.setLabel(this.tr('Trash'));\n        } else {\n          value.bind('name', this, 'label');\n          value.bind('valid', this, 'status', {\n            converter: function (value) {\n              return value === true ? 'valid' : 'error';\n            }\n          });\n        }\n        value.bind('temporary', this, 'temporary');\n        if (value.getType() === 'dir') {\n          this.setDroppable(true);\n          this.addListener('drop', this._onDrop, this);\n        } else {\n          this.setDroppable(false);\n          this.removeListener('drop', this._onDrop, this);\n        }\n      }\n    },\n\n    _applyStatus: function (value) {\n      const control = this.getChildControl('icon');\n      if (value) {\n        switch (value) {\n          case 'valid':\n            control.removeState('error');\n            break;\n\n          case 'error':\n            control.addState('error');\n            break;\n        }\n      }\n    },\n\n    /**\n     * Handle drop events\n     * @param ev {Event}\n     * @private\n     */\n    _onDrop: function (ev) {\n      this.info(ev.getRelatedTarget());\n    },\n\n    __cancelEditing: function () {\n      this.getChildControl('edit').setValue(this.getName());\n      this.setEditing(false);\n    },\n\n    _onKeypress: function (ev) {\n      if (ev.getKeyIdentifier() === 'Enter') {\n        this.setEditing(false);\n      } else if (ev.getKeyIdentifier() === 'Esc') {\n        this.__cancelEditing();\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'edit':\n           control = new qx.ui.form.TextField();\n           control.addListener('keypress', this._onKeypress, this);\n           control.exclude();\n           control.addListener('changeVisibility', function (ev) {\n              if (ev.getData() === 'visible') {\n                this.getChildControl('label').exclude();\n              } else {\n                this.getChildControl('label').show();\n              }\n           }, this);\n           control.addListener('blur', function () {\n             this.setEditing(false);\n           }, this);\n           this._add(control);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  }\n});\n","/**\n * A qx.ui.form.ListItem with an additional label overlay over the icon to show the file type\n */\nqx.Class.define('cv.ui.manager.form.FileListItem', {\n  extend: qx.ui.core.Widget,\n  implement : [qx.ui.form.IModel],\n  include: [cv.ui.manager.upload.MDragUpload],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label, icon, model) {\n    this.base(arguments, label, icon);\n    const layout = new qx.ui.layout.Canvas();\n    layout.setDesktop(true);\n    this._setLayout(layout);\n\n    if (model) {\n      this.setModel(model);\n    }\n    this.addListener('pointerover', this._onPointerOver, this);\n    this.addListener('pointerout', this._onPointerOut, this);\n\n    cv.ui.manager.model.Preferences.getInstance().addListener('changeDefaultConfigEditor', this._maintainFileActions, this);\n\n    this.setUploadHint(this.tr('Drop the file here to replace the content.'));\n  },\n\n  /*\n  *****************************************************************************\n     EVENTS\n  *****************************************************************************\n  */\n  events: {\n    /** (Fired by {@link qx.ui.form.List}) */\n    'action' : 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-file-item'\n    },\n\n    model: {\n      nullable: true,\n      event: 'changeModel',\n      apply: '_applyModel',\n      dereference: true,\n      check: 'cv.ui.manager.model.FileItem'\n    },\n\n    /**\n     * Show the action buttons.\n     */\n    showFileActions: {\n      check: 'Boolean',\n      init: false,\n      apply: '_maintainFileActions'\n    },\n\n    /** The label/caption/text of the qx.ui.basic.Atom instance */\n    label: {\n      nullable: true,\n      check: 'String',\n      event: 'changeLabel'\n    },\n\n    /** Any URI String supported by qx.ui.basic.Image to display an icon */\n    icon: {\n      check: 'String',\n      nullable: true,\n      themeable: true,\n      event: 'changeIcon'\n    },\n\n    /**\n     * The space between the icon and the label\n     */\n    gap: {\n      check : 'Integer',\n      nullable : false,\n      event : 'changeGap',\n      themeable : true,\n      init : 4\n    },\n\n\n    /**\n     * Configure the visibility of the sub elements/widgets.\n     * Possible values: both, label, icon\n     */\n    show: {\n      init : 'both',\n      check : [ 'both', 'label', 'icon' ],\n      themeable : true,\n      inheritable : true,\n      event : 'changeShow'\n    },\n\n\n    /**\n     * The position of the icon in relation to the text.\n     * Only useful/needed if text and icon is configured and 'show' is configured as 'both' (default)\n     */\n    iconPosition: {\n      init   : 'left',\n      check : ['top', 'right', 'bottom', 'left', 'top-left', 'bottom-left', 'top-right', 'bottom-right'],\n      themeable : true,\n      event: 'changeIconPosition'\n    },\n\n\n    /**\n     * Whether the content should be rendered centrally when to much space\n     * is available. Enabling this property centers in both axis. The behavior\n     * when disabled of the centering depends on the {@link #iconPosition} property.\n     * If the icon position is <code>left</code> or <code>right</code>, the X axis\n     * is not centered, only the Y axis. If the icon position is <code>top</code>\n     * or <code>bottom</code>, the Y axis is not centered. In case of e.g. an\n     * icon position of <code>top-left</code> no axis is centered.\n     */\n    center : {\n      init : false,\n      check : 'Boolean',\n      themeable : true,\n      event: 'changeCenter'\n    },\n\n    /**\n     * Restrict possible file uploads (not supported by every browxer)\n     */\n    acceptUpload: {\n      init: null,\n      nullable: true,\n      check: 'String'\n    },\n\n    viewMode: {\n      check: ['list', 'preview'],\n      init: 'preview',\n      apply: '_applyViewMode'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    _uploadManager: null,\n\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates: {\n      focused : true,\n      selected : true,\n      dragover : true,\n      hovered: true\n    },\n\n    _applyViewMode: function () {\n      switch (this.getViewMode()) {\n        case 'list':\n          this.addState('list');\n          this.getChildControl('atom').setLayoutProperties({left: 10, top: 0, bottom: 0, right: null});\n          this.getChildControl('bottom-bar').setLayoutProperties({top: 0, bottom: 0, right: 0, left: null});\n          break;\n\n        case 'preview':\n          this.removeState('list');\n          this.getChildControl('atom').setLayoutProperties({left: 0, top: 0, bottom: 34, right: 0});\n          this.getChildControl('bottom-bar').setLayoutProperties({left: 0, bottom: 0, right: 0, top: null});\n          break;\n      }\n    },\n\n    /**\n     * Event handler for the pointer over event.\n     */\n    _onPointerOver : function() {\n      this.addState('hovered');\n    },\n\n\n    /**\n     * Event handler for the pointer out event.\n     */\n    _onPointerOut : function() {\n      this.removeState('hovered');\n    },\n\n    _isDroppable: function (files) {\n      if (files.length === 1) {\n        if (this.getModel().getSpecial() === 'add-file') {\n          return true;\n        }\n        const myMime = cv.ui.manager.tree.FileSystem.getMimetypeFromSuffix(this.getModel().getName().split('.').pop());\n        return myMime === files[0].type;\n      }\n      return false;\n    },\n\n    _onDrop: function (ev) {\n      ev.preventDefault();\n      if (this.getModel().getSpecial() === 'add-file') {\n        cv.ui.manager.upload.MDragUpload.uploadFile(cv.ui.manager.upload.MDragUpload.getFiles(ev)[0]);\n      } else {\n        qxl.dialog.Dialog.confirm(this.tr('Do you really want to replace the \\'%1\\' with the uploaded files content?', this.getModel().getName()), function (confirmed) {\n          if (confirmed) {\n            const newFile = cv.ui.manager.upload.MDragUpload.getFiles(ev)[0];\n            cv.ui.manager.upload.MDragUpload.uploadFile(newFile, this.getModel());\n          }\n        }, this);\n      }\n      this._onStopDragging(ev);\n    },\n\n    _applyModel: function (value) {\n      if (value && value.getType() === 'file') {\n        const control = this.getChildControl('file-type');\n        if (!value.isFake()) {\n          const name = value.getName();\n          this.getChildControl('atom').setToolTipText(this.tr('Double click to open \"%1\"', name));\n          let type = name.split('.').pop();\n\n          // do not use file types that are longer than 4 chars (not enough space)\n          if (type.length <= 4) {\n            let handled = false;\n            switch (type) {\n              case 'xml':\n                control.setValue('</>');\n                handled = true;\n                break;\n\n              case 'js':\n                type = qx.lang.String.firstUp(type); // jshint ignore:line\n              // eslint-disable-next-line no-fallthrough\n              case 'css':\n              case 'conf':\n                control.setValue(type);\n                handled = true;\n                break;\n            }\n            if (handled && this.getViewMode() === 'preview') {\n              control.show();\n            } else {\n              control.exclude();\n            }\n          } else {\n            control.exclude();\n          }\n        }\n      } else {\n        this.getChildControl('file-type').exclude();\n        this.getChildControl('atom').resetToolTipText();\n      }\n      // this.getChildControl('bottom-bar').show();\n      // this.setUploadHint(this.tr('Drop the file here to replace the content.'));\n      // this.getChildControl('atom').setToolTipText(this.tr('Double click to open'));\n      this._maintainFileActions();\n      // if (this._uploadManager) {\n      //   try {\n      //     this._uploadManager.removeWidget(this);\n      //   } catch (e) {}\n      // }\n    },\n\n    _onOpenWith: function (ev) {\n      const handlerId = ev.getTarget().getUserData('handlerId');\n      qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n        file: this.getModel(),\n        handler: handlerId\n      });\n    },\n\n    _applyIcon: function (value, old) {\n      this.base(arguments, value, old);\n      if (value && !value.startsWith('@')) {\n        const control = this.getChildControl('atom').getChildControl('icon');\n        if (!cv.ui.manager.viewer.Image.getImageData(value)) {\n          // wait for image to be loaded\n          control.addListenerOnce('loaded', this.__scaleWithAspect, this);\n        } else {\n          this.__scaleWithAspect();\n        }\n      }\n    },\n\n    _maintainFileActions: function () {\n      const file = this.getModel();\n      if (this.isShowFileActions() && file) {\n        this.getChildControl('download-button').setVisibility(file.getType() === 'dir' || file.isFake() ? 'excluded' : 'visible');\n        this.getChildControl('action-button').setVisibility(file.isFake() ? 'excluded' : 'visible');\n        const editorConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, 'edit');\n        const viewerConf = cv.ui.manager.control.FileHandlerRegistry.getInstance().getFileHandler(file, 'view');\n        const openButton = this.getChildControl('open-button');\n        const editButton = this.getChildControl('edit-button');\n        if (file.isWriteable() && editorConf) {\n          editButton.setUserData('handlerId', editorConf.Clazz.classname);\n          editButton.set({\n            icon: editorConf.Clazz.ICON || cv.theme.dark.Images.getIcon('edit', 18),\n            enabled: true,\n            toolTipText: editorConf.Clazz.TITLE ? editorConf.Clazz.TITLE.translate().toString() : ''\n          });\n          editButton.show();\n        } else {\n          editButton.exclude();\n        }\n        if (viewerConf) {\n          openButton.setUserData('handlerId', viewerConf.Clazz.classname);\n          openButton.set({\n            icon: viewerConf.Clazz.ICON || cv.theme.dark.Images.getIcon('preview', 18),\n            enabled: true,\n            toolTipText: viewerConf.Clazz.TITLE ? viewerConf.Clazz.TITLE.translate().toString() : ''\n          });\n          openButton.show();\n        } else {\n          openButton.exclude();\n        }\n        this.getChildControl('action-button');\n        this.getChildControl('bottom-bar').show();\n      } else {\n        this.getChildControl('bottom-bar').exclude();\n      }\n    },\n\n    __scaleWithAspect: function () {\n      const data = cv.ui.manager.viewer.Image.getImageData(this.getIcon());\n      const control = this.getChildControl('atom').getChildControl('icon');\n      const sizeHint = control.getSizeHint();\n      let width = sizeHint.width;\n      let height = Math.round(1 / data.aspectRatio * width);\n      const padding = [0, 0, 0, 0];\n      if (height > sizeHint.height) {\n        height = sizeHint.height;\n        width = Math.round(data.aspectRatio * height);\n        padding[1] = Math.round((sizeHint.width - width) / 2);\n        padding[3] = padding[1];\n      } else {\n        padding[0] = Math.round((sizeHint.height - height) / 2);\n        padding[2] = padding[0];\n      }\n      control.setPadding(padding);\n    },\n\n    _maintainFileTypePosition: function () {\n      const iconBounds = this.getChildControl('atom').getChildControl('icon').getBounds();\n      const top = Math.round(iconBounds.top + iconBounds.height / 2);\n      this.getChildControl('file-type').setLayoutProperties({\n        left: iconBounds.left,\n        top: top,\n        right: iconBounds.left + iconBounds.width,\n        bottom: top + 18\n      });\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n        case 'atom':\n          control = new qx.ui.basic.Atom();\n          ['label', 'icon', 'gap', 'iconPosition', 'show', 'center'].forEach(function (prop) {\n            this.bind(prop, control, prop);\n          }, this);\n          control.setAnonymous(true);\n          this._add(control, {top: 0, left: 0, right: 0, bottom: 34});\n          break;\n\n        case 'file-type': {\n          control = new qx.ui.basic.Label();\n          control.set({\n            zIndex: 100,\n            anonymous: true,\n            font: 'title',\n            textAlign: 'center',\n            textColor: 'background-main',\n            minWidth: 70\n          });\n          const icon = this.getChildControl('atom').getChildControl('icon');\n          icon.bind('visibility', control, 'visibility');\n          icon.addListener('resize', this._maintainFileTypePosition, this);\n          this._add(control, {width: '100%'});\n          break;\n        }\n\n        case 'bottom-bar':\n          control = new qx.ui.container.Composite(new qx.ui.layout.HBox(4, 'center'));\n          control.setAnonymous(true);\n          this._add(control, {left: 0, bottom: 0, right: 0});\n          break;\n\n        case 'download-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('download', 18));\n          control.setToolTipText(this.tr('Download file'));\n          control.addListener('execute', function () {\n            cv.ui.manager.control.FileController.getInstance().download(this.getModel());\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n\n        case 'action-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('menu', 18));\n          control.setToolTipText(this.tr('Other file actions'));\n          this.getChildControl('bottom-bar').add(control);\n          control.addListener('tap', function (ev) {\n            this.fireEvent('action', qx.event.type.Tap, [ev.getNativeEvent(), this, ev.getTarget(), false, true]);\n          }, this);\n          break;\n\n        case 'open-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('preview', 18));\n          control.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n              file: this.getModel(),\n              handler: control.getUserData('handlerId')\n            });\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n\n        case 'edit-button':\n          control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('preview', 18));\n          control.addListener('execute', function () {\n            qx.event.message.Bus.dispatchByName('cv.manager.openWith', {\n              file: this.getModel(),\n              handler: control.getUserData('handlerId')\n            });\n          }, this);\n          this.getChildControl('bottom-bar').add(control);\n          break;\n      }\n      if (!control) {\n        control = this._createMDragUploadChildControlImpl(id);\n      }\n\n      return control || this.base(arguments, id);\n    },\n\n    // overridden\n    capture: function () {\n      // do not fire capture method for upload-items (see: com.zenesis.qx.upload.MUploadButton)\n      if (!this.getFile() || this.getFile().getSpecial() !== 'add-file') {\n        this.base(arguments);\n      }\n    },\n\n    // overridden\n    releaseCapture: function() {\n      // do not fire capture method for upload-items (see: com.zenesis.qx.upload.MUploadButton)\n      if (!this.getFile() || this.getFile().getSpecial() !== 'add-file') {\n        this.base(arguments);\n      }\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.removeListener('pointerover', this._onPointerOver, this);\n    this.removeListener('pointerout', this._onPointerOut, this);\n\n    this._disposeObjects('_uploadManager');\n    cv.ui.manager.model.Preferences.getInstance().removeListener('changeDefaultConfigEditor', this._maintainFileActions, this);\n  }\n});\n","/**\n * Atom with cv.ui.manager.viewer.SvgIcon instead ob an qx.ui.basic.Image\n */\nqx.Class.define('cv.ui.manager.core.IconAtom', {\n  extend: qx.ui.basic.Atom,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-icon'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyLabel: function (value) {\n      this.base(arguments, value);\n      this.getChildControl('icon').setName(value);\n    },\n\n    /**\n     * Updates the visibility of the icon\n     */\n    _handleIcon : function() {\n      if (!this.getChildControl('icon').getName() || this.getShow() === 'label') {\n        this._excludeChildControl('icon');\n      } else {\n        this._showChildControl('icon');\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new cv.ui.manager.viewer.SvgIcon();\n           control.setAnonymous(true);\n           this._addAt(control, 0);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  }\n});\n","/**\n * XSD-based code completion provider for the monaco text editor.\n *\n * @since 0.11.0\n * @author Tobias Brutigam\n */\nqx.Class.define('cv.ui.manager.editor.completion.Config', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   *\n   * @param schema {cv.ui.manager.model.Schema}\n   */\n  construct: function (schema) {\n    this.base(arguments);\n    this.__elementCache = {};\n    this._schema = schema;\n    this._dataProvider = cv.ui.manager.editor.data.Provider.getInstance();\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __elementCache: null,\n    __metaElementCache: null,\n    _dataProvider: null,\n\n    getLastOpenedTag: function (text) {\n      // get all tags inside of the content\n      const tags = text.match(/<\\/*(?=\\S*)([a-zA-Z-]+)/g);\n      if (!tags) {\n        return null;\n      }\n      // we need to know which tags are closed\n      const closingTags = [];\n      for (let i = tags.length - 1; i >= 0; i--) {\n        if (tags[i].indexOf('</') === 0) {\n          closingTags.push(tags[i].substring('</'.length));\n        } else {\n          // get the last position of the tag\n          const tagPosition = text.lastIndexOf(tags[i]);\n          const tag = tags[i].substring('<'.length);\n          const closingBracketIdx = text.indexOf('/>', tagPosition);\n          // if the tag wasn't closed\n          if (closingBracketIdx === -1) {\n            // if there are no closing tags or the current tag wasn't closed\n            if (!closingTags.length || closingTags[closingTags.length - 1] !== tag) {\n              // we found our tag, but let's get the information if we are looking for\n              // a child element or an attribute\n              text = text.substring(tagPosition);\n\n              const openedTag = text.indexOf('<') > text.indexOf('>');\n              let contentSearch = false;\n              let currentAttribute = null;\n              if (openedTag) {\n                const attrMatch = /([\\w\\-_\\.\\d]+)=\"[^\"]*$/.exec(text);\n                contentSearch = !!attrMatch;\n                currentAttribute = attrMatch ? attrMatch[1] : null;\n              }\n              const filteredElementSearch = /<[\\w-_\\d]+$/.test(text);\n              return {\n                tagName: tag,\n                currentAttribute: currentAttribute,\n                filteredElementSearch: filteredElementSearch,\n                isAttributeSearch: !filteredElementSearch && openedTag && !contentSearch,\n                isContentSearch: contentSearch,\n                text: text\n              };\n            }\n            // remove the last closed tag\n            closingTags.splice(closingTags.length - 1, 1);\n          }\n          // remove the last checked tag and continue processing the rest of the content\n          text = text.substring(0, tagPosition);\n        }\n      }\n      return null;\n    },\n\n    findElements: function (parent, elementName, maxDepth, currentDepth, inMeta) {\n      const cache = inMeta === true ? this.__metaElementCache : this.__elementCache;\n      if (elementName in cache) {\n        return cache[elementName];\n      }\n      if (maxDepth < currentDepth) {\n        return null;\n      }\n      if (!parent) {\n        parent = this._schema.getElementNode('pages');\n      }\n      if (currentDepth === undefined) {\n        currentDepth = 1;\n      }\n      const allowedElements = parent.getAllowedElements();\n      // console.log(parent.name+\" looking for \"+elementName+\" in tree level \"+currentDepth+ \"(<\"+maxDepth+\") (\"+Object.getOwnPropertyNames(allowedElements).join(\", \")+\")\");\n      if (elementName in allowedElements) {\n        // console.log(\"found \"+elementName+\" in tree level \"+currentDepth);\n        this.__elementCache[elementName] = allowedElements[elementName];\n        return allowedElements[elementName];\n      }\n      for (let element in allowedElements) {\n        if (inMeta !== true && element === 'meta') {\n          continue;\n        }\n        if (maxDepth > currentDepth) {\n          const result = this.findElements(allowedElements[element], elementName, maxDepth, currentDepth + 1);\n          if (result) {\n            cache[elementName] = result;\n            // console.log(\"found \" + elementName + \" in tree level \" + currentDepth);\n            return result;\n          }\n        }\n      }\n      return null;\n    },\n\n    isItemAvailable: function (itemName, maxOccurs, items) {\n      // the default for 'maxOccurs' is 1\n      maxOccurs = maxOccurs || '1';\n      // the element can appere infinite times, so it is available\n      if (maxOccurs && maxOccurs === 'unbounded') {\n        return true;\n      }\n      // count how many times the element appeared\n      let count = 0;\n      for (let i = 0; i < items.length; i++) {\n        if (items[i] === itemName) {\n          count++;\n        }\n      }\n      // if it didn't appear yet, or it can appear again, then it\n      // is available, otherwise it't not\n      return count === 0 || parseInt(maxOccurs) > count;\n    },\n\n    getElementString: function (element, indent, prefix) {\n      let insertText = indent + prefix + element.getName() + ' ';\n      // add all required attributes with default values\n      const allowedAttributes = element.getAllowedAttributes();\n      Object.getOwnPropertyNames(allowedAttributes).forEach(function(attr) {\n        const attribute = allowedAttributes[attr];\n        if (!attribute.isOptional) {\n          insertText += attr+'=\"'+(attribute.getDefaultValue() ? attribute.getDefaultValue() : '')+'\" ';\n        }\n      });\n      // add mandatory children\n      const requiredElements = element.getRequiredElements();\n      const allowedContent = element.getAllowedContent();\n      const isContentAllowed = allowedContent._text || requiredElements.length > 0 || !!allowedContent._grouping;\n      if (!isContentAllowed) {\n        // close tag\n        insertText = insertText.trim()+'/';\n      } else {\n        // close open tag\n        insertText = insertText.trim()+'>';\n\n        // insert required elements\n        let children = 0;\n        requiredElements.forEach(function(elemName) {\n          const elem = this.findElements(element, elemName, 1, 0);\n          if (elem) {\n            insertText += '\\n    ' + this.getElementString(elem, indent + '    ', '<') + '>';\n            children++;\n          }\n        }, this);\n        // add closing tag\n        if (children > 0) {\n          insertText += '\\n'+indent;\n        }\n        insertText += '</'+element.getName();\n      }\n      return insertText;\n    },\n\n    getAvailableElements: function (element, usedItems) {\n      const availableItems = [];\n      const children = element.getAllowedElements();\n\n      // if there are no such elements, then there are no suggestions\n      if (!children) {\n        return [];\n      }\n      Object.getOwnPropertyNames(children).filter(name => !name.startsWith('#')).forEach(function(name) {\n        // get all element attributes\n        const childElem = children[name];\n        // the element is a suggestion if it's available\n        if (this.isItemAvailable(childElem.getName(), childElem.getBounds().max, usedItems)) {\n          // mark it as a 'field', and get the documentation\n          availableItems.push({\n            label: childElem.getName(),\n            insertText: this.getElementString(childElem, '', ''),\n            kind: window.monaco.languages.CompletionItemKind.Field,\n            detail: childElem.getType(),\n            documentation: childElem.getDocumentation().join('\\n')\n          });\n        }\n      }, this);\n      // return the suggestions we found\n      return availableItems;\n    },\n\n    getAvailableAttributes: function (element, usedChildTags) {\n      const availableItems = [];\n      // get all attributes for the element\n      const attrs = element.getAllowedAttributes();\n      Object.getOwnPropertyNames(attrs).forEach(function(name) { // jshint ignore:line\n        const attr = attrs[name];\n        // accept it in a suggestion list only the attribute is not used yet\n        if (usedChildTags.indexOf(attr.name) === -1) {\n          // mark it as a 'property', and get it's documentation\n          availableItems.push({\n            label: attr.getName(),\n            insertText: attr.getName()+'=\"\"',\n            kind: window.monaco.languages.CompletionItemKind.Property,\n            detail: attr.getTypeString(),\n            documentation: attr.getDocumentation().join('\\n')\n          });\n        }\n      }, this);\n\n      // return the elements we found\n      return availableItems;\n    },\n\n    getProvider: function () {\n      return {\n        triggerCharacters: ['<', '\"'],\n        provideCompletionItems: function (model, position) {\n          // get editor content before the pointer\n          const textUntilPosition = model.getValueInRange({\n            startLineNumber: 1,\n            startColumn: 1,\n            endLineNumber: position.lineNumber,\n            endColumn: position.column\n          });\n          // parse mappings\n          const completeText = model.getValue();\n          const metaEndPos = completeText.indexOf('</meta>');\n          const textMeta = metaEndPos > 0 ? completeText.substring(0, metaEndPos) : completeText;\n          const mappingNames = [];\n          const stylingNames = [];\n          const templates = {};\n          let map;\n          let vmap;\n          let regex = /<mapping name=\"([^\"]+)\"/gm;\n          while ((map = regex.exec(textMeta)) !== null) {\n            mappingNames.push(map[1]);\n          }\n          regex = /<styling name=\"([^\"]+)\"/gm;\n          while ((map = regex.exec(textMeta)) !== null) {\n            stylingNames.push(map[1]);\n          }\n          const templatesStart = textMeta.indexOf('<templates>');\n          if (templatesStart >= 0) {\n            const templatesString = textMeta.substring(templatesStart + 11, textMeta.indexOf('</templates>') - 12).replace(/(?:\\r\\n|\\r|\\n)/g, '');\n            templatesString.split('</template>').forEach(function (rawTemplate) {\n              const nameMatch = /<template name=\"([^\"]+)\"/.exec(rawTemplate);\n              // search for variables\n              const variables = [];\n              const vregex = /{{{?\\s*([\\w\\d]+)\\s*}?}}/gm;\n              while ((vmap = vregex.exec(rawTemplate)) !== null) {\n                variables.push(vmap[1]);\n              }\n              templates[nameMatch[1]] = variables;\n            }, this);\n          }\n\n          // if we want suggestions, inside of which tag are we?\n          const lastOpenedTag = this.getLastOpenedTag(textUntilPosition);\n          // console.log(lastOpenedTag);\n          // get opened tags to see what tag we should look for in the XSD schema\n          const openedTags = [];\n          // attrobutes of the ancestors\n          const openedAttributes = [];\n          // get the elements/attributes that are already mentioned in the element we're in\n          const usedItems = [];\n          const isAttributeSearch = lastOpenedTag && lastOpenedTag.isAttributeSearch;\n          const isContentSearch = lastOpenedTag && lastOpenedTag.isContentSearch;\n          const filteredElementSearch = lastOpenedTag && lastOpenedTag.filteredElementSearch;\n          // no need to calculate the position in the XSD schema if we are in the root element\n          let parts;\n          if (lastOpenedTag) {\n            // try to create a valid XML document\n            parts = lastOpenedTag.text.split(' ');\n            parts.shift();\n            let cleanedText = textUntilPosition;\n            if (parts.length) {\n              cleanedText = cleanedText.substring(0, cleanedText.length-parts.join(' ').length)+'>';\n            }\n            // parse the content (not cleared text) into an xml document\n            const xmlDoc = qx.xml.Document.fromString(cleanedText);\n            let lastChild = xmlDoc.lastElementChild;\n            let i;\n            let lastFound = false;\n            while (lastChild) {\n              openedTags.push(lastChild.tagName);\n              openedAttributes.push(lastChild.attributes);\n              // if we found our last opened tag\n              if (lastChild.tagName === lastOpenedTag.tagName) {\n                lastFound = true;\n                // if we are looking for attributes, then used items should\n                // be the attributes we already used\n                if (lastOpenedTag.isAttributeSearch && lastChild.outerHTML === lastOpenedTag.text) {\n                  const attrs = lastChild.attributes;\n                  for (i = 0; i < attrs.length; i++) {\n                    usedItems.push(attrs[i].nodeName);\n                  }\n                } else {\n                  // if we are looking for child elements, then used items\n                  // should be the elements that were already used\n                  const children = lastChild.children;\n                  for (i = 0; i < children.length; i++) {\n                    if (children[i].tagName.toLowerCase() !== 'parsererror') {\n                      usedItems.push(children[i].tagName);\n                    }\n                  }\n                }\n                break;\n              }\n              // we haven't found the last opened tag yet, so we move to\n              // the next element\n              lastChild = lastChild.lastElementChild;\n            }\n            if (!lastFound) {\n              // fallback -> parse string\n              if (isAttributeSearch || isContentSearch) {\n                parts = lastOpenedTag.text.split(' ');\n                // skip tag name\n                parts.shift();\n                parts.forEach(function(entry) {\n                  usedItems.push(entry.split('=').shift());\n                });\n              }\n            }\n          }\n          let res = [];\n          let match;\n          // find the last opened tag in the schema to see what elements/attributes it can have\n          let searchedElement = openedTags[openedTags.length - 1];\n          if (isContentSearch) {\n            // handle data providers if the is one relevant\n            if (lastOpenedTag.tagName === 'pages' && lastOpenedTag.currentAttribute === 'design') {\n              return this._dataProvider.getDesigns().then(function (sugg) {\n                return {suggestions: sugg};\n              });\n            } else if (lastOpenedTag.tagName === 'address' && lastOpenedTag.currentAttribute === 'transform') {\n              return {suggestions: this._dataProvider.getTransforms()};\n            } else if (lastOpenedTag.tagName === 'plugin' && lastOpenedTag.currentAttribute === 'name') {\n              return {suggestions: this._dataProvider.getPlugins()};\n            } else if (lastOpenedTag.tagName === 'icon' && lastOpenedTag.currentAttribute === 'name') {\n              return {suggestions: this._dataProvider.getIcons()};\n            } else if (lastOpenedTag.tagName === 'influx') {\n              if (lastOpenedTag.currentAttribute === 'measurement') {\n                return this._dataProvider.getInfluxDBs().then(function (suggestions) {\n                  return {suggestions: suggestions};\n                });\n              } else if (lastOpenedTag.currentAttribute === 'field') {\n                match = /measurement=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n                if (match) {\n                  return this._dataProvider.getInfluxDBFields(match[1]).then(function (suggestions) {\n                    return {suggestions: suggestions};\n                  });\n                }\n              }\n            } else if (lastOpenedTag.tagName === 'tag' && (lastOpenedTag.currentAttribute === 'key' || lastOpenedTag.currentAttribute === 'value') && openedTags.includes('influx')) {\n              const influxAttributes = openedAttributes[openedTags.indexOf('influx')];\n              const attr = influxAttributes.getNamedItem('measurement');\n              if (attr) {\n                if (lastOpenedTag.currentAttribute === 'key') {\n                  return this._dataProvider.getInfluxDBTags(attr.value).then(function (suggestions) {\n                    return {suggestions: suggestions};\n                  });\n                } else if (lastOpenedTag.currentAttribute === 'value') {\n                  match = /key=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n                  if (match) {\n                    return this._dataProvider.getInfluxDBValues(attr.value, match[1]).then(function (suggestions) {\n                      return {suggestions: suggestions};\n                    });\n                  }\n                }\n              }\n            } else if (lastOpenedTag.tagName === 'template' && lastOpenedTag.currentAttribute === 'name' && openedTags.includes('meta')) {\n              res = Object.keys(templates).map(function (name) {\n                return {\n                  label: name,\n                  insertText: name,\n                  kind: window.monaco.languages.CompletionItemKind.EnumMember\n                };\n              }, this);\n              return {suggestions: res};\n            } else if (lastOpenedTag.tagName === 'value' &&\n              lastOpenedTag.currentAttribute === 'name' &&\n              !openedTags.includes('meta') &&\n              openedTags.includes('template')) {\n              // TODO: find out template name\n              const templateNames = Object.keys(templates);\n              templateNames.forEach(function (name) {\n                templates[name].forEach(function (variableName) {\n                  res.push({\n                    label: variableName,\n                    insertText: variableName,\n                    detail: qx.locale.Manager.tr('Variable from template %1', name),\n                    kind: window.monaco.languages.CompletionItemKind.Variable\n                  });\n                }, this);\n              }, this);\n              return {suggestions: res};\n            } else if (lastOpenedTag.currentAttribute === 'mapping') {\n              res = mappingNames.map(function (mappingName) {\n                return {\n                  label: mappingName,\n                  insertText: mappingName,\n                  kind: window.monaco.languages.CompletionItemKind.EnumMember\n                };\n              }, this);\n              return {suggestions: res};\n            } else if (lastOpenedTag.currentAttribute === 'styling') {\n              res = stylingNames.map(function (stylingName) {\n                return {\n                  label: stylingName,\n                  insertText: stylingName,\n                  kind: window.monaco.languages.CompletionItemKind.EnumMember\n                };\n              }, this);\n              return {suggestions: res};\n            }\n\n            // TODO: completions that have to be retrieved from the backend\n            // * rrds\n            // * Influx: dbs, tags fields\n            // * media files\n\n            searchedElement = lastOpenedTag.tagName;\n          } else if (!isAttributeSearch && filteredElementSearch) {\n            searchedElement = openedTags[openedTags.length-2];\n          } else if (lastOpenedTag.tagName === 'address' && lastOpenedTag.currentAttribute === null) {\n            return this._dataProvider.getAddresses('monaco').then(res => ({suggestions: res}));\n          }\n          if (searchedElement === 'rrd') {\n            return this._dataProvider.getRrds('monaco').then(res => ({suggestions: res}));\n          } else if (searchedElement === 'file' && !isAttributeSearch && !isContentSearch && openedTags.includes('files')) {\n            match = /type=\"([^\"]+)\"/.exec(lastOpenedTag.text);\n            const typeFilter = match ? match[1] : null;\n            return this._dataProvider.getMediaFiles(typeFilter).then(function (suggestions) {\n              return {suggestions: suggestions};\n            });\n          }\n          const currentItem = this.findElements(this._schema.getElementNode('pages'), searchedElement, openedTags.length, openedTags.includes('meta'));\n\n          // return available elements/attributes if the tag exists in the schema, or an empty\n          // array if it doesn't\n          if (isContentSearch) {\n            const currentAttribute = usedItems[usedItems.length - 1];\n\n            if (currentItem && currentAttribute in currentItem.getAllowedAttributes()) {\n              const attribute = currentItem.getAllowedAttributes()[currentAttribute];\n              const type = attribute.getTypeString();\n              attribute.getEnumeration().forEach(function(entry) {\n                res.push({\n                  label: entry,\n                  kind: window.monaco.languages.CompletionItemKind.Value,\n                  detail: type,\n                  documentation: attribute.getDocumentation().join('\\n')\n                });\n              });\n            }\n          } else if (isAttributeSearch) {\n            // get attributes completions\n            res = currentItem ? this.getAvailableAttributes(currentItem, usedItems) : [];\n          } else {\n            // get elements completions\n            // eslint-disable-next-line no-lonely-if\n            if (lastOpenedTag && lastOpenedTag.text.endsWith('</')) {\n              res.push({\n                label: lastOpenedTag.tagName,\n                kind: window.monaco.languages.CompletionItemKind.Field\n              });\n            } else {\n              res = currentItem ? this.getAvailableElements(currentItem, usedItems) : [];\n            }\n          }\n          return {suggestions: res};\n        }.bind(this)\n      };\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__elementCache = null;\n    this._schema = null;\n    this._dataProvider = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.Schema', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (filename) {\n    this.base(arguments);\n    if (!filename || !filename.match(/\\.xsd$/)) {\n      throw new Error('no, empty or invalid filename given, can not instantiate without one');\n    }\n    this.__filename = filename;\n    this.__allowedRootElements = {};\n    this.__referencedNodeCache = {};\n    this.__typeNodeCache = {};\n    this._cacheXSD();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    __CACHE: {},\n\n    getInstance: function (schemaFile) {\n      if (!Object.prototype.hasOwnProperty.call(this.__CACHE, schemaFile)) {\n        this.__CACHE[schemaFile] = new cv.ui.manager.model.Schema(qx.util.ResourceManager.getInstance().toUri(schemaFile));\n      }\n      return this.__CACHE[schemaFile];\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    loaded: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeLoaded'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __filename: null,\n    /**\n     * object of the schema/xsd\n     * @var object\n     */\n    __xsd: null,\n\n    /**\n     * object of allowed root-level elements\n     * @var object\n     */\n    __allowedRootElements: null,\n\n    /**\n     * cache for referenced nods\n     * @var object\n     */\n    __referencedNodeCache: null,\n\n    /**\n     * cache for getTypeNode\n     * @var object\n     */\n    __typeNodeCache: null,\n\n    /**\n     * cache for #text-SchemaElement\n     * @var object\n     */\n    __textNodeSchemaElement: null,\n\n    /**\n     * cache for #comment-SchemaElement\n     * @var object\n     */\n    __commentNodeSchemaElement: null,\n\n    /**\n     * @var {Array<String>}\n     */\n    _widgetNames: null,\n\n    onLoaded: function (callback, context) {\n      if (this.isLoaded()) {\n        callback.call(context);\n      } else {\n        this.addListenerOnce('changeLoaded', callback, context);\n      }\n    },\n\n    /**\n     * load and cache the xsd from the server\n     */\n    _cacheXSD: function () {\n      const ajaxRequest = new qx.io.request.Xhr(this.__filename);\n      ajaxRequest.set({\n        accept: 'application/xml'\n      });\n      ajaxRequest.addListenerOnce('success', function (e) {\n        const req = e.getTarget();\n        // Response parsed according to the server's response content type\n        let xml = req.getResponse();\n        if (xml && (typeof xml === 'string')) {\n          xml = qx.xml.Document.fromString(xml);\n        }\n        this.__xsd = xml;\n\n        // parse the data, to have at least a list of root-level-elements\n        this._parseXSD();\n      }, this);\n      ajaxRequest.send();\n    },\n\n    /**\n     * parse the schema once\n     */\n    _parseXSD: function () {\n      // make a list of root-level elements\n      this.__xsd.querySelectorAll('schema > element').forEach(element => {\n        const name = element.getAttribute('name');\n        this.__allowedRootElements[name] = new cv.ui.manager.model.schema.Element(element, this);\n      });\n      this.setLoaded(true);\n    },\n\n    getElementNode: function (name) {\n      if (Object.prototype.hasOwnProperty.call(this.__allowedRootElements, name)) {\n        return this.__allowedRootElements[name];\n      }\n      throw new Error('schema/xsd appears to be invalid, element ' + name + ' not allowed on root level');\n    },\n\n    /**\n     * dive into the schema and find the element that is being pulled in by a ref.\n     * Do so recursively.\n     * referenced nodes can be top-level-nodes only!\n     *\n     * @param   type    string  Type of the node (e.g. element, attributeGroup, ...)\n     * @param   refName string  Name as per the ref-attribute\n     * @return  object          jQuery-object of the ref'ed element\n     */\n    getReferencedNode: function (type, refName) {\n      if (Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type) && Object.prototype.hasOwnProperty.call(this.__referencedNodeCache[type], refName)) {\n        return this.__referencedNodeCache[type][refName];\n      }\n\n      const selector = 'schema > ' + type + '[name=\"' + refName + '\"]';\n      let ref = this.__xsd.querySelector(selector);\n      if (!ref) {\n        throw new Error('schema/xsd appears to be invalid, reference ' + type + '\"' + refName + '\" can not be found');\n      }\n\n      if (ref.hasAttribute('ref')) {\n        // do it recursively, if necessary\n        ref = this.getReferencedNode(type, ref.getAttribute('ref'));\n      }\n\n      if (!Object.prototype.hasOwnProperty.call(this.__referencedNodeCache, type)) {\n        this.__referencedNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__referencedNodeCache[type][refName] = ref;\n\n      return ref;\n    },\n\n\n    /**\n     * get the definition of a type, be it complex or simple\n     *\n     * @param   type    string  Type of type to find (either simple or complex)\n     * @param   name    string  Name of the type to find\n     */\n    getTypeNode: function (type, name) {\n      if (Object.prototype.hasOwnProperty.call(this.__typeNodeCache, type) && Object.prototype.hasOwnProperty.call(this.__typeNodeCache[type], name)) {\n        return this.__typeNodeCache[type][name];\n      }\n      let typeNode = this.__xsd.querySelector(type + 'Type[name=\"' + name + '\"]');\n\n      if (!typeNode) {\n        throw new Error('schema/xsd appears to be invalid, ' + type + 'Type \"' + name + '\" can not be found');\n      }\n\n      if (typeof this.__typeNodeCache[type] == 'undefined') {\n        this.__typeNodeCache[type] = {};\n      }\n\n      // fill the cache\n      this.__typeNodeCache[type][name] = typeNode;\n\n      return typeNode;\n    },\n\n    /**\n     * get a SchemaElement for a #text-node\n     *\n     * @return  object  SchemaElement for #text-node\n     */\n    getTextNodeSchemaElement: function () {\n      if (this.__textNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#text');\n        tmpXML.setAttribute('type', 'xsd:string');\n        this.__textNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__textNodeSchemaElement;\n    },\n\n    /**\n     * get a SchemaElement for a #comment-node\n     *\n     * @return  object  SchemaElement for #comment-node\n     */\n    getCommentNodeSchemaElement: function () {\n      if (this.__commentNodeSchemaElement === null) {\n        // text-content is always a simple string\n        const tmpXML = this.__xsd.createElement('element');\n        tmpXML.setAttribute('name', '#comment');\n        tmpXML.setAttribute('type', 'xsd:string');\n        tmpXML.setAttribute('minOccurs', '0');\n        tmpXML.setAttribute('maxOccurs', 'unbounded');\n        this.__commentNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this);\n      }\n\n      return this.__commentNodeSchemaElement;\n    },\n\n    /**\n     * get the DOM for this Schema\n     *\n     * @return  object  DOM\n     */\n    getSchemaDOM: function () {\n      return this.__xsd;\n    },\n\n    /**\n     * A CometVisu-Schema specific helper function that returns an array of all widget names.\n     * @returns {Array<String>}\n     */\n    getWidgetNames: function () {\n      if (!this._widgetNames) {\n        const pages = this.getElementNode('pages');\n        const page = pages.getSchemaElementForElementName('page');\n        this._widgetNames = Object.keys(page.getAllowedElements()).filter(name => !name.startsWith('#') && name !== 'layout');\n      }\n      return this._widgetNames;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__xsd = null;\n    this._disposeObjects('__commentNodeSchemaElement', '__textNodeSchemaElement');\n    this._disposeMap('__allowedRootElements');\n    this.__referencedNodeCache = null;\n    this.__typeNodeCache = null;\n    this._widgetNames = null;\n  }\n});\n\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.editor.completion.CometVisu', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    TEMPLATES: null,\n\n    getTemplates: function () {\n      if (!this.TEMPLATES) {\n        this.TEMPLATES = [{\n          filterText: 'cvclass',\n          label: 'CometVisu-Class',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A generic CometVisu class.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Class.define(\"cv.$0\", {\\n  extend: qx.core.Object,\\n\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvwidget',\n          label: 'CometVisu-Widget',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A CometVisu class for a widget.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Class.define(\"cv.ui.structure.pure.$0\", {\\n  extend: cv.ui.structure.AbstractWidget,\\n\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvinterface',\n          label: 'CometVisu-Interface',\n          kind: window.monaco.languages.CompletionItemKind.Interface,\n          detail: 'A generic CometVisu Interface.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Interface.define(\"cv.$0\", {\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvmixin',\n          label: 'CometVisu-Mixin',\n          kind: window.monaco.languages.CompletionItemKind.Class,\n          detail: 'A generic CometVisu Mixin.',\n          insertText: '/**\\n * TODO: Add documentation\\n * \\n * @since ' + cv.Version.VERSION.replace('-dev', '') + ' ($CURRENT_YEAR)\\n */\\nqx.Mixin.define(\"cv.$0\", {\\n  \\n});\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvmembers',\n          label: 'CometVisu-Class members',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'A CometVisu classes members section.',\n          insertText: '  /*\\n  ***********************************************\\n    MEMBERS\\n  ***********************************************\\n  */\\n  members: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvproperties',\n          label: 'CometVisu-Class properties',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'A CometVisu classes properties section.',\n          insertText: '  /*\\n  ***********************************************\\n    PROPERTIES\\n  ***********************************************\\n  */\\n  properties: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvstatics',\n          label: 'CometVisu-Class statics',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'statics section.',\n          insertText: '  /*\\n  ***********************************************\\n    STATICS\\n  ***********************************************\\n  */\\n  statics: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvevents',\n          label: 'CometVisu-Class events',\n          kind: window.monaco.languages.CompletionItemKind.Struct,\n          detail: 'events section.',\n          insertText: '  /*\\n  ***********************************************\\n    EVENTS\\n  ***********************************************\\n  */\\n  events: {\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvconstructor',\n          label: 'Constructor',\n          kind: window.monaco.languages.CompletionItemKind.Method,\n          detail: 'constructor.',\n          insertText: '  /*\\n  ***********************************************\\n    CONSTRUCTOR\\n  ***********************************************\\n  */\\n  construct: function () {\\n    this.base(arguments);\\n    $0\\n  },\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }, {\n          filterText: 'cvdestructor',\n          label: 'Destructor',\n          kind: window.monaco.languages.CompletionItemKind.Method,\n          detail: 'destructor.',\n          insertText: '  /*\\n  ***********************************************\\n    DESTRUCTOR\\n  ***********************************************\\n  */\\n  destruct: function () {\\n    this.base(arguments);\\n    $0\\n  }\\n',\n          insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n        }];\n\n        // load plugin template from backend\n        return new Promise(function (resolve, reject) {\n          cv.io.rest.Client.getFsClient().readSync({path: '.templates/Plugin.js'}, function (err, res) {\n            if (err) {\n              reject(err);\n            } else {\n              this.TEMPLATES.push({\n                filterText: 'cvplugin',\n                label: 'CometVisu-Plugin',\n                kind: window.monaco.languages.CompletionItemKind.Class,\n                detail: 'A CometVisu class for a plugin.',\n                insertText: res.replace('###SINCE###', cv.Version.VERSION.replace('-dev', '')+ ' ($CURRENT_YEAR)'),\n                insertTextRules: window.monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet | window.monaco.languages.CompletionItemInsertTextRule.KeepWhitespace\n              });\n              resolve(this.TEMPLATES);\n            }\n          }, this);\n        }.bind(this));\n      }\n      return Promise.resolve(this.TEMPLATES);\n    },\n\n    getProvider: function () {\n      return {\n        triggerCharacters: ['cv'],\n        provideCompletionItems: function () {\n          // get editor content before the pointer\n          return this.getTemplates().then(function (sugg) {\n            return {suggestions: sugg};\n          });\n        }.bind(this)\n      };\n    }\n  }\n});\n","/**\n * An atomic change on an cv.ui.manager.model.XmlElement that can be undone / redone.\n */\nqx.Class.define('cv.ui.manager.model.ElementChange', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (title, element, changes, type) {\n    this.base(arguments);\n    this.setTitle(title);\n    this.setElement(element);\n    this.setChanges(changes);\n    this.setChangeType(type || 'content');\n  },\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement'\n    },\n    title: {\n      check: 'String'\n    },\n    changes: {\n      check: 'Array'\n    },\n    changeType: {\n      check: ['content', 'created', 'deleted', 'moved'],\n      init: ['content']\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * Undo all changes\n     * @return {Boolean} true if all changes are undone\n     */\n    undo: function() {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.undo();\n              } else {\n                element.setAttribute(change.attribute, change.old);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.child) {\n              change.child.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.oldParent, change.oldIndex, true);\n            break;\n        }\n      }\n      return success;\n    },\n\n    /**\n     * Redo all change\n     *  @return {Boolean} true if all changes are redone\n     */\n    redo: function () {\n      const element = this.getElement();\n      let success = false;\n      let change;\n      if (!element.isDisposed()) {\n        switch (this.getChangeType()) {\n          case 'content':\n            this.getChanges().forEach(change => {\n              if (change instanceof cv.ui.manager.model.ElementChange) {\n                change.redo();\n              } else {\n                element.setAttribute(change.attribute, change.value);\n              }\n            });\n            element.updateModified();\n            success = true;\n            break;\n\n          case 'deleted':\n            if (element) {\n              element.remove(true);\n              success = true;\n            }\n            break;\n\n          case 'created':\n            change = this.getChanges()[0];\n            if (change.parent) {\n              success = change.parent.insertChild(change.child, change.index, true);\n            }\n            break;\n\n          case 'moved':\n            change = this.getChanges()[0];\n            success = change.child.moveTo(change.parent, change.index, true);\n            break;\n        }\n      }\n      return success;\n    }\n  }\n});\n","/**\n * Widget for node items in XML-File\n */\nqx.Class.define('cv.ui.manager.tree.VirtualElementItem', {\n  extend: qx.ui.tree.VirtualTreeItem,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label) {\n    this.base(arguments, label);\n    if (qx.core.Environment.get('device.touch')) {\n      this.addState('touch');\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'element-tree-item'\n    },\n\n    name: {\n      check: 'String',\n      init: '',\n      event: 'changeName',\n      apply: '_applyName'\n    },\n\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyTemporary'\n    },\n\n    status: {\n      check: ['valid', 'error', 'comment'],\n      nullable: true,\n      apply: '_applyStatus'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: false\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applySortable'\n    },\n\n    droppable: {\n      refine: true,\n      init: true\n    },\n\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    edit: 'qx.event.type.Data',\n    action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: { // eslint-disable-line @qooxdoo/qx/no-refs-in-members\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates : {\n      selected : true,\n      touch: true\n    },\n    __labelAdded: false,\n\n    _applyName: function(value) {\n      this.getContentElement().setAttribute('data-nodename', value);\n    },\n\n    // this has to be set by model binding, because the qx way by adding a state does not survive a widget re-binding\n    _applyDragging: function (value) {\n      if (value) {\n        this.addState('drag');\n      } else {\n        this.removeState('drag');\n      }\n    },\n\n    _applyModel: function (value) {\n      if (qx.core.Environment.get('device.touch')) {\n        if (value) {\n          const menuButton = this.getChildControl('menu-button');\n          menuButton.show();\n          let menu = menuButton.getMenu();\n          menu.setEditor(value.getEditor());\n          menu.setElement(value);\n        } else {\n          this.getChildControl('menu-button').hide();\n        }\n      } else if (this.hasChildControl('menu-button')) {\n        this.getChildControl('menu-button').exclude();\n      }\n    },\n\n    _applyTemporary: function (value) {\n      if (value) {\n        this.addState('temporary');\n      } else {\n        this.removeState('temporary');\n      }\n    },\n\n    _applySortable: function (value) {\n      if (value) {\n        this.getChildControl('move-button').show();\n      } else {\n        this.getChildControl('move-button').hide();\n      }\n    },\n\n    _applyStatus: function (value, old) {\n      const icon = this.getChildControl('icon');\n      const label = this.getChildControl('label');\n      if (old) {\n        icon.removeState(old);\n        label.removeState(old);\n      }\n      if (value) {\n        icon.addState(value);\n        label.addState(value);\n      }\n    },\n\n    _addWidgets: function() {\n      this.base(arguments);\n      const open = this.getChildControl('open', true);\n      if (open && qx.core.Environment.get('device.touch')) {\n        open.getContentElement().addClass('touch-tree-open-icon');\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n         case 'icon':\n           control = new cv.ui.manager.basic.Image().set({\n             alignY: 'middle',\n             anonymous: true,\n             source: this.getIcon(),\n             maxWidth: 22,\n             maxHeight: 22\n           });\n           break;\n\n         case 'buttons':\n           control = new qx.ui.container.Composite(new qx.ui.layout.HBox(8));\n           control.setAnonymous(true);\n           break;\n\n         case 'move-button':\n           control = new qx.ui.basic.Atom('', cv.theme.dark.Images.getIcon('drag-handle', qx.core.Environment.get('device.touch') ? 36 : 18));\n           control.setToolTipText(this.tr('Drag to move'));\n           control.setAnonymous(true);\n           control.setShow('icon');\n           this.getChildControl('buttons').addAt(control, 0);\n           break;\n\n         case 'menu-button':\n           control = new qx.ui.form.MenuButton('', cv.theme.dark.Images.getIcon('menu', qx.core.Environment.get('device.touch') ? 24 : 14), new cv.ui.manager.contextmenu.ConfigElement());\n           control.getMenu().addListener('action', ev => {\n             this.fireDataEvent('action', ev.getData());\n           });\n           this.getChildControl('buttons').addAt(control, 1);\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    // overridden\n    addLabel : function(text) {\n      const label = this.getChildControl('label');\n\n      if (this.__labelAdded) {\n        this._remove(label);\n      }\n\n      if (text) {\n        this.setLabel(text);\n      } else {\n        label.setValue(this.getLabel());\n      }\n\n      this._add(label);\n      this._add(new qx.ui.core.Spacer(), {flex: 1});\n      const buttons = this.getChildControl('buttons');\n      this._add(buttons);\n      this.__labelAdded = true;\n    }\n  }\n});\n","/**\n * Contextmenu for an XML-Element in a CometVisu config file.\n */\nqx.Class.define('cv.ui.manager.contextmenu.ConfigElement', {\n  extend: qx.ui.menu.Menu,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (editor) {\n    this.base(arguments);\n    if (editor) {\n      this.setEditor(editor);\n    }\n    this._commandGroup = qx.core.Init.getApplication().getCommandManager().getActive();\n    this._init();\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'action': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    element: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true,\n      apply: '_applyElement'\n    },\n\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      apply: '_applyEditor'\n    }\n\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * @var {qx.ui.command.GroupManager}\n     */\n    _commandGroup: null,\n\n    _applyEditor: function (value, old) {\n      if (old) {\n        old.removeListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n      if (value) {\n        value.addListener('changeClipboard', this._maintainClipboardButtons, this);\n      }\n    },\n\n    _applyElement: function(value, old) {\n      if (old) {\n        old.removeRelatedBindings(this.getChildControl('delete-button'));\n        old.removeRelatedBindings(this.getChildControl('cut-button'));\n      }\n      if (value) {\n        const editable = value.isEditable();\n        this.getChildControl('copy-button').setEnabled(true);\n        if (editable) {\n          value.bind('deletable', this.getChildControl('delete-button'), 'enabled');\n          value.bind('deletable', this.getChildControl('cut-button'), 'enabled');\n          this.getChildControl('view-button').exclude();\n          this.getChildControl('edit-button').show();\n          this.getChildControl('edit-button').setEnabled(value.getShowEditButton());\n          let addable = value.getAddableChildren(true);\n          this.getChildControl('create-button').setEnabled(addable.length > 0);\n        } else {\n          this.getChildControl('delete-button').setEnabled(false);\n          this.getChildControl('cut-button').setEnabled(false);\n          this.getChildControl('create-button').setEnabled(false);\n          this.getChildControl('view-button').show();\n          // enable view button when there are attributes to show\n          this.getChildControl('view-button').setEnabled(value.getShowEditButton());\n          this.getChildControl('edit-button').exclude();\n        }\n      } else {\n        ['edit', 'delete', 'cut', 'copy', 'paste', 'create'].forEach(name => this.getChildControl(name + '-button').setEnabled(false));\n      }\n      this._maintainClipboardButtons();\n    },\n\n    _init: function () {\n      ['view', 'edit', 'delete'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      ['cut', 'copy', 'paste'].forEach(name => this.add(this.getChildControl(name + '-button')));\n      this.addSeparator();\n      this.add(this.getChildControl('create-button'));\n    },\n\n    _maintainClipboardButtons: function () {\n      const content = this.getEditor().getClipboard();\n      const element = this.getElement();\n      let enabled = (element ? element.isEditable() : false) && content instanceof cv.ui.manager.model.XmlElement;\n      if (enabled) {\n        // check if content is allowed as child here\n        let addable = element.getAddableChildren(true);\n        enabled = addable.includes(content.getName()) && element.isChildAllowedAtPosition(content, Number.POSITIVE_INFINITY);\n      }\n      this.getChildControl('paste-button').setEnabled(enabled);\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n       let control;\n\n       switch (id) {\n         case 'view-button':\n           control = this.__createButton('view', this.tr('View'), cv.theme.dark.Images.getIcon('view', 18));\n           control.exclude();\n           break;\n\n         case 'edit-button':\n           control = this.__createButton('edit', this.tr('Edit'), cv.theme.dark.Images.getIcon('edit', 18));\n           break;\n\n         case 'delete-button':\n           control = this.__createButton('delete', this.tr('Delete'), cv.theme.dark.Images.getIcon('delete', 18));\n           break;\n\n         case 'cut-button':\n           control = this.__createButton('cut', this.tr('Cut'), cv.theme.dark.Images.getIcon('cut', 18));\n           break;\n\n         case 'copy-button':\n           control = this.__createButton('copy', this.tr('Copy'), cv.theme.dark.Images.getIcon('copy', 18));\n           break;\n\n         case 'paste-button':\n           control = this.__createButton('paste', this.tr('Paste'), cv.theme.dark.Images.getIcon('paste', 18));\n           break;\n\n         case 'create-menu':\n           control = new qx.ui.menu.Menu();\n           break;\n\n         case 'create-button':\n           control = this.__createButton('create', this.tr('Add child'), cv.theme.dark.Images.getIcon('add', 18));\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    },\n\n    __createButton: function (action, title, icon, command, menu) {\n      const button = new qx.ui.menu.Button(title, icon, command, menu);\n      button.addListener('execute', function () {\n        this.fireDataEvent('action', {\n          action: action,\n          element: this.getElement()\n        });\n      }, this);\n      return button;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._commandGroup = null;\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.ElementForm', {\n  extend: qxl.dialog.Form,\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    labelColumnWidth: {\n      refine: true,\n      init: 300\n    },\n\n    useBlocker: {\n      refine: true,\n      init: true\n    },\n\n    blockerOpacity: {\n      refine: true,\n      init: 0.9\n    },\n\n    blockerColor: {\n      refine: true,\n      init: '#585858'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __mappedKeys: null,\n    __hints: null,\n    _rootListenerId: null,\n\n    _applyFormData: function (formData, old) {\n      this.__mappedKeys = {\n        map: {},\n        inverse: {}\n      };\n      let firstWidget;\n      if (this._formController) {\n        try {\n          this.getModel().removeAllBindings();\n          this._formController.dispose();\n        } catch (e) {\n        }\n      }\n      if (this._form) {\n        try {\n          this._form.getValidationManager().removeAllBindings();\n          this._form.dispose();\n        } catch (e) {\n        }\n      }\n      this._formContainer.removeAll();\n      if (!formData) {\n        return;\n      }\n      if (this.getModel()) {\n        this.getModel().removeAllBindings();\n        this.getModel().dispose();\n      }\n      let modelData = {};\n      for (let key of Object.getOwnPropertyNames(formData)) {\n        let i = 0;\n        let mappedKey = key.replaceAll(/[-_\\.#]+([a-z])/g, (match, p1) => p1.toUpperCase()) + i++;\n        while (Object.prototype.hasOwnProperty.call(modelData, mappedKey)) {\n          mappedKey = mappedKey.substr(0, mappedKey.length - 1) + i++;\n        }\n        if (mappedKey !== key) {\n          this.__mappedKeys.map[mappedKey] = key;\n          this.__mappedKeys.inverse[key] = mappedKey;\n        }\n        modelData[mappedKey] = formData[key].value !== undefined\n          ? formData[key].value\n          : null;\n      }\n      let model = qx.data.marshal.Json.createModel(modelData);\n      this.setModel(model);\n      // form\n      this._form = new qx.ui.form.Form();\n      if (qx.core.Environment.get('module.objectid') === true) {\n        this._form.setQxObjectId('form');\n        this.addOwnedQxObject(this._form);\n      }\n      this._formController = new qx.data.controller.Object(this.getModel());\n      this._onFormReady(this._form);\n      let i = 0;\n      let atom;\n      for (let key of Object.getOwnPropertyNames(formData)) {\n        const mappedKey = this.__mappedKeys.inverse[key];\n        let fieldData = formData[key];\n        let formElement = null;\n        switch (fieldData.type.toLowerCase()) {\n          case 'groupheader':\n            this._form.addGroupHeader(fieldData.value);\n            break;\n          case 'textarea':\n            formElement = new qx.ui.form.TextArea();\n            formElement.setMinimalLineHeight(fieldData.lines);\n            if (fieldData.autoSize === true) {\n              formElement.setAutoSize(true);\n              formElement.setMinHeight(fieldData.lines * 16);\n            } else {\n              formElement.setHeight(fieldData.lines * 16);\n            }\n            formElement.setLiveUpdate(true);\n            break;\n          case 'textfield':\n            formElement = new qx.ui.form.TextField();\n            if (fieldData.maxLength) {\n formElement.setMaxLength(fieldData.maxLength); \n}\n            formElement.setLiveUpdate(true);\n            break;\n          case 'sourceeditor':\n            formElement = new cv.ui.manager.form.SourceCodeField('', fieldData.language);\n            if (fieldData.autoSize === true) {\n              formElement.setAutoSize(true);\n              formElement.setMinHeight(fieldData.lines * 16);\n            } else {\n              formElement.setHeight(fieldData.lines * 16);\n            }\n            break;\n          case 'datefield':\n          case 'date':\n            formElement = new qx.ui.form.DateField();\n            if (fieldData.dateFormat) {\n              formElement.setDateFormat(fieldData.dateFormat);\n            }\n            break;\n          case 'passwordfield':\n          case 'password':\n            formElement = new qx.ui.form.PasswordField();\n            formElement.getContentElement().setAttribute('autocomplete', 'password');\n            break;\n          case 'combobox': {\n            formElement = new qx.ui.form.ComboBox();\n            const parseComboOptions = function (options) {\n              if (Array.isArray(options)) {\n                options.forEach(function (item) {\n                  let listItem = new qx.ui.form.ListItem(item.label, item.icon);\n                  formElement.add(listItem);\n                });\n              } else if (typeof options === 'object') {\n                // grouped options\n                Object.keys(options).forEach(groupName => {\n                  let groupItem = new qx.ui.form.ListItem(groupName);\n                  groupItem.set({\n                    anonymous: true,\n                    appearance: 'optiongroup'\n                  });\n                  formElement.add(groupItem);\n                  options[groupName].forEach(function (item) {\n                    let listItem = new qx.ui.form.ListItem(item.label, item.icon, item.value);\n                    formElement.add(listItem);\n                  });\n                });\n              }\n            };\n            if (fieldData.options instanceof Promise) {\n              formElement.setPlaceholder(this.tr('Loading...'));\n              fieldData.options.then(options => {\n                formElement.setPlaceholder(fieldData.placeholder);\n                parseComboOptions(options);\n              }, this).catch(err => {\n                this.error(err);\n                formElement.setPlaceholder(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n              }, this);\n            } else {\n              parseComboOptions(fieldData.options);\n            }\n            break;\n          }\n          case 'virtualcombobox': {\n            formElement = new qx.ui.form.VirtualComboBox();\n            formElement.set({\n              iconPath: 'icon',\n              labelPath: 'value'\n            });\n            if (fieldData.validation) {\n              formElement.getChildControl('textfield').setLiveUpdate(true);\n            }\n            const selection = formElement.getChildControl('dropdown').getSelection();\n            selection.addListener('change', function (ev) {\n              const selected = selection.getItem(0);\n              if (selected && selected instanceof cv.ui.manager.form.Option) {\n                this.__hints = selected.getHints();\n              } else {\n                this.__hints = null;\n              }\n            }, this);\n            model = new qx.data.Array();\n            const parseVComboOptions = function (options) {\n              if (Array.isArray(options)) {\n                options.forEach(item => {\n                  model.push(new cv.ui.manager.form.Option(item.label + (item.value ? ` (${item.value})` : ''), item.icon, item.value, item.hints));\n                });\n              } else if (typeof options === 'object') {\n                Object.keys(options).forEach(groupName => {\n                  const groupModel = new cv.ui.manager.form.Option(groupName);\n                  groupModel.setType('group');\n                  model.push(groupModel);\n                  options[groupName].forEach(function (item) {\n                    model.push(new cv.ui.manager.form.Option(item.label + (item.value ? ` (${item.value})` : ''), item.icon, item.value, item.hints));\n                  });\n                });\n              }\n            };\n            if (fieldData.options instanceof Promise) {\n              formElement.setPlaceholder(this.tr('Loading...'));\n              fieldData.options.then(options => {\n                formElement.setPlaceholder(fieldData.placeholder);\n                parseVComboOptions(options);\n              }, this).catch(err => {\n                this.error(err);\n                formElement.setPlaceholder(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n              }, this);\n            } else {\n              parseVComboOptions(fieldData.options);\n            }\n\n            formElement.setDelegate({\n              createItem: function () {\n                return new cv.ui.manager.form.ListItem();\n              },\n              bindItem: function (controller, item, index) {\n                controller.bindProperty('icon', 'icon', null, item, index);\n                controller.bindProperty('label', 'label', null, item, index);\n                controller.bindProperty('type', 'appearance', {\n                  converter: function (value) {\n                    switch (value) {\n                      case 'state':\n                        return 'state-option';\n                      case 'error':\n                        return 'error-option';\n                      case 'group':\n                        return 'optiongroup';\n                      default:\n                        return 'listitem';\n                    }\n                  }\n                }, item, index);\n                controller.bindProperty('type', 'anonymous', {\n                  converter: function (value) {\n                    return value === 'group';\n                  }\n                }, item, index);\n              }\n            });\n            formElement.setModel(model);\n            break;\n          }\n\n          case 'selectbox': {\n            formElement = new qx.ui.form.SelectBox();\n            if (fieldData.options instanceof Promise) {\n              atom = formElement.getChildControl('atom');\n              atom.setLabel(this.tr('Loading...'));\n              atom.addState('loading');\n              fieldData.options.then(options => {\n                const atom = formElement.getChildControl('atom');\n                atom.resetLabel();\n                atom.removeState('loading');\n                model = qx.data.marshal.Json.createModel(options);\n                // eslint-disable-next-line no-new\n                new qx.data.controller.List(model, formElement, 'label');\n              }, this).catch(err => {\n                this.error(err);\n                const atom = formElement.getChildControl('atom');\n                atom.setLabel(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n                atom.removeState('loading');\n                atom.addState('error');\n              }, this);\n            } else {\n              model = qx.data.marshal.Json.createModel(fieldData.options);\n              // eslint-disable-next-line no-new\n              new qx.data.controller.List(model, formElement, 'label');\n            }\n            break;\n          }\n\n          case 'virtualselectbox':\n            formElement = new cv.ui.manager.form.VirtualSelectBox();\n            model = new qx.data.Array();\n            if (fieldData.options) {\n              if (fieldData.options instanceof Promise) {\n                atom = formElement.getChildControl('atom');\n                atom.setLabel(this.tr('Loading...'));\n                atom.addState('loading');\n                fieldData.options.then(options => {\n                  const atom = formElement.getChildControl('atom');\n                  atom.resetLabel();\n                  atom.removeState('loading');\n                  options.forEach(item => {\n                    model.push(new cv.ui.manager.form.Option(item.label, item.icon, item.value));\n                  });\n                }).catch(err => {\n                  this.error(err);\n                  const atom = formElement.getChildControl('atom');\n                  atom.setLabel(this.tr('Possible values could no be retrieved, please check browser console for error details'));\n                  atom.removeState('loading');\n                  atom.addState('error');\n                }, this);\n              } else {\n                fieldData.options.forEach(item => {\n                  model.push(new cv.ui.manager.form.Option(item.label, item.icon, item.value));\n                });\n              }\n            }\n            formElement.setDelegate({\n              createItem: function() {\n                return new cv.ui.manager.form.ListItem();\n              },\n              bindItem:  function (controller, item, index) {\n                controller.bindDefaultProperties(item, index);\n                controller.bindProperty('value', 'model', null, item, index);\n              }\n            });\n            formElement.set({\n              labelPath: 'label',\n              iconPath: 'icon',\n              iconOptions: {\n                converter: function (value) {\n                  if (typeof value === 'function') {\n                    return value().trim();\n                  }\n                  return value;\n                }\n              },\n              model: model\n            });\n            break;\n          case 'radiogroup':\n            formElement = new qx.ui.form.RadioGroup();\n            if (fieldData.orientation) {\n              formElement.setUserData('orientation', fieldData.orientation);\n            }\n            fieldData.options.forEach(function (item) {\n              let radioButton = new qx.ui.form.RadioButton(item.label);\n              radioButton.setUserData(\n                'value',\n                item.value !== undefined ? item.value : item.label\n              );\n              formElement.add(radioButton);\n            }, this);\n            break;\n          case 'label':\n            formElement = new qx.ui.form.TextField(); // dummy\n            formElement.setUserData('excluded', true);\n            break;\n          case 'checkbox':\n            formElement = new cv.ui.manager.form.CheckBox();\n            formElement.setTriState(true);\n            break;\n          case 'spinner':\n            formElement = new qx.ui.form.Spinner();\n            if (fieldData.min) {\n              formElement.setMinimum(fieldData.min);\n            }\n            if (fieldData.max) {\n              formElement.setMaximum(fieldData.max);\n            }\n            if (fieldData.step) {\n              formElement.setSingleStep(fieldData.step);\n            }\n            if (fieldData.fractionsDigits) {\n              let fd = fieldData.fractionsDigits;\n              let nf = new qx.util.format.NumberFormat();\n              if (fd.min) {\n                nf.setMinimumFractionDigits(fd.min);\n              }\n              if (fd.max) {\n                nf.setMaximumFractionDigits(fd.max);\n              }\n              formElement.setNumberFormat(nf);\n            }\n            break;\n          default:\n            this.error('Invalid form field type:' + fieldData.type);\n        }\n        formElement.setUserData('key', key);\n        formElement.setUserData('mappedKey', mappedKey);\n        if (i === 0) {\n          firstWidget = formElement;\n        }\n        i++;\n        if (typeof fieldData.type == 'string') {\n          switch (fieldData.type.toLowerCase()) {\n            case 'textarea':\n            case 'textfield':\n            case 'passwordfield':\n            case 'combobox':\n            case 'virtualcombobox':\n            case 'datefield':\n            case 'spinner':\n            case 'sourceeditor':\n              this._formController.addTarget(formElement, 'value', mappedKey, true, null, {\n                converter: function (value) {\n                  this.getValidationManager().validate();\n                  return value;\n                }.bind(this._form)\n              });\n              break;\n            case 'virtualselectbox':\n              this._formController.addTarget(formElement, 'value', mappedKey, true, {\n                converter: function (value) {\n                  if (typeof value === 'string') {\n                    let option;\n                    this.getModel().some(item => {\n                      if (item.getValue() === value) {\n                        option = item;\n                        return true;\n                      }\n                      return false;\n                    });\n                    return option;\n                  }\n                  return value;\n                }.bind(formElement)\n              }, {\n                converter: function (option) {\n                  this.getValidationManager().validate();\n                  return option ? option.getValue() : null;\n                }.bind(this._form)\n              });\n              break;\n            case 'checkbox':\n              this._formController.addTarget(formElement, 'value', mappedKey, true, null);\n              break;\n            case 'selectbox':\n              this._formController.addTarget(formElement, 'selection', mappedKey, true, {\n                converter: qx.lang.Function.bind(function (value) {\n                  let selected = null;\n                  let selectables = this.getSelectables();\n                  selectables.forEach(function (selectable) {\n                    if (selectable.getModel().getValue() === value) {\n                      selected = selectable;\n                    }\n                  }, this);\n                  if (!selected) {\n                    return [selectables[0]];\n                  }\n                  return [selected];\n                }, formElement)\n              }, {\n                converter: qx.lang.Function.bind(function (selection) {\n                  return selection[0].getModel().getValue();\n                }, formElement)\n              });\n              break;\n            case 'radiogroup':\n              this._formController.addTarget(formElement, 'selection', mappedKey, true, {\n                converter: qx.lang.Function.bind(function (value) {\n                  let selectables = this.getSelectables();\n                  let selection = [];\n                  if (value) {\n                    selectables.forEach(function (selectable) {\n                      let sValue = selectable.getUserData('value');\n                      if (sValue === value) {\n                        selection = [selectable];\n                      }\n                    }, this);\n                  }\n                  return selection;\n                }, formElement)\n              }, {\n                converter: function (selection) {\n                  return selection[0].getUserData('value');\n                }\n              });\n              break;\n          }\n        }\n        /**\n         * Validation\n         */\n        let validator = null;\n        if (formElement && fieldData.validation) {\n          // required field\n          if (fieldData.validation.required) {\n            formElement.setRequired(true);\n          }\n          // sync validation\n          if (fieldData.validation.validator) {\n            validator = fieldData.validation.validator;\n            if (typeof validator == 'string') {\n              if (qx.util.Validate[validator]) {\n                validator = qx.util.Validate[validator]();\n              } else if (validator.charAt(0) === '/') {\n                validator = qx.util.Validate.regExp(\n                  new RegExp(validator.substr(1, validator.length - 2)),\n                  fieldData.validation.errorMessage\n                );\n              } else {\n                this.error('Invalid string validator.');\n              }\n            } else if (!(validator instanceof qx.ui.form.validation.AsyncValidator) && typeof validator !== 'function') {\n              this.error('Invalid validator.');\n            }\n          }\n          // async validation\n          if (qx.lang.Type.isString(fieldData.validation.proxy) &&\n            qx.lang.Type.isString(fieldData.validation.method)\n          ) {\n            /**\n             * fieldData.validation.proxy\n             * the name of a global variable (or path) to a function that acts as the proxy of\n             * the 'send' or 'execute' function of a preconfigured JsonRpc client. The function\n             * receives the following parameters: service method (string), parameters (array)\n             * and callback (function). It proxies the parameters to the given JsonRpc method and\n             * calls the callback with the result (true if valid, false if not) received from the\n             * server. The JsonRpc service name is preconfigured by the server and cannot be\n             * changed by the client.\n             */\n              // clean\n            let proxy = fieldData.validation.proxy.replace(/;\\n/g, '');\n            try {\n              // eslint-disable-next-line no-eval\n              eval('proxy = ' + proxy + ';');\n            } catch (e) {\n              this.warn('Invalid proxy name');\n            }\n            if (typeof proxy == 'function') {\n              let method = fieldData.validation.method;\n              let message = fieldData.validation.invalidMessage;\n              let validationFunc = function (validatorObj, value) {\n                if (!validatorObj.__asyncInProgress) {\n                  validatorObj.__asyncInProgress = true;\n                  proxy(method, [value], function (valid) {\n                    validatorObj.setValid(valid, message || qx.locale.Manager.tr('Value is invalid'));\n                    validatorObj.__asyncInProgress = false;\n                  });\n                }\n              };\n              validator = new qx.ui.form.validation.AsyncValidator(validationFunc);\n            }\n          }\n        }\n\n        /**\n         * other widget properties @todo: allow to set all properties\n         */\n        if (fieldData.width !== undefined) {\n          formElement.setWidth(fieldData.width);\n        }\n        if (fieldData.placeholder !== undefined) {\n          formElement.setPlaceholder(fieldData.placeholder);\n        }\n        if (fieldData.enabled !== undefined) {\n          formElement.setEnabled(fieldData.enabled);\n        }\n        if (fieldData.help !== undefined) {\n          formElement.setUserData('help', fieldData.help);\n        }\n\n        /**\n         * Events\n         */\n        if (qx.lang.Type.isObject(fieldData.events)) {\n          for (let type in fieldData.events) {\n            try {\n              // eslint-disable-next-line no-eval\n              let func = eval('(' + fieldData.events[type] + ')'); // eval is evil, I know.\n              if (!qx.lang.Type.isFunction(func)) {\n                throw new Error();\n              }\n              formElement.addListener(type, func, formElement);\n            } catch (e) {\n              this.warn('Invalid \\'' + type + '\\' event handler for form element \\'' + key + '\\'.');\n            }\n          }\n        }\n\n        // Putting it all together\n        let label = fieldData.label;\n        this._form.add(formElement, label, validator);\n        // Add the form elements as objects owned by the form widget\n        if (qx.core.Environment.get('module.objectid') === true) {\n          formElement.setQxObjectId(key);\n          this._form.addOwnedQxObject(formElement);\n        }\n      }\n\n\n      let view = new cv.ui.manager.form.ElementFormRenderer(this._form);\n      view.getLayout().setColumnFlex(0, 0);\n      view.getLayout().setColumnMaxWidth(0, this.getLabelColumnWidth());\n      view.getLayout().setColumnFlex(1, 1);\n      view.getLayout().set({\n        spacingX: 8\n      });\n      view.setAllowGrowX(true);\n      const scroll = new qx.ui.container.Scroll(view);\n      scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      this._rootListenerId = qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        scroll.setMaxHeight(qx.bom.Document.getHeight() - 132);\n      });\n\n      view.bind('width', scroll, 'width');\n      view.bind('height', scroll, 'height');\n      this._formContainer.add(scroll);\n      this._form.getValidationManager().validate();\n      if (firstWidget) {\n        qx.event.Timer.once(() => {\n          firstWidget.focus();\n        }, this, 200);\n      }\n    },\n\n    _handleOk: function () {\n      this.hide();\n      if (this.getCallback()) {\n        const data = qx.util.Serializer.toNativeObject(this.getModel());\n        const mappedNames = Object.keys(this.__mappedKeys.map);\n        mappedNames.forEach(mappedKey => {\n          if (Object.prototype.hasOwnProperty.call(data, mappedKey)) {\n            data[this.__mappedKeys.map[mappedKey]] = data[mappedKey];\n            delete data[mappedKey];\n          }\n        });\n        if (this.__hints) {\n          Object.keys(this.__hints).forEach(name => data[name] = this.__hints[name]);\n        }\n        this.getCallback().call(\n          this.getContext(),\n          data\n        );\n      }\n      this.resetCallback();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    if (this._rootListenerId) {\n      qx.core.Init.getApplication().getRoot().removeListenerById(this._rootListenerId);\n      this._rootListenerId = null;\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.schema.Base', {\n  extend: qx.core.Object,\n  type: 'abstract',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   * @param   node    {Node} the group-node\n   * @param   schema  {cv.ui.manager.model.Schema}  the corresponding schema\n   */\n  construct: function (node, schema) {\n    this.base(arguments);\n    this.setNode(node);\n    this.setSchema(schema);\n    this._bounds = {\n      min: undefined,\n      max: undefined\n    };\n    this._allowedElements = {};\n    this._sortedContent = [];\n    this._subGroupings = [];\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    /**\n     * type of this object\n     * @var string\n     */\n    type: {\n      check: 'String',\n      init: 'unknown'\n    },\n    elementsHaveOrder: {\n      check: 'Boolean',\n      init: false\n    },\n    schema: {\n      check: 'cv.ui.manager.model.Schema',\n      nullable: false\n    },\n    node: {\n      check: 'Node',\n      nullable: false\n    },\n    /**\n     * array of sub-choices, -sequences, -groups that are defined\n     * @var array\n     */\n    subGroupings: {\n      check: 'Array'\n    }\n  },\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * bounds for this element\n     * @var object\n     */\n    _bounds: null,\n\n    /**\n     * cache for getRegex\n     * @var string\n     */\n    _regexCache: null,\n\n    /**\n     * list of elements that are allowed as per our own definition\n     * @var object\n     */\n    _allowedElements: null,\n\n    /**\n     * the sorted listed of allowed elements and sub-groupings\n     * @var array\n     */\n    _sortedContent: null,\n\n    /**\n     * array of sub-choices, -sequences, -groups that are defined\n     * @var array\n     */\n    _subGroupings: null,\n\n    /// needs to be implemented by the inheriting classes\n    parse: function () {\n      const n = this.getNode();\n      let min = n.hasAttribute('minOccurs') ? n.getAttribute('minOccurs') : 1; // default is 1\n      let max = n.hasAttribute('maxOccurs') ? n.getAttribute('maxOccurs') : 1; // default is 1\n      this._bounds = {\n        min: parseInt(min),\n        max: max === 'unbounded' ? Number.POSITIVE_INFINITY : parseInt(max)\n      };\n    },\n\n    /**\n     * is an element (specified by its name) allowed in this group?\n     * Goes recursive.\n     * Does NOT check bounds! Does NOT check dependencies!\n     *\n     * @param   element string  the element we check for\n     * @return  boolean         is it allowed?\n     */\n    isElementAllowed: function (element) {\n      if (typeof this._allowedElements[element] !== 'undefined') {\n        // this element is immediately allowed\n        return true;\n      }\n\n      // go over the list of subGroupings and check, if the element is allowed with any of them\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        if (this._subGroupings[i].isElementAllowed(element) === true) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    /**\n     * get the SchemaElement-object for a certain element-name.\n     * May return undefined if no element is found, so you might be interested in checking isElementAllowed beforehand.\n     *\n     * @param   elementName string  name of the element to find the SchemaElement for\n     * @return  object              SchemaElement-object, or undefined if none is found\n     */\n    getSchemaElementForElementName: function (elementName) {\n      if (typeof this._allowedElements[elementName] != 'undefined') {\n        // this element is immediately allowed\n        return this._allowedElements[elementName];\n      }\n\n      // go over the list of sub-choices and check, if the element is allowed with them\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        if (this._subGroupings[i].isElementAllowed(elementName) === true) {\n          // this element is allowed\n          return this._subGroupings[i].getSchemaElementForElementName(elementName);\n        }\n      }\n\n      // can not find any reason why elementName is allowed with us...\n      return undefined;\n    },\n\n\n    /**\n     * get a list of required elements.\n     * if an element is required multiple times, it is listed multiple times\n     * Attention: elements are NOT sorted.\n     *\n     * @return  array   list of required elements\n     */\n    getRequiredElements: function () {\n      // we do know what we require. might not be too easy to find out, but ok\n\n      // if we have no lower bounds, then nothing is required\n      if (this._bounds.min === 0) {\n        return [];\n      }\n\n      const requiredElements = [];\n\n      // my own elements\n      for (const [name, item] of Object.entries(this._allowedElements)) {\n        if (item.getBounds().min > 0) {\n          for (let i = 0; i < item.getBounds().min; ++i) {\n            requiredElements.push(name);\n          }\n        }\n      }\n\n      // elements of our sub-groupings, if any\n      this._subGroupings.forEach(grouping => {\n        const subRequiredElements = grouping.getRequiredElements();\n\n        if (subRequiredElements.length > 0) {\n          for (let i = 0; i < subRequiredElements.length; ++i) {\n            requiredElements.push(subRequiredElements[i]);\n          }\n        }\n      });\n\n      return requiredElements;\n    },\n\n    /**\n     * get the elements allowed for this group\n     *\n     * @return  object      list of allowed elements, key is the name\n     */\n    getAllowedElements: function () {\n      const myAllowedElements = {};\n\n      for (const [name, item] of Object.entries(this._allowedElements)) {\n        myAllowedElements[name] = item;\n      }\n\n      // also the elements allowed by our sub-choices etc.\n      this._subGroupings.forEach(grouping => {\n        Object.assign(myAllowedElements, grouping.getAllowedElements());\n      });\n\n      return myAllowedElements;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * @param   sortNumber  integer the sort number of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      return {};\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      return '';\n    },\n\n\n    /**\n     * find out if this Grouping has multi-level-bounds, i.e. sub-groupings with bounds.\n     * This makes it more or less impossible to know in advance which elements might be needed\n     *\n     * @return  boolean does it?\n     */\n    hasMultiLevelBounds: function () {\n      return this._subGroupings.length > 0;\n    },\n\n\n    /**\n     * get the bounds of this very grouping\n     *\n     * @return  object  like {min: x, max: y}\n     */\n    getBounds: function () {\n      return this._bounds;\n    },\n\n\n    /**\n     * get bounds for a specific element.\n     * Take into account the bounds of the element and/or our own bounds\n     *\n     * @param   childName   string  name of the child-to-be\n     * @return  object              {max: x, min: y}, or undefined if none found\n     */\n    getBoundsForElementName: function (childName) {\n      return this._bounds;\n    },\n\n    /**\n     * create a regex-object from a pattern\n     *\n     * For some obscure reason, this may not be inside a classes method, or else that class is not instantiateable\n     *\n     * @param   input       string  the pattern to match (without //)\n     * @param   modifiers   string  modifiers, if any\n     * @return  object              RegExp-object\n     */\n    regexFromString: function (input, modifiers) {\n      if (modifiers === undefined) {\n        modifiers = '';\n      }\n\n      return new RegExp(input, modifiers);\n    }\n  }\n});\n","/**\n * Code the extract data from annotations (e.g. appinfo, documentation) in Element/Attribute\n */\nqx.Mixin.define('cv.ui.manager.model.schema.MAnnotation', {\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.__linkRegex = new RegExp(':ref:[`\\'](.+?)[`\\']', 'g');\n    this.__language = qx.locale.Manager.getInstance().getLanguage() === 'de' ? 'de' : 'en';\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * cache for getAppinfo\n     * @var array\n     */\n    __appInfoCache: null,\n    __linkRegex: null,\n    __language: null,\n\n    /**\n     * cache for getDocumentation\n     * @var array\n     */\n    __documentationCache: null,\n\n    __getTextNodesByXPath: function (node, xpath) {\n      const texts = [];\n      const doc = node.ownerDocument;\n      const nsResolver = doc.createNSResolver(doc.documentElement);\n      let iterator = doc.evaluate(xpath, node, nsResolver, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);\n      try {\n        let thisNode = iterator.iterateNext();\n\n        while (thisNode) {\n          texts.push(thisNode.textContent);\n          thisNode = iterator.iterateNext();\n        }\n      } catch (e) {\n        this.error('Error: Document tree modified during iteration ' + e);\n      }\n      return texts;\n    },\n\n    /**\n     * get the appinfo information from the element, if any\n     *\n     * @return  array   list of texts, or empty list if none\n     */\n    getAppinfo: function () {\n      if (this.__appInfoCache !== null) {\n        return this.__appInfoCache;\n      }\n      const node = this.getNode();\n      const appInfo = this.__getTextNodesByXPath(node, 'xsd:annotation/xsd:appinfo');\n      const type = this.getType();\n      if (type === 'element') {\n        // only aggregate types appinfo if it is not an immediate child of the element-node, but referenced/typed\n        if (node.querySelectorAll(':scope > complexType').length === 0) {\n          appInfo.push(...this.__getTextNodesByXPath(this._type, 'xsd:annotation/xsd:appinfo'));\n        }\n      } else if (type === 'attribute') {\n        if (node.hasAttribute('ref')) {\n          // the attribute is a reference, so take appinfo from there, too\n\n          const refName = node.getAttribute('ref');\n          const ref = this.getSchema().getReferencedNode('attribute', refName);\n\n          appInfo.push(...this.__getTextNodesByXPath(ref, 'xsd:annotation/xsd:appinfo'));\n        }\n      }\n\n      // fill the cache\n      this.__appInfoCache = appInfo;\n\n      return appInfo;\n    },\n\n    /**\n     * get the documentation information from the element, if any\n     *\n     * @return  array   list of texts, or empty list if none\n     */\n    getDocumentation: function () {\n      if (this.__documentationCache !== null) {\n        return this.__documentationCache;\n      }\n      const node = this.getNode();\n\n      const lang = qx.locale.Manager.getInstance().getLanguage();\n      const selector = 'xsd:annotation/xsd:documentation[@xml:lang=\\'' + lang + '\\']';\n\n      // any appinfo this element itself might carry\n      let documentation = this.__getTextNodesByXPath(node, selector);\n\n      const type = this.getType();\n      if (type === 'element') {\n        // only aggregate types appinfo if it is not an immediate child of the element-node, but referenced/typed\n        if (node.querySelectorAll(':scope > complexType').length === 0) {\n          documentation.push(...this.__getTextNodesByXPath(this._type, selector));\n        }\n      } else if (type === 'attribute') {\n        if (node.hasAttribute('ref')) {\n          // the attribute is a reference, so take appinfo from there, too\n\n          const refName = node.getAttribute('ref');\n          const ref = this.getSchema().getReferencedNode('attribute', refName);\n\n          documentation.push(...this.__getTextNodesByXPath(ref, selector));\n\n          documentation = documentation.map(entry => this.createDocumentationWebLinks(entry));\n        }\n      }\n      this.__documentationCache = documentation;\n\n      return documentation;\n    },\n\n\n    /**\n     * Transform documentation text to link to the online documentation when it\n     * contains a reference.\n     * @param text\n     * @return string The transformed input string.\n     */\n    createDocumentationWebLinks: function (text) {\n      const language = this.__language;\n      return text.replace(this.__linkRegex, function(match, contents) {\n        const\n          reference = contents.match(/^(.*?) *<([^<]*)>$/);\n          const label = reference ? reference[1] : contents;\n          const key = reference ? reference[2] : contents;\n\n        return '<a class=\"doclink\" target=\"_blank\" href=\"' + cv.ui.manager.model.schema.DocumentationMapping.MAP._base + language + cv.ui.manager.model.schema.DocumentationMapping.MAP[key] + '\">' + label + '</a>';\n      });\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__appInfoCache = null;\n    this.__documentationCache = null;\n    this.__linkRegex = null;\n  }\n});\n","/**\n * a single element from the schema\n */\nqx.Class.define('cv.ui.manager.model.schema.Element', {\n  extend: cv.ui.manager.model.schema.Base,\n  include: cv.ui.manager.model.schema.MAnnotation,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Get the name of a schema-element\n     * @param e object  element to find the name of\n     * @param schema\n     * @return  string          name of the element\n     * @throws  if the name can not be found\n     */\n    getElementName: function(e, schema) {\n      if (e.hasAttribute('name')) {\n        return e.getAttribute('name');\n      }\n\n      if (e.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = e.getAttribute('ref');\n        const ref = schema.getReferencedNode('element', refName);\n\n        if (ref.length !== 1) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n\n        return ref.getAttribute('name');\n      }\n\n      return 'unknown';\n    },\n\n    /**\n     * find the type-node for this element\n     * @param node\n     * @param schema\n     * @return  object  object of the type-Node\n     */\n    getTypeNode: function (node, schema) {\n      let type;\n\n      if (node.hasAttribute('type')) {\n        if (node.getAttribute('type').match(/^xsd:/)) {\n          // if it starts with xsd:, it's actually a simple type\n          // does not start with\n          type = node;\n        } else {\n          // otherwise, the element is linked to a complexType\n          type = schema.getTypeNode('complex', node.getAttribute('type'));\n        }\n      } else if (node.hasAttribute('ref')) {\n        // the link is a reference to another element, which means it does not even have it's own name.\n        // this one is most certainly deprecated, as we do not have many root-level-elements, and only those can\n        // be ref'ed\n      } else {\n        // the element is it's own type\n        type = node.querySelector(':scope > complexType');\n      }\n\n      return type;\n    },\n\n    sortChildNodes: function (sorting) {\n      /**\n       * the comparison-function that helps the sorting\n       *\n       * @param   a   mixed   whatever sort gives us\n       * @param   b   mixed   whatever sort gives us\n       * @return  integer     -1, 0, 1 - depending on sort-order\n       */\n      return function (a, b) {\n        let aSortvalue = sorting[a.name];\n        let bSortvalue = sorting[b.name];\n\n        if (aSortvalue === undefined || bSortvalue === undefined) {\n          // undefined means: no sorting available\n          return 0;\n        }\n\n        if (aSortvalue === bSortvalue) {\n          // identical means 'no sorting necessary'\n          return 0;\n        }\n\n        // we need to go through the complete list of values the sorting is composed of,\n        // to find the first one that distinguishes a from b\n\n        // first, typecast to string!\n        if (typeof aSortvalue !== 'string') {\n          aSortvalue = aSortvalue.toString();\n        }\n        if (typeof bSortvalue !== 'string') {\n          bSortvalue = bSortvalue.toString();\n        }\n\n        let aSortvaluesList = aSortvalue.split('.');\n        let bSortvaluesList = bSortvalue.split('.');\n\n        for (let i = 0; i < aSortvaluesList.length; ++i) {\n          if (aSortvaluesList[i] < bSortvaluesList[i]) {\n            return -1;\n          } else if (aSortvaluesList[i] > bSortvaluesList[i]) {\n            return 1;\n          }\n        }\n\n        // if nothing else matched, then they are treated equal\n        return 0;\n      };\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'element'\n    },\n\n    name: {\n      check: 'String',\n      init: ''\n    },\n\n    defaultValue: {\n      check: 'String',\n      nullable: true\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeSortable'\n    },\n\n    mixed: {\n      check: 'Boolean',\n      init: false\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __allowedContentLoaded: false,\n    __allowedContent: null,\n    __allowedAttributes: null,\n    __textNodeSchemaElement: null,\n\n    /**\n     * get and set the type-node for the element\n     * @var object  Type-Node (most certainly a complexType)\n     */\n    _type: null,\n\n    parse: function () {\n      this.base(arguments);\n      const node = this.getNode();\n      const schema = this.getSchema();\n\n      this._type = cv.ui.manager.model.schema.Element.getTypeNode(node, schema);\n      this.setName(cv.ui.manager.model.schema.Element.getElementName(node, schema));\n      if (node.hasAttribute('default')) {\n        this.setDefaultValue(node.getAttribute('default'));\n      }\n      this.setMixed(this._type.hasAttribute('mixed') && this._type.getAttribute('mixed') === 'true');\n    },\n\n    /**\n     * get a list of allowed elements for this element\n     *\n     * @return  object  object of SchemaElement-elements, key is the name\n     */\n    getAllowedContent: function () {\n      if (this.__allowedContent !== null) {\n        // if we have parsed this already, we can simply return the 'cache'\n        return this.__allowedContent;\n      }\n      const schema = this.getSchema();\n\n      const allowedContent = {\n        _grouping: undefined,\n        _text: false\n      };\n\n      // allowed sub-elements\n      // can be either simpleContent, or (choice|sequence|group|all)?\n      // 'all' is not supported yet.\n\n      if (this._type.querySelectorAll(':scope > simpleContent').length > 0) {\n        // it's simpleContent? Then it's either extension or restriction\n        // anyways, we will handle it, as if it were a simpleType\n        allowedContent._text = new cv.ui.manager.model.schema.SimpleType(this._type.querySelector(':scope > simpleContent'), schema);\n      } else if (this._type.querySelectorAll('complexType > choice, complexType> sequence, complexType > group').length > 0) {\n        // we have a choice, group or sequence. great\n        // as per the W3C, only one of these may appear per element/type\n\n        let tmpDOMGrouping = this._type.querySelector('complexType > choice, complexType > sequence, complexType > group');\n\n        // create the appropriate Schema*-object and append it to this very element\n        switch (tmpDOMGrouping.nodeName) {\n          case 'xsd:choice':\n          case 'choice':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Choice(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:sequence':\n          case 'sequence':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Sequence(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:group':\n          case 'group':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Group(tmpDOMGrouping, schema);\n            break;\n          case 'xsd:any':\n          case 'any':\n            allowedContent._grouping = new cv.ui.manager.model.schema.Any(tmpDOMGrouping, schema);\n            break;\n        }\n      } else if (this._type.hasAttribute('type') && this._type.getAttribute('type').match(/^xsd:/)) {\n        // this is a really simple node that defines its own baseType\n        allowedContent._text = new cv.ui.manager.model.schema.SimpleType(this._type, schema);\n      } else {\n        // no type, no children, no choice - this is an element with NO allowed content/children\n        this.__allowedContent = allowedContent;\n        return allowedContent;\n      }\n\n\n      const children = Array.from(this._type.querySelectorAll(':scope > element'));\n      children.forEach(sub => {\n        const subElement = new cv.ui.manager.model.schema.Element(sub, schema);\n        allowedContent[subElement.getName()] = subElement;\n      });\n\n      // fill the cache\n      this.__allowedContent = allowedContent;\n\n      return allowedContent;\n    },\n\n    /**\n     * get and set the list of allowed attributes\n     * @var array   List of SchemaAttribute-objects\n     */\n    getAllowedAttributes: function () {\n      if (this.__allowedAttributes === null) {\n        const allowedAttributes = {};\n\n        // allowed attributes\n        const attributes = Array.from(this._type.querySelectorAll(':scope > attribute, :scope > simpleContent > extension > attribute'));\n\n        // now add any attribute that comes from an attribute-group\n        const attributeGroups = Array.from(this._type.querySelectorAll(':scope > attributeGroup, :scope > simpleContent > extension > attributeGroup'));\n\n        attributeGroups.forEach(aGroup => {\n          // get get group itself, by reference if necessary\n          // then extract all attributes, and add them to the list of already know attributes\n\n          let attributeGroup = {};\n          if (aGroup.hasAttribute('ref')) {\n            // we do have a reffed group\n            attributeGroup = this.getSchema().getReferencedNode('attributeGroup', aGroup.getAttribute('ref'));\n          } else {\n            attributeGroup = aGroup;\n          }\n\n          Array.from(attributeGroup.querySelectorAll(':scope > attribute')).forEach(child => {\n            attributes.push(child);\n          });\n        });\n\n        // convert all allowed attributes to a more object-oriented approach\n        attributes.forEach(attr => {\n          const attribute = new cv.ui.manager.model.schema.Attribute(attr, this.getSchema());\n          allowedAttributes[attribute.getName()] = attribute;\n        });\n\n        this.__allowedAttributes = allowedAttributes;\n      }\n      return this.__allowedAttributes;\n    },\n\n    /**\n     * are this elements children sortable? this is not the case if a sequence is used, e.g.\n     *\n     * @return  boolean     are children sortable?\n     */\n    areChildrenSortable: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        return true;\n      }\n\n      // the inverse of \"do the elements have a given order?\"\n      return !allowedContent._grouping.getElementsHaveOrder();\n    },\n\n    /**\n     * get a list of required elements.\n     * if an element is required multiple times, it is listed multiple times\n     *\n     * @return  array   list of required elements\n     */\n    getRequiredElements: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping !== undefined) {\n        // we do have a grouping as a child\n        return allowedContent._grouping.getRequiredElements();\n      }\n\n      // there is no grouping, hence no elements defined as children\n      return [];\n    },\n\n    /**\n     * get a list of all allowed elements for this element\n     * @param excludeComment\n     * @return  object  list of SchemaElement-elements, key is the name\n     */\n    getAllowedElements: function (excludeComment) {\n      const allowedContent = this.getAllowedContent();\n\n      const allowedElements = {};\n      if (allowedContent._grouping !== undefined) {\n        Object.assign(allowedElements, allowedContent._grouping.getAllowedElements());\n      }\n\n      let textOnly = false;\n      if (this.isMixed()) {\n        // mixed elements are allowed to have #text-nodes\n        allowedElements['#text'] = this.getSchema().getTextNodeSchemaElement();\n      } else if (allowedContent._text && allowedContent._grouping === undefined) {\n        // text only\n        allowedElements['#text'] = allowedContent._text;\n        textOnly = true;\n      }\n\n      if (!textOnly && !excludeComment) {\n        // although its basically allowed to add comments in a text-only content, we do not allow it\n        allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n      }\n\n      return allowedElements;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     *\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping !== undefined) {\n        return allowedContent._grouping.getAllowedElementsSorting();\n      }\n\n      return undefined;\n    },\n\n    getFirstLevelElementSorting: function () {\n      const allowedSorting = this.getAllowedElementsSorting();\n      if (allowedSorting) {\n        // we only care about the first level here\n        Object.keys(allowedSorting).forEach(name => {\n          let sort = allowedSorting[name];\n          if (typeof sort === 'string') {\n            sort = parseInt(sort.split('.')[0]);\n          }\n          allowedSorting[name] = sort;\n        });\n      }\n      return allowedSorting;\n    },\n\n    /**\n     * get the bounds for this elements children (as defined by a choice)\n     *\n     * @return  object  bounds ({min: x, max: y})\n     */\n    getChildBounds: function () {\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // no choice = no idea about bounds\n        return undefined;\n      }\n\n      if (allowedContent._grouping.hasMultiLevelBounds() === true) {\n        // if our choice has sub-choices, then we have not fucking clue about bounds (or we can not process them)\n        return undefined;\n      }\n\n      return allowedContent._grouping.getBounds();\n    },\n\n    /**\n     * get the bounds for a specific element-name\n     * will go through all of the groupings-tree to find out, just how many elements of this may appear\n     *\n     * @param   childName   string  name of the child-to-be\n     * @return  object              {min: x, max: y}\n     */\n    getBoundsForElementName: function (childName) {\n      const allowedContent = this.getAllowedContent();\n\n      return allowedContent._grouping.getBoundsForElementName(childName);\n    },\n\n    /**\n     * check if a text-only-node is allowed ...\n     *\n     * @return  boolean\n     */\n    isTextContentAllowed: function () {\n      if (this.isMixed()) {\n        // mixed means that we allow for text-content\n        return true;\n      }\n\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._text !== undefined && allowedContent._text !== false) {\n        // if _text is defined and there, we assume that text-content is allowed\n        return true;\n      }\n\n      // had no reason to allow text-content, so gtfoml!\n      return false;\n    },\n\n    isTextContentRequired: function () {\n      if (this.isTextContentAllowed()) {\n        return !this.isMixed() && !this.getAllowedContent()._text.isValueValid('');\n      }\n      return false;\n    },\n\n    /**\n     * check if an element (specified by its name) is allowed as one of our immediate children\n     * Goes recursive if we have choices.\n     *\n     * @param   child   string  name of the element we want to check\n     * @return  boolean         is this element allowed?\n     */\n    isChildElementAllowed: function (child) {\n      if (child === '#text' || child === '#cdata-section') {\n        // text-nodes are somewhat special :)\n        return this.isTextContentAllowed();\n      } else if (child === '#comment') {\n        return true;\n      }\n\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // when there is no choice, then there is no allowed element\n        return false;\n      } \n        // see, if this child is allowed with our choice\n        return allowedContent._grouping.isElementAllowed(child);\n    },\n\n\n    /**\n     * get the SchemaElement-object for a certain element-name.\n     * May return undefined if no element is found, so you might be interested in checking isElementAllowed beforehand.\n     *\n     * @param   elementName string  name of the element to find the SchemaElement for\n     * @return  object              SchemaElement-object, or undefined if none is found\n     */\n    getSchemaElementForElementName: function (elementName) {\n      // first, get a list of allowed content (don't worry, it's cached)\n      const allowedContent = this.getAllowedContent();\n\n      if (elementName === '#text' || elementName === '#cdata-section') {\n        // no special handling for mixed nodes, they do have a #text-SchemaElement already!\n        // text-nodes may be allowed. we will see ...\n        if (this.isTextContentAllowed() === false) {\n          return undefined;\n        }\n\n        if (!this.__textNodeSchemaElement) {\n          const tmpXML = this.getSchema().getSchemaDOM().createElement('element');\n          tmpXML.setAttribute('name', '#text');\n          tmpXML.setAttribute('type', 'xsd:string');\n          this.__textNodeSchemaElement = new cv.ui.manager.model.schema.Element(tmpXML, this.getSchema());\n          if (allowedContent._text) {\n            this.__textNodeSchemaElement.getAllowedContent()._text = allowedContent._text;\n          } else if (this.isMixed()) {\n            this.__textNodeSchemaElement.getAllowedContent._text = this.getSchema().getTextNodeSchemaElement();\n          }\n        }\n        return this.__textNodeSchemaElement;\n      } else if (elementName === '#comment') {\n        // comments are always allowed\n        return this.getSchema().getCommentNodeSchemaElement();\n      }\n\n      if (allowedContent._grouping === undefined) {\n        // when there is no choice, then there is no allowed element\n        return undefined;\n      }\n\n      // go over our choice, if the element is allowed with it\n      if (allowedContent._grouping.isElementAllowed(elementName)) {\n        // only look in this tree, if the element is allowed there.\n        return allowedContent._grouping.getSchemaElementForElementName(elementName);\n      }\n\n      return undefined;\n    },\n\n    /**\n     * return the DOM this Schema is based on\n     *\n     * @return  object  DOM of $xsd\n     */\n    getSchemaDOM: function () {\n      return this.getSchema().getSchemaDOM();\n    },\n\n    /**\n     * check if a given value is valid for this element\n     *\n     * @param   value   string  value to check\n     * @return  boolean         is it valid?\n     */\n    isValueValid: function (value) {\n      if (this.isTextContentAllowed() === false) {\n        // if no text-content is allowed, then it can not be valid\n        return false;\n      }\n\n      if (this.isMixed()) {\n        // mixed is always good!\n        return true;\n      }\n\n      const allowedContent = this.getAllowedContent();\n\n      return allowedContent._text.isValueValid(value);\n    },\n\n    /**\n     * create and retrieve the part of a regular expression which describes this very element\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string\n     */\n    getRegex: function (separator, nocapture) {\n      if (typeof separator === 'undefined' || separator === undefined) {\n        // default to an empty string\n        separator = '';\n      }\n\n      let regexString = '(';\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      // start with the name of the element\n      regexString += this.getName() + separator + ')';\n\n      // append bounds\n      let boundsMin = '';\n      let boundsMax = '';\n      const bounds = this.getBounds();\n      if (bounds.min !== undefined) {\n        boundsMin = bounds.min;\n      }\n\n      if (bounds.max !== undefined) {\n        if (bounds.max !== Number.POSITIVE_INFINITY) {\n          boundsMax = bounds.max;\n        }\n      }\n\n      if (boundsMin !== '' || boundsMax !== '') {\n        // append bounds to the regex-string\n        regexString += '{' + boundsMin + ',' + boundsMax + '}';\n      }\n\n      // and thats all\n      return regexString;\n    },\n\n    /**\n     * create a full-blown regular expression that describes this elements immediate children\n     * @param separator   string  the string used to separate different elements, e.g. ';'\n     * @param nocapture\n     * @return  string              the regular expression\n     */\n    getChildrenRegex: function(separator, nocapture) {\n      if (typeof separator == 'undefined' || separator === undefined) {\n        // default to an empty string\n        separator = '';\n      }\n\n      const allowedContent = this.getAllowedContent();\n\n      if (allowedContent._grouping === undefined) {\n        // not really something to match\n        return '^';\n      }\n\n      return allowedContent._grouping.getRegex(separator, nocapture);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeMap('__allowedAttributes');\n    this._disposeMap('__allowedContent');\n    this._disposeObjects('__textNodeSchemaElement');\n  }\n});\n","/**\n * Represents an Element or TextNode in an XML document\n */\nqx.Class.define('cv.ui.manager.model.XmlElement', {\n  extend: qx.core.Object,\n  include: [\n    qx.data.marshal.MEventBubbling\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schemaElement, editor, parent) {\n    this.base(arguments);\n    this._node = node;\n    const children = new qx.data.Array();\n    if (node) {\n      this._node.$$widget = this;\n      this.initName(node.nodeName);\n      this.setSchemaElement(schemaElement);\n      if (this.hasChildren()) {\n        // we have to add a fake node to the children to show the tree that this node has children\n        // it will be removed when the real children are loaded\n        children.push(new cv.ui.manager.model.XmlElement());\n      }\n      if (editor) {\n        this.setEditor(editor);\n      }\n      if (parent) {\n        this.setParent(parent);\n      }\n      this._maintainIcon();\n      this._maintainStatus();\n    } else {\n      // this is a fake node needed for children simulation\n      this.initName('#temp');\n    }\n    this.initChildren(children);\n    this._initialAttributes = new Map();\n    this.bind('editor.file.writeable', this, 'editable');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    // the current editor this element os shown in\n    editor: {\n      check: 'cv.ui.manager.editor.Tree',\n      nullable: true,\n      event: 'changeEditor'\n    },\n    schemaElement: {\n      check: 'cv.ui.manager.model.schema.Element',\n      apply: '_applySchemaElement'\n    },\n    name: {\n      check: 'String',\n      deferredInit: true,\n      event: 'changeName',\n      apply: '_updateDisplayName'\n    },\n    displayName: {\n      check: 'String',\n      init: '',\n      event: 'changeDisplayName'\n    },\n    open : {\n      check : 'Boolean',\n      event : 'changeOpen',\n      init : false,\n      apply : '_onOpen'\n    },\n    loaded : {\n      check : 'Boolean',\n      event : 'changeLoaded',\n      init : false\n    },\n    children : {\n      check : 'qx.data.Array',\n      event : 'changeChildren',\n      apply: '_applyEventPropagation',\n      deferredInit : true\n    },\n\n    textContent: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyTextContent',\n      event: 'changeTextContent',\n      validate: '_validateTextContent'\n    },\n    /**\n     * Temporary nodes are not save in the backend yet\n     */\n    temporary: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeTemporary'\n    },\n\n    /**\n     * Validation result for this nodes content\n     */\n    valid: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeValid',\n      apply: '_applyValid'\n    },\n\n    invalidMessage: {\n      check: 'String',\n      init: '',\n      event: 'changeInvalidMessage'\n    },\n\n    status: {\n      check: ['error', 'valid', 'comment'],\n      init: 'valid',\n      event: 'changeStatus'\n    },\n\n    editable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeEditable',\n      apply: '_applyEditable'\n    },\n\n    sortable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeSortable'\n    },\n\n    /**\n     * true if this element can be deleted (either no bounds.min or more existing elements)\n     */\n    deletable: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeDeletable'\n    },\n\n    modified: {\n      check: 'Boolean',\n      init: false,\n      apply: '_applyModified'\n    },\n\n    showEditButton: {\n      check: 'Boolean',\n      init: true,\n      event: 'changeShowEditButton'\n    },\n    parent: {\n      check: 'cv.ui.manager.model.XmlElement',\n      nullable: true\n    },\n\n    // icon to show in the tree\n    icon: {\n      check: 'String',\n      nullable: true,\n      event: 'changeIcon'\n    },\n\n    dragging: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeDragging'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _node: null,\n    _schema: null,\n    _schemaElement: null,\n    _initialAttributes: null,\n    _initialChildNames: null,\n    _initialTextContent: null,\n    __initializing: false,\n    __addableChildren: null,\n\n    _maintainStatus: function () {\n      if (this._node.nodeType === Node.COMMENT_NODE) {\n        this.setStatus('comment');\n      } else if (!this.isValid()) {\n        this.setStatus('error');\n      } else {\n        this.setStatus('valid');\n      }\n    },\n\n    _applyValid: function (value) {\n      this._maintainStatus();\n      if (value) {\n        this.resetInvalidMessage();\n      }\n    },\n\n    convertTextNodeType: function (newType) {\n      if (this.isTextNode() && this._node.nodeType !== newType && (newType === Node.TEXT_NODE || newType === Node.CDATA_SECTION_NODE)) {\n        const content = this.getText();\n        const oldNode = this._node;\n        const newTextNode = newType === Node.CDATA_SECTION_NODE ? this._node.ownerDocument.createCDATASection(content) : this._node.ownerDocument.createTextNode(content);\n        if (oldNode.parentNode) {\n          oldNode.parentNode.replaceChild(newTextNode, oldNode);\n        }\n        this._node = newTextNode;\n        this.setName(this._node.nodeName);\n        this.load(true);\n      }\n    },\n\n    _maintainIcon: function () {\n      if (this._node) {\n        if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n          this.setIcon(cv.theme.dark.Images.getIcon('text-fields', 18));\n          return;\n        } else if (this._node.nodeType === Node.COMMENT_NODE) {\n          this.setIcon(cv.theme.dark.Images.getIcon('comment-fields', 18));\n          return;\n        } else if (this.getName() === 'icon' && this.getAttribute('name') && this.getAttribute('name').indexOf('{{') === -1) {\n          // try to use the configured icon (if its not set by a template variable)\n          const source = cv.IconHandler.getInstance().getIconSource(this.getAttribute('name'), 'tree-icon');\n          if (source) {\n            this.setIcon(source);\n            return;\n          }\n        }\n      }\n      if (this.isOpen()) {\n        this.setIcon(cv.theme.dark.Images.getIcon('folder-open', 18));\n      } else {\n        this.setIcon(cv.theme.dark.Images.getIcon('folder', 18));\n      }\n    },\n\n    _applyEditable: function () {\n      this._updateShowEditButton();\n      this.updateDeletable();\n    },\n\n    _updateShowEditButton: function () {\n      const schemaElement = this.getSchemaElement();\n      this.setShowEditButton(\n        schemaElement.isTextContentAllowed() && this.getName().startsWith('#') ||\n        Object.keys(schemaElement.getAllowedAttributes()).length > 0 ||\n        schemaElement.isChildElementAllowed('*') // any element allowed, this is edited as text (outerHTML)\n      );\n    },\n\n    updateDeletable: function () {\n      if (!this.isEditable()) {\n        this.setDeletable(false);\n      } else {\n        const parent = this.getParent();\n        if (this.isTextNode()) {\n          if (this.getSchemaElement().isTextContentRequired()) {\n            const existing = parent.getChildren().filter(child => child.isTextNode()).length;\n            this.setDeletable(existing > 1);\n          } else {\n            this.setDeletable(true);\n          }\n        } else {\n          let deletable = false;\n          if (parent) {\n            const schemaElement = parent.getSchemaElement();\n            const requiredFromParent = schemaElement.getRequiredElements();\n            if (requiredFromParent.includes(this.getName())) {\n              const bounds = schemaElement.getBoundsForElementName(this.getName());\n              if (bounds) {\n                const existing = parent.getChildren().filter(child => child.getName() === this.getName()).length;\n                // check if we can afford to delete one\n                deletable = (bounds.min <= existing - 1);\n              } else {\n                deletable = true;\n              }\n            } else {\n              deletable = true;\n            }\n          } else {\n            deletable = true;\n          }\n          this.setDeletable(deletable);\n        }\n      }\n    },\n\n    getNode: function () {\n      return this._node;\n    },\n\n    remove: function (skipUndo) {\n      const parent = this.getParent();\n      if (parent) {\n        const changes = [{\n          index: parent.getChildren().indexOf(this),\n          parent: parent,\n          child: this\n        }];\n        this._node.remove();\n        parent.getChildren().remove(this);\n        const editor = this.getEditor();\n        this.$$removed = true;\n        if (editor) {\n          // editor should not consider the modification state of removed elements\n          editor.updateModified(this);\n        }\n        parent.updateModified();\n        if (!skipUndo) {\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Remove %1', this.getDisplayName()), this, changes, 'deleted');\n            editor.addUndo(change);\n          }\n        }\n      }\n    },\n\n    /**\n     * Check is this element is an ancestor of the given element\n     * @param element {cv.ui.manager.model.XmlElement} element to check\n     * @returns {boolean}\n     */\n    isAncestor: function (element) {\n      let parent = element.getParent();\n      while (parent) {\n        if (parent === this) {\n          return true;\n        }\n        parent = parent.getParent();\n      }\n      return false;\n    },\n\n    /**\n     * Move this node to a new position in relation to the target\n     * @param target {cv.ui.manager.model.XmlElement} new direct sibling\n     * @param position {String} more 'before', 'after' or 'inside' target\n     * @param skipUndo {Boolean} no not add an undo operation for this\n     * @private\n     */\n    _move: function (target, position, skipUndo) {\n      if (this.isAncestor(target)) {\n        // we cannot move into ourselves descendants\n        return false;\n      }\n      if (target === this) {\n        // do not move ourselves before, after or inside ourselves\n        return false;\n      }\n      const parent = this.getParent();\n      const children = parent.getChildren();\n      const targetParent = position === 'inside' ? target : target.getParent();\n      const targetChildren = targetParent.getChildren();\n      const changes = [{\n        oldIndex: children.indexOf(this),\n        oldParent: parent,\n        parent: targetParent,\n        child: this,\n        index: targetChildren.indexOf(target) + (position === 'after' ? 1 : 0)\n      }];\n      if ((position === 'inside' && targetParent.getSchemaElement().isChildElementAllowed(this.getName())) || targetParent.isChildAllowedAtPosition(this, changes[0].index)) {\n        children.remove(this);\n        this.getNode().remove();\n        if (targetParent === parent) {\n          // target index might have changed by removing\n          changes[0].index = targetChildren.indexOf(target) + (position === 'after' ? 1 : 0);\n        }\n        targetParent.insertChild(this, changes[0].index, true, 'moved');\n        if (!skipUndo) {\n          const editor = this.getEditor();\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Move %1', this.getDisplayName()), this, changes, 'moved');\n            editor.addUndo(change);\n          }\n        }\n        return true;\n      }\n      return false;\n    },\n\n    moveTo: function (newParent, index, skipUndo) {\n      if (this.isAncestor(newParent)) {\n        // we cannot move into ourselves descendants\n        return false;\n      }\n      const parent = this.getParent();\n      const children = parent.getChildren();\n      const changes = [{\n        oldIndex: children.indexOf(this),\n        oldParent: parent,\n        parent: newParent,\n        child: this,\n        index: index\n      }];\n      // save old target index because we are moving inside the same parent, and the target index might change after removing\n      const target = newParent === parent && index < children.length ? children.getItem(index) : null;\n      if (newParent.isChildAllowedAtPosition(this, index)) {\n        children.remove(this);\n        this.getNode().remove();\n\n        if (target) {\n          index = children.indexOf(target);\n          changes[0].index = index;\n        }\n        newParent.insertChild(this, index, true, 'moved');\n        if (!skipUndo) {\n          const editor = this.getEditor();\n          if (editor) {\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Move %1', this.getDisplayName()), this, changes, 'moved');\n            editor.addUndo(change);\n          }\n        }\n        return true;\n      }\n      return false;\n    },\n\n    moveAfter: function (target, skipUndo) {\n      return this._move(target, 'after', skipUndo);\n    },\n\n    moveBefore: function (target, skipUndo) {\n      return this._move(target, 'before', skipUndo);\n    },\n\n    moveInside: function (target, skipUndo) {\n      return this._move(target, 'inside', skipUndo);\n    },\n\n    insertAfter: function (target, skipUndo) {\n      const targetParent = target.getParent();\n      const newIndex = targetParent.getChildren().indexOf(target) + 1;\n      return targetParent.insertChild(this, newIndex, skipUndo, 'added');\n    },\n\n    insertBefore: function (target, skipUndo) {\n      const targetParent = target.getParent();\n      const newIndex = targetParent.getChildren().indexOf(target);\n      return targetParent.insertChild(this, newIndex, skipUndo, 'added');\n    },\n\n    /**\n     * Returns a list of element names that can be added to this element.\n     * Checks the allowed elements and their bounds and the existing children\n     * to find out if we can add more of them.\n     * @param excludeComment {Boolean} exclude #comment child when set to true\n     */\n    getAddableChildren: function(excludeComment) {\n      if (!this.__addableChildren) {\n        if (this.getName().startsWith('#')) {\n          this.__addableChildren = [];\n        } else {\n          const schemaElement = this.getSchemaElement();\n          const allowed = schemaElement.getAllowedElements();\n          const stillAllowed = [];\n          const countExisting = {};\n          if (!this.isLoaded()) {\n            this.load();\n          }\n          this.getChildren().forEach(child => {\n            if (!Object.prototype.hasOwnProperty.call(countExisting, child.getName())) {\n              countExisting[child.getName()] = 0;\n            }\n            countExisting[child.getName()]++;\n          });\n\n          Object.keys(allowed).forEach(elementName => {\n            if (excludeComment === true && elementName === '#comment') {\n              return;\n            }\n            if ((elementName === '#text' || elementName === '#cdata-section')) {\n              if (schemaElement.isTextContentAllowed()) {\n                if (schemaElement.isMixed()) {\n                  // is a mixed content has only one text child and no other childs, we do not allow another text child -> avoid direct text siblings\n                  let textNodes = 0;\n                  let otherNodes = 0;\n                  Object.keys(countExisting).forEach(key => {\n                    if (key === '#text' || key === '#cdata-section') {\n                      textNodes+=countExisting[key];\n                    } else {\n                      otherNodes+=countExisting[key];\n                    }\n                  });\n                  if (textNodes<=otherNodes) {\n                    // we do not allow more text nodes than other nodes (e.g. a sequence of #text, elem would allow another #text node after elem)\n                    stillAllowed.push(elementName);\n                  }\n                } else if (!Object.prototype.hasOwnProperty.call(countExisting, '#text') && !Object.prototype.hasOwnProperty.call(countExisting, '#cdata-section')) {\n                  stillAllowed.push(elementName);\n                }\n              }\n              return;\n            }\n            const childBounds = schemaElement.getBoundsForElementName(elementName);\n            const existing = Object.prototype.hasOwnProperty.call(countExisting, elementName) ? countExisting[elementName] : 0;\n            if (childBounds && childBounds.max > existing) {\n              stillAllowed.push(elementName);\n            }\n          });\n          this.__addableChildren = stillAllowed;\n        }\n      }\n      return this.__addableChildren;\n    },\n\n    /**\n     * Checks if a new child is allowed at the given position\n     * @param xmlElement {cv.ui.manager.model.XmlElement|String} the element or an element name as string\n     * @param index {Number} position to check, use Number.POSITIVE_INFINITY to check if the child is allowed to be appended\n     * @returns {boolean}\n     */\n    isChildAllowedAtPosition: function (xmlElement, index) {\n      const schemaElement = this.getSchemaElement();\n      const nodeName = xmlElement instanceof cv.ui.manager.model.XmlElement ? xmlElement.getName() : xmlElement;\n      if (!schemaElement.isChildElementAllowed(nodeName)) {\n        this.debug(nodeName, 'is not allowed as child of', this.getName());\n        return false;\n      }\n      if (schemaElement.areChildrenSortable()) {\n        // allowed at any position\n        return true;\n      }\n      // check position\n      const allowedSorting = schemaElement.getFirstLevelElementSorting();\n      if (!this.isLoaded()) {\n        this.load();\n      }\n      const children = this.getChildren();\n      if (children.length === 0) {\n        // no children yet, no position problem\n        return true;\n      }\n      let currentPosition = index;\n      if (children.length > index) {\n        currentPosition = allowedSorting[children.getItem(index).getName()];\n      } else {\n        currentPosition = children.length;\n      }\n      let targetPosition = allowedSorting[nodeName];\n      if (currentPosition === targetPosition || targetPosition >= children.length) {\n        // no special position\n        return true;\n      } \n        // find the first previous sibling of a different type\n        let previousSibling;\n        if (index > 0) {\n          for (let i = Math.min(index, children.length) - 1; i >= 0; i--) {\n            if (children.getItem(i).getName() !== nodeName) {\n              previousSibling = children.getItem(i).getName();\n              break;\n            }\n          }\n        }\n        if (previousSibling) {\n          currentPosition = allowedSorting[previousSibling];\n        }\n        // only allow if it can be inserted before\n        const allowed = currentPosition + 1 >= targetPosition;\n        if (!allowed) {\n          this.debug(nodeName, 'is not allowed as child of', this.getName());\n          return false;\n        }\n      \n      return true;\n    },\n\n    findPositionForChild: function(newChild) {\n      const schemaElement = this.getSchemaElement();\n      if (schemaElement.isChildElementAllowed(newChild.getName())) {\n        if (!this.isLoaded()) {\n          this.load();\n        }\n        if (schemaElement.areChildrenSortable()) {\n          // any position is fine, just append it to the end\n          return this.getChildren().length;\n        } \n          const allowedSorting = schemaElement.getFirstLevelElementSorting();\n          if (allowedSorting && Object.prototype.hasOwnProperty.call(allowedSorting, newChild.getName())) {\n            const position = allowedSorting[newChild.getName()];\n            // search for the first sibling with a position > than the newChilds and insert it there\n            let targetIndex = position;\n            const found = this.getChildren().some((child, index) => {\n              const childPos = allowedSorting[child.getName()];\n              if (childPos > position) {\n                targetIndex = index;\n                return true;\n              }\n              return false;\n            });\n            if (!found) {\n              // append to the end\n              targetIndex = this.getChildren().length;\n            }\n            return targetIndex;\n          }\n      }\n      return -1;\n    },\n\n    /**\n     * insert child at given index\n     * @param xmlElement {cv.ui.manager.model.XmlElement} new child\n     * @param index {Number} index to insert the child, if set to -1 insert it at any allowed position\n     * @param skipUndo {Boolean} do not add an undo operation for this change\n     * @param internalOperation\n     * @return {Boolean} true if the child has been added\n     */\n    insertChild: function (xmlElement, index, skipUndo, internalOperation) {\n      if (!this.isLoaded()) {\n        this.load();\n      }\n      const children = this.getChildren();\n      let success = false;\n      if (index === -1) {\n        index = this.findPositionForChild(xmlElement);\n        if (index === -1) {\n          // no valid position found\n          return false;\n        }\n      }\n      if (this.isChildAllowedAtPosition(xmlElement, index)) {\n        if (index >= children.length) {\n          // append\n          this._node.appendChild(xmlElement.getNode());\n          children.push(xmlElement);\n          success = true;\n        } else if (index === 0) {\n          // add before first child\n          this._node.insertBefore(xmlElement.getNode(), this._node.children[0]);\n          children.unshift(xmlElement);\n          success = true;\n        } else {\n          const previousChild = children.getItem(index);\n          if (previousChild) {\n            previousChild.getNode().before(xmlElement.getNode());\n            children.insertBefore(previousChild, xmlElement);\n            success = true;\n          }\n        }\n      }\n      if (success) {\n        const editor = this.getEditor();\n        xmlElement.setParent(this);\n        if (xmlElement.$$removed) {\n          delete xmlElement.$$removed;\n          if (editor) {\n            editor.updateModified(xmlElement);\n          }\n          xmlElement.updateModified();\n        } else if (!internalOperation || internalOperation === 'added') {\n            xmlElement.$$added = true;\n            xmlElement.updateModified();\n          }\n        this.updateModified();\n        if (children.length === 1) {\n          // first child added -> open it\n          this.setOpen(true);\n        }\n        if (!skipUndo) {\n          if (editor) {\n            const changes = [{\n              index: index,\n              parent: this,\n              child: xmlElement\n            }];\n            const change = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Add %1', this.getDisplayName()), this, changes, 'created');\n            editor.addUndo(change);\n          }\n        }\n      }\n      return success;\n    },\n\n    _validateTextContent: function (value) {\n      // do not validate content that is loaded from the actual node\n      if (!this.__initializing) {\n        if (this._node) {\n          if (!this.getSchemaElement().isValueValid(value)) {\n            throw new qx.core.ValidationError(qx.locale.Manager.tr('Invalid text content: \\'%1\\'', value));\n          }\n        } else {\n          throw new qx.core.ValidationError(qx.locale.Manager.tr('Text content not allowed here'));\n        }\n      }\n    },\n\n    /**\n     * Validate this element (and its parent when this is a text node)\n     * @param recursive {Boolean} validate children too\n     */\n    validate: function (recursive) {\n      const schemaElement = this.getSchemaElement();\n      if (this.isTextNode()) {\n        this.getParent().validate(false);\n        this.setValid(schemaElement.isValueValid(this.getText()));\n      } else if (this.isElement()) {\n        const allowedAttributes = schemaElement.getAllowedAttributes();\n        const errors = [];\n        // check attribute values\n        for (let i = 0; i < this._node.attributes.length; i++) {\n          const attr = this._node.attributes.item(i);\n          if (Object.prototype.hasOwnProperty.call(allowedAttributes, attr.name)) {\n            if (!allowedAttributes[attr.name].isValueValid(attr.value)) {\n              errors.push({\n                attribute: attr.name,\n                error: qx.locale.Manager.tr('Invalid value')\n              });\n            }\n          } else {\n            errors.push({\n              attribute: attr.name,\n              error: qx.locale.Manager.tr('Attribute \\'%1\\' not allowed', attr.name)\n            });\n          }\n        }\n        // check for missing required attributes\n        Object.keys(allowedAttributes).filter(name => !allowedAttributes[name].isOptional()).forEach(name => {\n          if (!this._node.hasAttribute(name)) {\n            errors.push({\n              attribute: name,\n              error: qx.locale.Manager.tr('Attribute \\'%1\\' is required but missing', name)\n            });\n          }\n        });\n        if (schemaElement.isTextContentRequired()) {\n          // check if we have at least one non empty #text child\n          const found = this.getChildren().some(child => child.isTextNode() && child.getNode().nodeValue.trim() !== '');\n          if (!found) {\n            errors.push({\n              attribute: '#text',\n              error: qx.locale.Manager.tr('Text content is missing')\n            });\n          }\n        }\n        if (schemaElement.isTextContentAllowed()) {\n          this.getChildren().forEach(child => {\n            if (child.isTextNode()) {\n              child.load();\n              child.setValid(schemaElement.isValueValid(child.getText()));\n              if (!child.isValid()) {\n                child.setInvalidMessage(qx.locale.Manager.tr('Text content is invalid'));\n              }\n            }\n          });\n        }\n        this.setInvalidMessage(errors.map(err => err.error).join('<br/>'));\n        this.setValid(errors.length === 0);\n      }\n    },\n\n    isTextNode: function () {\n      return this.getName() === '#text' || this.getName() === '#cdata-section';\n    },\n\n    _applyTextContent: function (value) {\n      if (!this.__initializing) {\n        if (this._node) {\n          if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n            this._node.nodeValue = value;\n            this._updateDisplayName();\n          } else if (this._node.nodeType === Node.ELEMENT_NODE) {\n            this._node.textContent = value;\n          }\n        }\n      }\n    },\n\n    getText: function () {\n      return this.getTextContent();\n    },\n\n    setText: function (text, nodeName) {\n      let changed = false;\n      let newValue = text;\n      let oldValue = '';\n      if (this.getSchemaElement().isTextContentAllowed()) {\n        oldValue = this.getTextContent();\n        if (this.getSchemaElement().isValueValid(text)) {\n          if (oldValue !== text) {\n            this.setTextContent(text);\n            changed = true;\n          }\n        } else {\n          this.error('\\''+text+'\\' is no valid text content for a \\''+this.getName() + '\\' element');\n        }\n      } else {\n        this.error('text content is not allowed for a \\''+this.getName() + '\\' element');\n      }\n      return {\n        changed: changed,\n        attribute: nodeName || '#text',\n        value: newValue,\n        old: oldValue\n      };\n    },\n\n    getAttribute: function (name) {\n      return this._node.getAttribute(name);\n    },\n\n    setAttribute: function (name, value) {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        const attribute = this.getSchemaElement().getAllowedAttributes()[name];\n        let changed = false;\n        let newValue = value;\n        let oldValue = this._node.hasAttribute(name) ? this._node.getAttribute(name) : '';\n        if (attribute) {\n          if (value === null || value === undefined) {\n            value = '';\n          } else {\n            value = '' + value;\n          }\n          newValue = value;\n          if (attribute.isValueValid(value)) {\n            if (oldValue !== value) {\n              if (!value || value === attribute.getDefaultValue()) {\n                this._node.removeAttribute(name);\n                newValue = '';\n              } else {\n                this._node.setAttribute(name, value);\n              }\n              if (name === 'name') {\n                this._updateDisplayName();\n                if (this.getName() === 'icon') {\n                  this._maintainIcon();\n                }\n              }\n              changed = true;\n            }\n          } else {\n            this.error('\\'' + value + '\\' is not allowed for attribute \\'' + name + '\\'');\n          }\n        } else {\n          this.error('\\'' + name + '\\' is no allowed attribute for a \\'' + this.getName() + '\\' element');\n        }\n        return {\n          changed: changed,\n          attribute: name,\n          value: newValue,\n          old: oldValue\n        };\n      } else if (this._node.nodeType === Node.TEXT_NODE && name === '#text' || (this._node.nodeType === Node.CDATA_SECTION_NODE && name === '#cdata-section')) {\n        return this.setText(value, name);\n      } else if ((this._node.nodeType === Node.COMMENT_NODE && name === '#comment')) {\n        const oldValue = this.getTextContent();\n        const changed = value !== oldValue;\n        this.setTextContent(value);\n        return {\n          changed: changed,\n          attribute: name,\n          value: value,\n          old: oldValue\n        };\n      }\n      return null;\n    },\n\n    /**\n     * @return {Boolean} true if this element is a required child from its parent\n     */\n    isRequired: function () {\n      const parent = this.getParent();\n      if (parent) {\n        const requiredFromParent = parent.getSchemaElement().getRequiredElements();\n        return requiredFromParent.includes(this.getName());\n      }\n      // only root element has nor parent, and a root element is always required\n      return true;\n    },\n\n    setAttributes: function (data) {\n      const changes = [];\n      let change;\n      const parentChanges = [];\n      const isTextNode = (this.getName() === '#text' || this.getName() === '#cdata-section');\n      const parent = this.getParent();\n      Object.keys(data).forEach(attrName => {\n        if (isTextNode && !attrName.startsWith('#')) {\n          // special mode for editing text content from a data provider with hints, those hints must be applied to the parent\n          change = parent.setAttribute(attrName, data[attrName]);\n          if (change.changed) {\n            parentChanges.push(change);\n          }\n        } else if (attrName === '#outerHTML' || attrName === '#innerHTML') {\n          if (this.getSchemaElement().isChildElementAllowed('*')) {\n            const dom = new DOMParser().parseFromString(data[attrName], 'text/xml');\n            if (dom.getElementsByTagName('parsererror').length === 0) {\n              const oldValue = attrName === '#outerHTML' ? this._node.outerHTML : this._node.innerHTML;\n              const newNode = dom.documentElement;\n              if (attrName === '#outerHTML') {\n                const oldNode = this._node;\n                oldNode.parentNode.replaceChild(newNode, oldNode);\n                this._node = newNode;\n                this.setName(this._node.nodeName);\n              } else {\n                this._node.innerHTML = data[attrName];\n              }\n              changes.push({\n                changed: true,\n                attribute: attrName,\n                value: data[attrName],\n                old: oldValue\n              });\n              this.load(true);\n            }\n          } else if (attrName === '#innerHTML' && !data[attrName]) {\n            // allow empty values\n            const oldValue = this._node.innerHTML;\n            this._node.innerHTML = data[attrName];\n            changes.push({\n              changed: true,\n              attribute: attrName,\n              value: data[attrName],\n              old: oldValue\n            });\n            this.load(true);\n          }\n        } else {\n          change = this.setAttribute(attrName, data[attrName]);\n          if (change.changed) {\n            changes.push(change);\n          }\n        }\n      });\n      const editor = this.getEditor();\n      if (editor && changes.length > 0) {\n        if (parentChanges.length > 0) {\n          const parentChange = new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Change %1', parent.getDisplayName()), parent, parentChanges);\n          changes.push(parentChange);\n          parent.updateModified();\n        }\n        editor.addUndo(new cv.ui.manager.model.ElementChange(qx.locale.Manager.tr('Change %1', this.getDisplayName()), this, changes));\n      }\n      this.updateModified();\n    },\n\n    _applySchemaElement: function (schemaElement) {\n      schemaElement.bind('sortable', this, 'sortable', {\n        converter: function (value) {\n          return this.isEditable() && value;\n        }.bind(this)\n      });\n      this._updateShowEditButton();\n    },\n\n    _onOpen: function (value) {\n      if (value && !this.isLoaded()) {\n        this.load();\n      }\n      this._maintainIcon();\n    },\n\n    _applyModified: function () {\n      this._updateDisplayName();\n    },\n\n    _updateDisplayName: function () {\n      let displayName = this.getName();\n      if (this._node) {\n        if (this._node.nodeType === Node.ELEMENT_NODE) {\n          if (this._node.hasAttribute('name')) {\n            const nameAttr = this._node.getAttribute('name');\n            displayName += ' \"' + nameAttr + '\"';\n          } else if (this.getName() === 'pages' && this._node.hasAttribute('design')) {\n            const designAttr = this._node.getAttribute('design');\n            displayName += ' \"' + designAttr + '\"';\n          }\n        } else if ((this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE || this._node.nodeType === Node.COMMENT_NODE) && this._node.nodeValue.trim()) {\n          let textContent = this._node.nodeValue.trim();\n          if (textContent.length > 26) {\n            textContent = textContent.substring(0, 26) + '...';\n          }\n          displayName = textContent;\n        }\n      }\n      if (this.isModified()) {\n        displayName += ' *';\n      }\n      this.setDisplayName(displayName);\n    },\n    hasChildren: function() {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        if (this._node && this._node.hasChildNodes()) {\n          for (let i = 0; i < this._node.childNodes.length; i++) {\n            const childNode = this._node.childNodes.item(i);\n            if (childNode.nodeType === Node.ELEMENT_NODE ||\n              ((childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.CDATA_SECTION_NODE) && childNode.nodeValue.trim() !== '')) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    },\n\n    load: function (force) {\n      if (!this.isLoaded() || force) {\n        this.__initializing = true;\n        const children = this.getChildren();\n        children.removeListener('change', this._syncChildNodes, this);\n        children.removeAll();\n        if (this._node) {\n          if (this._node.nodeType === Node.ELEMENT_NODE) {\n            // read children\n            const schemaElement = this.getSchemaElement();\n            this._initialChildNames = [];\n            for (let i = 0; i < this._node.childNodes.length; i++) {\n              const childNode = this._node.childNodes.item(i);\n              const childSchemaElement = schemaElement.getSchemaElementForElementName(childNode.nodeName);\n              if (childSchemaElement) {\n                if (childNode.nodeType === Node.ELEMENT_NODE) {\n                  const child = new cv.ui.manager.model.XmlElement(childNode, childSchemaElement, this.getEditor(), this);\n                  children.push(child);\n                  this._initialChildNames.push(childNode.nodeName);\n                } else if (childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.CDATA_SECTION_NODE) {\n                  if (childNode.nodeValue.trim()) {\n                    // do not use childSchemaElement here, because our schemeElement already knows how to validate text\n                    const child = new cv.ui.manager.model.XmlElement(childNode, schemaElement, this.getEditor(), this);\n                    if (schemaElement.isMixed()) {\n                      // text nodes can be re-ordered in mixed content\n                      child.setSortable(true);\n                    }\n                    children.push(child);\n                    if (childNode.nodeValue.trim()) {\n                      this._initialChildNames.push(childNode.nodeName);\n                    }\n                  }\n                } else if (childNode.nodeType === Node.COMMENT_NODE) {\n                  if (childNode.nodeValue) {\n                    const child = new cv.ui.manager.model.XmlElement(childNode, childSchemaElement, this.getEditor(), this);\n                    // comment nodes are allowed everywhere. but we do not allow them to be moved via drag&drop now\n                    // because comments might contains template conditions, which will get invalid when moved and we cannot validate that\n                    child.setSortable(false);\n                    children.push(child);\n                    if (childNode.nodeValue.trim()) {\n                      this._initialChildNames.push(childNode.nodeName);\n                    }\n                  }\n                }\n              } else if (childNode.nodeType === Node.ELEMENT_NODE) {\n                if (schemaElement.isChildElementAllowed(childNode.nodeName)) {\n                  // allowed but no schema element\n                  const child = new cv.ui.manager.model.XmlElement(childNode, schemaElement, this.getEditor(), this);\n                  if (schemaElement.isMixed()) {\n                    // text nodes can be re-ordered in mixed content\n                    child.setSortable(true);\n                  }\n                  children.push(child);\n                  this._initialChildNames.push(childNode.nodeName);\n                } else {\n                  // only complain for real childs (no comments, textNodes)\n                  this.setValid(false);\n                  let msg = this.getInvalidMessage();\n                  msg = (msg ? msg + '<br/>' : '') + qx.locale.Manager.tr('Child element \\'%1\\' not allowed.', childNode.nodeName);\n                  this.setInvalidMessage(msg);\n                  this.setValid(false);\n                }\n              }\n            }\n\n            // read attributes\n            this._initialAttributes.clear();\n            for (let i = 0; i < this._node.attributes.length; i++) {\n              const attr = this._node.attributes.item(i);\n              this._initialAttributes.set(attr.name, attr.value);\n            }\n          } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n            this._initialTextContent = this._node.nodeValue;\n            try {\n              this.setTextContent(this._node.nodeValue);\n            } catch (e) {\n              this.appendInvalidMessage(e.toString());\n            }\n          }\n        }\n        this.setLoaded(true);\n        children.addListener('change', this._syncChildNodes, this);\n        this._updateChildrenDeletableFlags();\n        this.__initializing = false;\n      }\n    },\n\n    appendInvalidMessage: function (errorMsg) {\n      if (errorMsg) {\n        const existing = this.getInvalidMessage();\n        this.setInvalidMessage(existing ? existing + '<br/>' + errorMsg : errorMsg);\n      }\n    },\n\n    updateModified: function () {\n      if (this.$$added) {\n        this.setModified(true);\n      } else if (this._node.nodeType === Node.ELEMENT_NODE) {\n        const initial = this._initialAttributes;\n        const currentChildNames = this._currentChildNames();\n        if (this._node.attributes.length !== initial.size) {\n          this.setModified(true);\n        } else if (currentChildNames.length !== this._initialChildNames.length || currentChildNames.join('') !== this._initialChildNames.join('')) {\n          this.setModified(true);\n        } else {\n          for (const [key, value] of initial) {\n            if (!this._node.hasAttribute(key) || this._node.getAttribute(key) !== value) {\n              this.setModified(true);\n              return;\n            }\n          }\n          this.setModified(false);\n        }\n      } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n        this.setModified(this._initialTextContent !== this.getTextContent());\n      }\n      const editor = this.getEditor();\n      if (editor) {\n        editor.updateModified(this);\n      }\n    },\n\n    /**\n     * Special check if this element has modified children (position, of length)\n     * This is used to determine if the preview highlighting needs to be disabled because the xml structure has changed\n     * @returns {*|boolean}\n     */\n    hasChildrenModified: function () {\n      if (this._node.nodeType === Node.ELEMENT_NODE && this.isLoaded()) {\n        const currentChildNames = this._currentChildNames();\n        return this.isModified() && (currentChildNames.length !== this._initialChildNames.length || currentChildNames.join('') !== this._initialChildNames.join(''));\n      }\n      return false;\n    },\n\n    onSaved: function () {\n      if (this._node.nodeType === Node.ELEMENT_NODE) {\n        // read attributes\n        this._initialAttributes.clear();\n        for (let i = 0; i < this._node.attributes.length; i++) {\n          const attr = this._node.attributes.item(i);\n          this._initialAttributes.set(attr.name, attr.value);\n        }\n        this._initialChildNames = this._currentChildNames();\n      } else if (this._node.nodeType === Node.TEXT_NODE || this._node.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) {\n        this._initialTextContent = this._node.nodeValue;\n      }\n      if (this.$$added) {\n        delete this.$$added;\n      }\n      this.setModified(false);\n    },\n\n    isElement: function () {\n      return this._node.nodeType === Node.ELEMENT_NODE;\n    },\n\n    _currentChildNames: function () {\n      const names = [];\n      for (let i = 0; i < this._node.childNodes.length; i++) {\n        const childNode = this._node.childNodes.item(i);\n        if (childNode.nodeType === Node.ELEMENT_NODE) {\n          names.push(childNode.nodeName);\n        } else if ((childNode.nodeType === Node.TEXT_NODE || childNode.nodeType === Node.COMMENT_NODE || this._node.nodeType === Node.CDATA_SECTION_NODE) && childNode.nodeValue.trim()) {\n          names.push(childNode.nodeName);\n        }\n      }\n      return names;\n    },\n\n    _syncChildNodes: function (ev) {\n      // children have changed clear cache\n      this.__addableChildren = null;\n      // we have to update all deletable flags for this elements children, when their siblings changed\n      this._updateChildrenDeletableFlags();\n    },\n\n    _updateChildrenDeletableFlags: function () {\n      if (this.isEditable()) {\n        this.getChildren().forEach(child => {\n          if (child.isElement() || child.isTextNode()) {\n            child.updateDeletable();\n          }\n        });\n      }\n    },\n\n    getWidgetPath: function () {\n      if (this.getName() === '#comment') {\n        return '';\n      }\n      const widgets = this.getSchemaElement().getSchema().getWidgetNames();\n      let current = this;\n      while (current && !widgets.includes(current.getName())) {\n        current = current.getParent();\n      }\n      if (!current) {\n        return '';\n      }\n      if (current.getName() === 'navbar') {\n        return 'navbar' + qx.lang.String.firstUp(current.getAttribute('position'));\n      }\n\n      const ids = [];\n      let c = current;\n      while (c) {\n        const parent = c.getParent();\n        if (parent.getName() === 'pages') {\n          ids.unshift('id');\n          break;\n        }\n        let id = parent.getChildren().filter(child => child.getNode().nodeType === Node.ELEMENT_NODE && child.getName() !== 'layout').indexOf(c);\n        ids.unshift(id);\n        c = parent;\n      }\n      if (current.getName() === 'page') {\n        // make sure that the join ends with '_'\n        ids.push('');\n      }\n      return ids.join('_');\n    },\n\n    // overridden\n    clone: function() {\n      return new cv.ui.manager.model.XmlElement(this._node.cloneNode(true), this.getSchemaElement(), this.getEditor());\n    }\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._node = null;\n    this._schema = null;\n    this._initialAttributes = null;\n    this.__addableChildren = null;\n    this._disposeObjects('_schemaElement');\n  }\n});\n","/**\n * Wrapper class for all data providers.\n */\nqx.Class.define('cv.ui.manager.editor.data.Provider', {\n  extend: qx.core.Object,\n  type: 'singleton',\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this.__cache = {};\n    this._client = cv.io.rest.Client.getDataProviderClient();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    Config: {\n      'address': {\n        '#text': {\n          cache: true,\n          userInputAllowed: true,\n          grouped: true,\n          method: 'getAddresses'\n        }\n      },\n      'rrd': {\n        '#text': {\n          cache: true,\n          userInputAllowed: true,\n          method: 'getRrds'\n        }\n      },\n      'influx': {\n        'measurement': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBs'\n        },\n        'field': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBFields'\n        }\n      },\n      'tag': {\n        'key': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBTags'\n        },\n        'value': {\n          cache: false,\n          live: true,\n          userInputAllowed: false,\n          method: 'getInfluxDBValues'\n        }\n      },\n      'icon': {\n        'name': {\n          cache: true,\n          userInputAllowed: false,\n          method: 'getIcons'\n        }\n      },\n      'plugin': {\n        'name': {\n          cache: true,\n          userInputAllowed: false,\n          method: 'getPlugins'\n        }\n      },\n      'pages': {\n        'design': {\n          method: 'getDesigns',\n          cache: true,\n          userInputAllowed: false\n        }\n      },\n      // wildcard: will match ANY elements attribute (lower prio than an exact element-attribute-match)\n      '*': {\n        'rrd': {\n          method: 'getRrds',\n          cache: true,\n          userInputAllowed: true\n        },\n        'ga': {\n          method: 'getAddresses',\n          cache: true,\n          userInputAllowed: true,\n          grouped: true\n        },\n        'transform': {\n          method: 'getTransforms',\n          cache: true,\n          userInputAllowed: false\n        }\n      }\n    },\n\n    get: function (id, ...args) {\n      const instance = cv.ui.manager.editor.data.Provider.getInstance();\n      const format = 'dp';\n      const [element, attribute] = id.split('@');\n      let config = null;\n      if (this.Config[element] && this.Config[element][attribute]) {\n        config = this.Config[element][attribute];\n      } else if (this.Config['*'][attribute]) {\n        config = this.Config['*'][attribute];\n      }\n      if (config) {\n        const conf = {};\n        if (config.live) {\n          conf.getLive = qx.lang.Function.curry(instance[config.method], format, config).bind(instance);\n        } else {\n          args.unshift(config);\n          args.unshift(format);\n          conf.data = instance[config.method].apply(instance, args);\n        }\n        return Object.assign(conf, config);\n      }\n      return null;\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __cache: null,\n\n    _getFromCache: function (cacheId) {\n      return this.__cache[cacheId];\n    },\n\n    __clearFromCache: function (cacheId) {\n      if (!cacheId) {\n        this.__cache = {};\n      } else {\n        delete this.__cache[cacheId];\n      }\n    },\n\n    _addToCache: function (cacheId, data) {\n      this.__cache[cacheId] = data;\n    },\n\n    /**\n     * Returns the available design names as array of suggestions.\n     * @param format\n     * @param config\n     * @returns {Promise<Array>} suggestions\n     */\n    getDesigns: function (format, config) {\n      if (!config) {\n        config = {cache: true};\n      }\n      return this.__getData('designs', 'designsSync', null, [], format === 'dp' ? function (res) {\n        return res.map(function (designName) {\n          return {\n            label: designName,\n            value: designName\n          };\n        });\n      } : function (res) {\n        return res.map(function (designName) {\n          return {\n            label: designName,\n            insertText: designName,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          };\n        });\n      }, this, config.cache);\n    },\n\n    /**\n     * @param cacheId {String}\n     * @param rpc {String|Function} rpcname to use with this._client or function to call\n     * @param rpcContext {Object} rpc context\n     * @param args {Array} rpc arguments\n     * @param converter {Function} converter that converts the response to suggestions for the text editor\n     * @param converterContext {Object} context fot the converter function\n     * @param cache\n     * @returns {Promise<any>}\n     * @private\n     */\n    __getData: function (cacheId, rpc, rpcContext, args, converter, converterContext, cache) {\n      const cached = cache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return Promise.resolve(converter.call(converterContext || this, cached));\n      } \n        return new Promise(function (resolve, reject) {\n          const handleResponse = function (err, res) {\n            if (err) {\n              reject(err);\n            } else if (typeof res === 'string' && res.startsWith('Error:')) {\n              qx.log.Logger.error(this, res);\n              resolve(converter.call(converterContext || this, []));\n            } else {\n              if (cache) {\n                // cache the raw values not the converted ones\n                this._addToCache(cacheId, res);\n              }\n              resolve(converter.call(converterContext || this, res));\n            }\n          };\n          if (!args) {\n            args = [handleResponse, this];\n          } else {\n            args.push(handleResponse);\n            args.push(this);\n          }\n          if (qx.lang.Type.isString(rpc)) {\n            this._client[rpc].apply(rpcContext || this._client, args);\n          } else if (qx.lang.Type.isFunction(rpc)) {\n            rpc.apply(rpcContext, args);\n          }\n        }.bind(this));\n    },\n\n    __getFromUrl: function (url, converter, converterContext, cache) {\n      let cached = cache ? this._getFromCache(url) : null;\n      if (cached) {\n        if (converter) {\n          cached = converter.call(converterContext || this, cached);\n        }\n        return Promise.resolve(cached);\n      } \n        return new Promise(function (resolve, reject) {\n          const xhr = new qx.io.request.Xhr(url);\n          cv.TemplateEngine.getClient().authorize(xhr);\n          xhr.set({\n            accept: 'application/json'\n          });\n          xhr.addListener('success', ev => {\n            let data = ev.getTarget().getResponse();\n            if (cache) {\n              this._addToCache(url, data);\n            }\n            if (converter) {\n              data = converter.call(converterContext || this, data);\n            }\n            resolve(data);\n            }, this);\n          xhr.addListener('statusError', reject, this);\n          xhr.send();\n        }.bind(this));\n    },\n\n    getAddresses: function (format, config) {\n      const client = cv.TemplateEngine.getClient();\n      if (!config) {\n        config = {cache: true};\n      }\n      if (client.hasProvider('addresses')) {\n        return this.__getFromUrl(client.getProviderUrl('addresses'), client.getProviderConvertFunction('addresses', format), client, config.cache);\n      } \n        return this.__getData('addresses', 'addressesSync', null, [], format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    getRrds: function (format, config) {\n      const client = cv.TemplateEngine.getClient();\n      if (!config) {\n        config = {cache: true};\n      }\n      if (client.hasProvider('rrd')) {\n        return this.__getFromUrl(client.getProviderUrl('rrd'), client.getProviderConvertFunction('rrd', format), client, config.cache);\n      } \n        return this.__getData('rrds', 'rrdsSync', null, [], format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    getInfluxDBs: function (format, config, element) {\n      const args = this.__getInfluxArgs(element, false);\n      return this.__getData('influxdbs', 'influxdbsSync', null, args, format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n    },\n\n    __getInfluxArgs: function (element, withMeasurement) {\n      const args = [];\n      if (element.hasAttribute('authentication')) {\n        args.push({auth: element.getAttribute('authentication')});\n      }\n      if (withMeasurement) {\n        let influx = element;\n        // walk the tree to get the selected data source in the influx element\n        while (influx.nodeName !== 'influx') {\n          influx = influx.parentElement;\n          if (undefined === influx) {\n            // this safety measure can not happen without a bug somewhere!\n            throw new Error();\n          }\n        }\n        args.push({measurement: element.getAttribute('measurement')});\n      }\n      return args;\n    },\n\n    getInfluxDBFields: function (format, config, element) {\n     try {\n       const args = this.__getInfluxArgs(element, true);\n       return this.__getData('influxdbfields|' + args.measurement + '|' + args.auth, 'influxdbfieldsSync', null, args, format === 'dp' ? this._parseDpResponseForEditor : this._parseDpResponseForMonaco, this, config.cache);\n     } catch (e) {\n       return [];\n     }\n    },\n\n    __getInfluxDBTags: function (format, config, element, converter) {\n      try {\n        const args = this.__getInfluxArgs(element, true);\n        return this.__getData('influxdbtags|' + args.measurement + '|' + args.auth, 'influxdbtagsSync', null, args, converter, this, config.cache);\n      } catch (e) {\n        return [];\n      }\n    },\n\n    getInfluxDBTags: function (format, config, element) {\n      return this.__getInfluxDBTags(format, config, element, function (res) {\n        if (format === 'monaco') {\n          return Object.keys(res).map(function (x) {\n            return {\n              label: x,\n              insertText: x,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } \n          return Object.keys(res).map(function (x) {\n            return {value: x, label: x};\n          });\n      });\n    },\n\n    getInfluxDBValues: function (format, config, element, tag) {\n      return this.__getInfluxDBTags(format, config, element, function (res) {\n        if (res === null || !(element.attributes.key in res)) {\n          return [];\n        }\n        if (format === 'monaco') {\n          return res[tag].map(function (x) {\n            return {\n              label: x,\n              insertText: x,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } \n          return res[tag].map(function (x) {\n            return {\n              label: x,\n              value: x\n            };\n          });\n      });\n    },\n\n    _parseDpResponseForMonaco: function (data) {\n      return this.__parseDpResponse(data, 'monaco');\n    },\n\n    _parseDpResponseForEditor: function (data) {\n      return this.__parseDpResponse(data, 'dp');\n    },\n\n    __parseDpResponse: function (data, format) {\n      const target = [];\n      if (!format || format === 'monaco') {\n        data.forEach(function (entry) {\n          target.push({\n            label: entry.label,\n            insertText: entry.value,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          });\n        }, this);\n      } else if (format === 'dp') {\n        return data || [];\n      }\n      return target;\n    },\n\n    getMediaFiles: function (format, config, typeFilter) {\n      const fsClient = cv.io.rest.Client.getFsClient();\n      return this.__getData('media', fsClient.readSync, fsClient, [{path: 'media', recursive: true}], function (res) {\n        return res.filter(function (file) {\n          return !typeFilter || file.name.endsWith('.' + typeFilter);\n        }).map(function (file) {\n          const path = file.parentFolder + file.name;\n          return {\n            label: path,\n            insertText: path,\n            kind: window.monaco.languages.CompletionItemKind.EnumMember\n          };\n        });\n      }, this, config.cache);\n    },\n\n    /**\n     * Returns the list of available transformations as suggestion entry array.\n     * @param format\n     * @param config\n     * @returns {Array}\n     */\n    getTransforms: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const cacheId = 'transforms|' + format;\n      const useCache = !config || config.cache === true;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      }\n      const transforms = [];\n      Object.keys(cv.Transform.registry).forEach(function (key) {\n          const entry = cv.Transform.registry[key];\n          let suggestion;\n          if (format === 'dp') {\n            suggestion = {\n              label: entry.name + ' [' + key + ']',\n              value: key\n            };\n          } else {\n            suggestion = {\n              label: key,\n              insertText: key,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n            if (entry.lname && Object.prototype.hasOwnProperty.call(entry.lname, qx.locale.Manager.getInstance().getLanguage())) {\n              suggestion.detail = entry.lname[qx.locale.Manager.getInstance().getLanguage()];\n            }\n          }\n          transforms.push(suggestion);\n        }, this);\n        if (useCache) {\n          this._addToCache(cacheId, transforms);\n        }\n        return transforms;\n    },\n\n    /**\n     * Returns the plugin names (all defined parts staring with 'plugin-')\n     * @param format\n     * @param config\n     * @returns {Array}\n     */\n    getPlugins: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const useCache = !config || config.cache === true;\n      const cacheId = 'plugins|' + format;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      }\n      const plugins = [];\n      const qxParts = qx.io.PartLoader.getInstance().getParts();\n      Object.keys(qxParts).forEach(function (partName) {\n          if (partName.startsWith('plugin-')) {\n            const pluginName = partName.substring(7);\n            if (format === 'dp') {\n              plugins.push({\n                label: pluginName,\n                value: pluginName\n              });\n            } else {\n              plugins.push({\n                label: pluginName,\n                insertText: pluginName,\n                kind: window.monaco.languages.CompletionItemKind.EnumMember\n              });\n            }\n          }\n        }, this);\n        if (useCache) {\n          this._addToCache(cacheId, plugins);\n        }\n        return plugins;\n    },\n\n    getIcons: function (format, config) {\n      if (!format) {\n        format = 'monaco';\n      }\n      const useCache = !config || config.cache === true;\n      const cacheId = 'icons|' + format;\n      const cached = useCache ? this._getFromCache(cacheId) : null;\n      if (cached) {\n        return cached;\n      } \n        let icons;\n        const iconHandler = cv.IconHandler.getInstance();\n        if (format === 'monaco') {\n          icons = Object.keys(cv.IconConfig.DB).map(function (iconName) {\n            return {\n              label: iconName,\n              insertText: iconName,\n              kind: window.monaco.languages.CompletionItemKind.EnumMember\n            };\n          });\n        } else if (format === 'dp') {\n          // dataprovider format\n          icons = Object.keys(cv.IconConfig.DB).map(function (iconName) {\n            return {\n              label: iconName,\n              value: iconName,\n              icon: iconHandler.getIconSource(iconName)\n            };\n          });\n        }\n        if (useCache) {\n          this._addToCache(cacheId, icons);\n        }\n        return icons;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__cache = null;\n  }\n});\n","/**\n * Show validation errors for a config file.\n */\nqx.Class.define('cv.ui.manager.dialog.ValidationError', {\n  extend: qxl.dialog.Dialog,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  /**\n   *\n   * @param file {cv.ui.manager.model.FileItem}\n   * @param content {String}\n   * @param errors {Array<Map>}\n   * @param properties {Map?}\n   */\n  construct: function (file, content, errors, properties) {\n    this._file = file;\n    this._content = content.split('\\n');\n    this._errors = errors;\n    this.base(arguments, Object.assign(properties || {}, {\n      useBlocker: true\n    }));\n\n    this.addListener('appear', () => {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this.highlight, this);\n      } else {\n        this.highlight();\n      }\n    });\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n   action: 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _content: null,\n    _errors: null,\n    _rootListenerId: null,\n\n    /**\n     * @var {cv.ui.manager.model.FileItem}\n     */\n    _file: null,\n\n    highlight: function () {\n      Array.from(document.querySelectorAll('pre.highlight')).forEach(elem => {\n        monaco.editor.colorizeElement(elem, {\n          theme: 'vs-dark'\n        });\n      });\n    },\n\n    /**\n     * Create the main content of the widget\n     */\n    _createWidgetContent: function() {\n      let container = this._createDialogContainer();\n      let vbox = new qx.ui.container.Composite(new qx.ui.layout.VBox(10));\n      container.add(vbox);\n\n      let prologue = this.tr('<h3>Config Errors</h3>\\\n<p>The validation of \"%1\" showed some errors. It is NOT recommended to edit this file in the XML-Tree editor, because \\\nit can break the file completely. Please open this file in the text editor and fix the errors there. \\\nOnly proceed to edit the file in the XML-Tree editor if you know what you are doing.</p>', this._file.getFullPath());\n\n      let options = this.tr('<p>You can choose between the following options:\\\n<ul>\\\n    <li><b>Cancel</b> - Close this editor</li>\\\n    <li><b>Proceed</b> - Open the defective file in this editor</li>\\\n    <li><b>Open in text editor</b> - Close this editor and open the defective file in the text editor</li>\\\n</ul>\\\n</p>');\n      const labelOptions = {\n        rich: true,\n        width: Math.min(qx.bom.Viewport.getWidth() - 32, 750),\n        allowGrowX: true\n      };\n      const message = new qx.ui.basic.Label(prologue);\n      message.set(labelOptions);\n      vbox.add(message);\n\n      // errors\n      const errorBox = new qx.ui.container.Composite(new qx.ui.layout.VBox(0));\n      const errorScroll = new qx.ui.container.Scroll(errorBox);\n      errorScroll.set({\n        padding: [0, 0, 8, 8],\n        decorator: 'cv-editor-config-section'\n      });\n      errorScroll.setMinHeight(100);\n      errorScroll.setHeight(Math.min(300, qx.bom.Document.getHeight() - 340));\n      this._rootListenerId = qx.core.Init.getApplication().getRoot().addListener('resize', function () {\n        errorScroll.setHeight(Math.min(300, qx.bom.Document.getHeight() - 340));\n      });\n      vbox.add(errorScroll, {flex: 1});\n      const errorLabels = new Map();\n      this._errors.forEach(error => {\n        const errorId = error.line + error.element + error.attribute;\n        let label;\n        if (!errorLabels.has(errorId)) {\n          let codeSnippet = [];\n          const startIndex = Math.max(0, error.line-3);\n          const endIndex = Math.min(this._content.length - 1, error.line+2);\n          let minIndent = Number.POSITIVE_INFINITY;\n          for (let i = startIndex; i < endIndex; i++) {\n            const line = this._content[i];\n            const indent = line.search(/\\S|$/);\n            if (indent < minIndent && indent >= 0) {\n              minIndent = indent;\n            }\n            codeSnippet.push([i+1, line.trimRight()]);\n          }\n          if (minIndent === Number.POSITIVE_INFINITY) {\n            minIndent = 0;\n          }\n          codeSnippet = codeSnippet.map(line => line[0] + ': ' + qx.xml.String.escape(line[1].substr(minIndent)));\n          const headline = this.tr('Line %1', error.line);\n          label = new qx.ui.basic.Label(`<h4>${headline}</h4><pre class=\"highlight\" style=\"background-color: black; padding: 8px;\" data-lang=\"text/xml\">${codeSnippet.join('\\n')}</pre>`);\n          label.set(labelOptions);\n          errorLabels.set(errorId, label);\n          errorBox.add(label);\n        } else {\n          label = errorLabels.get(errorId);\n        }\n        if (!error.message.startsWith('[facet')) {\n          label.setValue(label.getValue() + `<p>${error.message}</p>`);\n        }\n      }, this);\n\n      const option = new qx.ui.basic.Label(options);\n      option.set(labelOptions);\n      vbox.add(option);\n\n      // buttons\n      let buttonPane = this._createButtonPane();\n\n      // close button\n      let closeButton = new qx.ui.form.Button(this.tr('Cancel'));\n      closeButton.addListener('execute', () => this.fireDataEvent('action', 'cancel'), this);\n\n      let proceedButton = new qx.ui.form.Button(this.tr('Proceed'));\n      proceedButton.addListener('execute', () => this.fireDataEvent('action', 'proceed'), this);\n\n      let openSourceButton = new qx.ui.form.Button(this.tr('Open in text editor'));\n      openSourceButton.addListener('execute', () => this.fireDataEvent('action', 'open-source'), this);\n\n      buttonPane.add(closeButton);\n      buttonPane.add(proceedButton);\n      buttonPane.add(openSourceButton);\n\n      container.add(buttonPane);\n      this.add(container);\n    }\n  },\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._content = null;\n    this._errors = null;\n    this._file = null;\n    if (this._rootListenerId) {\n      qx.core.Init.getApplication().getRoot().removeListenerById(this._rootListenerId);\n      this._rootListenerId = null;\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.config.Section', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name) {\n    this.base(arguments);\n    this.setName(name);\n    this.initOptions(new qx.data.Array());\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    name: {\n      check: 'String',\n      event: 'changeName',\n      init: ''\n    },\n\n    options: {\n      check: 'qx.data.Array',\n      deferredInit: true,\n      event: 'changeOptions'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    addOption: function(key, value) {\n      const options = this.getOptions();\n      const found = options.some(function (option) {\n        if (option.getKey() === key) {\n          option.setValue(value);\n          return true;\n        }\n        return false;\n      }, this);\n      if (!found) {\n        options.push(new cv.ui.manager.model.config.Option(key, value));\n      }\n    }\n  }\n});\n","/**\n * This widgets shows and editable config section in a list.\n */\nqx.Class.define('cv.ui.manager.form.SectionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    const grid = new qx.ui.layout.Grid(8, 8);\n    grid.setColumnFlex(1, 1);\n    grid.setColumnAlign(0, 'left', 'top');\n    this._setLayout(grid);\n    this._createChildControl('section-title');\n    this._createChildControl('list');\n    this._createChildControl('delete');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-section'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.config.Section',\n      nullable: false,\n      apply: '_applyModel'\n    },\n\n    modified:{\n      check: 'Boolean',\n      init: false,\n      event: 'changeModified'\n    },\n\n    readOnly: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadOnly'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'delete': 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _listController: null,\n    _originalName: null,\n    _originalOptions: null,\n\n    _applyModel: function (value, old) {\n      const nameField = this.getChildControl('name');\n      this.__unbindModel(old);\n      if (value) {\n        value.bind('name', nameField, 'value');\n        this._originalName = value.getName();\n        this._originalOptions = {};\n        value.getOptions().forEach(function (option) {\n          option.addListener('change', this.__checkForModification, this);\n          this._originalOptions[option.getKey()] = option.getValue();\n        }, this);\n        nameField.bind('value', value, 'name');\n        value.addListener('changeName', this.__checkForModification, this);\n        value.bind('options', this._listController, 'model');\n        // add at least one empty entry, when there are no options\n        if (value.getOptions().length === 0) {\n          const emptyOption = new cv.ui.manager.model.config.Option('', '');\n          value.getOptions().push(emptyOption);\n        }\n      } else {\n        this._originalName = null;\n        this._originalOptions = null;\n      }\n    },\n\n    __unbindModel: function (model) {\n      if (model) {\n        const nameField = this.getChildControl('name');\n        if (this._listController) {\n          model.removeRelatedBindings(this._listController);\n        }\n        model.removeListener('changeName', this.__checkForModification, this);\n        model.removeRelatedBindings(nameField);\n        nameField.removeRelatedBindings(model);\n        model.getOptions().forEach(function (option) {\n          option.removeListener('change', this.__checkForModification, this);\n        }, this);\n      }\n    },\n\n    __checkForModification: function () {\n      if (this._originalName !== this.getModel().getName()) {\n        this.setModified(true);\n        return;\n      }\n      // check if the still have the same the same amount of options\n      if (Object.keys(this._originalOptions).length !== this.getModel().getOptions().length) {\n        this.setModified(true);\n        return;\n      }\n      // compare options one by one\n      const modified = this.getModel().getOptions().some(function (option) {\n        return (!Object.prototype.hasOwnProperty.call(this._originalOptions, option.getKey()) ||\n          this._originalOptions[option.getKey()] !== option.getValue()\n        );\n      }, this);\n      this.setModified(modified);\n    },\n\n    _onDeleteOption: function (ev) {\n      const option = ev.getData();\n      const options = this.getModel().getOptions();\n      if (options.length === 1) {\n        // do not delete the last option, just reset its values\n        option.resetKey();\n        option.resetValue();\n      } else {\n        const removed = this.getModel().getOptions().remove(option);\n        if (removed) {\n          removed.removeListener('change', this.__checkForModification, this);\n        }\n      }\n      this.__checkForModification();\n    },\n\n    _onAddOption: function () {\n      const option = new cv.ui.manager.model.config.Option('', '');\n      option.addListener('change', this.__checkForModification, this);\n      this.getModel().getOptions().push(option);\n      this.__checkForModification();\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'section-title':\n           control = new qx.ui.basic.Label(this.tr('Section'));\n           this._add(control, {row: 0, column: 0});\n           break;\n\n         case 'name':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             required: true\n           });\n           this.bind('readOnly', control, 'readOnly');\n           this._add(control, {row: 0, column: 1});\n           break;\n\n         case 'delete':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n           control.setToolTipText(this.tr('Delete section'));\n           control.addListener('execute', function() {\n             this.fireDataEvent('delete', this.getModel());\n           }, this);\n           this.bind('readOnly', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'hidden' : 'visible';\n             }\n           });\n           this._add(control, {row: 0, column: 2});\n           break;\n\n         case 'list':\n           control = new qx.ui.form.List();\n           control.setEnableInlineFind(false);\n           this._listController = new qx.data.controller.List(null, control);\n           this._listController.setNullValueTitle('header');\n           this._listController.setAllowNull(true);\n           this._listController.setDelegate({\n             createItem: function () {\n               return new cv.ui.manager.form.OptionListItem();\n             },\n             configureItem: function (item) {\n               item.addListener('delete', this._onDeleteOption, this);\n               item.addListener('add', this._onAddOption, this);\n               this.bind('readOnly', item, 'readOnly');\n             }.bind(this),\n             bindItem: function (controller, item, index) {\n               controller.bindProperty('', 'model', null, item, index);\n             }\n           });\n           this._add(control, {row: 1, column: 1});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._disposeObjects('_listController');\n  }\n});\n","/**\n * QX version of the svg use icon way of displaying the KNF-UF icons.\n */\nqx.Class.define('cv.ui.manager.viewer.SvgIcon', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (name) {\n    this.base(arguments);\n    if (name) {\n      this.setName(name);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    name: {\n      check: 'String',\n      nullable: true,\n      apply: '_applyName'\n    },\n\n    appearance: {\n      refine: true,\n      init: 'cv-svg-icon'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __spriteUrl: null,\n    __useElement: null,\n\n    _applyName: function (value) {\n      if (value) {\n        if (!this.__spriteUrl) {\n          this.__spriteUrl = qx.util.ResourceManager.getInstance().toUri('icons/knx-uf-iconset.svg');\n        }\n        if (!this.__useElement.getDomElement()) {\n          this.__useElement.addListenerOnce('appear', function () {\n            this._applyName(value);\n          }, this);\n          return;\n        }\n        // qx.xml.Element.setAttributeNS(document, this.__useElement.getDomElement(), 'http://www.w3.org/1999/xlink', 'xlink:href', this.__spriteUrl + '#kuf-' + value);\n        this.__useElement.getDomElement().setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', this.__spriteUrl + '#kuf-' + value);\n      } else {\n        this.__useElement.removeAttribute('xlink:href');\n      }\n    },\n\n    // overridden\n    _createContentElement : function() {\n      const svgElem = new cv.svg.Element('svg');\n      this.__useElement = new cv.svg.Element('use');\n      svgElem.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n      svgElem.add(this.__useElement);\n      return svgElem;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__useElement = null;\n  }\n});\n","/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Fabian Jakobs (fjakobs)\n     * Sebastian Werner (wpbasti)\n\n************************************************************************ */\n\n/**\n * The image class displays an image file\n *\n * This class supports image clipping, which means that multiple images can be combined\n * into one large image and only the relevant part is shown.\n *\n * *Example*\n *\n * Here is a little example of how to use the widget.\n *\n * <pre class='javascript'>\n *   var image = new qx.ui.basic.Image(\"icon/32/actions/format-justify-left.png\");\n *\n *   this.getRoot().add(image);\n * </pre>\n *\n * This example create a widget to display the image\n * <code>icon/32/actions/format-justify-left.png</code>.\n *\n * *External Documentation*\n *\n * <a href='http://qooxdoo.org/docs/#desktop/widget/image.md' target='_blank'>\n * Documentation of this widget in the qooxdoo manual.</a>\n *\n * NOTE: Instances of this class must be disposed of after use\n *\n */\nqx.Class.define('cv.ui.manager.basic.Image',\n  {\n    extend : qx.ui.core.Widget,\n\n\n\n    /*\n    *****************************************************************************\n       CONSTRUCTOR\n    *****************************************************************************\n    */\n\n    /**\n     * @param source {String?null} The URL of the image to display.\n     */\n    construct : function(source) {\n      this.__contentElements = {};\n\n      this.base(arguments);\n\n      if (source) {\n        this.setSource(source);\n      }\n    },\n\n\n\n\n    /*\n    *****************************************************************************\n       PROPERTIES\n    *****************************************************************************\n    */\n\n    properties :\n      {\n        /** The URL of the image. Setting it will possibly abort loading of current image. */\n        source :\n          {\n            check : 'String',\n            init : null,\n            nullable : true,\n            event : 'changeSource',\n            apply : '_applySource',\n            themeable : true\n          },\n\n\n        /**\n         * Whether the image should be scaled to the given dimensions\n         *\n         * This is disabled by default because it prevents the usage\n         * of image clipping when enabled.\n         */\n        scale :\n          {\n            check : 'Boolean',\n            init : false,\n            event : 'changeScale',\n            themeable : true,\n            apply : '_applyScale'\n          },\n\n        /**\n         * Whether to preserve the image ratio (ie prevent distortion), and which dimension\n         * to prioritise\n         */\n        forceRatio : {\n          init : 'auto',\n          check : [ 'disabled', 'height', 'width', 'auto' ],\n          apply : '_applyDimension'\n        },\n\n        /**\n         * Whether to allow scaling the image up\n         */\n        allowScaleUp : {\n          init : false,\n          check : 'Boolean',\n          apply : '_applyDimension'\n        },\n\n        // overridden\n        appearance :\n          {\n            refine : true,\n            init : 'image'\n          },\n\n\n        // overridden\n        allowShrinkX :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowShrinkY :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowGrowX :\n          {\n            refine : true,\n            init : false\n          },\n\n\n        // overridden\n        allowGrowY :\n          {\n            refine : true,\n            init : false\n          }\n      },\n\n\n    /*\n    *****************************************************************************\n       EVENTS\n    *****************************************************************************\n    */\n\n    events :\n      {\n        /**\n         * Fired if the image source can not be loaded. This event can only be\n         * fired for the first loading of an unmanaged resource (external image).\n         */\n        loadingFailed : 'qx.event.type.Event',\n\n\n        /**\n         * Fired if the image has been loaded. This is even true for managed\n         * resources (images known by generator).\n         */\n        loaded : 'qx.event.type.Event',\n\n\n        /** Fired when the pending request has been aborted. */\n        aborted : 'qx.event.type.Event'\n      },\n\n\n    statics:\n      {\n        PLACEHOLDER_IMAGE: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'\n      },\n\n    /*\n    *****************************************************************************\n       MEMBERS\n    *****************************************************************************\n    */\n\n    members :\n      {\n        __width : null,\n        __height : null,\n        __mode : null,\n        __contentElements : null,\n        __currentContentElement : null,\n        __wrapper : null,\n        __requestId : 0,\n\n\n        // overridden\n        _onChangeTheme : function() {\n          this.base(arguments);\n          // restyle source (theme change might have changed the resolved url)\n          this._styleSource();\n        },\n\n        /*\n        ---------------------------------------------------------------------------\n          WIDGET API\n        ---------------------------------------------------------------------------\n        */\n\n        // overridden\n        getContentElement : function() {\n          return this.__getSuitableContentElement();\n        },\n\n\n        // overridden\n        _createContentElement : function() {\n          return this.__getSuitableContentElement();\n        },\n\n\n        // overridden\n        _getContentHint : function() {\n          return {\n            width : this.__width || 0,\n            height : this.__height || 0\n          };\n        },\n\n        // overridden\n        _applyDecorator : function(value, old) {\n          this.base(arguments, value, old);\n\n          let source = this.getSource();\n          source = qx.util.AliasManager.getInstance().resolve(source);\n          let el = this.getContentElement();\n          if (this.__wrapper) {\n            el = el.getChild(0);\n          }\n          this.__setSource(el, source);\n        },\n\n        // overridden\n        _applyTextColor : function(value) {\n          if (this.__getMode() === 'font') {\n            let el = this.getContentElement();\n            if (this.__wrapper) {\n              el = el.getChild(0);\n            }\n\n            if (value) {\n              el.setStyle('color', qx.theme.manager.Color.getInstance().resolve(value));\n            } else {\n              el.removeStyle('color');\n            }\n          }\n        },\n\n        // overridden\n        _applyPadding : function(value, old, name) {\n          this.base(arguments, value, old, name);\n\n          const element = this.getContentElement();\n          if (this.__wrapper) {\n            element.getChild(0).setStyles({\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          } else if (this.__getMode() === 'font') {\n            element.setStyles({\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          } else {\n            element.setPadding(\n              this.getPaddingLeft() || 0, this.getPaddingTop() || 0\n            );\n          }\n        },\n\n        renderLayout : function(left, top, width, height) {\n          this.base(arguments, left, top, width, height);\n\n          const element = this.getContentElement();\n          if (this.__wrapper) {\n            element.getChild(0).setStyles({\n              width: width - (this.getPaddingLeft() || 0) - (this.getPaddingRight() || 0),\n              height: height - (this.getPaddingTop() || 0) - (this.getPaddingBottom() || 0),\n              top: this.getPaddingTop() || 0,\n              left: this.getPaddingLeft() || 0\n            });\n          }\n        },\n\n\n\n\n        /*\n        ---------------------------------------------------------------------------\n          IMAGE API\n        ---------------------------------------------------------------------------\n        */\n\n        // property apply, overridden\n        _applyEnabled : function(value, old) {\n          this.base(arguments, value, old);\n\n          if (this.getSource()) {\n            this._styleSource();\n          }\n        },\n\n\n        // property apply\n        _applySource : function(value, old) {\n          // abort loading current image\n          if (old) {\n            if (qx.io.ImageLoader.isLoading(old)) {\n              qx.io.ImageLoader.abort(old);\n            }\n          }\n\n          this._styleSource();\n        },\n\n\n        // property apply\n        _applyScale : function(value) {\n          this._styleSource();\n        },\n\n\n        /**\n         * Remembers the mode to keep track which contentElement is currently in use.\n         * @param mode {String} internal mode (alphaScaled|scaled|nonScaled)\n         */\n        __setMode : function(mode) {\n          this.__mode = mode;\n        },\n\n\n        /**\n         * Returns the current mode if set. Otherwise checks the current source and\n         * the current scaling to determine the current mode.\n         *\n         * @return {String} current internal mode\n         */\n        __getMode : function() {\n          if (this.__mode === null) {\n            const source = this.getSource();\n\n            if (source && qx.lang.String.startsWith(source, '@')) {\n              this.__mode = 'font';\n            } else if (source && qx.lang.String.startsWith(source, '<svg')) {\n              this.__mode = 'svg';\n            } else {\n              let isPng = false;\n              if (source !== null) {\n                isPng = source.endsWith('.png');\n              }\n\n              if (this.getScale() && isPng && qx.core.Environment.get('css.alphaimageloaderneeded')) {\n                this.__mode = 'alphaScaled';\n              } else if (this.getScale()) {\n                this.__mode = 'scaled';\n              } else {\n                this.__mode = 'nonScaled';\n              }\n            }\n          }\n\n          return this.__mode;\n        },\n\n\n        /**\n         * Creates a contentElement suitable for the current mode\n         *\n         * @param mode {String} internal mode\n         * @return {qx.html.Image} suitable image content element\n         */\n        __createSuitableContentElement : function(mode) {\n          let scale;\n          let tagName;\n          let Clazz = qx.html.Image;\n\n          switch (mode) {\n            case 'svg':\n              Clazz = qx.html.Element;\n              tagName = 'div';\n              break;\n            case 'font':\n              Clazz = qx.html.Label;\n              scale = true;\n              tagName = 'div';\n              break;\n            case 'alphaScaled':\n              scale = true;\n              tagName = 'div';\n              break;\n            case 'nonScaled':\n              scale = false;\n              tagName = 'div';\n              break;\n            default:\n              scale = true;\n              tagName = 'img';\n              break;\n          }\n\n          const element = new (Clazz)(tagName);\n          element.connectWidget(this);\n          element.setStyles({\n            'overflowX': 'hidden',\n            'overflowY': 'hidden',\n            'boxSizing': 'border-box'\n          });\n\n          if (mode === 'font') {\n            element.setRich(true);\n          } else if (mode !== 'svg') {\n            element.setScale(scale);\n\n            if (qx.core.Environment.get('css.alphaimageloaderneeded')) {\n              const wrapper = this.__wrapper = new qx.html.Element('div');\n              element.connectWidget(this);\n              wrapper.setStyle('position', 'absolute');\n              wrapper.add(element);\n              return wrapper;\n            }\n          }\n\n          return element;\n        },\n\n\n        /**\n         * Returns a contentElement suitable for the current mode\n         *\n         * @return {qx.html.Image} suitable image contentElement\n         */\n        __getSuitableContentElement : function() {\n          if (this.$$disposed) {\n            return null;\n          }\n\n          const mode = this.__getMode();\n\n          if (!this.__contentElements[mode]) {\n            this.__contentElements[mode] = this.__createSuitableContentElement(mode);\n          }\n\n          const element = this.__contentElements[mode];\n\n          if (!this.__currentContentElement) {\n            this.__currentContentElement = element;\n          }\n\n          return element;\n        },\n\n\n        /**\n         * Applies the source to the clipped image instance or preload\n         * an image to detect sizes and apply it afterwards.\n         *\n         */\n        _styleSource : function() {\n          const AliasManager = qx.util.AliasManager.getInstance();\n          const ResourceManager = qx.util.ResourceManager.getInstance();\n\n          let source = AliasManager.resolve(this.getSource());\n\n          let element = this.getContentElement();\n          if (this.__wrapper) {\n            element = element.getChild(0);\n          }\n\n          if (!source) {\n            this.__resetSource(element);\n            return;\n          }\n\n          this.__checkForContentElementSwitch(source);\n\n          if ((qx.core.Environment.get('engine.name') == 'mshtml') &&\n            (parseInt(qx.core.Environment.get('engine.version'), 10) < 9 ||\n              qx.core.Environment.get('browser.documentmode') < 9)) {\n            const repeat = this.getScale() ? 'scale' : 'no-repeat';\n            element.tagNameHint = qx.bom.element.Decoration.getTagName(repeat, source);\n          }\n\n          const contentEl = this.__getContentElement();\n\n          // Detect if the image registry knows this image\n          if (ResourceManager.isFontUri(source)) {\n            this.__setManagedImage(contentEl, source);\n            const color = this.getTextColor();\n            if (qx.lang.Type.isString(color)) {\n              this._applyTextColor(color, null);\n            }\n          } else if (source && source.startsWith('<svg')) {\n            this.__setManagedImage(contentEl, source);\n          } else if (ResourceManager.has(source)) {\n            const highResolutionSource = ResourceManager.findHighResolutionSource(source);\n            if (highResolutionSource) {\n              const imageWidth = ResourceManager.getImageWidth(source);\n              const imageHeight = ResourceManager.getImageHeight(source);\n              this.setWidth(imageWidth);\n              this.setHeight(imageHeight);\n\n              // set background size on current element (div or img)\n              const backgroundSize = imageWidth + 'px, ' + imageHeight + 'px';\n              this.__currentContentElement.setStyle('background-size', backgroundSize);\n\n              this.setSource(highResolutionSource);\n              source = highResolutionSource;\n            }\n            this.__setManagedImage(contentEl, source);\n            this.__fireLoadEvent();\n          } else if (qx.io.ImageLoader.isLoaded(source)) {\n            this.__setUnmanagedImage(contentEl, source);\n            this.__fireLoadEvent();\n          } else {\n            this.__loadUnmanagedImage(contentEl, source);\n          }\n        },\n\n\n        /**\n         * Helper function, which fires <code>loaded</code> event asynchronously.\n         * It emulates native <code>loaded</code> event of an image object. This\n         * helper will be called, if you try to load a managed image or an\n         * previously loaded unmanaged image.\n         */\n        __fireLoadEvent : function() {\n          this.__requestId++;\n          qx.bom.AnimationFrame.request(function(rId) {\n            // prevent firing of the event if source changed in the meantime\n            if (rId === this.__requestId) {\n              this.fireEvent('loaded');\n            } else {\n              this.fireEvent('aborted');\n            }\n          }.bind(this, this.__requestId));\n        },\n\n\n        /**\n         * Returns the content element.\n         * @return {qx.html.Image} content element\n         */\n        __getContentElement : function() {\n          let contentEl = this.__currentContentElement;\n          if (this.__wrapper) {\n            contentEl = contentEl.getChild(0);\n          }\n\n          return contentEl;\n        },\n\n\n        /**\n         * Checks if the current content element is capable to display the image\n         * with the current settings (scaling, alpha PNG)\n         *\n         * @param source {String} source of the image\n         */\n        __checkForContentElementSwitch : qx.core.Environment.select('engine.name',\n          {\n            'mshtml' : function(source) {\n              const alphaImageLoader = qx.core.Environment.get('css.alphaimageloaderneeded');\n              const isPng = source.endsWith('.png');\n              const isFont = source.startsWith('@');\n              const isSvg = source.startsWith('<svg');\n\n              if (isFont) {\n                this.__setMode('font');\n              } else if (isSvg) {\n                this.__setMode('svg');\n              } else if (alphaImageLoader && isPng) {\n                if (this.getScale() && this.__getMode() != 'alphaScaled') {\n                  this.__setMode('alphaScaled');\n                } else if (!this.getScale() && this.__getMode() != 'nonScaled') {\n                  this.__setMode('nonScaled');\n                }\n              } else if (this.getScale() && this.__getMode() != 'scaled') {\n                  this.__setMode('scaled');\n                } else if (!this.getScale() && this.__getMode() != 'nonScaled') {\n                  this.__setMode('nonScaled');\n                }\n\n              this.__checkForContentElementReplacement(this.__getSuitableContentElement());\n            },\n\n            'default' : function(source) {\n              const isFont = source && qx.lang.String.startsWith(source, '@');\n              const isSvg = source.startsWith('<svg');\n\n              if (isFont) {\n                this.__setMode('font');\n              } else if (isSvg) {\n                this.__setMode('svg');\n              } else if (this.getScale() && this.__getMode() != 'scaled') {\n                this.__setMode('scaled');\n              } else if (!this.getScale() && this.__getMode() != 'nonScaled') {\n                this.__setMode('nonScaled');\n              }\n\n              this.__checkForContentElementReplacement(this.__getSuitableContentElement());\n            }\n          }),\n\n\n        /**\n         * Checks the current child and replaces it if necessary\n         *\n         * @param elementToAdd {qx.html.Image} content element to add\n         */\n        __checkForContentElementReplacement : function(elementToAdd) {\n          const currentContentElement = this.__currentContentElement;\n\n          if (currentContentElement !== elementToAdd) {\n            if (currentContentElement !== null) {\n              const pixel = 'px';\n              const styles = {};\n\n              //inherit styles from current element\n              const currentStyles = currentContentElement.getAllStyles();\n              if (currentStyles) {\n                for (let prop in currentStyles) {\n                  styles[prop] = currentStyles[prop];\n                }\n              }\n\n              // Don't transfer background image when switching from image to icon font\n              if (this.__getMode() === 'font' || this.__getMode() === 'svg') {\n                delete styles.backgroundImage;\n              }\n\n              // Copy dimension and location of the current content element\n              const bounds = this.getBounds();\n              if (bounds !== null) {\n                styles.width = bounds.width + pixel;\n                styles.height = bounds.height + pixel;\n              }\n\n              const insets = this.getInsets();\n              styles.left = parseInt(currentContentElement.getStyle('left') || insets.left) + pixel;\n              styles.top = parseInt(currentContentElement.getStyle('top') || insets.top) + pixel;\n\n              styles.zIndex = 10;\n\n              const newEl = this.__wrapper ? elementToAdd.getChild(0) : elementToAdd;\n              newEl.setStyles(styles, true);\n              newEl.setSelectable(this.getSelectable());\n\n              if (!currentContentElement.isVisible()) {\n                elementToAdd.hide();\n              } else if (!elementToAdd.isVisible()) {\n                elementToAdd.show();\n              }\n\n              if (!currentContentElement.isIncluded()) {\n                elementToAdd.exclude();\n              } else if (!elementToAdd.isIncluded()) {\n                elementToAdd.include();\n              }\n\n              const container = currentContentElement.getParent();\n\n              if (container) {\n                const index = container.getChildren().indexOf(currentContentElement);\n                container.removeAt(index);\n                container.addAt(elementToAdd, index);\n              }\n              // force re-application of source so __setSource is called again\n              const hint = newEl.getNodeName();\n              if (newEl.setSource) {\n                newEl.setSource(null);\n              } else if (newEl.setValue) {\n                newEl.setValue('');\n              } else {\n                newEl.removeAll();\n              }\n              const currentEl = this.__getContentElement();\n              newEl.tagNameHint = hint;\n              newEl.setAttribute('class', currentEl.getAttribute('class'));\n\n              // Flush elements to make sure the DOM elements are created.\n              qx.html.Element.flush();\n              const currentDomEl = currentEl.getDomElement();\n              const newDomEl = elementToAdd.getDomElement();\n\n              // copy event listeners\n              const listeners = currentContentElement.getListeners() || [];\n              listeners.forEach(function(listenerData) {\n                elementToAdd.addListener(listenerData.type, listenerData.handler, listenerData.self, listenerData.capture);\n              });\n\n              if (currentDomEl && newDomEl) {\n                // Switch the DOM elements' hash codes. This is required for the event\n                // layer to work [BUG #7447]\n                const currentHash = currentDomEl.$$hash;\n                currentDomEl.$$hash = newDomEl.$$hash;\n                newDomEl.$$hash = currentHash;\n              }\n\n              this.__currentContentElement = elementToAdd;\n            }\n          }\n        },\n\n\n        /**\n         * Use the ResourceManager to set a managed image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setManagedImage : function(el, source) {\n          const ResourceManager = qx.util.ResourceManager.getInstance();\n          const isFont = ResourceManager.isFontUri(source);\n          const isSvg = source.startsWith('<svg');\n\n          // Try to find a disabled image in registry\n          if (!this.getEnabled()) {\n            const disabled = source.replace(/\\.([a-z]+)$/, '-disabled.$1');\n            if (!isFont && ResourceManager.has(disabled)) {\n              source = disabled;\n              this.addState('replacement');\n            } else {\n              this.removeState('replacement');\n            }\n          }\n\n          // Optimize case for enabled changes when no disabled image was found\n          if (!isFont && !isSvg && el.getSource() === source) {\n            return;\n          }\n\n          // Special case for non resource manager handled font icons\n          if (isFont) {\n            // Don't use scale if size is set via postfix\n            if (this.getScale() && parseInt(source.split('/')[2], 10)) {\n              this.setScale(false);\n            }\n\n            // Adjust size if scaling is applied\n            let width;\n            let height;\n            if (this.getScale()) {\n              const hint = this.getSizeHint();\n              width = this.getWidth() || hint.width;\n              height = this.getHeight() || hint.height;\n            } else {\n              const font = qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]);\n              if (qx.core.Environment.get('qx.debug')) {\n                this.assertObject(font, 'Virtual image source contains unkown font descriptor');\n              }\n              const size = parseInt(source.split('/')[2] || font.getSize(), 10);\n              width = ResourceManager.getImageWidth(source) || size;\n              height = ResourceManager.getImageHeight(source) || size;\n            }\n\n            this.__updateContentHint(width, height);\n            this.__setSource(el, source);\n          } else if (isSvg) {\n            // Apply source\n            this.__setSource(el, source);\n\n            // Adjust size\n            this.__updateContentHint(40, 40);\n          } else {\n            // Apply source\n            this.__setSource(el, source);\n\n            // Compare with old sizes and relayout if necessary\n            this.__updateContentHint(\n              ResourceManager.getImageWidth(source),\n              ResourceManager.getImageHeight(source)\n            );\n          }\n        },\n\n        _applyDimension : function() {\n          this.base(arguments);\n\n          const isFont = this.getSource() && qx.lang.String.startsWith(this.getSource(), '@');\n          if (isFont) {\n            const el = this.getContentElement();\n            if (el) {\n              if (this.getScale()) {\n                const hint = this.getSizeHint();\n                const width = this.getWidth() || hint.width || 40;\n                const height = this.getHeight() || hint.height || 40;\n                el.setStyle('fontSize', (width > height ? height : width) + 'px');\n              } else {\n                const font = qx.theme.manager.Font.getInstance().resolve(this.getSource().match(/@([^/]+)/)[1]);\n                el.setStyle('fontSize', font.getSize() + 'px');\n              }\n            }\n          } else {\n            this.__updateContentHint();\n          }\n        },\n\n        /**\n         * Use the infos of the ImageLoader to set an unmanaged image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setUnmanagedImage : function(el, source) {\n          const ImageLoader = qx.io.ImageLoader;\n\n          // Apply source\n          this.__setSource(el, source);\n\n          // Compare with old sizes and relayout if necessary\n          const width = ImageLoader.getWidth(source);\n          const height = ImageLoader.getHeight(source);\n          this.__updateContentHint(width, height);\n        },\n\n\n        /**\n         * Use the ImageLoader to load an unmanaged image\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __loadUnmanagedImage : function(el, source) {\n          const ImageLoader = qx.io.ImageLoader;\n\n          if (qx.core.Environment.get('qx.debug')) {\n            // loading external images via HTTP/HTTPS is a common usecase, as is\n            // using data URLs.\n            const sourceLC = source.toLowerCase();\n            if (!sourceLC.startsWith('http') &&\n              !sourceLC.startsWith('data:image/')) {\n              const self = this.self(arguments);\n\n              if (!self.__warned) {\n                self.__warned = {};\n              }\n\n              if (!self.__warned[source]) {\n                this.debug('try to load an unmanaged relative image: ' + source);\n                self.__warned[source] = true;\n              }\n            }\n          }\n\n          // only try to load the image if it not already failed\n          if (!ImageLoader.isFailed(source)) {\n            ImageLoader.load(source, this.__loaderCallback, this);\n          } else {\n            this.__resetSource(el);\n          }\n        },\n\n        /**\n         * Reset source displayed by the DOM element.\n         *\n         * @param el {Element} image DOM element\n         */\n        __resetSource : function(el) {\n          if (el !== null) {\n            if (el instanceof qx.html.Image) {\n              el.resetSource();\n            } else if (el instanceof qx.html.Label) {\n              el.resetValue();\n            } else {\n              el.removeAll();\n            }\n          }\n        },\n\n        /**\n         * Combines the decorator's image styles with our own image to make sure\n         * gradient and backgroundImage decorators work on Images.\n         *\n         * @param el {Element} image DOM element\n         * @param source {String} source path\n         */\n        __setSource: function (el, source) {\n          const isFont = source && qx.lang.String.startsWith(source, '@');\n          const isSvg = source && qx.lang.String.startsWith(source, '<svg');\n\n          if (isSvg) {\n            const child = new qx.html.Element('svg');\n            child.useMarkup(source);\n            el.removeAll();\n            el.add(child);\n          } else if (isFont) {\n            const sparts = source.split('/');\n            let fontSource = source;\n            if (sparts.length > 2) {\n              fontSource = sparts[0] + '/' + sparts[1];\n            }\n\n\n            const ResourceManager = qx.util.ResourceManager.getInstance();\n            const font = qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]);\n            const fontStyles = qx.lang.Object.clone(font.getStyles());\n            delete fontStyles.color;\n            el.setStyles(fontStyles);\n            el.setStyle('font');\n            el.setStyle('display', 'table-cell');\n            el.setStyle('verticalAlign', 'middle');\n            el.setStyle('textAlign', 'center');\n\n            if (this.getScale()) {\n              el.setStyle('fontSize', (this.__width > this.__height ? this.__height : this.__width) + 'px');\n            } else {\n              const size = parseInt(sparts[2] || qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)/)[1]).getSize());\n              el.setStyle('fontSize', size + 'px');\n            }\n\n            const resource = ResourceManager.getData(fontSource);\n            if (resource) {\n              el.setValue(String.fromCharCode(resource[2]));\n            } else {\n              const charCode = parseInt(qx.theme.manager.Font.getInstance().resolve(source.match(/@([^/]+)\\/(.*)$/)[2]), 16);\n              if (qx.core.Environment.get('qx.debug')) {\n                this.assertNumber(charCode, 'Font source needs either a glyph name or the unicode number in hex');\n              }\n              el.setValue(String.fromCharCode(charCode));\n            }\n\n            return;\n          } else if (el.getNodeName() == 'div') {\n            // checks if a decorator already set.\n            // In this case we have to merge background styles\n            const decorator = qx.theme.manager.Decoration.getInstance().resolve(this.getDecorator());\n            if (decorator) {\n              const hasGradient = (decorator.getStartColor() && decorator.getEndColor());\n              const hasBackground = decorator.getBackgroundImage();\n              if (hasGradient || hasBackground) {\n                const repeat = this.getScale() ? 'scale' : 'no-repeat';\n\n                // get the style attributes for the given source\n                const attr = qx.bom.element.Decoration.getAttributes(source, repeat);\n                // get the background image(s) defined by the decorator\n                const decoratorStyle = decorator.getStyles(true);\n\n                const combinedStyles = {\n                  'backgroundImage': attr.style.backgroundImage,\n                  'backgroundPosition': (attr.style.backgroundPosition || '0 0'),\n                  'backgroundRepeat': (attr.style.backgroundRepeat || 'no-repeat')\n                };\n\n                if (hasBackground) {\n                  combinedStyles['backgroundPosition'] += ',' + decoratorStyle['background-position'] || '0 0';\n                  combinedStyles['backgroundRepeat'] += ', ' + decorator.getBackgroundRepeat();\n                }\n\n                if (hasGradient) {\n                  combinedStyles['backgroundPosition'] += ', 0 0';\n                  combinedStyles['backgroundRepeat'] += ', no-repeat';\n                }\n\n                combinedStyles['backgroundImage'] += ',' + (decoratorStyle['background-image'] || decoratorStyle['background']);\n\n                // apply combined background images\n                el.setStyles(combinedStyles);\n\n                return;\n              }\n            } else if (el.setSource) {\n              // force re-apply to remove old decorator styles\n              el.setSource(null);\n            }\n          }\n          if (el.setSource) {\n            el.setSource(source);\n          }\n        },\n\n        /**\n         * Event handler fired after the preloader has finished loading the icon\n         *\n         * @param source {String} Image source which was loaded\n         * @param imageInfo {Map} Dimensions of the loaded image\n         */\n        __loaderCallback : function(source, imageInfo) {\n          // Ignore the callback on already disposed images\n          if (this.$$disposed === true) {\n            return;\n          }\n\n          // Ignore when the source has already been modified\n          if (source !== qx.util.AliasManager.getInstance().resolve(this.getSource())) {\n            this.fireEvent('aborted');\n            return;\n          }\n\n          /// Output a warning if the image could not loaded and quit\n          if (imageInfo.failed) {\n            this.warn('Image could not be loaded: ' + source);\n            this.fireEvent('loadingFailed');\n          } else if (imageInfo.aborted) {\n            this.fireEvent('aborted');\n            return;\n          } else {\n            this.fireEvent('loaded');\n          }\n\n          // Update image\n          this.__setUnmanagedImage(this.__getContentElement(), source);\n        },\n\n\n        /**\n         * Updates the content hint when the image size has been changed\n         *\n         * @param width {Integer} width of the image\n         * @param height {Integer} height of the image\n         */\n        __updateContentHint : function(width, height) {\n          if (width === undefined) {\n            width = this.__width;\n          }\n          if (height === undefined) {\n            height = this.__height;\n          }\n          if (this._recalc(width, height)) {\n            qx.ui.core.queue.Layout.add(this);\n          }\n        },\n\n\n        /**\n         * Recalculates the size of the image, according to scaling parameters\n         * @param originalWidth\n         * @param originalHeight\n         */\n        _recalc: function(originalWidth, originalHeight) {\n          const maxWidth = this.getMaxWidth();\n          const maxHeight = this.getMaxHeight();\n          const minWidth = this.getMinWidth();\n          const minHeight = this.getMinHeight();\n\n          let width = originalWidth;\n          let height = originalHeight;\n\n          const ratio = originalHeight / originalWidth;\n\n          switch (this.getForceRatio()) {\n            case 'height':\n              if (maxHeight !== null && height > maxHeight) {\n                height = maxHeight;\n                width = height / ratio;\n              } else if (height < minHeight) {\n                height = minHeight;\n                width = height / ratio;\n              }\n              if (height < maxHeight && this.isAllowScaleUp()) {\n                height = maxHeight;\n                width = height / ratio;\n              }\n              break;\n\n            case 'width':\n              if (maxWidth !== null && width > maxWidth) {\n                width = maxWidth;\n                height = width * ratio;\n              } else if (width < minWidth) {\n                width = minWidth;\n                height = width * ratio;\n              }\n              if (width < maxWidth && this.isAllowScaleUp()) {\n                width = maxWidth;\n                height = width * ratio;\n              }\n              break;\n\n            case 'auto':\n            case 'bestfit':\n              if (maxWidth !== null && width > maxWidth) {\n                width = maxWidth;\n                height = width * ratio;\n              } else if (width < minWidth) {\n                width = minWidth;\n                height = width * ratio;\n              }\n              if (width < maxWidth && this.isAllowScaleUp()) {\n                width = maxWidth;\n                height = width * ratio;\n              }\n              if (maxHeight !== null && height > maxHeight) {\n                height = maxHeight;\n                width = height / ratio;\n              }\n              break;\n          }\n\n          width = Math.round(width);\n          height = Math.round(height);\n          if (width != this.__width || height != this.__height) {\n            this.__width = width;\n            this.__height = height;\n            return true;\n          }\n          return false;\n        }\n      },\n\n\n    /*\n    *****************************************************************************\n       DESTRUCTOR\n    *****************************************************************************\n    */\n\n    destruct : function() {\n      for (let mode in this.__contentElements) {\n        if (Object.prototype.hasOwnProperty.call(this.__contentElements, mode)) {\n          this.__contentElements[mode].disconnectWidget(this);\n        }\n      }\n\n      delete this.__currentContentElement;\n      if (this.__wrapper) {\n        delete this.__wrapper;\n      }\n\n      this._disposeMap('__contentElements');\n    }\n  });\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.SourceCodeField', {\n  extend : qx.ui.core.Widget,\n  implement : [\n    qx.ui.form.IStringForm,\n    qx.ui.form.IForm\n  ],\n  include : [\n    qx.ui.form.MForm\n  ],\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (value, type) {\n    this.base(arguments);\n    this._init();\n\n    if (type) {\n      this.setType(type);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    /** Fired when the value was modified */\n    'changeValue' : 'qx.event.type.Data'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: 'String',\n      init: 'xml',\n      apply: '_applyType'\n    },\n    // overridden\n    focusable: {\n      refine : true,\n      init : true\n    },\n    autoSize: {\n      check: 'Boolean',\n      init: false,\n      apply: '_autoSize'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _editor: null,\n    __delayedValue: null,\n    __areaHeight: null,\n    _hasBeenEdited: false,\n\n    _applyType: function (value) {\n      if (value && this.__delayedValue) {\n        this.setValue(this.__delayedValue);\n        this.__delayedValue = null;\n      }\n    },\n\n    _autoSize: function () {\n      if (this._editor && this.isAutoSize()) {\n        const contentHeight = (this._editor.getModel().getLineCount() + 1) * 19;\n        this._setAreaHeight(contentHeight);\n      }\n    },\n\n    /**\n     * Sets the element's value.\n     *\n     * @param value {String|null} The new value of the element.\n     */\n    setValue: function(value) {\n      if (!this._hasBeenEdited) {\n        if (this._editor && this.getType()) {\n          this._editor.setValue(value);\n        } else {\n          this.__delayedValue = value;\n        }\n      }\n      this._autoSize();\n    },\n\n\n    /**\n     * Resets the element's value to its initial value.\n     */\n    resetValue : function() {\n      if (this._editor) {\n        this._editor.setValue('');\n      }\n    },\n\n\n    /**\n     * The element's user set value.\n     *\n     * @return {String|null} The value.\n     */\n    getValue : function() {\n      if (this._editor) {\n        return this._editor.getValue();\n      } else if (this.__delayedValue) {\n        return this.__delayedValue;\n      } \n        return '';\n    },\n\n    _init: function () {\n      if (!window.monaco) {\n        cv.ui.manager.editor.Source.load(this._init, this);\n      } else {\n        const domElement = this.getContentElement().getDomElement();\n        if (!domElement) {\n          this.addListenerOnce('appear', () => {\n            this._init();\n          }, this);\n        } else {\n          this._editor = window.monaco.editor.create(domElement, {\n            suggestOnTriggerCharacters: true,\n            folding: true,\n            autoIndent: true,\n            automaticLayout: true,\n            dragAndDrop: true,\n            formatOnPaste: true,\n            formatOnType: true,\n            renderValidationDecorations: 'on',\n            minimap: {\n              enabled: false\n            },\n            theme: 'vs-dark'\n          });\n          if (this.getType()) {\n            const model = this._editor.getModel();\n            const uri = monaco.Uri.parse('cv://SourceCode.' + this.getType());\n            let newModel = window.monaco.editor.getModel(uri);\n            if (!newModel) {\n              newModel = window.monaco.editor.createModel(this.__delayedValue, this.getType(), uri);\n            } else {\n              newModel.setValue(this.__delayedValue);\n            }\n            if (model !== newModel) {\n              newModel.updateOptions({\n                tabSize: 2,\n                indentSize: 2,\n                insertSpaces: true\n              });\n              this._editor.setModel(newModel);\n            }\n          }\n          if (this.__delayedValue) {\n            this.__delayedValue = null;\n          }\n          this._editor.onDidChangeModelContent(this._onContentChange.bind(this));\n        }\n      }\n    },\n\n    _onContentChange: function () {\n      this._hasBeenEdited = true;\n      this.fireDataEvent('changeValue', this._editor.getValue());\n      this._autoSize();\n    },\n\n    // overridden\n    getFocusElement : function() {\n      const el = this.getContentElement();\n      if (el) {\n        return el;\n      }\n      return null;\n    },\n\n    _setAreaHeight: function(height) {\n      if (this.__areaHeight !== height) {\n        this.__areaHeight = height;\n        qx.ui.core.queue.Layout.add(this);\n        qx.ui.core.queue.Manager.flush();\n        if (this._editor) {\n          this._editor.layout();\n        }\n      }\n    },\n\n    // overridden\n    _getContentHint: function() {\n      const hint = this.base(arguments);\n\n      if (this.isAutoSize()) {\n        hint.height = this.__areaHeight || hint.height;\n      }\n\n      return hint;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this._hasBeenEdited = false;\n    if (this._editor) {\n      this._editor.dispose();\n      this._editor = null;\n    }\n  }\n});\n","/**\n * Option model for a VirtualComboBox / -SelectBox\n */\nqx.Class.define('cv.ui.manager.form.Option', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (label, icon, value, hints) {\n    this.base(arguments);\n    if (label) {\n      this.setLabel(label);\n    }\n    if (icon) {\n      this.setIcon(icon);\n    }\n    if (value) {\n      this.setValue(value);\n    }\n    if (hints) {\n      this.setHints(hints);\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      check: ['default', 'group', 'state', 'error'],\n      init: 'default',\n      event: 'changeType'\n    },\n    label: {\n      check: 'String',\n      event: 'changeLabel'\n    },\n    icon: {\n      event: 'changeIcon',\n      nullable: true\n    },\n    value: {\n      check: 'String',\n      event: 'changeValue',\n      nullable: true\n    },\n    hints: {\n      check: 'Object',\n      nullable: true\n    }\n  }\n});\n","/**\n * ListItem that uses cv.ui.manager.basic.Image\n */\nqx.Class.define('cv.ui.manager.form.ListItem', {\n  extend: qx.ui.form.ListItem,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'icon':\n          control = new cv.ui.manager.basic.Image(this.getIcon());\n          control.setAnonymous(true);\n          this._addAt(control, 0);\n          if (this.getIcon() === null || this.getShow() === 'label') {\n            control.exclude();\n          }\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    }\n  }\n});\n","/**\n * qx.ui.form.VirtualSelectBox that uses cv.ui.manager.form.ListItem as 'atom' childcontrol.\n */\nqx.Class.define('cv.ui.manager.form.VirtualSelectBox', {\n  extend: qx.ui.form.VirtualSelectBox,\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // overridden\n    _createChildControlImpl : function(id, hash) {\n      let control;\n\n      switch (id) {\n        case 'atom':\n          control = new cv.ui.manager.form.ListItem('');\n          control.setCenter(false);\n          control.setAnonymous(true);\n\n          this._add(control, {flex:1});\n          break;\n      }\n\n      return control || this.base(arguments, id, hash);\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.form.CheckBox', {\n  extend: qx.ui.form.CheckBox,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _onExecute : function(e) {\n      if (this.isTriState()) {\n        // toggle between three states\n        if (this.getValue() === true) {\n          this.setValue(false);\n        } else if (this.getValue() === false) {\n          this.setValue(null);\n        } else {\n          this.setValue(true);\n        }\n      } else {\n        this.toggleValue();\n      }\n    },\n\n    _applyValue : function(value, old) {\n      this.base(arguments, value, old);\n      if (value === null) {\n        this.setLabel(' - ' + this.tr('not set') + ' - ');\n      } else {\n        this.setLabel('');\n      }\n    }\n  }\n});\n","/**\n * Special form renderer for editing XML-Config elements (allows special help texts for items)\n */\nqx.Class.define('cv.ui.manager.form.ElementFormRenderer', {\n  extend: qxl.dialog.FormRenderer,\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    addItems: function(items, names, title) {\n      if (title !== null) {\n        this._add(\n          this._createHeader(title), {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          }\n        );\n        this._row++;\n      }\n      for (let i = 0; i < items.length; i++) {\n        let item = items[i];\n        let widget;\n        let label;\n        if (item instanceof qx.ui.form.RadioGroup) {\n          if (item.getUserData('orientation') === 'horizontal') {\n            widget = this._createHBoxForRadioGroup(item);\n          } else {\n            widget = this._createWidgetForRadioGroup(item);\n          }\n        } else {\n          widget = item;\n        }\n        if (names[i] && item.getUserData('excluded')) {\n          label = new qx.ui.basic.Label(names[i]);\n          label.setRich(true);\n          this._add(label, {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          });\n        } else if (!names[i]) {\n          this._add(widget, {\n            row: this._row,\n            column: 0,\n            colSpan: 2\n          });\n        } else {\n          label = this._createLabel(names[i], item);\n          label.setRich(true);\n          this._add(label, {\n            row: this._row,\n            column: 0\n          });\n          this._add(widget, {\n            row: this._row,\n            column: 1\n          });\n        }\n        this._row++;\n        if (item.getUserData('help')) {\n          label = new qx.ui.basic.Label(item.getUserData('help'));\n          label.setRich(true);\n          label.setAppearance('helptext');\n          this._add(label, {\n            row: this._row,\n            column: 1\n          });\n          this._row++;\n        }\n        this._add(new qx.ui.menu.Separator(), {\n          row: this._row,\n          column: 0,\n          colSpan: 2\n        });\n        this._row++;\n        if (i === 0) {\n          widget.focus();\n        }\n      }\n    }\n  }\n});\n","/**\n *\n */\nqx.Class.define('cv.ui.manager.model.schema.DocumentationMapping', {\n  type: 'static',\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    MAP: {\n      '_base': 'https://www.cometvisu.org/CometVisu/',\n      'audio': '/latest/manual/config/widgets/audio/index.html#audio',\n      'break': '/latest/manual/config/widgets/break/index.html#break',\n      'colorchooser': '/latest/manual/config/widgets/plugins/colorchooser/index.html#colorchooser',\n      'designtoggle': '/latest/manual/config/widgets/designtoggle/index.html#designtoggle',\n      'diagram': '/latest/manual/config/widgets/plugins/diagram/index.html#diagram',\n      'flavour': '/latest/manual/config/flavour.html#flavour',\n      'gauge': '/latest/manual/config/widgets/plugins/gauge/index.html#gauge',\n      'image': '/latest/manual/config/widgets/image/index.html#image',\n      'imagetrigger': '/latest/manual/config/widgets/imagetrigger/index.html#imagetrigger',\n      'include': '/latest/manual/config/widgets/include/index.html#include',\n      'info': '/latest/manual/config/widgets/info/index.html#info',\n      'infoaction': '/latest/manual/config/widgets/infoaction/index.html#infoaction',\n      'infotrigger': '/latest/manual/config/widgets/infotrigger/index.html#infotrigger',\n      'install-no-pakets': '/latest/manual/install/install-dev.html#install-no-pakets',\n      'line': '/latest/manual/config/widgets/line/index.html#line',\n      'mapping': '/latest/manual/config/mapping.html#mapping',\n      'multitrigger': '/latest/manual/config/widgets/multitrigger/index.html#multitrigger',\n      'page': '/latest/manual/config/widgets/page/index.html#page',\n      'pagejump': '/latest/manual/config/widgets/pagejump/index.html#pagejump',\n      'powerspectrum': '/latest/manual/config/widgets/plugins/powerspectrum/index.html#powerspectrum',\n      'pushbutton': '/latest/manual/config/widgets/pushbutton/index.html#pushbutton',\n      'refresh': '/latest/manual/config/widgets/refresh/index.html#refresh',\n      'reload': '/latest/manual/config/widgets/reload/index.html#reload',\n      'rgb': '/latest/manual/config/widgets/rgb/index.html#rgb',\n      'slide': '/latest/manual/config/widgets/slide/index.html#slide',\n      'speech': '/latest/manual/config/widgets/plugins/speech/index.html#speech',\n      'strftime': '/latest/manual/config/widgets/plugins/strftime/index.html#strftime',\n      'styling': '/latest/manual/config/styling.html#styling',\n      'switch': '/latest/manual/config/widgets/switch/index.html#switch',\n      'system-voraussetzungen': '/latest/manual/#system-voraussetzungen',\n      'text': '/latest/manual/config/widgets/text/index.html#text',\n      'toggle': '/latest/manual/config/widgets/toggle/index.html#toggle',\n      'trigger': '/latest/manual/config/widgets/trigger/index.html#trigger',\n      'urltrigger': '/latest/manual/config/widgets/urltrigger/index.html#urltrigger',\n      'video': '/latest/manual/config/widgets/video/index.html#video',\n      'visu-config-details': '/latest/manual/config/index.html#visu-config-details',\n      'web': '/latest/manual/config/widgets/web/index.html#web',\n      'widgets': '/latest/manual/config/widgets/index.html#widgets'\n    }\n  }\n});\n","/**\n * a single SimpleType from the schema.\n * Should be useable for SimpleContent, too.\n * Is usable for attributes, too.\n */\nqx.Class.define('cv.ui.manager.model.schema.SimpleType', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.__enumerations = [];\n    this.__pattern = [];\n    this.__regexCache = {};\n    this.__bases = [];\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'simpleType'\n    },\n    optional: {\n      check: 'Boolean',\n      init: false\n    },\n\n    /**\n     * the baseType of this element, which is one of the xsd-namespaced types (like 'string')\n     * @var string\n     */\n    baseType: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    __pattern: null,\n    __enumerations: null,\n    __bases: null,\n    __regexCache: null,\n\n    parse: function () {\n      const node = this.getNode();\n      this.setOptional(node.getAttribute('use') === 'required');\n      this.__fillNodeData(node);\n    },\n\n    /**\n     * parse a node, find it's data (restrictions, extensions, bases ... whatever)\n     *\n     * @param   node    DOMNode the node to parse\n     */\n    __fillNodeData: function (node) {\n      const schema = this.getSchema();\n\n      if (node.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = node.getAttribute('ref');\n        node = schema.getReferencedNode('attribute', refName);\n\n        if (!node) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n      }\n\n      if (node.hasAttribute('type')) {\n        // hacked: allow this to be used for attributes\n        const baseType = node.getAttribute('type');\n\n        if (!baseType.match(/^xsd:/)) {\n          // if it's not an xsd-default-basetype, we need to find out what it is\n          const subnode = schema.getReferencedNode('simpleType', baseType);\n          this.__fillNodeData(subnode);\n        } else {\n          this.setBaseType(baseType);\n        }\n        // is this attribute optional?\n        this.setOptional(node.getAttribute('use') !== 'required');\n\n        return;\n      }\n\n      const subNodes = Array.from(node.querySelectorAll(':scope > restriction, :scope > extension, :scope > simpleType > restriction, :scope > simpleType > extension'));\n\n      subNodes.forEach(subNode => {\n        const baseType = subNode.getAttribute('base');\n\n        if (!baseType.match(/^xsd:/)) {\n          // don't dive in for default-types, they simply can not be found\n          const subnode = schema.getReferencedNode('simpleType', baseType);\n          this.__fillNodeData(subnode);\n        } else {\n          this.setBaseType(baseType);\n        }\n        Array.from(subNode.querySelectorAll(':scope > pattern')).forEach(patternNode => {\n          this.__pattern.push(patternNode.getAttribute('value'));\n        });\n\n        Array.from(subNode.querySelectorAll(':scope > enumeration')).forEach(enumerationNode => {\n          this.__enumerations.push(enumerationNode.getAttribute('value'));\n        });\n      });\n\n      if (!this.getBaseType()) {\n        this.setBaseType('xsd:anyType');\n      }\n      this.__bases.push(this.getBaseType());\n    },\n\n    /**\n     * check if a given value is valid for this type\n     *\n     * @param   value   mixed   the value to check\n     * @return  boolean         if the value is valid\n     */\n    isValueValid: function (value) {\n      const baseType = this.getBaseType();\n      const schema = this.getSchema();\n      if (!baseType) {\n        throw new Error('something is wrong, do not have a baseType for type');\n      }\n\n      if (value === '') {\n        // empty values are valid if this node is optional!\n        return this.isOptional();\n      }\n\n      if (baseType.search(/^xsd:/) === -1) {\n        // created our own type, will need to find and use it.\n        const typeNode = schema.getTypeNode('simple', baseType);\n        const subType = new cv.ui.manager.model.schema.SimpleType(typeNode, schema);\n        return subType.isValueValid(value);\n      } \n        // xsd:-namespaces types, those are the originals\n        switch (baseType) {\n          case 'xsd:string':\n          case 'xsd:anyURI':\n          case 'xsd:anyType':\n            if (!(typeof (value) == 'string')) {\n              // it's not a string, but it should be.\n              // pretty much any input a user gives us is string, so this is pretty much moot.\n              return false;\n            }\n            break;\n          case 'xsd:decimal':\n            if (!value.match(/^[-+]?[0-9]*(\\.[0-9]+)?$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:unsignedByte':\n          case 'xsd:nonNegativeInteger':\n            if (!value.match(/^[+]?[0-9]+$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:integer':\n            if (!value.match(/^[-+]?[0-9]+$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:float':\n            if (!value.match(/^[-+]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?$/)) {\n              return false;\n            }\n            break;\n          case 'xsd:boolean':\n            if (!value.match(/^(true|false|0|1)$/)) {\n              return false;\n            }\n            break;\n          default:\n            throw new Error('not implemented baseType ' + baseType);\n        }\n      \n\n      // check if the value is in our list of valid values, if there is such a list\n      if (this.__enumerations.length > 0) {\n        if (!this.__enumerations.includes(value)) {\n          return false;\n        }\n      }\n\n      // check if the value matches any given pattern\n      if (this.__pattern.length > 0) {\n        // start with assuming it's valid\n        let boolValid = true;\n\n        this.__pattern.forEach(item => {\n          if (!Object.prototype.hasOwnProperty.call(this.__regexCache, item)) {\n            // create a regex from the pattern; mind ^ an $ - XSD has them implicitly (XSD Datatypes, Appendix G)\n            // so for our purpose, we need to add them for every branch (that is not inside [])\n            const branchIndices = [];\n            let start = 0;\n            let i = item.indexOf('|', start);\n            while (i < item.length) {\n              if (i < 0) {\n                break;\n              }\n              // go backwards and look for an [ stop looking on ]\n              let isRootBranch = true;\n              for (let j = i; j >= start; j--) {\n                if (item[j] === ']') {\n                  break;\n                } else if (item[j] === '[') {\n                  isRootBranch = false;\n                }\n              }\n              if (isRootBranch) {\n                branchIndices.push([start, i - start]);\n              }\n              start = i + 1;\n              i = item.indexOf('|', start);\n              if (branchIndices.length > 100) {\n                this.error('too many branchIndices');\n                break;\n              }\n            }\n            if (item.length > start) {\n              // append the rest\n              branchIndices.push([start, item.length - start]);\n            }\n            const branches = branchIndices.map(entry => `^${item.substr(entry[0], entry[1]).replace(/\\\\([\\s\\S])|(\\$)/g, '\\\\$1$2')}$`);\n            this.__regexCache[item] = this.regexFromString(branches.join('|'));\n          }\n\n          if (this.__regexCache[item].test(value) === false) {\n            // regular expression did not match\n            // bad bad value!\n            boolValid = false;\n          }\n        }, this);\n\n        // if the value has been marked invalid by a regex, return invalid.\n        if (boolValid === false) {\n          return false;\n        }\n      }\n\n      // if no check said the value is invalid, then it is not invalid\n      return true;\n    },\n\n    /**\n     * get this elements enumeration (if there is any)\n     *\n     * @return  array   list of allowed values (if there are any)\n     */\n    getEnumeration: function () {\n      if (this.getBaseType() === 'xsd:boolean') {\n        // special handling for boolean, as we KNOW it to be an enumeration\n        return ['true', 'false'];\n      }\n\n      return this.__enumerations;\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__regexCache = null;\n  }\n});\n","/**\n * a single choice.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Choice', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'choice'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const node = this.getNode();\n      const schema = this.getSchema();\n      const subElements = Array.from(node.querySelectorAll(':scope > element'));\n      subElements.forEach(elem => {\n        const subElement = new cv.ui.manager.model.schema.Element(elem, schema);\n        subElement.setSortable(true);\n        this._allowedElements[subElement.getName()] = subElement;\n      });\n      this._allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n\n      // choices\n      Array.from(node.querySelectorAll(':scope > choice')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      });\n\n      // sequences\n      Array.from(node.querySelectorAll(':scope > sequence')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n      });\n\n      // groups\n      Array.from(node.querySelectorAll(':scope > group')).forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Group(grouping, schema));\n      });\n    },\n\n    // overridden\n    getRequiredElements: function () {\n      // a choice has no defined required elements\n      // if you want required elements, use sequence or all\n      return [];\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // create list of allowed elements\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      const elementRegexes = [];\n      for (const element of Object.values(this._allowedElements)) {\n        elementRegexes.push(element.getRegex(separator, nocapture));\n      }\n\n      // also collect the regex for each and every grouping we might have\n      this._subGroupings.forEach(grouping => {\n        elementRegexes.push(grouping.getRegex(separator, nocapture));\n      });\n\n      regexString += elementRegexes.join('|');\n\n      regexString += ')';\n\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // as we are a choice, we can define the number of occurences for children of ANY level\n      if (this.isElementAllowed(childName) === true) {\n        return this.getBounds();\n      }\n\n      return undefined;\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * For a choice, all elements have the same sorting, so they will all have the\n     * same sortnumber\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     *\n     * @param   sortnumber  integer the sortnumber of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortnumber) {\n      const namesWithSorting = {};\n\n      // all elements allowed directly\n      Object.keys(this._allowedElements).forEach(function (name) {\n        const item = this._allowedElements[name];\n        let mySortnumber = 'x'; // for a choice, sortnumber is always the same\n        if (sortnumber !== undefined) {\n          mySortnumber = sortnumber + '.' + mySortnumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortnumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortnumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n\n      // all elements allowed by subGroupings\n      this._subGroupings.forEach(function (item, i) {\n        let mySortnumber = 'x'; // for a choice, sortnumber is always the same\n        if (sortnumber !== undefined) {\n          mySortnumber = sortnumber + '.' + mySortnumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortnumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortnumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n      return namesWithSorting;\n    }\n  }\n});\n","/**\n * a single sequence.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Sequence', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'sequence'\n    },\n    elementsHaveOrder: {\n      refine: true,\n      init: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      // for a sequence, we need to keep the order of the elements\n      // so we have to use a 'mixed' approach in reading them\n      const subNodes = Array.from(this.getNode().children);\n\n      subNodes.forEach(subNode => {\n        let subObject;\n\n        switch (subNode.nodeName) {\n          case 'xsd:element':\n          case 'element':\n            subObject = new cv.ui.manager.model.schema.Element(subNode, schema);\n            // sequences' children are non-sortable\n            subObject.setSortable(false);\n            this._allowedElements[subObject.getName()] = subObject;\n            break;\n          case 'xsd:choice':\n          case 'choice':\n            subObject = new cv.ui.manager.model.schema.Choice(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:sequence':\n          case 'sequence':\n            subObject = new cv.ui.manager.model.schema.Sequence(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:group':\n          case 'group':\n            subObject = new cv.ui.manager.model.schema.Group(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n          case 'xsd:any':\n          case 'any':\n            subObject = new cv.ui.manager.model.schema.Any(subNode, schema);\n            this._subGroupings.push(subObject);\n            break;\n        }\n\n        this._sortedContent.push(subObject);\n      });\n      this._allowedElements['#comment'] = this.getSchema().getCommentNodeSchemaElement();\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // create list of allowed elements\n      if (nocapture) {\n        regexString += '?:';\n      }\n\n      const elementRegexes = [];\n\n      // this goes over ALL elements AND sub-groupings\n      this._sortedContent.forEach(element => {\n        elementRegexes.push(element.getRegex(separator, nocapture));\n      });\n\n      regexString += elementRegexes.join('');\n\n      regexString += ')';\n\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // we are a sequence-element; there is actually a lot of sayings ...\n      if (typeof this._allowedElements[childName] !== 'undefined') {\n        const elementBounds = this._allowedElements[childName].getBounds();\n        const sequenceBounds = this.getBounds();\n\n        const resultBounds = {\n          min: 1,\n          max: 1\n        };\n\n        // if it is bounded, we must duplicate element and sequence bounds\n        // (an element may appear as often as the number of sequences times the number of elements\n        // in each sequence - roughly)\n        if (Object.prototype.hasOwnProperty.call(elementBounds, 'min')) {\n          resultBounds.min = elementBounds.min;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'min') && !isNaN(sequenceBounds.min)) {\n          resultBounds.min *= sequenceBounds.min;\n        }\n\n        if (elementBounds.max === Number.POSITIVE_INFINITY || sequenceBounds.max === Number.POSITIVE_INFINITY) {\n          resultBounds.max = Number.POSITIVE_INFINITY;\n        } else {\n          if (Object.prototype.hasOwnProperty.call(elementBounds, 'max')) {\n            resultBounds.max = elementBounds.max;\n          }\n\n          if (Object.prototype.hasOwnProperty.call(sequenceBounds, 'max') && !isNaN(sequenceBounds.max)) {\n            resultBounds.max *= sequenceBounds.max;\n          }\n        }\n\n        return resultBounds;\n      }\n\n      let childBounds;\n\n      let tmpBounds;\n\n      for (let i = 0; i < this._subGroupings.length; ++i) {\n        tmpBounds = this._subGroupings[i].getBoundsForElementName(childName);\n\n        if (undefined !== tmpBounds) {\n          // once we find the first set of bounds, we return that\n          childBounds = tmpBounds;\n          break;\n        }\n      }\n\n      return childBounds;\n    },\n\n    /**\n     * get the sorting of the allowed elements\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     * @param sortNumber  integer the sortNumber of a parent (only used when recursive)\n     * @return object     list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      const namesWithSorting = {};\n\n      this._sortedContent.forEach((item, i) => {\n        let mySortNumber = i;\n        if (sortNumber !== undefined) {\n          mySortNumber = sortNumber + '.' + i;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortNumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortNumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      });\n\n      return namesWithSorting;\n    }\n  }\n});\n","/**\n * a single group.\n * may be recursive\n */\nqx.Class.define('cv.ui.manager.model.schema.Group', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'group'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      let group = this.getNode();\n      if (group.hasAttribute('ref')) {\n        // if this is a reference, unravel it.\n        group = schema.getReferencedNode('group', group.getAttribute('ref'));\n      }\n\n      // we are allowed choice and sequence, but only ONE AT ALL is allowed\n      let grouping = group.querySelector(':scope > choice');\n      if (grouping) {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      } else {\n        grouping = group.querySelector(':scope > sequence');\n        if (grouping) {\n          this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n        }\n      }\n    },\n\n    /**\n     * get the elements allowed for this group\n     *\n     * @return  object      list of allowed elements, key is the name\n     */\n    getAllowedElements: function () {\n      // we have non of ourselves, so we return what the child says\n      return this._subGroupings[0].getAllowedElements();\n    },\n\n    /**\n     * get the sorting of the allowed elements.\n     * For a group, all elements have the same sorting, so they will all have the\n     * same sort number\n     *\n     * Warning: this only works if any element can have only ONE position in the parent.\n     *\n     * @param   sortNumber  integer the sort number of a parent (only used when recursive)\n     * @return  object              list of allowed elements, with their sort-number as value\n     */\n    getAllowedElementsSorting: function (sortNumber) {\n      const namesWithSorting = {};\n      const allowedElements = this.getAllowedElements();\n      Object.keys(allowedElements).forEach(name => {\n        const item = allowedElements[name];\n        let mySortNumber = 'x'; // for a group, sortNumber is always the same\n        if (sortNumber !== undefined) {\n          mySortNumber = sortNumber + '.' + mySortNumber;\n        }\n\n        if (item.getType() === 'element') {\n          namesWithSorting[item.getName()] = mySortNumber;\n        } else {\n          // go recursive\n          const subSortedElements = item.getAllowedElementsSorting(mySortNumber);\n          Object.assign(namesWithSorting, subSortedElements);\n        }\n      }, this);\n      return namesWithSorting;\n    },\n\n    /**\n     * get a regex (string) describing this choice\n     *\n     * @param   separator   string  the string used to separate different elements, e.g. ';'\n     * @param   nocapture   bool    when set to true non capturing groups are used\n     * @return  string  regex\n     */\n    getRegex: function (separator, nocapture) {\n      if (this._regexCache !== null) {\n        // use the cache if primed\n        return this._regexCache;\n      }\n\n      let regexString = '(';\n\n      // collect the regex for each and every grouping we might have;\n      // 'each and every' means 'the only ONE'\n      this._subGroupings.forEach(grouping => {\n        regexString = '(';\n        if (nocapture) {\n regexString += '?:'; \n}\n        regexString += grouping.getRegex(separator, nocapture) + ')';\n      });\n\n      // append bounds to regex\n      regexString += '{';\n      const bounds = this.getBounds();\n      regexString += bounds.min === undefined ? 1 : bounds.min;\n      regexString += ',';\n      if (bounds.max !== Number.POSITIVE_INFINITY) {\n        regexString += bounds.max === undefined ? 1 : bounds.max;\n      }\n      regexString += '}';\n\n      // fill the cache\n      this._regexCache = regexString;\n\n      // thats about it.\n      return regexString;\n    },\n\n    getBoundsForElementName: function (childName) {\n      // we are a group. we have no saying of ourselves\n      // (@FIXME: by definition we do, but we do not take that into account)\n      return this._subGroupings[0].getBoundsForElementName(childName);\n    }\n  }\n});\n","/**\n * any content.\n */\nqx.Class.define('cv.ui.manager.model.schema.Any', {\n  extend: cv.ui.manager.model.schema.Base,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'any'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n\n    /**\n     * parse a list of elements in this group.\n     * Group is allowed (all|choice|sequence)? as per the definition.\n     * We do all of those (except for 'all')\n     */\n    parse: function () {\n      this.base(arguments);\n      const schema = this.getSchema();\n\n      let group = this.getNode();\n      if (group.hasAttribute('ref')) {\n        // if this is a reference, unravel it.\n        group = schema.getReferencedNode('group', group.getAttribute('ref'));\n      }\n      // we are allowed choice and sequence, but only ONE AT ALL is allowed\n      group.querySelectorAll(':scope > choice').forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Choice(grouping, schema));\n      });\n\n      // sequences\n      group.querySelectorAll(':scope > sequence').forEach(grouping => {\n        this._subGroupings.push(new cv.ui.manager.model.schema.Sequence(grouping, schema));\n      });\n\n      // there may be only one, so we simply us the first we found\n      if (this._subGroupings.length > 0) {\n        this._subGroupings = [this._subGroupings[0]];\n      }\n    },\n\n    // overridden\n    isElementAllowed: function (element) {\n      return true;\n    },\n\n    // overridden\n    getSchemaElementForElementName: function (elementName) {\n      // can not find any reason why elementName is allowed with us...\n      return undefined;\n    },\n\n    // overridden\n    getRequiredElements: function () {\n      return [];\n    },\n\n    // overridden\n    getAllowedElements: function() {\n      return {};\n    },\n\n    getRegex: function (separator, nocapture) {\n      return '.*';\n    },\n\n    hasMultiLevelBounds: function () {\n      return true;\n    },\n\n    getBoundsForElementName: function (childName) {\n      return this._bounds;\n    }\n  }\n});\n","/**\n * a single attribute from the schema.\n */\nqx.Class.define('cv.ui.manager.model.schema.Attribute', {\n  extend: cv.ui.manager.model.schema.Base,\n  include: cv.ui.manager.model.schema.MAnnotation,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (node, schema) {\n    this.base(arguments, node, schema);\n    this.parse();\n  },\n\n  /*\n  ***********************************************\n    STATICS\n  ***********************************************\n  */\n  statics: {\n    /**\n     * Get the name of a schema-node\n     * @param e object  element to find the name of\n     * @param schema\n     * @return  string          name of the element\n     * @throws  if the name can not be found\n     */\n    getAttributeName: function(e, schema) {\n      if (e.hasAttribute('name')) {\n        return e.getAttribute('name');\n      }\n\n      if (e.hasAttribute('ref')) {\n        // it's a ref, seek other element!\n        const refName = e.getAttribute('ref');\n        const ref = schema.getReferencedNode('attribute', refName);\n\n        if (!ref) {\n          throw new Error('schema/xsd appears to be invalid, can not find element ' + refName);\n        }\n\n        return ref.getAttribute('name');\n      }\n\n      return 'unknown';\n    }\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    type: {\n      refine: true,\n      init: 'attribute'\n    },\n    name: {\n      check: 'String',\n      init: ''\n    },\n    optional: {\n      check: 'Boolean',\n      init: false\n    },\n    defaultValue: {\n      check: 'String',\n      nullable: true\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _type: null,\n\n    parse: function () {\n      const node = this.getNode();\n      const schema = this.getSchema();\n      /**\n       * we have our own type\n       * @var object  SchemaSimpleType of the attribute, for validating purposes\n       */\n      this._type = new cv.ui.manager.model.schema.SimpleType(node, schema);\n      this.setName(cv.ui.manager.model.schema.Attribute.getAttributeName(node, schema));\n      if (node.hasAttribute('default')) {\n        this.setDefaultValue(node.getAttribute('default'));\n      }\n      this.setOptional(node.getAttribute('use') !== 'required');\n    },\n\n    /**\n     * check if a given value is valid for this attribute\n     *\n     * @param   value   mixed   the value to check\n     * @return  boolean         if the value is valid\n     */\n    isValueValid: function (value) {\n      if (value === null || value === undefined) {\n        value = '';\n      } else {\n        value = '' + value;\n      }\n      if (value === '') {\n        // empty values are valid if this node is optional!\n        return this.isOptional();\n      }\n      return this._type.isValueValid(value);\n    },\n\n    /**\n     * get a simple string telling us, what type of content is allowed\n     *\n     * @return  string  description of allowed values, almost user-readable :)\n     */\n    getTypeString: function () {\n      const description = this._type.getBaseType();\n\n      if (description.match(/xsd\\:/)) {\n        return description.replace(/xsd\\:/, '');\n      }\n\n      return this.tr('complex type, please see documentation');\n    },\n\n    /**\n     * get the list of values that are valid for this attribute, if it is an enumeration\n     *\n     * @return  array   list of string of valid values\n     */\n    getEnumeration: function () {\n      return this._type.getEnumeration();\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__appInfoCache = null;\n    this.__documentationCache = null;\n  }\n});\n","/**\n * Simple config entry.\n */\nqx.Class.define('cv.ui.manager.model.config.Option', {\n  extend: qx.core.Object,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function (key, value) {\n    this.base(arguments);\n    this.setKey(key);\n    this.setValue(value);\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    // sent whenever the options key or value has been changed\n    'change': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    key: {\n      check: 'String',\n      init: '',\n      event: 'changeKey',\n      apply: '_applyChange'\n    },\n\n    value: {\n      check: 'String',\n      init: '',\n      event: 'changeValue',\n      apply: '_applyChange'\n    }\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    _applyChange: function () {\n      this.fireEvent('change');\n    }\n  }\n});\n","/**\n * This widgets shows and editable config option in a list.\n */\nqx.Class.define('cv.ui.manager.form.OptionListItem', {\n  extend: qx.ui.core.Widget,\n\n  /*\n  ***********************************************\n    CONSTRUCTOR\n  ***********************************************\n  */\n  construct: function () {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.HBox(8));\n    this._createChildControl('key');\n    this._createChildControl('value');\n    this._createChildControl('key-title');\n    this._createChildControl('value-title');\n    this._createChildControl('delete');\n    this._createChildControl('add');\n  },\n\n  /*\n  ***********************************************\n    PROPERTIES\n  ***********************************************\n  */\n  properties: {\n    appearance: {\n      refine: true,\n      init: 'cv-editor-config-option'\n    },\n\n    model: {\n      check: 'cv.ui.manager.model.config.Option',\n      nullable: true,\n      apply: '_applyModel'\n    },\n\n    readOnly: {\n      check: 'Boolean',\n      init: false,\n      event: 'changeReadOnly'\n    }\n  },\n\n  /*\n  ***********************************************\n    EVENTS\n  ***********************************************\n  */\n  events: {\n    'delete': 'qx.event.type.Data',\n    'add': 'qx.event.type.Event'\n  },\n\n  /*\n  ***********************************************\n    MEMBERS\n  ***********************************************\n  */\n  members: {\n    // list controller with allowNull calls setLabel\n    setLabel: function (label) {\n\n    },\n\n    // list controller with allowNull calls setIcon\n    setIcon: function () {},\n\n    _applyModel: function (value, old) {\n      const keyField = this.getChildControl('key');\n      const valueField = this.getChildControl('value');\n      const keyTitleField = this.getChildControl('key-title');\n      const valueTitleField = this.getChildControl('value-title');\n      this.__unbindModel(old);\n      if (value) {\n        // bi-directional bind\n        value.bind('key', keyField, 'value');\n        value.bind('value', valueField, 'value');\n        keyField.bind('value', value, 'key');\n        valueField.bind('value', value, 'value');\n        keyField.show();\n        valueField.show();\n        keyTitleField.exclude();\n        valueTitleField.exclude();\n        this.getChildControl('delete').show();\n        this.getChildControl('add').show();\n      } else {\n        keyField.exclude();\n        valueField.exclude();\n        keyTitleField.show();\n        valueTitleField.show();\n        this.getChildControl('delete').hide();\n        this.getChildControl('add').hide();\n      }\n    },\n\n    __unbindModel: function (model) {\n      if (model) {\n        const keyField = this.getChildControl('key');\n        const valueField = this.getChildControl('value');\n        if (model) {\n          model.removeRelatedBindings(keyField);\n          model.removeRelatedBindings(valueField);\n          keyField.removeRelatedBindings(model);\n          valueField.removeRelatedBindings(model);\n        }\n      }\n    },\n\n    // overridden\n    _createChildControlImpl : function(id) {\n      let control;\n\n      switch (id) {\n         case 'key':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true,\n             required: true\n           });\n           this.bind('readOnly', control, 'readOnly');\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'value':\n           control = new qx.ui.form.TextField();\n           control.set({\n             liveUpdate: true\n           });\n           this.bind('readOnly', control, 'readOnly');\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'delete':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('delete', 22));\n           control.setToolTipText(this.tr('Delete option'));\n           control.addListener('execute', function() {\n             this.fireDataEvent('delete', this.getModel());\n           }, this);\n           this.bind('readOnly', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'hidden' : 'visible';\n             }\n           });\n           this._add(control);\n           break;\n\n         case 'add':\n           control = new qx.ui.form.Button(null, cv.theme.dark.Images.getIcon('add', 18));\n           control.setToolTipText(this.tr('Add option'));\n           control.addListener('execute', function() {\n             this.fireEvent('add');\n           }, this);\n           this.bind('readOnly', control, 'visibility', {\n             converter: function (value) {\n               return value ? 'hidden' : 'visible';\n             }\n           });\n           this._add(control);\n           break;\n\n         case 'key-title':\n           control = new qx.ui.basic.Label(this.tr('Key'));\n           control.exclude();\n           this._add(control, {width: '40%'});\n           break;\n\n         case 'value-title':\n           control = new qx.ui.basic.Label(this.tr('Value'));\n           control.exclude();\n           this._add(control, {width: '40%'});\n           break;\n       }\n\n       return control || this.base(arguments, id);\n    }\n  },\n\n  /*\n  ***********************************************\n    DESTRUCTOR\n  ***********************************************\n  */\n  destruct: function () {\n    this.__unbindModel(this.getModel());\n  }\n});\n","/**\n * Wrapper for cometvisu icons to make the usable as Qx-Widget.\n */\nqx.Class.define('cv.ui.manager.basic.Icon', {\n  extend: qx.ui.core.Widget\n\n});\n"]}