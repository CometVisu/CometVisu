<!DOCTYPE html>
<html class="writer-html4" lang="de" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Automatisierte Tests &mdash; CometVisu</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/theme_override.css" type="text/css" />
    <link rel="canonical" href="https://www.cometvisu.org/CometVisu/de/0.13/manual/colab/dev/test.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/versions.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="../../genindex.html" />
    <link rel="search" title="Suche" href="../../search.html" />
    <link rel="next" title="Informationen für Entwickler" href="../../devel/index.html" />
    <link rel="prev" title="Einrichten einer VM mit Visual Studio Code" href="../howto-vm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> CometVisu<img src="../../_static/comet_webapp_icon_android_48.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.13.0-dev
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installation der CometVisu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config/index.html">Konfiguration der CometVisu</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Hilf dem CometVisu Projekt</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#allgemeine-vorbereitungen">Allgemeine Vorbereitungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#allgemeine-vorgehensweise">Allgemeine Vorgehensweise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#repositories-synchron-halten">Repositories synchron halten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#mithilfe-bei-der-dokumentation">Mithilfe bei der Dokumentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#mithilfe-bei-der-entwicklung">Mithilfe bei der Entwicklung</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Automatisierte Tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#unittests">Unittests</a></li>
<li class="toctree-l4"><a class="reference internal" href="#eigene-tests-schreiben">Eigene Tests schreiben</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#fehlerbericht-erstellen">Fehlerbericht erstellen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../devel/index.html">Informationen für Entwickler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CometVisu</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Hilf dem CometVisu Projekt</a> &raquo;</li>
      <li>Automatisierte Tests</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition caution">
<p class="first admonition-title">Vorsicht</p>
<p class="last">Dies ist die Dokumentation des aktuellen Entwicklungszweigs der CometVisu.
Es besteht daher die Möglichkeit, dass einige der hier beschriebenen Features
mit dem aktuellsten Release der CometVisu nicht genutzt werden können.</p>
</div>
<div class="section" id="automatisierte-tests">
<h1>Automatisierte Tests<a class="headerlink" href="#automatisierte-tests" title="Link zu dieser Überschrift">¶</a></h1>
<p>Die CometVisu nutzt zwei Arten von automatisierten Softwaretests: Unittests und End-to-End Tests.
Bei Unittest geht es darum einzelne Funktionen innerhalb des Sourcecodes zu testen.
Wenn man z.B. eine <cite>add</cite>-Funktion hat, die zwei Zahlen addiert, dann ruft ein Unittest diese
Funktion auf, übergibt ihr zwei Zahlen und prüft ob das Ergebnis korrekt ist.</p>
<p>End-to-End Tests prüfen eher das „Große Ganze“ und simulieren das Benutzervehalten.
Hierbei wird also die CometVisu voll-automatisiert in einem Browser geöffnet und die Tests
bedienen die Visu wie ein Benutzer und prüfen ob eine Aktion die gewünschten Veränderungen bewirkt.
Zu kann man z.B. prüfen ob das Klicken auf einen Switch den passenden Wert an das Backend liefert und
wenn das Backend ein Update für den Switch liefert, dieser diesen entsprechend anzeigt.</p>
<div class="section" id="unittests">
<h2>Unittests<a class="headerlink" href="#unittests" title="Link zu dieser Überschrift">¶</a></h2>
<p>Als Testrunner für die Unittests kommt <a class="reference external" href="https://karma-runner.github.io">Karma</a> zum Einsatz.
Ausgeführt werden die Tests über das Kommandozeilen-Tool Grunt.
Falls noch nicht geschehen, müssen also einmalig folgende Kommandos im Wurzelverzeichnis des
CometVisu Projekts zur Vorbereitung ausgeführt werden.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm install
sudo npm -g install grunt-cli
</pre></div>
</div>
<p>Die vorhandenen Unittests kann man dann mit folgendem Befehl ausführen:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grunt karma:ci
</pre></div>
</div>
<p>Dies führt die Tests inkl. eine Code-Coverage Analyse aus. Die Code-Coverage zeigt als Ergebnis an wieviel
Prozent des Sourcecodes durch Tests abgedeckt wurde, die Ausgabe sieht so aus:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">===============================</span> Coverage <span class="nv">summary</span> <span class="o">===============================</span>
Statements   : <span class="m">42</span>.14% <span class="o">(</span> <span class="m">1308</span>/3104 <span class="o">)</span>
Branches     : <span class="m">32</span>.35% <span class="o">(</span> <span class="m">584</span>/1805 <span class="o">)</span>
Functions    : <span class="m">46</span>.99% <span class="o">(</span> <span class="m">211</span>/449 <span class="o">)</span>
Lines        : <span class="m">41</span>.8% <span class="o">(</span> <span class="m">1233</span>/2950 <span class="o">)</span>
<span class="o">================================================================================</span>
</pre></div>
</div>
<p>Einen ausführlicheren Coverage Report findet man unter <code class="docutils literal notranslate"><span class="pre">./coverage/&lt;browser-name&gt;/index.html</span></code>. Wobei
der Browser Name dem des den ausführenden Browsers entspeist. Zur Zeit ist dies der für Headless-Testing
entwickelte (auf Chrome basierende) PhantomJS. Theoretisch sind hier aber alle auf dem lokalen System
installierten Browser möglich. In dem ausführlichen Coverage Report, kann man bis hinunter in einzelne
Sourcecode Dateien navigieren und dort sehen, welche Zeilen noch nicht getestet wurde. Das ist sehr
nützlich, um zu sehen an welchen Stellen die Tests noch verfollständigt werden müssen</p>
</div>
<div class="section" id="eigene-tests-schreiben">
<h2>Eigene Tests schreiben<a class="headerlink" href="#eigene-tests-schreiben" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die Unittests werden mit Hilfe des <a class="reference external" href="http://jasmine.github.io/2.4/introduction.html">Jasmine Frameworks</a>
geschrieben. Dadurch ist es möglich, die Tests fast in natürlicher Sprache zu schreiben. Der Grundaufbau eines
Tests sieht so aus:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;Meine Testsuite&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;should add two numbers&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">add</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span> <span class="mf">5</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mf">9</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Dieser Code testet eine <code class="docutils literal notranslate"><span class="pre">add</span></code>-Funktion die einfach zwei Zahlen addiert.</p>
<p>Zu finden sind die vorhandenen Tests im <code class="docutils literal notranslate"><span class="pre">source/test/karma</span></code> Untervezeichnis. Möchte man nun einen neuen Test für eine (fiktive)
Sourcecode Datei unter <code class="docutils literal notranslate"><span class="pre">source/ui/structure/pure/NewWidget.js</span></code> schreiben, legt man die neue Datei
<code class="docutils literal notranslate"><span class="pre">source/test/karma/ui/structure/pure/NewWidget-spec.js</span></code> an.
Wichtig ist hier, dass der Name der Testdatei auf <code class="docutils literal notranslate"><span class="pre">-spec</span></code> endet, sonst wird sie vom Testrunner nicht gefunden.</p>
<p>Der Test für diese Datei sollte nun folgendermaßen aussehen:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;testing the new-widget&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;should test the creation of a new-widget&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Hilfsfunktion die den HTML-Code des widgets erzeugt (weitere Hilfsfunktionen sind in source/test/karma/helper-spec.js zu finden)</span>
    <span class="c1">// die Hilfsfunktion gibt ein Array mit 2 Elementen zurück, das erste ist die Instanz den Widget-Objekts, das zweite der HTML-Code als String</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createTestWidgetString</span><span class="p">(</span><span class="s2">&quot;new-widget&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;&lt;label&gt;Test&lt;/label&gt;&quot;</span><span class="p">);</span>
    <span class="c1">// macht aus dem String ein DOM Element</span>
    <span class="kd">var</span> <span class="nx">widget</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">div</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span><span class="nx">div</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">res</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span><span class="k">return</span> <span class="nx">div</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mf">0</span><span class="p">];})();</span>
    <span class="c1">// das Widget Object (Instanz der Klasse cv.ui.structure.pure.NewWidget)</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">res</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>

    <span class="c1">// prüft ob das DOM Element die CSS Klasse newwidget hat</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">widget</span><span class="p">).</span><span class="nx">toHaveClass</span><span class="p">(</span><span class="s1">&#39;newwidget&#39;</span><span class="p">);</span>
    <span class="c1">// prüft ob das DOM Element ein Label mit dem Text &#39;Test&#39; hat</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">widget</span><span class="p">).</span><span class="nx">toHaveLabel</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">);</span>
    <span class="c1">// prüft ob der widget Pfad &#39;id_0&#39; ist</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">getPath</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="s2">&quot;id_0&quot;</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;should test another part of the new-widget&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// weitere Tests</span>
  <span class="p">});</span>

  <span class="p">...</span>

<span class="p">});</span>
</pre></div>
</div>
<p>Als Beispiele, wie man Tests schreibt und welche Dinge man wie testen kann, sollten die vorhandenen Tests dienen.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../howto-vm.html" class="btn btn-neutral float-left" title="Einrichten einer VM mit Visual Studio Code" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../devel/index.html" class="btn btn-neutral float-right" title="Informationen für Entwickler" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2010-2022 Christian Mayer and the CometVisu contributers.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Version</span>
      v: 0.13.0-dev
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../../0.10/manual">0.10.2</a></dd>
        
          <dd><a href="../../0.11/manual">0.11.2</a></dd>
        
          <dd><a href="../../0.12/manual">0.12.0</a></dd>
        
          <dd><a href="../../0.13/manual">0.13.0-dev</a></dd>
        
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>