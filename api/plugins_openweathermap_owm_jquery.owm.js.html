<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>CometVisu Source: plugins/openweathermap/owm/jquery.owm.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.spacelab.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">CometVisu</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-lib_CometVisuClient.html">lib/CometVisuClient</a></li><li><a href="module-lib_TemplateEngine.html">lib/TemplateEngine</a></li><li><a href="module-plugins_powerspectrum_structure_plugin.html">plugins/powerspectrum/structure_plugin</a></li><li><a href="module-structure_pure.html">structure/pure</a></li><li><a href="module-structure_pure_Audio.html">structure/pure/Audio</a></li><li><a href="module-structure_pure_Break.html">structure/pure/Break</a></li><li><a href="module-structure_pure_DesignToggle.html">structure/pure/DesignToggle</a></li><li><a href="module-structure_pure_Group.html">structure/pure/Group</a></li><li><a href="module-structure_pure_Image.html">structure/pure/Image</a></li><li><a href="module-structure_pure_ImageTrigger.html">structure/pure/ImageTrigger</a></li><li><a href="module-structure_pure_Include.html">structure/pure/Include</a></li><li><a href="module-structure_pure_Info.html">structure/pure/Info</a></li><li><a href="module-structure_pure_InfoAction.html">structure/pure/InfoAction</a></li><li><a href="module-structure_pure_InfoTrigger.html">structure/pure/InfoTrigger</a></li><li><a href="module-structure_pure_Line.html">structure/pure/Line</a></li><li><a href="module-structure_pure_Multitrigger.html">structure/pure/Multitrigger</a></li><li><a href="module-structure_pure_NavBar.html">structure/pure/NavBar</a></li><li><a href="module-structure_pure_Page.html">structure/pure/Page</a></li><li><a href="module-structure_pure_PageJump.html">structure/pure/PageJump</a></li><li><a href="module-structure_pure_PushButton.html">structure/pure/PushButton</a></li><li><a href="module-structure_pure_Refresh.html">structure/pure/Refresh</a></li><li><a href="module-structure_pure_Reload.html">structure/pure/Reload</a></li><li><a href="module-structure_pure_Rgb.html">structure/pure/Rgb</a></li><li><a href="module-structure_pure_Slide.html">structure/pure/Slide</a></li><li><a href="module-structure_pure_Switch.html">structure/pure/Switch</a></li><li><a href="module-structure_pure_Text.html">structure/pure/Text</a></li><li><a href="module-structure_pure_Toggle.html">structure/pure/Toggle</a></li><li><a href="module-structure_pure_Trigger.html">structure/pure/Trigger</a></li><li><a href="module-structure_pure_Unknown.html">structure/pure/Unknown</a></li><li><a href="module-structure_pure_UrlTrigger.html">structure/pure/UrlTrigger</a></li><li><a href="module-structure_pure_Video.html">structure/pure/Video</a></li><li><a href="module-structure_pure_Web.html">structure/pure/Web</a></li><li><a href="module-structure_pure_WgPluginInfo.html">structure/pure/WgPluginInfo</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="-_anonymous_-EventHandler-Dispatcher.html"><anonymous>~EventHandler~Dispatcher</a></li><li><a href="FOO.html">FOO</a></li><li><a href="module-cometvisu-client.html">cometvisu-client</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#debug">debug</a></li><li><a href="global.html#fadeNavbar">fadeNavbar</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#handleRead">handleRead</a></li><li><a href="global.html#initializeNavbars">initializeNavbars</a></li><li><a href="global.html#jOWM">jOWM</a></li><li><a href="global.html#list">list</a></li><li><a href="global.html#navbarSetSize">navbarSetSize</a></li><li><a href="global.html#subscribe">subscribe</a></li><li><a href="global.html#updatePageParts">updatePageParts</a></li><li><a href="global.html#write">write</a></li>
				</ul>
			</li>
			
		</ul>
		<div class="col-sm-3 col-md-3">
            <form class="navbar-form" role="search">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                    <div class="input-group-btn">
                        <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                    </div>
                </div>
            </form>
        </div>
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: plugins/openweathermap/owm/jquery.owm.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript linenums">/**
 * Plugin: jquery.OWM
 *
 * jQuery plugin to display data from OpenWeatherMap.
 *
 * Version: 0.0.1
 * Copyright (c) 2015, Stefan Borchert
 *
 * Licensed under the GPLv3 license.
**/

var jOWM = jOWM || {};

(function ($) {

  $.fn.openweathermap = function(options, fn) {

    // Set plugin defaults.
    var defaults = {
      // Base URL to service.
      baseURL: 'http://api.openweathermap.org/data/2.5/',
      // Number of items to show detailed data for (0..4).
      detailItems: 4,
      // Number of items in forecast (0..16).
      forecastItems: 5,
      // Include today in forecast?
      forecastToday: true,
      // Default units.
      units: 'metric',
      // Type ('exact', 'like').
      type: 'like',
      // Refresh interval in minutes.
      refresh: 30,
      // App-ID needed to access the service.
      appid: ''
    };

    var options = $.extend(defaults, options);

    // Sanitize options.
    options.detailItems = parseInt(options.detailItems, 10);
    if (options.detailItems &lt; 0) {
      options.detailItems = 0;
    }
    if (options.detailItems > 4) {
      options.detailItems = 4;
    }
    options.forecastItems = parseInt(options.forecastItems, 10);
    if (options.forecastItems &lt; 0) {
      options.forecastItems = 0;
    }
    if (options.forecastItems > 16) {
      options.forecastItems = 16;
    }

    // extend locales by German and French
    Date.ext.locales['de'] = {
      a: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],
      A: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],
      b: ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],
      B: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
    };

    return this.each(function(i, e) {
      $element = $(e);

      if (!$element.hasClass('jowm')) {
        $element.addClass('jowm');
      }

      // Process element.
      _process(e, options);

    });

  };

  var _process = function (e, options) {
    var html = '';
    var paramsDefault = _parametersFromOptions(options);
    var currentURL = options.baseURL + 'forecast?' + paramsDefault.join('&amp;');
    var forecastItems = paramsDefault;
    // Limit results to specified number of days.
    forecastItems.push('cnt=' + options.forecastItems);
    var forecastURL = options.baseURL + 'forecast/daily?' + forecastItems.join('&amp;');

    if ($('ul.detailed', $(e)).length === 0) {
      $('&lt;ul>')
        .addClass('detailed')
        .addClass('clearfix')
        .appendTo($(e));
    }
    if ($('ul.forecast', $(e)).length === 0) {
      $('&lt;ul>')
        .addClass('forecast')
        .addClass('clearfix')
        .appendTo($(e));
    }

    // Load location data.
    $.getJSON(options.baseURL + 'weather?' + paramsDefault.join('&amp;'), function (data) {
      if (data.cod == 200) {
        // Load sunrise/sunset.
        options.sunrise = data.sys.sunrise;
        options.sunset = data.sys.sunset;

        // Fetch data for detailed items.
        _processDataDetailed(e, currentURL, options);
        // Fetch data for forecast items.
        _processDataForecast(e, forecastURL, options);
      }
      else {
        $(e).after('&lt;!-- Failed to fetch detailed weather data. -->');
      }
    });

  }

  /**
   * Process detailed weather data and generate output.
   */
  var _processDataDetailed = function (e, url, options) {
    // Clear old markup.
    $('ul.detailed', $(e)).html('');
    if (options.detailItems === 0) {
      // Detailed items are disabled.
      return;
    }
    $.getJSON(url, function (data) {
      if (data.cod == 200) {
        var dataItems = data.list.slice(0, options.detailItems);
        $.each(dataItems, function (index, elem) {
          $item = $('&lt;li>');
          if (elem.dt &lt; options.sunrise || elem.dt > options.sunset) {
            $item.addClass('night');
          }
          if (index === 0) {
            $item.addClass('first');
          }
          if (index === (dataItems.length - 1)) {
            $item.addClass('last');
          }
          $item.html(jOWM.theme('weatherDetailItem', elem, options));
          $item.appendTo($('ul.detailed', $(e)));
        });
      }
      else {
        $(e).after('&lt;!-- Failed to fetch detailed weather data. -->');
      }
    });
  }

  /**
   * Process forecast weather data and generate output.
   */
  var _processDataForecast = function (e, url, options) {
    // Clear old markup.
    $('ul.forecast', $(e)).html('');
    if (options.forecastItems === 0) {
      // Forecast is disabled.
      return;
    }
    $.getJSON(url, function (data) {
      if (data.cod == 200) {
        var dataItems = data.list;
        if (!options.forecastToday) {
          // Remove first item from list.
          dataItems.shift();
        }
        $.each(dataItems, function (index, elem) {
          $item = $('&lt;li>');
          if (index === 0) {
            $item.addClass('first');
          }
          if (index === (dataItems.length - 1)) {
            $item.addClass('last');
          }
          $item.html(jOWM.theme('weatherForecastItem', elem, options));
          $item.appendTo($('ul.forecast', $(e)));
        });
      }
      else {
        $(e).after('&lt;!-- Failed to fetch forecast weather data. -->');
      }
    });
  }

  /**
   * Helper function to create URL parameters from options.
   *
   * @param options
   *   List of widget options.
   */
  var _parametersFromOptions = function(options) {
    var items = [];
    if (options.hasOwnProperty('lang')) {
      items.push('lang=' + options.lang);
    }
    if (options.hasOwnProperty('q')) {
      items.push('q=' + options.q);
    }
    else if (options.hasOwnProperty('lat') &amp;&amp; options.hasOwnProperty('lon')) {
      items.push('lat=' + options.lat);
      items.push('lon=' + options.lon);
    }
    if (options.hasOwnProperty('units')) {
      items.push('units=' + options.units);
    }
    if (options.hasOwnProperty('type')) {
      items.push('type=' + options.type);
    }
    if (options.hasOwnProperty('appid')) {
      items.push('appid=' + options.appid);
    }
    return items;
  }

  /**
   * Generic theme function.
   */
  jOWM.theme = function (func) {
    var args = Array.prototype.slice.apply(arguments, [1]);

    return (jOWM.theme[func] || jOWM.theme.prototype[func]).apply(this, args);
  };

  /**
   * Default theme function for weather temperature.
   */
  jOWM.theme.prototype.weatherTemperature = function (temperature, precision, suffix) {
    suffix = suffix || '°';
    return parseFloat(temperature).toFixed(precision) + suffix;
  }

  /**
   * Default theme function for detailed weather item.
   */
  jOWM.theme.prototype.weatherDetailItem = function (data, options) {
    var weather = data.weather[0];
    var temperature = data.main;
    var d = new Date(data.dt * 1000); // We need ms, not s!
    d.locale = options.lang;

    var output = '&lt;div class="weather-detailed weather-' + weather.id + ' clearfix">';
    output += ' &lt;div class="weather">';
    output += '  &lt;span class="weather-icon" data-weather-text="' + weather.description + '" data-weather-code="' + weather.id + '">&lt;/span>';
    output += ' &lt;/div>';
    output += ' &lt;div class="temperature">' + jOWM.theme('weatherTemperature', temperature.temp, 1) + '&lt;/div>';
    output += '&lt;/div>';
    return output;
  };

  /**
   * Default theme function for forecast weather item.
   */
  jOWM.theme.prototype.weatherForecastItem = function (data, options) {
    var weather = data.weather[0];
    var temperature = data.temp;
    var d = new Date(data.dt * 1000); // We need ms, not s!
    d.locale = options.lang;

    var output = '&lt;div class="weather-forecast weather-' + weather.id + ' clearfix">';
    output += ' &lt;div class="day">' + d.strftime('%a') + '&lt;/div>';
    output += ' &lt;div class="weather-icon" data-weather-text="' + weather.description + '" data-weather-code="' + weather.id + '">&lt;/div>';
    output += ' &lt;div class="temperature high">' + jOWM.theme('weatherTemperature', temperature.max, 0, ' °C') + '&lt;/div>';
    output += ' &lt;div class="temperature low">' + jOWM.theme('weatherTemperature', temperature.max, 0, ' °C') + '&lt;/div>';
    output += '&lt;/div>';
    return output;
  };

})(jQuery);
</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>

<div class="modal fade" id="searchResults">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Search results</h4>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>

<footer>


	<span class="copyright">
	CometVisu Copyright © 2010-2016, Christian Mayer and the CometVisu contributers.
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a>
	
		on Mon Aug 29th 2016
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>
<script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>

<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			var id = $( heading ).attr( "id" );
			return id && id.replace(/\~/g, '-inner-').replace(/\./g, '-static-') || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->


<script type="text/javascript">
	$(document).ready(function() {
		SearcherDisplay.init();
	});
</script>

</body>
</html>
